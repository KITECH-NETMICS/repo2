(function(){function x(a,f,g){var d=a.getStyle("height");g=!g&&d.replace(/[0-9|.]/g,"");var c=0;"mm"==f?"mm"==g?c=parseInt(d.replace(/[^0-9|.]/g,"")):(c=POLARIS.env.ie?a.$.clientHeight:parseFloat(a.getComputedStyle("height")),c=parseInt(POLARIS.tools.convertPxToMm(c))):"px"==f&&(c="px"==g?parseFloat(d.replace(/[^0-9|.]/g,"")):POLARIS.env.ie?a.$.clientHeight:parseFloat(a.getComputedStyle("height")));return c}function y(a,f,g){var d=a.getStyle("width");g=!g&&d.replace(/[0-9|.]/g,"");var c=0;"mm"==f?
"mm"==g?c=parseInt(d.replace(/[^0-9|.]/g,"")):(c=POLARIS.env.ie?a.$.clientWidth:parseFloat(a.getComputedStyle("width")),c=parseInt(POLARIS.tools.convertPxToMm(c))):"px"==f&&(c="px"==g?parseFloat(d.replace(/[^0-9|.]/g,"")):POLARIS.env.ie?a.$.clientWidth:parseFloat(a.getComputedStyle("width")));return c}function C(a){var f=a.getSelection().getStartElement();if(f){var g=a.elementPath(f);a=POLARIS.tools.getContentSizeToUnit(a,"mm").width;g&&(f=g.block||g.blockLimit||f);f=POLARIS.tools.convertPxToMm(f.getSize("width",
!0));f=parseInt(f);f>=a&&(f=a-1);return f}}function D(a){for(var f=0,g=0,d=0,c,n=a.$.rows.length;d<n;d++){c=a.$.rows[d];for(var t=f=0,h,e=c.cells.length;t<e;t++)h=c.cells[t],"none"!=h.style.display&&(f+=h.colSpan);f>g&&(g=f)}return g}function v(a,f,g){return function(){var d=this.getValue(),d=!!(POLARIS.dialog.validate.number()(d)&&d>=f&&d<g+1);d||(alert(a.replace("%1",g)),this.select());return d}}function z(a,f){if(a)for(var g=a.elements,d=0,c;d<g.length;d++)if(c=g[d],c=c.getStyle(f))return c;return null}
function u(a,f){var g=function(h){return new POLARIS.dom.element(h,a.document)};a.editable();var d={type:"html",html:"\x26nbsp;"},c=a.plugins.uicolor;setupData={};setupData.info||(setupData.info={});var u=POLARIS.tools.getNextId()+"_tableBgColorPanel",t=POLARIS.tools.getNextId()+"_tableBorderColorPanel";return{title:a.lang.table.title,minWidth:244,minHeight:120,resizable:POLARIS.DIALOG_RESIZE_NONE,onLoad:function(){var a=this,e=a.getContentElement("advanced","advStyles");if(e)e.on("change",function(){var b=
this.getStyle("width",""),e=a.getContentElement("info","txtWidth");e&&e.setValue(b,!0);b=this.getStyle("height","");(e=a.getContentElement("info","txtHeight"))&&e.setValue(b,!0)})},onShow:function(){a.pagination&&a.pagination.adjustCaret(a);var h=a.getSelection(),e=h.getRanges(),b,g=this.getContentElement("info","txtRows"),w=this.getContentElement("info","txtCols"),A=this.getContentElement("info","txtWidth"),d=this.getContentElement("info","txtHeight");if("tableProperties"==f){if((h=h.getSelectedElement())&&
h.is("table")?b=h:0<e.length&&(POLARIS.env.webkit&&e[0].shrink(POLARIS.NODE_ELEMENT),b=a.elementPath(e[0].getCommonAncestor(!0)).contains("table",1)),null==b&&(b=a.plugins.tabletools.getDragStartCell().getAscendant("table")),this._.selectedElement=b,this._.paginatedTables=null,b.hasAttribute("doc-data-value")&&"polaris-table-paginated"==b.getAttribute("doc-data-role")){this._.paginatedTables=[];var e=b.getAttribute("doc-data-value"),e=b.getAscendant("body",1).find('table[doc-data-value\x3d"'+e+'"]'),
c,h=0;for(c=e.count();h<c;h++)this._.paginatedTables.push(e.getItem(h))}}else A.setValue(C(a)),d.setValue(parseInt(POLARIS.tools.convertPxToMm(32*g.getValue())));b?(this.setupContent(b),g&&g.disable(),w&&w.disable()):(g&&g.enable(),w&&w.enable());A&&A.onChange();d&&d.onChange()},onOk:function(){POLARIS.plugins.tabletools.clearSelectedCell();a.pagination&&a.pagination.adjustCaret(a);if(!POLARIS.plugins.div.getSurroundDiv(a)){var h=a.getSelection(),e=this._.selectedElement&&h.createBookmarks(),b=this._.selectedElement||
g("table"),f=this._.paginatedTables,d={};b.setStyle("table-layout","fixed");this.commitContent(d,b);if(d.info){d=d.info;0<parseFloat(d.cmbCellSpacing)?(b.setStyle("border-spacing",parseFloat(d.cmbCellSpacing)+a.lang.common.unitPt),b.setStyle("border-collapse","separate")):(b.setStyle("border-spacing","0"),b.setStyle("border-collapse","collapse"));if(!this._.selectedElement){var c=b.append(g("colgroup")),p=b.append(g("tbody")),m=parseInt(d.txtRows,10)||0,l=parseInt(d.txtCols,10)||0;d.txtHeight||(d.txtHeight=
32*m);d.txtWidth||(d.txtWidth=C(a));var n=POLARIS.tools.convertToPx(d.txtWidth+a.lang.common.unitMm),k=POLARIS.tools.convertToPx(d.txtHeight+a.lang.common.unitMm),n=POLARIS.plugins.tabletools.getSplittedCellSize(n,l);cellHeightPxs=POLARIS.plugins.tabletools.getSplittedCellSize(k,m);var k=h.getStartElement(),k=a.elementPath(k),t={},u={};t["line-height"]=a.config.documentLineHeight?a.config.documentLineHeight:z(k,"line-height");u["font-family"]=a.config.documentFontFamily?a.config.documentFontFamily:
z(k,"font-family");u["font-size"]=a.config.documentFontSize?a.config.documentFontSize+"pt":z(k,"font-size");for(k=0;k<l;k++)c.append(g("col")).setStyle("width",POLARIS.tools.cssLength(n[k]));for(k=0;k<m;k++)for(var c=p.append(g("tr")),q=0;q<l;q++){var r=c.append(g("td"));r.setStyle("width",POLARIS.tools.cssLength(n[q]));r.setStyle("height",POLARIS.tools.cssLength(cellHeightPxs[q]));r.setStyle("padding-left","2mm");r.setStyle("padding-right","2mm");var v=new POLARIS.dom.element("p"),B=new POLARIS.dom.element("span");
B.setStyles(u);B.setHtml("\x26#8203;");v.append(B);v.setStyles(t);r.append(v)}}m=d.selHeaders;if(!b.$.tHead&&("row"==m||"both"==m)){c=new POLARIS.dom.element(b.$.createTHead());p=b.getElementsByTag("tbody").getItem(0);p=p.getElementsByTag("tr").getItem(0);for(k=0;k<p.getChildCount();k++)l=p.getChild(k),l.type!=POLARIS.NODE_ELEMENT||l.data("polaris-bookmark")||(l.renameNode("th"),l.setAttribute("scope","col"));c.append(p.remove())}if(null!==b.$.tHead&&"row"!=m&&"both"!=m){c=new POLARIS.dom.element(b.$.tHead);
p=b.getElementsByTag("tbody").getItem(0);for(n=p.getFirst();0<c.getChildCount();){p=c.getFirst();for(k=0;k<p.getChildCount();k++)l=p.getChild(k),l.type==POLARIS.NODE_ELEMENT&&(l.renameNode("td"),l.removeAttribute("scope"));p.insertBefore(n)}c.remove()}if(!this.hasColumnHeaders&&("col"==m||"both"==m))for(c=0;c<b.$.rows.length;c++)l=new POLARIS.dom.element(b.$.rows[c].cells[0]),l.renameNode("th"),l.setAttribute("scope","row");if(this.hasColumnHeaders&&"col"!=m&&"both"!=m)for(k=0;k<b.$.rows.length;k++)c=
new POLARIS.dom.element(b.$.rows[k]),"tbody"==c.getParent().getName()&&(l=new POLARIS.dom.element(c.$.cells[0]),l.renameNode("td"),l.removeAttribute("scope"));if(d.txtHeight){if(k=parseInt(d.txtHeight),(m=x(b,"mm",!0))||(m=k),l=k/m,b.removeAttribute("height"),b.setStyle("height",d.txtHeight+a.lang.common.unitMm),1!=l)for(k=0,m=b.$.rows.length;k<m;k++)for(c=b.$.rows[k],q=0,p=c.cells.length;q<p;q++)r=new POLARIS.dom.element(c.cells[q]),n=x(r,"px")*l,r.setStyle("height",POLARIS.tools.cssLength(n))}else b.removeStyle("height");
(function(h){function e(h,b){if(b){var d;d=(d=y(h,"mm",!0))?parseInt(b)/d:1;h.removeAttribute("width");h.setStyle("width",b+a.lang.common.unitMm);if(d&&1!=d){var c=h.findOne("colgroup");if(c=c&&c.find("col")){var f=c.count(),k,g,l;for(k=0;k<f;k++)g=c.getItem(k),l=Math.round(POLARIS.plugins.tabletools.getColWidth(g)*d),g.setStyle("width",l+"px"),g.hasAttribute("width")&&g.removeAttribute("width")}k=h.$.rows;g=h.$.rows.length;for(var m,n,p,c=0;c<g;c++)for(l=k[c].cells,m=l.length,f=0;f<m;f++)n=new POLARIS.dom.element(l[f]),
p=y(n,"px")*d,n.setStyle("width",POLARIS.tools.cssLength(p))}}else h.removeStyle("width")}if(f){var d,c=f.length;for(d=0;d<c;d++)e(f[d],h)}else e(b,h)})(d.txtWidth);(function(a){if(f){var h,e=f.length;for(h=0;h<e;h++){var d=f[h];a?d.setAttribute("align",a):d.removeAttribute("align")}}else a?b.setAttribute("align",a):b.removeAttribute("align")})(d.cmbAlign);if(this._.selectedElement)b.removeAttribute("bgColor"),b.removeAttribute("border"),b.removeAttribute("borderColor");else for(b.setStyle("border-width",
"0px"),b.setStyle("border-color","#000000"),b.setStyle("border-style","solid"),k=0,m=b.$.rows.length;k<m;k++)for(c=b.$.rows[k],q=0,p=c.cells.length;q<p;q++)r=new POLARIS.dom.element(c.cells[q]),l=POLARIS.tools.cssLength("0.12mm"),r.setStyle("border-width",l),r.setStyle("border-color","#000000"),r.setStyle("border-style","solid");"yes"==d.tableLayout?b.setStyle("word-break","break-all"):b.removeStyle("word-break");b.getAttribute("style")||b.removeAttribute("style")}if(this._.selectedElement)try{h.selectBookmarks(e)}catch(D){}else a.insertElementWithBlockSplit(b)}},
contents:[{id:"info",label:a.lang.common.generalTab,elements:[{type:"hbox",styles:["vertical-align:top"],children:[{type:"text",id:"txtRows",width:"120px",maxLength:2,"default":3,label:a.lang.table.rows,required:!0,validate:v(a.lang.table.invalidRows,1,50),setup:function(a){this.setValue(a.$.rows.length)},commit:n},{type:"text",id:"txtCols",width:"120px",maxLength:2,"default":2,label:a.lang.table.columns,required:!0,validate:v(a.lang.table.invalidCols,1,50),setup:function(a){this.setValue(D(a))},
commit:n}]},{type:"hbox",widths:["35%","15%","35%","15%"],styles:["vertical-align:top"],children:[{type:"text",id:"txtWidth",maxLength:3,requiredContent:"table{width}",label:a.lang.common.width,"default":"",validate:function(){if(a.config.wordprocessor){var h=POLARIS.tools.getContentSizeToUnit(a,"mm").width,e=this.getValue(),e=!!(POLARIS.dialog.validate.integer()(e)&&1<=e&&e<h);e||(alert(a.lang.table.invalidWidth.replace("%1",h)),this.setValue(h-1),this.select());return e}return POLARIS.dialog.validate.number(a.lang.common.invalidWidth)},
onChange:function(){var a=this.getDialog().getContentElement("advanced","advStyles");a&&a.updateStyle("width",this.getValue())},setup:function(a){a=y(a,"mm",!0);this.setValue(a)},commit:n},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:a.lang.common.unitMm}]},{type:"text",id:"txtHeight",maxLength:3,requiredContent:"table{height}",label:a.lang.common.height,"default":"",validate:function(){if(a.config.wordprocessor){var h=POLARIS.tools.getContentSizeToUnit(a,"mm").height,e=
this.getValue(),e=!!(POLARIS.dialog.validate.integer()(e)&&1<=e&&e<h);e||(alert(a.lang.table.invalidHeight.replace("%1",h)),this.setValue(h-1),this.select());return e}return POLARIS.dialog.validate.number(a.lang.common.invalidHeight)},onChange:function(){var a=this.getDialog().getContentElement("advanced","advStyles");a&&a.updateStyle("height",this.getValue())},setup:function(a){a=x(a,"mm",!0);this.setValue(a)},commit:n},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:a.lang.common.unitMm}]}]},
{type:"hbox",styles:["vertical-align:top"],widths:["50%","35%","15%"],children:[{id:"cmbAlign",type:"select",requiredContent:"table[align]","default":"",label:a.lang.common.align,items:[[a.lang.common.alignLeft,""],[a.lang.common.alignCenter,"center"],[a.lang.common.alignRight,"right"]],setup:function(a){this.setValue(a.getAttribute("align")||"")},commit:n},{id:"cmbCellSpacing",type:"text",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer?!0:!1,requiredContent:"table[cellSpacing]",
maxLength:2,"default":"0",validate:v(a.lang.table.invalidCellSpacing,0,50),label:a.lang.table.cellSpacing,setup:function(a){this.setValue(parseFloat(a.getStyle("border-spacing"))||"0")},commit:n},{type:"vbox",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer?!0:!1,children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:a.lang.common.unitPt}]}]},{type:"hbox",styles:["vertical-align:top"],children:[{type:"select",hidden:!0,id:"selBorderWidth",width:"120px",requiredContent:"table[border]",
"default":a.lang.table.borderWidth[2][0],label:a.lang.table.border,items:[[a.lang.table.borderWidth[0][0],a.lang.table.borderWidth[0][1]],[a.lang.table.borderWidth[1][0],a.lang.table.borderWidth[1][1]],[a.lang.table.borderWidth[2][0],a.lang.table.borderWidth[2][1]],[a.lang.table.borderWidth[3][0],a.lang.table.borderWidth[3][1]],[a.lang.table.borderWidth[4][0],a.lang.table.borderWidth[4][1]],[a.lang.table.borderWidth[5][0],a.lang.table.borderWidth[5][1]],[a.lang.table.borderWidth[6][0],a.lang.table.borderWidth[6][1]],
[a.lang.table.borderWidth[7][0],a.lang.table.borderWidth[7][1]],[a.lang.table.borderWidth[8][0],a.lang.table.borderWidth[8][1]],[a.lang.table.borderWidth[9][0],a.lang.table.borderWidth[9][1]],[a.lang.table.borderWidth[10][0],a.lang.table.borderWidth[10][1]],[a.lang.table.borderWidth[11][0],a.lang.table.borderWidth[11][1]],[a.lang.table.borderWidth[12][0],a.lang.table.borderWidth[12][1]],[a.lang.table.borderWidth[13][0],a.lang.table.borderWidth[13][1]],[a.lang.table.borderWidth[14][0],a.lang.table.borderWidth[14][1]],
[a.lang.table.borderWidth[15][0],a.lang.table.borderWidth[15][1]],[a.lang.table.borderWidth[16][0],a.lang.table.borderWidth[16][1]]],setup:function(){},commit:function(){}},{id:"selBorderStyle",type:"select",hidden:!0,width:"120px",requiredContent:"table[border]","default":"solid",label:a.lang.table.tableBorderStyle,items:[[a.lang.table.borderStyle.border_none,"none"],[a.lang.table.borderStyle.border_dotted,"dotted"],[a.lang.table.borderStyle.border_dashed,"dashed"],[a.lang.table.borderStyle.border_solid,
"solid"],[a.lang.table.borderStyle.border_double,"double"]],setup:function(){},commit:function(){}}]},{type:"hbox",hidden:!0,styles:["vertical-align:top"],children:[{type:"html",id:"tableBgColor",html:'\x3cp style\x3d"height:16px;\x3e\x3cspan\x3e'+a.lang.table.tableBgColor+'\x3c/span\x3e\x3c/p\x3e\x3cdiv id\x3d"'+u+'"class\x3d"polaris_dialog_ui_colorpanel" style\x3d"width: 78px;"\x3e\x3c/div\x3e',setup:function(a){},commit:function(a){}},c?{type:"button",id:"tableBgColorChoose","class":"colorChooser",
label:a.lang.common.chooseColor,onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){a.getUIColorFromDialog(function(a){POLARIS.document.getById(u).setStyle("background-color",a)},this)}}:d,{type:"html",id:"tableBorderColor",html:'\x3cp style\x3d"height:16px;\x3e\x3cspan\x3e'+a.lang.table.tableBorderColor+'\x3c/span\x3e\x3c/p\x3e\x3cdiv id\x3d"'+t+'"class\x3d"polaris_dialog_ui_colorpanel" style\x3d"width: 78px; background-color: #000000"\x3e\x3c/div\x3e',
setup:function(a){},commit:function(a){}},c?{type:"button",id:"tableBorderColorChoose","class":"colorChooser",label:a.lang.common.chooseColor,onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){a.getUIColorFromDialog(function(a){POLARIS.document.getById(t).setStyle("background-color",a?a:"#000000")},this)}}:d]},{type:"hbox",id:"imagebox",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer||a.config.useImageBase64Encoding?!0:!1,children:[{id:"txtPath",
type:"text",style:"width: 172px;",label:a.lang.table.bgImage,required:!0,setup:function(a){a=a.getComputedStyle("background-image")||"";a="none"==a?"":a.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(a,h,d){return d});this.setValue(a)},commit:function(a,e){e.removeAttribute("background");var b=this.getValue();b?(b=b.replace(/ /g,"%20"),e.setStyle("background-image","url("+b+")")):e.removeStyle("background-image")}},{type:"vbox",filebrowser:"uploadButton",label:a.lang.image.upload,style:"width: 66px",
children:[{type:"file",id:"upload",style:"width:100%",hidden:!0,label:a.lang.image.btnUpload,size:38},{type:"fileButton",id:"uploadButton",style:"width:100%",filebrowser:"info:txtPath",label:a.lang.image.btnUpload,"for":["info","upload"]}]}]},{type:"select",id:"repeat",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer||a.config.useImageBase64Encoding?!0:!1,label:a.lang.table.repeatLabel,"default":"repeat",items:[[a.lang.table.notRepeat,"no-repeat"],[a.lang.table.repeat,"repeat"],
[a.lang.table.horizontalRepeat,"repeat-x"],[a.lang.table.verticalRepeat,"repeat-y"]],setup:function(a){a=a.getComputedStyle("background-repeat")||"";""==a?this.setValue("no-repeat"):this.setValue(a)},commit:function(a,e){var b=this.getValue();this.getDialog().getContentElement("info","txtPath").getValue()&&b?e.setStyle("background-repeat",b):e.removeStyle("background-repeat")}}]},{id:"advanced",hidden:!0,label:a.lang.common.advancedTab,elements:[{type:"select",id:"selHeaders",requiredContent:"th",
"default":"",label:a.lang.table.headers,items:[[a.lang.table.headersNone,""],[a.lang.table.headersRow,"row"],[a.lang.table.headersColumn,"col"],[a.lang.table.headersBoth,"both"]],setup:function(a){var e=this.getDialog();e.hasColumnHeaders=!0;for(var b=0;b<a.$.rows.length;b++){var d=a.$.rows[b].cells[0];if(d&&"th"!=d.nodeName.toLowerCase()){e.hasColumnHeaders=!1;break}}null!==a.$.tHead?this.setValue(e.hasColumnHeaders?"both":"row"):this.setValue(e.hasColumnHeaders?"col":"")},commit:n},{type:"radio",
id:"tableLayout",label:a.lang.table.tableLayout,"default":"yes",items:[[a.lang.table.fixed,"yes"],[a.lang.table.auto,"no"]],setup:function(a){"break-all"==a.getStyle("word-break")?this.setValue("yes"):this.setValue("no")},commit:function(a,e){var b=this.id;a.info||(a.info={});a.info[b]=this.getValue();"yes"==this.getValue()?e.setStyle("word-break","break-all"):e.removeStyle("word-break")}},{type:"text",id:"linkId",requiredContent:"table[id]",label:a.lang.common.id,setup:function(a){this.setValue(a.getAttribute("id"))},
commit:function(a,e){this.getValue()||this.isChanged()?e.setAttribute("id",this.getValue()):e.removeAttribute("id")}},{id:"cmbLangDir",type:"select",requiredContent:"table[dir]",label:a.lang.common.langDir,"default":"",items:[[a.lang.common.notSet,""],[a.lang.common.langDirLtr,"ltr"],[a.lang.common.langDirRtl,"rtl"]],setup:function(a){this.setValue(a.getAttribute("dir"))},commit:function(a,e){this.getValue()?e.setAttribute("dir",this.getValue()):e.removeAttribute("dir")}},{type:"text",id:"txtSummary",
requiredContent:"table[summary]",label:a.lang.table.summary,setup:function(a){this.setValue(a.getAttribute("summary")||"")},commit:function(a,e){this.getValue()?e.setAttribute("summary",this.getValue()):e.removeAttribute("summary")}},{type:"hbox",children:[{type:"text",id:"txtCaption",requiredContent:"caption",width:"181px",label:a.lang.table.caption,setup:function(a){this.enable();a=a.getElementsByTag("caption");if(0<a.count()){a=a.getItem(0);var e=a.getFirst(POLARIS.dom.walker.nodeType(POLARIS.NODE_ELEMENT));
e&&!e.equals(a.getBogus())?(this.disable(),this.setValue(a.getText())):(a=POLARIS.tools.trim(a.getText()),this.setValue(a))}},commit:function(d,e){if(this.isEnabled()){var b=this.getValue(),c=e.getElementsByTag("caption");if(b)0<c.count()?(c=c.getItem(0),c.setHtml("")):(c=new POLARIS.dom.element("caption",a.document),e.getChildCount()?c.insertBefore(e.getFirst()):c.appendTo(e)),c.append(new POLARIS.dom.text(b,a.document));else if(0<c.count())for(b=c.count()-1;0<=b;b--)c.getItem(b).remove()}}},{type:"vbox",
padding:0,children:[{type:"html",html:"\x26nbsp;"},{type:"checkbox",id:"chkCaption",style:"margin-top: 2px;","default":!0,label:a.lang.table.chkcaption,setup:function(a){a=a.getElementsByTag("caption");0<a.count()&&("none"==a.getItem(0).getStyle("display")?this.setValue(!1):this.setValue(!0))},commit:function(a,c){var b=c.getElementsByTag("caption");0<b.count()&&(b=b.getItem(0),0==this.getValue()?b.setStyle("display","none"):b.removeStyle("display"))}}]}]}]}]}}var n=function(a){var f=this.id;a.info||
(a.info={});a.info[f]=this.getValue()};POLARIS.dialog.add("table",function(a){return u(a,"table")});POLARIS.dialog.add("tableProperties",function(a){return u(a,"tableProperties")})})();