POLARIS.dialog.add("clickheredialog",function(d){function g(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute("doc-data-field")&&!a.is("td")}var h=d.lang.table,k=h.cell;return{title:d.lang.clickhere.label,minWidth:244,minHeight:80,resizable:POLARIS.DIALOG_RESIZE_NONE,contents:[{id:"info",label:d.lang.common.generalTab,accessKey:"I",elements:[{type:"vbox",children:[{type:"text",id:"cellField",width:"100%",label:k.cellField,"default":"",maxLength:100,setup:function(a){1!=d.config.editMode&&this.disable();
a&&(a=a.getAttribute("doc-data-field"),this.setValue(a))},commit:function(a){if(0!=this.isChanged()&&0!=this.isEnabled()){var c=this.getValue();null==c||0==c.length?(a.removeAttribute("doc-data-field"),a.removeAttribute("contentEditable")):a.setAttribute("doc-data-field",this.getValue())}}},{type:"checkbox",id:"cellFieldEditable",width:"100%",label:k.cellFieldEditable,"default":!1,validate:function(){if(1==this.getValue()){var a=this.getDialog().getContentElement("info","cellField").getValue();a&&
(a=a.replace(/^\s+|\s+$/gm,""));if(""==a)return alert(h.noFieldNameForFieldEditable),!1}return!0},setup:function(a){1!=d.config.editMode&&this.disable();a&&"true"==a.getAttribute("doc-data-field-editable")?this.setValue(!0):this.setValue(!1)},commit:function(a){0!=this.isChanged()&&0!=this.isEnabled()&&(0==a.hasAttribute("doc-data-field")?a.removeAttribute("doc-data-field-editable"):this.getValue()?a.setAttribute("doc-data-field-editable",!0):a.setAttribute("doc-data-field-editable",!1))}}]}]}],onShow:function(){var a=
d.getSelection(),a=(a=a&&a.getStartElement())&&a.getAscendant(g,!0);this.setupContent(a)},onOk:function(){var a=d.getSelection(),c=(a=a&&a.getStartElement())&&a.getAscendant(g,!0);if(null!=a)if(c)this.commitContent(c);else{var e=this.getContentElement("info","cellField").getValue(),b=this.getContentElement("info","cellFieldEditable").getValue(),c=new POLARIS.dom.element(POLARIS.env.ie&&8>=POLARIS.env.version?"div":"article");c.setAttribute("doc-data-field",e);c.setAttribute("doc-data-field-editable",
b);c.setAttribute("doc-data-field-position","both");1==d.config.editMode&&c.addClass("polarisClickHere");POLARIS.env.ie&&c.setStyle("ime-mode","active");var b=a.getStyle("line-height"),f=a.getStyle("font-family"),e=a.getStyle("font-size");if(null==b||0==b.length)b=1.6;null!=f&&0!=f.length||!d.config.documentFontFamily||(f=d.config.documentFontFamily);null!=e&&0!=e.length||!d.config.documentFontSize||(e=d.config.documentFontSize+"pt");null!=b&&0!=b.length||!d.config.documentLineHeight||(b=d.config.documentLineHeight);
b=""+("line-height: "+b+";")+("font-family: "+f+";");b+="font-size: "+e+";";e='\x3cp style\x3d"'+b+'"\x3e\x3cbr\x3e\x3c/p\x3e';c.setHtml(e);b=a.getAscendant("td td",!0);a=a.getAscendant("p",!0);b&&null==a?b.appendChild(c):a&&(c.insertAfter(a),(new POLARIS.dom.element.createFromHtml(e)).insertAfter(c))}}}});