POLARIS.dialog.add("cellProperties",function(c){function M(a,b){var d="",d=POLARIS.env.ie?String(b?a.$.clientWidth:a.getStyle("width")):b?a.getComputedStyle("width"):a.getStyle("width"),f=0;return f="mm"==d.replace(/[0-9|.]/g,"")?parseInt(d.replace(/[^0-9|.]/g,"")):POLARIS.tools.convertPxToMm(parseFloat(d))}function k(a){return function(b,d){for(var f=a(b[0],d),e=1;e<b.length;e++)if(a(b[e],d)!==f){f=null;break}"undefined"!=typeof f&&(this.setValue(f),POLARIS.env.gecko&&"select"==this.type&&!f&&(this.getInputElement().$.selectedIndex=
-1))}}function I(a,b,d){return function(){var f=this.getValue(),f=!!(POLARIS.dialog.validate.number()(f)&&f>=b&&f<d+1);f||(alert(a.replace("%1",d)),this.select());return f}}function J(a,b,d){if(null!=selectedTable&&void 0!=selectedTable){if(void 0==d||null==d)d=POLARIS.tools.buildTableMap(selectedTable);var f=POLARIS.plugins.tabletools.getCellIndex(a,d),e=parseInt(a.getAttribute("rowspan"),10)||1;a=parseInt(a.getAttribute("colspan"),10)||1;"rtl"==selectedTable.getAttribute("dir")&&("left"==b?b="right":
"right"==b&&(b="left"));var c,r,h,k;"left"==b&&(c=f[0],r=f[1]-1,h=c+e-1,k=r);"right"==b&&(c=f[0],r=f[1]+a,h=c+e-1,k=r);"top"==b&&(c=f[0]-1,r=f[1],h=c,k=r+a-1);"bottom"==b&&(c=f[0]+e,r=f[1],h=c,k=r+a-1);for(var f=[],g=0,l=d.length;g<l;g++)for(var u=d[g],m=0,v=u.length;m<v;m++)if(u[m]){var t=new POLARIS.dom.element(u[m]),n=POLARIS.plugins.tabletools.getCellIndex(t,d),p=n[0],n=n[1],w=parseInt(t.getAttribute("rowspan"),10)||1,x=parseInt(t.getAttribute("colspan"),10)||1;c<=p&&h>=p&&r<=n&&k>=n&&("left"==
b||"right"==b?e>=w&&f.push(t):("top"==b||"bottom"==b)&&a>=x&&f.push(t))}return f}}function K(a,b,d){if(0==x)return!0;if(null==selectedTable||void 0==selectedTable)return!1;var f=POLARIS.plugins.tabletools.getCellIndex(a,d);d=f[0];var f=f[1],e=parseInt(a.getAttribute("rowspan"),10)||1;a=parseInt(a.getAttribute("colspan"),10)||1;var c=POLARIS.plugins.tabletools.getDragStartCell(),r=POLARIS.plugins.tabletools.getDragEndCell(),h=POLARIS.plugins.tabletools.getSelectedCellsIndex(c,r),c=h[0],r=h[1],k=h[4],
h=h[5];"rtl"==selectedTable.getAttribute("dir")&&("left"==b?b="right":"right"==b&&(b="left"));var g=!1;"left"==b&&f==r&&(g=!0);"right"==b&&f+a-1==h&&(g=!0);"top"==b&&d==c&&(g=!0);"bottom"==b&&d+e-1==k&&(g=!0);return g}function H(){var a=POLARIS.plugins.tabletools.getSelectedCells(c.getSelection()),b=!0;if(1<a.length){var d=a[0],f=a[a.length-1],e=f.$.cellPosition[0]-d.$.cellPosition[0]+1,q=Math.floor(a.length/e);if(d.getStyle("border-left-style")+"|"+d.getStyle("border-top-style")!=f.getStyle("border-bottom-style")+
"|"+f.getStyle("border-right-style"))b=!1;else for(var g=1;g<a.length-1;g++){var h=a[g];if(h.getStyle("background-color")!=d.getStyle("background-color")){b=!1;break}else if(h.$.cellPosition[0]==d.$.cellPosition[0]&&h.$.cellPosition[1]==a[q-1].$.cellPosition[1]){if(h.getStyle("border-top-style")!=d.getStyle("border-top-style")||h.getStyle("border-right-style")!=d.getStyle("border-left-style")){b=!1;break}}else if(h.$.cellPosition[0]==d.$.cellPosition[0]){if(h.getStyle("border-top-style")!=d.getStyle("border-top-style")){b=
!1;break}}else if(h.$.cellPosition[0]==f.$.cellPosition[0]&&h.$.cellPosition[1]==a[(e-1)*q].$.cellPosition[1]){if(h.getStyle("border-bottom-style")!=f.getStyle("border-bottom-style")||h.getStyle("border-left-style")!=f.getStyle("border-right-style")){b=!1;break}}else if(h.$.cellPosition[0]==f.$.cellPosition[0]){if(h.getStyle("border-bottom-style")!=f.getStyle("border-bottom-style")){b=!1;break}}else if(h.$.cellPosition[0]>d.$.cellPosition[0]&&h.$.cellPosition[0]<f.$.cellPosition[0])if(h.$.cellPosition[1]==
d.$.cellPosition[1]){if(h.getStyle("border-left-style")!=d.getStyle("border-left-style")){b=!1;break}}else if(h.$.cellPosition[1]==f.$.cellPosition[1]&&h.getStyle("border-right-style")!=f.getStyle("border-right-style")){b=!1;break}}}return b}var N=c.lang.table,g=N.cell,l=c.lang.common,O=POLARIS.dialog.validate,x=POLARIS.plugins.tabletools.getIsApplyAsSingleCell(),P={type:"html",html:"\x26nbsp;"},Q=c.plugins.uicolor;objDialog=this;isBgColorChanged=isSetPreview=isSetBgColor=isSetBorderStyle=isSetBorderColor=
isSetBorderWidth=isSetContentEditable=!1;borderWidth=1;borderColor="#000000";borderStyle="solid";selectedTable=tableMap=null;var y="transparent",R=!1,z="",v="",A="",B="",n="",C="",D="",p="",E="",F="",w="",G="",m=POLARIS.tools.getNextId()+"_cellBgColorPanel",L=POLARIS.tools.getNextId()+"_cellBorderColorPanel";return{title:g.title,minWidth:244,minHeight:80,resizable:POLARIS.DIALOG_RESIZE_NONE,contents:[{id:"info",label:c.lang.common.generalTab,accessKey:"I",elements:[{type:"vbox",children:[{type:"hbox",
widths:["35%","15%","35%","15%"],children:[{type:"text",id:"width",label:l.width,validate:O.number(c.lang.common.invalidWidth),maxLength:3,setup:k(function(a){return parseFloat(M(a,!0)).toFixed(0)}),commit:function(a){},"default":""},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:c.lang.common.unitMm}]},{type:"text",id:"height",label:l.height,"default":"",maxLength:3,validate:O.number(g.invalidHeight),onLoad:function(){this.getInputElement()},setup:k(function(a){var b=parseFloat,
d="",d=POLARIS.env.ie?String(a.$.clientHeight):a.getComputedStyle("height");a=0;a="mm"==d.replace(/[0-9|.]/g,"")?parseInt(d.replace(/[^0-9|.]/g,"")):POLARIS.tools.convertPxToMm(parseFloat(d));return b(a).toFixed(0)}),commit:function(a){if(0!=this.isChanged()){var b=parseInt(this.getValue(),10);isNaN(b)?a.removeStyle("height"):a.setStyle("height",b+c.lang.common.unitMm);a.removeAttribute("height")}}},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:c.lang.common.unitMm}]}]},
{type:"hbox",widths:["50%","50%"],children:[{type:"select",id:"hAlign",label:g.hAlign,"default":"",items:[[l.notSet,""],[l.alignLeft,"left"],[l.alignCenter,"center"],[l.alignRight,"right"]],setup:k(function(a){var b=a.getAttribute("align");return a.getStyle("text-align")||b||""}),commit:function(a){if(0!=this.isChanged()){var b=this.getValue();b?a.setStyle("text-align",b):a.removeStyle("text-align");a.removeAttribute("align");a=a.find("p, li, table");var d,f=a.count();for(d=0;d<f;d++){var e=a.getItem(d);
e.is("p","li")?b?e.setStyle("text-align",b):e.removeStyle("text-align"):e.is("table")&&(b?"left"==b?e.removeAttribute("align"):e.setAttribute("align",b):e.removeAttribute("align"))}}}},{type:"select",id:"vAlign",label:g.vAlign,"default":"",items:[[l.notSet,""],[l.alignTop,"top"],[l.alignMiddle,"middle"],[l.alignBottom,"bottom"]],setup:k(function(a){var b=a.getAttribute("valign");a=a.getStyle("vertical-align");switch(a){case "top":case "middle":case "bottom":case "baseline":break;default:a=""}return a||
b||""}),commit:function(a){if(0!=this.isChanged()){var b=this.getValue();b?a.setStyle("vertical-align",b):a.removeStyle("vertical-align");a.removeAttribute("valign")}}}]},{type:"html",html:c.lang.table.cellPad},{type:"hbox",styles:["vertical-align:top"],children:[{type:"hbox",widths:["40%","40%","20%"],children:[{type:"html",html:c.lang.table.cellPadding.left},{type:"text",id:"txtCellPadLeft",maxLength:5,requiredContent:"td{padding-left}","default":"2",validate:I(c.lang.table.invalidCellPadding,0,
21),setup:k(function(a){a=a.getStyle("padding-left");return-1==a.indexOf("mm")?"0":parseFloat(a)+""}),commit:function(a){0!=this.isChanged()&&this.getValue()&&a.setStyle("padding-left",this.getValue()+c.lang.common.unitMm)}},{type:"html",html:c.lang.common.unitMm}]},{type:"hbox",widths:["40%","40%","20%"],children:[{type:"html",html:c.lang.table.cellPadding.top},{type:"text",id:"txtCellPadTop",maxLength:5,requiredContent:"td{padding-top}","default":"0",validate:I(c.lang.table.invalidCellPadding,0,
21),setup:k(function(a){a=a.getStyle("padding-top");return-1==a.indexOf("mm")?"0":parseFloat(a)+""}),commit:function(a){0!=this.isChanged()&&this.getValue()&&a.setStyle("padding-top",this.getValue()+c.lang.common.unitMm)}},{type:"html",html:c.lang.common.unitMm}]}]},{type:"hbox",styles:["vertical-align:top"],children:[{type:"hbox",widths:["40%","40%","20%"],children:[{type:"html",html:c.lang.table.cellPadding.right},{type:"text",id:"txtCellPadRight",maxLength:5,requiredContent:"td{padding-right}",
"default":"2",validate:I(c.lang.table.invalidCellPadding,0,21),setup:k(function(a){a=a.getStyle("padding-right");return-1==a.indexOf("mm")?"0":parseFloat(a)+""}),commit:function(a){0!=this.isChanged()&&this.getValue()&&a.setStyle("padding-right",this.getValue()+c.lang.common.unitMm)}},{type:"html",html:c.lang.common.unitMm}]},{type:"hbox",widths:["40%","40%","20%"],children:[{type:"html",html:c.lang.table.cellPadding.bottom},{type:"text",id:"txtCellPadBottom",maxLength:5,requiredContent:"td{padding-bottom}",
"default":"0",validate:I(c.lang.table.invalidCellPadding,0,21),setup:k(function(a){a=a.getStyle("padding-bottom");return-1==a.indexOf("mm")?"0":parseFloat(a)+""}),commit:function(a){0!=this.isChanged()&&this.getValue()&&a.setStyle("padding-bottom",this.getValue()+c.lang.common.unitMm)}},{type:"html",html:c.lang.common.unitMm}]}]}]}]},{id:"background",label:c.lang.label.label_cellBg,elements:[{type:"hbox",widths:["50%","50%"],children:[{type:"select",id:"selBorderWidth","default":c.lang.table.borderWidth[2][0],
label:g.borderWidth,items:[[c.lang.table.borderWidth[0][0],c.lang.table.borderWidth[0][1]],[c.lang.table.borderWidth[1][0],c.lang.table.borderWidth[1][1]],[c.lang.table.borderWidth[2][0],c.lang.table.borderWidth[2][1]],[c.lang.table.borderWidth[3][0],c.lang.table.borderWidth[3][1]],[c.lang.table.borderWidth[4][0],c.lang.table.borderWidth[4][1]],[c.lang.table.borderWidth[5][0],c.lang.table.borderWidth[5][1]],[c.lang.table.borderWidth[6][0],c.lang.table.borderWidth[6][1]],[c.lang.table.borderWidth[7][0],
c.lang.table.borderWidth[7][1]],[c.lang.table.borderWidth[8][0],c.lang.table.borderWidth[8][1]],[c.lang.table.borderWidth[9][0],c.lang.table.borderWidth[9][1]],[c.lang.table.borderWidth[10][0],c.lang.table.borderWidth[10][1]],[c.lang.table.borderWidth[11][0],c.lang.table.borderWidth[11][1]],[c.lang.table.borderWidth[12][0],c.lang.table.borderWidth[12][1]],[c.lang.table.borderWidth[13][0],c.lang.table.borderWidth[13][1]],[c.lang.table.borderWidth[14][0],c.lang.table.borderWidth[14][1]],[c.lang.table.borderWidth[15][0],
c.lang.table.borderWidth[15][1]],[c.lang.table.borderWidth[16][0],c.lang.table.borderWidth[16][1]]],setup:k(function(a,b){if(!isSetBorderWidth){if(H()){var d=a.getStyle("border-left-width"),f=a.getStyle("border-top-width"),e=a.getStyle("border-right-width"),q=a.getStyle("border-bottom-width");borderWidth=isNaN(parseFloat(d))?isNaN(parseFloat(f))?isNaN(parseFloat(e))?isNaN(parseFloat(q))?"0.12mm":q:e:f:d;if(borderWidth.replace(/[0-9|.]/g,"")!=c.lang.common.unitMm){d=borderWidth.replace(/[a-z]/g,"");
borderWidth=POLARIS.tools.convertPtToMm(d);borderWidth=borderWidth.toFixed(1)+c.lang.common.unitMm;d=[];for(values in c.lang.table.borderWidth)if(d.push(Number(c.lang.table.borderWidth[values][0].replace(/[a-z]/g,""))),c.lang.table.borderWidth[values][0]==borderWidth)return borderWidth;borderWidth=Number(borderWidth.replace(/[a-z]/g,""));e=-1;for(q=0;q<d.length;q++)if(f=d[q]-borderWidth,q+1<d.length&&Math.abs(d[q+1]-d[q])>Math.abs(f)){e=q;break}borderWidth=-1<e?d[e]+c.lang.common.unitMm:"0.12mm"}}else borderWidth=
"0.12mm";isSetBorderWidth=!0}return borderWidth}),onChange:function(a){a=this.getDialog().getContentElement("background","borderTop").getValue();var b=this.getDialog().getContentElement("background","borderBottom").getValue(),d=this.getDialog().getContentElement("background","borderLeft").getValue(),f=this.getDialog().getContentElement("background","borderRight").getValue(),e=this.getDialog().getContentElement("background","selBorderWidth").getValue(),e=POLARIS.tools.cssLength(e),c=POLARIS.document.getById("polaris_tablecell_preview");
1==a&&c.setStyle("border-top-width",e);1==b&&c.setStyle("border-bottom-width",e);1==d&&c.setStyle("border-left-width",e);1==f&&c.setStyle("border-right-width",e)},commit:function(a){}},{id:"selBorderStyle",type:"select","default":"",label:g.borderStyle,items:[[c.lang.table.borderStyle.border_none,"none"],[c.lang.table.borderStyle.border_solid,"solid"],[c.lang.table.borderStyle.border_double,"double"],[c.lang.table.borderStyle.border_dashed,"dashed"],[c.lang.table.borderStyle.border_dotted,"dotted"]],
setup:k(function(a,b){if(!isSetBorderStyle){if(H()){var d=a.getStyle("border-left-style"),f=a.getStyle("border-top-style"),e=a.getStyle("border-right-style"),c=a.getStyle("border-bottom-style");d&&"none"!=d?borderStyle=d:f&&"none"!=f?borderStyle=f:e&&"none"!=e?borderStyle=e:c&&"none"!=c&&(borderStyle=c);"solid"!=borderStyle&&"double"!=borderStyle&&"dashed"!=borderStyle&&"dotted"!=borderStyle&&(borderStyle="none");"none"==d&&"none"==e&&"none"==f&&"none"==c&&(borderStyle="none")}else borderStyle="solid";
isSetBorderStyle=!0}return borderStyle}),onChange:function(a){a=this.getDialog().getContentElement("background","borderTop").getValue();var b=this.getDialog().getContentElement("background","borderBottom").getValue(),d=this.getDialog().getContentElement("background","borderLeft").getValue(),c=this.getDialog().getContentElement("background","borderRight").getValue(),e=this.getDialog().getContentElement("background","selBorderStyle").getValue(),g=POLARIS.document.getById("polaris_tablecell_preview");
1==a&&g.setStyle("border-top-style",e);1==b&&g.setStyle("border-bottom-style",e);1==d&&g.setStyle("border-left-style",e);1==c&&g.setStyle("border-right-style",e)},commit:function(a){}}]},{type:"hbox",widths:["50%","50%"],children:[{type:"hbox",widths:["70%","30%"],children:[{type:"html",id:"bgColor",html:"\x3cspan\x3e"+g.bgColor+'\x3c/span\x3e\x3cdiv id\x3d"'+m+'"class\x3d"polaris_dialog_ui_colorpanel" style\x3d"width: 78px;"\x3e\x3c/div\x3e',setup:k(function(a,b){if(!isSetBgColor){var d=POLARIS.document.getById(m),
c=POLARIS.document.getById("polaris_tablecell_preview");if(H()){var e=a.getAttribute("bgColor");(y=a.getStyle("background-color")||e)?d.setStyle("background-color",y):d.removeStyle("background-color");y?c.setStyle("background-color",y):c.removeStyle("background-color")}else y=null,d.removeStyle("background-color"),c.removeStyle("background-color");isSetBgColor=!0}isBgColorChanged=!1;return y}),isChanged:function(){return isBgColorChanged},onChange:function(a){isBgColorChanged=!0},commit:function(a){if(0!=
this.isChanged()){var b=POLARIS.document.getById(m);value=this.getValue();this.getDialog().getContentElement("background","noBackgroundColor").getValue()&&(value=!1);value?a.setStyle("background-color",value):a.removeStyle("background-color");a.removeAttribute("bgColor");b.removeStyle("background-color")}}},Q?{type:"button",id:"bgColorChoose","class":"colorChooser",label:c.lang.common.chooseColor,onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){c.getUIColorFromDialog(function(a){if(!this.getDialog().getContentElement("background",
"noBackgroundColor").getValue()){POLARIS.document.getById(m).setStyle("background-color",a);this.getDialog().getContentElement("background","noBackgroundColor").getValue()||POLARIS.document.getById("polaris_tablecell_preview").setStyle("background-color",a);var b=this.getDialog().getContentElement("background","bgColor");b.setValue(a);b.onChange()}},this)}}:P]},{type:"hbox",widths:["70%","30%"],children:[{type:"html",id:"txtBorderColor",html:"\x3cspan\x3e"+g.borderColor+'\x3c/span\x3e\x3cdiv id\x3d"'+
L+'"class\x3d"polaris_dialog_ui_colorpanel" style\x3d"width: 78px; background-color: #000000"\x3e\x3c/div\x3e',setup:k(function(a,b){if(isSetBorderColor)borderColor=null;else{var d=POLARIS.document.getById(L),c=POLARIS.document.getById("polaris_tablecell_preview");if(H()){var e=a.getAttribute("borderColor");borderColor=a.getStyle("border-top-color")||e||"#000000"}else borderColor="#000000";d.setStyle("background-color",borderColor);c.setStyle("border-color",borderColor);isSetBorderColor=!0}return borderColor}),
isChanged:function(){return this.getValue()!=this.getInitValue()},getValue:function(){var a=POLARIS.document.getById(L).getStyle("background-color");return a?a:"#000000"},setInitValue:function(){this._.initValue=this.getValue()},getInitValue:function(){return this._.initValue},onChange:function(a){a=this.getDialog().getContentElement("background","borderTop").getValue();var b=this.getDialog().getContentElement("background","borderBottom").getValue(),d=this.getDialog().getContentElement("background",
"borderLeft").getValue(),c=this.getDialog().getContentElement("background","borderRight").getValue(),e=this.getDialog().getContentElement("background","txtBorderColor").getValue(),g=POLARIS.document.getById("polaris_tablecell_preview");1==a&&g.setStyle("border-top-color",e);1==b&&g.setStyle("border-bottom-color",e);1==d&&g.setStyle("border-left-color",e);1==c&&g.setStyle("border-right-color",e)},commit:function(a){}},Q?{type:"button",id:"borderColorChoose","class":"colorChooser",label:c.lang.common.chooseColor,
width:"100%",onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){c.getUIColorFromDialog(function(a){POLARIS.document.getById(L).setStyle("background-color",a?a:"#000000");this.getDialog().getContentElement("background","txtBorderColor").setValue(a?a:"#000000");this.getDialog().getContentElement("background","txtBorderColor").onChange()},this)}}:P]}]},{type:"checkbox",id:"noBackgroundColor","default":!1,label:N.noBackgroundColor,setup:function(a){return!1},
onChange:function(){if(this.getValue()){var a=POLARIS.document.getById("polaris_tablecell_preview");a.removeStyle("background-color");var b=POLARIS.document.getById(m);b.setStyle("background-color","")}else a=POLARIS.document.getById("polaris_tablecell_preview"),b=POLARIS.document.getById(m),b=b.getStyle("background-color"),a.setStyle("background-color",b)},onClick:function(){if(this.getValue()){var a=POLARIS.document.getById("polaris_tablecell_preview");a.removeStyle("background-color");var b=POLARIS.document.getById(m);
b.setStyle("background-color","")}else a=POLARIS.document.getById("polaris_tablecell_preview"),b=POLARIS.document.getById(m),b=b.getStyle("background-color"),a.setStyle("background-color",b)},commit:function(a){0!=this.isChanged()&&this.getValue()&&(a.removeStyle("background-color"),a.removeAttribute("bgColor"))}},{type:"hbox",id:"imagebox",hidden:x||c.config.useImageBase64Encoding,setup:function(a){this.hidden=x||c.config.useImageBase64Encoding;a=POLARIS.document.getById(this.domId);1==x||c.config.useImageBase64Encoding?
a.hide():a.show()},children:[{id:"txtPath",type:"text",style:"width: 172px;",label:c.lang.image.imagePath,required:!0,setup:k(function(a){a=a.getComputedStyle("background-image")||"";return a="none"==a?"":a.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(a,d,c){return c})}),commit:function(a){if(0!=this.isChanged()){var b=this.getValue();b?(b=b.replace(/ /g,"%20"),a.setStyle("background-image","url("+b+")"),a.setStyle("background-size","100% 100%")):a.removeStyle("background-image")}}},{type:"vbox",
filebrowser:"uploadButton",label:c.lang.image.upload,style:"width: 66px;",children:[{type:"file",id:"upload",style:"width:100%",hidden:!0,label:c.lang.image.btnUpload,size:38},{type:"fileButton",id:"uploadButton",style:"width:100%",filebrowser:"background:txtPath",label:c.lang.image.btnUpload,"for":["background","upload"]}]}]},{type:"vbox",children:[{type:"html",html:"\x3cp\x3e"+g.borderSelection+"\x3c/p\x3e"},{type:"vbox",style:"border: 1px solid #a0a2ab; border-radius: 2px; background-color: #fffeff; padding: 5px; height: 100%;",
textalign:"center",children:[{type:"html",html:'\x3cp style\x3d"text-align:center; vertical-align: middle;"\x3e'+g.borderSelectionInfo+"\x3c/p\x3e"},{type:"checkbox",id:"borderTop",label:"",onClick:function(){var a=POLARIS.document.getById("polaris_tablecell_preview"),b=this.getValue(),d=this.getDialog().getContentElement("background","txtBorderColor").getValue(),c=this.getDialog().getContentElement("background","selBorderStyle").getValue(),e=this.getDialog().getContentElement("background","selBorderWidth").getValue(),
e=POLARIS.tools.cssLength(e);0==b&&(d=z,c=v,e=A,e=POLARIS.tools.cssLength(e));if(POLARIS.env.chrome&&"#000000"==d||"rgb(0, 0, 0)"==d)d=null;a.setStyle("border-top-color",d);a.setStyle("border-top-style",c);a.setStyle("border-top-width",e)},commit:function(a){if(0!=K(a,"top",tableMap)&&1==this.getValue()){var b=this.getDialog().getContentElement("background","selBorderStyle").getValue(),d=this.getDialog().getContentElement("background","txtBorderColor").getValue(),c=this.getDialog().getContentElement("background",
"selBorderWidth").getValue(),e=POLARIS.tools.cssLength(c);0>=c?(a.removeStyle("border-top-style"),a.removeStyle("border-top-color"),a.removeStyle("border-top-width"),selectedTable.removeAttribute("border")):(a.setStyle("border-top-style",b),a.setStyle("border-top-color",d),a.setStyle("border-top-width",e),a.removeAttribute("borderColor"));topCells=J(a,"top",tableMap);for(a=0;a<topCells.length;a++)0>=c?(topCells[a]&&topCells[a].removeStyle("border-bottom-style"),topCells[a]&&topCells[a].removeStyle("border-bottom-color"),
topCells[a]&&topCells[a].removeStyle("border-bottom-width")):(topCells[a]&&topCells[a].setStyle("border-bottom-style",b),topCells[a]&&topCells[a].setStyle("border-bottom-color",d),topCells[a]&&topCells[a].setStyle("border-bottom-width",e))}}},{type:"hbox",verticalalign:"middle",widths:["50%","32px","50%"],children:[{type:"checkbox",id:"borderLeft",style:"float:right;",label:"",onClick:function(){var a=POLARIS.document.getById("polaris_tablecell_preview"),b=this.getValue(),d=this.getDialog().getContentElement("background",
"txtBorderColor").getValue(),c=this.getDialog().getContentElement("background","selBorderStyle").getValue(),e=this.getDialog().getContentElement("background","selBorderWidth").getValue(),e=POLARIS.tools.cssLength(e);0==b&&(d=D,c=p,e=E,e=POLARIS.tools.cssLength(e));if(POLARIS.env.chrome&&"#000000"==d||"rgb(0, 0, 0)"==d)d=null;a.setStyle("border-left-color",d);a.setStyle("border-left-style",c);a.setStyle("border-left-width",e)},commit:function(a){if(0!=K(a,"left",tableMap)&&1==this.getValue()){var b=
this.getDialog().getContentElement("background","selBorderStyle").getValue(),d=this.getDialog().getContentElement("background","txtBorderColor").getValue(),c=this.getDialog().getContentElement("background","selBorderWidth").getValue(),e=POLARIS.tools.cssLength(c);0>=c?(a.removeStyle("border-left-style"),a.removeStyle("border-left-color"),a.removeStyle("border-left-width"),selectedTable.removeAttribute("border")):(a.setStyle("border-left-style",b),a.setStyle("border-left-color",d),a.setStyle("border-left-width",
e),a.removeAttribute("borderColor"));leftCells=J(a,"left",tableMap);for(a=0;a<leftCells.length;a++)0>=c?(leftCells[a]&&leftCells[a].removeStyle("border-right-style"),leftCells[a]&&leftCells[a].removeStyle("border-right-color"),leftCells[a]&&leftCells[a].removeStyle("border-right-width")):(leftCells[a]&&leftCells[a].setStyle("border-right-style",b),leftCells[a]&&leftCells[a].setStyle("border-right-color",d),leftCells[a]&&leftCells[a].setStyle("border-right-width",e))}}},{id:"borderPriview",type:"html",
html:'\x3cdiv id\x3d"polaris_tablecell_preview" style\x3d"width: 32px; height: 32px;"\x3e\x3c/div\x3e',setup:k(function(a,b){if(!isSetPreview){var d=POLARIS.document.getById("polaris_tablecell_preview"),f=POLARIS.plugins.tabletools.getSelectedCells(c.getSelection()),e=f[0],f=f[f.length-1];1<b?H()?(D=e.getStyle("border-left-color"),p=e.getStyle("border-left-style"),E=e.getStyle("border-left-width"),z=e.getStyle("border-top-color"),v=e.getStyle("border-top-style"),A=e.getStyle("border-top-width"),F=
f.getStyle("border-right-color"),w=f.getStyle("border-right-style"),G=f.getStyle("border-right-width"),B=f.getStyle("border-bottom-color"),n=f.getStyle("border-bottom-style"),C=f.getStyle("border-bottom-width")):C=n=B=G=w=F=A=v=z=E=p=D="":(D=a.getStyle("border-left-color"),p=a.getStyle("border-left-style"),E=a.getStyle("border-left-width"),z=a.getStyle("border-top-color"),v=a.getStyle("border-top-style"),A=a.getStyle("border-top-width"),F=a.getStyle("border-right-color"),w=a.getStyle("border-right-style"),
G=a.getStyle("border-right-width"),B=a.getStyle("border-bottom-color"),n=a.getStyle("border-bottom-style"),C=a.getStyle("border-bottom-width"));""!=z?d.setStyle("border-top-color",z):d.removeStyle("border-top-color");""!=v&&"none"!=v?d.setStyle("border-top-style",v):d.removeStyle("border-top-style");""!=A?d.setStyle("border-top-width",A):d.removeStyle("border-top-width");""!=B?d.setStyle("border-bottom-color",B):d.removeStyle("border-bottom-color");""!=n&&"none"!=n?d.setStyle("border-bottom-style",
n):d.removeStyle("border-bottom-style");""!=C?d.setStyle("border-bottom-width",C):d.removeStyle("border-bottom-width");""!=D?d.setStyle("border-left-color",D):d.removeStyle("border-left-color");""!=p&&"none"!=p?d.setStyle("border-left-style",p):d.removeStyle("border-left-style");""!=E?d.setStyle("border-left-width",E):d.removeStyle("border-left-width");""!=F?d.setStyle("border-right-color",F):d.removeStyle("border-right-color");""!=w&&"none"!=w?d.setStyle("border-right-style",w):d.removeStyle("border-right-style");
""!=G?d.setStyle("border-right-width",G):d.removeStyle("border-right-width");d.removeAttribute("border");isSetPreview=!0}})},{type:"checkbox",id:"borderRight",style:"float:left;",label:"",onClick:function(){var a=POLARIS.document.getById("polaris_tablecell_preview"),b=this.getValue(),d=this.getDialog().getContentElement("background","txtBorderColor").getValue(),c=this.getDialog().getContentElement("background","selBorderStyle").getValue(),e=this.getDialog().getContentElement("background","selBorderWidth").getValue(),
e=POLARIS.tools.cssLength(e);0==b&&(d=F,c=w,e=G,e=POLARIS.tools.cssLength(e));if(POLARIS.env.chrome&&"#000000"==d||"rgb(0, 0, 0)"==d)d=null;a.setStyle("border-right-color",d);a.setStyle("border-right-style",c);a.setStyle("border-right-width",e)},commit:function(a){if(0!=K(a,"right",tableMap)&&1==this.getValue()){var b=this.getDialog().getContentElement("background","selBorderStyle").getValue(),d=this.getDialog().getContentElement("background","txtBorderColor").getValue(),c=this.getDialog().getContentElement("background",
"selBorderWidth").getValue(),e=POLARIS.tools.cssLength(c);0>=c?(a.removeStyle("border-right-style"),a.removeStyle("border-right-color"),a.removeStyle("border-right-width")):(a.setStyle("border-right-style",b),a.setStyle("border-right-color",d),a.setStyle("border-right-width",e),a.removeAttribute("borderColor"));rightCells=J(a,"right",tableMap);for(a=0;a<rightCells.length;a++)0>=c?(rightCells[a]&&rightCells[a].removeStyle("border-left-style"),rightCells[a]&&rightCells[a].removeStyle("border-left-color"),
rightCells[a]&&rightCells[a].removeStyle("border-left-width")):(rightCells[a]&&rightCells[a].setStyle("border-left-style",b),rightCells[a]&&rightCells[a].setStyle("border-left-color",d),rightCells[a]&&rightCells[a].setStyle("border-left-width",e))}}}]},{type:"checkbox",id:"borderBottom",label:"",onClick:function(){var a=POLARIS.document.getById("polaris_tablecell_preview"),b=this.getValue(),d=this.getDialog().getContentElement("background","txtBorderColor").getValue(),c=this.getDialog().getContentElement("background",
"selBorderStyle").getValue(),e=this.getDialog().getContentElement("background","selBorderWidth").getValue(),e=POLARIS.tools.cssLength(e);0==b&&(d=B,c=n,e=C,e=POLARIS.tools.cssLength(e));if(POLARIS.env.chrome&&"#000000"==d||"rgb(0, 0, 0)"==d)d=null;a.setStyle("border-bottom-color",d);a.setStyle("border-bottom-style",c);a.setStyle("border-bottom-width",e)},commit:function(a){if(0!=K(a,"bottom",tableMap)&&1==this.getValue()){var b=this.getDialog().getContentElement("background","selBorderStyle").getValue(),
c=this.getDialog().getContentElement("background","txtBorderColor").getValue(),f=this.getDialog().getContentElement("background","selBorderWidth").getValue(),e=POLARIS.tools.cssLength(f);0>=f?(a.removeStyle("border-bottom-style"),a.removeStyle("border-bottom-color"),a.removeStyle("border-bottom-width"),selectedTable.removeAttribute("border")):(a.setStyle("border-bottom-style",b),a.setStyle("border-bottom-color",c),a.setStyle("border-bottom-width",e),a.removeAttribute("borderColor"));bottomCells=J(a,
"bottom",tableMap);for(a=0;a<bottomCells.length;a++)0>=f?(bottomCells[a]&&bottomCells[a].removeStyle("border-top-style"),bottomCells[a]&&bottomCells[a].removeStyle("border-top-color"),bottomCells[a]&&bottomCells[a].removeStyle("border-top-width")):(bottomCells[a]&&bottomCells[a].setStyle("border-top-style",b),bottomCells[a]&&bottomCells[a].setStyle("border-top-color",c),bottomCells[a]&&bottomCells[a].setStyle("border-top-width",e))}}}]}]}]},{id:"advanced",label:c.lang.common.advancedTab,elements:[{type:"radio",
id:"cellType",hidden:!0,label:g.cellType,"default":"td",items:[[g.data,"td"],[g.header,"th"]],setup:k(function(a){return a.getName()}),commit:function(a){0!=this.isChanged()&&a.renameNode(this.getValue())}},{type:"radio",id:"contentEditable",label:g.cellLock,"default":"no",items:[[g.yes,"yes"],[g.no,"no"]],setup:k(function(a){return"false"==a.getAttribute("contentEditable")?"yes":"no"}),commit:function(a){if(0!=this.isChanged())if("yes"==this.getValue()){isSetContentEditable=!0;if(POLARIS.env.ie){var b;
b='\x3cdiv style\x3d"width:100%;" unselectable\x3d"on" contentEditable\x3d"false" doc-data-protected\x3d"true"\x3e'+a.$.innerHTML+"\x3c/div\x3e";a.$.innerHTML=b;c.getSelection().removeAllRanges()}a.setAttribute("contentEditable","false");a.setAttribute("doc-data-protected","true")}else POLARIS.env.ie&&(b=a.getFirst())&&"DIV"==b.$.nodeName&&(a.$.innerHTML=b.$.innerHTML),a.removeAttribute("contentEditable"),a.removeAttribute("doc-data-protected","false")}},{type:"vbox",children:[{type:"text",id:"cellField",
width:"100%",label:g.cellField,"default":"",maxLength:100,setup:k(function(a){var b=a.findOne("[doc-data-field]");return b?b.getAttribute("doc-data-field"):a.getAttribute("doc-data-field")}),commit:function(a){if(0!=this.isChanged()){var b=a.findOne("[doc-data-field]");a=b?b:a;b=this.getValue();null==b||0==b.length?(a.removeAttribute("doc-data-field"),a.removeAttribute("contentEditable")):a.setAttribute("doc-data-field",this.getValue())}}},{type:"checkbox",id:"cellFieldEditable",width:"100%",label:g.cellFieldEditable,
"default":!1,validate:function(){if(1==this.getValue()){var a=this.getDialog().getContentElement("advanced","cellField").getValue();a&&(a=a.replace(/^\s+|\s+$/gm,""));if(""==a)return alert(N.noFieldNameForFieldEditable),!1}return!0},setup:k(function(a){var b=a.findOne("[doc-data-field]");return"true"==(b?b:a).getAttribute("doc-data-field-editable")?!0:!1}),commit:function(a){if(0!=this.isChanged()){var b=a.findOne("[doc-data-field]");a=b?b:a;0==a.hasAttribute("doc-data-field")?a.removeAttribute("doc-data-field-editable"):
this.getValue()?a.setAttribute("doc-data-field-editable",!0):a.setAttribute("doc-data-field-editable",!1)}}}]}]}],onShow:function(){x=POLARIS.plugins.tabletools.getIsApplyAsSingleCell();var a=POLARIS.plugins.tabletools.getIsApplyForEachCell();(x||a)&&this.selectPage("background");this.cells=POLARIS.plugins.tabletools.getSelectedCells(this._.editor.getSelection());this.setupContent(this.cells,this.cells.length);selectedTable=this.cells[0].getAscendant("table",1);tableMap=POLARIS.tools.buildTableMap(selectedTable);
R=1<this.cells.length?!0:!1;var a=this.getContentElement("advanced","cellField"),b=this.getContentElement("advanced","cellFieldEditable");1==c.config.editMode||2==c.config.editMode?(a&&a.enable(),b&&b.enable()):(a&&a.disable(),b&&b.disable())},onOk:function(){isSetPreview=isSetBgColor=isSetBorderStyle=isSetBorderColor=isSetBorderWidth=!1;var a=this.cells;selectedTable.hide();for(var b={},d=this.getContentElement("info","width"),f=a.length,e=0;e<f;e++)this.commitContent(a[e]),b[POLARIS.plugins.tabletools.getCellIndex(a[e],
u)[1]]=1;if(1==d.isChanged()){var g=[];if(selectedTable.hasAttribute("doc-data-value")&&"polaris-table-paginated"==selectedTable.getAttribute("doc-data-role"))for(var k=selectedTable.getAttribute("doc-data-value"),k=selectedTable.getAscendant("body",1).find('table[doc-data-value\x3d"'+k+'"]'),e=0;e<k.count();e++)g.push(k.getItem(e));else g.push(selectedTable);for(var d=parseFloat(d.getValue()).toFixed(0),k=POLARIS.tools.convertMmTopx(d),h=null,n=g.length,m=0;m<n;m++){var l=g[m],u=POLARIS.tools.buildTableMap(l),
p;for(p in b){if(e=l.findOne("colgroup"))e=e.find("col").getItem(p),e.setStyle("width",k),e.hasAttribute("width")&&e.removeAttribute("width");for(var e=0,v=u.length;e<v;e++){var t=u[e][p];t&&(t=new POLARIS.dom.element(t),null==h&&(h=parseFloat(M(t,!0)).toFixed(0)),isNaN(d)?t.removeStyle("width"):t.setStyle("width",POLARIS.tools.cssLength(k)),t.removeAttribute("width"))}}u=h-d;e=parseFloat(M(l,!0));u=POLARIS.tools.convertMmTopx(e-u);l.setStyle("width",POLARIS.tools.cssLength(u))}}b=c.document.getSelection();
POLARIS.plugins.tabletools.isTableSelected(b)&&(selectedTable.removeStyle("background-color"),selectedTable.removeAttribute("bgcolor"),selectedTable.setStyle("border-width","0px"),selectedTable.setStyle("border-color","#000000"),selectedTable.setStyle("border-style","solid"),selectedTable.removeAttribute("border"));POLARIS.plugins.tabletools.clearSelectedCell();for(e=0;e<f;e++)delete a[e].$.cellPosition;selectedTable.show();isSetContentEditable||(b=this._.editor.getSelection(),a=b.createBookmarks(),
this._.editor.forceNextSelectionCheck(),b.selectBookmarks(a),this._.editor.selectionChange());this._.editor.fire("tableresize")},onLoad:function(){var a={};this.foreach(function(b){b.setup&&b.commit&&(b.setup=POLARIS.tools.override(b.setup,function(c){return function(){c.apply(this,arguments);a[b.id]=b.getValue()}}),b.commit=POLARIS.tools.override(b.commit,function(c){return function(){(a[b.id]!==b.getValue()||R)&&c.apply(this,arguments)}}))})},onCancel:function(){isSetPreview=isSetBgColor=isSetBorderStyle=
isSetBorderColor=isSetBorderWidth=!1}}});