/*
 Copyright (c) 2014-2018 INFRAWARE, Inc. All rights reserved.

 homepage: www.infraware-global.com

 We make no express warranties, oral or written, to you regarding the software and that the software is being provided to you 'as is' without warranty of any kind. We disclaim any and all other warranties, whether expressed, implied, or statutory. Your rights may vary depending on the state in which you live. We shall not be liable for indirect, incidental, special, cover, reliance, or consequential damages resulting from the use of this product.
 You use this program solely at your own risk. In no event shall we be liable to you for any damages, including but not limited to any loss, or other incidental, indirect or consequential damages of any kind arising out of the use of the software, even if we have been advised of the possibility of such damages. In no event will we be liable for any claim, whether in contract, tort, or any other theory of liability, exceed the cost of the software. This limitation shall apply to claims of personal injury to the extent permitted by law.
*/
(function(){function Fa(a,e){POLARIS.tools.extend(this,e,{editor:a,id:POLARIS.tools.getNextId(),area:a._.notificationArea});e.type||(this.type="info");this.element=this._createElement()}function wa(a){var e=this;this.editor=a;this.notifications=[];this.element=this._createElement();this._uiBuffer=POLARIS.tools.eventsBuffer(10,this._layout,this);this._changeBuffer=POLARIS.tools.eventsBuffer(500,this._layout,this);a.on("destroy",function(){e._removeListeners();e.element.remove()})}if(!window.POLARIS||
!window.POLARIS.dom){window.POLARIS||(window.POLARIS=function(){var a=/(^|.*[\\\/])polaris\.js(?:\?.*|;.*)?$/i,e={timestamp:"IAF0",version:"7.1.0",revision:"6384",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:a},status:"unloaded",basePath:function(){var d=window.POLARIS_BASEPATH||"";if(!d)for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++){var e=b[c].src.match(a);if(e){d=e[1];break}}-1==d.indexOf(":/")&&"//"!=d.slice(0,2)&&(d=0===d.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+
d:location.href.match(/^[^\?]*\/(?:)/)[0]+d);if(!d)throw'The POLARISEditor installation path could not be automatically detected. Please set the global variable "POLARIS_BASEPATH" before creating editor instances.';return d}(),getUrl:function(a){-1==a.indexOf(":/")&&0!==a.indexOf("/")&&(a=this.basePath+a);this.timestamp&&"/"!=a.charAt(a.length-1)&&!/[&?]t=/.test(a)&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"t\x3d"+this.timestamp);return a},domReady:function(){function a(){try{document.addEventListener?
(document.removeEventListener("DOMContentLoaded",a,!1),b()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),b())}catch(c){}}function b(){for(var a;a=c.shift();)a()}var c=[];return function(b){function h(){try{document.documentElement.doScroll("left")}catch(b){setTimeout(h,1);return}a()}c.push(b);"complete"===document.readyState&&setTimeout(a,1);if(1==c.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",
a,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",a);b=!1;try{b=!window.frameElement}catch(e){}document.documentElement.doScroll&&b&&h()}}}()},b=window.POLARIS_GETURL;if(b){var c=e.getUrl;e.getUrl=function(a){return b.call(e,a)||c.call(e,a)}}return e}());POLARIS.event||(POLARIS.event=function(){},POLARIS.event.implementOn=function(a){var e=POLARIS.event.prototype,b;for(b in e)null==a[b]&&(a[b]=e[b])},POLARIS.event.prototype=function(){function a(a){var d=
e(this);return d[a]||(d[a]=new b(a))}var e=function(a){a=a.getPrivate&&a.getPrivate()||a._||(a._={});return a.events||(a.events={})},b=function(a){this.name=a;this.listeners=[];this.lock=!1};b.prototype={getListenerIndex:function(a){for(var d=0,b=this.listeners;d<b.length;d++)if(b[d].fn==a)return d;return-1}};return{define:function(b,d){var h=a.call(this,b);POLARIS.tools.extend(h,d,!0)},on:function(b,d,h,g,e){function f(a,m,p,e){a={name:b,sender:this,editor:a,data:m,listenerData:g,stop:p,cancel:e,
removeListener:l};return!1===d.call(h,a)?!1:a.data}function l(){n.removeListener(b,d)}var m=a.call(this,b);if(0>m.getListenerIndex(d)){m=m.listeners;h||(h=this);isNaN(e)&&(e=10);var n=this;f.fn=d;f.priority=e;for(var q=m.length-1;0<=q;q--)if(m[q].priority<=e)return m.splice(q+1,0,f),{removeListener:l};m.unshift(f)}return{removeListener:l}},once:function(){var a=Array.prototype.slice.call(arguments),d=a[1];a[1]=function(a){a.removeListener();return d.apply(this,arguments)};return this.on.apply(this,
a)},capture:function(){POLARIS.event.useCapture=1;var a=this.on.apply(this,arguments);POLARIS.event.useCapture=0;return a},fire:function(){var a=0,d=function(){a=1},b=0,g=function(){b=1};return function(k,f,l){var m=e(this)[k];k=a;var n=b;a=b=0;if(m&&!1===m.lock){var q=m.listeners;if(q.length)for(var q=q.slice(0),v,r=0;r<q.length;r++){if(m.errorProof)try{v=q[r].call(this,l,f,d,g)}catch(p){}else v=q[r].call(this,l,f,d,g);!1===v?b=1:"undefined"!=typeof v&&(f=v);if(a||b)break}}f=b?!1:"undefined"==typeof f?
!0:f;a=k;b=n;return f}}(),fireOnce:function(a,d,b){d=this.fire(a,d,b);delete e(this)[a];return d},removeListener:function(a,d){var b=e(this)[a];if(b){var g=b.getListenerIndex(d);0<=g&&b.listeners.splice(g,1)}},removeAllListeners:function(){var a=e(this),d;for(d in a)delete a[d]},hasListeners:function(a){return(a=e(this)[a])&&0<a.listeners.length},lockEvent:function(a){e(this)[a].lock=!0},unlockEvent:function(a){e(this)[a].lock=!1}}}());POLARIS.editor||(POLARIS.editor=function(){POLARIS._.pending.push([this,
arguments]);POLARIS.event.call(this)},POLARIS.editor.prototype.fire=function(a,e){a in{instanceReady:1,loaded:1}&&(this[a]=!0);return POLARIS.event.prototype.fire.call(this,a,e,this)},POLARIS.editor.prototype.fireOnce=function(a,e){a in{instanceReady:1,loaded:1}&&(this[a]=!0);return POLARIS.event.prototype.fireOnce.call(this,a,e,this)},POLARIS.event.implementOn(POLARIS.editor.prototype));POLARIS.env||(POLARIS.env=function(){var a=navigator.userAgent.toLowerCase(),e={ie:-1<a.indexOf("trident/"),webkit:-1<
a.indexOf(" applewebkit/"),air:-1<a.indexOf(" adobeair/"),mac:-1<a.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode&&(!document.documentMode||10>document.documentMode),mobile:-1<a.indexOf("mobile"),iOS:/(ipad|iphone|ipod)/.test(a),isCustomDomain:function(){if(!this.ie)return!1;var a=document.domain,b=window.location.hostname;return a!=b&&a!="["+b+"]"},secure:"https:"==location.protocol};e.gecko="Gecko"==navigator.product&&!e.webkit&&!e.ie;e.webkit&&(-1<a.indexOf("chrome")?e.chrome=!0:
e.safari=!0);var b=0;e.ie&&(b=e.quirks||!document.documentMode?parseFloat(a.match(/msie (\d+)/)[1]):document.documentMode,e.ie9Compat=9==b,e.ie8Compat=8==b,e.ie7Compat=7==b,e.ie6Compat=7>b||e.quirks);if(e.gecko){var c=a.match(/rv:([\d\.]+)/);c&&(c=c[1].split("."),b=1E4*c[0]+100*(c[1]||0)+1*(c[2]||0))}e.air&&(b=parseFloat(a.match(/ adobeair\/(\d+)/)[1]));e.webkit&&(b=parseFloat(a.match(/ applewebkit\/(\d+)/)[1]));e.chrome&&(b=parseFloat(a.match(/ chrome\/(\d+)/)[1]));e.version=b;e.isCompatible=e.iOS&&
534<=b||!e.mobile&&(e.ie&&8<b||e.gecko&&2E4<=b||e.air&&1<=b||e.webkit&&522<=b||e.chrome&&49<=b||!1);e.hidpi=2<=window.devicePixelRatio;e.needsBrFiller=e.gecko||e.webkit||e.ie&&10<b;e.needsNbspFiller=e.ie&&11>b;e.cssClass="polaris_browser_"+(e.ie?"ie":e.gecko?"gecko":e.webkit?"webkit":"unknown");e.quirks&&(e.cssClass+=" polaris_browser_quirks");e.ie&&(e.cssClass+=" polaris_browser_ie"+(e.quirks?"6 polaris_browser_iequirks":e.version));e.air&&(e.cssClass+=" polaris_browser_air");e.iOS&&(e.cssClass+=
" polaris_browser_ios");e.hidpi&&(e.cssClass+=" polaris_hidpi");return e}());"unloaded"==POLARIS.status&&function(){POLARIS.event.implementOn(POLARIS);POLARIS.loadFullCore=function(){if("basic_ready"!=POLARIS.status)POLARIS.loadFullCore._load=1;else{delete POLARIS.loadFullCore;var a=document.createElement("script");a.type="text/javascript";a.src=POLARIS.basePath+"polaris.js";document.getElementsByTagName("head")[0].appendChild(a)}};POLARIS.loadFullCoreTimeout=0;POLARIS.add=function(a){(this._.pending||
(this._.pending=[])).push(a)};(function(){POLARIS.domReady(function(){var a=POLARIS.loadFullCore,e=POLARIS.loadFullCoreTimeout;a&&(POLARIS.status="basic_ready",a&&a._load?a():e&&setTimeout(function(){POLARIS.loadFullCore&&POLARIS.loadFullCore()},1E3*e))})})();POLARIS.status="basic_loaded"}();POLARIS.dom={};window.POLARIS||(window.POLARIS=function(){var a=/(^|.*[\\\/])polaris\.js(?:\?.*|;.*)?$/i,e={timestamp:"IAF0",version:"7.1.0",revision:"6384",rnd:Math.floor(900*Math.random())+100,_:{pending:[],
basePathSrcPattern:a},status:"unloaded",basePath:function(){var d=window.POLARIS_BASEPATH||"";if(!d)for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++){var e=b[c].src.match(a);if(e){d=e[1];break}}-1==d.indexOf(":/")&&"//"!=d.slice(0,2)&&(d=0===d.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+d:location.href.match(/^[^\?]*\/(?:)/)[0]+d);if(!d)throw'The POLARISEditor installation path could not be automatically detected. Please set the global variable "POLARIS_BASEPATH" before creating editor instances.';
return d}(),getUrl:function(a){-1==a.indexOf(":/")&&0!==a.indexOf("/")&&(a=this.basePath+a);this.timestamp&&"/"!=a.charAt(a.length-1)&&!/[&?]t=/.test(a)&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"t\x3d"+this.timestamp);return a},domReady:function(){function a(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",a,!1),b()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),b())}catch(c){}}function b(){for(var a;a=c.shift();)a()}
var c=[];return function(b){function h(){try{document.documentElement.doScroll("left")}catch(b){setTimeout(h,1);return}a()}c.push(b);"complete"===document.readyState&&setTimeout(a,1);if(1==c.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",a);b=!1;try{b=!window.frameElement}catch(e){}document.documentElement.doScroll&&b&&
h()}}}()},b=window.POLARIS_GETURL;if(b){var c=e.getUrl;e.getUrl=function(a){return b.call(e,a)||c.call(e,a)}}return e}());POLARIS.version="7.1.0";POLARIS.revision="6384";POLARIS.build="$WCREV$";POLARIS.ENTER_P=1;POLARIS.ENTER_BR=2;POLARIS.ENTER_DIV=3;POLARIS.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:POLARIS.ENTER_P,forceEnterMode:!1,shiftEnterMode:POLARIS.ENTER_BR,docType:"\x3c!DOCTYPE html\x3e",bodyId:"",bodyClass:"",
fullPage:!0,height:200,width:"",plugins:"dialogui,dialog,wysiwygarea,toolbar,newpage,save,print,templates,clipboard,pastefromword,pastetext,undo,link,image,imageresize,flash,iframe,symbol,horizontalrule,find,selectall,maximize,tabletools,tableresize,showborders,justify,indent,indentblock,indentlist,basicstyles,list,liststyle,font,lineutils,colorbutton,removeformat,preview,sourcearea,tab,a11yhelp,about,div,stylescombo,forms,pagebreak,scayt,specialchar,blockquote,showblocks,bidi,table,smiley,quicktable,button,panelbutton,panel,floatpanel,menu,contextmenu,enterkey,entities,popup,filebrowser,fakeobjects,floatingspace,listblock,menubutton,sharedspace,pagelayout,format,paragraphmargins,bgimage,htmlwriter,floating-tools,uicolor",
extraPlugins:"simpleuploads,ajax,xml,pagination,documentconvert,elementspath,ruler,textbutton,ribbon,menubar,inserttime,titlebar,saveas,quickaccesstoolbar,changecase,edit,zoom,grid,rubytext,paragraphline,movement,caption,blockcalculation,objectattribute,documentinfo,spellingcheck,notification,notificationaggregator,magicline,aes,license,objectresize,pubdocbody,clickhere,externalmedia,autogrow,inputmethod",removePlugins:"",skin:"polaris",allowedContent:!0,toolbarCanCollapse:!0,toolbarStartupExpanded:!0,
qatoolbarCanCollapse:!0,qatoolbarStartupExpanded:!0,ribbonCanCollapse:!0,ribbonStartupExpanded:!0,showRibbon:!0,showQuickAccessToolbar:!0,menubarCanCollapse:!0,menubarStartupExpanded:!0,showMenubar:!0,pasteFromWordRemoveFontStyles:!1,pasteFromWordRemoveStyles:!1,showTitlebar:!0,showToolbar:!0,editMode:1,protectedSource:[],tabIndex:0,baseFloatZIndex:1E4,blockedKeystrokes:[POLARIS.CTRL+66,POLARIS.CTRL+73,POLARIS.CTRL+85,POLARIS.ALT+POLARIS.SHIFT+66,POLARIS.ALT+POLARIS.SHIFT+73,POLARIS.ALT+POLARIS.SHIFT+
85,116,9,POLARIS.SHIFT+9,POLARIS.CTRL+65,POLARIS.CTRL+13,POLARIS.CTRL+74,POLARIS.CTRL+POLARIS.SHIFT+77,POLARIS.CTRL+POLARIS.SHIFT+76,POLARIS.CTRL+POLARIS.SHIFT+82,POLARIS.CTRL+POLARIS.SHIFT+67,POLARIS.ALT+POLARIS.SHIFT+69,POLARIS.ALT+POLARIS.SHIFT+82,POLARIS.CTRL+219,POLARIS.CTRL+221,POLARIS.ALT+POLARIS.SHIFT+87,POLARIS.ALT+POLARIS.SHIFT+78,POLARIS.ALT+POLARIS.SHIFT+70,POLARIS.ALT+POLARIS.SHIFT+71,POLARIS.ALT+POLARIS.SHIFT+90,POLARIS.ALT+POLARIS.SHIFT+65,POLARIS.CTRL+POLARIS.SHIFT+87,POLARIS.CTRL+
POLARIS.SHIFT+81,POLARIS.CTRL+121,POLARIS.CTRL+POLARIS.ALT+116,POLARIS.CTRL+POLARIS.SHIFT+69,POLARIS.CTRL+POLARIS.ALT+117,POLARIS.CTRL+POLARIS.SHIFT+71,POLARIS.CTRL+POLARIS.ALT+118,POLARIS.CTRL+POLARIS.SHIFT+68,POLARIS.CTRL+POLARIS.ALT+119,POLARIS.CTRL+POLARIS.SHIFT+70,POLARIS.CTRL+118,POLARIS.CTRL+119,POLARIS.ALT+76,POLARIS.CTRL+POLARIS.SHIFT+45,POLARIS.CTRL+POLARIS.SHIFT+46,POLARIS.CTRL+116,POLARIS.CTRL+117,POLARIS.CTRL+POLARIS.SHIFT+79,POLARIS.CTRL+POLARIS.SHIFT+73,POLARIS.CTRL+13,POLARIS.ALT+
37,POLARIS.ALT+38,POLARIS.ALT+39,POLARIS.ALT+40]};POLARIS.subrevision="6413";(function(){var a=[],e=POLARIS.env.gecko?"-moz-":POLARIS.env.webkit?"-webkit-":POLARIS.env.ie?"-ms-":"",b=/&/g,c=/>/g,d=/</g,h=/"/g,g=/'/g,k=/&amp;/g,f=/&gt;/g,l=/&lt;/g,m=/&quot;/g,n=/&#39;/g,q=/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,v=/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi;POLARIS.on("reset",function(){a=[]});POLARIS.ElapseTime=function(){this.start=new Date;this.reset=function(){this.start=new Date};this.elapse=
function(){return(new Date).getTime()-this.start.getTime()+" ms"}};POLARIS.getVersionString=function(){return POLARIS.version+"."+POLARIS.revision+(POLARIS.subrevision?"."+POLARIS.subrevision:"")};POLARIS.log=function(){function a(d){this.type=d;this.enable=!1;a.prototype.log=function(){if(this.enable){var a=Array.prototype.slice.call(arguments);a.unshift(g.getTimeStamp()+m+"["+this.type+"]");"unknown"!=typeof console.log.apply&&console.log.apply(console,a)}};a.bind=function(a){return function(){a.log.apply(a,
arguments)}}}function d(){var b={api:new a("api"),docconv:new a("docconv"),core:new a("core"),plugin:new a("plugin"),debug:new a("debug")};d.prototype.enable=function(a){b[a]&&(b[a].enable=!0)};d.prototype.disable=function(a){b[a]&&(b[a].enable=!1)};d.prototype.isEnable=function(a){return b[a]&&b[a].enable};this.tools=g;this.api=a.bind(b.api);this.docconv=a.bind(b.docconv);this.core=a.bind(b.core);this.plugin=a.bind(b.plugin);this.debug=a.bind(b.debug)}var b=POLARIS.env.ie?"ie":POLARIS.env.chrome?
"chrome":"",c=POLARIS.env.version,h=POLARIS.env.quirks?"quirks":"",m="["+POLARIS.getVersionString()+"]"+(POLARIS.build&&"$WCREV$"!=POLARIS.build?"[b"+POLARIS.build+"]":""),m=m+(b?"["+b+c+h+"]":h?"["+h+"]":""),g={getTimeStamp:function(){var a=new Date;return"["+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+":"+a.getMilliseconds()+"]"},getObjectString:function(a){(a=JSON.stringify(a))&&(a=a.replace(/url\":(\"[^\"]*\")/gi,function(a,d){return a.replace(d,"...")}));return a?a:""}},b=new d;b.enable("api");
b.enable("docconv");return b}();POLARIS.tools={arrayCompare:function(a,d){if(!a&&!d)return!0;if(!a||!d||a.length!=d.length)return!1;for(var b=0;b<a.length;b++)if(a[b]!=d[b])return!1;return!0},clone:function(a){var d;if(a&&a instanceof Array){d=[];for(var b=0;b<a.length;b++)d[b]=POLARIS.tools.clone(a[b]);return d}if(null===a||"object"!=typeof a||a instanceof String||a instanceof Number||a instanceof Boolean||a instanceof Date||a instanceof RegExp||a.nodeType||a.window===a)return a;d=new a.constructor;
for(b in a)d[b]=POLARIS.tools.clone(a[b]);return d},capitalize:function(a,d){return a.charAt(0).toUpperCase()+(d?a.slice(1):a.slice(1).toLowerCase())},extend:function(a){var d=arguments.length,b,c;"boolean"==typeof(b=arguments[d-1])?d--:"boolean"==typeof(b=arguments[d-2])&&(c=arguments[d-1],d-=2);for(var h=1;h<d;h++){var m=arguments[h],g;for(g in m)if(!0===b||null==a[g])if(!c||g in c)a[g]=m[g]}return a},prototypedCopy:function(a){var d=function(){};d.prototype=a;return new d},copy:function(a){var d=
{},b;for(b in a)d[b]=a[b];return d},isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)},isEmpty:function(a){for(var d in a)if(a.hasOwnProperty(d))return!1;return!0},isEmptyValue:function(a){return""===a||null===a||void 0===a||null!==a&&"object"===typeof a&&!Object.keys(a).length?!0:!1},cssVendorPrefix:function(a,d,b){if(b)return e+a+":"+d+";"+a+":"+d;b={};b[a]=d;b[e+a]=d;return b},cssStyleToDomStyle:function(){var a=document.createElement("div").style,d="undefined"!=typeof a.cssFloat?
"cssFloat":"undefined"!=typeof a.styleFloat?"styleFloat":"float";return function(a){return"float"==a?d:a.replace(/-./g,function(a){return a.substr(1).toUpperCase()})}}(),buildStyleHtml:function(a){a=[].concat(a);for(var d,b=[],c=0;c<a.length;c++)if(d=a[c])/@import|[{}]/.test(d)?b.push("\x3cstyle\x3e"+d+"\x3c/style\x3e"):b.push('\x3clink type\x3d"text/css" rel\x3dstylesheet href\x3d"'+d+'"\x3e');return b.join("")},htmlEncode:function(a){return String(a).replace(b,"\x26amp;").replace(c,"\x26gt;").replace(d,
"\x26lt;").replace(g,"\x26#39;")},htmlDecode:function(a){return a.replace(k,"\x26").replace(f,"\x3e").replace(l,"\x3c").replace(n,"'")},htmlEncodeAttr:function(a){return a.replace(h,"\x26quot;").replace(d,"\x26lt;").replace(c,"\x26gt;").replace(g,"\x26#39;")},htmlDecodeAttr:function(a){return a.replace(m,'"').replace(l,"\x3c").replace(f,"\x3e").replace(n,"'")},transformPlainTextToHtml:function(a,d){var b=d==POLARIS.ENTER_BR,c=this.htmlEncode(a.replace(/\r\n/g,"\n")),c=c.replace(/\t/g,"\x26nbsp;\x26nbsp; \x26nbsp;"),
h=d==POLARIS.ENTER_P?"p":"div";if(!b){var m=/\n/g;if(m.test(c))var g="\x3c"+h+"\x3e",e="\x3c/"+h+"\x3e",c=g+c.replace(m,function(){return e+g})+e}b||(c=c.replace(new RegExp("\x3cbr\x3e(?\x3d\x3c/"+h+"\x3e)"),function(a){return POLARIS.tools.repeat(a,2)}));c=c.replace(/^ | $/g,"\x26nbsp;");c=c.replace(/<p><\/p>/g,"\x3cp\x3e\x3cbr\x3e\x3c/p\x3e");return c=c.replace(/(>|\s) /g,function(a,d){return d+"\x26nbsp;"}).replace(/ (?=<)/g,"\x26nbsp;")},getNextNumber:function(){var a=0;return function(){return++a}}(),
getNextId:function(){return"polaris_"+this.getNextNumber()},override:function(a,d){var b=d(a);b.prototype=a.prototype;return b},setTimeout:function(a,d,b,c,h){h||(h=window);b||(b=h);return h.setTimeout(function(){c?a.apply(b,[].concat(c)):a.apply(b)},d||0)},trim:function(){var a=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(d){return d.replace(a,"")}}(),ltrim:function(){var a=/^[ \t\n\r]+/g;return function(d){return d.replace(a,"")}}(),rtrim:function(){var a=/[ \t\n\r]+$/g;return function(d){return d.replace(a,
"")}}(),indexOf:function(a,d){if("function"==typeof d)for(var b=0,c=a.length;b<c;b++){if(d(a[b]))return b}else{if(a.indexOf)return a.indexOf(d);b=0;for(c=a.length;b<c;b++)if(a[b]===d)return b}return-1},search:function(a,d){var b=POLARIS.tools.indexOf(a,d);return 0<=b?a[b]:null},bind:function(a,d){return function(){return a.apply(d,arguments)}},createClass:function(a){var d=a.$,b=a.base,c=a.privates||a._,h=a.proto;a=a.statics;!d&&(d=function(){b&&this.base.apply(this,arguments)});if(c)var m=d,d=function(){var a=
this._||(this._={}),d;for(d in c){var b=c[d];a[d]="function"==typeof b?POLARIS.tools.bind(b,this):b}m.apply(this,arguments)};b&&(d.prototype=this.prototypedCopy(b.prototype),d.prototype.constructor=d,d.base=b,d.baseProto=b.prototype,d.prototype.base=function(){this.base=b.prototype.base;b.apply(this,arguments);this.base=arguments.callee});h&&this.extend(d.prototype,h,!0);a&&this.extend(d,a,!0);return d},addFunction:function(d,b){return a.push(function(){return d.apply(b||this,arguments)})-1},removeFunction:function(d){a[d]=
null},callFunction:function(d){var b=a[d];return b&&b.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var a=/^-?\d+\.?\d*px$/,d;return function(b){d=POLARIS.tools.trim(b+"")+"px";return a.test(d)?d:b||""}}(),convertToPx:function(){var a;return function(d){a||(a=POLARIS.dom.element.createFromHtml('\x3cdiv style\x3d"position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"\x3e\x3c/div\x3e',POLARIS.document),POLARIS.document.getBody().append(a));return/%$/.test(d)?
d:(a.setStyle("width",d),a.$.clientWidth)}}(),roundDigit:function(a,d){var b=Math.pow(10,d),c=1;0>a&&(c=-1);b=Math.round(a*c*b)/b;return(b*c).toFixed(d)},floorDigit:function(a,d){var b=Math.pow(10,d);return(Math.floor(a*b)/b).toFixed(d)},ceilingDigit:function(a,d){var b=Math.pow(10,d);return(Math.ceil(a*b)/b).toFixed(d)},convertPxToMm:function(a){"string"==typeof a&&0<a.indexOf("px")&&(a=a.replace(/px/gi,""),a=parseFloat(a));return.264583*a},convertMmTopx:function(a){"string"==typeof a&&0<a.indexOf("mm")&&
(a=a.replace(/mm/gi,""),a=parseFloat(a));return 3.779528*a},convertPtToMm:function(a){return.388*a},convertPtToPx:function(a){return 96*parseFloat(a,10)/72},convertToPt:function(a){return.75*a},convertToUnit:function(a,d,b){if(POLARIS.tools.isEmptyValue(a))return a;var c,h=a.replace(/[0-9|.|-]/g,"");c=parseFloat(a);if(h!=d){if("px"==h&&"mm"==d)c=POLARIS.tools.convertPxToMm(c);else if("mm"==h&&"px"==d)c=POLARIS.tools.convertMmTopx(c);else{a={"ch-cm":.21087588*c,"ch-em":.5*c,"ch-ex":c/.9,"ch-in":.083022*
c,"ch-mm":2.1087588*c,"ch-pc":.5*c,"ch-pt":5.977584*c,"ch-%":50*c,"cm-ch":c/.21087588,"cm-em":c/.42175176,"cm-ex":c/.189788292,"cm-in":.39*c,"cm-mm":10*c,"cm-pc":c/.42175176,"cm-pt":28.3464566929*c,"em-ch":c/.5,"em-cm":.42175176*c,"em-ex":c/.45,"em-in":.166044*c,"em-mm":c/.237106301584,"em-pc":c,"em-pt":11.955168*c,"em-%":100*c,"ex-ch":.9*c,"ex-cm":.189788292*c,"ex-em":.45*c,"ex-in":.0747198*c,"ex-mm":1.89788292*c,"ex-pc":.45*c,"ex-pt":5.3798256*c,"ex-%":45*c,"in-ch":c/.083022,"in-cm":2.54*c,"in-em":c/
.166044,"in-ex":c/.0747198,"in-mm":25.4*c,"in-pc":c/.166044,"in-pt":c/.014842519685,"mm-ch":c/2.1087588,"mm-cm":c/10,"mm-em":.237106301584*c,"mm-ex":c/1.89788292,"mm-in":.39*c/10,"mm-pc":c/4.42175176,"mm-pt":c/.352777777778,"pc-ch":c/.5,"pc-cm":.42175176*c,"pc-em":c,"pc-ex":c/.45,"pc-in":.166044*c,"pc-mm":4.42175176*c,"pc-pt":c/.0836458341698,"pc-%":100*c,"pt-ch":c/5.977584,"pt-cm":c/28.3464566929,"pt-em":c/11.955168,"pt-ex":c/5.3798256,"pt-in":.014842519685*c,"pt-mm":.352777777778*c,"pt-pc":.0836458341698*
c,"pt-px":96*c/72,"%-ch":c/50,"%-em":c/100,"%-ex":c/45,"%-pc":c/100,"px-pt":72*c/96}[h+"-"+d];if(isNaN(a)||POLARIS.tools.isEmptyValue(a))a=c;c=a}return(b?c.toFixed(b):c.toFixed())+d}return a},getClientRectWithoutTransform:function(a){var d=a.$.getBoundingClientRect();!d.width&&(d.width=d.right-d.left);!d.height&&(d.height=d.bottom-d.top);if(a=(a=a&&a.getDocument())&&a.findOne("#polaris-page-container")){a=parseFloat(POLARIS.tools.getScaleRatio(a));var b=100*d.right/a,c=100*d.top/a,h=100*d.bottom/
a,m=100*d.width/a,g=100*d.height/a,e={};e.left=100*d.left/a;e.right=b;e.top=c;e.bottom=h;e.width=m;e.height=g;return e}return d},repeat:function(a,d){return Array(d+1).join(a)},tryThese:function(){for(var a,d=0,b=arguments.length;d<b;d++){var c=arguments[d];try{a=c();break}catch(h){}}return a},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(a){return function(){var d=arguments,b=this;window.setTimeout(function(){a.apply(b,d)},0)}},normalizeCssText:function(a,
d){var b=[],c,h=POLARIS.tools.parseCssText(a,!0,d);for(c in h)b.push(c+":"+h[c]);b.sort();return b.length?b.join(";")+";":""},convertRgbToHex:function(a){return a.replace(v,function(a,d,b,c){a=[d,b,c];for(d=0;3>d;d++)a[d]=("0"+parseInt(a[d],10).toString(16)).slice(-2);return"#"+a.join("")})},parseCssText:function(a,d,b){var c={};b&&(b=new POLARIS.dom.element("span"),b.setAttribute("style",a),a=POLARIS.tools.convertRgbToHex(b.getAttribute("style")||""));if(!a||";"==a)return c;a.replace(/&quot;/g,'"').replace(q,
function(a,b,h){d&&(b=b.toLowerCase(),"font-family"==b&&(h=h.replace(/["']/g,"").replace(/\s*,\s*/g,",")),h=POLARIS.tools.trim(h));c[b]=h});return c},writeCssText:function(a,d){var b,c=[];for(b in a)c.push(b+":"+a[b]);d&&c.sort();return c.join("; ")},objectCompare:function(a,d,b){var c;if(!a&&!d)return!0;if(!a||!d)return!1;for(c in a)if(a[c]!=d[c])return!1;if(!b)for(c in d)if(a[c]!=d[c])return!1;return!0},objectKeys:function(a){var d=[],b;for(b in a)d.push(b);return d},convertArrayToObject:function(a,
d){var b={};1==arguments.length&&(d=!0);for(var c=0,h=a.length;c<h;++c)b[a[c]]=d;return b},fixDomain:function(){for(var a;;)try{a=window.parent.document.domain;break}catch(d){a=a?a.replace(/.+?(?:\.|$)/,""):document.domain;if(!a)break;document.domain=a}return!!a},eventsBuffer:function(a,d){function b(){h=(new Date).getTime();c=!1;d()}var c,h=0;return{input:function(){if(!c){var d=(new Date).getTime()-h;d<a?c=setTimeout(b,a-d):b()}},reset:function(){c&&clearTimeout(c);c=h=0}}},enableHtml5Elements:function(a,
d){for(var b="abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),c=b.length,h;c--;)h=a.createElement(b[c]),d&&a.appendChild(h)},checkIfAnyArrayItemMatches:function(a,d){for(var b=0,c=a.length;b<c;++b)if(a[b].match(d))return!0;return!1},checkIfAnyObjectPropertyMatches:function(a,d){for(var b in a)if(b.match(d))return!0;return!1},getRandomString:function(a){for(var d="";d.length<a;){var b;
b=Math.floor(62*Math.random());b=10>b?b:36>b?String.fromCharCode(b+55):String.fromCharCode(b+61);d+=b}return d},getExtensionOfBase64EncodeImage:function(a){var d;0<a.indexOf("png")?d=".png":0<a.indexOf("jpeg")||0<a.indexOf("jpg")?d=".jpg":0<a.indexOf("gif")&&(d=".gif");return d},getImageStreamOfBase64EncodeImage:function(a){var d=a.indexOf("base64,")+7;return a.substring(d,a.length)},getRandomFileName:function(a){var d=POLARIS.tools.generateUUID(!1);return POLARIS.tools.getRandomString(a-d.length)+
d},generateUUID:function(a){var d=(new Date).getTime();window.performance&&"function"===typeof window.performance.now&&(d+=performance.now());return(a?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx":"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx").replace(/[xy]/g,function(a){var b=(d+16*Math.random())%16|0;d=Math.floor(d/16);return("x"==a?b:b&3|8).toString(16)})},isNumber:function(a){a=(a+"").replace(/^\s*|\s*$/g,"");return""==a||isNaN(a)?!1:!0},isInteger:function(a){"string"==typeof a&&(a=Number(a));return isNaN(a)?NaN:
parseInt(a)===a},isFloat:function(a){"string"==typeof a&&(a=Number(a));return isNaN(a)?NaN:parseInt(a)!==a},scaleElement:function(a,d,b,c,h,m){if(null==b||void 0==b)b="center";if(null==c||void 0==c)c="top";if(null==h||void 0==h)h="0";if(null==m||void 0==m)m="0";d/=100;a.setStyle("transform-origin",b+" "+c);a.setStyle("transform","matrix("+d+", 0, 0, "+d+", "+h+", "+m+")");a.$.style.MozTransformOrigin=b+" "+c;a.$.style.MozTransform="matrix("+d+", 0, 0, "+d+", "+h+", "+m+")";a.$.style.WebkitTransformOrigin=
b+" "+c;a.$.style.WebkitTransform="matrix("+d+", 0, 0, "+d+", "+h+", "+m+")";a.$.style.OTransformOrigin=b+" "+c;a.$.style.OTransform="matrix("+d+", 0, 0, "+d+", "+h+", "+m+")";POLARIS.env.ie&&(9>POLARIS.env.version||POLARIS.env.quirks)&&(a.$.style.zoom=d)},removeScaleFromElement:function(a){a.removeStyle("transform");a.removeStyle("transform-origin");a.$.style.MozTransformOrigin=null;a.$.style.MozTransform=null;a.$.style.WebkitTransformOrigin=null;a.$.style.WebkitTransform=null;a.$.style.OTransformOrigin=
null;a.$.style.OTransform=null;POLARIS.env.ie&&(a.$.style.zoom=null)},getScaleRatio:function(a){var d=function(a){a=a.split(",");if(a[0])return a=a[0].replace(/[^-\.0-9]/g,""),parseFloat(a)},b=a.getStyle("transform");if(b&&(b=d(b),!isNaN(b)))return 100*b;if(b=a.$.style.MozTransform)if(b=d(b),!isNaN(b))return 100*b;if(b=a.$.style.WebkitTransform)if(b=d(b),!isNaN(b))return 100*b;if(b=a.$.style.OTransform)if(b=d(b),!isNaN(b))return 100*b;return POLARIS.env.ie&&(9>POLARIS.env.version||POLARIS.env.quirks)&&
(b=a.$.style.zoom,a=parseFloat(b),!isNaN(a))?100*a:100},clickLink:function(a){if(a.click)a.click();else{var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);a.dispatchEvent(d)}},getPlainText:function(a){var d=function(a,d){if(a.$.style[d])return a.$.style[d];var b=a.$.currentStyle||a.$.ownerDocument.defaultView.getComputedStyle(a.$,null);return"SCRIPT"==a.$.tagName?"none":b[d]?"block"==b[d]&&"TD"==a.$.tagName?"feaux-inline":b[d]:-1<"LI,P,TR".indexOf(a.$.tagName)?"block":a.$.style[d]},
b=function(a){if(/pre/.test(d(a,"whiteSpace")))return m+=a.innerHTML.replace(/\t/g," ").replace(/\n/g," "),"";if("none"==d(a,"display"))return"";var c;c=d(a,"display")||"feaux-inline";c=-1<"table-row,block,list-item".indexOf(c)?!0:!1;c=c?"\n":" ";m+=c;for(var h=0;h<a.getChildCount();h++){var g=a.getChild(h);3==g.$.nodeType&&(m+=g.$.nodeValue);g.$.childNodes.length&&b(g)}return m+=c};a=a.clone(!0);a.$.innerHTML=a.$.innerHTML.replace(/<br>/g,"\n");for(var c=a.getElementsByTag("p"),h=0;h<c.$.length;h++)c.getItem(h).$.innerHTML+=
"NEWLINE";var m="";(function(a){var d=[],b=function(a){for(var c=0;c<a.getChildCount();c++){var h=a.getChild(c);3!=h.$.nodeType||/[^\t\n\r ]/.test(h.nodeValue)?h.$.hasChildNodes()&&b(h):d.push(h)}};b(a);for(a=0;a<d.length;a++)d[a].parentNode.removeChild(d[a])})(a);return function(a){return a?a.replace(/ +/g," ").replace(/[\t]+/gm,"").replace(/[ ]+$/gm,"").replace(/^[ ]+/gm,"").replace(/\n+/g,"\n").replace(/\n+$/,"").replace(/^\n+/,"").replace(/\nNEWLINE\n/g,"\n\n").replace(/NEWLINE\n/g,"\n").replace(/NEWLINE/g,
""):""}(b(a))},getCtrlId:function(a){var d="";a&&(a.is("a")?d="%hlk":a.is("table")?d="tbl":a.is("img")&&(d="gso"));return d},getSelectedParagraph:function(a,d){var b=a.getSelection(),c=d?new POLARIS.dom.range(a.document):b&&b.getRanges()[0],h=POLARIS.dtd.$list,m=a.elementPath(d),b=[];d&&c.selectNodeContents(d);if(null!=m){if(h=m.contains(h))b.push(h);else for(c=c.createIterator(),h=a.config.enterMode,c.enforceRealBlocks=!0,c.enlargeBr=h!=POLARIS.ENTER_BR;m=c.getNextParagraph(h==POLARIS.ENTER_P?"p":
"div");)m.isReadOnly()||b.push(m);return b}},getStyleInPath:function(a,d){if(a)for(var b=a.elements,c=0,h;c<b.length;c++)if(h=b[c],h=h.getStyle(d))return h;return null},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw\x3d\x3d",removeArrayDuplicate:function(a){for(var d={},b=0;b<a.length;b++)"undefined"==typeof d[a[b]]&&(d[a[b]]=1);a.length=0;for(b in d)a[a.length]=b;return a},getPageContentsSize:function(a){var d=a.plugins.pagination.pageInfo;
return{width:function(){var a=POLARIS.tools.convertMmTopx(d.getPageContentWidth());return Math.floor(a)}(),height:function(){var a=POLARIS.tools.convertMmTopx(d.getPageContentHeight());return Math.floor(a)}()}},getContentSizeToUnit:function(a,d){var b=POLARIS.tools,c,h;if(a.config.wordprocessor)switch(h=a.plugins.pagination.pageInfo,c=h.getPageContentWidth(),h=h.getPageContentHeight(),d){case "mm":c=parseInt(c);h=parseInt(h);break;default:c=parseInt(b.convertMmTopx(c)),h=parseInt(b.convertMmTopx(h))}else switch(h=
a.document.getBody().$,c=h.clientWidth,h=h.clientHeight,d){case "mm":c=parseInt(b.convertPxToMm(c));h=parseInt(b.convertPxToMm(h));break;default:c=parseInt(c),h=parseInt(h)}return{width:c,height:h}},isInEditableElement:function(a,d){var b;return 1===a.config.editMode&&d||2===a.config.editMode&&(b=d&&d.getAscendant({article:1,td:1}))&&b.isEditable()?!0:!1},reloadWebFontCss:function(a){var d=null,b=0,c=null,h="",m=0;if(POLARIS.env.ie)for(b=(d=a.document.find("link"))&&d.count(),m=0;m<b;m+=1)c=d.getItem(m),
(h=c.getAttribute("href"))&&-1<h.indexOf("fonts.css")&&(c.remove(),h=POLARIS.getUrl("fonts/fonts.css"),h+=-1<h.indexOf("fonts.css?")?"\x26v\x3d":"?v\x3d",h+=(new Date).getTime(),a.document.appendStyleSheet(h))},getSplitElements:function(a){var d=null,b="",d=null;if(!a||!a.hasAttribute("polaris-splitted"))return null;(b=a.getAttribute("polaris-splitted"))&&POLARIS.tools.isNumber(b)&&(d=(d=a.getDocument())&&d.find('[polaris-splitted\x3d"'+b+'"]'));return d}}})();POLARIS.dtd=function(){var a=POLARIS.tools.extend,
e=function(a,d){for(var b=POLARIS.tools.clone(a),c=1;c<arguments.length;c++){d=arguments[c];for(var h in d)delete b[h]}return b},b={},c={},d={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},h={command:1,link:1,meta:1,noscript:1,script:1,style:1},g={},k={"#":1},f={center:1,dir:1,noframes:1};a(b,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,
button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,"var":1,video:1,wbr:1},k,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1});a(c,d,b,f);e={a:e(b,{a:1,button:1}),abbr:b,address:c,area:g,article:c,aside:c,audio:a({source:1,track:1},
c),b:b,base:g,bdi:b,bdo:b,blockquote:c,body:c,br:g,button:e(b,{a:1,button:1}),canvas:b,caption:c,cite:b,code:b,col:g,colgroup:{col:1},command:g,datalist:a({option:1},b),dd:c,del:b,details:a({summary:1},c),dfn:b,div:c,dl:{dt:1,dd:1},dt:c,em:b,embed:g,fieldset:a({legend:1},c),figcaption:c,figure:a({figcaption:1},c),footer:c,form:c,h1:b,h2:b,h3:b,h4:b,h5:b,h6:b,head:a({title:1,base:1},h),header:c,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:g,html:a({head:1,body:1},c,h),i:b,iframe:k,img:g,input:g,ins:b,
kbd:b,keygen:g,label:b,legend:b,li:c,link:g,main:c,map:c,mark:b,menu:a({li:1},c),meta:g,meter:e(b,{meter:1}),nav:c,noscript:a({link:1,meta:1,style:1},b),object:a({param:1},b),ol:{li:1},optgroup:{option:1},option:k,output:b,p:b,param:g,pre:b,progress:e(b,{progress:1}),q:b,rp:b,rt:b,ruby:a({rp:1,rt:1},b),s:b,samp:b,script:k,section:c,select:{optgroup:1,option:1},small:b,source:g,span:b,strong:b,style:k,sub:b,summary:b,sup:b,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:c,
textarea:k,tfoot:{tr:1},th:c,thead:{tr:1},time:e(b,{time:1}),title:k,tr:{th:1,td:1},track:g,u:b,ul:{li:1},"var":b,video:a({source:1,track:1},c),wbr:g,acronym:b,applet:a({param:1},c),basefont:g,big:b,center:c,dialog:g,dir:{li:1},font:b,isindex:g,noframes:c,strike:b,tt:b};a(e,{$block:a({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},d,f),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,
ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:b,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:a({body:1,
head:1,html:1},e.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,
button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}});return e}();POLARIS.dom.event=function(a){this.$=a};POLARIS.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},
getKeystroke:function(){var a=this.getKey();if(this.$.ctrlKey||this.$.metaKey)a+=POLARIS.CTRL;this.$.shiftKey&&(a+=POLARIS.SHIFT);this.$.altKey&&(a+=POLARIS.ALT);return a},preventDefault:function(a){var e=this.$;e.preventDefault?e.preventDefault():e.returnValue=!1;a&&this.stopPropagation()},stopPropagation:function(){var a=this.$;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},getTarget:function(){var a=this.$.target||this.$.srcElement;return a?new POLARIS.dom.node(a):null},getPhase:function(){return this.$.eventPhase||
2},getPageOffset:function(){var a=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(a.documentElement.scrollLeft||a.body.scrollLeft),y:this.$.pageY||this.$.clientY+(a.documentElement.scrollTop||a.body.scrollTop)}}};POLARIS.CTRL=1114112;POLARIS.SHIFT=2228224;POLARIS.ALT=4456448;POLARIS.EVENT_PHASE_CAPTURING=1;POLARIS.EVENT_PHASE_AT_TARGET=2;POLARIS.EVENT_PHASE_BUBBLING=3;POLARIS.KEYCODE={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSEBREAK:19,CAPSLOOK:20,HAN_ENG:21,CHINESE_CHARACTER:25,
ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,L_WINDOW:91,R_WINDOW:92,R_CLICK:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145};POLARIS.dom.domObject=function(a){a&&(this.$=a)};POLARIS.dom.domObject.prototype=function(){var a=function(a,b){return function(c){"undefined"!=typeof POLARIS&&a.fire(b,new POLARIS.dom.event(c))}};return{getPrivate:function(){var a;(a=this.getCustomData("_"))||
this.setCustomData("_",a={});return a},on:function(e){var b=this.getCustomData("_polaris_nativeListeners");b||(b={},this.setCustomData("_polaris_nativeListeners",b));b[e]||(b=b[e]=a(this,e),this.$.addEventListener?this.$.addEventListener(e,b,!!POLARIS.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+e,b));return POLARIS.event.prototype.on.apply(this,arguments)},removeListener:function(a){POLARIS.event.prototype.removeListener.apply(this,arguments);if(!this.hasListeners(a)){var b=this.getCustomData("_polaris_nativeListeners"),
c=b&&b[a];c&&(this.$.removeEventListener?this.$.removeEventListener(a,c,!1):this.$.detachEvent&&this.$.detachEvent("on"+a,c),delete b[a])}},removeAllListeners:function(){var a=this.getCustomData("_polaris_nativeListeners"),b;for(b in a){var c=a[b];this.$.detachEvent?this.$.detachEvent("on"+b,c):this.$.removeEventListener&&this.$.removeEventListener(b,c,!1);delete a[b]}POLARIS.event.prototype.removeAllListeners.call(this)}}}();(function(a){var e={};POLARIS.on("reset",function(){e={}});a.equals=function(a){try{return a&&
a.$===this.$}catch(c){return!1}};a.setCustomData=function(a,c){var d=this.getUniqueId();(e[d]||(e[d]={}))[a]=c;return this};a.getCustomData=function(a){var c=this.$["data-polaris-expando"];return(c=c&&e[c])&&a in c?c[a]:null};a.removeCustomData=function(a){var c=this.$["data-polaris-expando"],c=c&&e[c],d,h;c&&(d=c[a],h=a in c,delete c[a]);return h?d:null};a.clearCustomData=function(){this.removeAllListeners();var a=this.$["data-polaris-expando"];a&&delete e[a]};a.getUniqueId=function(){return this.$["data-polaris-expando"]||
(this.$["data-polaris-expando"]=POLARIS.tools.getNextNumber())};POLARIS.event.implementOn(a)})(POLARIS.dom.domObject.prototype);POLARIS.dom.node=function(a){return a?new POLARIS.dom[a.nodeType==POLARIS.NODE_DOCUMENT?"document":a.nodeType==POLARIS.NODE_ELEMENT?"element":a.nodeType==POLARIS.NODE_TEXT?"text":a.nodeType==POLARIS.NODE_COMMENT?"comment":a.nodeType==POLARIS.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](a):this};POLARIS.dom.node.prototype=new POLARIS.dom.domObject;POLARIS.NODE_ELEMENT=
1;POLARIS.NODE_DOCUMENT=9;POLARIS.NODE_TEXT=3;POLARIS.NODE_COMMENT=8;POLARIS.NODE_DOCUMENT_FRAGMENT=11;POLARIS.POSITION_IDENTICAL=0;POLARIS.POSITION_DISCONNECTED=1;POLARIS.POSITION_FOLLOWING=2;POLARIS.POSITION_PRECEDING=4;POLARIS.POSITION_IS_CONTAINED=8;POLARIS.POSITION_CONTAINS=16;POLARIS.tools.extend(POLARIS.dom.node.prototype,{appendTo:function(a,e){a.append(this,e);return a},clone:function(a,e){var b=this.$.cloneNode(a),c=function(d){d["data-polaris-expando"]&&(d["data-polaris-expando"]=!1);if(d.nodeType==
POLARIS.NODE_ELEMENT&&(e||d.removeAttribute("id",!1),a)){d=d.childNodes;for(var b=0;b<d.length;b++)c(d[b])}};c(b);return new POLARIS.dom.node(b)},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(a){a.$.parentNode.insertBefore(this.$,a.$.nextSibling);return a},insertBefore:function(a){a.$.parentNode.insertBefore(this.$,a.$);return a},insertBeforeMe:function(a){this.$.parentNode.insertBefore(a.$,this.$);return a},getAddress:function(a){for(var e=
[],b=this.getDocument().$.documentElement,c=this.$;c&&c!=b;){var d=c.parentNode;d&&e.unshift(this.getIndex.call({$:c},a));c=d}return e},getDocument:function(){return new POLARIS.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(a){function e(a,d){var c=d?a.nextSibling:a.previousSibling;return c&&c.nodeType==POLARIS.NODE_TEXT?b(c)?c:e(c,d):null}function b(a){return!a.nodeValue||a.nodeValue==POLARIS.dom.selection.FILLING_CHAR_SEQUENCE}var c=this.$,d=-1,h;if(!this.$.parentNode||
a&&c.nodeType==POLARIS.NODE_TEXT&&b(c)&&!e(c)&&!e(c,!0))return-1;do a&&c!=this.$&&c.nodeType==POLARIS.NODE_TEXT&&(h||b(c))||(d++,h=c.nodeType==POLARIS.NODE_TEXT);while(c=c.previousSibling);return d},getNextSourceNode:function(a,e,b){if(b&&!b.call){var c=b;b=function(a){return!a.equals(c)}}a=!a&&this.getFirst&&this.getFirst();var d;if(!a){if(this.type==POLARIS.NODE_ELEMENT&&b&&!1===b(this,!0))return null;a=this.getNext()}for(;!a&&(d=(d||this).getParent());){if(b&&!1===b(d,!0))return null;a=d.getNext()}return!a||
b&&!1===b(a)?null:e&&e!=a.type?a.getNextSourceNode(!1,e,b):a},getPreviousSourceNode:function(a,e,b){if(b&&!b.call){var c=b;b=function(a){return!a.equals(c)}}a=!a&&this.getLast&&this.getLast();var d;if(!a){if(this.type==POLARIS.NODE_ELEMENT&&b&&!1===b(this,!0))return null;a=this.getPrevious()}for(;!a&&(d=(d||this).getParent());){if(b&&!1===b(d,!0))return null;a=d.getPrevious()}return!a||b&&!1===b(a)?null:e&&a.type!=e?a.getPreviousSourceNode(!1,e,b):a},getPrevious:function(a){var e=this.$,b;do b=(e=
e.previousSibling)&&10!=e.nodeType&&new POLARIS.dom.node(e);while(b&&a&&!a(b));return b},getNext:function(a){var e=this.$,b;do b=(e=e.nextSibling)&&new POLARIS.dom.node(e);while(b&&a&&!a(b));return b},getParent:function(a){var e=this.$.parentNode;return e&&(e.nodeType==POLARIS.NODE_ELEMENT||a&&e.nodeType==POLARIS.NODE_DOCUMENT_FRAGMENT)?new POLARIS.dom.node(e):null},getParents:function(a){var e=this,b=[];do b[a?"push":"unshift"](e);while(e=e.getParent());return b},getCommonAncestor:function(a){if(a.equals(this))return this;
if(a.contains&&a.contains(this))return a;var e=this.contains?this:this.getParent();do if(e.contains(a))return e;while(e=e.getParent());return null},getPosition:function(a){var e=this.$,b=a.$;if(e.compareDocumentPosition)return e.compareDocumentPosition(b);if(e==b)return POLARIS.POSITION_IDENTICAL;if(this.type==POLARIS.NODE_ELEMENT&&a.type==POLARIS.NODE_ELEMENT){if(e.contains){if(e.contains(b))return POLARIS.POSITION_CONTAINS+POLARIS.POSITION_PRECEDING;if(b.contains(e))return POLARIS.POSITION_IS_CONTAINED+
POLARIS.POSITION_FOLLOWING}if("sourceIndex"in e)return 0>e.sourceIndex||0>b.sourceIndex?POLARIS.POSITION_DISCONNECTED:e.sourceIndex<b.sourceIndex?POLARIS.POSITION_PRECEDING:POLARIS.POSITION_FOLLOWING}e=this.getAddress();a=a.getAddress();for(var b=Math.min(e.length,a.length),c=0;c<=b-1;c++)if(e[c]!=a[c]){if(c<b)return e[c]<a[c]?POLARIS.POSITION_PRECEDING:POLARIS.POSITION_FOLLOWING;break}return e.length<a.length?POLARIS.POSITION_CONTAINS+POLARIS.POSITION_PRECEDING:POLARIS.POSITION_IS_CONTAINED+POLARIS.POSITION_FOLLOWING},
getAscendant:function(a,e){var b=this.$,c,d;e||(b=b.parentNode);"function"==typeof a?(d=!0,c=a):(d=!1,c=function(d){d="string"==typeof d.nodeName?d.nodeName.toLowerCase():"";return"string"==typeof a?d==a:d in a});for(;b;){if(c(d?new POLARIS.dom.node(b):b))return new POLARIS.dom.node(b);try{b=b.parentNode}catch(h){b=null}}return null},hasAscendant:function(a,e){var b=this.$;e||(b=b.parentNode);for(;b;){if(b.nodeName&&b.nodeName.toLowerCase()==a)return!0;b=b.parentNode}return!1},move:function(a,e){a.append(this.remove(),
e)},remove:function(a){var e=this.$,b=e.parentNode;if(b){if(a)for(;a=e.firstChild;)b.insertBefore(e.removeChild(a),e);b.removeChild(e)}return this},replace:function(a){this.insertBefore(a);a.remove()},trim:function(){this.ltrim();this.rtrim()},ltrim:function(){for(var a;this.getFirst&&(a=this.getFirst());){if(a.type==POLARIS.NODE_TEXT){var e=POLARIS.tools.ltrim(a.getText()),b=a.getLength();if(e)e.length<b&&(a.split(b-e.length),this.$.removeChild(this.$.firstChild));else{a.remove();continue}}break}},
rtrim:function(){for(var a;this.getLast&&(a=this.getLast());){if(a.type==POLARIS.NODE_TEXT){var e=POLARIS.tools.rtrim(a.getText()),b=a.getLength();if(e)e.length<b&&(a.split(e.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild));else{a.remove();continue}}break}POLARIS.env.needsBrFiller&&(a=this.$.lastChild)&&1==a.nodeType&&"br"==a.nodeName.toLowerCase()&&a.parentNode.removeChild(a)},isReadOnly:function(){var a=this;this.type!=POLARIS.NODE_ELEMENT&&(a=this.getParent());var e=a&&a.hasAttribute&&
a.hasAttribute("contentEditable")?a.getAttribute("contentEditable"):null;if("false"==e)return!0;var b=a.$.isContentEditable;if(a&&"undefined"!=typeof b)return POLARIS.env.ie&&(b||(b="true"==e?!0:!1)),!(b||a.data("polaris-editable"));for(;a&&!a.data("polaris-editable");){e=a.getAttribute("contentEditable");if("false"==e)return!0;if("true"==e)break;a=a.getParent()}return!a}});POLARIS.dom.window=function(a){POLARIS.dom.domObject.call(this,a)};POLARIS.dom.window.prototype=new POLARIS.dom.domObject;POLARIS.tools.extend(POLARIS.dom.window.prototype,
{focus:function(){this.$.focus()},getViewPaneSize:function(){var a=this.$.document,e="CSS1Compat"==a.compatMode;return{width:(e?a.documentElement.clientWidth:a.body.clientWidth)||0,height:(e?a.documentElement.clientHeight:a.body.clientHeight)||0}},getScrollPosition:function(){var a=this.$;if("pageXOffset"in a)return{x:a.pageXOffset||0,y:a.pageYOffset||0};a=a.document;return{x:a.documentElement.scrollLeft||a.body.scrollLeft||0,y:a.documentElement.scrollTop||a.body.scrollTop||0}},getFrame:function(){var a=
this.$.frameElement;return a?new POLARIS.dom.element.get(a):null}});POLARIS.dom.document=function(a){POLARIS.dom.domObject.call(this,a)};POLARIS.dom.document.prototype=new POLARIS.dom.domObject;POLARIS.tools.extend(POLARIS.dom.document.prototype,{type:POLARIS.NODE_DOCUMENT,appendStyleSheet:function(a){if(this.$.createStyleSheet)this.$.createStyleSheet(a);else{var e=new POLARIS.dom.element("link");e.setAttributes({rel:"stylesheet",type:"text/css",href:a});this.getHead().append(e)}},appendStyleText:function(a){if(this.$.createStyleSheet){var e=
this.$.createStyleSheet("");e.cssText=a}else{var b=new POLARIS.dom.element("style",this);b.append(new POLARIS.dom.text(a,this));this.getHead().append(b)}return e||b.$.sheet},createElement:function(a,e){var b=new POLARIS.dom.element(a,this);e&&(e.attributes&&b.setAttributes(e.attributes),e.styles&&b.setStyles(e.styles));return b},createText:function(a){return new POLARIS.dom.text(a,this)},focus:function(){this.getWindow().focus()},getActive:function(){var a;try{a=this.$.activeElement}catch(e){return null}return new POLARIS.dom.element(a)},
getById:function(a){return(a=this.$.getElementById(a))?new POLARIS.dom.element(a):null},getByAddress:function(a,e){for(var b=this.$.documentElement,c=0;b&&c<a.length;c++){var d=a[c];if(e)for(var h=-1,g=0;g<b.childNodes.length;g++){var k=b.childNodes[g];if(!0!==e||3!=k.nodeType||!k.previousSibling||3!=k.previousSibling.nodeType)if(h++,h==d){b=k;break}}else b=b.childNodes[d]}return b?new POLARIS.dom.node(b):null},getElementsByTag:function(a,e){POLARIS.env.ie&&8>=document.documentMode||!e||(a=e+":"+
a);return new POLARIS.dom.nodeList(this.$.getElementsByTagName(a))},getHead:function(){var a=this.$.getElementsByTagName("head")[0];return a=a?new POLARIS.dom.element(a):this.getDocumentElement().append(new POLARIS.dom.element("head"),!0)},getBody:function(){return new POLARIS.dom.element(this.$.body)},getDocumentElement:function(){return new POLARIS.dom.element(this.$.documentElement)},getWindow:function(){return new POLARIS.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(a){this.$.open("text/html",
"replace");POLARIS.env.ie&&(a=a.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$\x26\n\x3cscript data-polaris-temp\x3d"1"\x3e('+POLARIS.tools.fixDomain+")();\x3c/script\x3e"));this.$.write(a);this.$.close()},find:function(a){return new POLARIS.dom.nodeList(this.$.querySelectorAll(a))},findOne:function(a){return(a=this.$.querySelector(a))?new POLARIS.dom.element(a):null},_getHtml5ShivFrag:function(){var a=this.getCustomData("html5ShivFrag");a||(a=this.$.createDocumentFragment(),POLARIS.tools.enableHtml5Elements(a,
!0),this.setCustomData("html5ShivFrag",a));return a}});POLARIS.dom.nodeList=function(a,e){this.$=a;this.rawMode=void 0==e?!1:e;this.immutableLength=a.length};POLARIS.dom.nodeList.prototype={count:function(){return 0==this.rawMode?this.immutableLength:this.$.length},getItem:function(a){var e=this.rawMode?this.$.length:this.immutableLength;return 0>a||a>=e?null:(a=this.$[a])?this.rawMode?a:new POLARIS.dom.node(a):null}};POLARIS.dom.element=function(a,e){"string"==typeof a&&(a=(e?e.$:document).createElement(a));
POLARIS.dom.domObject.call(this,a)};POLARIS.dom.element.get=function(a){return(a="string"==typeof a?document.getElementById(a)||document.getElementsByName(a)[0]:a)&&(a.$?a:new POLARIS.dom.element(a))};POLARIS.dom.element.prototype=new POLARIS.dom.node;POLARIS.dom.element.createFromHtml=function(a,e){var b=new POLARIS.dom.element("div",e);b.setHtml(a);return b.getFirst().remove()};POLARIS.dom.element.setMarker=function(a,e,b,c){var d=e.getCustomData("list_marker_id")||e.setCustomData("list_marker_id",
POLARIS.tools.getNextNumber()).getCustomData("list_marker_id"),h=e.getCustomData("list_marker_names")||e.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");a[d]=e;h[b]=1;return e.setCustomData(b,c)};POLARIS.dom.element.clearAllMarkers=function(a){for(var e in a)POLARIS.dom.element.clearMarkers(a,a[e],1)};POLARIS.dom.element.clearMarkers=function(a,e,b){var c=e.getCustomData("list_marker_names"),d=e.getCustomData("list_marker_id"),h;for(h in c)e.removeCustomData(h);e.removeCustomData("list_marker_names");
b&&(e.removeCustomData("list_marker_id"),delete a[d])};(function(){function a(a){var b=!0;a.$.id||(a.$.id="polaris_tmp_"+POLARIS.tools.getNextNumber(),b=!1);return function(){b||a.removeAttribute("id")}}function e(a,b){return"#"+a.$.id+" "+b.split(/,\s*/).join(", #"+a.$.id+" ")}function b(a){for(var b=0,g=0,e=c[a].length;g<e;g++)b+=parseInt(this.getComputedStyle(c[a][g])||0,10)||0;return b}POLARIS.tools.extend(POLARIS.dom.element.prototype,{type:POLARIS.NODE_ELEMENT,addClass:function(a){var b=this.$.className;
b&&((new RegExp("(?:^|\\s)"+a+"(?:\\s|$)","")).test(b)||(b+=" "+a));this.$.className=b||a;return this},removeClass:function(a){var b=this.getAttribute("class");b&&(a=new RegExp("(?:^|\\s+)"+a+"(?\x3d\\s|$)","i"),a.test(b)&&((b=b.replace(a,"").replace(/^\s+/,""))?this.setAttribute("class",b):this.removeAttribute("class")));return this},hasClass:function(a){return(new RegExp("(?:^|\\s+)"+a+"(?\x3d\\s|$)","")).test(this.getAttribute("class"))},append:function(a,b){"string"==typeof a&&(a=this.getDocument().createElement(a));
b?this.$.insertBefore(a.$,this.$.firstChild):this.$.appendChild(a.$);return a},appendHtml:function(a){if(this.$.childNodes.length){var b=new POLARIS.dom.element("div",this.getDocument());b.setHtml(a);b.moveChildren(this)}else this.setHtml(a)},appendText:function(a){null!=this.$.text?this.$.text+=a:this.append(new POLARIS.dom.text(a))},appendBogus:function(a){if(a||POLARIS.env.needsBrFiller){for(a=this.getLast();a&&a.type==POLARIS.NODE_TEXT&&!POLARIS.tools.rtrim(a.getText());)a=a.getPrevious();a&&
a.is&&a.is("br")||(a=this.getDocument().createElement("br"),POLARIS.env.gecko&&a.setAttribute("type","_moz"),this.append(a))}},breakParent:function(a){var b=new POLARIS.dom.range(this.getDocument());b.setStartAfter(this);b.setEndAfter(a);a=b.extractContents();b.insertNode(this.remove());a.insertAfterNode(this)},contains:POLARIS.env.ie||POLARIS.env.webkit?function(a){var b=this.$;return a.type!=POLARIS.NODE_ELEMENT?b.contains(a.getParent()?a.getParent().$:a.$):b!=a.$&&b.contains(a.$)}:function(a){return!!(this.$.compareDocumentPosition(a.$)&
16)},focus:function(){function a(){try{this.$.focus()}catch(d){}}return function(b){b?POLARIS.tools.setTimeout(a,100,this):a.call(this)}}(),getHtml:function(){var a=this.$.innerHTML;return POLARIS.env.ie?a.replace(/<\?[^>]*>/g,""):a},getOuterHtml:function(){var a=this.$.outerHTML;if(a)return a.replace(/<\?[^>]*>/,"");a=this.$.ownerDocument.createElement("div");a.appendChild(this.$.cloneNode(!0));return a.innerHTML},getClientRect:function(){var a=POLARIS.tools.extend({},this.$.getBoundingClientRect());
!a.width&&(a.width=a.right-a.left);!a.height&&(a.height=a.bottom-a.top);return a},setHtml:POLARIS.env.ie&&9>POLARIS.env.version?function(a){try{var b=this.$;if(this.getParent())return b.innerHTML=a;var c=this.getDocument()._getHtml5ShivFrag();c.appendChild(b);b.innerHTML=a;c.removeChild(b);return a}catch(e){this.$.innerHTML="";b=new POLARIS.dom.element("body",this.getDocument());b.$.innerHTML=a;for(b=b.getChildren();b.count();)this.append(b.getItem(0));return a}}:function(a){return this.$.innerHTML=
a},setText:function(){var a=document.createElement("p");a.innerHTML="x";a=a.textContent;return function(b){this.$[a?"textContent":"innerText"]=b}}(),getAttribute:function(){var a=function(a){return this.$.getAttribute(a,2)};return POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks)?function(a){switch(a){case "class":a="className";break;case "http-equiv":a="httpEquiv";break;case "name":return this.$.name;case "tabindex":return a=this.$.getAttribute(a,2),0!==a&&0===this.$.tabIndex&&(a=null),
a;case "checked":return a=this.$.attributes.getNamedItem(a),(a.specified?a.nodeValue:this.$.checked)?"checked":null;case "hspace":case "value":return this.$[a];case "style":return this.$.style.cssText;case "contenteditable":case "contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(a,2)}:a}(),getChildren:function(){return new POLARIS.dom.nodeList(this.$.childNodes)},getComputedStyle:document.defaultView&&
document.defaultView.getComputedStyle?function(a){var b=this.getWindow().$.getComputedStyle(this.$,null);return b?b.getPropertyValue(a):""}:function(a){return this.$.currentStyle[POLARIS.tools.cssStyleToDomStyle(a)]},getDtd:function(){var a=POLARIS.dtd[this.getName()];this.getDtd=function(){return a};return a},getElementsByTag:POLARIS.dom.document.prototype.getElementsByTag,getTabIndex:POLARIS.env.ie?function(){var a=this.$.tabIndex;0!==a||POLARIS.dtd.$tabIndex[this.getName()]||0===parseInt(this.getAttribute("tabindex"),
10)||(a=-1);return a}:POLARIS.env.webkit?function(){var a=this.$.tabIndex;void 0===a&&(a=parseInt(this.getAttribute("tabindex"),10),isNaN(a)&&(a=-1));return a}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var a=this.$.nodeName.toLowerCase();if(POLARIS.env.ie&&8>=document.documentMode){var b=
this.$.scopeName;"HTML"!=b&&(a=b.toLowerCase()+":"+a)}this.getName=function(){return a};return this.getName()},getValue:function(){return this.$.value},getFirst:function(a){var b=this.$.firstChild;(b=b&&new POLARIS.dom.node(b))&&a&&!a(b)&&(b=b.getNext(a));return b},getLast:function(a){var b=this.$.lastChild;(b=b&&new POLARIS.dom.node(b))&&a&&!a(b)&&(b=b.getPrevious(a));return b},getStyle:function(a){return this.$.style[POLARIS.tools.cssStyleToDomStyle(a)]},is:function(){var a=this.getName();if("object"==
typeof arguments[0])return!!arguments[0][a];for(var b=0;b<arguments.length;b++)if(arguments[b]==a)return!0;return!1},isEditable:function(a){var b=this.getName();return this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||POLARIS.dtd.$nonEditable[b]||POLARIS.dtd.$empty[b]||this.is("a")&&(this.data("polaris-saved-name")||this.hasAttribute("name"))&&!this.getChildCount()?!1:!1!==a?(a=POLARIS.dtd[b]||POLARIS.dtd.span,!(!a||!a["#"])):!0},isIdentical:function(a){var b=
this.clone(0,1);a=a.clone(0,1);b.removeAttributes(["_moz_dirty","data-polaris-expando","data-polaris-saved-href","data-polaris-saved-name"]);a.removeAttributes(["_moz_dirty","data-polaris-expando","data-polaris-saved-href","data-polaris-saved-name"]);if(b.$.isEqualNode)return b.$.style.cssText=POLARIS.tools.normalizeCssText(b.$.style.cssText),a.$.style.cssText=POLARIS.tools.normalizeCssText(a.$.style.cssText),b.$.isEqualNode(a.$);b=b.getOuterHtml();a=a.getOuterHtml();if(POLARIS.env.ie&&9>POLARIS.env.version&&
this.is("a")){var c=this.getParent();c.type==POLARIS.NODE_ELEMENT&&(c=c.clone(),c.setHtml(b),b=c.getHtml(),c.setHtml(a),a=c.getHtml())}return b==a},isVisible:function(){var a=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility"),b,c;a&&POLARIS.env.webkit&&(b=this.getWindow(),!b.equals(POLARIS.document.getWindow())&&(c=b.$.frameElement)&&(a=(new POLARIS.dom.element(c)).isVisible()));return!!a},isEmptyInlineRemoveable:function(){if(!POLARIS.dtd.$removeEmpty[this.getName()])return!1;
for(var a=this.getChildren(),b=0,c=a.count();b<c;b++){var e=a.getItem(b);if(e.type!=POLARIS.NODE_ELEMENT||!e.data("polaris-bookmark"))if(e.type==POLARIS.NODE_ELEMENT&&!e.isEmptyInlineRemoveable()||e.type==POLARIS.NODE_TEXT&&POLARIS.tools.trim(e.getText().replace(/\u200b/g,"")))return!1}return!0},isExistText:function(a){var b,c,e,f,l,m,n,q;c=(b=this.find('span[data-polaris-bookmark\x3d"1"]'))&&b.count();e=a=0;l=null;for(e=0;e<c;e+=1)l=b.getItem(e),"none"===l.getStyle("display")&&(a+=l.getText().replace(/\u200b|\n$/g,
"").length);f=e=0;c=(b=this.getTextNodes())?b.length:0;f=null;m;n="";q=0;l=this.getFirst(function(a){return a.type===POLARIS.NODE_TEXT&&0<a.getText().length&&"none"!==a.getParent().getStyle("display")?!0:!1});for(e=0;e<c;e+=1)if(f=b[e],f.equals(l))for(m=f.getText().replace(/\u200b|\n$/g,""),q=m.length,f=0;f<q;f+=1)if(n=m.charAt(f)," "===n)a+=1;else break;return 0<this.getText().replace(/\u200b|\n$/g,"").length-a},hasAttributes:POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks)?function(){for(var a=
this.$.attributes,b=0;b<a.length;b++){var c=a[b];switch(c.nodeName){case "class":if(this.getAttribute("class"))return!0;case "data-polaris-expando":continue;default:if(c.specified)return!0}}return!1}:function(){var a=this.$.attributes,b=a.length,c={"data-polaris-expando":1,_moz_dirty:1};return 0<b&&(2<b||!c[a[0].nodeName]||2==b&&!c[a[1].nodeName])},hasAttribute:function(){function a(b){var d=this.$.attributes.getNamedItem(b);if("input"==this.getName())switch(b){case "class":return 0<this.$.className.length;
case "checked":return!!this.$.checked;case "value":return b=this.getAttribute("type"),"checkbox"==b||"radio"==b?"on"!=this.$.value:!!this.$.value}return d?d.specified:!1}return POLARIS.env.ie?8>POLARIS.env.version?function(b){return"name"==b?!!this.$.name:a.call(this,b)}:a:function(a){return!!this.$.attributes.getNamedItem(a)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(a,b){var c=this.$;a=a.$;if(c!=a){var e;if(b)for(;e=c.lastChild;)a.insertBefore(c.removeChild(e),a.firstChild);
else for(;e=c.firstChild;)a.appendChild(c.removeChild(e))}},mergeSiblings:function(){function a(b,d,c){if(d&&d.type==POLARIS.NODE_ELEMENT){for(var e=[];d.data("polaris-bookmark")||d.isEmptyInlineRemoveable();)if(e.push(d),d=c?d.getNext():d.getPrevious(),!d||d.type!=POLARIS.NODE_ELEMENT)return;if(b.isIdentical(d)){for(var l=c?b.getLast():b.getFirst();e.length;)e.shift().move(b,!c);d.moveChildren(b,!c);d.remove();l&&l.type==POLARIS.NODE_ELEMENT&&l.mergeSiblings()}}}return function(b){if(!1===b||POLARIS.dtd.$removeEmpty[this.getName()]||
this.is("a"))a(this,this.getNext(),!0),a(this,this.getPrevious())}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var a=function(a,b){this.$.setAttribute(a,b);return this};return POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks)?function(b,c){"class"==b?this.$.className=c:"style"==b?this.$.style.cssText=c:"tabindex"==b?this.$.tabIndex=c:"checked"==b?this.$.checked=c:"contenteditable"==b?a.call(this,"contentEditable",c):a.apply(this,arguments);return this}:
POLARIS.env.ie8Compat&&POLARIS.env.secure?function(b,c){if("src"==b&&c.match(/^http:\/\//))try{a.apply(this,arguments)}catch(e){}else a.apply(this,arguments);return this}:a}(),setAttributes:function(a){for(var b in a)this.setAttribute(b,a[b]);return this},setValue:function(a){this.$.value=a;return this},removeAttribute:function(){var a=function(a){this.$.removeAttribute(a)};return POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks)?function(a){"class"==a?a="className":"tabindex"==a?a="tabIndex":
"contenteditable"==a&&(a="contentEditable");this.$.removeAttribute(a)}:a}(),removeAttributes:function(a){if(POLARIS.tools.isArray(a))for(var b=0;b<a.length;b++)this.removeAttribute(a[b]);else for(b in a)a.hasOwnProperty(b)&&this.removeAttribute(b)},removeStyle:function(a){var b=this.$.style;if(b.removeProperty||"border"!=a&&"margin"!=a&&"padding"!=a)b.removeProperty?b.removeProperty(a):b.removeAttribute(POLARIS.tools.cssStyleToDomStyle(a)),this.$.style.cssText||this.removeAttribute("style");else{var c=
["top","left","right","bottom"],e;"border"==a&&(e=["color","style","width"]);for(var b=[],f=0;f<c.length;f++)if(e)for(var l=0;l<e.length;l++)b.push([a,c[f],e[l]].join("-"));else b.push([a,c[f]].join("-"));for(a=0;a<b.length;a++)this.removeStyle(b[a])}},setStyle:function(a,b){if("width"==a||"height"==a)b=POLARIS.tools.cssLength(b);this.$.style[POLARIS.tools.cssStyleToDomStyle(a)]=b;return this},setStyles:function(a){for(var b in a)this.setStyle(b,a[b]);return this},setOpacity:function(a){POLARIS.env.ie&&
9>POLARIS.env.version?(a=Math.round(100*a),this.setStyle("filter",100<=a?"":"progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+a+")")):this.setStyle("opacity",a)},unselectable:function(){this.setStyles(POLARIS.tools.cssVendorPrefix("user-select","none"));if(POLARIS.env.ie){this.setAttribute("unselectable","on");for(var a,b=this.getElementsByTag("*"),c=0,e=b.count();c<e;c++)a=b.getItem(c),a.setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var a=this;"html"!=a.getName();){if("static"!=
a.getComputedStyle("position"))return a;a=a.getParent()}return null},getDocumentPosition:function(a){var b=0,c=0,e=this.getDocument(),f=e.getBody(),l=POLARIS.env.quirks;if(document.documentElement.getBoundingClientRect){var m=this.$.getBoundingClientRect(),n=e.$.documentElement,q=n.clientTop||f.$&&f.$.clientTop||0,v=n.clientLeft||f.$&&f.$.clientLeft||0,r=!0;POLARIS.env.ie&&(r=e.getDocumentElement().contains(this),e=e.getBody().contains(this),r=l&&e||!l&&r);r&&(POLARIS.env.webkit?(b=f.$&&f.$.scrollLeft||
n.scrollLeft,c=f.$&&f.$.scrollTop||n.scrollTop):(c=l?f.$:n,b=c.scrollLeft,c=c.scrollTop),b=m.left+b-v,c=m.top+c-q)}else for(q=this,v=null;q&&"body"!=q.getName()&&"html"!=q.getName();){b+=q.$.offsetLeft-q.$.scrollLeft;c+=q.$.offsetTop-q.$.scrollTop;q.equals(this)||(b+=q.$.clientLeft||0,c+=q.$.clientTop||0);for(;v&&!v.equals(q);)b-=v.$.scrollLeft,c-=v.$.scrollTop,v=v.getParent();v=q;q=(m=q.$.offsetParent)?new POLARIS.dom.element(m):null}a&&(m=this.getWindow(),q=a.getWindow(),!m.equals(q)&&m.$.frameElement&&
(a=(new POLARIS.dom.element(m.$.frameElement)).getDocumentPosition(a),b+=a.x,c+=a.y));document.documentElement.getBoundingClientRect||!POLARIS.env.gecko||l||(b+=this.$.clientLeft?1:0,c+=this.$.clientTop?1:0);return{x:b,y:c}},scrollIntoView:function(a){var b=this.getParent();if(b){var c="BackCompat"==b.getDocument().$.compatMode;do if((b.$.clientWidth&&b.$.clientWidth<b.$.scrollWidth||b.$.clientHeight&&b.$.clientHeight<b.$.scrollHeight)&&!b.is("body")&&this.scrollIntoParent(b,a,1),b.is("html")){var e=
b.getWindow();try{var f=e.$.frameElement;f&&(b=new POLARIS.dom.element(f))}catch(l){}}else if(c&&b.is("body"))break;while(b=b.getParent())}},scrollIntoParent:function(a,b,c){var e,f,l,m;function n(b,c){/body|html/.test(a.getName())?a.getWindow().$.scrollBy(b,c):(a.$.scrollLeft+=b,a.$.scrollTop+=c)}function q(a,b){var c={x:0,y:0};if(!a.is(r?"body":"html")){var d=a.$.getBoundingClientRect();c.x=d.left;c.y=d.top}d=a.getWindow();d.equals(b)||(d=q(POLARIS.dom.element.get(d.$.frameElement),b),c.x+=d.x,
c.y+=d.y);return c}function v(a,b){return parseInt(a.getComputedStyle("margin-"+b)||0,10)||0}!a&&(a=this.getWindow());l=a.getDocument();var r="BackCompat"==l.$.compatMode;a instanceof POLARIS.dom.window&&(a=r?l.getBody():l.getDocumentElement());l=a.getWindow();f=q(this,l);var p=q(a,l),t=this.$.offsetHeight;e=this.$.offsetWidth;var w=a.$.clientHeight,A=a.$.clientWidth;l=f.x-v(this,"left")-p.x||0;m=f.y-v(this,"top")-p.y||0;e=f.x+e+v(this,"right")-(p.x+A)||0;f=f.y+t+v(this,"bottom")-(p.y+w)||0;(0>m||
0<f)&&n(0,!0===b?m:!1===b?f:0>m?m:f);c&&(0>l||0<e)&&n(0>l?l:e,0)},setState:function(a,b,c){b=b||"polaris";switch(a){case POLARIS.TRISTATE_ON:this.addClass(b+"_on");this.removeClass(b+"_off");this.removeClass(b+"_disabled");c&&this.setAttribute("aria-pressed",!0);c&&this.removeAttribute("aria-disabled");break;case POLARIS.TRISTATE_DISABLED:this.addClass(b+"_disabled");this.removeClass(b+"_off");this.removeClass(b+"_on");c&&this.setAttribute("aria-disabled",!0);c&&this.removeAttribute("aria-pressed");
break;default:this.addClass(b+"_off"),this.removeClass(b+"_on"),this.removeClass(b+"_disabled"),c&&this.removeAttribute("aria-pressed"),c&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var a=this.$;try{a.contentWindow.document}catch(b){a.src=a.src}return a&&new POLARIS.dom.document(a.contentWindow.document)},copyAttributes:function(a,b){var c=this.$.attributes;b=b||{};for(var e=0;e<c.length;e++){var f=c[e],l=f.nodeName.toLowerCase(),m;if(!(l in b))if("checked"==l&&(m=this.getAttribute(l)))a.setAttribute(l,
m);else if(!POLARIS.env.ie||this.hasAttribute(l))m=this.getAttribute(l),null===m&&(m=f.nodeValue),a.setAttribute(l,m)}""!==this.$.style.cssText&&(a.$.style.cssText=this.$.style.cssText)},renameNode:function(a){if(this.getName()!=a){var b=this.getDocument();a=new POLARIS.dom.element(a,b);this.copyAttributes(a);this.moveChildren(a);this.getParent()&&this.$.parentNode.replaceChild(a.$,this.$);a.$["data-polaris-expando"]=this.$["data-polaris-expando"];this.$=a.$;delete this.getName}},getChild:function(){function a(b,
c){var d=b.childNodes;if(0<=c&&c<d.length)return d[c]}return function(b){var c=this.$;if(b.slice)for(;0<b.length&&c;)c=a(c,b.shift());else c=a(c,b);return c?new POLARIS.dom.node(c):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){this.on("contextmenu",function(a){a.data.getTarget().hasClass("polaris_enable_context_menu")||a.data.preventDefault()})},getDirection:function(a){return a?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&
this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(a,b){a="data-"+a;if(void 0===b)return this.getAttribute(a);!1===b?this.removeAttribute(a):this.setAttribute(a,b);return null},getEditor:function(){var a=POLARIS.instances,b,c;for(b in a)if(c=a[b],c.element.equals(this)&&c.elementMode!=POLARIS.ELEMENT_MODE_APPENDTO)return c;return null},find:function(b){var c=a(this);b=new POLARIS.dom.nodeList(this.$.querySelectorAll(e(this,
b)));c();return b},findOne:function(b){var c=a(this);b=this.$.querySelector(e(this,b));c();return b?new POLARIS.dom.element(b):null},forEach:function(a,b,c){if(!(c||b&&this.type!=b))var e=a(this);if(!1!==e){c=this.getChildren();for(var f=0;f<c.count();f++)e=c.getItem(f),e.type==POLARIS.NODE_ELEMENT?e.forEach(a,b):b&&e.type!=b||a(e)}},getTextNodes:function(){for(var a=[],b=0;b<this.getChildCount();b++){var c=this.getChild(b);c.type==POLARIS.NODE_TEXT?a.push(c):c.type==POLARIS.NODE_ELEMENT&&(a=a.concat(c.getTextNodes()))}return a},
getTextBrNodes:function(){for(var a=[],b=0;b<this.getChildCount();b++){var c=this.getChild(b);c.type==POLARIS.NODE_TEXT?a.push(c):c.type==POLARIS.NODE_ELEMENT&&(a=c.is("br")?a.concat(c):a.concat(c.getTextBrNodes()))}return a},getChildNodes:function(){for(var a=[],b=0;b<this.getChildCount();b++){var c=this.getChild(b);a.push(c);c.type==POLARIS.NODE_ELEMENT&&(a=a.concat(c.getChildNodes()))}return a},hasImageAsChild:function(){return this.findOne("img")?!0:!1},mergeSiblingAllElements:function(){var a=
this.getFirst(),b=0,c=0,e=b=null;if(a&&a.type===POLARIS.NODE_ELEMENT)for(b=a.getNext();b;)a.type===POLARIS.NODE_ELEMENT&&!a.is({br:1})&&b.type===POLARIS.NODE_ELEMENT&&b.isIdentical(a)?(b.moveChildren(a,!1),b.remove(!0),b=a.getNext()):(a=b,b=b.getNext());c=this.getChildCount();for(b=0;b<c;b+=1)e=this.getChild(b),e.type===POLARIS.NODE_ELEMENT&&e.mergeSiblingAllElements()},mergeTextNodes:function(){for(var a=0,b=null,c=null,a=this.getChildCount()-1;0<=a;--a)b=this.getChild(a),b.type===POLARIS.NODE_TEXT?
(c=b.getPrevious())&&c.type==POLARIS.NODE_TEXT&&(c.setText(c.getText()+b.getText()),b.remove()):b.type===POLARIS.NODE_ELEMENT&&b.mergeTextNodes()}});var c={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};POLARIS.dom.element.prototype.setSize=function(a,c,e){"number"==typeof c&&(!e||POLARIS.env.ie&&POLARIS.env.quirks||(c-=b.call(this,a)),this.setStyle(a,c+"px"))};POLARIS.dom.element.prototype.getSize=
function(a,c){var e=Math.max(this.$["offset"+POLARIS.tools.capitalize(a)],this.$["client"+POLARIS.tools.capitalize(a)])||0;c&&(e-=b.call(this,a));return e}})();POLARIS.dom.documentFragment=function(a){a=a||POLARIS.document;this.$=a.type==POLARIS.NODE_DOCUMENT?a.$.createDocumentFragment():a};POLARIS.tools.extend(POLARIS.dom.documentFragment.prototype,POLARIS.dom.element.prototype,{type:POLARIS.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(a){a=a.$;a.parentNode.insertBefore(this.$,a.nextSibling)}},
!0,{append:1,appendBogus:1,getFirst:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1});(function(){function a(a,b){var c=this.range;if(this._.end)return null;if(!this._.start){this._.start=1;if(c.collapsed)return this.end(),null;c.optimize()}var d,e=c.startContainer;d=c.endContainer;var m=c.startOffset,f=c.endOffset,h,g=this.guard,k=this.type,l=a?
"getPreviousSourceNode":"getNextSourceNode";if(!a&&!this._.guardLTR){var n=d.type==POLARIS.NODE_ELEMENT?d:d.getParent(),y=d.type==POLARIS.NODE_ELEMENT?d.getChild(f):d.getNext();this._.guardLTR=function(a,b){return(!b||!n.equals(a))&&(!y||!a.equals(y))&&(a.type!=POLARIS.NODE_ELEMENT||!b||!a.equals(c.root))}}if(a&&!this._.guardRTL){var F=e.type==POLARIS.NODE_ELEMENT?e:e.getParent(),E=e.type==POLARIS.NODE_ELEMENT?m?e.getChild(m-1):null:e.getPrevious();this._.guardRTL=function(a,b){return(!b||!F.equals(a))&&
(!E||!a.equals(E))&&(a.type!=POLARIS.NODE_ELEMENT||!b||!a.equals(c.root))}}var H=a?this._.guardRTL:this._.guardLTR;h=g?function(a,b){return!1===H(a,b)?!1:g(a,b)}:H;this.current?d=this.current[l](!1,k,h):(a?d.type==POLARIS.NODE_ELEMENT&&(d=0<f?d.getChild(f-1):!1===h(d,!0)?null:d.getPreviousSourceNode(!0,k,h)):(d=e,d.type==POLARIS.NODE_ELEMENT&&((d=d.getChild(m))||(d=!1===h(e,!0)?null:e.getNextSourceNode(!0,k,h)))),d&&!1===h(d)&&(d=null));for(;d&&!this._.end;){this.current=d;if(!this.evaluator||!1!==
this.evaluator(d)){if(!b)return d}else if(b&&this.evaluator)return!1;d=d[l](!1,k,h)}this.end();return this.current=null}function e(b){for(var c,d=null;c=a.call(this,b);)d=c;return d}function b(a){if(m(a))return!1;if(a.type==POLARIS.NODE_TEXT)return!0;if(a.type==POLARIS.NODE_ELEMENT){if(a.is(POLARIS.dtd.$inline)||a.is("hr")||"false"==a.getAttribute("contenteditable"))return!0;var b;if(b=!POLARIS.env.needsBrFiller&&a.is(n))a:{b=0;for(var c=a.getChildCount();b<c;++b)if(!m(a.getChild(b))){b=!1;break a}b=
!0}if(b)return!0}return!1}POLARIS.dom.walker=POLARIS.tools.createClass({$:function(a){this.range=a;this._={}},proto:{end:function(){this._.end=1},next:function(){return a.call(this)},previous:function(){return a.call(this,1)},checkForward:function(){return!1!==a.call(this,0,1)},checkBackward:function(){return!1!==a.call(this,1,1)},lastForward:function(){return e.call(this)},lastBackward:function(){return e.call(this,1)},reset:function(){delete this.current;this._={}}}});var c={block:1,"list-item":1,
table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},d={absolute:1,fixed:1};POLARIS.dom.element.prototype.isBlockBoundary=function(a){return"none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in d||!c[this.getComputedStyle("display")]?!!(this.is(POLARIS.dtd.$block)||a&&this.is(a)):!0};POLARIS.dom.walker.blockBoundary=function(a){return function(b){return!(b.type==POLARIS.NODE_ELEMENT&&
b.isBlockBoundary(a))}};POLARIS.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})};POLARIS.dom.walker.bookmark=function(a,b){function c(a){return a&&a.getName&&"span"==a.getName()&&a.data("polaris-bookmark")}return function(d){var e,m;e=d&&d.type!=POLARIS.NODE_ELEMENT&&(m=d.getParent())&&c(m);e=a?e:e||c(d);return!!(b^e)}};POLARIS.dom.walker.whitespaces=function(a){return function(b){var c;b&&b.type==POLARIS.NODE_TEXT&&(c=!POLARIS.tools.trim(b.getText())||POLARIS.env.webkit&&
b.getText()==POLARIS.dom.selection.FILLING_CHAR_SEQUENCE);return!!(a^c)}};POLARIS.dom.walker.invisible=function(a){var b=POLARIS.dom.walker.whitespaces(),c=POLARIS.env.webkit?1:0;return function(d){b(d)?d=1:(d.type==POLARIS.NODE_TEXT&&(d=d.getParent()),d=d.$.offsetWidth<=c);return!!(a^d)}};POLARIS.dom.walker.nodeType=function(a,b){return function(c){return!!(b^c.type==a)}};POLARIS.dom.walker.bogus=function(a){function b(a){return!g(a)&&!k(a)}return function(c){var d=POLARIS.env.needsBrFiller?c.is&&
c.is("br"):c.getText&&h.test(c.getText());d&&(d=c.getParent(),c=c.getNext(b),d=d.isBlockBoundary()&&(!c||c.type==POLARIS.NODE_ELEMENT&&c.isBlockBoundary()));return!!(a^d)}};POLARIS.dom.walker.temp=function(a){return function(b){b.type!=POLARIS.NODE_ELEMENT&&(b=b.getParent());b=b&&b.hasAttribute("data-polaris-temp");return!!(a^b)}};var h=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,g=POLARIS.dom.walker.whitespaces(),k=POLARIS.dom.walker.bookmark(),f=POLARIS.dom.walker.temp(),l=function(a){return k(a)||g(a)||a.type==
POLARIS.NODE_ELEMENT&&a.is(POLARIS.dtd.$inline)&&!a.is(POLARIS.dtd.$empty)};POLARIS.dom.walker.ignored=function(a){return function(b){b=g(b)||k(b)||f(b);return!!(a^b)}};var m=POLARIS.dom.walker.ignored(),n=function(a){var b={},c;for(c in a)POLARIS.dtd[c]["#"]&&(b[c]=1);return b}(POLARIS.dtd.$block);POLARIS.dom.walker.editable=function(a){return function(c){return!!(a^b(c))}};POLARIS.dom.element.prototype.getBogus=function(){var a=this;do a=a.getPreviousSourceNode();while(a&&l(a));return a&&(POLARIS.env.needsBrFiller?
a.is&&a.is("br"):a.getText&&h.test(a.getText()))?a:!1}})();POLARIS.dom.range=function(a){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null;this.collapsed=!0;var e=a instanceof POLARIS.dom.document;this.document=e?a:a.getDocument();this.root=e?a.getBody():a};(function(){function a(){var a=!1,b=POLARIS.dom.walker.whitespaces(),c=POLARIS.dom.walker.bookmark(!0),d=POLARIS.dom.walker.bogus();return function(e){return c(e)||b(e)?!0:d(e)&&!a?a=!0:e.type==POLARIS.NODE_TEXT&&(e.hasAscendant("pre")||
POLARIS.tools.trim(e.getText().replace(/\u200b/g,"")).length)||e.type==POLARIS.NODE_ELEMENT&&!e.is(h)?!1:!0}}function e(a){var b=POLARIS.dom.walker.whitespaces(),c=POLARIS.dom.walker.bookmark(1);return function(d){return c(d)||b(d)||d.type==POLARIS.NODE_TEXT&&0==d.getText().replace(/\u200b/g,"").length?!0:!a&&g(d)||d.type==POLARIS.NODE_ELEMENT&&d.is(POLARIS.dtd.$removeEmpty)}}function b(a){return function(){var b;return this[a?"getPreviousNode":"getNextNode"](function(a){!b&&l(a)&&(b=a);return f(a)&&
!(g(a)&&a.equals(b))})}}var c=function(a){a.collapsed=a.startContainer&&a.endContainer&&a.startContainer.equals(a.endContainer)&&a.startOffset==a.endOffset},d=function(a,b,c,d){a.optimizeBookmark();var e=a.startContainer,f=a.endContainer,h=a.startOffset,g=a.endOffset,k,l;f.type==POLARIS.NODE_TEXT?f=f.split(g):0<f.getChildCount()&&(g>=f.getChildCount()?(f=f.append(a.document.createText("")),l=!0):f=f.getChild(g));e.type==POLARIS.NODE_TEXT?(e.split(h),e.equals(f)&&(f=e.getNext())):h?h>=e.getChildCount()?
(e=e.append(a.document.createText("")),k=!0):e=e.getChild(h).getPrevious():(e=e.append(a.document.createText(""),1),k=!0);var h=e.getParents(),g=f.getParents(),C,u,B;for(C=0;C<h.length&&(u=h[C],B=g[C],u.equals(B));C++);for(var G=c,y,F,E,H=C;H<h.length;H++){y=h[H];G&&!y.equals(e)&&(F=G.append(y.clone()));for(y=y.getNext();y&&!y.equals(g[H])&&!y.equals(f);)E=y.getNext(),2==b?G.append(y.clone(!0)):(y.remove(),1==b&&G.append(y)),y=E;G&&(G=F)}G=c;for(c=C;c<g.length;c++){y=g[c];0<b&&!y.equals(f)&&(F=G.append(y.clone()));
if(!h[c]||y.$.parentNode!=h[c].$.parentNode)for(y=y.getPrevious();y&&!y.equals(h[c])&&!y.equals(e);)E=y.getPrevious(),2==b?G.$.insertBefore(y.$.cloneNode(!0),G.$.firstChild):(y.remove(),1==b&&G.$.insertBefore(y.$,G.$.firstChild)),y=E;G&&(G=F)}2==b?(u=a.startContainer,u.type==POLARIS.NODE_TEXT&&(u.$.data+=u.$.nextSibling.data,u.$.parentNode.removeChild(u.$.nextSibling)),a=a.endContainer,a.type==POLARIS.NODE_TEXT&&a.$.nextSibling&&(a.$.data+=a.$.nextSibling.data,a.$.parentNode.removeChild(a.$.nextSibling))):
(u&&B&&(e.$.parentNode!=u.$.parentNode||f.$.parentNode!=B.$.parentNode)&&(b=B.getIndex(),k&&B.$.parentNode==e.$.parentNode&&b--,d&&u.type==POLARIS.NODE_ELEMENT?(d=POLARIS.dom.element.createFromHtml('\x3cspan data-polaris-bookmark\x3d"1" style\x3d"display:none"\x3e\x26nbsp;\x3c/span\x3e',a.document),d.insertAfter(u),u.mergeSiblings(!1),a.moveToBookmark({startNode:d})):a.setStart(B.getParent(),b)),a.collapse(!0));k&&e.remove();l&&f.$.parentNode&&f.remove()},h={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,
code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},g=POLARIS.dom.walker.bogus(),k=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,f=POLARIS.dom.walker.editable(),l=POLARIS.dom.walker.ignored(!0);POLARIS.dom.range.prototype={clone:function(){var a=new POLARIS.dom.range(this.root);a._setStartContainer(this.startContainer);a.startOffset=this.startOffset;a._setEndContainer(this.endContainer);a.endOffset=this.endOffset;a.collapsed=this.collapsed;
return a},collapse:function(a){a?(this._setEndContainer(this.startContainer),this.endOffset=this.startOffset):(this._setStartContainer(this.endContainer),this.startOffset=this.endOffset);this.collapsed=!0},cloneContents:function(){var a=new POLARIS.dom.documentFragment(this.document);this.collapsed||d(this,2,a);return a},deleteContents:function(a){this.collapsed||d(this,0,null,a)},extractContents:function(a){var b=new POLARIS.dom.documentFragment(this.document);this.collapsed||d(this,1,b,a);return b},
createBookmark:function(a){var b,c,d,e,f=this.collapsed;b=this.document.createElement("span");b.data("polaris-bookmark",1);b.setStyle("display","none");b.setHtml("\x26nbsp;");a&&(d="polaris_bm_"+POLARIS.tools.getNextNumber(),b.setAttribute("id",d+(f?"C":"S")));f||(c=b.clone(),c.setHtml("\x26nbsp;"),a&&c.setAttribute("id",d+"E"),e=this.clone(),e.collapse(),e.insertNode(c));e=this.clone();e.collapse(!0);e.insertNode(b);c?(this.setStartAfter(b),this.setEndBefore(c)):this.moveToPosition(b,POLARIS.POSITION_AFTER_END);
return{startNode:a?d+(f?"C":"S"):b,endNode:a?d+"E":c,serializable:a,collapsed:f}},createBookmark2:function(){function a(b){var d=b.container,e=b.offset,m;m=d;var f=e;m=m.type!=POLARIS.NODE_ELEMENT||0===f||f==m.getChildCount()?0:m.getChild(f-1).type==POLARIS.NODE_TEXT&&m.getChild(f).type==POLARIS.NODE_TEXT;m&&(d=d.getChild(e-1),e=d.getLength());if(d.type==POLARIS.NODE_ELEMENT&&0<e){a:{for(m=d;e--;)if(f=m.getChild(e).getIndex(!0),0<=f){e=f;break a}e=-1}e+=1}if(d.type==POLARIS.NODE_TEXT){m=d;for(f=0;(m=
m.getPrevious())&&m.type==POLARIS.NODE_TEXT;)f+=m.getText().replace(POLARIS.dom.selection.FILLING_CHAR_SEQUENCE,"").length;m=f;d.getText()?e+=m:(f=d.getPrevious(c),m?(e=m,d=f?f.getNext():d.getParent().getFirst()):(d=d.getParent(),e=f?f.getIndex(!0)+1:0))}b.container=d;b.offset=e}function b(a,c){var d=c.getCustomData("polaris-fillingChar");if(d){var e=a.container;d.equals(e)&&(a.offset-=POLARIS.dom.selection.FILLING_CHAR_SEQUENCE.length,0>=a.offset&&(a.offset=e.getIndex(),a.container=e.getParent()))}}
var c=POLARIS.dom.walker.nodeType(POLARIS.NODE_TEXT,!0);return function(c){var d=this.collapsed,e={container:this.startContainer,offset:this.startOffset},f={container:this.endContainer,offset:this.endOffset};c&&(a(e),b(e,this.root),d||(a(f),b(f,this.root)));return{start:e.container.getAddress(c),end:d?null:f.container.getAddress(c),startOffset:e.offset,endOffset:f.offset,normalized:c,collapsed:d,is2:!0}}}(),moveToBookmark:function(a){if(a.is2){var b=this.document.getByAddress(a.start,a.normalized),
c=a.startOffset,d=a.end&&this.document.getByAddress(a.end,a.normalized);a=a.endOffset;this.setStart(b,c);d?this.setEnd(d,a):this.collapse(!0)}else b=(c=a.serializable)?this.document.getById(a.startNode):a.startNode,a=c?this.document.getById(a.endNode):a.endNode,this.setStartBefore(b),b.remove(),a?(this.setEndBefore(a),a.remove()):this.collapse(!0)},getBoundaryNodes:function(){var a=this.startContainer,b=this.endContainer,c=this.startOffset,d=this.endOffset,e;if(a.type==POLARIS.NODE_ELEMENT)if(e=a.getChildCount(),
e>c)a=a.getChild(c);else if(1>e)a=a.getPreviousSourceNode();else{for(a=a.$;a.lastChild;)a=a.lastChild;a=new POLARIS.dom.node(a);a=a.getNextSourceNode()||a}if(b.type==POLARIS.NODE_ELEMENT)if(e=b.getChildCount(),e>d)b=b.getChild(d).getPreviousSourceNode(!0);else if(1>e)b=b.getPreviousSourceNode();else{for(b=b.$;b.lastChild;)b=b.lastChild;b=new POLARIS.dom.node(b)}a.getPosition(b)&POLARIS.POSITION_FOLLOWING&&(a=b);return{startNode:a,endNode:b}},getCommonAncestor:function(a,b){var c=this.startContainer,
d=this.endContainer,c=c.equals(d)?a&&c.type==POLARIS.NODE_ELEMENT&&this.startOffset==this.endOffset-1?c.getChild(this.startOffset):c:c.getCommonAncestor(d);return b&&!c.is?c.getParent():c},optimize:function(){var a=this.startContainer,b=this.startOffset;a.type!=POLARIS.NODE_ELEMENT&&(b?b>=a.getLength()&&this.setStartAfter(a):this.setStartBefore(a));a=this.endContainer;b=this.endOffset;a.type!=POLARIS.NODE_ELEMENT&&(b?b>=a.getLength()&&this.setEndAfter(a):this.setEndBefore(a))},optimizeBookmark:function(){var a=
this.startContainer,b=this.endContainer;a.is&&a.is("span")&&a.data("polaris-bookmark")&&this.setStartAt(a,POLARIS.POSITION_BEFORE_START);b&&b.is&&b.is("span")&&b.data("polaris-bookmark")&&this.setEndAt(b,POLARIS.POSITION_AFTER_END)},trim:function(a,b){var c=this.startContainer,d=this.startOffset,e=this.collapsed;if((!a||e)&&c&&c.type==POLARIS.NODE_TEXT){if(d)if(d>=c.getLength())d=c.getIndex()+1,c=c.getParent();else{var f=c.split(d),d=c.getIndex()+1,c=c.getParent();this.startContainer.equals(this.endContainer)?
this.setEnd(f,this.endOffset-this.startOffset):c.equals(this.endContainer)&&(this.endOffset+=1)}else d=c.getIndex(),c=c.getParent();this.setStart(c,d);if(e){this.collapse(!0);return}}c=this.endContainer;d=this.endOffset;b||e||!c||c.type!=POLARIS.NODE_TEXT||(d?(d>=c.getLength()||c.split(d),d=c.getIndex()+1):d=c.getIndex(),c=c.getParent(),this.setEnd(c,d))},enlarge:function(a,b){function c(a){return a&&a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute("contenteditable")?null:a}var d=new RegExp(/[^\s\ufeff]/);
switch(a){case POLARIS.ENLARGE_INLINE:var e=1;case POLARIS.ENLARGE_ELEMENT:var f=function(a,b){var c=new POLARIS.dom.range(g);c.setStart(a,b);c.setEndAt(g,POLARIS.POSITION_BEFORE_END);var c=new POLARIS.dom.walker(c),e;for(c.guard=function(a){return!(a.type==POLARIS.NODE_ELEMENT&&a.isBlockBoundary())};e=c.next();){if(e.type!=POLARIS.NODE_TEXT)return!1;F=e!=a?e.getText():e.substring(b);if(d.test(F))return!1}return!0};if(this.collapsed)break;var h=this.getCommonAncestor(),g=this.root,k,l,C,u,B,G=!1,
y,F;y=this.startContainer;var E=this.startOffset;y.type==POLARIS.NODE_TEXT?(E&&(y=!POLARIS.tools.trim(y.substring(0,E)).length&&y,G=!!y),y&&((u=y.getPrevious())||(C=y.getParent()))):(E&&(u=y.getChild(E-1)||y.getLast()),u||(C=y));for(C=c(C);C||u;){if(C&&!u){!B&&C.equals(h)&&(B=!0);if(e?C.isBlockBoundary():!g.contains(C))break;G&&"inline"==C.getComputedStyle("display")||(G=!1,B?k=C:this.setStartBefore(C));u=C.getPrevious()}for(;u;)if(y=!1,u.type==POLARIS.NODE_COMMENT)u=u.getPrevious();else{if(u.type==
POLARIS.NODE_TEXT)F=u.getText(),d.test(F)&&(u=null),y=/[\s\ufeff]$/.test(F);else if((u.$.offsetWidth>(POLARIS.env.webkit?1:0)||b&&u.is("br"))&&!u.data("polaris-bookmark"))if(G&&POLARIS.dtd.$removeEmpty[u.getName()]){F=u.getText();if(d.test(F))u=null;else for(var E=u.$.getElementsByTagName("*"),H=0,J;J=E[H++];)if(!POLARIS.dtd.$removeEmpty[J.nodeName.toLowerCase()]){u=null;break}u&&(y=!!F.length)}else u=null;y&&(G?B?k=C:C&&this.setStartBefore(C):G=!0);if(u){y=u.getPrevious();if(!C&&!y){C=u;u=null;break}u=
y}else C=null}C&&(C=c(C.getParent()))}y=this.endContainer;E=this.endOffset;C=u=null;B=G=!1;y.type==POLARIS.NODE_TEXT?POLARIS.tools.trim(y.substring(E)).length?G=!0:(G=!y.getLength(),E==y.getLength()?(u=y.getNext())||(C=y.getParent()):f(y,E)&&(C=y.getParent())):(u=y.getChild(E))||(C=y);for(;C||u;){if(C&&!u){!B&&C.equals(h)&&(B=!0);if(e?C.isBlockBoundary():!g.contains(C))break;G&&"inline"==C.getComputedStyle("display")||(G=!1,B?l=C:C&&this.setEndAfter(C));u=C.getNext()}for(;u;){y=!1;if(u.type==POLARIS.NODE_TEXT)F=
u.getText(),f(u,0)||(u=null),y=/^[\s\ufeff]/.test(F);else if(u.type==POLARIS.NODE_ELEMENT){if((0<u.$.offsetWidth||b&&u.is("br"))&&!u.data("polaris-bookmark"))if(G&&POLARIS.dtd.$removeEmpty[u.getName()]){F=u.getText();if(d.test(F))u=null;else for(E=u.$.getElementsByTagName("*"),H=0;J=E[H++];)if(!POLARIS.dtd.$removeEmpty[J.nodeName.toLowerCase()]){u=null;break}u&&(y=!!F.length)}else u=null}else y=1;y&&G&&(B?l=C:this.setEndAfter(C));if(u){y=u.getNext();if(!C&&!y){C=u;u=null;break}u=y}else C=null}C&&
(C=c(C.getParent()))}k&&l&&(h=k.contains(l)?l:k,this.setStartBefore(h),this.setEndAfter(h));break;case POLARIS.ENLARGE_BLOCK_CONTENTS:case POLARIS.ENLARGE_LIST_ITEM_CONTENTS:C=new POLARIS.dom.range(this.root);g=this.root;C.setStartAt(g,POLARIS.POSITION_AFTER_START);C.setEnd(this.startContainer,this.startOffset);C=new POLARIS.dom.walker(C);var I,L,z=POLARIS.dom.walker.blockBoundary(a==POLARIS.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),D=null,O=function(a){if(a.type==POLARIS.NODE_ELEMENT&&"false"==a.getAttribute("contenteditable"))if(D){if(D.equals(a)){D=
null;return}}else D=a;else if(D)return;var b=z(a);b||(I=a);return b},e=function(a){var b=O(a);!b&&a.is&&a.is("br")&&(L=a);return b};C.guard=O;C=C.lastBackward();I=I||g;this.setStartAt(I,!I.is("br")&&(!C&&this.checkStartOfBlock()||C&&I.contains(C))?POLARIS.POSITION_AFTER_START:POLARIS.POSITION_AFTER_END);if(a==POLARIS.ENLARGE_LIST_ITEM_CONTENTS){C=this.clone();C=new POLARIS.dom.walker(C);var P=POLARIS.dom.walker.whitespaces(),X=POLARIS.dom.walker.bookmark();C.evaluator=function(a){return!P(a)&&!X(a)};
if((C=C.previous())&&C.type==POLARIS.NODE_ELEMENT&&C.is("br"))break}C=this.clone();C.collapse();C.setEndAt(g,POLARIS.POSITION_BEFORE_END);C=new POLARIS.dom.walker(C);C.guard=a==POLARIS.ENLARGE_LIST_ITEM_CONTENTS?e:O;I=D=L=null;C=C.lastForward();I=I||g;this.setEndAt(I,!C&&this.checkEndOfBlock()||C&&I.contains(C)?POLARIS.POSITION_BEFORE_END:POLARIS.POSITION_BEFORE_START);L&&this.setEndAfter(L)}},shrink:function(a,b,c){if(!this.collapsed){a=a||POLARIS.SHRINK_TEXT;var d=this.clone(),e=this.startContainer,
f=this.endContainer,h=this.startOffset,g=this.endOffset,k=1,l=1;e&&e.type==POLARIS.NODE_TEXT&&(h?h>=e.getLength()?d.setStartAfter(e):(d.setStartBefore(e),k=0):d.setStartBefore(e));f&&f.type==POLARIS.NODE_TEXT&&(g?g>=f.getLength()?d.setEndAfter(f):(d.setEndAfter(f),l=0):d.setEndBefore(f));var d=new POLARIS.dom.walker(d),C=POLARIS.dom.walker.bookmark();d.evaluator=function(b){return b.type==(a==POLARIS.SHRINK_ELEMENT?POLARIS.NODE_ELEMENT:POLARIS.NODE_TEXT)};var u;d.guard=function(b,d){if(C(b))return!0;
if(a==POLARIS.SHRINK_ELEMENT&&b.type==POLARIS.NODE_TEXT||d&&b.equals(u)||!1===c&&b.type==POLARIS.NODE_ELEMENT&&b.isBlockBoundary()||b.type==POLARIS.NODE_ELEMENT&&b.hasAttribute("contenteditable"))return!1;d||b.type!=POLARIS.NODE_ELEMENT||(u=b);return!0};k&&(e=d[a==POLARIS.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(e,b?POLARIS.POSITION_AFTER_START:POLARIS.POSITION_BEFORE_START);l&&(d.reset(),(d=d[a==POLARIS.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(d,b?POLARIS.POSITION_BEFORE_END:
POLARIS.POSITION_AFTER_END));return!(!k&&!l)}},insertNode:function(a){this.optimizeBookmark();this.trim(!1,!0);var b=this.startContainer,c=b.getChild(this.startOffset);c?a.insertBefore(c):b.append(a);a.getParent()&&a.getParent().equals(this.endContainer)&&this.endOffset++;this.setStartBefore(a)},moveToPosition:function(a,b){this.setStartAt(a,b);this.collapse(!0)},moveToRange:function(a){this.setStart(a.startContainer,a.startOffset);this.setEnd(a.endContainer,a.endOffset)},selectNodeContents:function(a){this.setStart(a,
0);this.setEnd(a,a.type==POLARIS.NODE_TEXT?a.getLength():a.getChildCount())},setStart:function(a,b){a.type==POLARIS.NODE_ELEMENT&&POLARIS.dtd.$empty[a.getName()]&&(b=a.getIndex(),a=a.getParent());this._setStartContainer(a);this.startOffset=b;this.endContainer||(this._setEndContainer(a),this.endOffset=b);c(this)},setEnd:function(a,b){a.type==POLARIS.NODE_ELEMENT&&POLARIS.dtd.$empty[a.getName()]&&(b=a.getIndex()+1,a=a.getParent());this._setEndContainer(a);this.endOffset=b;this.startContainer||(this._setStartContainer(a),
this.startOffset=b);c(this)},setStartAfter:function(a){this.setStart(a.getParent(),a.getIndex()+1)},setStartBefore:function(a){this.setStart(a.getParent(),a.getIndex())},setEndAfter:function(a){this.setEnd(a.getParent(),a.getIndex()+1)},setEndBefore:function(a){this.setEnd(a.getParent(),a.getIndex())},setStartAt:function(a,b){switch(b){case POLARIS.POSITION_AFTER_START:this.setStart(a,0);break;case POLARIS.POSITION_BEFORE_END:a.type==POLARIS.NODE_TEXT?this.setStart(a,a.getLength()):this.setStart(a,
a.getChildCount());break;case POLARIS.POSITION_BEFORE_START:this.setStartBefore(a);break;case POLARIS.POSITION_AFTER_END:this.setStartAfter(a)}c(this)},setEndAt:function(a,b){switch(b){case POLARIS.POSITION_AFTER_START:this.setEnd(a,0);break;case POLARIS.POSITION_BEFORE_END:a.type==POLARIS.NODE_TEXT?this.setEnd(a,a.getLength()):this.setEnd(a,a.getChildCount());break;case POLARIS.POSITION_BEFORE_START:this.setEndBefore(a);break;case POLARIS.POSITION_AFTER_END:this.setEndAfter(a)}c(this)},fixBlock:function(a,
b,c){var d=this.createBookmark();b=this.document.createElement(b,c);this.collapse(a);this.enlarge(POLARIS.ENLARGE_BLOCK_CONTENTS);this.extractContents().appendTo(b);b.trim();b.appendBogus();this.insertNode(b);this.moveToBookmark(d);return b},splitBlock:function(a){var b=new POLARIS.dom.elementPath(this.startContainer,this.root),c=new POLARIS.dom.elementPath(this.endContainer,this.root),d=b.block,e=c.block,f=null;if(!b.blockLimit.equals(c.blockLimit))return null;"br"!=a&&(d||(d=this.fixBlock(!0,a),
e=(new POLARIS.dom.elementPath(this.endContainer,this.root)).block),e||(e=this.fixBlock(!1,a)));a=d&&this.checkStartOfBlock();b=e&&this.checkEndOfBlock();this.deleteContents();d&&d.equals(e)&&(b?(f=new POLARIS.dom.elementPath(this.startContainer,this.root),this.moveToPosition(e,POLARIS.POSITION_AFTER_END),e=null):a?(f=new POLARIS.dom.elementPath(this.startContainer,this.root),this.moveToPosition(d,POLARIS.POSITION_BEFORE_START),d=null):(e=this.splitElement(d),d.is("ul","ol")||d.appendBogus()));return{previousBlock:d,
nextBlock:e,wasStartOfBlock:a,wasEndOfBlock:b,elementPath:f}},splitElement:function(a){if(!this.collapsed)return null;this.setEndAt(a,POLARIS.POSITION_BEFORE_END);var b=this.extractContents(),c=a.clone(!1);b.appendTo(c);c.insertAfter(a);this.moveToPosition(a,POLARIS.POSITION_AFTER_END);return c},removeEmptyBlocksAtEnd:function(){function a(d){return function(a){return b(a)||c(a)||a.type==POLARIS.NODE_ELEMENT&&a.isEmptyInlineRemoveable()||d.is("table")&&a.is("caption")?!1:!0}}var b=POLARIS.dom.walker.whitespaces(),
c=POLARIS.dom.walker.bookmark(!1);return function(b){for(var c=this.createBookmark(),d=this[b?"endPath":"startPath"](),e=d.block||d.blockLimit,f;e&&!e.equals(d.root)&&!e.getFirst(a(e));)f=e.getParent(),this[b?"setEndAt":"setStartAt"](e,POLARIS.POSITION_AFTER_END),e.remove(),e=f;this.moveToBookmark(c)}}(),startPath:function(){return new POLARIS.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new POLARIS.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(a,
b){var c=b==POLARIS.START,d=this.clone();d.collapse(c);d[c?"setStartAt":"setEndAt"](a,c?POLARIS.POSITION_AFTER_START:POLARIS.POSITION_BEFORE_END);d=new POLARIS.dom.walker(d);d.evaluator=e(c);return d[c?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var b=this.startContainer,c=this.startOffset;POLARIS.env.ie&&c&&b.type==POLARIS.NODE_TEXT&&(b=POLARIS.tools.ltrim(b.substring(0,c)),k.test(b)&&this.trim(0,1));this.trim();b=new POLARIS.dom.elementPath(this.startContainer,this.root);c=this.clone();
c.collapse(!0);c.setStartAt(b.block||b.blockLimit,POLARIS.POSITION_AFTER_START);b=new POLARIS.dom.walker(c);b.evaluator=a();return b.checkBackward()},checkEndOfBlock:function(){var b=this.endContainer,c=this.endOffset;POLARIS.env.ie&&b.type==POLARIS.NODE_TEXT&&(b=POLARIS.tools.rtrim(b.substring(c)),k.test(b)&&this.trim(1,0));this.trim();b=new POLARIS.dom.elementPath(this.endContainer,this.root);c=this.clone();c.collapse(!1);c.setEndAt(b.block||b.blockLimit,POLARIS.POSITION_BEFORE_END);b=new POLARIS.dom.walker(c);
b.evaluator=a();return b.checkForward()},getPreviousNode:function(a,b,c){var d=this.clone();d.collapse(1);d.setStartAt(c||this.root,POLARIS.POSITION_AFTER_START);c=new POLARIS.dom.walker(d);c.evaluator=a;c.guard=b;return c.previous()},getNextNode:function(a,b,c){var d=this.clone();d.collapse();d.setEndAt(c||this.root,POLARIS.POSITION_BEFORE_END);c=new POLARIS.dom.walker(d);c.evaluator=a;c.guard=b;return c.next()},checkReadOnly:function(){function a(b,c){for(;b;){if(b.type==POLARIS.NODE_ELEMENT){if("false"==
b.getAttribute("contentEditable")&&!b.data("polaris-editable"))return 0;if(b.is("html")||"true"==b.getAttribute("contentEditable")&&(b.contains(c)||b.equals(c)))break}b=b.getParent()}return 1}return function(){var b=this.startContainer,c=this.endContainer;return!(a(b,c)&&a(c,b))}}(),moveToLeafElementEditablePosition:function(a,b,c){function d(a,c,e){var f;e||a.type!=POLARIS.NODE_ELEMENT||(f=a[b?"getLast":"getFirst"](l));c||f||(f=a[b?"getPrevious":"getNext"](l));return f}for(var e="",f=0;a;){if(a.type==
POLARIS.NODE_TEXT){b&&this.endContainer&&this.checkEndOfBlock()&&k.test(a.getText())?this.moveToPosition(a,POLARIS.POSITION_BEFORE_START):this.moveToPosition(a,b?POLARIS.POSITION_AFTER_END:POLARIS.POSITION_BEFORE_START);f=1;break}a.type!=POLARIS.NODE_COMMENT&&(e=a.getName());if("object"==typeof c){if(c[e]){a=d(a,0,1);continue}}else for(var h=2;h<arguments.length;h++)arguments[h]==e&&(a=d(a,0,1));if(!a)break;a.type==POLARIS.NODE_ELEMENT&&(a.isEditable()?(this.moveToPosition(a,b?POLARIS.POSITION_BEFORE_END:
POLARIS.POSITION_AFTER_START),f=1):b&&a.is("br")&&this.endContainer&&this.checkEndOfBlock()&&this.moveToPosition(a,POLARIS.POSITION_BEFORE_START));a=d(a,f,0)}return!!f},moveToElementEditablePosition:function(a,b){if(a.type==POLARIS.NODE_ELEMENT&&!a.isEditable(!1))return this.moveToPosition(a,b?POLARIS.POSITION_AFTER_END:POLARIS.POSITION_BEFORE_START),!0;for(var c=0;a;){if(a.type==POLARIS.NODE_TEXT){b&&this.endContainer&&this.checkEndOfBlock()&&k.test(a.getText())?this.moveToPosition(a,POLARIS.POSITION_BEFORE_START):
this.moveToPosition(a,b?POLARIS.POSITION_AFTER_END:POLARIS.POSITION_BEFORE_START);c=1;break}if(a.type==POLARIS.NODE_ELEMENT)if(a.isEditable())this.moveToPosition(a,b?POLARIS.POSITION_BEFORE_END:POLARIS.POSITION_AFTER_START),c=1;else if(b&&a.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(a,POLARIS.POSITION_BEFORE_START);else if("false"==a.getAttribute("contenteditable")&&a.is(POLARIS.dtd.$block))return this.setStartBefore(a),this.setEndAfter(a),!0;var d=a,e=c,f=void 0;d.type==
POLARIS.NODE_ELEMENT&&d.isEditable(!1)&&(f=d[b?"getLast":"getFirst"](l));e||f||(f=d[b?"getPrevious":"getNext"](l));a=f}return!!c},moveToClosestEditablePosition:function(a,b){var c=new POLARIS.dom.range(this.root),d=0,e,f=[POLARIS.POSITION_AFTER_END,POLARIS.POSITION_BEFORE_START];c.moveToPosition(a,f[b?0:1]);if(a.is(POLARIS.dtd.$block)){if(e=c[b?"getNextEditableNode":"getPreviousEditableNode"]())d=1,e.type==POLARIS.NODE_ELEMENT&&e.is(POLARIS.dtd.$block)&&"false"==e.getAttribute("contenteditable")?
(c.setStartAt(e,POLARIS.POSITION_BEFORE_START),c.setEndAt(e,POLARIS.POSITION_AFTER_END)):c.moveToPosition(e,f[b?1:0])}else d=1;d&&this.moveToRange(c);return!!d},moveToElementEditStart:function(a){return this.moveToElementEditablePosition(a)},moveToElementEditEnd:function(a){return this.moveToElementEditablePosition(a,!0)},getEnclosedNode:function(){var a=this.clone();a.optimize();if(a.startContainer.type!=POLARIS.NODE_ELEMENT||a.endContainer.type!=POLARIS.NODE_ELEMENT)return null;var a=new POLARIS.dom.walker(a),
b=POLARIS.dom.walker.bookmark(!1,!0),c=POLARIS.dom.walker.whitespaces(!0);a.evaluator=function(a){return c(a)&&b(a)};var d=a.next();a.reset();return d&&d.equals(a.previous())?d:null},getTouchedStartNode:function(){var a=this.startContainer;return this.collapsed||a.type!=POLARIS.NODE_ELEMENT?a:a.getChild(this.startOffset)||a},getTouchedEndNode:function(){var a=this.endContainer;return this.collapsed||a.type!=POLARIS.NODE_ELEMENT?a:a.getChild(this.endOffset-1)||a},getNextEditableNode:b(),getPreviousEditableNode:b(1),
scrollIntoView:function(){var a=new POLARIS.dom.element.createFromHtml("\x3cspan\x3e\x26nbsp;\x3c/span\x3e",this.document),b,c,d,e=this.clone();e.optimize();(d=e.startContainer.type==POLARIS.NODE_TEXT)?(c=e.startContainer.getText(),b=e.startContainer.split(e.startOffset),a.insertAfter(e.startContainer)):e.insertNode(a);a.scrollIntoView();d&&(e.startContainer.setText(c),b.remove());a.remove()},_setStartContainer:function(a){this.startContainer=a},_setEndContainer:function(a){this.endContainer=a}}})();
POLARIS.POSITION_AFTER_START=1;POLARIS.POSITION_BEFORE_END=2;POLARIS.POSITION_BEFORE_START=3;POLARIS.POSITION_AFTER_END=4;POLARIS.ENLARGE_ELEMENT=1;POLARIS.ENLARGE_BLOCK_CONTENTS=2;POLARIS.ENLARGE_LIST_ITEM_CONTENTS=3;POLARIS.ENLARGE_INLINE=4;POLARIS.START=1;POLARIS.END=2;POLARIS.SHRINK_ELEMENT=1;POLARIS.SHRINK_TEXT=2;"use strict";(function(){function a(a){1>arguments.length||(this.range=a,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function e(a){var b=[];a.forEach(function(a){if("true"==
a.getAttribute("contenteditable"))return b.push(a),!1},POLARIS.NODE_ELEMENT,!0);return b}function b(a,c,d,f){a:{null==f&&(f=e(d));for(var h;h=f.shift();)if(h.getDtd().p){f={element:h,remaining:f};break a}f=null}if(!f)return 0;if((h=POLARIS.filter.instances[f.element.data("polaris-filter")])&&!h.check(c))return b(a,c,d,f.remaining);c=new POLARIS.dom.range(f.element);c.selectNodeContents(f.element);c=c.createIterator();c.enlargeBr=a.enlargeBr;c.enforceRealBlocks=a.enforceRealBlocks;c.activeFilter=c.filter=
h;a._.nestedEditable={element:f.element,container:d,remaining:f.remaining,iterator:c};return 1}function c(a,b,c){if(!b)return!1;a=a.clone();a.collapse(!c);return a.checkBoundaryOfElement(b,c?POLARIS.START:POLARIS.END)}var d=/^[\r\n\t ]+$/,h=POLARIS.dom.walker.bookmark(!1,!0),g=POLARIS.dom.walker.whitespaces(!0),k=function(a){return h(a)&&g(a)},f={dd:1,dt:1,li:1};a.prototype={getNextParagraph:function(a){var e,g,q,v,r;a=a||"p";if(this._.nestedEditable){if(e=this._.nestedEditable.iterator.getNextParagraph(a))return this.activeFilter=
this._.nestedEditable.iterator.activeFilter,e;this.activeFilter=this.filter;if(b(this,a,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(a);this._.nestedEditable=null}if(!this.range.root.getDtd()[a])return null;if(!this._.started){var p=this.range.clone();g=p.startPath();var t=p.endPath(),w=!p.collapsed&&c(p,g.block),A=!p.collapsed&&c(p,t.block,1);p.shrink(POLARIS.SHRINK_ELEMENT,
!0);w&&p.setStartAt(g.block,POLARIS.POSITION_BEFORE_END);A&&p.setEndAt(t.block,POLARIS.POSITION_AFTER_START);g=p.endContainer.hasAscendant("pre",!0)||p.startContainer.hasAscendant("pre",!0);p.enlarge(this.forceBrBreak&&!g||!this.enlargeBr?POLARIS.ENLARGE_LIST_ITEM_CONTENTS:POLARIS.ENLARGE_BLOCK_CONTENTS);p.collapsed||(g=new POLARIS.dom.walker(p.clone()),t=POLARIS.dom.walker.bookmark(!0,!0),g.evaluator=t,this._.nextNode=g.next(),g=new POLARIS.dom.walker(p.clone()),g.evaluator=t,g=g.previous(),this._.lastNode=
g.getNextSourceNode(!0,null,p.root),this._.lastNode&&this._.lastNode.type==POLARIS.NODE_TEXT&&!POLARIS.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&(t=this.range.clone(),t.moveToPosition(this._.lastNode,POLARIS.POSITION_AFTER_END),t.checkEndOfBlock()&&(t=new POLARIS.dom.elementPath(t.endContainer,t.root),this._.lastNode=(t.block||t.blockLimit).getNextSourceNode(!0))),this._.lastNode&&p.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=p.document.createText(""),
this._.lastNode.insertAfter(g)),p=null);this._.started=1;g=p}t=this._.nextNode;p=this._.lastNode;for(this._.nextNode=null;t;){var w=0,A=t.hasAscendant("pre"),x=t.type!=POLARIS.NODE_ELEMENT,C=0;if(x)t.type==POLARIS.NODE_TEXT&&d.test(t.getText())&&(x=0);else{var u=t.getName();if(POLARIS.dtd.$block[u]&&"false"==t.getAttribute("contenteditable")){e=t;b(this,a,e);break}else if(t.isBlockBoundary(this.forceBrBreak&&!A&&{br:1})){if("br"==u)x=1;else if(!g&&!t.getChildCount()&&"hr"!=u){e=t;q=t.equals(p);break}g&&
(g.setEndAt(t,POLARIS.POSITION_BEFORE_START),"br"!=u&&(this._.nextNode=t));w=1}else{if(t.getFirst()){g||(g=this.range.clone(),g.setStartAt(t,POLARIS.POSITION_BEFORE_START));t=t.getFirst();continue}x=1}}x&&!g&&(g=this.range.clone(),g.setStartAt(t,POLARIS.POSITION_BEFORE_START));q=(!w||x)&&t.equals(p);if(g&&!w)for(;!t.getNext(k)&&!q;){u=t.getParent();if(u.isBlockBoundary(this.forceBrBreak&&!A&&{br:1})){w=1;x=0;q||u.equals(p);g.setEndAt(u,POLARIS.POSITION_BEFORE_END);break}t=u;x=1;q=t.equals(p);C=1}x&&
g.setEndAt(t,POLARIS.POSITION_AFTER_END);t=this._getNextSourceNode(t,C,p);if((q=!t)||w&&g)break}if(!e){if(!g)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;e=new POLARIS.dom.elementPath(g.startContainer,g.root);t=e.blockLimit;w={div:1,th:1,td:1};e=e.block;!e&&t&&!this.enforceRealBlocks&&w[t.getName()]&&g.checkStartOfBlock()&&g.checkEndOfBlock()&&!t.equals(g.root)?e=t:!e||this.enforceRealBlocks&&e.is(f)?(t=g.startContainer,w=!0,t.type===POLARIS.NODE_ELEMENT&&(t.is("tr")||
t.is(a))&&(w=!1),w?(e=this.range.document.createElement(a),g.extractContents().appendTo(e),e.trim(),g.insertNode(e),v=r=!0):this._.nextNode=this._getNextSourceNode(g.getBoundaryNodes().endNode,1,p)):"li"!=e.getName()?g.checkStartOfBlock()&&g.checkEndOfBlock()||(e=e.clone(!1),g.extractContents().appendTo(e),e.trim(),r=g.splitBlock(),v=!r.wasStartOfBlock,r=!r.wasEndOfBlock,g.insertNode(e)):q||(this._.nextNode=e.equals(p)?null:this._getNextSourceNode(g.getBoundaryNodes().endNode,1,p))}v&&(v=e.getPrevious())&&
v.type==POLARIS.NODE_ELEMENT&&("br"==v.getName()?v.remove():v.getLast()&&"br"==v.getLast().$.nodeName.toLowerCase()&&v.getLast().remove());r&&(v=e.getLast())&&v.type==POLARIS.NODE_ELEMENT&&"br"==v.getName()&&(!POLARIS.env.needsBrFiller||v.getPrevious(h)||v.getNext(h))&&v.remove();this._.nextNode||(this._.nextNode=q||e.equals(p)||!p?null:this._getNextSourceNode(e,1,p));return e},_getNextSourceNode:function(a,b,c){function d(a){return!(a.equals(c)||a.equals(e))}var e=this.range.root;for(a=a.getNextSourceNode(b,
null,d);!h(a);)a=a.getNextSourceNode(b,null,d);return a}};POLARIS.dom.range.prototype.createIterator=function(){return new a(this)}})();POLARIS.command=function(a,e){this.uiItems=[];this.exec=function(b){if(this.state==POLARIS.TRISTATE_DISABLED||!this.checkAllowed())return!1;this.editorFocus&&a.focus();return!1===this.fire("exec")?!0:!1!==e.exec.call(this,a,b)};this.refresh=function(a,b){if(!this.readOnly&&a.readOnly)return!0;if(this.context&&!b.isContextFor(this.context)||!this.checkAllowed(!0))return this.disable(),
!0;this.startDisabled||this.enable();this.modes&&!this.modes[a.mode]&&this.disable();return!1===this.fire("refresh",{editor:a,path:b})?!0:e.refresh&&!1!==e.refresh.apply(this,arguments)};var b;this.checkAllowed=function(c){return c||"boolean"!=typeof b?b=a.activeFilter.checkFeature(this):b};POLARIS.tools.extend(this,e,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!e.context,state:POLARIS.TRISTATE_DISABLED});POLARIS.event.call(this)};POLARIS.command.prototype={enable:function(){"showimageborder"!=
this.name&&this.state==POLARIS.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&"undefined"!=typeof this.previousState?this.previousState:POLARIS.TRISTATE_OFF)},disable:function(){"showimageborder"!=this.name&&this.setState(POLARIS.TRISTATE_DISABLED)},setState:function(a){if(this.state==a||a!=POLARIS.TRISTATE_DISABLED&&!this.checkAllowed())return!1;this.previousState=this.state;this.state=a;this.fire("state");return!0},toggleState:function(){this.state==POLARIS.TRISTATE_OFF?
this.setState(POLARIS.TRISTATE_ON):this.state==POLARIS.TRISTATE_ON&&this.setState(POLARIS.TRISTATE_OFF)}};POLARIS.event.implementOn(POLARIS.command.prototype);(function(){function a(a,b,c,d,e){var f,h;a=[];for(f in b){h=b[f];h="boolean"==typeof h?{}:"function"==typeof h?{match:h}:H(h);"$"!=f.charAt(0)&&(h.elements=f);c&&(h.featureName=c.toLowerCase());var k=h;k.elements=g(k.elements,/\s+/)||null;k.propertiesOnly=k.propertiesOnly||!0===k.elements;var l=/\s*,\s*/,m=void 0;for(m in L){k[m]=g(k[m],l)||
null;var p=k,n=z[m],u=g(k[z[m]],l),t=k[m],C=[],D=!0,r=void 0;u?D=!1:u={};for(r in t)"!"==r.charAt(0)&&(r=r.slice(1),C.push(r),u[r]=!0,D=!1);for(;r=C.pop();)t[r]=t["!"+r],delete t["!"+r];p[n]=(D?!1:u)||null}k.match=k.match||null;d.push(h);a.push(h)}b=e.elements;e=e.generic;var x;c=0;for(d=a.length;c<d;++c){f=H(a[c]);h=!0===f.classes||!0===f.styles||!0===f.attributes;k=f;m=n=l=void 0;for(l in L)k[l]=w(k[l]);p=!0;for(m in z){l=z[m];n=k[l];u=[];t=void 0;for(t in n)-1<t.indexOf("*")?u.push(new RegExp("^"+
t.replace(/\*/g,".*")+"$")):u.push(t);n=u;n.length&&(k[l]=n,p=!1)}k.nothingRequired=p;k.noProperties=!(k.attributes||k.classes||k.styles);if(!0===f.elements||null===f.elements)e[h?"unshift":"push"](f);else for(x in k=f.elements,delete f.elements,k)if(b[x])b[x][h?"unshift":"push"](f);else b[x]=[f]}}function e(a,c,d,e){if(!a.match||a.match(c))if(e||k(a,c))if(a.propertiesOnly||(d.valid=!0),d.allAttributes||(d.allAttributes=b(a.attributes,c.attributes,d.validAttributes)),d.allStyles||(d.allStyles=b(a.styles,
c.styles,d.validStyles)),!d.allClasses){a=a.classes;c=c.classes;e=d.validClasses;if(a)if(!0===a)a=!0;else{for(var f=0,h=c.length,g;f<h;++f)g=c[f],e[g]||(e[g]=a(g));a=!1}else a=!1;d.allClasses=a}}function b(a,b,c){if(!a)return!1;if(!0===a)return!0;for(var d in b)c[d]||(c[d]=a(d));return!1}function c(a,b,c){if(!a.match||a.match(b)){if(a.noProperties)return!1;c.hadInvalidAttribute=d(a.attributes,b.attributes)||c.hadInvalidAttribute;c.hadInvalidStyle=d(a.styles,b.styles)||c.hadInvalidStyle;a=a.classes;
b=b.classes;if(a){for(var e=!1,f=!0===a,h=b.length;h--;)if(f||a(b[h]))b.splice(h,1),e=!0;a=e}else a=!1;c.hadInvalidClass=a||c.hadInvalidClass}}function d(a,b){if(!a)return!1;var c=!1,d=!0===a,e;for(e in b)if(d||a(e))delete b[e],c=!0;return c}function h(a,b,c){if(a.disabled||a.customConfig&&!c||!b)return!1;a._.cachedChecks={};return!0}function g(a,b){if(!a)return!1;if(!0===a)return a;if("string"==typeof a)return a=J(a),"*"==a?!0:POLARIS.tools.convertArrayToObject(a.split(b));if(POLARIS.tools.isArray(a))return a.length?
POLARIS.tools.convertArrayToObject(a):!1;var c={},d=0,e;for(e in a)c[e]=a[e],d++;return d?c:!1}function k(a,b){if(a.nothingRequired)return!0;var c,d,e,h;if(e=a.requiredClasses)for(h=b.classes,c=0;c<e.length;++c)if(d=e[c],"string"==typeof d){if(-1==POLARIS.tools.indexOf(h,d))return!1}else if(!POLARIS.tools.checkIfAnyArrayItemMatches(h,d))return!1;return f(b.styles,a.requiredStyles)&&f(b.attributes,a.requiredAttributes)}function f(a,b){if(!b)return!0;for(var c=0,d;c<b.length;++c)if(d=b[c],"string"==
typeof d){if(!(d in a))return!1}else if(!POLARIS.tools.checkIfAnyObjectPropertyMatches(a,d))return!1;return!0}function l(a){if(!a)return{};a=a.split(/\s*,\s*/).sort();for(var b={};a.length;)b[a.shift()]="polaris-test";return b}function m(a){var b,c,d,e,f={},h=1;for(a=J(a);b=a.match(D);)(c=b[2])?(d=n(c,"styles"),e=n(c,"attrs"),c=n(c,"classes")):d=e=c=null,f["$"+h++]={elements:b[1],classes:c,styles:d,attributes:e},a=a.slice(b[0].length);return f}function n(a,b){var c=a.match(O[b]);return c?J(c[1]):
null}function q(a){var b=a.styleBackup=a.attributes.style,c=a.classBackup=a.attributes["class"];a.styles||(a.styles=POLARIS.tools.parseCssText(b||"",1));a.classes||(a.classes=c?c.split(/\s+/):[])}function v(a,b,d,f){var h=0,g;f.toHtml&&(b.name=b.name.replace(P,"$1"));if(f.doCallbacks&&a.elementCallbacks){a:{g=a.elementCallbacks;for(var k=0,l=g.length,m;k<l;++k)if(m=g[k](b)){g=m;break a}g=void 0}if(g)return g}if(f.doTransform&&(g=a._.transformations[b.name])){q(b);for(k=0;k<g.length;++k)u(a,b,g[k]);
p(b)}if(f.doFilter){a:{k=b.name;l=a._;a=l.allowedRules.elements[k];g=l.allowedRules.generic;k=l.disallowedRules.elements[k];l=l.disallowedRules.generic;m=f.skipRequired;var n={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1},z,w;if(a||g){q(b);if(k)for(z=0,w=k.length;z<w;++z)if(!1===c(k[z],b,n)){a=null;break a}if(l)for(z=0,w=l.length;z<w;++z)c(l[z],b,n);if(a)for(z=0,w=a.length;z<w;++z)e(a[z],
b,n,m);if(g)for(z=0,w=g.length;z<w;++z)e(g[z],b,n,m);a=n}else a=null}if(!a||!a.valid)return d.push(b),1;w=a.validAttributes;var C=a.validStyles;g=a.validClasses;var k=b.attributes,D=b.styles,l=b.classes;m=b.classBackup;var r=b.styleBackup,x,A,v=[],n=[],G=/^data-polaris-/;z=!1;delete k.style;delete k["class"];delete b.classBackup;delete b.styleBackup;if(!a.allAttributes)for(x in k)w[x]||(G.test(x)?x==(A=x.replace(/^data-polaris-saved-/,""))||w[A]||(delete k[x],z=!0):(delete k[x],z=!0));if(!a.allStyles||
a.hadInvalidStyle){for(x in D)a.allStyles||C[x]?v.push(x+":"+D[x]):z=!0;v.length&&(k.style=v.sort().join("; "))}else r&&(k.style=r);if(!a.allClasses||a.hadInvalidClass){for(x=0;x<l.length;++x)(a.allClasses||g[l[x]])&&n.push(l[x]);n.length&&(k["class"]=n.sort().join(" "));m&&n.length<m.split(/\s+/).length&&(z=!0)}else m&&(k["class"]=m);z&&(h=1);if(!f.skipFinalValidation&&!t(b))return d.push(b),1}f.toHtml&&(b.name=b.name.replace(X,"polaris:$1"));return h}function r(a){var b=[],c;for(c in a)-1<c.indexOf("*")&&
b.push(c.replace(/\*/g,".*"));return b.length?new RegExp("^(?:"+b.join("|")+")$"):null}function p(a){var b=a.attributes,c;delete b.style;delete b["class"];if(c=POLARIS.tools.writeCssText(a.styles,!0))b.style=c;a.classes.length&&(b["class"]=a.classes.sort().join(" "))}function t(a){switch(a.name){case "a":if(!a.children.length&&!a.attributes.name)return!1;break;case "img":if(!a.attributes.src)return!1}return!0}function w(a){if(!a)return!1;if(!0===a)return!0;var b=r(a);return function(c){return c in
a||b&&c.match(b)}}function A(){return new POLARIS.htmlParser.element("br")}function x(a){return a.type==POLARIS.NODE_ELEMENT&&("br"==a.name||E.$block[a.name])}function C(a,b,c){var d=a.name;if(E.$empty[d]||!a.children.length)"hr"==d&&"br"==b?a.replaceWith(A()):(a.parent&&c.push({check:"it",el:a.parent}),a.remove());else if(E.$block[d]||"tr"==d)if("br"==b)a.previous&&!x(a.previous)&&(b=A(),b.insertBefore(a)),a.next&&!x(a.next)&&(b=A(),b.insertAfter(a)),a.replaceWithChildren();else{var d=a.children,
e;b:{e=E[b];for(var f=0,h=d.length,g;f<h;++f)if(g=d[f],g.type==POLARIS.NODE_ELEMENT&&!e[g.name]){e=!1;break b}e=!0}if(e)a.name=b,a.attributes={},c.push({check:"parent-down",el:a});else{e=a.parent;for(var f=e.type==POLARIS.NODE_DOCUMENT_FRAGMENT||"body"==e.name,k,l,h=d.length;0<h;)g=d[--h],f&&(g.type==POLARIS.NODE_TEXT||g.type==POLARIS.NODE_ELEMENT&&E.$inline[g.name])?(k||(k=new POLARIS.htmlParser.element(b),k.insertAfter(a),c.push({check:"parent-down",el:k})),k.add(g,0)):(k=null,l=E[e.name]||E.span,
g.insertAfter(a),e.type==POLARIS.NODE_DOCUMENT_FRAGMENT||g.type!=POLARIS.NODE_ELEMENT||l[g.name]||c.push({check:"el-up",el:g}));a.remove()}}else"style"==d?a.remove():(a.parent&&c.push({check:"it",el:a.parent}),a.replaceWithChildren())}function u(a,b,c){var d,e;for(d=0;d<c.length;++d)if(e=c[d],!(e.check&&!a.check(e.check,!1)||e.left&&!e.left(b))){e.right(b,S);break}}function B(a,b){var c=b.getDefinition(),d=c.attributes,e=c.styles,f,g,h,k;if(a.name!=c.element)return!1;for(f in d)if("class"==f)for(c=
d[f].split(/\s+/),h=a.classes.join("|");k=c.pop();){if(-1==h.indexOf(k))return!1}else if(a.attributes[f]!=d[f])return!1;for(g in e)if(a.styles[g]!=e[g])return!1;return!0}function G(a,b){var c,d;"string"==typeof a?c=a:a instanceof POLARIS.style?d=a:(c=a[0],d=a[1]);return[{element:c,left:d,right:function(a,c){c.transform(a,b)}}]}function y(a){return function(b){return B(b,a)}}function F(a){return function(b,c){c[a](b)}}var E=POLARIS.dtd,H=POLARIS.tools.copy,J=POLARIS.tools.trim,I=["","p","br","div"];
POLARIS.FILTER_SKIP_TREE=2;POLARIS.filter=function(a){this.allowedContent=[];this.disallowedContent=[];this.elementCallbacks=null;this.disabled=!1;this.editor=null;this.id=POLARIS.tools.getNextNumber();this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{}};POLARIS.filter.instances[this.id]=this;if(a instanceof POLARIS.editor){a=this.editor=a;this.customConfig=!0;var b=a.config.allowedContent;!0===b?this.disabled=!0:(b||(this.customConfig=
!1),this.allow(b,"config",1),this.allow(a.config.extraAllowedContent,"extra",1),this.allow(I[a.enterMode]+" "+I[a.shiftEnterMode],"default",1),this.disallow(a.config.disallowedContent))}else this.customConfig=!1,this.allow(a,"default",1)};POLARIS.filter.instances={};POLARIS.filter.prototype={allow:function(b,c,d){if(!h(this,b,d))return!1;var e,f;if("string"==typeof b)b=m(b);else if(b instanceof POLARIS.style){if(b.toAllowedContentRules)return this.allow(b.toAllowedContentRules(this.editor),c,d);e=
b.getDefinition();b={};d=e.attributes;b[e.element]=e={styles:e.styles,requiredStyles:e.styles&&POLARIS.tools.objectKeys(e.styles)};d&&(d=H(d),e.classes=d["class"]?d["class"].split(/\s+/):null,e.requiredClasses=e.classes,delete d["class"],e.attributes=d,e.requiredAttributes=d&&POLARIS.tools.objectKeys(d))}else if(POLARIS.tools.isArray(b)){for(e=0;e<b.length;++e)f=this.allow(b[e],c,d);return f}a(this,b,c,this.allowedContent,this._.allowedRules);return!0},applyTo:function(a,b,c,d){if(this.disabled)return!1;
var e=this,f=[],g=this.editor&&this.editor.config.protectedSource,h,k=!1,l={doFilter:!c,doTransform:!0,doCallbacks:!0,toHtml:b};a.forEach(function(a){if(a.type==POLARIS.NODE_ELEMENT){if("off"==a.attributes["data-polaris-filter"])return!1;if(!b||"span"!=a.name||!~POLARIS.tools.objectKeys(a.attributes).join("|").indexOf("data-polaris-"))if(h=v(e,a,f,l),h&1)k=!0;else if(h&2)return!1}else if(a.type==POLARIS.NODE_COMMENT&&a.value.match(/^\{polaris_protected\}(?!\{C\})/)){var c;a:{var d=decodeURIComponent(a.value.replace(/^\{polaris_protected\}/,
""));c=[];var m,p,n;if(g)for(p=0;p<g.length;++p)if((n=d.match(g[p]))&&n[0].length==d.length){c=!0;break a}d=POLARIS.htmlParser.fragment.fromHtml(d);1==d.children.length&&(m=d.children[0]).type==POLARIS.NODE_ELEMENT&&v(e,m,c,l);c=!c.length}c||f.push(a)}},null,!0);f.length&&(k=!0);var m;a=[];d=I[d||(this.editor?this.editor.enterMode:POLARIS.ENTER_P)];for(var p;c=f.pop();)c.type==POLARIS.NODE_ELEMENT?C(c,d,a):c.remove();for(;m=a.pop();)if(c=m.el,c.parent)switch(p=E[c.parent.name]||E.span,m.check){case "it":E.$removeEmpty[c.name]&&
!c.children.length?C(c,d,a):t(c)||C(c,d,a);break;case "el-up":c.parent.type==POLARIS.NODE_DOCUMENT_FRAGMENT||p[c.name]||C(c,d,a);break;case "parent-down":c.parent.type==POLARIS.NODE_DOCUMENT_FRAGMENT||p[c.name]||C(c.parent,d,a)}return k},checkFeature:function(a){if(this.disabled||!a)return!0;a.toFeature&&(a=a.toFeature(this.editor));return!a.requiredContent||this.check(a.requiredContent)},disable:function(){this.disabled=!0},disallow:function(b){if(!h(this,b,!0))return!1;"string"==typeof b&&(b=m(b));
a(this,b,null,this.disallowedContent,this._.disallowedRules);return!0},addContentForms:function(a){if(!this.disabled&&a){var b,c,d=[],e;for(b=0;b<a.length&&!e;++b)c=a[b],("string"==typeof c||c instanceof POLARIS.style)&&this.check(c)&&(e=c);if(e){for(b=0;b<a.length;++b)d.push(G(a[b],e));this.addTransformations(d)}}},addElementCallback:function(a){this.elementCallbacks||(this.elementCallbacks=[]);this.elementCallbacks.push(a)},addFeature:function(a){if(this.disabled||!a)return!0;a.toFeature&&(a=a.toFeature(this.editor));
this.allow(a.allowedContent,a.name);this.addTransformations(a.contentTransformations);this.addContentForms(a.contentForms);return a.requiredContent&&(this.customConfig||this.disallowedContent.length)?this.check(a.requiredContent):!0},addTransformations:function(a){var b,c;if(!this.disabled&&a){var d=this._.transformations,e;for(e=0;e<a.length;++e){b=a[e];var f=void 0,g=void 0,h=void 0,k=void 0,l=void 0,m=void 0;c=[];for(g=0;g<b.length;++g)h=b[g],"string"==typeof h?(h=h.split(/\s*:\s*/),k=h[0],l=null,
m=h[1]):(k=h.check,l=h.left,m=h.right),f||(f=h,f=f.element?f.element:k?k.match(/^([a-z0-9]+)/i)[0]:f.left.getDefinition().element),l instanceof POLARIS.style&&(l=y(l)),c.push({check:k==f?null:k,left:l,right:"string"==typeof m?F(m):m});b=f;d[b]||(d[b]=[]);d[b].push(c)}}},check:function(a,b,c){if(this.disabled)return!0;if(POLARIS.tools.isArray(a)){for(var d=a.length;d--;)if(this.check(a[d],b,c))return!0;return!1}var e,f;if("string"==typeof a){f=a+"\x3c"+(!1===b?"0":"1")+(c?"1":"0")+"\x3e";if(f in this._.cachedChecks)return this._.cachedChecks[f];
d=m(a).$1;e=d.styles;var h=d.classes;d.name=d.elements;d.classes=h=h?h.split(/\s*,\s*/):[];d.styles=l(e);d.attributes=l(d.attributes);d.children=[];h.length&&(d.attributes["class"]=h.join(" "));e&&(d.attributes.style=POLARIS.tools.writeCssText(d.styles));e=d}else d=a.getDefinition(),e=d.styles,h=d.attributes||{},e?(e=H(e),h.style=POLARIS.tools.writeCssText(e,!0)):e={},e={name:d.element,attributes:h,classes:h["class"]?h["class"].split(/\s+/):[],styles:e,children:[]};var h=POLARIS.tools.clone(e),g=
[],k;if(!1!==b&&(k=this._.transformations[e.name])){for(d=0;d<k.length;++d)u(this,e,k[d]);p(e)}v(this,h,g,{doFilter:!0,doTransform:!1!==b,skipRequired:!c,skipFinalValidation:!c});b=0<g.length?!1:POLARIS.tools.objectCompare(e.attributes,h.attributes,!0)?!0:!1;"string"==typeof a&&(this._.cachedChecks[f]=b);return b},getAllowedEnterMode:function(){var a=["p","div","br"],b={p:POLARIS.ENTER_P,div:POLARIS.ENTER_DIV,br:POLARIS.ENTER_BR};return function(c,d){var e=a.slice(),f;if(this.check(I[c]))return c;
for(d||(e=e.reverse());f=e.pop();)if(this.check(f))return b[f];return POLARIS.ENTER_BR}}(),destroy:function(){delete POLARIS.filter.instances[this.id];delete this._;delete this.allowedContent;delete this.disallowedContent}};var L={styles:1,attributes:1,classes:1},z={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},D=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,O={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,
classes:/\(([^\)]+)\)/},P=/^polaris:(object|embed|param)$/,X=/^(object|embed|param)$/,S=POLARIS.filter.transformationsTools={sizeToStyle:function(a){this.lengthToStyle(a,"width");this.lengthToStyle(a,"height")},sizeToAttribute:function(a){this.lengthToAttribute(a,"width");this.lengthToAttribute(a,"height")},lengthToStyle:function(a,b,c){c=c||b;if(!(c in a.styles)){var d=a.attributes[b];d&&(/^\d+$/.test(d)&&(d+="px"),a.styles[c]=d)}delete a.attributes[b]},lengthToAttribute:function(a,b,c){c=c||b;if(!(c in
a.attributes)){var d=a.styles[b],e=d&&d.match(/^(\d+)(?:\.\d*)?px$/);e?a.attributes[c]=e[1]:"polaris-test"==d&&(a.attributes[c]="polaris-test")}delete a.styles[b]},alignmentToStyle:function(a){if(!("float"in a.styles)){var b=a.attributes.align;if("left"==b||"right"==b)a.styles["float"]=b}delete a.attributes.align},alignmentToAttribute:function(a){if(!("align"in a.attributes)){var b=a.styles["float"];if("left"==b||"right"==b)a.attributes.align=b}delete a.styles["float"]},matchesStyle:B,transform:function(a,
b){if("string"==typeof b)a.name=b;else{var c=b.getDefinition(),d=c.styles,e=c.attributes,f,h,g,k;a.name=c.element;for(f in e)if("class"==f)for(c=a.classes.join("|"),g=e[f].split(/\s+/);k=g.pop();)-1==c.indexOf(k)&&a.classes.push(k);else a.attributes[f]=e[f];for(h in d)a.styles[h]=d[h]}}}})();(function(){POLARIS.focusManager=function(a){if(a.focusManager)return a.focusManager;this.hasFocus=!1;this.currentActive=null;this._={editor:a};return this};POLARIS.focusManager._={blurDelay:200};POLARIS.focusManager.prototype=
{focus:function(a){this._.timer&&clearTimeout(this._.timer);a&&(this.currentActive=a);this.hasFocus||this._.locked||((a=POLARIS.currentInstance)&&a.focusManager.blur(1),this.hasFocus=!0,(a=this._.editor.container)&&a.addClass("polaris_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(a){function e(){if(this.hasFocus){this.hasFocus=!1;var a=this._.editor.container;a&&a.removeClass("polaris_focus");this._.editor.fire("blur")}}
if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var b=POLARIS.focusManager._.blurDelay;a||!b?e.call(this):this._.timer=POLARIS.tools.setTimeout(function(){delete this._.timer;e.call(this)},b,this)}},add:function(a,e){var b=a.getCustomData("focusmanager");if(!b||b!=this){b&&b.remove(a);var b="focus",c="blur";e&&(POLARIS.env.ie?(b="focusin",c="focusout"):POLARIS.event.useCapture=1);var d={blur:function(){a.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(a)}};a.on(b,
d.focus,this);a.on(c,d.blur,this);e&&(POLARIS.event.useCapture=0);a.setCustomData("focusmanager",this);a.setCustomData("focusmanager_handlers",d)}},remove:function(a){a.removeCustomData("focusmanager");var e=a.removeCustomData("focusmanager_handlers");a.removeListener("blur",e.blur);a.removeListener("focus",e.focus)}}})();POLARIS.keystrokeHandler=function(a){if(a.keystrokeHandler)return a.keystrokeHandler;this.keystrokes={};this.blockedKeystrokes={};this._={editor:a};return this};(function(){var a,
e=function(b){b=b.data;var d=b.getKeystroke(),e=this.keystrokes[d],g=this._.editor;a=!1===g.fire("key",{keyCode:d,domEvent:b});a||(e&&(a=!1!==g.execCommand(e,{from:"keystrokeHandler"})),a||(a=!!this.blockedKeystrokes[d]));a&&b.preventDefault(!0);return!a},b=function(b){a&&(a=!1,b.data.preventDefault(!0))};POLARIS.keystrokeHandler.prototype={attach:function(a){a.on("keydown",e,this);if(POLARIS.env.gecko&&POLARIS.env.mac)a.on("keypress",b,this)}}})();(function(){POLARIS.lang={languages:{en:1,ko:1},
rtl:{},load:function(a,e,b){a&&POLARIS.lang.languages[a]||(a=this.detect(e,a));var c=this;e=function(){c[a].dir=c.rtl[a]?"rtl":"ltr";b(a,c[a])};this[a]?e():POLARIS.scriptLoader.load(POLARIS.getUrl("lang/"+a+".js"),e,this)},detect:function(a,e){var b=this.languages;e=e||navigator.userLanguage||navigator.language||a;var c=e.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),d=c[1],c=c[2];b[d+"-"+c]?d=d+"-"+c:b[d]||(d=null);POLARIS.lang.detect=d?function(){return d}:function(a){return a};return d||a}}})();
POLARIS.scriptLoader=function(){var a={},e={};return{load:function(b,c,d,h){var g="string"==typeof b;g&&(b=[b]);d||(d=POLARIS);var k=b.length,f=[],l=[],m=function(a){c&&(g?c.call(d,a):c.call(d,f,l))};if(0===k)m(!0);else{var n=function(a,b){(b?f:l).push(a);0>=--k&&(h&&POLARIS.document.getDocumentElement().removeStyle("cursor"),m(b))},q=function(b,c){a[b]=1;var d=e[b];delete e[b];for(var f=0;f<d.length;f++)d[f](b,c)},v=function(b){if(a[b])n(b,!0);else{var d=e[b]||(e[b]=[]);d.push(n);if(!(1<d.length)){var f=
new POLARIS.dom.element("script");f.setAttributes({type:"text/javascript",src:b});c&&(POLARIS.env.ie&&11>POLARIS.env.version?f.$.onreadystatechange=function(){if("loaded"==f.$.readyState||"complete"==f.$.readyState)f.$.onreadystatechange=null,q(b,!0)}:(f.$.onload=function(){setTimeout(function(){q(b,!0)},0)},f.$.onerror=function(){q(b,!1)}));f.appendTo(POLARIS.document.getHead())}}};h&&POLARIS.document.getDocumentElement().setStyle("cursor","wait");for(var r=0;r<k;r++)v(b[r])}},queue:function(){function a(){var b;
(b=c[0])&&this.load(b.scriptUrl,b.callback,POLARIS,0)}var c=[];return function(d,e){var g=this;c.push({scriptUrl:d,callback:function(){e&&e.apply(this,arguments);c.shift();a.call(g)}});1==c.length&&a.call(this)}}()}}();POLARIS.resourceManager=function(a,e){this.basePath=a;this.fileName=e;this.registered={};this.loaded={};this.externals={};this._={waitingList:{}}};POLARIS.resourceManager.prototype={add:function(a,e){if(this.registered[a])throw'[POLARIS.resourceManager.add] The resource name "'+a+'" is already registered.';
var b=this.registered[a]=e||{};b.name=a;b.path=this.getPath(a);POLARIS.fire(a+POLARIS.tools.capitalize(this.fileName)+"Ready",b);return this.get(a)},get:function(a){return this.registered[a]||null},getPath:function(a){var e=this.externals[a];return POLARIS.getUrl(e&&e.dir||this.basePath+a+"/")},getFilePath:function(a){var e=this.externals[a];return POLARIS.getUrl(this.getPath(a)+(e?e.file:this.fileName+".js"))},addExternal:function(a,e,b){a=a.split(",");for(var c=0;c<a.length;c++){var d=a[c];b||(e=
e.replace(/[^\/]+$/,function(a){b=a;return""}));this.externals[d]={dir:e,file:b||this.fileName+".js"}}},load:function(a,e,b){POLARIS.tools.isArray(a)||(a=a?[a]:[]);for(var c=this.loaded,d=this.registered,h=[],g={},k={},f=0;f<a.length;f++){var l=a[f];if(l)if(c[l]||d[l])k[l]=this.get(l);else{var m=this.getFilePath(l);h.push(m);m in g||(g[m]=[]);g[m].push(l)}}POLARIS.scriptLoader.load(h,function(a,d){if(d.length)throw'[POLARIS.resourceManager.load] Resource name "'+g[d[0]].join(",")+'" was not found at "'+
d[0]+'".';for(var f=0;f<a.length;f++)for(var h=g[a[f]],l=0;l<h.length;l++){var m=h[l];k[m]=this.get(m);c[m]=1}e.call(b,k)},this)}};POLARIS.plugins=new POLARIS.resourceManager("plugins/","plugin");POLARIS.plugins.load=POLARIS.tools.override(POLARIS.plugins.load,function(a){var e={};return function(b,c,d){var h={},g=function(b){a.call(this,b,function(a){POLARIS.tools.extend(h,a);var b=[],k;for(k in a){var n=a[k],q=n&&n.requires;if(!e[k]){if(n.icons)for(var v=n.icons.split(","),r=v.length;r--;)POLARIS.skin.addIcon(v[r],
n.path+"icons/"+(POLARIS.env.hidpi&&n.hidpi?"hidpi/":"")+v[r]+".png");e[k]=1}if(q)for(q.split&&(q=q.split(",")),n=0;n<q.length;n++)h[q[n]]||b.push(q[n])}if(b.length)g.call(this,b);else{for(k in h)n=h[k],n.onLoad&&!n.onLoad._called&&(!1===n.onLoad()&&delete h[k],n.onLoad._called=1);c&&c.call(d||window,h)}},this)};g.call(this,b)}});POLARIS.plugins.setLang=function(a,e,b){var c=this.get(a);a=c.langEntries||(c.langEntries={});c=c.lang||(c.lang=[]);c.split&&(c=c.split(","));-1==POLARIS.tools.indexOf(c,
e)&&c.push(e);a[e]=b};POLARIS.ui=function(a){if(a.ui)return a.ui;this.items={};this.instances={};this.editor=a;this._={handlers:{}};return this};POLARIS.ui.prototype={add:function(a,e,b){b.name=a.toLowerCase();var c=this.items[a]={type:e,command:b.command||null,args:Array.prototype.slice.call(arguments,2)};POLARIS.tools.extend(c,b)},get:function(a){return this.instances[a]},create:function(a){var e=this.items[a],b=e&&this._.handlers[e.type],c=e&&e.command&&this.editor.getCommand(e.command),b=b&&b.create.apply(this,
e.args);this.instances[a]=b;c&&c.uiItems.push(b);b&&!b.type&&(b.type=e.type);return b},addHandler:function(a,e){this._.handlers[a]=e},space:function(a){return POLARIS.document.getById(this.spaceId(a))},spaceId:function(a){return this.editor.id+"_"+a}};POLARIS.event.implementOn(POLARIS.ui);(function(){function a(a,d,f){POLARIS.event.call(this);a=a&&POLARIS.tools.clone(a);if(void 0!==d){if(!(d instanceof POLARIS.dom.element))throw Error("Expect element of type POLARIS.dom.element.");if(!f)throw Error("One of the element modes must be specified.");
if(POLARIS.env.ie&&POLARIS.env.quirks&&f==POLARIS.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!b(d,f))throw Error('The specified element mode is not supported on element: "'+d.getName()+'".');this.element=d;this.elementMode=f;this.name=this.elementMode!=POLARIS.ELEMENT_MODE_APPENDTO&&(d.getId()||d.getNameAtt())}else this.elementMode=POLARIS.ELEMENT_MODE_NONE;this._={};this.commands={};this.templates={};this.name=this.name||e();this.id=POLARIS.tools.getNextId();
this.status="unloaded";this.config=POLARIS.tools.prototypedCopy(POLARIS.config);this.ui=new POLARIS.ui(this);this.focusManager=new POLARIS.focusManager(this);this.keystrokeHandler=new POLARIS.keystrokeHandler(this);this.on("readOnly",c);this.on("selectionChange",function(a){h(this,a.data.path)});this.on("activeFilterChange",function(){h(this,this.elementPath(),!0)});this.on("mode",c);this.on("instanceReady",function(){this.config.startupFocus&&this.focus()});POLARIS.fire("instanceCreated",null,this);
POLARIS.add(this);POLARIS.tools.setTimeout(function(){k(this,a)},0,this)}function e(){do var a="editor"+ ++v;while(POLARIS.instances[a]);return a}function b(a,b){return b==POLARIS.ELEMENT_MODE_INLINE?a.is(POLARIS.dtd.$editable)||a.is("textarea"):b==POLARIS.ELEMENT_MODE_REPLACE?!a.is(POLARIS.dtd.$nonBodyContent):1}function c(){var a=this.commands,b;for(b in a)d(this,a[b])}function d(a,b){b[b.startDisabled?"disable":a.readOnly&&!b.readOnly?"disable":b.modes[a.mode]?"enable":"disable"]()}function h(a,
b,c){if(b){var d,e,f=a.commands;for(e in f)d=f[e],(c||d.contextSensitive)&&d.refresh(a,b)}}function g(a){var b=a.config.customConfig;if(!b)return!1;var b=POLARIS.getUrl(b),c=r[b]||(r[b]={});c.fn?(c.fn.call(a,a.config),POLARIS.getUrl(a.config.customConfig)!=b&&g(a)||a.fireOnce("customConfigLoaded")):POLARIS.scriptLoader.queue(b,function(){c.fn=POLARIS.editorConfig?POLARIS.editorConfig:function(){};g(a)});return!0}function k(a,b){a.on("customConfigLoaded",function(){POLARIS.preEditorConfig&&POLARIS.preEditorConfig(a.config);
if(b){if(b.on)for(var c in b.on)a.on(c,b.on[c]);POLARIS.tools.extend(a.config,b,!0);delete a.config.on}c=a.config;a.readOnly=!!(c.readOnly||(a.elementMode==POLARIS.ELEMENT_MODE_INLINE?a.element.is("textarea")?a.element.hasAttribute("disabled"):a.element.isReadOnly():a.elementMode==POLARIS.ELEMENT_MODE_REPLACE&&a.element.hasAttribute("disabled")));a.blockless=a.elementMode==POLARIS.ELEMENT_MODE_INLINE?!(a.element.is("textarea")||POLARIS.dtd[a.element.getName()].p):!1;a.tabIndex=c.tabIndex||a.element&&
a.element.getAttribute("tabindex")||0;a.activeEnterMode=a.enterMode=a.blockless?POLARIS.ENTER_BR:c.enterMode;a.activeShiftEnterMode=a.shiftEnterMode=a.blockless?POLARIS.ENTER_BR:c.shiftEnterMode;c.skin&&(POLARIS.skinName=c.skin);if(a.config.configParams){for(name in a.config.configParams)void 0!=a.config.configParams[name]&&(a.config[name]=a.config.configParams[name]);POLARIS.config.language=a.config.configParams.language;delete a.config.configParams}a.fireOnce("configLoaded");a.dataProcessor=new POLARIS.htmlDataProcessor(a);
a.filter=a.activeFilter=new POLARIS.filter(a);f(a)});b&&null!=b.customConfig&&(a.config.customConfig=b.customConfig);g(a)||a.fireOnce("customConfigLoaded")}function f(a){POLARIS.skin.loadPart("editor",function(){l(a)})}function l(a){POLARIS.lang.load(a.config.language,a.config.defaultLanguage,function(b,c){var d=a.config.title;a.langCode=b;a.lang=POLARIS.tools.prototypedCopy(c);a.title="string"==typeof d||!1===d?d:[a.lang.editor,a.name].join(", ");a.config.contentsLangDirection||(a.config.contentsLangDirection=
a.elementMode==POLARIS.ELEMENT_MODE_INLINE?a.element.getDirection(1):a.lang.dir);a.fire("langLoaded");m(a)})}function m(a){a.getStylesSet(function(b){a.once("loaded",function(){a.fire("stylesSet",{styles:b})},null,null,1);n(a)})}function n(a){var b=a.config,c=b.plugins,d=b.extraPlugins,e=b.removePlugins;if(d)var f=new RegExp("(?:^|,)(?:"+d.replace(/\s*,\s*/g,"|")+")(?\x3d,|$)","g"),c=c.replace(f,""),c=c+(","+d);if(e)var h=new RegExp("(?:^|,)(?:"+e.replace(/\s*,\s*/g,"|")+")(?\x3d,|$)","g"),c=c.replace(h,
"");POLARIS.env.air&&(c+=",adobeair");POLARIS.plugins.load(c.split(","),function(c){var d=[],e=[],f=[];a.plugins=c;for(var g in c){var k=c[g],l=k.lang,m=null,n=k.requires,z;POLARIS.tools.isArray(n)&&(n=n.join(","));if(n&&(z=n.match(h)))for(;n=z.pop();)POLARIS.tools.setTimeout(function(a,b){throw Error('Plugin "'+a.replace(",","")+'" cannot be removed from the plugins list, because it\'s required by "'+b+'" plugin.');},0,null,[n,g]);l&&!a.lang[g]&&(l.split&&(l=l.split(",")),0<=POLARIS.tools.indexOf(l,
a.langCode)?m=a.langCode:(m=a.langCode.replace(/-.*/,""),m=m!=a.langCode&&0<=POLARIS.tools.indexOf(l,m)?m:0<=POLARIS.tools.indexOf(l,"en")?"en":l[0]),k.langEntries&&k.langEntries[m]?(a.lang[g]=k.langEntries[m],m=null):f.push(POLARIS.getUrl(k.path+"lang/"+m+".js")));e.push(m);d.push(k)}POLARIS.scriptLoader.load(f,function(){for(var c=["beforeInit","init","afterInit"],f=0;f<c.length;f++)for(var h=0;h<d.length;h++){var g=d[h];0===f&&e[h]&&g.lang&&g.langEntries&&(a.lang[g.name]=g.langEntries[e[h]]);if(g[c[f]])g[c[f]](a)}a.fireOnce("pluginsLoaded");
b.keystrokes&&a.setKeystroke(a.config.keystrokes);for(h=0;h<a.config.blockedKeystrokes.length;h++)a.keystrokeHandler.blockedKeystrokes[a.config.blockedKeystrokes[h]]=1;a.status="loaded";a.fireOnce("loaded");POLARIS.fire("instanceLoaded",null,a)})})}function q(){var a=this.element;if(a&&this.elementMode!=POLARIS.ELEMENT_MODE_APPENDTO){var b=this.getData();this.config.htmlEncodeOutput&&(b=POLARIS.tools.htmlEncode(b));a.is("textarea")?a.setValue(b):a.setHtml(b);return!0}return!1}a.prototype=POLARIS.editor.prototype;
POLARIS.editor=a;var v=0,r={};POLARIS.tools.extend(POLARIS.editor.prototype,{addCommand:function(a,b){b.name=a.toLowerCase();var c=new POLARIS.command(this,b);this.mode&&d(this,c);return this.commands[a]=c},_attachToForm:function(){function a(b){c.updateElement();c._.required&&!d.getValue()&&!1===c.fire("required")&&b.data.preventDefault()}function b(a){return!!(a&&a.call&&a.apply)}var c=this,d=c.element,e=new POLARIS.dom.element(d.$.form);d.is("textarea")&&e&&(e.on("submit",a),b(e.$.submit)&&(e.$.submit=
POLARIS.tools.override(e.$.submit,function(b){return function(){a();null!=b&&void 0!=b&&(b.apply?b.apply(this):b())}})),c.on("destroy",function(){e.removeListener("submit",a)}))},destroy:function(a){this.fire("beforeDestroy");!a&&q.call(this);this.editable(null);this.filter.destroy();delete this.filter;delete this.activeFilter;this.status="destroyed";this.fire("destroy");this.removeAllListeners();POLARIS.remove(this);POLARIS.fire("instanceDestroyed",null,this)},elementPath:function(a){if(!a){a=this.getSelection();
if(!a)return null;a=a.getStartElement()}return a?new POLARIS.dom.elementPath(a,this.editable()):null},createRange:function(){var a=this.editable();return a?new POLARIS.dom.range(a):null},execCommand:function(a,b){var c=this.getCommand(a),d={name:a,commandData:b,command:c};return c&&c.state!=POLARIS.TRISTATE_DISABLED&&!1!==this.fire("beforeCommandExec",d)&&(d.returnValue=c.exec(d.commandData),!c.async&&!1!==this.fire("afterCommandExec",d))?d.returnValue:!1},execCommandAbs:function(a,b){var c=this.getCommand(a);
return c?(c.enable(),c=c.exec(b)):!1},getCommand:function(a){return this.commands[a]},getData:function(a){!a&&this.fire("beforeGetData");var b=this._.data;"string"!=typeof b&&(b=(b=this.element)&&this.elementMode==POLARIS.ELEMENT_MODE_REPLACE?b.is("textarea")?b.getValue():b.getHtml():"");b={dataValue:b};!a&&this.fire("getData",b);return b.dataValue},getSnapshot:function(){var a=this.fire("getSnapshot");if("string"!=typeof a){var b=this.element;b&&this.elementMode==POLARIS.ELEMENT_MODE_REPLACE&&(a=
b.is("textarea")?b.getValue():b.getHtml())}return a},loadSnapshot:function(a){this.fire("loadSnapshot",a)},setData:function(a,b,c){POLARIS.plugins.tabletools&&POLARIS.plugins.tabletools.clearSelectedCell();this.document&&this.document.clearCustomData();var d=!0,e=b;b&&"object"==typeof b&&(c=b.internal,e=b.callback,d=!b.noSnapshot);!c&&d&&this.fire("saveSnapshot");if(e||!c)this.once("dataReady",function(a){!c&&d&&this.fire("saveSnapshot");e&&e.call(a.editor)});a={dataValue:a};!c&&this.fire("setData",
a);this._.data=a.dataValue;!c&&this.fire("afterSetData",a)},setReadOnly:function(a){a=null==a||a;this.readOnly!=a&&(this.readOnly=a,this.keystrokeHandler.blockedKeystrokes[8]=+a,null!=this.editable()&&this.editable().setReadOnly(a),this.fire("readOnly"))},insertHtml:function(a,b){this.fire("insertHtml",{dataValue:a,mode:b})},insertText:function(a){this.fire("insertText",a)},insertElement:function(a){this.fire("insertElement",a)},insertElementWithBlockSplit:function(a){var b=this.getSelection();if(b=
b?b.getRanges()[0]:null){this.fire("saveSnapshot");var c=this.document.createElement("span"),d=this.document.createText(" "),e=this.document.createText("​");b.insertNode(c);b.setEndBefore(c);b.select();this.fire("lockSnapshot");c.append(d);this.fire("insertElement",a);e.replace(c);this.fire("unlockSnapshot")}},focus:function(){POLARIS.env.ie&&this.editable().hasFocus||this.fire("beforeFocus")},checkDirty:function(){return this.undoManager&&this.undoManager.locked?!1:"ready"==this.status&&this._.previousValue!==
this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return q.call(this)},setKeystroke:function(){for(var a=this.keystrokeHandler.keystrokes,b=POLARIS.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],c,d,e=b.length;e--;)c=b[e],d=0,POLARIS.tools.isArray(c)&&(d=c[1],c=c[0]),d?a[c]=d:delete a[c]},addFeature:function(a){return this.filter.addFeature(a)},setActiveFilter:function(a){a||(a=this.filter);this.activeFilter!==a&&(this.activeFilter=
a,this.fire("activeFilterChange"),a===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(a.getAllowedEnterMode(this.enterMode),a.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(a,b){a=a?this.blockless?POLARIS.ENTER_BR:a:this.enterMode;b=b?this.blockless?POLARIS.ENTER_BR:b:this.shiftEnterMode;if(this.activeEnterMode!=a||this.activeShiftEnterMode!=b)this.activeEnterMode=a,this.activeShiftEnterMode=b,this.fire("activeEnterModeChange")}})})();POLARIS.ELEMENT_MODE_NONE=
0;POLARIS.ELEMENT_MODE_REPLACE=1;POLARIS.ELEMENT_MODE_APPENDTO=2;POLARIS.ELEMENT_MODE_INLINE=3;if(!document.body||document.readyState&&"complete"!=document.readyState)document.write('\x3cscript type\x3d"text/javascript" src\x3d"'+POLARIS.getUrl("preconfig/preconfig.js")+'"\x3e\x3c/script\x3e');else{var Sa=document.createElement("script");Sa.type="text/javascript";Sa.src=POLARIS.getUrl("preconfig/preconfig.js");document.body.appendChild(Sa)}POLARIS.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\x3e)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}};
(function(){var a=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,e={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};POLARIS.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(b){for(var c,d,h=0,g;c=this._.htmlPartsRegex.exec(b);){d=c.index;if(d>h)if(h=b.substring(h,d),g)g.push(h);else this.onText(h);
h=this._.htmlPartsRegex.lastIndex;if(d=c[1])if(d=d.toLowerCase(),g&&POLARIS.dtd.$cdata[d]&&(this.onCDATA(g.join("")),g=null),!g){this.onTagClose(d);continue}if(g)g.push(c[0]);else if(d=c[3]){if(d=d.toLowerCase(),!/="|!doctype/.test(d)){var k={},f,l=c[4];c=!!c[5];if(l)for(;f=a.exec(l);){var m=f[1].toLowerCase();f=f[2]||f[3]||f[4]||"";k[m]=!f&&e[m]?m:POLARIS.tools.htmlDecodeAttr(f)}this.onTagOpen(d,k,c);!g&&POLARIS.dtd.$cdata[d]&&(g=[])}}else if(d=c[2])this.onComment(d)}if(b.length>h)this.onText(b.substring(h,
b.length))}}})();POLARIS.htmlParser.basicWriter=POLARIS.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(a){this._.output.push("\x3c",a)},openTagClose:function(a,e){e?this._.output.push(" /\x3e"):this._.output.push("\x3e")},attribute:function(a,e){"string"==typeof e&&(e=POLARIS.tools.htmlEncodeAttr(e));this._.output.push(" ",a,'\x3d"',e,'"')},closeTag:function(a){this._.output.push("\x3c/",a,"\x3e")},text:function(a){this._.output.push(a)},comment:function(a){this._.output.push("\x3c!--",
a,"--\x3e")},write:function(a){this._.output.push(a)},reset:function(){this._.output=[];this._.indent=!1},getHtml:function(a){var e=this._.output.join("");a&&this.reset();return e}}});"use strict";(function(){POLARIS.htmlParser.node=function(){};POLARIS.htmlParser.node.prototype={remove:function(){var a=this.parent.children,e=POLARIS.tools.indexOf(a,this),b=this.previous,c=this.next;b&&(b.next=c);c&&(c.previous=b);a.splice(e,1);this.parent=null},replaceWith:function(a){var e=this.parent.children,
b=POLARIS.tools.indexOf(e,this),c=a.previous=this.previous,d=a.next=this.next;c&&(c.next=a);d&&(d.previous=a);e[b]=a;a.parent=this.parent;this.parent=null},insertAfter:function(a){var e=a.parent.children,b=POLARIS.tools.indexOf(e,a),c=a.next;e.splice(b+1,0,this);this.next=a.next;this.previous=a;a.next=this;c&&(c.previous=this);this.parent=a.parent},insertBefore:function(a){var e=a.parent.children,b=POLARIS.tools.indexOf(e,a);e.splice(b,0,this);this.next=a;(this.previous=a.previous)&&(a.previous.next=
this);a.previous=this;this.parent=a.parent},getAscendant:function(a){var e="function"==typeof a?a:"string"==typeof a?function(b){return b.name==a}:function(b){return b.name in a},b=this.parent;for(;b&&b.type==POLARIS.NODE_ELEMENT;){if(e(b))return b;b=b.parent}return null},wrapWith:function(a){this.replaceWith(a);a.add(this);return a},getIndex:function(){return POLARIS.tools.indexOf(this.parent.children,this)},getFilterContext:function(a){return a||{}}}})();"use strict";POLARIS.htmlParser.comment=
function(a){this.value=a;this._={isBlockLike:!1}};POLARIS.htmlParser.comment.prototype=POLARIS.tools.extend(new POLARIS.htmlParser.node,{type:POLARIS.NODE_COMMENT,filter:function(a,e){var b=this.value;if(!(b=a.onComment(e,b,this)))return this.remove(),!1;if("string"!=typeof b)return this.replaceWith(b),!1;this.value=b;return!0},writeHtml:function(a,e){e&&this.filter(e);a.comment(this.value)}});"use strict";(function(){POLARIS.htmlParser.text=function(a){this.value=a;this._={isBlockLike:!1}};POLARIS.htmlParser.text.prototype=
POLARIS.tools.extend(new POLARIS.htmlParser.node,{type:POLARIS.NODE_TEXT,filter:function(a,e){if(!(this.value=a.onText(e,this.value,this)))return this.remove(),!1},writeHtml:function(a,e){e&&this.filter(e);a.text(this.value)}})})();"use strict";(function(){POLARIS.htmlParser.cdata=function(a){this.value=a};POLARIS.htmlParser.cdata.prototype=POLARIS.tools.extend(new POLARIS.htmlParser.node,{type:POLARIS.NODE_TEXT,filter:function(){},writeHtml:function(a){a.write(this.value)}})})();"use strict";POLARIS.htmlParser.fragment=
function(){this.children=[];this.parent=null;this._={isBlockLike:!0,hasInlineStarted:!1}};(function(){function a(a){return a.attributes["data-polaris-survive"]?!1:"a"==a.name&&a.attributes.href||POLARIS.dtd.$removeEmpty[a.name]}var e=POLARIS.tools.extend({table:1,ul:1,ol:1,dl:1},POLARIS.dtd.table,POLARIS.dtd.ul,POLARIS.dtd.ol,POLARIS.dtd.dl),b={ol:1,ul:1},c=POLARIS.tools.extend({},{html:1},POLARIS.dtd.html,POLARIS.dtd.body,POLARIS.dtd.head,{style:1,script:1}),d={ul:"li",ol:"li",dl:"dd",table:"tbody",
tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};POLARIS.htmlParser.fragment.fromHtml=function(h,g,k){function f(a){var b;if(0<t.length)for(var c=0;c<t.length;c++){var d=t[c],e=d.name,f=POLARIS.dtd[e],h=A.name&&POLARIS.dtd[A.name];h&&!h[e]||a&&f&&!f[a]&&POLARIS.dtd[a]?e==A.name&&(n(A,A.parent,1),c--):(b||(l(),b=1),d=d.clone(),d.parent=A,A=d,t.splice(c,1),c--)}}function l(){for(;w.length;)n(w.shift(),A)}function m(a){if(a._.isBlockLike&&"pre"!=a.name&&"textarea"!=a.name&&"p"!=a.name){var b=a.children.length,
c=a.children[b-1],d;c&&c.type==POLARIS.NODE_TEXT&&((d=POLARIS.tools.rtrim(c.value))?c.value=d:a.children.length=b-1)}}function n(b,c,d){c=c||A||p;var e=A;void 0===b.previous&&(q(c,b)&&(A=c,r.onTagOpen(k,{}),b.returnPoint=c=A),m(b),a(b)&&!b.children.length||c.add(b),"pre"==b.name&&(C=!1),"textarea"==b.name&&(x=!1));b.returnPoint?(A=b.returnPoint,delete b.returnPoint):A=d?c:e}function q(a,b){if((a==p||"body"==a.name)&&k&&(!a.name||POLARIS.dtd[a.name][k])){var c,d;return(c=b.attributes&&(d=b.attributes["data-polaris-real-element-type"])?
d:b.name)&&c in POLARIS.dtd.$inline&&!(c in POLARIS.dtd.head)&&!b.isOrphan||b.type==POLARIS.NODE_TEXT}}function v(a,b){return a in POLARIS.dtd.$listItem||a in POLARIS.dtd.$tableContent?a==b||"dt"==a&&"dd"==b||"dd"==a&&"dt"==b:!1}var r=new POLARIS.htmlParser,p=g instanceof POLARIS.htmlParser.element?g:"string"==typeof g?new POLARIS.htmlParser.element(g):new POLARIS.htmlParser.fragment,t=[],w=[],A=p,x="textarea"==p.name,C="pre"==p.name;r.onTagOpen=function(d,h,g,k){h=new POLARIS.htmlParser.element(d,
h);h.isUnknown&&g&&(h.isEmpty=!0);h.isOptionalClose=k;if(a(h))t.push(h);else{if("pre"==d)C=!0;else{if("br"==d&&C){A.add(new POLARIS.htmlParser.text("\n"));return}"textarea"==d&&(x=!0)}if("br"==d)w.push(h);else{for(;!(k=(g=A.name)?POLARIS.dtd[g]||(A._.isBlockLike?POLARIS.dtd.div:POLARIS.dtd.span):c,h.isUnknown||A.isUnknown||k[d]);)if(A.isOptionalClose)r.onTagClose(g);else if(d in b&&g in b)g=A.children,(g=g[g.length-1])&&"li"==g.name||n(g=new POLARIS.htmlParser.element("li"),A),!h.returnPoint&&(h.returnPoint=
A),A=g;else if(d in POLARIS.dtd.$listItem&&!v(d,g))r.onTagOpen("li"==d?"ul":"dl",{},0,1);else if(g in e&&!v(d,g))!h.returnPoint&&(h.returnPoint=A),A=A.parent;else if(g in POLARIS.dtd.$inline&&t.unshift(A),A.parent)n(A,A.parent,1);else{h.isOrphan=1;break}f(d);l();h.parent=A;h.isEmpty?n(h):A=h}}};r.onTagClose=function(a){for(var b=t.length-1;0<=b;b--)if(a==t[b].name){t.splice(b,1);return}for(var c=[],d=[],e=A;e!=p&&e.name!=a;)e._.isBlockLike||d.unshift(e),c.push(e),e=e.returnPoint||e.parent;if(e!=p){for(b=
0;b<c.length;b++){var f=c[b];n(f,f.parent)}A=e;e._.isBlockLike&&l();n(e,e.parent);e==A&&(A=A.parent);t=t.concat(d)}"body"==a&&(k=!1)};r.onText=function(a){if(!(A._.hasInlineStarted&&!w.length||C||x)&&(a=POLARIS.tools.ltrim(a),0===a.length))return;var b=A.name,h=b?POLARIS.dtd[b]||(A._.isBlockLike?POLARIS.dtd.div:POLARIS.dtd.span):c;if(!x&&!h["#"]&&b in e)r.onTagOpen(d[b]||""),r.onText(a);else{l();f();C||x||(a=a.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));a=new POLARIS.htmlParser.text(a);if(q(A,a))this.onTagOpen(k,
{},0,1);A.add(a)}};r.onCDATA=function(a){A.add(new POLARIS.htmlParser.cdata(a))};r.onComment=function(a){l();f();A.add(new POLARIS.htmlParser.comment(a))};r.parse(h);for(l();A!=p;)n(A,A.parent,1);m(p);return p};POLARIS.htmlParser.fragment.prototype={type:POLARIS.NODE_DOCUMENT_FRAGMENT,add:function(a,b){isNaN(b)&&(b=this.children.length);var c=0<b?this.children[b-1]:null;if(c){if(a._.isBlockLike&&c.type==POLARIS.NODE_TEXT&&(c.value=POLARIS.tools.rtrim(c.value),0===c.value.length)){this.children.pop();
this.add(a);return}c.next=a}a.previous=c;a.parent=this;this.children.splice(b,0,a);this._.hasInlineStarted||(this._.hasInlineStarted=a.type==POLARIS.NODE_TEXT||a.type==POLARIS.NODE_ELEMENT&&!a._.isBlockLike)},filter:function(a,b){b=this.getFilterContext(b);a.onRoot(b,this);this.filterChildren(a,!1,b)},filterChildren:function(a,b,c){if(this.childrenFilteredBy!=a.id){c=this.getFilterContext(c);if(b&&!this.parent)a.onRoot(c,this);this.childrenFilteredBy=a.id;for(b=0;b<this.children.length;b++)!1===this.children[b].filter(a,
c)&&b--}},writeHtml:function(a,b){b&&this.filter(b);this.writeChildrenHtml(a)},writeChildrenHtml:function(a,b,c){var d=this.getFilterContext();if(c&&!this.parent&&b)b.onRoot(d,this);b&&this.filterChildren(b,!1,d);b=0;c=this.children;for(d=c.length;b<d;b++)c[b].writeHtml(a)},forEach:function(a,b,c){if(!(c||b&&this.type!=b))var d=a(this);if(!1!==d){c=this.children;for(var e=0;e<c.length;e++)d=c[e],d.type==POLARIS.NODE_ELEMENT?d.forEach(a,b):b&&d.type!=b||a(d)}},getFilterContext:function(a){return a||
{}}}})();"use strict";(function(){function a(){this.rules=[]}function e(b,c,d,e){var g,k;for(g in c)(k=b[g])||(k=b[g]=new a),k.add(c[g],d,e)}POLARIS.htmlParser.filter=POLARIS.tools.createClass({$:function(b){this.id=POLARIS.tools.getNextNumber();this.elementNameRules=new a;this.attributeNameRules=new a;this.elementsRules={};this.attributesRules={};this.textRules=new a;this.commentRules=new a;this.rootRules=new a;b&&this.addRules(b,10)},proto:{addRules:function(a,c){var d;"number"==typeof c?d=c:c&&
"priority"in c&&(d=c.priority);"number"!=typeof d&&(d=10);"object"!=typeof c&&(c={});a.elementNames&&this.elementNameRules.addMany(a.elementNames,d,c);a.attributeNames&&this.attributeNameRules.addMany(a.attributeNames,d,c);a.elements&&e(this.elementsRules,a.elements,d,c);a.attributes&&e(this.attributesRules,a.attributes,d,c);a.text&&this.textRules.add(a.text,d,c);a.comment&&this.commentRules.add(a.comment,d,c);a.root&&this.rootRules.add(a.root,d,c)},applyTo:function(a){a.filter(this)},onElementName:function(a,
c){return this.elementNameRules.execOnName(a,c)},onAttributeName:function(a,c){return this.attributeNameRules.execOnName(a,c)},onText:function(a,c,d){return this.textRules.exec(a,c,d)},onComment:function(a,c,d){return this.commentRules.exec(a,c,d)},onRoot:function(a,c){return this.rootRules.exec(a,c)},onElement:function(a,c){for(var d=[this.elementsRules["^"],this.elementsRules[c.name],this.elementsRules.$],e,g=0;3>g;g++)if(e=d[g]){e=e.exec(a,c,this);if(!1===e)return null;if(e&&e!=c)return this.onNode(a,
e);if(c.parent&&!c.name)break}return c},onNode:function(a,c){var d=c.type;return d==POLARIS.NODE_ELEMENT?this.onElement(a,c):d==POLARIS.NODE_TEXT?new POLARIS.htmlParser.text(this.onText(a,c.value)):d==POLARIS.NODE_COMMENT?new POLARIS.htmlParser.comment(this.onComment(a,c.value)):null},onAttribute:function(a,c,d,e){return(d=this.attributesRules[d])?d.exec(a,e,c,this):e}}});POLARIS.htmlParser.filterRulesGroup=a;a.prototype={add:function(a,c,d){this.rules.splice(this.findIndex(c),0,{value:a,priority:c,
options:d})},addMany:function(a,c,d){for(var e=[this.findIndex(c),0],g=0,k=a.length;g<k;g++)e.push({value:a[g],priority:c,options:d});this.rules.splice.apply(this.rules,e)},findIndex:function(a){for(var c=this.rules,d=c.length-1;0<=d&&a<c[d].priority;)d--;return d+1},exec:function(a,c){var d=c instanceof POLARIS.htmlParser.node||c instanceof POLARIS.htmlParser.fragment,e=Array.prototype.slice.call(arguments,1),g=this.rules,k=g.length,f,l,m,n;for(n=0;n<k;n++)if(d&&(f=c.type,l=c.name),m=g[n],!(a.nonEditable&&
!m.options.applyToAll||a.nestedEditable&&m.options.excludeNestedEditable)){m=m.value.apply(null,e);if(!1===m||d&&m&&(m.name!=l||m.type!=f))return m;null!=m&&(e[0]=c=m)}return c},execOnName:function(a,c){for(var d=0,e=this.rules,g=e.length,k;c&&d<g;d++)k=e[d],a.nonEditable&&!k.options.applyToAll||a.nestedEditable&&k.options.excludeNestedEditable||(c=c.replace(k.value[0],k.value[1]));return c}}})();(function(){function a(a,e){function f(a){return a||POLARIS.env.needsNbspFiller?new POLARIS.htmlParser.text(" "):
new POLARIS.htmlParser.element("br",{"data-polaris-bogus":1})}function k(a,c){return function(d){if(d.type!=POLARIS.NODE_DOCUMENT_FRAGMENT){var e=d.attributes;"doc-data-role"in e&&0==e["doc-data-role"].indexOf("polaris-page-")||(e=!1,a?(m(d),e=!1!==("function"==typeof c?c(d):c)):(b(d)&&(e=!0),m(d)),e&&(z||POLARIS.env.needsBrFiller||d.type!=POLARIS.NODE_DOCUMENT_FRAGMENT?z||POLARIS.env.needsBrFiller||!(7<document.documentMode||d.name in POLARIS.dtd.tr||d.name in POLARIS.dtd.$listItem)?(e=b(d),e=!e||
"form"==d.name&&"input"==e.name):e=!1:e=!1),e&&d.add(f(a)))}}}function l(a,b){if((!z||POLARIS.env.needsBrFiller)&&a.type==POLARIS.NODE_ELEMENT&&"br"==a.name&&!a.attributes["data-polaris-eol"])return!0;var c;return a.type==POLARIS.NODE_TEXT&&(c=a.value.match(w))&&(c.index&&((new POLARIS.htmlParser.text(a.value.substring(0,c.index))).insertBefore(a),a.value=c[0]),!POLARIS.env.needsBrFiller&&z&&(!b||a.parent.name in p)||!z&&((c=a.previous)&&"br"==c.name||!c||h(c)))?!0:!1}function m(a){var d=[];a=b(a);
var e,g;if(a)for(l(a,1)&&d.push(a);a;)h(a)&&(e=c(a))&&l(e)&&((g=c(e))&&!h(g)?d.push(e):(f(z).insertAfter(e),e.remove())),a=a.previous;for(e=0;e<d.length;e++)g=d[e].attributes,"br"==d[e].name&&g.clear||d[e].remove()}var n={elements:{}},z="html"==e,p=POLARIS.tools.extend({},u),C;for(C in p)"#"in x[C]||delete p[C];for(C in p)n.elements[C]=k(z,a.config.fillEmptyBlocks);n.root=k(z,!1);n.elements.br=function(a){return function(b){if(b.parent.type!=POLARIS.NODE_DOCUMENT_FRAGMENT){var e=b.attributes;if("data-polaris-bogus"in
e||"data-polaris-eol"in e)delete e["data-polaris-bogus"];else{for(e=b.next;e&&d(e);)e=e.next;var k=c(b);!e&&h(b.parent)?g(b.parent,f(a)):h(e)&&k&&!h(k)&&f(a).insertBefore(e)}}}}(z);return n}function e(a,b){return a!=POLARIS.ENTER_BR&&!1!==b?a==POLARIS.ENTER_DIV?"div":"p":!1}function b(a){for(a=a.children[a.children.length-1];a&&d(a);)a=a.previous;return a}function c(a){for(a=a.previous;a&&d(a);)a=a.previous;return a}function d(a){return a.type==POLARIS.NODE_TEXT&&!POLARIS.tools.trim(a.value)||a.type==
POLARIS.NODE_ELEMENT&&a.attributes["data-polaris-bookmark"]}function h(a){return a&&(a.type==POLARIS.NODE_ELEMENT&&a.name in u||a.type==POLARIS.NODE_DOCUMENT_FRAGMENT)}function g(a,b){var c=a.children[a.children.length-1];a.children.push(b);b.parent=a;c&&(c.next=b,b.previous=c)}function k(a){a=a.attributes;"false"!=a.contenteditable&&(a["data-polaris-editable"]=a.contenteditable?"true":1);a.contenteditable="false"}function f(a){a=a.attributes;switch(a["data-polaris-editable"]){case "true":a.contenteditable=
"true";break;case "1":delete a.contenteditable}}function l(a){return a.replace(E,function(a,b,c){return"\x3c"+b+c.replace(H,function(a,b){return J.test(b)&&-1==c.indexOf("data-polaris-saved-"+b)?" data-polaris-saved-"+a+" data-polaris-"+POLARIS.rnd+"-"+a:a})+"\x3e"})}function m(a,b){return a.replace(b,function(a,b,c){0===a.indexOf("\x3ctextarea")&&(a=b+v(c).replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;")+"\x3c/textarea\x3e");return"\x3cpolaris:encoded\x3e"+encodeURIComponent(a)+"\x3c/polaris:encoded\x3e"})}
function n(a){return a.replace(z,function(a,b){return decodeURIComponent(b)})}function q(a){return a.replace(/\x3c!--(?!{polaris_protected})[\s\S]+?--\x3e/g,function(a){return"\x3c!--"+A+"{C}"+encodeURIComponent(a).replace(/--/g,"%2D%2D")+"--\x3e"})}function v(a){return a.replace(/\x3c!--\{polaris_protected\}\{C\}([\s\S]+?)--\x3e/g,function(a,b){return decodeURIComponent(b)})}function r(a,b){var c=b._.dataStore;return a.replace(/\x3c!--\{polaris_protected\}([\s\S]+?)--\x3e/g,function(a,b){return decodeURIComponent(b)}).replace(/\{polaris_protected_(\d+)\}/g,
function(a,b){return c&&c[b]||""})}function p(a,b){return a.replace(/([\w-]+)\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|(?:([^ >]+)))/gi,function(a,b,c){if(0>b.indexOf("polaris")){var d=new POLARIS.dom.element("div");d.setHtml(c);return/javascript:/gi.test(d.getText().replace(/\n/g,""))?"polaris-protected-"+a+" "+b+"\x3d'{polaris-protected}'":a}return a})}function t(a,b){var c=[],d=b.config.protectedSource,e=b._.dataStore||(b._.dataStore={id:1}),f=/<\!--\{polaris_temp(comment)?\}(\d*?)--\x3e/g,d=[/<script[\s\S]*?<\/script>/gi,
/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(d);a=a.replace(/\x3c!--[\s\S]*?--\x3e/g,function(a){return"\x3c!--{polaris_tempcomment}"+(c.push(a)-1)+"--\x3e"});for(var g=0;g<d.length;g++)a=a.replace(d[g],function(a){a=a.replace(f,function(a,b,d){return c[d]});return/polaris_temp(comment)?/.test(a)?a:"\x3c!--{polaris_temp}"+(c.push(a)-1)+"--\x3e"});a=a.replace(f,function(a,b,d){return"\x3c!--"+A+(b?"{C}":"")+encodeURIComponent(c[d]).replace(/--/g,"%2D%2D")+"--\x3e"});a=a.replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=>]+))+\s*>/g,
function(a){return a.replace(/\x3c!--\{polaris_protected\}([^>]*)--\x3e/g,function(a,b){e[e.id]=decodeURIComponent(b);return"{polaris_protected_"+e.id++ +"}"})});return a=a.replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,function(a,c,d,e){return"\x3c"+c+d+"\x3e"+r(v(e),b)+"\x3c/"+c+"\x3e"})}POLARIS.htmlDataProcessor=function(b){var c,d,f=this;this.editor=b;this.dataFilter=c=new POLARIS.htmlParser.filter;this.htmlFilter=d=new POLARIS.htmlParser.filter;this.writer=new POLARIS.htmlParser.basicWriter;
c.addRules(B);c.addRules(G,{applyToAll:!0});c.addRules(a(b,"data"),{applyToAll:!0});d.addRules(y);d.addRules(F,{applyToAll:!0});d.addRules(a(b,"html"),{applyToAll:!0});b.on("toHtml",function(a){a=a.data;var c=a.dataValue,d,c=t(c,b),c=m(c,L),c=l(c),c=m(c,I),c=c.replace(D,"$1polaris:$2"),c=c.replace(P,"\x3cpolaris:$1$2\x3e\x3c/polaris:$1\x3e"),c=c.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2"),c=c.replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-polaris-"+POLARIS.rnd+"-$2");d=a.context||b.editable().getName();
var f;POLARIS.env.ie&&9>POLARIS.env.version&&"pre"==d&&(d="div",c="\x3cpre\x3e"+c+"\x3c/pre\x3e",f=1);d=b.document.createElement(d);d.setHtml("a"+c);c=d.getHtml().substr(1);c=c.replace(new RegExp("data-polaris-"+POLARIS.rnd+"-","ig"),"");f&&(c=c.replace(/^<pre>|<\/pre>$/gi,""));c=c.replace(O,"$1$2");c=n(c);c=v(c);c=p(c,b);d=!1===a.fixForBody?!1:e(a.enterMode,b.config.autoParagraph);c=POLARIS.htmlParser.fragment.fromHtml(c,a.context,d);if(d&&(f=c,!f.children.length&&POLARIS.dtd[f.name][d])){var g=
{style:""};b.config.documentFontFamily&&(g.style+="font-family: "+b.config.documentFontFamily+";");b.config.documentFontSize&&(g.style+="font-size: "+b.config.documentFontSize+"pt;");b.config.documentLineHeight&&(g.style+="line-height: "+b.config.documentLineHeight+";");d=new POLARIS.htmlParser.element(d,g);d.setHtml("\x3cbr\x3e");f.add(d)}a.dataValue=c},null,null,5);b.on("toHtml",function(a){a.data.filter.applyTo(a.data.dataValue,!0,a.data.dontFilter,a.data.enterMode)&&b.fire("dataFiltered")},null,
null,6);b.on("toHtml",function(a){a.data.dataValue.filterChildren(f.dataFilter,!0)},null,null,10);b.on("toHtml",function(a){a=a.data;var b=a.dataValue,c=new POLARIS.htmlParser.basicWriter;b.writeChildrenHtml(c);b=c.getHtml(!0);a.dataValue=q(b)},null,null,15);b.on("toDataFormat",function(a){var c=a.data.dataValue;a.data.enterMode!=POLARIS.ENTER_BR&&(c=c.replace(/^<br *\/?>/i,""));a.data.dataValue=POLARIS.htmlParser.fragment.fromHtml(c,a.data.context,e(a.data.enterMode,b.config.autoParagraph))},null,
null,5);b.on("toDataFormat",function(a){a.data.dataValue.filterChildren(f.htmlFilter,!0)},null,null,10);b.on("toDataFormat",function(a){a.data.filter.applyTo(a.data.dataValue,!1,!0)},null,null,11);b.on("toDataFormat",function(a){var c=a.data.dataValue,d=f.writer;d.reset();c.writeChildrenHtml(d);c=d.getHtml(!0);c=v(c);c=r(c,b);a.data.dataValue=c},null,null,15)};POLARIS.htmlDataProcessor.prototype={toHtml:function(a,b,c,d){var e=this.editor,f,g,h;b&&"object"==typeof b?(f=b.context,c=b.fixForBody,d=
b.dontFilter,g=b.filter,h=b.enterMode):f=b;f||null===f||(f=e.editable().getName());return e.fire("toHtml",{dataValue:a,context:f,fixForBody:c,dontFilter:d,filter:g||e.filter,enterMode:h||e.enterMode}).dataValue},toDataFormat:function(a,b){var c,d,e;b&&(c=b.context,d=b.filter,e=b.enterMode);c||null===c||(c=this.editor.editable().getName());return this.editor.fire("toDataFormat",{dataValue:a,filter:d||this.editor.filter,context:c,enterMode:e||this.editor.enterMode}).dataValue}};var w=/(?:&nbsp;|\xa0)$/,
A="{polaris_protected}",x=POLARIS.dtd,C="caption colgroup col thead tfoot tbody".split(" "),u=POLARIS.tools.extend({},x.$blockLimit,x.$block),B={elements:{input:k,textarea:k}},G={attributeNames:[[/^on/,"data-polaris-pa-on"],[/^data-polaris-expando$/,""]]},y={elements:{embed:function(a){var b=a.parent;if(b&&"object"==b.name){var c=b.attributes.width,b=b.attributes.height;c&&(a.attributes.width=c);b&&(a.attributes.height=b)}},a:function(a){if(!(a.children.length||a.attributes.name||a.attributes["data-polaris-saved-name"]))return!1}}},
F={elementNames:[[/^polaris:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-polaris-(saved|pa)-/,""],[/^data-polaris-.*/,""],["hidefocus",""]],elements:{$:function(a){var b=a.attributes;if(b){if(b["data-polaris-temp"])return!1;for(var c=["name","href","src"],d,e=0;e<c.length;e++)d="data-polaris-saved-"+c[e],d in b&&delete b[c[e]]}return a},table:function(a){a.children.slice(0).sort(function(a,b){var c,d;a.type==POLARIS.NODE_ELEMENT&&b.type==a.type&&(c=POLARIS.tools.indexOf(C,a.name),d=POLARIS.tools.indexOf(C,
b.name));-1<c&&-1<d&&c!=d||(c=a.parent?a.getIndex():-1,d=b.parent?b.getIndex():-1);return c>d?1:-1})},param:function(a){a.children=[];a.isEmpty=!0;return a},span:function(a){"Apple-style-span"==a.attributes["class"]&&delete a.name},html:function(a){delete a.attributes.contenteditable;delete a.attributes["class"]},body:function(a){delete a.attributes.spellcheck;delete a.attributes.contenteditable},style:function(a){var b=a.children[0];b&&b.value&&(b.value=POLARIS.tools.trim(b.value));a.attributes.type||
(a.attributes.type="text/css")},title:function(a){var b=a.children[0];!b&&g(a,b=new POLARIS.htmlParser.text);b.value=a.attributes["data-polaris-title"]||""},input:f,textarea:f},attributes:{"class":function(a){return POLARIS.tools.ltrim(a.replace(/(?:^|\s+)polaris_[^\s]*/g,""))||!1}}};POLARIS.env.ie&&(F.attributes.style=function(a){return a.replace(/(^|;)([^\:]+)/g,function(a){return a.toLowerCase()})});var E=/<(a|area|img|input|source)\b([^>]*)>/gi,H=/([\w-]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ >]+))/gi,
J=/^(href|src|name)$/i,I=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,L=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,z=/<polaris:encoded>([^<]*)<\/polaris:encoded>/gi,D=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,O=/(<\/?)polaris:((?:html|body|head|title)[^>]*>)/gi,P=/<polaris:(param|embed)([^>]*?)\/?>(?!\s*<\/polaris:\1)/gi})();"use strict";POLARIS.htmlParser.element=function(a,e){this.name=a;this.attributes=e||{};this.children=[];var b=
a||"",c=b.match(/^polaris:(.*)/);c&&(b=c[1]);b=!!(POLARIS.dtd.$nonBodyContent[b]||POLARIS.dtd.$block[b]||POLARIS.dtd.$listItem[b]||POLARIS.dtd.$tableContent[b]||POLARIS.dtd.$nonEditable[b]||"br"==b);this.isEmpty=!!POLARIS.dtd.$empty[a];this.isUnknown=!POLARIS.dtd[a];this._={isBlockLike:b,hasInlineStarted:this.isEmpty||!b}};POLARIS.htmlParser.cssStyle=function(a){var e={};((a instanceof POLARIS.htmlParser.element?a.attributes.style:a)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,
function(a,c,d){"font-family"==c&&(d=d.replace(/["']/g,""));e[c.toLowerCase()]=d});return{rules:e,populate:function(a){var c=this.toString();c&&(a instanceof POLARIS.dom.element?a.setAttribute("style",c):a instanceof POLARIS.htmlParser.element?a.attributes.style=c:a.style=c)},toString:function(){var a=[],c;for(c in e)e[c]&&a.push(c,":",e[c],";");return a.join("")}}};(function(){function a(a){return function(b){return b.type==POLARIS.NODE_ELEMENT&&("string"==typeof a?b.name==a:b.name in a)}}var e=
function(a,b){a=a[0];b=b[0];return a<b?-1:a>b?1:0},b=POLARIS.htmlParser.fragment.prototype;POLARIS.htmlParser.element.prototype=POLARIS.tools.extend(new POLARIS.htmlParser.node,{type:POLARIS.NODE_ELEMENT,add:b.add,clone:function(){return new POLARIS.htmlParser.element(this.name,this.attributes)},filter:function(a,b){var e=this,g,k;b=e.getFilterContext(b);if(b.off)return!0;if(!e.parent)a.onRoot(b,e);for(;;){g=e.name;if(!(k=a.onElementName(b,g)))return this.remove(),!1;e.name=k;if(!(e=a.onElement(b,
e)))return this.remove(),!1;if(e!==this)return this.replaceWith(e),!1;if(e.name==g)break;if(e.type!=POLARIS.NODE_ELEMENT)return this.replaceWith(e),!1;if(!e.name)return this.replaceWithChildren(),!1}g=e.attributes;var f,l;for(f in g){for(k=g[f];;)if(l=a.onAttributeName(b,f))if(l!=f)delete g[f],f=l;else break;else{delete g[f];break}l&&(!1===(k=a.onAttribute(b,e,l,k))?delete g[l]:g[l]=k)}e.isEmpty||this.filterChildren(a,!1,b);return!0},filterChildren:b.filterChildren,writeHtml:function(a,b){b&&this.filter(b);
var h=this.name,g=[],k=this.attributes,f,l;a.openTag(h,k);for(f in k)g.push([f,k[f]]);a.sortAttributes&&g.sort(e);f=0;for(l=g.length;f<l;f++)k=g[f],a.attribute(k[0],k[1]);a.openTagClose(h,this.isEmpty);this.writeChildrenHtml(a);this.isEmpty||a.closeTag(h)},writeChildrenHtml:b.writeChildrenHtml,replaceWithChildren:function(){for(var a=this.children,b=a.length;b;)a[--b].insertAfter(this);this.remove()},forEach:b.forEach,getFirst:function(b){if(!b)return this.children.length?this.children[0]:null;"function"!=
typeof b&&(b=a(b));for(var d=0,e=this.children.length;d<e;++d)if(b(this.children[d]))return this.children[d];return null},getHtml:function(){var a=new POLARIS.htmlParser.basicWriter;this.writeChildrenHtml(a);return a.getHtml()},setHtml:function(a){a=this.children=POLARIS.htmlParser.fragment.fromHtml(a).children;for(var b=0,e=a.length;b<e;++b)a[b].parent=this},getOuterHtml:function(){var a=new POLARIS.htmlParser.basicWriter;this.writeHtml(a);return a.getHtml()},split:function(a){for(var b=this.children.splice(a,
this.children.length-a),e=this.clone(),g=0;g<b.length;++g)b[g].parent=e;e.children=b;b[0]&&(b[0].previous=null);0<a&&(this.children[a-1].next=null);this.parent.add(e,this.getIndex()+1);return e},addClass:function(a){if(!this.hasClass(a)){var b=this.attributes["class"]||"";this.attributes["class"]=b+(b?" ":"")+a}},removeClass:function(a){var b=this.attributes["class"];b&&((b=POLARIS.tools.trim(b.replace(new RegExp("(?:\\s+|^)"+a+"(?:\\s+|$)")," ")))?this.attributes["class"]=b:delete this.attributes["class"])},
hasClass:function(a){var b=this.attributes["class"];return b?(new RegExp("(?:^|\\s)"+a+"(?\x3d\\s|$)")).test(b):!1},getFilterContext:function(a){var b=[];a||(a={off:!1,nonEditable:!1,nestedEditable:!1});a.off||"off"!=this.attributes["data-polaris-processor"]||b.push("off",!0);a.nonEditable||"false"!=this.attributes.contenteditable?a.nonEditable&&!a.nestedEditable&&"true"==this.attributes.contenteditable&&b.push("nestedEditable",!0):b.push("nonEditable",!0);if(b.length){a=POLARIS.tools.copy(a);for(var e=
0;e<b.length;e+=2)a[b[e]]=b[e+1]}return a}},!0)})();(function(){var a={},e=/{([^}]+)}/g,b=/([\\'])/g,c=/\n/g,d=/\r/g;POLARIS.template=function(h){if(a[h])this.output=a[h];else{var g=h.replace(b,"\\$1").replace(c,"\\n").replace(d,"\\r").replace(e,function(a,b){return"',data['"+b+"']\x3d\x3dundefined?'{"+b+"}':data['"+b+"'],'"});this.output=a[h]=Function("data","buffer","return buffer?buffer.push('"+g+"'):['"+g+"'].join('');")}}})();delete POLARIS.loadFullCore;POLARIS.instances={};POLARIS.document=
new POLARIS.dom.document(document);POLARIS.add=function(a){POLARIS.instances[a.name]=a;a.on("focus",function(){POLARIS.currentInstance!=a&&(POLARIS.currentInstance=a,POLARIS.fire("currentInstance"))});a.on("blur",function(){POLARIS.currentInstance==a&&(POLARIS.currentInstance=null,POLARIS.fire("currentInstance"))});POLARIS.fire("instance",null,a)};POLARIS.remove=function(a){delete POLARIS.instances[a.name]};(function(){var a={};POLARIS.addTemplate=function(e,b){var c=a[e];if(c)return c;c={name:e,
source:b};POLARIS.fire("template",c);return a[e]=new POLARIS.template(c.source)};POLARIS.getTemplate=function(e){return a[e]}})();(function(){var a=[];POLARIS.addCss=function(e){a.push(e)};POLARIS.getCss=function(){return a.join("\n")}})();POLARIS.on("instanceDestroyed",function(){POLARIS.tools.isEmpty(this.instances)&&POLARIS.fire("reset")});POLARIS.TRISTATE_ON=1;POLARIS.TRISTATE_OFF=2;POLARIS.TRISTATE_DISABLED=0;POLARIS.TRISTATE_CHECKED=3;(function(){POLARIS.inline=function(a,e){if(!POLARIS.env.isCompatible)return null;
a=POLARIS.dom.element.get(a);if(a.getEditor())throw'The editor instance "'+a.getEditor().name+'" is already attached to the provided element.';var b=new POLARIS.editor(e,a,POLARIS.ELEMENT_MODE_INLINE),c=a.is("textarea")?a:null;c?(b.setData(c.getValue(),null,!0),a=POLARIS.dom.element.createFromHtml('\x3cdiv contenteditable\x3d"'+!!b.readOnly+'" class\x3d"polaris_textarea_inline"\x3e'+c.getValue()+"\x3c/div\x3e",POLARIS.document),a.insertAfter(c),c.hide(),c.$.form&&b._attachToForm()):b.setData(a.getHtml(),
null,!0);b.on("loaded",function(){b.fire("uiReady");b.editable(a);b.container=a;b.setData(b.getData(1));b.resetDirty();b.fire("contentDom");b.mode="wysiwyg";b.fire("mode");b.status="ready";b.fireOnce("instanceReady");POLARIS.fire("instanceReady",null,b)},null,null,1E4);b.on("destroy",function(){c&&(b.container.clearCustomData(),b.container.remove(),c.show());b.element.clearCustomData();delete b.element});return b};POLARIS.inlineAll=function(){var a,e,b;for(b in POLARIS.dtd.$editable)for(var c=POLARIS.document.getElementsByTag(b),
d=0,h=c.count();d<h;d++)a=c.getItem(d),"true"==a.getAttribute("contenteditable")&&(e={element:a,config:{}},!1!==POLARIS.fire("inline",e)&&POLARIS.inline(a,e.config))};POLARIS.domReady(function(){!POLARIS.disableAutoInline&&POLARIS.inlineAll()})})();POLARIS.replaceClass="polarisditor";(function(){function a(a,d,h,g){if(!POLARIS.env.isCompatible)return null;a=POLARIS.dom.element.get(a);if(a.getEditor())throw'The editor instance "'+a.getEditor().name+'" is already attached to the provided element.';
var k=new POLARIS.editor(d,a,g);g==POLARIS.ELEMENT_MODE_REPLACE&&(a.setStyle("visibility","hidden"),k._.required=a.hasAttribute("required"),a.removeAttribute("required"));h&&k.setData(h,null,!0);k.on("loaded",function(){b(k);g==POLARIS.ELEMENT_MODE_REPLACE&&k.config.autoUpdateElement&&a.$.form&&k._attachToForm();k.setMode(k.config.startupMode,function(){k.resetDirty();k.status="ready";k.fireOnce("instanceReady");POLARIS.fire("instanceReady",null,k)})});k.on("destroy",e);return k}function e(){var a=
this.container,b=this.element;a&&(a.clearCustomData(),a.remove());b&&(b.clearCustomData(),this.elementMode==POLARIS.ELEMENT_MODE_REPLACE&&(b.show(),this._.required&&b.setAttribute("required","required")),delete this.element)}function b(a){var b=a.name,e=a.element,g=a.elementMode,k=a.fire("uiSpace",{space:"top",html:""}).html,f=a.fire("uiSpace",{space:"bottom",html:""}).html;if(POLARIS.env.ie||POLARIS.env.gecko)k+='\x3ca href\x3d"#" accesskey\x3d"t"\x3e\x3c/a\x3e';var l=new POLARIS.template('\x3c{outerEl} id\x3d"polaris_{name}" class\x3d"{id} polaris polaris_reset polaris_chrome polaris_editor_{name} polaris_{langDir} '+
POLARIS.env.cssClass+'"  dir\x3d"{langDir}" lang\x3d"{langCode}" role\x3d"application"'+(a.title?' aria-labelledby\x3d"polaris_{name}_arialbl"':"")+"\x3e"+(a.title?'\x3cspan id\x3d"polaris_{name}_arialbl" class\x3d"polaris_voice_label"\x3e{voiceLabel}\x3c/span\x3e':"")+'\x3c{outerEl} class\x3d"polaris_inner polaris_reset" role\x3d"presentation"\x3e{topHtml}\x3c{outerEl} id\x3d"{contentId}" class\x3d"polaris_contents polaris_reset" role\x3d"presentation"\x3e\x3c/{outerEl}\x3e{bottomHtml}\x3c/{outerEl}\x3e\x3c/{outerEl}\x3e'),
b=POLARIS.dom.element.createFromHtml(l.output({id:a.id,name:b,langDir:a.lang.dir,langCode:a.langCode,voiceLabel:a.title,topHtml:k?'\x3cspan id\x3d"'+a.ui.spaceId("top")+'" class\x3d"polaris_top polaris_reset_all" role\x3d"presentation" style\x3d"height:auto;width:100%"\x3e'+k+"\x3c/span\x3e":"",contentId:a.ui.spaceId("contents"),bottomHtml:f?'\x3cspan id\x3d"'+a.ui.spaceId("bottom")+'" class\x3d"polaris_bottom polaris_reset_all" role\x3d"presentation"\x3e'+f+"\x3c/span\x3e":"",outerEl:POLARIS.env.ie?
"span":"div"}));g==POLARIS.ELEMENT_MODE_REPLACE?(e.hide(),b.insertAfter(e)):e.append(b);a.container=b;f&&a.ui.space("bottom").unselectable();e=a.config.width;g=a.config.height;e&&b.setStyle("width",POLARIS.tools.cssLength(e));g&&a.ui.space("contents").setStyle("height",POLARIS.tools.cssLength(g));b.disableContextMenu();POLARIS.env.webkit&&b.on("focus",function(){a.focus()});a.fireOnce("uiReady")}POLARIS.replace=function(b,d){return a(b,d,null,POLARIS.ELEMENT_MODE_REPLACE)};POLARIS.appendTo=function(b,
d,e){return a(b,d,e,POLARIS.ELEMENT_MODE_APPENDTO)};POLARIS.replaceAll=function(){for(var a=document.getElementsByTagName("textarea"),b=0;b<a.length;b++){var e=null,g=a[b];if(g.name||g.id){if("string"==typeof arguments[0]){if(!(new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)")).test(g.className))continue}else if("function"==typeof arguments[0]&&(e={},!1===arguments[0](g,e)))continue;this.replace(g,e)}}};POLARIS.editor.prototype.addMode=function(a,b){(this._.modes||(this._.modes={}))[a]=b};POLARIS.editor.prototype.setMode=
function(a,b){var e=this,g=this._.modes;if(a!=e.mode&&g&&g[a]){e.fire("beforeSetMode",a);if(e.mode){var k=e.checkDirty(),g=e._.previousModeData,f,l=0;e.fire("beforeModeUnload");e.editable(0);e._.previousMode=e.mode;e._.previousModeData=f=e.getData(1);"source"==e.mode&&g==f&&(e.fire("lockSnapshot",{forceUpdate:!0}),l=1);e.ui.space("contents").setHtml("");e.mode=""}else e._.previousModeData=e.getData(1);this._.modes[a](function(){e.mode=a;void 0!==k&&!k&&e.resetDirty();l?e.fire("unlockSnapshot"):"wysiwyg"==
a&&e.fire("saveSnapshot");setTimeout(function(){e.fire("mode");b&&b.call(e)},0)})}};POLARIS.editor.prototype.resize=function(a,b,e,g){var k=this.container,f=this.ui.space("contents"),l=POLARIS.env.webkit&&this.document&&this.document.getWindow().$.frameElement;g=g?this.container.getFirst(function(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasClass("polaris_inner")}):k;g.setSize("width",a,!0);l&&(l.style.width="1%");f.setStyle("height",Math.max(b-(e?0:(g.$.offsetHeight||0)-(f.$.clientHeight||0)),0)+
"px");l&&(l.style.width="100%");this.fire("resize")};POLARIS.editor.prototype.getResizable=function(a){return a?this.ui.space("contents"):this.container};POLARIS.domReady(function(){POLARIS.replaceClass&&POLARIS.replaceAll(POLARIS.replaceClass)});POLARIS.editor.prototype.showProgress=function(){var a,b=[];return function(e,g,k,f){if(1==f)return 0<=b.indexOf(g)?!0:!1;if(!a){if(void 0==k||null==k)k='\x3cdiv id\x3d"polaris_progress_cover" style\x3d"background-color:rgba(255,255,255,0.7);width:100%;height:100%;top:0;left:0;position:absolute;visibility:visible;z-index:200;cursor:progress"\x3e\x3cdiv style\x3d"display:table;width:100%;height:100%;"\x3e\x3cdiv style\x3d"text-align:center;vertical-align:middle;display:table-cell;"\x3e처리 중에는 편집을 할 수 없습니다.\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';
a=POLARIS.dom.element.createFromHtml(k);a.appendTo(this.container);POLARIS.env.ie&&9>POLARIS.env.version&&(a.setStyle("zoom",1),a.setStyle("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr\x3d#EEFFFFFF,endColorstr\x3d#EEFFFFFF)"))}e?(b.push(g),a.setStyle("visibility","visible")):(b.pop(g),0==b.length&&a.setStyle("visibility","hidden"))}}()})();POLARIS.config.startupMode="wysiwyg";(function(){function a(a){var b=a.editor,d=a.data.path,f=d.blockLimit,k=a.data.selection,h=k.getRanges()[0],
l;if(POLARIS.env.gecko||POLARIS.env.ie&&POLARIS.env.needsBrFiller){var m=k.getStartElement();m&&h.collapsed&&h.startOffset==h.endOffset&&m.type==POLARIS.NODE_ELEMENT&&0<m.getText().length||!(k=e(k,d))||(k.appendBogus(),l=POLARIS.env.ie)}g(b,d.block,f)&&h.collapsed&&!h.getCommonAncestor().isReadOnly()&&(d=h.clone(),d.enlarge(POLARIS.ENLARGE_BLOCK_CONTENTS),f=new POLARIS.dom.walker(d),f.guard=function(a){return!c(a)||a.type==POLARIS.NODE_COMMENT||a.isReadOnly()},!f.checkForward()||d.checkStartOfBlock()&&
d.checkEndOfBlock())&&(b=h.fixBlock(!0,b.activeEnterMode==POLARIS.ENTER_DIV?"div":"p"),POLARIS.env.needsBrFiller||(b=b.getFirst(c))&&b.type==POLARIS.NODE_TEXT&&POLARIS.tools.trim(b.getText()).match(/^(?:&nbsp;|\xa0)$/)&&b.remove(),l=1,a.cancel());l&&h.select()}function e(a,b){if(a.isFake)return 0;var d=b.block||b.blockLimit,e=d&&d.getLast(c);if(!(!d||!d.isBlockBoundary()||e&&e.type==POLARIS.NODE_ELEMENT&&e.isBlockBoundary()||d.is("pre")||d.getBogus()))return d}function b(a){var b=a.data.getTarget();
b.is("input")&&(b=b.getAttribute("type"),"submit"!=b&&"reset"!=b||a.data.preventDefault())}function c(a){return n(a)&&q(a)}function d(a,b){return function(c){var d=POLARIS.dom.element.get(c.data.$.toElement||c.data.$.fromElement||c.data.$.relatedTarget);d&&(b.equals(d)||b.contains(d))||a.call(this,c)}}function h(a){function b(a){return function(b,e){e&&b.type==POLARIS.NODE_ELEMENT&&b.is(f)&&(d=b);if(!(e||!c(b)||a&&l(b)))return!1}}var d,e=a.getRanges()[0];a=a.root;var f={table:1,ul:1,ol:1,dl:1};if(e.startPath().contains(f)){var g=
e.clone();g.collapse(1);g.setStartAt(a,POLARIS.POSITION_AFTER_START);a=new POLARIS.dom.walker(g);a.guard=b();a.checkBackward();if(d)return g=e.clone(),g.collapse(),g.setEndAt(d,POLARIS.POSITION_AFTER_END),a=new POLARIS.dom.walker(g),a.guard=b(!0),d=!1,a.checkForward(),d}return null}function g(a,b,c){return!1!==a.config.autoParagraph&&a.activeEnterMode!=POLARIS.ENTER_BR&&a.editable().equals(c)&&!b||b&&"true"==b.getAttribute("contenteditable")}function k(a){a.editor.focus();a.editor.fire("saveSnapshot")}
function f(a){var b=a.editor;POLARIS.tools.reloadWebFontCss(b);b.document.getSelection().scrollIntoView();setTimeout(function(){b.fire("saveSnapshot");b.fire("contentChange",{type:"insert"})},0)}POLARIS.editable=POLARIS.tools.createClass({base:POLARIS.dom.element,$:function(a,b){this.base(b.$||b);this.editor=a;this.status="unloaded";this.isComposing=this.hasFocus=!1;this.setup()},proto:{focus:function(){var a;if(POLARIS.env.webkit&&!this.hasFocus&&(a=this.editor._.previousActive||this.getDocument().getActive(),
this.contains(a))){a.focus();return}try{this.$[POLARIS.env.ie&&this.getDocument().equals(POLARIS.document)?"setActive":"focus"]()}catch(b){if(!POLARIS.env.ie)throw b;}POLARIS.env.safari&&!this.isInline()&&(a=POLARIS.document.getActive(),a.equals(this.getWindow().getFrame())||this.getWindow().focus())},on:function(a,b){var c=Array.prototype.slice.call(arguments,0);POLARIS.env.ie&&/^focus|blur$/.exec(a)&&(a="focus"==a?"focusin":"focusout",b=d(b,this),c[0]=a,c[1]=b);return POLARIS.dom.element.prototype.on.apply(this,
c)},attachListener:function(a){this._.listeners||(this._.listeners=[]);var b=Array.prototype.slice.call(arguments,1),b=a.on.apply(a,b);this._.listeners.push(b);return b},clearListeners:function(){var a=this._.listeners;try{for(;a.length;)a.pop().removeListener()}catch(b){}},restoreAttrs:function(){var a=this._.attrChanges,b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],null!==b?this.setAttribute(c,b):this.removeAttribute(c))},attachClass:function(a){var b=this.getCustomData("classes");this.hasClass(a)||
("body_class"!=a&&(!b&&(b=[]),b.push(a),this.setCustomData("classes",b)),this.addClass(a))},changeAttr:function(a,b){var c=this.getAttribute(a);b!==c&&(!this._.attrChanges&&(this._.attrChanges={}),a in this._.attrChanges||(this._.attrChanges[a]=c),this.setAttribute(a,b))},insertHtml:function(a,b){k(this);v(this,b||"html",a)},insertText:function(a){k(this);var b=this.editor,c=b.getSelection().getStartElement(),d=c&&c.hasAscendant&&c.hasAscendant("pre",!0)?POLARIS.ENTER_BR:b.activeEnterMode,b=d==POLARIS.ENTER_BR,
e=POLARIS.tools;a=e.htmlEncode(a.replace(/\r\n/g,"\n"));a=a.replace(/\t/g,"\x26nbsp;\x26nbsp; \x26nbsp;");var f=d=d==POLARIS.ENTER_P?"p":"div";(c=c?c.getAttribute("style"):"")&&(f=f+' style \x3d "'+c+'"');if(!b)if(c=/\n{3}/g,c.test(a)){var g="\x3c"+f+"\x3e",h="\x3c/"+d+"\x3e";a=g+a.replace(c,function(){return"\n"+h+g})+h;a=a.replace(/\n/g,"\x3cbr\x3e")}else c=/\n{2}/g,c.test(a)&&(g="\x3c"+f+"\x3e",h="\x3c/"+d+"\x3e",a=g+a.replace(c,function(){return h+g})+h),a=a.replace(/\n/g,"\x3cbr\x3e"),b||(a=
a.replace(new RegExp("\x3cbr\x3e(?\x3d\x3c/"+d+"\x3e)"),function(a){return e.repeat(a,2)}));a=a.replace(/^ | $/g,"\x26nbsp;");a=a.replace(/(>|\s) /g,function(a,b){return b+"\x26nbsp;"}).replace(/ (?=<)/g,"\x26nbsp;");v(this,"text",a)},insertElement:function(a,b){b?this.insertElementIntoRange(a,b):this.insertElementIntoSelection(a)},insertElementIntoRange:function(a,b){var c=this.editor,d=c.config.enterMode,e=a.getName(),f=POLARIS.dtd.$block[e],g=c.getSelection().getStartElement();g&&(g.hasAttribute("doc-data-field")||
(g=g.getAscendant(function(a){return a.hasAttribute&&a.hasAttribute("doc-data-field")})));if(!g&&b.checkReadOnly())return!1;b.deleteContents(1);b.startContainer.type==POLARIS.NODE_ELEMENT&&b.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})&&r(b);var h,k;if(f)for(;(h=b.getCommonAncestor(0,1))&&(k=POLARIS.dtd[h.getName()])&&(!k||!k[e]);)h.getName()in POLARIS.dtd.span?b.splitElement(h):b.checkStartOfBlock()&&b.checkEndOfBlock()?(b.setStartBefore(h),b.collapse(!0),h.remove()):b.splitBlock(d==
POLARIS.ENTER_DIV?"div":"p",c.editable());b.insertNode(a);return!0},insertElementIntoSelection:function(a){k(this);var b=this.editor,d=b.activeEnterMode,b=b.getSelection(),e=b.getRanges()[0],g=a.getName(),g=POLARIS.dtd.$block[g];this.insertElementIntoRange(a,e)&&(e.moveToPosition(a,POLARIS.POSITION_AFTER_END),g&&((g=a.getNext(function(a){return c(a)&&!l(a)}))&&g.type==POLARIS.NODE_ELEMENT&&g.is(POLARIS.dtd.$block)?g.getDtd()["#"]?e.moveToElementEditStart(g):e.moveToElementEditEnd(a):g||d==POLARIS.ENTER_BR||
(g=e.fixBlock(!0,d==POLARIS.ENTER_DIV?"div":"p"),e.moveToElementEditStart(g))));b.selectRanges([e]);f(this)},setData:function(a,b){b||(a=this.editor.dataProcessor.toHtml(a));this.setHtml(a);this.fixInitialSelection();"unloaded"==this.status&&(this.status="ready");this.editor.fire("dataReady")},getData:function(a){var b=this.getHtml();a||(b=this.editor.dataProcessor.toDataFormat(b));return b},setReadOnly:function(a){this.setAttribute("contenteditable",!a)},detach:function(){this.removeClass("polaris_editable");
this.status="detached";var a=this.editor;this._.detach();delete a.document;delete a.window},isInline:function(){return this.getDocument().equals(POLARIS.document)},fixInitialSelection:function(){function a(){var b=c.getDocument().$,d=b.getSelection(),e;a:if(d.anchorNode&&d.anchorNode==c.$)e=!0;else{if(POLARIS.env.webkit&&(e=c.getDocument().getActive())&&e.equals(c)&&!d.anchorNode){e=!0;break a}e=void 0}e&&(e=new POLARIS.dom.range(c),e.moveToElementEditStart(c),b=b.createRange(),b.setStart(e.startContainer.$,
e.startOffset),b.collapse(!0),d.removeAllRanges(),d.addRange(b))}function b(){var a=c.getDocument().$,d=a.selection,e=c.getDocument().getActive();"None"==d.type&&e.equals(c)&&(d=new POLARIS.dom.range(c),a=a.body.createTextRange(),d.moveToElementEditStart(c),d=d.startContainer,d.type!=POLARIS.NODE_ELEMENT&&(d=d.getParent()),a.moveToElementText(d.$),a.collapse(!0),a.select())}var c=this;if(POLARIS.env.ie&&(9>POLARIS.env.version||POLARIS.env.quirks))this.hasFocus&&(this.focus(),b());else if(this.hasFocus)this.focus(),
a();else this.once("focus",function(){a()},null,null,-999)},setup:function(){var a=this.editor;this.on("compositionstart",function(){this.isComposing=!0},this);this.on("compositionend",function(){this.isComposing=!1},this);this.attachListener(a,"beforeGetData",function(){var b=this.getData();this.is("textarea")||!1!==a.config.ignoreEmptyParagraph&&(b=b.replace(m,function(a,b){return b}));a.setData(b,null,1)},this);this.attachListener(a,"getSnapshot",function(a){a.data=this.getData(1)},this);this.attachListener(a,
"afterSetData",function(){this.setData(a.getData(1))},this);this.attachListener(a,"loadSnapshot",function(a){this.setData(a.data,1)},this);this.attachListener(a,"beforeFocus",function(){var b=a.getSelection();(b=b&&b.getNative())&&"Control"==b.type||this.focus()},this);this.attachListener(a,"insertHtml",function(a){this.insertHtml(a.data.dataValue,a.data.mode)},this);this.attachListener(a,"insertElement",function(a){this.insertElement(a.data)},this);this.attachListener(a,"insertText",function(a){this.insertText(a.data)},
this);a.config.wordprocessor||this.setReadOnly(a.readOnly);this.attachClass("polaris_editable");this.attachClass("polaris_pagesize");a.config.wordprocessor||(this.setStyle("padding-left",a.config.paddingleft),this.setStyle("padding-right",a.config.paddingright),this.setStyle("padding-top",a.config.paddingtop));this.attachClass("body_class");this.setStyle("cursor","auto");var d=a.config.width;POLARIS.tools.isNumber(d)&&(d=parseInt(a.config.width,10)-parseInt(a.config.paddingright,10)-parseInt(a.config.paddingleft,
10)-parseInt(a.config.scrollWidth,10),this.setStyle("width",d));this.attachClass(a.elementMode==POLARIS.ELEMENT_MODE_INLINE?"polaris_editable_inline":a.elementMode==POLARIS.ELEMENT_MODE_REPLACE||a.elementMode==POLARIS.ELEMENT_MODE_APPENDTO?"polaris_editable_themed":"");this.attachClass("polaris_contents_"+a.config.contentsLangDirection);a.keystrokeHandler.blockedKeystrokes[8]=+a.readOnly;a.keystrokeHandler.attach(this);this.on("blur",function(){this.hasFocus=!1},null,null,-1);this.on("focus",function(){this.hasFocus=
!0},null,null,-1);a.focusManager.add(this);this.equals(POLARIS.document.getActive())&&(this.hasFocus=!0,a.once("contentDom",function(){a.focusManager.focus(this)},this));this.isInline()&&this.changeAttr("tabindex",a.tabIndex);if(!this.is("textarea")){a.document=this.getDocument();a.window=this.getWindow();d=a.document;this.changeAttr("spellcheck",!a.config.disableNativeSpellChecker);var e=a.config.contentsLangDirection;this.getDirection(1)!=e&&this.changeAttr("dir",e);var f=POLARIS.getCss();f&&(e=
d.getHead(),e.getCustomData("stylesheet")||(f=d.appendStyleText(f),f=new POLARIS.dom.element(f.ownerNode||f.owningElement),e.setCustomData("stylesheet",f),f.data("polaris-temp",1)));e=d.getCustomData("stylesheet_ref")||0;d.setCustomData("stylesheet_ref",e+1);this.setCustomData("polaris_includeReadonly",!a.config.disableReadonlyStyling);this.attachListener(this,"click",function(a){a=a.data;var b=(new POLARIS.dom.elementPath(a.getTarget(),this)).contains("a");b&&2!=a.$.button&&b.isReadOnly()&&a.preventDefault()});
var g={8:1,46:1};this.attachListener(a,"key",function(b){if(a.readOnly)return!0;var c=b.data.domEvent.getKey(),d,e=a.getSelection(),f=e.getRanges()[0],k=f?f.startPath():void 0,l=k?k.block:void 0;if(!f)return!d;if(b.data.domEvent.$.ctrlKey)return!0;if(c in g){var m,r;b=8==c;POLARIS.env.ie&&11>POLARIS.env.version&&(m=e.getSelectedElement())||(m=h(e))?(a.fire("saveSnapshot"),f.moveToPosition(m,POLARIS.POSITION_BEFORE_START),m.remove(),f.select(),a.fire("saveSnapshot"),d=1):f.collapsed&&(l&&(r=l[b?"getPrevious":
"getNext"](n))&&r.type==POLARIS.NODE_ELEMENT&&r.is("table")&&f[b?"checkStartOfBlock":"checkEndOfBlock"]()?(a.fire("saveSnapshot"),46==c&&l&&(l.trim(),0==l.getText().replace(/\u200B/g,"").length&&l.remove()),a.openDialog("deleteTable",function(){f.selectNodeContents(r);f.select();this._.selectedElement=r}),d=1):POLARIS.env.ie&&l&&r&&r.type==POLARIS.NODE_ELEMENT&&r.is("hr")&&f[b?"checkStartOfBlock":"checkEndOfBlock"]()?(a.fire("saveSnapshot"),r.remove(),a.fire("saveSnapshot"),d=1):l&&(r&&r.type==POLARIS.NODE_ELEMENT&&
r.is("div")||!r&&k.blockLimit&&k.blockLimit.is("div"))&&f[b?"checkStartOfBlock":"checkEndOfBlock"]()&&(r&&(a.fire("saveSnapshot"),r.remove(),a.fire("saveSnapshot")),d=1))}return!d});a.blockless&&POLARIS.env.ie&&POLARIS.env.needsBrFiller&&this.attachListener(this,"keyup",function(b){b.data.getKeystroke()in g&&!this.getFirst(c)&&(this.appendBogus(),b=a.createRange(),b.moveToPosition(this,POLARIS.POSITION_AFTER_START),b.select())});this.attachListener(this,"dblclick",function(b){if(a.readOnly)return!1;
b={element:b.data.getTarget()};a.fire("doubleclick",b)});this.attachListener(a.window,"scroll",function(b){b={element:b.data.getTarget()};a.fire("scroll",b)});this.attachListener(this,"mousedown",function(b){this.isComposing=this.isDragging=!1;var c={element:b.data.getTarget()};2==a.config.editMode&&c.element&&!c.element.isEditable()?(a.fire("hidePanel"),b.data.preventDefault(),setTimeout(function(){var b=c.element.findOne('article[doc-data-field-editable\x3d"true"]');if(b){var d=new POLARIS.dom.range(a.document);
d.moveToElementEditablePosition(b,!0);d.select(!0);a.focus()}},0)):(b=b.data.$.button,0===b?a.fire("mousedownleft",c):2==b&&a.fire("mousedownright",c))});this.attachListener(this,"mouseup",function(b){var c={element:b.data.getTarget(),buttonType:b.data.$.button,ctrlKey:b.data.$.ctrlKey,isDragging:this.isDragging};this.isDragging=!1;a.fire("mouseup",c);var d=a.document.getSelection().getRanges()[0];if(d&&d.collapsed&&d.startContainer&&d.startContainer.type==POLARIS.NODE_ELEMENT&&!d.startContainer.getAscendant("table")){var e=
new POLARIS.dom.range(d.document);e.selectNodeContents(d.startContainer);e.setEnd(d.startContainer,d.startOffset);e=new POLARIS.dom.walker(e);e.evaluator=function(a){return POLARIS.env.chrome?a.type==POLARIS.NODE_TEXT||a.type==POLARIS.NODE_ELEMENT&&a.is("p"):a.type==POLARIS.NODE_TEXT};if(e=e.previous())0==e.getText().replace(/\u200B/g,"").length?d.moveToLeafElementEditablePosition(e,!1):d.moveToPosition(e,POLARIS.POSITION_BEFORE_END),d.select();else if(POLARIS.env.chrome){var e=c.element,f=d.startPath();
f&&f.block||e.is("p")||e.is("span")||(d.moveToLeafElementEditablePosition(e),d.select())}}c=c.element;POLARIS.env.ie&&c.is("img")&&!c.isReadOnly()?(b.cancel(),b=new POLARIS.dom.range(a.document),b.setStartBefore(c),b.setEndAfter(c),b.select()):setTimeout(function(){var b=a.getSelection(),c=a.elementPath();b&&c&&a.fire("selectionChange",{selection:b,path:a.elementPath()})},0)});this.attachListener(this,"mousemove",function(b){this.isDragging=!0;var c={element:b.data.getTarget()};b=b.data.getTarget();
(b.hasAscendant("td",!0)||b.hasAscendant("th",!0))&&a.fire("mousemove",c)});this.attachListener(this,"selectChange",function(b){b={element:b.data.getTarget()};a.fire("selectedCellChange",b)});POLARIS.env.ie&&this.attachListener(this,"click",b);this.attachListener(this,"mousedown",function(b){var c=b.data.getTarget();POLARIS.env.ie?c.is("hr","input","textarea")&&!c.isReadOnly()&&(a.getSelection().selectElement(c),c.is("input","textarea")&&b.data.preventDefault()):c.is("img","hr","input","textarea",
"select")&&!c.isReadOnly()&&(a.getSelection().selectElement(c),c.is("input","textarea","select")&&b.data.preventDefault())});POLARIS.env.gecko&&this.attachListener(this,"mouseup",function(b){if(2==b.data.$.button&&(b=b.data.getTarget(),!b.getOuterHtml().replace(m,""))){var c=a.createRange();c.moveToElementEditStart(b);c.select(!0)}});POLARIS.env.webkit&&!0!==a.config.htmlInputElementEditable&&(this.attachListener(this,"click",function(b){b.data.getTarget().is("input","select")&&1==a.config.editMode&&
b.data.preventDefault()}),this.attachListener(this,"mouseup",function(b){b.data.getTarget().is("input","textarea")&&1==a.config.editMode&&b.data.preventDefault()}))}}},_:{detach:function(){this.editor.setData(this.editor.getData(),0,1);this.clearListeners();this.restoreAttrs();var a;if(a=this.removeCustomData("classes"))for(;a.length;)this.removeClass(a.pop());if(!this.is("textarea")){a=this.getDocument();var b=a.getHead();if(b.getCustomData("stylesheet")){var c=a.getCustomData("stylesheet_ref");
--c?a.setCustomData("stylesheet_ref",c):(a.removeCustomData("stylesheet_ref"),b.removeCustomData("stylesheet").remove())}}this.editor.fire("contentDomUnload");delete this.editor}}});POLARIS.editor.prototype.editable=function(a){var b=this._.editable;if(b&&a)return 0;arguments.length&&(b=this._.editable=a?a instanceof POLARIS.editable?a:new POLARIS.editable(this,a):(b&&b.detach(),null));return b};var l=POLARIS.dom.walker.bogus(),m=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,
n=POLARIS.dom.walker.whitespaces(!0),q=POLARIS.dom.walker.bookmark(!1,!0);POLARIS.on("instanceLoaded",function(b){var c=b.editor;c.on("insertElement",function(a){a=a.data;a.type==POLARIS.NODE_ELEMENT&&(a.is("input")||a.is("textarea"))&&!0!==c.config.htmlInputElementEditable&&1!=c.config.editMode&&("false"!=a.getAttribute("contentEditable")&&a.data("polaris-editable",a.hasAttribute("contenteditable")?"true":"1"),a.setAttribute("contentEditable",!1))});c.on("selectionChange",function(b){if(!c.readOnly){var d=
c.getSelection();d&&!d.isLocked&&(d=c.checkDirty(),c.fire("lockSnapshot"),a(b),c.fire("unlockSnapshot"),d||c.resetDirty())}})});POLARIS.on("instanceCreated",function(a){var b=a.editor;b.on("mode",function(){var a=b.editable();if(a&&a.isInline()){var c=b.title;a.changeAttr("role","textbox");a.changeAttr("aria-label",c);c&&a.changeAttr("title",c);var d=b.fire("ariaEditorHelpLabel",{}).label;if(d&&(c=this.ui.space(this.elementMode==POLARIS.ELEMENT_MODE_INLINE?"top":"contents"))){var e=POLARIS.tools.getNextId(),
d=POLARIS.dom.element.createFromHtml('\x3cspan id\x3d"'+e+'" class\x3d"polaris_voice_label"\x3e'+d+"\x3c/span\x3e");c.append(d);a.changeAttr("aria-describedby",e)}}})});POLARIS.addCss(".polaris_editable{cursor:text}.polaris_editable img,.polaris_editable input,.polaris_editable textarea{cursor:default}");var v=function(){function a(b){var d=b.range,e=b.mergeCandidates,f,g,k,l,u;"text"==b.type&&d.shrink(POLARIS.SHRINK_ELEMENT,!0,!1)&&(g=POLARIS.dom.element.createFromHtml("\x3cspan\x3e\x26nbsp;\x3c/span\x3e",
d.document),d.insertNode(g),d.setStartAfter(g));k=new POLARIS.dom.elementPath(d.startContainer);b.endPath=l=new POLARIS.dom.elementPath(d.endContainer);if(!d.collapsed){f=l.block||l.blockLimit;var q=d.getCommonAncestor();f&&!f.equals(q)&&!f.contains(q)&&d.checkEndOfBlock()&&b.zombies.push(f);d.deleteContents()}for(;(u=m(d))&&h(u)&&u.isBlockBoundary()&&k.contains(u);)d.moveToPosition(u,POLARIS.POSITION_BEFORE_END);r(d,b.blockLimit,k,l);g&&(d.setEndBefore(g),d.collapse(),g.remove());g=d.startPath();
if(f=g.contains(n,!1,1))d.splitElement(f),b.inlineStylesRoot=f,b.inlineStylesPeak=g.lastElement;b=d.createBookmark();(f=b.startNode.getPrevious(c))&&h(f)&&n(f)&&e.push(f);(f=b.startNode.getNext(c))&&h(f)&&n(f)&&e.push(f);for(f=b.startNode;(f=f.getParent())&&n(f);)e.push(f);d.moveToBookmark(b)}function b(a,c){var d=a.range;if("text"==a.type&&a.inlineStylesRoot){for(var e=c,f=a.inlineStylesPeak,g=f.getDocument().createText("{polaris-peak}"),k=a.inlineStylesRoot.getParent();!f.equals(k);)g=g.appendTo(f.clone()),
f=f.getParent();c=g.getOuterHtml().split("{polaris-peak}").join(e)}c=a.editor.fire("removeFillingChar",c);e=a.blockLimit.getName();f=null;/^\s+|\s+$/.test(c)&&"span"in POLARIS.dtd[e]&&(f='\x3cspan data-polaris-marker\x3d"1"\x3e\x26nbsp;\x3c/span\x3e',c=f+c+f);c=a.editor.dataProcessor.toHtml(c,{context:null,fixForBody:!1,dontFilter:a.dontFilter,filter:a.editor.activeFilter,enterMode:a.editor.activeEnterMode});e=d.document.createElement("body");e.setHtml(c);f&&(e.getFirst().remove(),e.getLast().remove());
if((d=d.startPath().block)&&!0===d.isExistText())a:{var l;if(1==e.getChildCount()&&h(l=e.getFirst())&&l.is(J)){d=l.getElementsByTag("*");f=0;for(k=d.count();f<k;f++)if(g=d.getItem(f),!g.is(I))break a;l.moveChildren(l.getParent(1));l.remove()}}a.dataWrapper=e;return c}function d(a){var b=a.range,c=b.document,e,f=a.blockLimit,h,m,n=0,r,x=[],p,w,A=0,t=0,y,G;h=b.startContainer;var B=a.endPath.elements[0],H;m=B.getPosition(h);var J=!!B.getCommonAncestor(h)&&m!=POLARIS.POSITION_IDENTICAL&&!(m&POLARIS.POSITION_CONTAINS+
POLARIS.POSITION_IS_CONTAINED);h=k(a.dataWrapper,a);for(q(h,b);n<h.length;n++){m=h[n];if(e=m.isLineBreak){e=b;y=f;var I=void 0,aa=void 0;m.hasBlockSibling?e=1:(I=e.startContainer.getAscendant(v.$block,1))&&I.is({div:1,p:1})?(aa=I.getPosition(y),aa==POLARIS.POSITION_IDENTICAL||aa==POLARIS.POSITION_CONTAINS?e=0:(y=e.splitElement(I),e.moveToPosition(y,POLARIS.POSITION_AFTER_START),e=1)):e=0}if(e)t=0<n;else{e=b.startPath();if(e=!m.isBlock&&g(a.editor,e.block,e.blockLimit))w=a.editor,e=w=w.activeEnterMode!=
POLARIS.ENTER_BR&&!1!==w.config.autoParagraph?w.activeEnterMode==POLARIS.ENTER_DIV?"div":"p":!1;e&&(w=c.createElement(w),w.appendBogus(),b.insertNode(w),POLARIS.env.needsBrFiller&&(r=w.getBogus())&&r.remove(),b.moveToPosition(w,POLARIS.POSITION_BEFORE_END));if((e=b.startPath().block)&&!e.equals(p)&&!e.hasAscendant("article")){if(r=e.getBogus())r.remove(),x.push(e);p=e}m.firstNotAllowed&&(A=1);if(A&&m.isElement){e=b.startContainer;for(y=null;e&&!v[e.getName()][m.name];){if(e.equals(f)){e=null;break}y=
e;e=e.getParent()}if(e)y&&(G=b.splitElement(y),a.zombies.push(G),a.zombies.push(y));else{y=f.getName();H=!n;e=n==h.length-1;y=l(m.node,y);for(var I=[],aa=y.length,la=0,pa=void 0,za=0,Ja=-1;la<aa;la++)pa=y[la]," "==pa?(za||H&&!la||(I.push(new POLARIS.dom.text(" ")),Ja=I.length),za=1):(I.push(pa),za=0);e&&Ja==I.length&&I.pop();H=I}}if(H){for(;e=H.pop();)b.insertNode(e);H=0}else e=m.node,b.insertNode(e);m.lastNotAllowed&&n<h.length-1&&((G=J?B:G)&&b.setEndAt(G,POLARIS.POSITION_AFTER_START),A=0);b.endContainer.type===
POLARIS.NODE_ELEMENT&&!b.endContainer.isExistText()&&n<h.length-1&&b.setEndAt(e,POLARIS.POSITION_BEFORE_END);b.collapse()}}a.dontMoveCaret=t;a.bogusNeededBlocks=x}function e(a){for(var b=a.range,d,f,g,k=a.bogusNeededBlocks,l=b.createBookmark();d=a.zombies.pop();)d.getParent()&&(f=b.clone(),f.moveToElementEditStart(d),f.removeEmptyBlocksAtEnd());if(k)for(;d=k.pop();)POLARIS.env.needsBrFiller?d.appendBogus():d.append(b.document.createText(" "));for(;d=a.mergeCandidates.pop();)d.mergeSiblings();b.moveToBookmark(l);
if(!a.dontMoveCaret){for(d=m(b);d&&h(d)&&!d.is(v.$empty);){if(d.isBlockBoundary())b.moveToPosition(d,POLARIS.POSITION_BEFORE_END);else{if(n(d)&&d.getHtml().match(/(\s|&nbsp;)$/g)){g=null;break}g=b.clone();g.moveToPosition(d,POLARIS.POSITION_BEFORE_END)}d=d.getLast(c)}g&&b.moveToRange(g)}}function h(a){return a.type==POLARIS.NODE_ELEMENT}function k(a,b){var c,d,e,f,g=[],l=b.range.startContainer;c=b.range.startPath();for(var l=v[l.getName()],m=0,n=a.getChildren(),r=n.count(),u=-1,q=-1,w=0,p=c.contains(v.$list);m<
r;++m)c=n.getItem(m),h(c)?(e=c.getName(),p&&e in POLARIS.dtd.$list?g=g.concat(k(c,b)):l&&(f=!!l[e],"br"!=e||!c.data("polaris-eol")||m&&m!=r-1||(w=(d=m?g[m-1].node:n.getItem(m+1))&&(!h(d)||!d.is("br")),d=d&&h(d)&&v.$block[d.getName()]),-1!=u||f||(u=m),f||(q=m),g.push({isElement:1,isLineBreak:w,isBlock:c.isBlockBoundary(),hasBlockSibling:d,node:c,name:e,allowed:f}),d=w=0)):g.push({isElement:0,node:c,allowed:1});-1<u&&(g[u].firstNotAllowed=1);-1<q&&(g[q].lastNotAllowed=1);return g}function l(a,b){var c=
[],d=a.getChildren(),e=d.count(),f,g=0,k=v[b],m=!a.is(v.$inline)||a.is("br");for(m&&c.push(" ");g<e;g++)f=d.getItem(g),h(f)&&!f.is(k)?c=c.concat(l(f,b)):c.push(f);m&&c.push(" ");return c}function m(a){return h(a.startContainer)&&a.startContainer.getChild(a.startOffset-1)}function n(a){return a&&h(a)&&(a.is(v.$removeEmpty)||a.is("a")&&!a.isBlockBoundary())}function r(a,b,c,d){var e=a.clone(),f,g;e.setEndAt(b,POLARIS.POSITION_BEFORE_END);(f=(new POLARIS.dom.walker(e)).next())&&h(f)&&H[f.getName()]&&
(g=f.getPrevious())&&h(g)&&!g.getParent().equals(a.startContainer)&&c.contains(g)&&d.contains(f)&&f.isIdentical(g)&&(f.moveChildren(g),f.remove(),r(a,b,c,d))}function q(a,b){function c(a,b){if(!(a&&a.hasAscendant("article")&&b&&"table"==b.name)&&b.isBlock&&b.isElement&&!b.node.is("br")&&h(a)&&a.is("br"))return a.remove(),1}var d=b.endContainer.getChild(b.endOffset),e=b.endContainer.getChild(b.endOffset-1);d&&c(d,a[a.length-1]);e&&c(e,a[0])&&(b.setEnd(b.endContainer,b.endOffset-1),b.collapse())}var v=
POLARIS.dtd,H={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},J={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},I=POLARIS.tools.extend({},v.$inline);delete I.br;return function(c,g,h){var k=c.editor,l=k.getSelection(),m=l.getRanges()[0],n=!1;"unfiltered_html"==g&&(g="html",n=!0);(l=l.getStartElement())&&(l.hasAttribute("doc-data-field")||(l=l.getAscendant(function(a){return a.hasAttribute&&a.hasAttribute("doc-data-field")})));!m||!l&&m.checkReadOnly()||(l=new POLARIS.dom.elementPath(m.startContainer,
m.root),g={type:g,dontFilter:n,editable:c,editor:k,range:m,blockLimit:l.blockLimit||m.root,mergeCandidates:[],zombies:[]},a(g),n=!1,m.checkEndOfBlock()&&-1<h.lastIndexOf("\x3cbr\x3e")&&(h=h.replace(/<br>$/,""),n=!0),h&&b(g,h)&&(d(g),n&&(h=POLARIS.tools.createEmptyParagraph(k),h.setHtml("\x3cbr\x3e"),h.insertAfter(l.block))),e(g),m.select(),f(c))}}(),r=function(){function a(b){b=new POLARIS.dom.walker(b);b.guard=function(a,b){if(b)return!1;if(a.type==POLARIS.NODE_ELEMENT)return a.is(POLARIS.dtd.$tableContent)};
b.evaluator=function(a){return a.type==POLARIS.NODE_ELEMENT};return b}function b(a,c,d){c=a.getDocument().createElement(c);a.append(c,d);return c}function c(a){var b=a.count(),d;for(b;0<b--;)d=a.getItem(b),POLARIS.tools.trim(d.getHtml())||(d.appendBogus(),POLARIS.env.ie&&9>POLARIS.env.version&&d.getChildCount()&&d.getFirst().remove())}return function(d){var e=d.startContainer,f=e.getAscendant("table",1),g=!1;c(f.getElementsByTag("td"));c(f.getElementsByTag("th"));f=d.clone();f.setStart(e,0);f=a(f).lastBackward();
f||(f=d.clone(),f.setEndAt(e,POLARIS.POSITION_BEFORE_END),f=a(f).lastForward(),g=!0);f||(f=e);f.is("table")?(d.setStartAt(f,POLARIS.POSITION_BEFORE_START),d.collapse(!0),f.remove()):(f.is({tbody:1,thead:1,tfoot:1})&&(f=b(f,"tr",g)),f.is("tr")&&(f=b(f,f.getParent().is("thead")?"th":"td",g)),(e=f.getBogus())&&e.remove(),d.moveToPosition(f,g?POLARIS.POSITION_AFTER_START:POLARIS.POSITION_BEFORE_END))}}()})();(function(){function a(){var a=this._.fakeSelection,b;a&&(b=this.getSelection(1),b&&b.isHidden()||
(a.reset(),a=0));if(!a&&(a=b||this.getSelection(1),!a||a.getType()==POLARIS.SELECTION_NONE))return;this.fire("selectionCheck",a);(b=this.elementPath())&&!b.compare(this._.selectionPreviousPath)&&(POLARIS.env.webkit&&(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=b,this.fire("selectionChange",{selection:a,path:b}))}function e(){q=!0;n||(b.call(this),n=POLARIS.tools.setTimeout(b,200,this))}function b(){n=null;q&&(POLARIS.tools.setTimeout(a,0,this),q=!1)}function c(a){return v(a)||
a.type==POLARIS.NODE_ELEMENT&&!a.is(POLARIS.dtd.$empty)?!0:!1}function d(a){function b(c,d){return c&&c.type!=POLARIS.NODE_TEXT?a.clone()["moveToElementEdit"+(d?"End":"Start")](c):!1}if(!(a.root instanceof POLARIS.editable||a.root.isEditable()))return!1;var d=a.startContainer,e=a.getPreviousNode(c,null,d),f=a.getNextNode(c,null,d);return b(e)||b(f,1)||!(e||f||d.type==POLARIS.NODE_ELEMENT&&d.isBlockBoundary()&&d.getBogus())?!0:!1}function h(a){g(a,!1);var b=a.getDocument().createText(A);a.setCustomData("polaris-fillingChar",
b);return b}function g(a,b){var c=a&&a.removeCustomData("polaris-fillingChar");if(c&&0!=c.$.length){if(!1!==b){var d=a.getDocument().getSelection().getNative(),e=d&&a.getDocument().getSelection().getType()!=POLARIS.SELECTION_NONE&&d.getRangeAt(0),f=A.length,g=!1;POLARIS.env.webkit?g=e&&e.intersectsNode(c.$):POLARIS.env.ie&&(g=e&&e.collapsed&&e.startContainer==c.$);if(c.getLength()>f&&g){var h=[{node:d.anchorNode,offset:d.anchorOffset},{node:d.focusNode,offset:d.focusOffset}];d.anchorNode==c.$&&d.anchorOffset>
f&&(h[0].offset-=f);d.focusNode==c.$&&d.focusOffset>f&&(h[1].offset-=f)}}c.setText(k(c.getText(),1));h&&(c=a.getDocument().$,d=c.getSelection(),c=c.createRange(),c.setStart(h[0].node,h[0].offset),c.collapse(!0),d.removeAllRanges(),d.addRange(c),POLARIS.env.webkit&&d.extend(h[1].node,h[1].offset))}}function k(a,b){return b?a.replace(x,function(a,b){return b?" ":""}):a=a.replace(/\u200b{7}/g,"")}function f(a){var b=POLARIS.dom.element.createFromHtml('\x3cdiv data-polaris-hidden-sel\x3d"1" data-polaris-temp\x3d"1" style\x3d"'+
(POLARIS.env.ie?"display:none":"position:fixed;top:0;left:-1000px")+'"\x3e\x26nbsp;\x3c/div\x3e',a.document);a.fire("lockSnapshot");a.editable().append(b);var c=a.getSelection(1),d=a.createRange(),e=c.root.on("selectionchange",function(a){a.cancel()},null,null,0);d.setStartAt(b,POLARIS.POSITION_AFTER_START);d.setEndAt(b,POLARIS.POSITION_BEFORE_END);c.selectRanges([d]);e.removeListener();a.fire("unlockSnapshot");a._.hiddenSelectionContainer=b}function l(a){var b={37:1,39:1,8:1,46:1};a.config.wordprocessor&&
(b={});return function(c){var d=c.data.getKeystroke();if(b[d]){var e=a.getSelection().getRanges(),f=e[0];1==e.length&&f.collapsed&&(d=f[38>d?"getPreviousEditableNode":"getNextEditableNode"]())&&d.type==POLARIS.NODE_ELEMENT&&"false"==d.getAttribute("contenteditable")&&(a.getSelection().fake(d),c.data.preventDefault(),c.cancel())}}}function m(a){for(var b=0;b<a.length;b++){var c=a[b];c.getCommonAncestor().isReadOnly()&&a.splice(b,1);if(!c.collapsed){if(c.startContainer.isReadOnly())for(var d=c.startContainer,
e;d&&!((e=d.type==POLARIS.NODE_ELEMENT)&&d.is("body")||!d.isReadOnly());)e&&"false"==d.getAttribute("contentEditable")&&c.setStartAfter(d),d=d.getParent();d=c.startContainer;e=c.endContainer;var f=c.startOffset,g=c.endOffset,h=c.clone();d&&d.type==POLARIS.NODE_TEXT&&(f>=d.getLength()?h.setStartAfter(d):h.setStartBefore(d));e&&e.type==POLARIS.NODE_TEXT&&(g?h.setEndAfter(e):h.setEndBefore(e));d=new POLARIS.dom.walker(h);d.evaluator=function(d){if(d.type==POLARIS.NODE_ELEMENT&&d.isReadOnly()){var e=
c.clone();c.setEndBefore(d);c.collapsed&&a.splice(b--,1);d.getPosition(h.endContainer)&POLARIS.POSITION_CONTAINS||(e.setStartAfter(d),e.collapsed||a.splice(b+1,0,e));return!0}return!1};d.next()}}return a}var n,q,v=POLARIS.dom.walker.invisible(1),r=function(){function a(b){return function(a){var c=a.editor.createRange();c.moveToClosestEditablePosition(a.selected,b)&&a.editor.getSelection().selectRanges([c]);return!1}}function b(a){return function(b){var c=b.editor,d=c.createRange(),e;(e=d.moveToClosestEditablePosition(b.selected,
a))||(e=d.moveToClosestEditablePosition(b.selected,!a));e&&c.getSelection().selectRanges([d]);c.fire("saveSnapshot");b.selected.remove();e||(d.moveToElementEditablePosition(c.editable()),c.getSelection().selectRanges([d]));c.fire("saveSnapshot");return!1}}var c=a(),d=a(1);return{37:c,38:c,39:d,40:d,8:b(),46:b(1)}}();POLARIS.on("instanceCreated",function(b){function c(){var a=d.getSelection();a&&a.removeAllRanges()}var d=b.editor;d.on("contentDom",function(){function b(){q=new POLARIS.dom.selection(d.getSelection());
q.lock()}function c(){h.removeListener("mouseup",c);n.removeListener("mouseup",c);var a=POLARIS.document.$.selection,b=a.createRange();"None"!=a.type&&b.parentElement().ownerDocument==f.$&&b.select()}var f=d.document,h=POLARIS.document,k=d.editable(),m=f.getBody(),n=f.getDocumentElement(),r=k.isInline(),z,q;POLARIS.env.gecko&&k.attachListener(k,"focus",function(a){a.removeListener();0!==z&&(a=d.getSelection().getNative())&&a.isCollapsed&&a.anchorNode==k.$&&(a=d.createRange(),a.moveToElementEditStart(k),
a.select())},null,null,-2);k.attachListener(k,POLARIS.env.webkit?"DOMFocusIn":"focus",function(){z&&POLARIS.env.webkit&&(z=d._.previousActive&&d._.previousActive.equals(f.getActive()));d.unlockSelection(z);z=0},null,null,-1);k.attachListener(k,"mousedown",function(){z=0});if(POLARIS.env.ie||r)p?k.attachListener(k,"beforedeactivate",b,null,null,-1):k.attachListener(d,"selectionCheck",b,null,null,-1),k.attachListener(k,POLARIS.env.webkit?"DOMFocusOut":"blur",function(){if(POLARIS.env.ie){var a=k.isComposing,
b=q.getRanges()[0];a&&b&&(b.setStart(b.startContainer,b.startOffset+1),b.collapse(!0))}k.isComposing=!1;d.lockSelection(q);z=1},null,null,-1),k.attachListener(k,"mousedown",function(){z=0});if(POLARIS.env.ie&&!r){var u;k.attachListener(k,"mousedown",function(a){2==a.data.$.button&&((a=d.document.getSelection())&&a.getType()!=POLARIS.SELECTION_NONE||(u=d.window.getScrollPosition()))});k.attachListener(k,"mouseup",function(a){2==a.data.$.button&&u&&(d.document.$.documentElement.scrollLeft=u.x,d.document.$.documentElement.scrollTop=
u.y);u=null});if("BackCompat"!=f.$.compatMode){if(POLARIS.env.ie7Compat||POLARIS.env.ie6Compat)n.on("mousedown",function(a){function b(a){a=a.data.$;if(d){var c=m.$.createTextRange();try{c.moveToPoint(a.clientX,a.clientY)}catch(e){}d.setEndPoint(0>f.compareEndPoints("StartToStart",c)?"EndToEnd":"StartToStart",c);d.select()}}function c(){n.removeListener("mousemove",b);h.removeListener("mouseup",c);n.removeListener("mouseup",c);d.select()}a=a.data;if(a.getTarget().is("html")&&a.$.y<n.$.clientHeight&&
a.$.x<n.$.clientWidth){var d=m.$.createTextRange();try{d.moveToPoint(a.$.clientX,a.$.clientY)}catch(e){}var f=d.duplicate();n.on("mousemove",b);h.on("mouseup",c);n.on("mouseup",c)}});if(7<POLARIS.env.version&&11>POLARIS.env.version)n.on("mousedown",function(a){a.data.getTarget().is("html")&&(h.on("mouseup",c),n.on("mouseup",c))})}}k.attachListener(k,"selectionchange",a,d);k.attachListener(k,"keyup",e,d);k.attachListener(k,POLARIS.env.webkit?"DOMFocusIn":"focus",function(){d.forceNextSelectionCheck();
d.selectionChange(1)});if(r&&(POLARIS.env.webkit||POLARIS.env.gecko)){var w;k.attachListener(k,"mousedown",function(){w=1});k.attachListener(f.getDocumentElement(),"mouseup",function(){w&&e.call(d);w=0})}else k.attachListener(POLARIS.env.ie?k:f.getDocumentElement(),"mouseup",e,d);(POLARIS.env.webkit||POLARIS.env.ie)&&k.attachListener(f,"keydown",function(a){switch(a.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:case 38:case 40:g(k)}},null,null,-1);k.attachListener(k,
"keydown",l(d),null,null,-1)});d.on("setData",function(){d.unlockSelection();POLARIS.env.webkit&&c()});d.on("contentDomUnload",function(){d.unlockSelection()});if(POLARIS.env.ie9Compat)d.on("beforeDestroy",c,null,null,9);d.on("dataReady",function(){delete d._.fakeSelection;delete d._.hiddenSelectionContainer;d.selectionChange(1)});d.on("loadSnapshot",function(){var a=POLARIS.dom.walker.nodeType(POLARIS.NODE_ELEMENT),b=d.editable().getLast(a);b&&b.hasAttribute("data-polaris-hidden-sel")&&(b.remove(),
POLARIS.env.gecko&&(a=d.editable().getFirst(a))&&a.is("br")&&a.getAttribute("_moz_editor_bogus_node")&&a.remove())},null,null,100);d.on("key",function(a){if("wysiwyg"==d.mode){var b=d.getSelection();if(b.isFake){var c=r[a.data.keyCode];if(c)return c({editor:d,selected:b.getSelectedElement(),selection:b,keyEvent:a})}}})});POLARIS.on("instanceReady",function(a){var b=a.editor;if(POLARIS.env.webkit||POLARIS.env.ie)b.on("selectionChange",function(){var a=b.editable(),c=a.getCustomData("polaris-fillingChar");
c&&(c.getCustomData("ready")?g(a):c.setCustomData("ready",1))},null,null,-1),b.on("beforeSetMode",function(){g(b.editable())},null,null,-1),b.on("getSnapshot",function(a){a.data&&(a.data=k(a.data))},b,null,20),b.on("toDataFormat",function(a){a.data.dataValue=k(a.data.dataValue)},null,null,0),b.on("removeFillingChar",function(a){a.data&&(a.data=k(a.data))},b,null,20)});POLARIS.editor.prototype.selectionChange=function(b){(b?a:e).call(this)};POLARIS.editor.prototype.getSelection=function(a){return!this._.savedSelection&&
!this._.fakeSelection||a?(a=this.editable())&&"wysiwyg"==this.mode?new POLARIS.dom.selection(a):null:this._.savedSelection||this._.fakeSelection};POLARIS.editor.prototype.lockSelection=function(a){return(a=a||this.getSelection(1))&&a.getType()!=POLARIS.SELECTION_NONE?(!a.isLocked&&a.lock(),this._.savedSelection=a,!0):!1};POLARIS.editor.prototype.unlockSelection=function(a){var b=this._.savedSelection;return b?(b.unlock(a),delete this._.savedSelection,!0):!1};POLARIS.editor.prototype.forceNextSelectionCheck=
function(){delete this._.selectionPreviousPath};POLARIS.dom.document.prototype.getSelection=function(){return new POLARIS.dom.selection(this)};POLARIS.dom.range.prototype.select=function(){var a=this.root instanceof POLARIS.editable?this.root.editor.getSelection():new POLARIS.dom.selection(this.root);a.selectRanges([this]);return a};POLARIS.SELECTION_NONE=1;POLARIS.SELECTION_TEXT=2;POLARIS.SELECTION_ELEMENT=3;var p="function"!=typeof window.getSelection,t=1;POLARIS.dom.selection=function(a){if(a instanceof
POLARIS.dom.selection){var b=a;a=a.root}var c=a instanceof POLARIS.dom.element;this.rev=b?b.rev:t++;this.document=a instanceof POLARIS.dom.document?a:a.getDocument();this.root=c?a:this.document.getBody();this.isLocked=0;this._={cache:{}};if(b)return POLARIS.tools.extend(this._.cache,b._.cache),this.isFake=b.isFake,this.isLocked=b.isLocked,this;a=this.getNative();var d,e;if(a)if(a.getRangeAt)d=(e=a.rangeCount&&a.getRangeAt(0))&&new POLARIS.dom.node(e.commonAncestorContainer);else{try{e=a.createRange()}catch(f){}d=
e&&POLARIS.dom.element.get(e.item&&e.item(0)||e.parentElement())}if(!d||d.type!=POLARIS.NODE_ELEMENT&&d.type!=POLARIS.NODE_TEXT||!this.root.equals(d)&&!this.root.contains(d))this._.cache.type=POLARIS.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new POLARIS.dom.rangeList;return this};var w={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,
tfoot:1},A=POLARIS.tools.repeat("​",7),x=new RegExp(A+"( )?","g");POLARIS.tools.extend(POLARIS.dom.selection,{_removeFillingCharSequenceString:k,_createFillingCharSequenceNode:h,_removeFillingCharSequenceNode:g,FILLING_CHAR_SEQUENCE:A});POLARIS.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=p?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:p?function(){var a=this._.cache;if(a.type)return a.type;
var b=POLARIS.SELECTION_NONE;try{var c=this.getNative(),d=c.type;"Text"==d&&(b=POLARIS.SELECTION_TEXT);"Control"==d&&(b=POLARIS.SELECTION_ELEMENT);c.createRange().parentElement()&&(b=POLARIS.SELECTION_TEXT)}catch(e){}return a.type=b}:function(){var a=this._.cache;if(a.type)return a.type;var b=POLARIS.SELECTION_TEXT,c=this.getNative();if(!c||!c.rangeCount)b=POLARIS.SELECTION_NONE;else if(1==c.rangeCount){var c=c.getRangeAt(0),d=c.startContainer;d==c.endContainer&&1==d.nodeType&&1==c.endOffset-c.startOffset&&
w[d.childNodes[c.startOffset].nodeName.toLowerCase()]&&(b=POLARIS.SELECTION_ELEMENT)}return a.type=b},getRanges:function(){var a=p?function(){function a(b){return(new POLARIS.dom.node(b)).getIndex()}var b=function(b,c){b=b.duplicate();b.collapse(c);var d=b.parentElement();if(!d.hasChildNodes())return{container:d,offset:0};for(var e=d.children,f,g,h=b.duplicate(),k=0,l=e.length-1,m=-1,n,r;k<=l;)if(m=Math.floor((k+l)/2),f=e[m],h.moveToElementText(f),n=h.compareEndPoints("StartToStart",b),0<n)l=m-1;
else if(0>n)k=m+1;else return{container:d,offset:a(f)};if(-1==m||m==e.length-1&&0>n){h.moveToElementText(d);h.setEndPoint("StartToStart",b);h=h.text.replace(/(\r\n|\r)/g,"\n").length;e=d.childNodes;if(!h)return f=e[e.length-1],f.nodeType!=POLARIS.NODE_TEXT?{container:d,offset:e.length}:{container:f,offset:f.nodeValue.length};for(d=e.length;0<h&&0<d;)g=e[--d],g.nodeType==POLARIS.NODE_TEXT&&(r=g,h-=g.nodeValue.length);return{container:r,offset:-h}}h.collapse(0<n?!0:!1);h.setEndPoint(0<n?"StartToStart":
"EndToStart",b);h=h.text.replace(/(\r\n|\r)/g,"\n").length;if(!h)return{container:d,offset:a(f)+(0<n?0:1)};for(;0<h;)try{g=f[0<n?"previousSibling":"nextSibling"],g.nodeType==POLARIS.NODE_TEXT&&(h-=g.nodeValue.length,r=g),f=g}catch(q){return{container:d,offset:a(f)}}return{container:r,offset:0<n?-h:r.nodeValue.length+h}};return function(){var a=this.getNative(),c=a&&a.createRange(),d=this.getType();if(!a)return[];if(d==POLARIS.SELECTION_TEXT)return a=new POLARIS.dom.range(this.root),d=b(c,!0),a.setStart(new POLARIS.dom.node(d.container),
d.offset),d=b(c),a.setEnd(new POLARIS.dom.node(d.container),d.offset),a.endContainer.getPosition(a.startContainer)&POLARIS.POSITION_PRECEDING&&a.endOffset<=a.startContainer.getIndex()&&a.collapse(),[a];if(d==POLARIS.SELECTION_ELEMENT){for(var d=[],e=0;e<c.length;e++){for(var f=c.item(e),g=f.parentNode,h=0,a=new POLARIS.dom.range(this.root);h<g.childNodes.length&&g.childNodes[h]!=f;h++);a.setStart(new POLARIS.dom.node(g),h);a.setEnd(new POLARIS.dom.node(g),h+1);d.push(a)}return d}return[]}}():function(){var a=
[],b,c=this.getNative();if(!c)return a;for(var d=0;d<c.rangeCount;d++){var e=c.getRangeAt(d);b=new POLARIS.dom.range(this.root);b.setStart(new POLARIS.dom.node(e.startContainer),e.startOffset);b.setEnd(new POLARIS.dom.node(e.endContainer),e.endOffset);a.push(b)}return a};return function(b){var c=this._.cache,d=c.ranges;d||(c.ranges=d=new POLARIS.dom.rangeList(a.call(this)));return b?m(new POLARIS.dom.rangeList(d.slice())):d}}(),getStartElement:function(){var a=this._.cache;if(void 0!==a.startElement)return a.startElement;
var b;switch(this.getType()){case POLARIS.SELECTION_ELEMENT:return this.getSelectedElement();case POLARIS.SELECTION_TEXT:var c=this.getRanges()[0];if(c){if(c.collapsed)b=c.startContainer,b.type!=POLARIS.NODE_ELEMENT&&(b=b.getParent());else{for(c.optimize();b=c.startContainer,c.startOffset==(b.getChildCount?b.getChildCount():b.getLength())&&!b.isBlockBoundary();)c.setStartAfter(b);b=c.startContainer;if(b.type!=POLARIS.NODE_ELEMENT)return b.getParent();if((b=b.getChild(c.startOffset))&&b.type==POLARIS.NODE_ELEMENT)for(c=
b.getFirst();c&&c.type==POLARIS.NODE_ELEMENT;)b=c,c=c.getFirst();else b=c.startContainer}b=b.$}}return a.startElement=b?new POLARIS.dom.element(b):null},getSelectedElement:function(){var a=this._.cache;if(void 0!==a.selectedElement)return a.selectedElement;var b=this,c=POLARIS.tools.tryThese(function(){return b.getNative().createRange().item(0)},function(){for(var a=b.getRanges()[0].clone(),c,d,e=2;e&&!((c=a.getEnclosedNode())&&c.type==POLARIS.NODE_ELEMENT&&w[c.getName()]&&(d=c));e--)a.shrink(POLARIS.SHRINK_ELEMENT);
return d&&d.$});return a.selectedElement=c?new POLARIS.dom.element(c):null},getSelectedText:function(){var a=this._.cache;if(void 0!==a.selectedText)return a.selectedText;var b=this.getNative(),b=p?"Control"==b.type?"":b.createRange().text:b.toString();return a.selectedText=b},lock:function(){this.getRanges();this.getStartElement();this.getSelectedElement();this.getSelectedText();this._.cache.nativeSel=null;this.isLocked=1},unlock:function(a){if(this.isLocked){if(a)var b=this.getSelectedElement(),
c=!b&&this.getRanges(),d=this.isFake;this.isLocked=0;this.reset();a&&(a=b||c[0]&&c[0].getCommonAncestor())&&a.getAscendant("body",1)&&(d?this.fake(b):b?this.selectElement(b):this.selectRanges(c))}},reset:function(){this._.cache={};this.isFake=0;var a=this.root.editor;if(a&&a._.fakeSelection&&this.rev==a._.fakeSelection.rev){delete a._.fakeSelection;var b=a._.hiddenSelectionContainer;if(b){var c=a.checkDirty();a.fire("lockSnapshot");b.remove();a.fire("unlockSnapshot");!c&&a.resetDirty()}delete a._.hiddenSelectionContainer}this.rev=
t++},selectElement:function(a){var b=new POLARIS.dom.range(this.root);b.setStartBefore(a);b.setEndAfter(a);this.selectRanges([b])},selectRanges:function(a){var b=this.root.editor,c=b&&b._.hiddenSelectionContainer;this.reset();if(c)for(var c=this.root,e,f=0;f<a.length;++f)e=a[f],e.endContainer.equals(c)&&(e.endOffset=Math.min(e.endOffset,c.getChildCount()));if(a.length)if(this.isLocked){var k=POLARIS.document.getActive();this.unlock();this.selectRanges(a);this.lock();k&&!k.equals(this.root)&&k.focus()}else{var l;
a:{var m,n;if(1==a.length&&!(n=a[0]).collapsed&&(l=n.getEnclosedNode())&&l.type==POLARIS.NODE_ELEMENT&&(n=n.clone(),n.shrink(POLARIS.SHRINK_ELEMENT,!0),(m=n.getEnclosedNode())&&m.type==POLARIS.NODE_ELEMENT&&(l=m),"false"==l.getAttribute("contenteditable")))break a;l=void 0}if(l&&b)this.fake(l);else{if(p){m=POLARIS.dom.walker.whitespaces(!0);l=/\ufeff|\u00a0/;n={table:1,tbody:1,tr:1};1<a.length&&(b=a[a.length-1],a[0].setEnd(b.endContainer,b.endOffset));b=a[0];a=b.collapsed;var r,q,z;if((c=b.getEnclosedNode())&&
c.type==POLARIS.NODE_ELEMENT&&c.getName()in w&&(!c.is("a")||!c.getText()))try{z=c.$.createControlRange();z.addElement(c.$);z.select();return}catch(D){}if(b.startContainer.type==POLARIS.NODE_ELEMENT&&b.startContainer.getName()in n||b.endContainer.type==POLARIS.NODE_ELEMENT&&b.endContainer.getName()in n)b.shrink(POLARIS.NODE_ELEMENT,!0),a=b.collapsed;z=b.createBookmark();n=z.startNode;a||(k=z.endNode);z=b.document.$.body.createTextRange();z.moveToElementText(n.$);z.moveStart("character",1);k?(l=b.document.$.body.createTextRange(),
l.moveToElementText(k.$),z.setEndPoint("EndToEnd",l),z.moveEnd("character",-1)):(r=n.getNext(m),q=n.hasAscendant("pre"),r=!(r&&r.getText&&r.getText().match(l))&&(q||!n.hasPrevious()||n.getPrevious().is&&n.getPrevious().is("br")),q=b.document.createElement("span"),q.setHtml("\x26#65279;"),q.insertBefore(n),r&&b.document.createText("﻿").insertBefore(n));b.setStartBefore(n);n.remove();a?(r?(z.moveStart("character",-1),z.select(),b.document.$.selection.clear()):z.select(),b.moveToPosition(q,POLARIS.POSITION_BEFORE_START),
q.remove()):(b.setEndBefore(k),k.remove(),z.select())}else{k=this.getNative();if(!k)return;this.removeAllRanges();for(z=0;z<a.length;z++){if(z<a.length-1&&(r=a[z],q=a[z+1],l=r.clone(),l.setStart(r.endContainer,r.endOffset),l.setEnd(q.startContainer,q.startOffset),!l.collapsed&&(l.shrink(POLARIS.NODE_ELEMENT,!0),b=l.getCommonAncestor(),l=l.getEnclosedNode(),b.isReadOnly()||l&&l.isReadOnly()))){q.setStart(r.startContainer,r.startOffset);a.splice(z--,1);continue}b=a[z];q=this.document.$.createRange();
b.collapsed&&(POLARIS.env.webkit||POLARIS.env.ie)&&d(b)&&(l=h(b.document.getBody()),b.insertNode(l),(r=l.getNext())&&!l.getPrevious()&&r.type==POLARIS.NODE_ELEMENT&&"br"==r.getName()?(g(b.document.getBody()),b.moveToPosition(r,POLARIS.POSITION_BEFORE_START)):b.moveToPosition(l,POLARIS.POSITION_AFTER_END));try{q.setStart(b.startContainer.$,b.startOffset)}catch(x){q.setStart(b.startContainer.$,0)}try{q.setEnd(b.endContainer.$,b.endOffset)}catch(A){try{if(0<=A.toString().indexOf("NS_ERROR_ILLEGAL_VALUE"))b.collapse(1),
q.setEnd(b.endContainer.$,b.endOffset);else throw A;}catch(t){q.setEnd(b.endContainer.$,0)}}try{k.addRange&&(k.addRange(q),!0===POLARIS.env.ie&&k.addRange(q))}catch(v){POLARIS.log.core("sel.addRange"+v)}}}this.reset();this.root.fire("selectionchange")}}},fake:function(a){var b=this.root.editor;this.reset();f(b);var c=this._.cache,d=new POLARIS.dom.range(this.root);d.setStartBefore(a);d.setEndAfter(a);c.ranges=new POLARIS.dom.rangeList(d);c.selectedElement=c.startElement=a;c.type=POLARIS.SELECTION_ELEMENT;
c.selectedText=c.nativeSel=null;this.isFake=1;this.rev=t++;b._.fakeSelection=this;this.root.fire("selectionchange")},isHidden:function(){var a=this.getCommonAncestor();a&&a.type==POLARIS.NODE_TEXT&&(a=a.getParent());return!(!a||!a.data("polaris-hidden-sel"))},createBookmarks:function(a){a=this.getRanges().createBookmarks(a);this.isFake&&(a.isFake=1);return a},createBookmarks2:function(a){a=this.getRanges().createBookmarks2(a);this.isFake&&(a.isFake=1);return a},selectBookmarks:function(a){for(var b=
[],c=0;c<a.length;c++){var d=new POLARIS.dom.range(this.root);d.moveToBookmark(a[c]);b.push(d)}a.isFake?this.fake(b[0].getEnclosedNode()):this.selectRanges(b);return this},getCommonAncestor:function(){var a=this.getRanges();return a.length?a[0].startContainer.getCommonAncestor(a[a.length-1].endContainer):null},scrollIntoView:function(){this.type!=POLARIS.SELECTION_NONE&&this.getRanges()[0]&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=POLARIS.SELECTION_NONE){var a=
this.getNative();try{a&&a[p?"empty":"removeAllRanges"]()}catch(b){}this.reset()}}}})();"use strict";POLARIS.STYLE_BLOCK=1;POLARIS.STYLE_INLINE=2;POLARIS.STYLE_OBJECT=3;(function(){function a(a,b){for(var c,d;(a=a.getParent())&&!a.equals(b);)if(a.getAttribute("data-nostyle"))c=a;else if(!d){var e=a.getAttribute("contentEditable");"false"==e?c=a:"true"==e&&(d=1)}return c}function e(a,b,c,d){return(a.getPosition(b)|d)==d&&(!c.childRule||c.childRule(a))}function b(a,b){function c(a){if(!a)return null;
if(a.type===POLARIS.NODE_ELEMENT&&a.is("li"))return a;for(;a=a.getParent();)if(a){if(a.type===POLARIS.NODE_ELEMENT&&a.is("li"))return a;for(var b in POLARIS.dtd.$blockLimit)if(a.is(b))return null}else return null}function d(a){for(var b=0;a;a=a.getPrevious())b+=1;return b}a=c(a);b=c(b);if(a&&b){if(d(a)>d(b)){var e=a;a=b;b=e}for(;a;){POLARIS.plugins.list.applyStyles(a);if(a.equals(b))break;a=a.getNext()}}}function c(d){POLARIS.plugins.inputmethod.cleanZWSPInRangeBoundary(d,{isRemoveEmptyNode:!1,isExistTextCheck:!1});
var f=!0,g=d.document;if(d.collapsed)f=A(this,g),f.append(g.createText("​")),d.insertNode(f),d.moveToPosition(f,POLARIS.POSITION_BEFORE_END);else{var k=this.element,l=this._.definition,m,n=l.ignoreReadonly,r=n||l.includeReadonly;null==r&&(r=d.root.getCustomData("polaris_includeReadonly"));var q=POLARIS.dtd[k];q||(m=!0,q=POLARIS.dtd.span);d.enlarge(POLARIS.ENLARGE_INLINE,1);d.trim();var D=d.createBookmark(),w=D.startNode,x=D.endNode,v=w,t;if(!n){var u=d.getCommonAncestor(),n=a(w,u),u=a(x,u);n&&(v=
n.getNextSourceNode(!0));u&&(x=u)}v.getPosition(x)==POLARIS.POSITION_FOLLOWING&&(v=0);(n=w.getNextSourceNode(!0))&&z(n)&&w.insertAfter(n);for((n=x.getNextSourceNode(!0))&&z(n)&&x.insertBefore(n);v;){n=!1;if(v.equals(x))v=null,n=!0;else{var y=v.type==POLARIS.NODE_ELEMENT?v.getName():null,u=y&&"false"==v.getAttribute("contentEditable"),C=y&&v.getAttribute("data-nostyle");if(y&&v.data("polaris-bookmark")){v=v.getNextSourceNode(!0);continue}if(z(v)){var F=v.getParent();if(F&&0<F.$.innerText.replace(/\n$/g,
"").length){v=v.getNextSourceNode(!0);continue}else F=d.document.createText("​"),F.replace(v),v=F}if(u&&r&&POLARIS.dtd.$block[y])for(var G=v,F=h(G),E=void 0,H=F.length,J=0,G=H&&new POLARIS.dom.range(G.getDocument());J<H;++J){var E=F[J],B=POLARIS.filter.instances[E.data("polaris-filter")];if(B?B.check(this):1)G.selectNodeContents(E),c.call(this,G)}F=y?!q[y]||C?0:u&&!r?0:e(v,x,l,O):1;if(F)if(E=v.getParent(),F=l,H=k,J=m,!E||!(E.getDtd()||POLARIS.dtd.span)[H]&&!J||F.parentRule&&!F.parentRule(E))n=!0;
else{if(t||y&&POLARIS.dtd.$removeEmpty[y]&&(v.getPosition(x)|O)!=O||(t=d.clone(),t.setStartBefore(v)),y=v.type,y==POLARIS.NODE_TEXT||u||y==POLARIS.NODE_ELEMENT&&!v.getChildCount()){for(var y=v,I;(n=!y.getNext(L))&&(I=y.getParent(),q[I.getName()])&&e(I,w,l,P);)y=I;t.setEndAfter(y)}}else n=!0;v=v.getNextSourceNode(C||u)}if(n&&t&&!t.collapsed){for(var n=A(this,g),u=n.hasAttributes(),F=t.getCommonAncestor(),C={},y={},E={},H={},W,sa,ha;n&&F;){if(F.getName()==k){for(W in l.attributes)!H[W]&&(ha=F.getAttribute(sa))&&
(n.getAttribute(W)==ha?y[W]=1:H[W]=1);for(sa in l.styles)!E[sa]&&(ha=F.getStyle(sa))&&(n.getStyle(sa)==ha?C[sa]=1:E[sa]=1)}F=F.getParent()}for(W in y)n.removeAttribute(W);for(sa in C)n.removeStyle(sa);u&&!n.hasAttributes()&&(n=null);n?(t.extractContents().appendTo(n),t.insertNode(n),p.call(this,n),n.mergeSiblings(),POLARIS.env.ie||n.$.normalize(),"a"==l.element&&l.attributes.id==l.attributes.name&&(f=!1)):(n=new POLARIS.dom.element("span"),t.extractContents().appendTo(n),t.insertNode(n),p.call(this,
n),n.remove(!0));t=null;if(0==f)break}}d.moveToBookmark(D);d.shrink(POLARIS.SHRINK_TEXT);d.shrink(POLARIS.NODE_ELEMENT,!0);b(d.startContainer,d.endContainer)}}function d(a){function c(){for(var a=new POLARIS.dom.elementPath(e.getParent()),b=new POLARIS.dom.elementPath(f.getParent()),d=null,h=null,k=0;k<a.elements.length;k++){var l=a.elements[k];if(l==a.block||l==a.blockLimit)break;g.checkElementRemovable(l,!0)&&(d=l)}for(k=0;k<b.elements.length;k++){l=b.elements[k];if(l==b.block||l==b.blockLimit)break;
g.checkElementRemovable(l,!0)&&(h=l)}h&&f.breakParent(h);d&&e.breakParent(d)}POLARIS.plugins.inputmethod.cleanZWSPInRangeBoundary(a,{isRemoveEmptyNode:!0,isExistTextCheck:!0});a.enlarge(POLARIS.ENLARGE_INLINE,1);var d=a.createBookmark(),e=d.startNode,f=d.endNode,g=this;if(a.collapsed){for(var h=new POLARIS.dom.elementPath(e.getParent(),a.root),k,l=0,m;l<h.elements.length&&(m=h.elements[l])&&m!=h.block&&m!=h.blockLimit;l++)if(this.checkElementRemovable(m)){var n,q;(n=(q=a.checkBoundaryOfElement(m,
POLARIS.END))&&a.checkBoundaryOfElement(m,POLARIS.START))&&q?(m.mergeSiblings(),m.is(this.element)?r.call(this,m):t(m,B(this)[m.getName()])):n||q?(k=m,k.match=n?"start":"end"):(k=m,k.match=n?"start":"end",f=e,c())}if(k){m=e;for(l=0;;l++){n=h.elements[l];if(n.equals(k))break;else if(n.match)continue;else n=n.clone();n.append(m);m=n}m["start"==k.match?"insertBefore":"insertAfter"](k)}}else for((h=e.getNextSourceNode(!0))&&z(h)&&e.insertAfter(h),(h=f.getNextSourceNode(!0))&&z(h)&&f.insertBefore(h),c(),
h=e;h&&!h.equals(f);)k=h.getNextSourceNode(),h.type==POLARIS.NODE_ELEMENT&&this.checkElementRemovable(h)&&(h.getName()==this.element?r.call(this,h):t(h,B(this)[h.getName()]),k.type==POLARIS.NODE_ELEMENT&&k.contains(e)&&(c(),k=e.getNext())),h=k;a.moveToBookmark(d);a.shrink(POLARIS.NODE_ELEMENT,!0);b(a.startContainer,a.endContainer)}function h(a){var b=[];a.forEach(function(a){if("true"==a.getAttribute("contenteditable"))return b.push(a),!1},POLARIS.NODE_ELEMENT,!0);return b}function g(a){var b=a.getEnclosedNode()||
a.getCommonAncestor(!1,!0);(a=(new POLARIS.dom.elementPath(b,a.root)).contains(this.element,1))&&!a.isReadOnly()&&x(a,this)}function k(a){var b=a.getCommonAncestor(!0,!0);if(a=(new POLARIS.dom.elementPath(b,a.root)).contains(this.element,1)){var b=this._.definition,c=b.attributes;if(c)for(var d in c)a.removeAttribute(d,c[d]);if(b.styles)for(var e in b.styles)b.styles.hasOwnProperty(e)&&a.removeStyle(e)}}function f(a){var b=a.createBookmark(!0),c=a.createIterator();c.enforceRealBlocks=!0;this._.enterMode&&
(c.enlargeBr=this._.enterMode!=POLARIS.ENTER_BR);for(var d,e=a.document,f;d=c.getNextParagraph();)!d.isReadOnly()&&(c.activeFilter?c.activeFilter.check(this):1)&&(f=A(this,e,d),m(d,f));a.moveToBookmark(b)}function l(a){var b=a.createBookmark(1),c=a.createIterator();c.enforceRealBlocks=!0;c.enlargeBr=this._.enterMode!=POLARIS.ENTER_BR;for(var d,e;d=c.getNextParagraph();)this.checkElementRemovable(d)&&(d.is("pre")?((e=this._.enterMode==POLARIS.ENTER_BR?null:a.document.createElement(this._.enterMode==
POLARIS.ENTER_P?"p":"div"))&&d.copyAttributes(e),m(d,e)):r.call(this,d));a.moveToBookmark(b)}function m(a,b){var c=!b;c&&(b=a.getDocument().createElement("div"),a.copyAttributes(b));var d=b&&b.is("pre"),e=a.is("pre"),f=!d&&e;if(d&&!e){e=b;(f=a.getBogus())&&f.remove();f=a.getHtml();f=q(f,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");f=f.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");f=f.replace(/([ \t\n\r]+|&nbsp;)/g," ");f=f.replace(/<br\b[^>]*>/gi,"\n");if(POLARIS.env.ie){var g=a.getDocument().createElement("div");
g.append(e);e.$.outerHTML="\x3cpre\x3e"+f+"\x3c/pre\x3e";e.copyAttributes(g.getFirst());e=g.getFirst().remove()}else e.setHtml(f);b=e}else f?b=v(c?[a.getHtml()]:n(a),b):a.moveChildren(b);b.replace(a);if(d){var c=b,h;(h=c.getPrevious(D))&&h.type==POLARIS.NODE_ELEMENT&&h.is("pre")&&(d=q(h.getHtml(),/\n$/,"")+"\n\n"+q(c.getHtml(),/^\n/,""),POLARIS.env.ie?c.$.outerHTML="\x3cpre\x3e"+d+"\x3c/pre\x3e":c.setHtml(d),h.remove())}else c&&w(b)}function n(a){var b=[];q(a.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-polaris-bookmark.*?\/span>))*\n(?!$)/gi,
function(a,b,c){return b+"\x3c/pre\x3e"+c+"\x3cpre\x3e"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(a,c){b.push(c)});return b}function q(a,b,c){var d="",e="";a=a.replace(/(^<span[^>]+data-polaris-bookmark.*?\/span>)|(<span[^>]+data-polaris-bookmark.*?\/span>$)/gi,function(a,b,c){b&&(d=b);c&&(e=c);return""});return d+a.replace(b,c)+e}function v(a,b){var c;1<a.length&&(c=new POLARIS.dom.documentFragment(b.getDocument()));for(var d=0;d<a.length;d++){var e=a[d],e=e.replace(/(\r\n|\r)/g,"\n"),e=
q(e,/^[ \t]*\n/,""),e=q(e,/\n$/,""),e=q(e,/^[ \t]+|[ \t]+$/g,function(a,b){return 1==a.length?"\x26nbsp;":b?" "+POLARIS.tools.repeat("\x26nbsp;",a.length-1):POLARIS.tools.repeat("\x26nbsp;",a.length-1)+" "}),e=e.replace(/\n/g,"\x3cbr\x3e"),e=e.replace(/[ \t]{2,}/g,function(a){return POLARIS.tools.repeat("\x26nbsp;",a.length-1)+" "});if(c){var f=b.clone();f.setHtml(e);c.append(f)}else b.setHtml(e)}return c||b}function r(a,b){var c=this._.definition,d=c.attributes,c=c.styles,e=B(this)[a.getName()],
f=POLARIS.tools.isEmpty(d)&&POLARIS.tools.isEmpty(c),g;for(g in d)if("class"!=g&&!this._.definition.fullMatch||a.getAttribute(g)==G(g,d[g]))b&&"data-"==g.slice(0,5)||(f=a.hasAttribute(g),a.removeAttribute(g));for(var h in c)this._.definition.fullMatch&&a.getStyle(h)!=G(h,c[h],!0)||(f=f||!!a.getStyle(h),a.removeStyle(h));t(a,e,E[a.getName()]);f&&(this._.definition.alwaysRemoveElement?w(a,1):!POLARIS.dtd.$block[a.getName()]||this._.enterMode==POLARIS.ENTER_BR&&!a.hasAttributes()?w(a):a.renameNode(this._.enterMode==
POLARIS.ENTER_P?"p":"div"))}function p(a){for(var b=B(this),c=a.getElementsByTag(this.element),d,e=c.count();0<=--e;)d=c.getItem(e),d.isReadOnly()||r.call(this,d,!0);for(var f in b)if(f!=this.element)for(c=a.getElementsByTag(f),e=c.count()-1;0<=e;e--)d=c.getItem(e),d.isReadOnly()||t(d,b[f])}function t(a,b,c){var d=b&&b.attributes;b=b&&b.styles;if(d)for(var e=0;e<d.length;e++){var f=d[e][0],g;if(g=a.getAttribute(f)){var h=d[e][1];(null===h||h.test&&h.test(g)||"string"==typeof h&&g==h)&&a.removeAttribute(f)}}if(b)for(e=
0;e<b.length;e++)if(d=b[e][0],f=a.getStyle(d))g=b[e][1],(null===g||g.test&&g.test(f)||"string"==typeof g&&f==g)&&a.removeStyle(d);c||w(a)}function w(a,b){if(!a.hasAttributes()||b)if(POLARIS.dtd.$block[a.getName()]){var c=a.getPrevious(D),d=a.getNext(D);!c||c.type!=POLARIS.NODE_TEXT&&c.isBlockBoundary({br:1})||a.append("br",1);!d||d.type!=POLARIS.NODE_TEXT&&d.isBlockBoundary({br:1})||a.append("br");a.remove(!0)}else c=a.getFirst(),d=a.getLast(),a.remove(!0),c&&(c.type==POLARIS.NODE_ELEMENT&&c.mergeSiblings(),
d&&!c.equals(d)&&d.type==POLARIS.NODE_ELEMENT&&d.mergeSiblings())}function A(a,b,c){var d;d=a.element;"*"==d&&(d="span");d=new POLARIS.dom.element(d,b);c&&c.copyAttributes(d);d=x(d,a);b.getCustomData("doc_processing_style")&&d.hasAttribute("id")?d.removeAttribute("id"):b.setCustomData("doc_processing_style",1);return d}function x(a,b){var c=b._.definition,d=c.attributes,c=POLARIS.style.getStyleText(c);if(d)for(var e in d)a.setAttribute(e,d[e]);c&&a.setAttribute("style",c);return a}function C(a,b){for(var c in a)a[c]=
a[c].replace(I,function(a,c){return b[c]})}function u(a){var b=a._AC;if(b)return b;var b={},c=0,d=a.attributes;if(d)for(var e in d)c++,b[e]=d[e];if(d=POLARIS.style.getStyleText(a))b.style||c++,b.style=d;b._length=c;return a._AC=b}function B(a){if(a._.overrides)return a._.overrides;var b=a._.overrides={},c=a._.definition.overrides;if(c){POLARIS.tools.isArray(c)||(c=[c]);for(var d=0;d<c.length;d++){var e=c[d],f,g,h;"string"==typeof e?f=e.toLowerCase():(f=e.element?e.element.toLowerCase():a.element,
g=e.attributes,h=e.styles);e=b[f]||(b[f]={});if(g){f=e.attributes=e.attributes||[];for(var k in g)f.push([k.toLowerCase(),g[k]])}if(h){var e=e.styles=e.styles||[],l;for(l in h)e.push([l.toLowerCase(),h[l]])}}}return b}function G(a,b,c){var d=new POLARIS.dom.element("span");d[c?"setStyle":"setAttribute"](a,b);return d[c?"getStyle":"getAttribute"](a)}function y(a,b){"string"==typeof a&&(a=POLARIS.tools.parseCssText(a));"string"==typeof b&&(b=POLARIS.tools.parseCssText(b,!0));for(var c in a)if("letter-spacing"==
c){if(!(c in b)||b[c]!=a[c]&&"inherit"!=a[c]&&"inherit"!=b[c])return!1}else if(!(c in b&&(b[c]==a[c]||0<=a[c].indexOf(b[c])||"inherit"==a[c]||"inherit"==b[c])))return!1;return!0}function F(a,b,c){var d=a.document,e=a.getRanges();b=b?this.removeFromRange:this.applyToRange;for(var f,g=e.createIterator();f=g.getNextRange();)b.call(this,f,c);a.selectRanges(e);d.removeCustomData("doc_processing_style")}var E={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,
aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},H={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},J=/\s*(?:;\s*|$)/,I=/#\((.+?)\)/g,L=POLARIS.dom.walker.bookmark(0,1),z=POLARIS.dom.walker.bogus(),D=POLARIS.dom.walker.whitespaces(1);POLARIS.style=function(a,b){if("string"==typeof a.type)return new POLARIS.style.customHandlers[a.type](a);var c=a.attributes;
c&&c.style&&(a.styles=POLARIS.tools.extend({},a.styles,POLARIS.tools.parseCssText(c.style)),delete c.style);b&&(a=POLARIS.tools.clone(a),C(a.attributes,b),C(a.styles,b));c=this.element=a.element?"string"==typeof a.element?a.element.toLowerCase():a.element:"*";this.type=a.type||(E[c]?POLARIS.STYLE_BLOCK:H[c]?POLARIS.STYLE_OBJECT:POLARIS.STYLE_INLINE);"object"==typeof this.element&&(this.type=POLARIS.STYLE_OBJECT);this._={definition:a}};POLARIS.style.prototype={apply:function(a){if(a instanceof POLARIS.dom.document)return F.call(this,
a.getSelection());if(this.checkApplicable(a.elementPath(),a)){var b=this._.enterMode;b||(this._.enterMode=a.activeEnterMode);F.call(this,a.getSelection(),0,a);this._.enterMode=b}},remove:function(a){if(a instanceof POLARIS.dom.document)return F.call(this,a.getSelection(),1);if(this.checkApplicable(a.elementPath(),a)){var b=this._.enterMode;b||(this._.enterMode=a.activeEnterMode);F.call(this,a.getSelection(),1,a);this._.enterMode=b}},applyToRange:function(a){this.applyToRange=this.type==POLARIS.STYLE_INLINE?
c:this.type==POLARIS.STYLE_BLOCK?f:this.type==POLARIS.STYLE_OBJECT?g:null;return this.applyToRange(a)},removeFromRange:function(a){this.removeFromRange=this.type==POLARIS.STYLE_INLINE?d:this.type==POLARIS.STYLE_BLOCK?l:this.type==POLARIS.STYLE_OBJECT?k:null;return this.removeFromRange(a)},applyToObject:function(a){x(a,this)},checkActive:function(a,b){switch(this.type){case POLARIS.STYLE_BLOCK:return this.checkElementRemovable(a.block||a.blockLimit,!0,b);case POLARIS.STYLE_OBJECT:case POLARIS.STYLE_INLINE:for(var c=
a.elements,d=0,e;d<c.length;d++)if(e=c[d],this.type!=POLARIS.STYLE_INLINE||e!=a.block&&e!=a.blockLimit){if(this.type==POLARIS.STYLE_OBJECT){var f=e.getName();if(!("string"==typeof this.element?f==this.element:f in this.element))continue}if(this.checkElementRemovable(e,!0,b))return!0}}return!1},checkApplicable:function(a,b,c){b&&b instanceof POLARIS.filter&&(c=b);if(c&&!c.check(this))return!1;switch(this.type){case POLARIS.STYLE_OBJECT:return!!a.contains(this.element);case POLARIS.STYLE_BLOCK:return!!a.blockLimit.getDtd()[this.element]}return!0},
checkElementMatch:function(a,b){var c=this._.definition;if(!a||!c.ignoreReadonly&&a.isReadOnly())return!1;var d=a.getName();if("string"==typeof this.element?d==this.element:d in this.element){if(!b&&!a.hasAttributes())return!0;c=u(c);if(c._length){for(var e in c)if("_length"!=e){var f=a.getAttribute(e)||"";if("style"==e)a:{d=c[e];"string"==typeof d&&(d=POLARIS.tools.parseCssText(d));"string"==typeof f&&(f=POLARIS.tools.parseCssText(f,!0));var g=void 0;for(g in d)if(!(g in f)||f[g]!=d[g]&&"inherit"!=
d[g]&&"inherit"!=f[g]){d=!1;break a}d=!0}else d=c[e]==f;if(d){if(!b)return!0}else if(b)return!1}if(b)return!0}else return!0}return!1},checkElementStyleMatch:function(a){var b=this._.definition;if(!a)return!1;a.getName();if(!a.hasAttributes())return!1;b=u(b);if(b._length)for(var c in b)if("_length"!=c){var d=a.getAttribute(c)||"";if("style"==c?y(b[c],d):b[c]==d)return!0}return!1},checkElementRemovable:function(a,b,c){if(this.checkElementMatch(a,b,c))return!0;if(b=B(this)[a.getName()]){var d;if(!(b=
b.attributes))return!0;for(c=0;c<b.length;c++)if(d=b[c][0],d=a.getAttribute(d)){var e=b[c][1];if(null===e)return!0;if("string"==typeof e){if(d==e)return!0}else if(e.test(d))return!0}}return!1},buildPreview:function(a){var b=this._.definition,c=[],d=b.element;"bdo"==d&&(d="span");var c=["\x3c",d],e=b.attributes;if(e)for(var f in e)c.push(" ",f,'\x3d"',e[f],'"');(e=POLARIS.style.getStyleText(b))&&c.push(' style\x3d"',e,'"');c.push("\x3e",a||b.name,"\x3c/",d,"\x3e");return c.join("")},getDefinition:function(){return this._.definition}};
POLARIS.style.getStyleText=function(a){var b=a._ST;if(b)return b;var b=a.styles,c=a.attributes&&a.attributes.style||"",d="";c.length&&(c=c.replace(J,";"));for(var e in b){var f=b[e],g=(e+":"+f).replace(J,";");"inherit"==f?d+=g:c+=g}c.length&&(c=POLARIS.tools.normalizeCssText(c,!0));return a._ST=c+d};POLARIS.style.customHandlers={};POLARIS.style.addCustomHandler=function(a){var b=function(a){this._={definition:a};this.setup&&this.setup(a)};b.prototype=POLARIS.tools.extend(POLARIS.tools.prototypedCopy(POLARIS.style.prototype),
{assignedTo:POLARIS.STYLE_OBJECT},a,!0);return this.customHandlers[a.type]=b};var O=POLARIS.POSITION_PRECEDING|POLARIS.POSITION_IDENTICAL|POLARIS.POSITION_IS_CONTAINED,P=POLARIS.POSITION_FOLLOWING|POLARIS.POSITION_IDENTICAL|POLARIS.POSITION_IS_CONTAINED})();POLARIS.styleCommand=function(a,e){this.requiredContent=this.allowedContent=this.style=a;POLARIS.tools.extend(this,e,!0)};POLARIS.styleCommand.prototype.exec=function(a){a.focus();var e=a.getSelection(),b=this.state,c=this.style;if((e=POLARIS.plugins.tabletools.getSelectedCells(e))&&
0<e.length&&POLARIS.plugins.tabletools.hasSelectedCell(e))for(var d=0;d<e.length;d++){var h=e[d],g=new POLARIS.dom.range(a.document);g.selectNodeContents(h);b==POLARIS.TRISTATE_OFF?c.applyToRange(g):b==POLARIS.TRISTATE_ON&&c.removeFromRange(g)}else b==POLARIS.TRISTATE_OFF?a.applyStyle(c):b==POLARIS.TRISTATE_ON&&a.removeStyle(c);b==POLARIS.TRISTATE_OFF?this.setState(POLARIS.TRISTATE_ON):b==POLARIS.TRISTATE_ON&&this.setState(POLARIS.TRISTATE_OFF)};POLARIS.stylesSet=new POLARIS.resourceManager("","stylesSet");
POLARIS.addStylesSet=POLARIS.tools.bind(POLARIS.stylesSet.add,POLARIS.stylesSet);POLARIS.loadStylesSet=function(a,e,b){POLARIS.stylesSet.addExternal(a,e,"");POLARIS.stylesSet.load(a,b)};POLARIS.tools.extend(POLARIS.editor.prototype,{attachStyleStateChange:function(a,e){var b=this._.styleStateChangeCallbacks;b||(b=this._.styleStateChangeCallbacks=[],this.on("selectionChange",function(a){for(var d=0;d<b.length;d++){var e=b[d],g=e.style.checkActive(a.data.path,this)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;
e.fn.call(this,g)}}));b.push({style:a,fn:e})},applyStyle:function(a){a.apply(this)},removeStyle:function(a){a.remove(this)},getStylesSet:function(a){if(this._.stylesDefinitions)a(this._.stylesDefinitions);else{var e=this,b=e.config.stylesCombo_stylesSet||e.config.stylesSet;if(!1===b)a(null);else if(b instanceof Array)e._.stylesDefinitions=b,a(b);else{b||(b="default");var b=b.split(":"),c=b[0];POLARIS.stylesSet.addExternal(c,b[1]?b.slice(1).join(":"):POLARIS.getUrl("styles.js"),"");POLARIS.stylesSet.load(c,
function(b){e._.stylesDefinitions=b[c];a(e._.stylesDefinitions)})}}}});POLARIS.dom.comment=function(a,e){"string"==typeof a&&(a=(e?e.$:document).createComment(a));POLARIS.dom.domObject.call(this,a)};POLARIS.dom.comment.prototype=new POLARIS.dom.node;POLARIS.tools.extend(POLARIS.dom.comment.prototype,{type:POLARIS.NODE_COMMENT,getOuterHtml:function(){return"\x3c!--"+this.$.nodeValue+"--\x3e"}});"use strict";(function(){var a={},e={},b;for(b in POLARIS.dtd.$blockLimit)b in POLARIS.dtd.$list||(a[b]=
1);for(b in POLARIS.dtd.$block)b in POLARIS.dtd.$blockLimit||b in POLARIS.dtd.$empty||(e[b]=1);POLARIS.dom.elementPath=function(b,d){var h=null,g=null,k=[],f=b,l;d=d||b.getDocument().getBody();do if(f.type==POLARIS.NODE_ELEMENT){k.push(f);if(!this.lastElement&&(this.lastElement=f,f.is(POLARIS.dtd.$object)||"false"==f.getAttribute("contenteditable")))continue;if(f.equals(d))break;if(!g&&(l=f.getName(),"true"==f.getAttribute("contenteditable")?g=f:!h&&e[l]&&(h=f),a[l])){if(l=!h&&"div"==l){a:{l=f.getChildren();
for(var m=0,n=l.count();m<n;m++){var q=l.getItem(m);if(q.type==POLARIS.NODE_ELEMENT&&POLARIS.dtd.$block[q.getName()]){l=!0;break a}}l=!1}l=!l}l?h=f:g=f}}while(f=f.getParent());g||(g=d);this.block=h;this.blockLimit=g;this.root=d;this.elements=k}})();POLARIS.dom.elementPath.prototype={compare:function(a){var e=this.elements;a=a&&a.elements;if(!a||e.length!=a.length)return!1;for(var b=0;b<e.length;b++)if(!e[b].equals(a[b]))return!1;return!0},contains:function(a,e,b){var c;"string"==typeof a&&(c=function(b){return b.getName()==
a});a instanceof POLARIS.dom.element?c=function(b){return b.equals(a)}:POLARIS.tools.isArray(a)?c=function(b){return-1<POLARIS.tools.indexOf(a,b.getName())}:"function"==typeof a?c=a:"object"==typeof a&&(c=function(b){return b.getName()in a});var d=this.elements,h=d.length;e&&h--;b&&(d=Array.prototype.slice.call(d,0),d.reverse());for(e=0;e<h;e++)if(c(d[e]))return d[e];return null},isContextFor:function(a){var e;return a in POLARIS.dtd.$block?(e=this.contains(POLARIS.dtd.$intermediate)||this.root.equals(this.block)&&
this.block||this.blockLimit,!!e.getDtd()[a]):!0},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}};POLARIS.dom.text=function(a,e){"string"==typeof a&&(a=(e?e.$:document).createTextNode(a));this.$=a};POLARIS.dom.text.prototype=new POLARIS.dom.node;POLARIS.tools.extend(POLARIS.dom.text.prototype,{type:POLARIS.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(a){this.$.nodeValue=a},split:function(a){var e=
this.$.parentNode,b=e.childNodes.length,c=this.getLength(),d=this.getDocument(),h=new POLARIS.dom.text(this.$.splitText(a),d);e.childNodes.length==b&&(a>=c?(h=d.createText(""),h.insertAfter(this)):(a=d.createText(""),a.insertAfter(h),a.remove()));return h},substring:function(a,e){return"number"!=typeof e?this.$.nodeValue.substr(a):this.$.nodeValue.substring(a,e)}});(function(){function a(a,c,d){var e=a.serializable,g=c[d?"endContainer":"startContainer"],k=d?"endOffset":"startOffset",f=e?c.document.getById(a.startNode):
a.startNode;a=e?c.document.getById(a.endNode):a.endNode;g.equals(f.getPrevious())?(c.startOffset=c.startOffset-g.getLength()-a.getPrevious().getLength(),g=a.getNext()):g.equals(a.getPrevious())&&(c.startOffset-=g.getLength(),g=a.getNext());g.equals(f.getParent())&&c[k]++;g.equals(a.getParent())&&c[k]++;c[d?"endContainer":"startContainer"]=g;return c}POLARIS.dom.rangeList=function(a){if(a instanceof POLARIS.dom.rangeList)return a;a?a instanceof POLARIS.dom.range&&(a=[a]):a=[];return POLARIS.tools.extend(a,
e)};var e={createIterator:function(){var a=this,c=POLARIS.dom.walker.bookmark(),d=[],e;return{getNextRange:function(g){e=void 0===e?0:e+1;var k=a[e];if(k&&1<a.length){if(!e)for(var f=a.length-1;0<=f;f--)d.unshift(a[f].createBookmark(!0));if(g)for(var l=0;a[e+l+1];){var m=k.document;g=0;f=m.getById(d[l].endNode);for(m=m.getById(d[l+1].startNode);;){f=f.getNextSourceNode(!1);if(m.equals(f))g=1;else if(c(f)||f.type==POLARIS.NODE_ELEMENT&&f.isBlockBoundary())continue;break}if(!g)break;l++}for(k.moveToBookmark(d.shift());l--;)f=
a[++e],f.moveToBookmark(d.shift()),k.setEnd(f.endContainer,f.endOffset)}return k}}},createBookmarks:function(b){for(var c=[],d,e=0;e<this.length;e++){c.push(d=this[e].createBookmark(b,!0));for(var g=e+1;g<this.length;g++)this[g]=a(d,this[g]),this[g]=a(d,this[g],!0)}return c},createBookmarks2:function(a){for(var c=[],d=0;d<this.length;d++)c.push(this[d].createBookmark2(a));return c},moveToBookmarks:function(a){for(var c=0;c<this.length;c++)this[c].moveToBookmark(a[c])}}})();(function(){function a(){return POLARIS.getUrl(POLARIS.skinName.split(",")[1]||
"skins/"+POLARIS.skinName.split(",")[0]+"/")}function e(b){var c=POLARIS.skin["ua_"+b],d=POLARIS.env;if(c)for(var c=c.split(",").sort(function(a,b){return a>b?-1:1}),e=0,f;e<c.length;e++)if(f=c[e],d.ie&&(f.replace(/^ie/,"")==d.version||d.quirks&&"iequirks"==f)&&(f="ie"),d[f]){b+="_"+c[e];break}return POLARIS.getUrl(a()+b+".css")}function b(a,b){h[a]||(POLARIS.document.appendStyleSheet(e(a)),h[a]=1);b&&b()}function c(a){var b=a.getById(g);b||(b=a.getHead().append("style"),b.setAttribute("id",g),b.setAttribute("type",
"text/css"));return b}function d(a,b,c){var d,e,f;if(POLARIS.env.webkit)for(b=b.split("}").slice(0,-1),e=0;e<b.length;e++)b[e]=b[e].split("{");for(var g=0;g<a.length;g++)if(POLARIS.env.webkit)for(e=0;e<b.length;e++){f=b[e][1];for(d=0;d<c.length;d++)f=f.replace(c[d][0],c[d][1]);a[g].$.sheet.addRule(b[e][0],f)}else{f=b;for(d=0;d<c.length;d++)f=f.replace(c[d][0],c[d][1]);POLARIS.env.ie&&11>POLARIS.env.version?a[g].$.styleSheet.cssText+=f:a[g].$.innerHTML+=f}}var h={};POLARIS.skin={path:a,loadPart:function(c,
d){POLARIS.skin.name!=POLARIS.skinName.split(",")[0]?POLARIS.scriptLoader.load(POLARIS.getUrl(a()+"skin.js"),function(){b(c,d)}):b(c,d)},getPath:function(a){return POLARIS.getUrl(e(a))},icons:{},addIcon:function(a,b,c,d){a=a.toLowerCase();this.icons[a]||(this.icons[a]={path:b,offset:c||0,bgsize:d||"16px"})},getIconStyle:function(a,b,c,d,e){var f;a&&(a=a.toLowerCase(),b&&(f=this.icons[a+"-rtl"]),f||(f=this.icons[a]));a=c||f&&f.path||"";d=d||f&&f.offset;e=e||f&&f.bgsize||"16px";return a&&"background-image:url("+
POLARIS.getUrl(a)+");background-position:0 "+d+"px;background-size:"+e+";"}};POLARIS.tools.extend(POLARIS.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(a){var b=c(POLARIS.document);return(this.setUiColor=function(a){this.uiColor=a;var c=POLARIS.skin.chameleon,e="",g="";"function"==typeof c&&(e=c(this,"editor"),g=c(this,"panel"));a=[[f,a]];d([b],e,a);d(k,g,a)}).call(this,a)}});var g="polaris_ui_color",k=[],f=/\$color/g;POLARIS.on("instanceLoaded",function(a){if(!POLARIS.env.ie||
!POLARIS.env.quirks){var b=a.editor;a=function(a){a=(a.data[0]||a.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument();if(!a.getById("polaris_ui_color")){a=c(a);k.push(a);var e=b.getUiColor();e&&d([a],POLARIS.skin.chameleon(b,"panel"),[[f,e]])}};b.on("panelShow",a);b.on("menuShow",a);b.config.uiColor&&b.setUiColor(b.config.uiColor)}})})();(function(){if(POLARIS.env.webkit)POLARIS.env.hc=!1;else{var a=POLARIS.dom.element.createFromHtml('\x3cdiv style\x3d"width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"\x3e\x3c/div\x3e',
POLARIS.document);a.appendTo(POLARIS.document.getHead());try{var e=a.getComputedStyle("border-top-color"),b=a.getComputedStyle("border-right-color");POLARIS.env.hc=!(!e||e!=b)}catch(c){POLARIS.env.hc=!1}a.remove()}POLARIS.env.hc&&(POLARIS.env.cssClass+=" polaris_hc");POLARIS.document.appendStyleText(".polaris{visibility:hidden;}");POLARIS.status="loaded";POLARIS.fireOnce("loaded");if(a=POLARIS._.pending)for(delete POLARIS._.pending,e=0;e<a.length;e++)POLARIS.editor.prototype.constructor.apply(a[e][0],
a[e][1]),POLARIS.add(a[e][0])})();POLARIS.skin.name="polaris";POLARIS.skin.ua_editor="";POLARIS.skin.ua_dialog="";POLARIS.skin.chameleon=function(){return""};POLARIS.plugins.add("dialogui",{onLoad:function(){var a=function(a){this._||(this._={});this._["default"]=this._.initValue=a["default"]||"";this._.required=a.required||!1;for(var b=[this._],c=1;c<arguments.length;c++)b.push(arguments[c]);b.push(!0);POLARIS.tools.extend.apply(POLARIS.tools,b);return this._},e={build:function(a,b,c){return new POLARIS.ui.dialog.textInput(a,
b,c)}},b={build:function(a,b,c){return new POLARIS.ui.dialog[b.type](a,b,c)}},c={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(a){this.setValue(this.getInitValue(),a)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._["default"]},getInitValue:function(){return this._.initValue}},d=POLARIS.tools.extend({},POLARIS.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(a,b){this._.domOnChangeRegistered||
(a.on("load",function(){this.getInputElement().on("change",function(){a.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0);this.on("change",b)}},!0),h=/^on([A-Z]\w+)/,g=function(a){for(var b in a)(h.test(b)||"title"==b||"type"==b)&&delete a[b];return a};POLARIS.tools.extend(POLARIS.ui.dialog,{labeledElement:function(b,c,d,e){if(!(4>arguments.length)){var g=a.call(this,c);g.labelId=POLARIS.tools.getNextId()+"_label";this._.children=
[];var h={role:c.role||"presentation"};c.includeLabel&&(h["aria-labelledby"]=g.labelId);POLARIS.ui.dialog.uiElement.call(this,b,c,d,"div",null,h,function(){var a=[],d=c.required?" polaris_required":"";"horizontal"!=c.labelLayout?a.push('\x3clabel class\x3d"polaris_dialog_ui_labeled_label'+d+'" ',' id\x3d"'+g.labelId+'"',g.inputId?' for\x3d"'+g.inputId+'"':"",(c.labelStyle?' style\x3d"'+c.labelStyle+'"':"")+"\x3e",c.label,"\x3c/label\x3e",'\x3cdiv class\x3d"polaris_dialog_ui_labeled_content"',c.controlStyle?
' style\x3d"'+c.controlStyle+'"':"",' role\x3d"presentation"\x3e',e.call(this,b,c),"\x3c/div\x3e"):(d={type:"hbox",widths:c.widths,padding:0,children:[{type:"html",html:'\x3clabel class\x3d"polaris_dialog_ui_labeled_label'+d+'" id\x3d"'+g.labelId+'" for\x3d"'+g.inputId+'"'+(c.labelStyle?' style\x3d"'+c.labelStyle+'"':"")+"\x3e"+POLARIS.tools.htmlEncode(c.label)+"\x3c/span\x3e"},{type:"html",html:'\x3cspan class\x3d"polaris_dialog_ui_labeled_content"'+(c.controlStyle?' style\x3d"'+c.controlStyle+'"':
"")+"\x3e"+e.call(this,b,c)+"\x3c/span\x3e"}]},POLARIS.dialog._.uiElementBuilders.hbox.build(b,d,a));return a.join("")})}},textInput:function(b,c,d){if(!(3>arguments.length)){a.call(this,c);var e=this._.inputId=POLARIS.tools.getNextId()+"_textInput",g={"class":"polaris_dialog_ui_input_"+c.type,id:e,type:c.type};c.validate&&(this.validate=c.validate);c.maxLength&&(g.maxlength=c.maxLength);c.size&&(g.size=c.size);c.inputStyle&&(g.style=c.inputStyle);c.readOnly&&(g.readOnly=!0);var h=this,v=!1;b.on("load",
function(){h.getInputElement().on("keydown",function(a){13==a.data.getKeystroke()&&(v=!0)});if(!POLARIS.env.webkit)h.getInputElement().on("keyup",function(a){13==a.data.getKeystroke()&&v&&(b.getButton("ok")&&setTimeout(function(){b.getButton("ok").click()},0),v=!1)},null,null,1E3)});POLARIS.ui.dialog.labeledElement.call(this,b,c,d,function(){var a=['\x3cdiv class\x3d"polaris_dialog_ui_input_',c.type,'" role\x3d"presentation"'];c.width&&a.push('style\x3d"width:'+c.width+'" ');a.push("\x3e\x3cinput ");
g["aria-labelledby"]=this._.labelId;this._.required&&(g["aria-required"]=this._.required);for(var b in g)a.push(b+'\x3d"'+g[b]+'" ');a.push(" /\x3e\x3c/div\x3e");return a.join("")})}},textarea:function(b,c,d){if(!(3>arguments.length)){a.call(this,c);var e=this,g=this._.inputId=POLARIS.tools.getNextId()+"_textarea",h={};c.validate&&(this.validate=c.validate);h.rows=c.rows||5;h.cols=c.cols||20;h["class"]="polaris_dialog_ui_input_textarea "+(c["class"]||"");"undefined"!=typeof c.inputStyle&&(h.style=
c.inputStyle);c.dir&&(h.dir=c.dir);POLARIS.ui.dialog.labeledElement.call(this,b,c,d,function(){h["aria-labelledby"]=this._.labelId;this._.required&&(h["aria-required"]=this._.required);var a=['\x3cdiv class\x3d"polaris_dialog_ui_input_textarea" role\x3d"presentation"\x3e\x3ctextarea id\x3d"',g,'" '],b;for(b in h)a.push(b+'\x3d"'+POLARIS.tools.htmlEncode(h[b])+'" ');a.push("\x3e",POLARIS.tools.htmlEncode(e._["default"]),"\x3c/textarea\x3e\x3c/div\x3e");return a.join("")})}},checkbox:function(b,c,d){if(!(3>
arguments.length)){var e=a.call(this,c,{"default":!!c["default"]});c.validate&&(this.validate=c.validate);POLARIS.ui.dialog.uiElement.call(this,b,c,d,"span",null,null,function(){var a=POLARIS.tools.extend({},c,{id:c.id?c.id+"_checkbox":POLARIS.tools.getNextId()+"_checkbox"},!0),d=[],h=POLARIS.tools.getNextId()+"_label",l={"class":"polaris_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":h};g(a);c["default"]&&(l.checked="checked");"undefined"!=typeof a.inputStyle&&(a.style=a.inputStyle);
e.checkbox=new POLARIS.ui.dialog.uiElement(b,a,d,"input",null,l);d.push(' \x3clabel id\x3d"',h,'" for\x3d"',l.id,'"'+(c.labelStyle?' style\x3d"'+c.labelStyle+'"':"")+"\x3e",POLARIS.tools.htmlEncode(c.label),"\x3c/label\x3e");return d.join("")})}},radio:function(b,c,d){if(!(3>arguments.length)){a.call(this,c);this._["default"]||(this._["default"]=this._.initValue=c.items[0][1]);c.validate&&(this.validate=c.valdiate);var e=[],h=this;c.role="radiogroup";c.includeLabel=!0;POLARIS.ui.dialog.labeledElement.call(this,
b,c,d,function(){for(var a=[],d=[],l=(c.id?c.id:POLARIS.tools.getNextId())+"_radio",p=0;p<c.items.length;p++){var t=c.items[p],w=void 0!==t[2]?t[2]:t[0],A=void 0!==t[1]?t[1]:t[0],x=POLARIS.tools.getNextId()+"_radio_input",C=x+"_label",x=POLARIS.tools.extend({},c,{id:x,title:null,type:null},!0),w=POLARIS.tools.extend({},x,{title:w},!0),u={type:"radio","class":"polaris_dialog_ui_radio_input",name:l,value:A,"aria-labelledby":C},B=[];h._["default"]==A&&(u.checked="checked");g(x);g(w);"undefined"!=typeof x.inputStyle&&
(x.style=x.inputStyle);x.keyboardFocusable=!0;e.push(new POLARIS.ui.dialog.uiElement(b,x,B,"input",null,u));B.push(" ");new POLARIS.ui.dialog.uiElement(b,w,B,"label",null,{id:C,"for":u.id},t[0]);a.push(B.join(""))}c.order&&"vertical"==c.order?new POLARIS.ui.dialog.vbox(b,e,a,d):new POLARIS.ui.dialog.hbox(b,e,a,d);return d.join("")});this._.children=e}},button:function(b,c,d){if(arguments.length){"function"==typeof c&&(c=c(b.getParentEditor()));a.call(this,c,{disabled:c.disabled||!1});POLARIS.event.implementOn(this);
var e=this;b.on("load",function(){var a=this.getElement();(function(){a.on("click",function(a){e.click();a.data.preventDefault()});a.on("keydown",function(a){a.data.getKeystroke()in{32:1}&&(e.click(),a.data.preventDefault())})})();a.unselectable()},this);var g=POLARIS.tools.extend({},c);delete g.style;var h=POLARIS.tools.getNextId()+"_label";POLARIS.ui.dialog.uiElement.call(this,b,g,d,"a",null,{style:c.style,href:"javascript:void(0)",title:c.label,hidefocus:"true","class":c["class"],role:"button",
"aria-labelledby":h},'\x3cspan id\x3d"'+h+'" class\x3d"polaris_dialog_ui_button"\x3e'+POLARIS.tools.htmlEncode(c.label)+"\x3c/span\x3e")}},select:function(b,c,d){if(!(3>arguments.length)){var e=a.call(this,c);c.validate&&(this.validate=c.validate);e.inputId=POLARIS.tools.getNextId()+"_select";b.on("load",function(){var a=this.getInputElement();(function(){a.on("keydown",function(a){a.data.getKeystroke()in{116:1}&&a.data.preventDefault()})})()},this);POLARIS.ui.dialog.labeledElement.call(this,b,c,
d,function(){var a=POLARIS.tools.extend({},c,{id:c.id?c.id+"_select":POLARIS.tools.getNextId()+"_select"},!0),d=[],h=[],l={id:e.inputId,"class":"polaris_dialog_ui_input_select","aria-labelledby":this._.labelId};d.push('\x3cdiv class\x3d"polaris_dialog_ui_input_',c.type,'" role\x3d"presentation"');c.width&&d.push('style\x3d"width:'+c.width+'" ');d.push("\x3e");void 0!==c.size&&(l.size=c.size);void 0!==c.multiple&&(l.multiple=c.multiple);g(a);for(var p=0,t;p<c.items.length&&(t=c.items[p]);p++)h.push('\x3coption value\x3d"',
POLARIS.tools.htmlEncode(void 0!==t[1]?t[1]:t[0]).replace(/"/g,"\x26quot;"),'" /\x3e ',POLARIS.tools.htmlEncode(t[0]));"undefined"!=typeof a.inputStyle&&(a.style=a.inputStyle);e.select=new POLARIS.ui.dialog.uiElement(b,a,d,"select",null,l,h.join(""));d.push("\x3c/div\x3e");return d.join("")})}},file:function(b,c,d){if(!(3>arguments.length)){void 0===c["default"]&&(c["default"]="");var e=POLARIS.tools.extend(a.call(this,c),{definition:c,buttons:[]});c.validate&&(this.validate=c.validate);b.on("load",
function(){POLARIS.document.getById(e.frameId).getParent().addClass("polaris_dialog_ui_input_file")});POLARIS.ui.dialog.labeledElement.call(this,b,c,d,function(){e.frameId=POLARIS.tools.getNextId()+"_fileInput";var a=['\x3ciframe frameborder\x3d"0" allowtransparency\x3d"0" class\x3d"polaris_dialog_ui_input_file" role\x3d"presentation" id\x3d"',e.frameId,'" title\x3d"',c.label,'" src\x3d"javascript:void('];a.push(POLARIS.env.ie?"(function(){"+encodeURIComponent("document.open();("+POLARIS.tools.fixDomain+
")();document.close();")+"})()":"0");a.push(')"\x3e\x3c/iframe\x3e');return a.join("")})}},fileButton:function(b,c,d){var e=this;if(!(3>arguments.length)){a.call(this,c);c.validate&&(this.validate=c.validate);var g=POLARIS.tools.extend({},c),h=g.onClick;g.className=(g.className?g.className+" ":"")+"polaris_dialog_ui_button";g.onClick=function(a){var d=c["for"];h&&!1===h.call(this,a)||(b.getContentElement(d[0],d[1]).submit(),this.disable())};b.on("load",function(){b.getContentElement(c["for"][0],c["for"][1])._.buttons.push(e)});
POLARIS.ui.dialog.button.call(this,b,g,d)}},html:function(){var a=/^\s*<[\w:]+\s+([^>]*)?>/,b=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,c=/\/$/;return function(d,e,g){if(!(3>arguments.length)){var h=[],r=e.html;"\x3c"!=r.charAt(0)&&(r="\x3cspan\x3e"+r+"\x3c/span\x3e");var p=e.focus;if(p){var t=this.focus;this.focus=function(){("function"==typeof p?p:t).call(this);this.fire("focus")};e.isFocusable&&(this.isFocusable=this.isFocusable);this.keyboardFocusable=!0}POLARIS.ui.dialog.uiElement.call(this,
d,e,h,"span",null,null,"");h=h.join("").match(a);r=r.match(b)||["","",""];c.test(r[1])&&(r[1]=r[1].slice(0,-1),r[2]="/"+r[2]);g.push([r[1]," ",h[1]||"",r[2]].join(""))}}}(),fieldset:function(a,b,c,d,e){var g=e.label;this._={children:b};POLARIS.ui.dialog.uiElement.call(this,a,e,d,"fieldset",null,null,function(){var a=[];g&&a.push("\x3clegend"+(e.labelStyle?' style\x3d"'+e.labelStyle+'"':"")+"\x3e"+g+"\x3c/legend\x3e");for(var b=0;b<c.length;b++)a.push(c[b]);return a.join("")})}},!0);POLARIS.ui.dialog.html.prototype=
new POLARIS.ui.dialog.uiElement;POLARIS.ui.dialog.labeledElement.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.uiElement,{setLabel:function(a){var b=POLARIS.document.getById(this._.labelId);1>b.getChildCount()?(new POLARIS.dom.text(a,POLARIS.document)).appendTo(b):b.getChild(0).$.nodeValue=a;return this},getLabel:function(){var a=POLARIS.document.getById(this._.labelId);return!a||1>a.getChildCount()?"":a.getChild(0).getText()},eventProcessors:d},!0);POLARIS.ui.dialog.button.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.uiElement,
{click:function(){return this._.disabled?!1:this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var a=this.getElement();a&&a.removeClass("polaris_disabled")},disable:function(){this._.disabled=!0;this.getElement().addClass("polaris_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:POLARIS.tools.extend({},POLARIS.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(a,
b){this.on("click",function(){b.apply(this,arguments)})}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0);POLARIS.ui.dialog.textInput.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.labeledElement,{getInputElement:function(){return POLARIS.document.getById(this._.inputId)},focus:function(){var a=this.selectParentTab();setTimeout(function(){var b=a.getInputElement();b&&!b.getAttribute("readonly")&&b.$.focus()},0)},select:function(){var a=
this.selectParentTab();setTimeout(function(){var b=a.getInputElement();b&&!b.getAttribute("readonly")&&(b.$.focus(),b.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(a){POLARIS.tools.isEmptyValue(a)&&(a="");return POLARIS.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},keyboardFocusable:!0},c,!0);POLARIS.ui.dialog.textarea.prototype=new POLARIS.ui.dialog.textInput;POLARIS.ui.dialog.select.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},
add:function(a,b,c){var d=new POLARIS.dom.element("option",this.getDialog().getParentEditor().document),e=this.getInputElement().$;d.$.text=a;d.$.value=void 0===b||null===b?a:b;void 0===c||null===c?POLARIS.env.ie?e.add(d.$):e.add(d.$,null):e.add(d.$,c);return this},remove:function(a){this.getInputElement().$.remove(a);return this},clear:function(){for(var a=this.getInputElement().$;0<a.length;)a.remove(0);return this},keyboardFocusable:!0},c,!0);POLARIS.ui.dialog.checkbox.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.uiElement,
{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(a,b){this.getInputElement().$.checked=a;!b&&this.fire("change",{value:a})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(a,b){if(!POLARIS.env.ie||8<POLARIS.env.version)return d.onChange.apply(this,arguments);a.on("load",function(){var a=this._.checkbox.getElement();a.on("propertychange",function(b){b=b.data.$;"checked"==
b.propertyName&&this.fire("change",{value:a.$.checked})},this)},this);this.on("change",b);return null}},keyboardFocusable:!0},c,!0);POLARIS.ui.dialog.radio.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.uiElement,{setValue:function(a,b){for(var c=this._.children,d,e=0;e<c.length&&(d=c[e]);e++)d.getElement().$.checked=d.getValue()==a;!b&&this.fire("change",{value:a})},getValue:function(){for(var a=this._.children,b=0;b<a.length;b++)if(a[b].getElement().$.checked)return a[b].getValue();return null},
accessKeyUp:function(){var a=this._.children,b;for(b=0;b<a.length;b++)if(a[b].getElement().$.checked){a[b].getElement().focus();return}a[0].getElement().focus()},eventProcessors:{onChange:function(a,b){if(POLARIS.env.ie)a.on("load",function(){for(var a=this._.children,b=this,c=0;c<a.length;c++)a[c].getElement().on("propertychange",function(a){a=a.data.$;"checked"==a.propertyName&&this.$.checked&&b.fire("change",{value:this.getAttribute("value")})})},this),this.on("change",b);else return d.onChange.apply(this,
arguments);return null}}},c,!0);POLARIS.ui.dialog.file.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.labeledElement,c,{getInputElement:function(){var a=POLARIS.document.getById(this._.frameId).getFrameDocument();return 0<a.$.forms.length?new POLARIS.dom.element(a.$.forms[0].elements[0]):this.getElement()},submit:function(){this.getInputElement().getParent().$.submit();return this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(a){var b=/^on([A-Z]\w+)/,
c,d=function(a,b,c,d){a.on("formLoaded",function(){a.getInputElement().on(c,d,a)})},e;for(e in a)if(c=e.match(b))this.eventProcessors[e]?this.eventProcessors[e].call(this,this._.dialog,a[e]):d(this,this._.dialog,c[1].toLowerCase(),a[e]);return this},reset:function(){function a(){c.$.open();var k="";d.size&&(k=d.size-(POLARIS.env.ie?7:0));var w=b.frameId+"_input";c.$.write(['\x3chtml dir\x3d"'+r+'" lang\x3d"'+p+'"\x3e\x3chead\x3e\x3ctitle\x3e\x3c/title\x3e\x3c/head\x3e\x3cbody style\x3d"margin: 0; overflow: hidden; background: transparent;"\x3e',
'\x3cform enctype\x3d"multipart/form-data" method\x3d"POST" dir\x3d"'+r+'" lang\x3d"'+p+'" action\x3d"',POLARIS.tools.htmlEncode(d.action),'"\x3e\x3clabel id\x3d"',b.labelId,'" for\x3d"',w,'" style\x3d"display:none"\x3e',POLARIS.tools.htmlEncode(d.label),'\x3c/label\x3e\x3cinput style\x3d"width:100%" id\x3d"',w,'" aria-labelledby\x3d"',b.labelId,'" type\x3d"file" name\x3d"',POLARIS.tools.htmlEncode(d.id||"polaris_upload"),'" size\x3d"',POLARIS.tools.htmlEncode(0<k?k:""),'" /\x3e\x3c/form\x3e\x3c/body\x3e\x3c/html\x3e\x3cscript\x3e',
POLARIS.env.ie?"("+POLARIS.tools.fixDomain+")();":"","window.parent.POLARIS.tools.callFunction("+g+");","window.onbeforeunload \x3d function() {window.parent.POLARIS.tools.callFunction("+h+")}","\x3c/script\x3e"].join(""));c.$.close();for(k=0;k<e.length;k++)e[k].enable()}var b=this._,c=POLARIS.document.getById(b.frameId).getFrameDocument(),d=b.definition,e=b.buttons,g=this.formLoadedNumber,h=this.formUnloadNumber,r=b.dialog._.editor.lang.dir,p=b.dialog._.editor.langCode;g||(g=this.formLoadedNumber=
POLARIS.tools.addFunction(function(){this.fire("formLoaded")},this),h=this.formUnloadNumber=POLARIS.tools.addFunction(function(){this.getInputElement().clearCustomData()},this),this.getDialog()._.editor.on("destroy",function(){POLARIS.tools.removeFunction(g);POLARIS.tools.removeFunction(h)}));POLARIS.env.gecko?setTimeout(a,500):a()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(a,b){this._.domOnChangeRegistered||
(this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0);this.on("change",b)}},keyboardFocusable:!0},!0);POLARIS.ui.dialog.fileButton.prototype=new POLARIS.ui.dialog.button;POLARIS.ui.dialog.fieldset.prototype=POLARIS.tools.clone(POLARIS.ui.dialog.hbox.prototype);POLARIS.dialog.addUIElement("text",e);POLARIS.dialog.addUIElement("password",e);POLARIS.dialog.addUIElement("textarea",b);POLARIS.dialog.addUIElement("checkbox",
b);POLARIS.dialog.addUIElement("radio",b);POLARIS.dialog.addUIElement("button",b);POLARIS.dialog.addUIElement("select",b);POLARIS.dialog.addUIElement("file",b);POLARIS.dialog.addUIElement("fileButton",b);POLARIS.dialog.addUIElement("html",b);POLARIS.dialog.addUIElement("fieldset",{build:function(a,b,c){for(var d=b.children,e,g=[],h=[],r=0;r<d.length&&(e=d[r]);r++){var p=[];g.push(p);h.push(POLARIS.dialog._.uiElementBuilders[e.type].build(a,e,p))}return new POLARIS.ui.dialog[b.type](a,h,g,c,b)}})}});
POLARIS.DIALOG_RESIZE_NONE=0;POLARIS.DIALOG_RESIZE_WIDTH=1;POLARIS.DIALOG_RESIZE_HEIGHT=2;POLARIS.DIALOG_RESIZE_BOTH=3;(function(){function a(){for(var a=this._.tabIdList.length,b=POLARIS.tools.indexOf(this._.tabIdList,this._.currentTabId)+a,c=b-1;c>b-a;c--)if(this._.tabs[this._.tabIdList[c%a]][0].$.offsetHeight)return this._.tabIdList[c%a];return null}function e(){for(var a=this._.tabIdList.length,b=POLARIS.tools.indexOf(this._.tabIdList,this._.currentTabId),c=b+1;c<b+a;c++)if(this._.tabs[this._.tabIdList[c%
a]][0].$.offsetHeight)return this._.tabIdList[c%a];return null}function b(a,b){for(var c=a.$.getElementsByTagName("input"),d=0,e=c.length;d<e;d++){var f=new POLARIS.dom.element(c[d]);"text"==f.getAttribute("type").toLowerCase()&&(b?(f.setAttribute("value",f.getCustomData("fake_value")||""),f.removeCustomData("fake_value")):(f.setCustomData("fake_value",f.getAttribute("value")),f.setAttribute("value","")))}}function c(a,b){var c=this.getInputElement();c&&(a?c.removeAttribute("aria-invalid"):c.setAttribute("aria-invalid",
!0));a||(this.select?this.select():this.focus());b&&alert(b);this.fire("validated",{valid:a,msg:b})}function d(){var a=this.getInputElement();a&&a.removeAttribute("aria-invalid")}function h(a){var b=POLARIS.tools.addFunction(function(a){116===a.keyCode?a.preventDefault(!0):8!=a.keyCode||"input"==a.target.nodeName.toLowerCase()&&"text"==a.target.type&&!a.target.getAttribute("readonly")||("textarea"!=a.target.nodeName.toLowerCase()||a.target.getAttribute("readonly"))&&a.preventDefault(!0)});a=POLARIS.dom.element.createFromHtml(POLARIS.addTemplate("dialog",
p).output({id:POLARIS.tools.getNextNumber(),editorId:a.id,langDir:a.lang.dir,langCode:a.langCode,editorDialogClass:"polaris_editor_"+a.name.replace(/\./g,"\\.")+"_dialog",closeTitle:a.lang.common.close,hidpi:POLARIS.env.hidpi?"polaris_hidpi":"",onkeydown:b}));var b=a.getChild([0,0,0,0,0]),c=b.getChild(0),d=b.getChild(1);if(POLARIS.env.ie&&!POLARIS.env.quirks){var e="javascript:void(function(){"+encodeURIComponent("document.open();("+POLARIS.tools.fixDomain+")();document.close();")+"}())";POLARIS.dom.element.createFromHtml('\x3ciframe frameBorder\x3d"0" class\x3d"polaris_iframe_shim" src\x3d"'+
e+'" tabIndex\x3d"-1"\x3e\x3c/iframe\x3e').appendTo(b.getParent())}c.unselectable();d.unselectable();return{element:a,parts:{dialog:a.getChild(0),title:c,close:d,tabs:b.getChild(2),contents:b.getChild([3,0,0,0]),footer:b.getChild([3,0,1,0])}}}function g(a,b,c){this.element=b;this.focusIndex=c;this.tabIndex=0;this.isFocusable=function(){return!b.getAttribute("disabled")&&b.isVisible()};this.focus=function(){a._.currentFocusIndex=this.focusIndex;this.element.focus()};b.on("keydown",function(a){a.data.getKeystroke()in
{32:1,13:1}&&this.fire("click")});b.on("focus",function(){this.fire("mouseover")});b.on("blur",function(){this.fire("mouseout")})}function k(a){function b(){a.layout()}var c=POLARIS.document.getWindow();c.on("resize",b);a.on("hide",function(){c.removeListener("resize",b)})}function f(a,b){this._={dialog:a};POLARIS.tools.extend(this,b)}function l(a){function b(c){var k=a.getSize(),l=POLARIS.document.getWindow().getViewPaneSize(),m=c.data.$.screenX,n=c.data.$.screenY,r=m-d.x,q=n-d.y;d={x:m,y:n};e.x+=
r;e.y+=q;a.move(e.x+h[3]<g?-h[3]:e.x-h[1]>l.width-k.width-g?l.width-k.width+("rtl"==f.lang.dir?0:h[1]):e.x,e.y+h[0]<g?-h[0]:e.y-h[2]>l.height-k.height-g?l.height-k.height+h[2]:e.y,1);c.data.preventDefault()}function c(){POLARIS.document.removeListener("mousemove",b);POLARIS.document.removeListener("mouseup",c);if(POLARIS.env.ie6Compat){var a=G.getChild(0).getFrameDocument();a.removeListener("mousemove",b);a.removeListener("mouseup",c)}}var d=null,e=null,f=a.getParentEditor(),g=f.config.dialog_magnetDistance,
h=POLARIS.skin.margins||[0,0,0,0];"undefined"==typeof g&&(g=20);a.parts.title.on("mousedown",function(f){d={x:f.data.$.screenX,y:f.data.$.screenY};POLARIS.document.on("mousemove",b);POLARIS.document.on("mouseup",c);e=a.getPosition();if(POLARIS.env.ie6Compat){var g=G.getChild(0).getFrameDocument();g.on("mousemove",b);g.on("mouseup",c)}f.data.preventDefault()},a)}function m(a){function b(c){var n="rtl"==f.lang.dir,r=m.width,q=m.height,w=r+(c.data.$.screenX-l.x)*(n?-1:1)*(a._.moved?1:2),x=q+(c.data.$.screenY-
l.y)*(a._.moved?1:2),D=a._.element.getFirst(),D=n&&D.getComputedStyle("right"),p=a.getPosition();p.y+x>k.height&&(x=k.height-p.y);(n?D:p.x)+w>k.width&&(w=k.width-(n?D:p.x));if(e==POLARIS.DIALOG_RESIZE_WIDTH||e==POLARIS.DIALOG_RESIZE_BOTH)r=Math.max(d.minWidth||0,w-g);if(e==POLARIS.DIALOG_RESIZE_HEIGHT||e==POLARIS.DIALOG_RESIZE_BOTH)q=Math.max(d.minHeight||0,x-h);a.resize(r,q);a._.moved||a.layout();c.data.preventDefault()}function c(){POLARIS.document.removeListener("mouseup",c);POLARIS.document.removeListener("mousemove",
b);n&&(n.remove(),n=null);if(POLARIS.env.ie6Compat){var a=G.getChild(0).getFrameDocument();a.removeListener("mouseup",c);a.removeListener("mousemove",b)}}var d=a.definition,e=d.resizable;if(e!=POLARIS.DIALOG_RESIZE_NONE){var f=a.getParentEditor(),g,h,k,l,m,n,r=POLARIS.tools.addFunction(function(d){m=a.getSize();var e=a.parts.contents;e.$.getElementsByTagName("iframe").length&&(n=POLARIS.dom.element.createFromHtml('\x3cdiv class\x3d"polaris_dialog_resize_cover" style\x3d"height: 100%; position: absolute; width: 100%;"\x3e\x3c/div\x3e'),
e.append(n));h=m.height-a.parts.contents.getSize("height",!(POLARIS.env.gecko||POLARIS.env.ie&&POLARIS.env.quirks));g=m.width-a.parts.contents.getSize("width",1);l={x:d.screenX,y:d.screenY};k=POLARIS.document.getWindow().getViewPaneSize();POLARIS.document.on("mousemove",b);POLARIS.document.on("mouseup",c);POLARIS.env.ie6Compat&&(e=G.getChild(0).getFrameDocument(),e.on("mousemove",b),e.on("mouseup",c));d.preventDefault&&d.preventDefault()});a.on("load",function(){var b="";e==POLARIS.DIALOG_RESIZE_WIDTH?
b=" polaris_resizer_horizontal":e==POLARIS.DIALOG_RESIZE_HEIGHT&&(b=" polaris_resizer_vertical");b=POLARIS.dom.element.createFromHtml('\x3cdiv class\x3d"polaris_resizer'+b+" polaris_resizer_"+f.lang.dir+'" title\x3d"'+POLARIS.tools.htmlEncode(f.lang.common.resize)+'" onmousedown\x3d"POLARIS.tools.callFunction('+r+', event )"\x3e'+("ltr"==f.lang.dir?"◢":"◣")+"\x3c/div\x3e");a.parts.footer.append(b,1)});f.on("destroy",function(){POLARIS.tools.removeFunction(r)})}}function n(a){a.data.preventDefault(1)}
function q(a){var b=POLARIS.document.getWindow(),c=a.config,d=c.dialog_backgroundCoverColor||"white",e=c.dialog_backgroundCoverOpacity,f=c.baseFloatZIndex,c=POLARIS.tools.genKey(d,e,f),g=B[c];g?g.show():(f=['\x3cdiv tabIndex\x3d"-1" style\x3d"position: ',POLARIS.env.ie6Compat?"absolute":"fixed","; z-index: ",f,"; top: 0px; left: 0px; ",POLARIS.env.ie6Compat?"":"background-color: "+d,'" class\x3d"polaris_dialog_background_cover"\x3e'],POLARIS.env.ie6Compat&&(d="\x3chtml\x3e\x3cbody style\x3d\\'background-color:"+
d+";\\'\x3e\x3c/body\x3e\x3c/html\x3e",f.push('\x3ciframe hidefocus\x3d"true" frameborder\x3d"0" id\x3d"polaris_dialog_background_iframe" src\x3d"javascript:'),f.push("void((function(){"+encodeURIComponent("document.open();("+POLARIS.tools.fixDomain+")();document.write( '"+d+"' );document.close();")+"})())"),f.push('" style\x3d"position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity\x3d0)"\x3e\x3c/iframe\x3e')),f.push("\x3c/div\x3e"),g=POLARIS.dom.element.createFromHtml(f.join("")),
g.setOpacity(void 0!==e?e:.5),g.on("keydown",n),g.on("keypress",n),g.on("keyup",n),g.appendTo(POLARIS.document.getBody()),B[c]=g);a.focusManager.add(g);G=g;a=function(){var a=b.getViewPaneSize();g.setStyles({width:a.width+"px",height:a.height+"px"})};var h=function(){var a=b.getScrollPosition(),c=POLARIS.dialog._.currentTop;g.setStyles({left:a.x+"px",top:a.y+"px"});if(c){do a=c.getPosition(),c.move(a.x,a.y);while(c=c._.parentDialog)}};u=a;b.on("resize",a);a();POLARIS.env.mac&&POLARIS.env.webkit||
g.focus();if(POLARIS.env.ie6Compat){var k=function(){h();arguments.callee.prevScrollHandler.apply(this,arguments)};b.$.setTimeout(function(){k.prevScrollHandler=window.onscroll||function(){};window.onscroll=k},0);h()}}function v(a){G&&(a.focusManager.remove(G),a=POLARIS.document.getWindow(),G.hide(),a.removeListener("resize",u),POLARIS.env.ie6Compat&&a.$.setTimeout(function(){window.onscroll=window.onscroll&&window.onscroll.prevScrollHandler||null},0),u=null)}var r=POLARIS.tools.cssLength,p='\x3cdiv class\x3d"polaris_reset_all {editorId} {editorDialogClass} {hidpi}" dir\x3d"{langDir}" lang\x3d"{langCode}" role\x3d"dialog" aria-labelledby\x3d"polaris_dialog_title_{id}"\x3e\x3ctable class\x3d"polaris_dialog '+
POLARIS.env.cssClass+' polaris_{langDir}" tabindex\x3d"0" onkeydown\x3d"POLARIS.tools.callFunction({onkeydown}, event );" style\x3d"position:absolute; outline:0;" role\x3d"presentation"\x3e\x3ctr\x3e\x3ctd role\x3d"presentation"\x3e\x3cdiv class\x3d"polaris_dialog_body" role\x3d"presentation"\x3e\x3cdiv id\x3d"polaris_dialog_title_{id}" class\x3d"polaris_dialog_title" role\x3d"presentation"\x3e\x3c/div\x3e\x3ca id\x3d"polaris_dialog_close_button_{id}" class\x3d"polaris_dialog_close_button" href\x3d"javascript:void(0)" title\x3d"{closeTitle}" role\x3d"button"\x3e\x3cspan class\x3d"polaris_label"\x3eX\x3c/span\x3e\x3c/a\x3e\x3cdiv id\x3d"polaris_dialog_tabs_{id}" class\x3d"polaris_dialog_tabs" role\x3d"tablist"\x3e\x3c/div\x3e\x3ctable class\x3d"polaris_dialog_contents" role\x3d"presentation"\x3e\x3ctr\x3e\x3ctd id\x3d"polaris_dialog_contents_{id}" class\x3d"polaris_dialog_contents_body" role\x3d"presentation"\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd id\x3d"polaris_dialog_footer_{id}" class\x3d"polaris_dialog_footer" role\x3d"presentation"\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e';
POLARIS.dialog=function(b,f){function g(){var a=F._.focusList;a.sort(function(a,b){return a.tabIndex!=b.tabIndex?b.tabIndex-a.tabIndex:a.focusIndex-b.focusIndex});for(var b=a.length,c=0;c<b;c++)a[c].focusIndex=c}function k(a){var b=F._.focusList;a=a||0;if(!(1>b.length)){var c=F._.currentFocusIndex;try{b[c].getInputElement().$.blur()}catch(d){}for(var e=c=(c+a+b.length)%b.length;a&&!b[e].isFocusable()&&(e=(e+a+b.length)%b.length,e!=c););for(;"polaris_disabled"==b[e].className;)e++;b[e].focus();"text"==
b[e].type&&b[e].select()}}function n(c){if(F==POLARIS.dialog._.currentTop){var d=c.data.getKeystroke(),f="rtl"==b.lang.dir;u=v=0;if(9==d||d==POLARIS.SHIFT+9)d=d==POLARIS.SHIFT+9,F._.tabBarMode?(d=d?a.call(F):e.call(F),F.selectPage(d),F._.tabs[d][0].focus()):k(d?-1:1),u=1;else if(d==POLARIS.ALT+121&&!F._.tabBarMode&&1<F.getPageCount())F._.tabBarMode=!0,F._.tabs[F._.currentTabId][0].focus(),u=1;else if(37!=d&&39!=d||!F._.tabBarMode)if(13!=d&&32!=d||!F._.tabBarMode)if(13==d)d=c.data.getTarget(),d.is("a",
"button","select","textarea")||d.is("input")&&"button"==d.$.type||((d=this.getButton("ok"))&&POLARIS.tools.setTimeout(d.click,0,d),u=1),v=1;else if(27==d)(d=this.getButton("cancel"))?POLARIS.tools.setTimeout(d.click,0,d):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),v=1;else return;else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,k(1),u=1;else d=d==(f?39:37)?a.call(F):e.call(F),F.selectPage(d),F._.tabs[d][0].focus(),u=1;r(c)}}function r(a){u?a.data.preventDefault(1):
v&&a.data.stopPropagation()}var q=POLARIS.dialog._.dialogDefinitions[f],w=POLARIS.tools.clone(t),x=b.config.dialog_buttonsOrder||"OS",p=b.lang.dir,A={},u,v;("OS"==x&&POLARIS.env.mac||"rtl"==x&&"ltr"==p||"ltr"==x&&"rtl"==p)&&w.buttons.reverse();q=POLARIS.tools.extend(q(b),w);q=POLARIS.tools.clone(q);q=new C(this,q);w=h(b);this._={editor:b,element:w.element,name:f,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,
pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1};this.parts=w.parts;POLARIS.tools.setTimeout(function(){b.fire("ariaWidget",this.parts.contents)},0,this);w={position:POLARIS.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"};w["rtl"==p?"right":"left"]=0;this.parts.dialog.setStyles(w);POLARIS.event.call(this);this.definition=q=POLARIS.fire("dialogDefinition",{name:f,definition:q},b).definition;"user"==b.config.userMode&&(b.config.removeDialogTabs="table:advanced;cellProperties:advanced;image:advanced;link:advanced;link:target;flash:advanced;div:advanced");
if(!("removeDialogTabs"in b._)&&b.config.removeDialogTabs){w=b.config.removeDialogTabs.split(";");for(p=0;p<w.length;p++)if(x=w[p].split(":"),2==x.length){var y=x[0];A[y]||(A[y]=[]);A[y].push(x[1])}b._.removeDialogTabs=A}if(b._.removeDialogTabs&&(A=b._.removeDialogTabs[f]))for(p=0;p<A.length;p++)q.removeContents(A[p]);if(q.onLoad)this.on("load",q.onLoad);if(q.onShow)this.on("show",q.onShow);if(q.onHide)this.on("hide",q.onHide);if(q.onOk)this.on("ok",function(a){1!=a.sender.definition.skipSaveSnapShotWhenHide&&
(b.fire("saveSnapshot"),setTimeout(function(){b.fire("saveSnapshot")},0));!1===q.onOk.call(this,a)&&(a.data.hide=!1);var c=!1;if("headerfooter"===a.sender._.name||"pagenumber"===a.sender._.name)c=!0;b.fire("contentChange",{type:"dialog",isRelayoutAll:c})});if(q.onCancel)this.on("cancel",function(a){!1===q.onCancel.call(this,a)&&(a.data.hide=!1)});var F=this,E=function(a){var b=F._.contents,c=!1,d;for(d in b)for(var e in b[d])if(c=a.call(this,b[d][e]))return};this.on("ok",function(a){E(function(b){if(b.validate){var d=
b.validate(this),e="string"==typeof d||!1===d;e&&(a.data.hide=!1,a.stop());c.call(b,!e,"string"==typeof d?d:void 0);return e}})},this,null,0);this.on("cancel",function(a){E(function(c){if(c.isChanged())return b.config.dialog_noConfirmCancel||confirm(b.lang.common.confirmCancel)||(a.data.hide=!1),!0})},this,null,0);this.parts.close.on("click",function(a){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide();a.data.preventDefault()},this);this.changeFocus=k;var G=this._.element;b.focusManager.add(G,
1);this.on("show",function(){G.on("keydown",n,this);if(POLARIS.env.gecko)G.on("keypress",r,this)});this.on("hide",function(){G.removeListener("keydown",n);POLARIS.env.gecko&&G.removeListener("keypress",r);E(function(a){d.apply(a)})});this.on("iframeAdded",function(a){(new POLARIS.dom.document(a.data.iframe.$.contentWindow.document)).on("keydown",n,this,null,0)});this.on("show",function(){g();if(b.config.dialog_startupFocusTab&&1<F._.pageCount)F._.tabBarMode=!0,F._.tabs[F._.currentTabId][0].focus();
else if(!this._.hasFocus)if(this._.currentFocusIndex=-1,q.onFocus){var a=q.onFocus.call(this);a&&a.focus()}else k(1)},this,null,4294967295);if(POLARIS.env.ie6Compat)this.on("load",function(){var a=this.getElement(),b=a.getFirst();b.remove();b.appendTo(a)},this);l(this);m(this);(new POLARIS.dom.text(q.title,POLARIS.document)).appendTo(this.parts.title);for(p=0;p<q.contents.length;p++)(A=q.contents[p])&&this.addPage(A);this.parts.tabs.on("click",function(a){var b=a.data.getTarget();b.hasClass("polaris_dialog_tab")&&
(b=b.$.id,this.selectPage(b.substring(8,b.lastIndexOf("_"))),this._.tabBarMode&&(this._.tabBarMode=!1,this._.currentFocusIndex=-1,k(1)),a.data.preventDefault())},this);p=[];A=POLARIS.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"polaris_dialog_footer_buttons",widths:[],children:q.buttons},p).getChild();this.parts.footer.setHtml(p.join(""));for(p=0;p<A.length;p++)this._.buttons[A[p].id]=A[p]};POLARIS.dialog.prototype={destroy:function(){this.hide();this._.element.remove()},resize:function(){return function(a,
b){this._.contentSize&&this._.contentSize.width==a&&this._.contentSize.height==b||(POLARIS.dialog.fire("resize",{dialog:this,width:a,height:b},this._.editor),this.fire("resize",{width:a,height:b},this._.editor),this.parts.contents.setStyles({width:a+"px",height:b+"px"}),"rtl"==this._.editor.lang.dir&&this._.position&&(this._.position.x=POLARIS.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)),this._.contentSize={width:a,
height:b})}}(),getSize:function(){var a=this._.element.getFirst();return{width:a.$.offsetWidth||0,height:a.$.offsetHeight||0}},move:function(a,b,c){var d=this._.element.getFirst(),e="rtl"==this._.editor.lang.dir,f="fixed"==d.getComputedStyle("position");POLARIS.env.ie&&d.setStyle("zoom","100%");f&&this._.position&&this._.position.x==a&&this._.position.y==b||(this._.position={x:a,y:b},f||(f=POLARIS.document.getWindow().getScrollPosition(),a+=f.x,b+=f.y),e&&(f=this.getSize(),a=POLARIS.document.getWindow().getViewPaneSize().width-
f.width-a),b={top:(0<b?b:0)+"px"},b[e?"right":"left"]=(0<a?a:0)+"px",d.setStyles(b),c&&(this._.moved=1))},getPosition:function(){return POLARIS.tools.extend({},this._.position)},isShown:function(){function a(b,c){var d=b._.parentDialog;return null===d?!1:d===c?!0:a(d,c)}var b=POLARIS.dialog._.currentTop;return null===b?!1:b===this?!0:a(b,this)},show:function(){if(!0!==this.isShown()){var a=this._.element,b=this.definition;a.getParent()&&a.getParent().equals(POLARIS.document.getBody())?a.setStyle("display",
"block"):a.appendTo(POLARIS.document.getBody());this.resize(this._.contentSize&&this._.contentSize.width||b.width||b.minWidth,this._.contentSize&&this._.contentSize.height||b.height||b.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);null===POLARIS.dialog._.currentZIndex&&(POLARIS.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex);this._.element.getFirst().setStyle("z-index",POLARIS.dialog._.currentZIndex+=10);null===POLARIS.dialog._.currentTop?(POLARIS.dialog._.currentTop=
this,this._.parentDialog=null,q(this._.editor)):(this._.parentDialog=POLARIS.dialog._.currentTop,this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2),POLARIS.dialog._.currentTop=this);a.on("keydown",F);a.on("keyup",E);this._.hasFocus=!1;for(var c in b.contents)if(b.contents[c]){var a=b.contents[c],d=this._.tabs[a.id],e=a.requiredContent,f=0;if(d){for(var g in this._.contents[a.id]){var h=this._.contents[a.id][g];"hbox"!=h.type&&"vbox"!=h.type&&
h.getInputElement()&&(h.requiredContent&&!this._.editor.activeFilter.check(h.requiredContent)?h.disable():(h.enable(),f++))}!f||e&&!this._.editor.activeFilter.check(e)?d[0].addClass("polaris_dialog_tab_disabled"):d[0].removeClass("polaris_dialog_tab_disabled")}}POLARIS.tools.setTimeout(function(){this.layout();k(this);this.parts.dialog.setStyle("visibility","");this.fireOnce("load",{});POLARIS.ui.fire("ready",this);this.fire("show",{});this._.editor.fire("dialogShow",this);this._.parentDialog||this._.editor.focusManager.lock();
this.foreach(function(a){a.setInitValue&&a.setInitValue()})},100,this)}},layout:function(){var a=this.parts.dialog,b=this.getSize(),c=POLARIS.document.getWindow().getViewPaneSize(),d=(c.width-b.width)/2,e=(c.height-b.height)/2;POLARIS.env.ie6Compat||(b.height+(0<e?e:0)>c.height||b.width+(0<d?d:0)>c.width?a.setStyle("position","absolute"):a.setStyle("position","fixed"));this.move(this._.moved?this._.position.x:d,this._.moved?this._.position.y:e)},foreach:function(a){for(var b in this._.contents)for(var c in this._.contents[b])a.call(this,
this._.contents[b][c]);return this},reset:function(){var a=function(a){a.reset&&a.reset(1)};return function(){this.foreach(a);return this}}(),setupContent:function(){var a=arguments;this.foreach(function(b){b.setup&&b.setup.apply(b,a)})},commitContent:function(){var a=arguments;this.foreach(function(b){POLARIS.env.ie&&this._.currentFocusIndex==b.focusIndex&&b.getInputElement().$.blur();b.commit&&b.commit.apply(b,a)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{});this._.editor.fire("dialogHide",
this);this.selectPage(this._.tabIdList[0]);var a=this._.element;a.setStyle("display","none");this.parts.dialog.setStyle("visibility","hidden");for(J(this);POLARIS.dialog._.currentTop!=this;)POLARIS.dialog._.currentTop.hide();if(this._.parentDialog){var b=this._.parentDialog.getElement().getFirst();b.setStyle("z-index",parseInt(b.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else v(this._.editor);if(POLARIS.dialog._.currentTop=this._.parentDialog)POLARIS.dialog._.currentZIndex-=
10;else{POLARIS.dialog._.currentZIndex=null;a.removeListener("keydown",F);a.removeListener("keyup",E);var c=this._.editor;c.focus();setTimeout(function(){c.focusManager.unlock();POLARIS.env.iOS&&c.window.focus()},0)}delete this._.parentDialog;this.foreach(function(a){a.resetInitValue&&a.resetInitValue()})}},addPage:function(a){if(!a.requiredContent||this._.editor.filter.check(a.requiredContent)){for(var b=[],c=a.label?' title\x3d"'+POLARIS.tools.htmlEncode(a.label)+'"':"",d=POLARIS.dialog._.uiElementBuilders.vbox.build(this,
{type:"vbox",className:"polaris_dialog_page_contents",children:a.elements,expand:!!a.expand,padding:a.padding,textalign:a.textalign,verticalalign:a.verticalalign,heights:a.heights,style:a.style||"width: 100%;"},b),e=this._.contents[a.id]={},f=d.getChild(),g=0;d=f.shift();)d.notAllowed||"hbox"==d.type||"vbox"==d.type||g++,e[d.id]=d,"function"==typeof d.getChild&&f.push.apply(f,d.getChild());g||(a.hidden=!0);b=POLARIS.dom.element.createFromHtml(b.join(""));b.setAttribute("role","tabpanel");d=POLARIS.env;
e="polaris_"+a.id+"_"+POLARIS.tools.getNextNumber();c=POLARIS.dom.element.createFromHtml(['\x3ca class\x3d"polaris_dialog_tab"',0<this._.pageCount?" polaris_last":"polaris_first",c,a.hidden?' style\x3d"display:none"':"",' id\x3d"',e,'"',d.gecko&&!d.hc?"":' href\x3d"javascript:void(0)"',' tabIndex\x3d"-1" hidefocus\x3d"true" role\x3d"tab"\x3e',a.label,"\x3c/a\x3e"].join(""));b.setAttribute("aria-labelledby",e);this._.tabs[a.id]=[c,b];this._.tabIdList.push(a.id);!a.hidden&&this._.pageCount++;this._.lastTab=
c;this.updateStyle();b.setAttribute("name",a.id);b.appendTo(this.parts.contents);c.unselectable();this.parts.tabs.append(c);a.accessKey&&(H(this,this,"CTRL+"+a.accessKey,L,I),this._.accessKeyMap["CTRL+"+a.accessKey]=a.id)}},selectPage:function(a){if(this._.currentTabId!=a&&!this._.tabs[a][0].hasClass("polaris_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:a,currentPage:this._.currentTabId})){for(var c in this._.tabs){var d=this._.tabs[c][0],e=this._.tabs[c][1];c!=a&&(d.removeClass("polaris_dialog_tab_selected"),
e.hide());e.setAttribute("aria-hidden",c!=a)}var f=this._.tabs[a];f[0].addClass("polaris_dialog_tab_selected");POLARIS.env.ie6Compat||POLARIS.env.ie7Compat?(b(f[1]),f[1].show(),setTimeout(function(){b(f[1],1)},0)):f[1].show();this._.currentTabId=a;this._.currentTabIndex=POLARIS.tools.indexOf(this._.tabIdList,a)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("polaris_single_page")},hidePage:function(b){var c=this._.tabs[b]&&this._.tabs[b][0];c&&1!=this._.pageCount&&
c.isVisible()&&(b==this._.currentTabId&&this.selectPage(a.call(this)),c.hide(),this._.pageCount--,this.updateStyle())},showPage:function(a){if(a=this._.tabs[a]&&this._.tabs[a][0])a.show(),this._.pageCount++,this.updateStyle()},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(a,b){var c=this._.contents[a];return c&&c[b]},getValueOf:function(a,b){return this.getContentElement(a,b).getValue()},setValueOf:function(a,b,c){return this.getContentElement(a,
b).setValue(c)},getButton:function(a){return this._.buttons[a]},click:function(a){return this._.buttons[a].click()},disableButton:function(a){return this._.buttons[a].disable()},enableButton:function(a){return this._.buttons[a].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(a,b){if("undefined"==typeof b)b=this._.focusList.length,
this._.focusList.push(new g(this,a,b));else{this._.focusList.splice(b,0,new g(this,a,b));for(var c=b+1;c<this._.focusList.length;c++)this._.focusList[c].focusIndex++}}};POLARIS.tools.extend(POLARIS.dialog,{add:function(a,b){this._.dialogDefinitions[a]&&"function"!=typeof b||(this._.dialogDefinitions[a]=b)},exists:function(a){return!!this._.dialogDefinitions[a]},getCurrent:function(){return POLARIS.dialog._.currentTop},isTabEnabled:function(a,b,c){a=a.config.removeDialogTabs;return!(a&&a.match(new RegExp("(?:^|;)"+
b+":"+c+"(?:$|;)","i")))},okButton:function(){var a=function(a,b){b=b||{};return POLARIS.tools.extend({id:"ok",type:"button",label:a.lang.common.ok,"class":"polaris_dialog_ui_button_ok",onClick:function(a){a=a.data.dialog;!1!==a.fire("ok",{hide:!0}).hide&&a.hide()}},b,!0)};a.type="button";a.override=function(b){return POLARIS.tools.extend(function(c){return a(c,b)},{type:"button"},!0)};return a}(),cancelButton:function(){var a=function(a,b){b=b||{};return POLARIS.tools.extend({id:"cancel",type:"button",
label:a.lang.common.cancel,"class":"polaris_dialog_ui_button_cancel",onClick:function(a){a=a.data.dialog;!1!==a.fire("cancel",{hide:!0}).hide&&a.hide()}},b,!0)};a.type="button";a.override=function(b){return POLARIS.tools.extend(function(c){return a(c,b)},{type:"button"},!0)};return a}(),addUIElement:function(a,b){this._.uiElementBuilders[a]=b}});POLARIS.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};POLARIS.event.implementOn(POLARIS.dialog);POLARIS.event.implementOn(POLARIS.dialog.prototype);
var t={resizable:POLARIS.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[POLARIS.dialog.okButton,POLARIS.dialog.cancelButton]},w=function(a,b,c){for(var d=0,e;e=a[d];d++)if(e.id==b||c&&e[c]&&(e=w(e[c],b,c)))return e;return null},A=function(a,b,c,d,e){if(c){for(var f=0,g;g=a[f];f++){if(g.id==c)return a.splice(f,0,b),b;if(d&&g[d]&&(g=A(g[d],b,c,d,!0)))return g}if(e)return null}a.push(b);return b},x=function(a,b,c){for(var d=0,e;e=a[d];d++){if(e.id==b)return a.splice(d,1);if(c&&e[c]&&(e=x(e[c],
b,c)))return e}return null},C=function(a,b){this.dialog=a;for(var c=b.contents,d=0,e;e=c[d];d++)c[d]=e&&new f(a,e);POLARIS.tools.extend(this,b)};C.prototype={getContents:function(a){return w(this.contents,a)},getButton:function(a){return w(this.buttons,a)},addContents:function(a,b){return A(this.contents,a,b)},addButton:function(a,b){return A(this.buttons,a,b)},removeContents:function(a){x(this.contents,a)},removeButton:function(a){x(this.buttons,a)}};f.prototype={get:function(a){return w(this.elements,
a,"children")},add:function(a,b){return A(this.elements,a,b,"children")},remove:function(a){x(this.elements,a,"children")}};var u,B={},G,y={},F=function(a){var b=a.data.$.ctrlKey||a.data.$.metaKey,c=a.data.$.altKey,d=a.data.$.shiftKey,e=String.fromCharCode(a.data.$.keyCode);(b=y[(b?"CTRL+":"")+(c?"ALT+":"")+(d?"SHIFT+":"")+e])&&b.length&&(b=b[b.length-1],b.keydown&&b.keydown.call(b.uiElement,b.dialog,b.key),a.data.preventDefault())},E=function(a){var b=a.data.$.ctrlKey||a.data.$.metaKey,c=a.data.$.altKey,
d=a.data.$.shiftKey,e=String.fromCharCode(a.data.$.keyCode);(b=y[(b?"CTRL+":"")+(c?"ALT+":"")+(d?"SHIFT+":"")+e])&&b.length&&(b=b[b.length-1],b.keyup&&(b.keyup.call(b.uiElement,b.dialog,b.key),a.data.preventDefault()))},H=function(a,b,c,d,e){(y[c]||(y[c]=[])).push({uiElement:a,dialog:b,key:c,keyup:e||a.accessKeyUp,keydown:d||a.accessKeyDown})},J=function(a){for(var b in y){for(var c=y[b],d=c.length-1;0<=d;d--)c[d].dialog!=a&&c[d].uiElement!=a||c.splice(d,1);0===c.length&&delete y[b]}},I=function(a,
b){a._.accessKeyMap[b]&&a.selectPage(a._.accessKeyMap[b])},L=function(){};(function(){POLARIS.ui.dialog={uiElement:function(a,b,c,d,e,f,g){if(!(4>arguments.length)){var h=(d.call?d(b):d)||"div",k=["\x3c",h," "],l=(e&&e.call?e(b):e)||{},m=(f&&f.call?f(b):f)||{},n=(g&&g.call?g.call(this,a,b):g)||"",r=this.domId=m.id||POLARIS.tools.getNextId()+"_uiElement";b.requiredContent&&!a.getParentEditor().filter.check(b.requiredContent)&&(l.display="none",this.notAllowed=!0);m.id=r;var q={};b.type&&(q["polaris_dialog_ui_"+
b.type]=1);b.className&&(q[b.className]=1);b.disabled&&(q.polaris_disabled=1);for(var w=m["class"]&&m["class"].split?m["class"].split(" "):[],r=0;r<w.length;r++)w[r]&&(q[w[r]]=1);w=[];for(r in q)w.push(r);m["class"]=w.join(" ");b.title&&(m.title=b.title);q=(b.style||"").split(";");b.align&&(w=b.align,l["margin-left"]="left"==w?0:"auto",l["margin-right"]="right"==w?0:"auto");for(r in l)q.push(r+":"+l[r]);b.hidden&&q.push("display:none");for(r=q.length-1;0<=r;r--)""===q[r]&&q.splice(r,1);0<q.length&&
(m.style=(m.style?m.style+"; ":"")+q.join("; "));for(r in m)k.push(r+'\x3d"'+POLARIS.tools.htmlEncode(m[r])+'" ');k.push("\x3e",n,"\x3c/",h,"\x3e");c.push(k.join(""));(this._||(this._={})).dialog=a;"boolean"==typeof b.isChanged&&(this.isChanged=function(){return b.isChanged});"function"==typeof b.isChanged&&(this.isChanged=b.isChanged);"function"==typeof b.setValue&&(this.setValue=POLARIS.tools.override(this.setValue,function(a){return function(c){a.call(this,b.setValue.call(this,c))}}));"function"==
typeof b.getValue&&(this.getValue=POLARIS.tools.override(this.getValue,function(a){return function(){return b.getValue.call(this,a.call(this))}}));POLARIS.event.implementOn(this);this.registerEvents(b);this.accessKeyUp&&this.accessKeyDown&&b.accessKey&&H(this,a,"CTRL+"+b.accessKey);var p=this;a.on("load",function(){var b=p.getInputElement();if(b){var c=p.type in{checkbox:1,ratio:1}&&POLARIS.env.ie&&8>POLARIS.env.version?"polaris_dialog_ui_focused":"";b.on("focus",function(){a._.tabBarMode=!1;a._.hasFocus=
!0;p.fire("focus");c&&this.addClass(c)});b.on("blur",function(){p.fire("blur");c&&this.removeClass(c)})}});POLARIS.tools.extend(this,b);this.keyboardFocusable&&(this.tabIndex=b.tabIndex||0,this.focusIndex=a._.focusList.push(this)-1,this.on("focus",function(){a._.currentFocusIndex=p.focusIndex}))}},hbox:function(a,b,c,d,e){if(!(4>arguments.length)){this._||(this._={});var f=this._.children=b,g=e&&e.widths||null,h=e&&e.height||null,k,l={role:"presentation"};e&&e.align&&(l.align=e.align);POLARIS.ui.dialog.uiElement.call(this,
a,e||{type:"hbox"},d,"table",{},l,function(){var a=['\x3ctbody\x3e\x3ctr class\x3d"polaris_dialog_ui_hbox"\x3e'];for(k=0;k<c.length;k++){var b="polaris_dialog_ui_hbox_child",d=[];0===k&&(b="polaris_dialog_ui_hbox_first");k==c.length-1&&(b="polaris_dialog_ui_hbox_last");a.push('\x3ctd class\x3d"',b,'" role\x3d"presentation" ');g?g[k]&&d.push("width:"+r(g[k])):d.push("width:"+Math.floor(100/c.length)+"%");h&&d.push("height:"+r(h));e&&void 0!==e.padding&&d.push("padding:"+r(e.padding));e&&void 0!==e.verticalalign&&
d.push("vertical-align:"+e.verticalalign);e&&void 0!==e.textalign&&d.push("text-align:"+e.textalign);POLARIS.env.ie&&POLARIS.env.quirks&&f[k].align&&d.push("text-align:"+f[k].align);0<d.length&&a.push('style\x3d"'+d.join("; ")+'" ');a.push("\x3e",c[k],"\x3c/td\x3e")}a.push("\x3c/tr\x3e\x3c/tbody\x3e");return a.join("")})}},vbox:function(a,b,c,d,e){if(!(3>arguments.length)){this._||(this._={});var f=this._.children=b,g=e&&e.width||null,h=e&&e.heights||null;POLARIS.ui.dialog.uiElement.call(this,a,e||
{type:"vbox"},d,"div",null,{role:"presentation"},function(){var b=['\x3ctable role\x3d"presentation" cellspacing\x3d"0" border\x3d"0" '];b.push('style\x3d"');e&&e.expand&&b.push("height:100%;");b.push("width:"+r(g||"100%"),";");(POLARIS.env.webkit||POLARIS.env.ie)&&b.push("float:none;");b.push('"');b.push('align\x3d"',POLARIS.tools.htmlEncode(e&&e.align||("ltr"==a.getParentEditor().lang.dir?"left":"right")),'" ');b.push("\x3e\x3ctbody\x3e");for(var d=0;d<c.length;d++){var k=[];b.push('\x3ctr\x3e\x3ctd role\x3d"presentation" ');
g&&k.push("width:"+r(g||"100%"));h?k.push("height:"+r(h[d])):e&&e.expand&&k.push("height:"+Math.floor(100/c.length)+"%");e&&void 0!==e.padding&&k.push("padding:"+r(e.padding));e&&void 0!==e.verticalalign&&k.push("vertical-align:"+e.verticalalign);e&&void 0!==e.textalign&&k.push("text-align:"+e.textalign);POLARIS.env.ie&&POLARIS.env.quirks&&f[d].align&&k.push("text-align:"+f[d].align);0<k.length&&b.push('style\x3d"',k.join("; "),'" ');b.push(1==f[d].hidden?"\x3e":' class\x3d"polaris_dialog_ui_vbox_child"\x3e',
c[d],"\x3c/td\x3e\x3c/tr\x3e")}b.push("\x3c/tbody\x3e\x3c/table\x3e");return b.join("")})}}}})();POLARIS.ui.dialog.uiElement.prototype={getElement:function(){return POLARIS.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(a,b){this.getInputElement().setValue(a);!b&&this.fire("change",{value:a});return this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var a=
this.getInputElement();(a=a.getParent())&&-1==a.$.className.search("polaris_dialog_page_contents"););if(!a)return this;a=a.getAttribute("name");this._.dialog._.currentTabId!=a&&this._.dialog.selectPage(a);return this},focus:function(){this.selectParentTab().getInputElement().focus();return this},registerEvents:function(a){var b=/^on([A-Z]\w+)/,c,d=function(a,b,c,d){b.on("load",function(){a.getInputElement().on(c,d,a)})},e;for(e in a)if(c=e.match(b))this.eventProcessors[e]?this.eventProcessors[e].call(this,
this._.dialog,a[e]):d(this,this._.dialog,c[1].toLowerCase(),a[e]);return this},eventProcessors:{onLoad:function(a,b){a.on("load",b,this)},onShow:function(a,b){a.on("show",b,this)},onHide:function(a,b){a.on("hide",b,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var a=this.getElement();this.getInputElement().setAttribute("disabled","true");a.addClass("polaris_disabled")},enable:function(){var a=this.getElement();this.getInputElement().removeAttribute("disabled");
a.removeClass("polaris_disabled")},readOnly:function(a){var b=this.getInputElement();"undefined"==typeof a||a?b.setAttribute("readonly","true"):b.removeAttribute("readonly")},isReadOnly:function(){return!!this.getInputElement().getAttribute("readonly")},isEnabled:function(){return!this.getElement().hasClass("polaris_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return this.isEnabled()&&this.isVisible()?!0:!1}};POLARIS.ui.dialog.hbox.prototype=POLARIS.tools.extend(new POLARIS.ui.dialog.uiElement,
{getChild:function(a){if(1>arguments.length)return this._.children.concat();a.splice||(a=[a]);return 2>a.length?this._.children[a[0]]:this._.children[a[0]]&&this._.children[a[0]].getChild?this._.children[a[0]].getChild(a.slice(1,a.length)):null}},!0);POLARIS.ui.dialog.vbox.prototype=new POLARIS.ui.dialog.hbox;(function(){var a={build:function(a,b,c){for(var d=b.children,e,f=[],g=[],h=0;h<d.length&&(e=d[h]);h++){var k=[];f.push(k);g.push(POLARIS.dialog._.uiElementBuilders[e.type].build(a,e,k))}return new POLARIS.ui.dialog[b.type](a,
g,f,c,b)}};POLARIS.dialog.addUIElement("hbox",a);POLARIS.dialog.addUIElement("vbox",a)})();POLARIS.dialogCommand=function(a,b){this.dialogName=a;POLARIS.tools.extend(this,b,!0)};POLARIS.dialogCommand.prototype={exec:function(a){a.openDialog(this.dialogName)},canUndo:!1,editorFocus:1};(function(){var a=/^([a]|[^a])+$/,b=/^\d*$/,c=/^\d*(?:\.\d+)?$/,d=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,e=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,f=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;POLARIS.VALIDATE_OR=
1;POLARIS.VALIDATE_AND=2;POLARIS.dialog.validate={functions:function(){var a=arguments;return function(){var b=this&&this.getValue?this.getValue():a[0],c,d=POLARIS.VALIDATE_AND,e=[],f;for(f=0;f<a.length;f++)if("function"==typeof a[f])e.push(a[f]);else break;f<a.length&&"string"==typeof a[f]&&(c=a[f],f++);f<a.length&&"number"==typeof a[f]&&(d=a[f]);var g=d==POLARIS.VALIDATE_AND?!0:!1;for(f=0;f<e.length;f++)g=d==POLARIS.VALIDATE_AND?g&&e[f](b):g||e[f](b);return g?!0:c}},regex:function(a,b){return function(c){c=
this&&this.getValue?this.getValue():c;return a.test(c)?!0:b}},notEmpty:function(b){return this.regex(a,b)},integer:function(a){return this.regex(b,a)},number:function(a){return this.regex(c,a)},cssLength:function(a){return this.functions(function(a){return e.test(POLARIS.tools.trim(a))},a)},htmlLength:function(a){return this.functions(function(a){return d.test(POLARIS.tools.trim(a))},a)},inlineStyle:function(a){return this.functions(function(a){return f.test(POLARIS.tools.trim(a))},a)},equals:function(a,
b){return this.functions(function(b){return b==a},b)},notEqual:function(a,b){return this.functions(function(b){return b!=a},b)}};POLARIS.on("instanceDestroyed",function(a){if(POLARIS.tools.isEmpty(POLARIS.instances)){for(var b;b=POLARIS.dialog._.currentTop;)b.hide();for(var c in B)B[c].remove();B={}}a=a.editor._.storedDialogs;for(var d in a)a[d].destroy()})})();POLARIS.tools.extend(POLARIS.editor.prototype,{openDialog:function(a,b){var c=null,d=POLARIS.dialog._.dialogDefinitions[a];this.execCommand("hideFloatingTools");
null===POLARIS.dialog._.currentTop&&q(this);if("function"==typeof d)c=this._.storedDialogs||(this._.storedDialogs={}),c=c[a]||(c[a]=new POLARIS.dialog(this,a)),b&&b.call(c,c),c.show();else{if("failed"==d)throw v(this),Error('[POLARIS.dialog.openDialog] Dialog "'+a+'" failed when loading definition.');"string"==typeof d&&POLARIS.scriptLoader.load(POLARIS.getUrl(d),function(){"function"!=typeof POLARIS.dialog._.dialogDefinitions[a]&&(POLARIS.dialog._.dialogDefinitions[a]="failed");this.openDialog(a,
b)},this,0,1)}POLARIS.skin.loadPart("dialog");return c}})})();POLARIS.plugins.add("dialog",{requires:"dialogui",init:function(a){a.on("doubleclick",function(e){e.data.dialog&&a.openDialog(e.data.dialog)},null,null,999)}});(function(){POLARIS.plugins.add("a11yhelp",{requires:"dialog",availableLangs:{en:1,ko:1},init:function(a){var e=this;a.addCommand("a11yHelp",{exec:function(){var b=a.langCode,b=e.availableLangs[b]?b:e.availableLangs[b.replace(/-.*/,"")]?b.replace(/-.*/,""):"en";POLARIS.scriptLoader.load(POLARIS.getUrl(e.path+
"dialogs/lang/"+b+".js"),function(){a.lang.a11yhelp=e.langEntries[b];a.openDialog("a11yHelp")})},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1});a.setKeystroke(POLARIS.ALT+48,"a11yHelp");POLARIS.dialog.add("a11yHelp",this.path+"dialogs/a11yhelp.js");a.on("ariaEditorHelpLabel",function(b){b.data.label=a.lang.common.editorHelp})}})})();POLARIS.plugins.add("about",{lang:"en,ko",hidpi:!0,init:function(a){a.addCommand("UserManual",{exec:function(){var b=a.config.userManualURL||[POLARIS.getUrl("manual/userguide.html")];
a.popup(b,980,700,a.config.filebrowserWindowFeatures||a.config.fileBrowserWindowFeatures)},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1});a.ui.addButton&&a.ui.addButton("UserManual",{label:a.lang.about.UserManual,command:"UserManual",toolbar:"UserManual"});a.addCommand("ShortcutManual",{exec:function(){var b=a.config.shortcutManualURL||[POLARIS.getUrl("manual/shortcut.html")];a.popup(b,980,700,a.config.filebrowserWindowFeatures||a.config.fileBrowserWindowFeatures)},modes:{wysiwyg:1,source:1},
readOnly:1,canUndo:!1});a.ui.addButton&&a.ui.addButton("ShortcutManual",{label:a.lang.about.ShortcutManual,command:"ShortcutManual",toolbar:"ShortcutManual"});a.addCommand("TableManual",{exec:function(){var b=a.config.tableManualURL||[POLARIS.getUrl("manual/tableguide.html")];a.popup(b,980,700,a.config.filebrowserWindowFeatures||a.config.fileBrowserWindowFeatures)},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1});a.ui.addButton&&a.ui.addButton("TableManual",{label:a.lang.about.TableManual,command:"TableManual",
toolbar:"TableManual"});a.addCommand("Restriction",{exec:function(){var b=a.config.restrictionURL||[POLARIS.getUrl("manual/restriction.html")];a.popup(b,960,700,a.config.filebrowserWindowFeatures||a.config.fileBrowserWindowFeatures)},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1});a.ui.addButton&&a.ui.addButton("Restriction",{label:a.lang.about.Restriction,command:"Restriction",toolbar:"Restriction"});a.addCommand("fontGuide",{exec:function(){var b=a.config.fontGuideURL||[POLARIS.getUrl("manual/fontGuide.html")];
a.popup(b,620,600,a.config.filebrowserWindowFeatures||a.config.fileBrowserWindowFeatures)},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1});a.ui.addButton&&a.ui.addButton("FontGuide",{label:a.lang.about.fontGuide,command:"fontGuide",toolbar:"fontGuide"});var e=a.addCommand("about",new POLARIS.dialogCommand("about"));e.modes={wysiwyg:1,source:1};e.canUndo=!1;e.readOnly=1;a.ui.addButton&&a.ui.addButton("About",{label:a.lang.about.title,command:"about",toolbar:"about"});POLARIS.dialog.add("about",
this.path+"dialogs/about.js");e=a.addCommand("inquire",new POLARIS.dialogCommand("inquire"));e.modes={wysiwyg:1,source:1};e.canUndo=!1;e.readOnly=1;a.ui.addButton&&a.ui.addButton("CustomerInquire",{label:a.lang.about.CustomerInqure,command:"inquire",toolbar:"inquire"});POLARIS.dialog.add("inquire",this.path+"dialogs/inquire.js")}});(function(){var a={utf8Encode:function(a){return unescape(encodeURIComponent(a))},utf8Decode:function(a){try{return decodeURIComponent(escape(a))}catch(b){return a}}};
window.btoa||(window.btoa=function(a){a=String(a);for(var b,c,d=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",g="";a.charAt(d|0)||(h="\x3d",d%1);g+=h.charAt(63&b>>8-d%1*8)){c=a.charCodeAt(d+=.75);if(255<c)throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");b=b<<8|c}return g});window.atob||(window.atob=function(a){a=String(a).replace(/=+$/,"");if(1==a.length%4)throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");
for(var b=0,c,d,h=0,g="";d=a.charAt(h++);~d&&(c=b%4?64*c+d:d,b++%4)?g+=String.fromCharCode(255&c>>(-2*b&6)):0)d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(d);return g});a.base64Encode=function(a){if("undefined"!=typeof btoa)return btoa(a);throw Error("No Base64 Encode");};a.base64Decode=function(a){if("undefined"!=typeof atob)return atob(a);throw Error("No Base64 Decode");};a.cipher=function(e,b){for(var c=b.length/4-1,d=[[],[],[],[]],h=0;16>h;h++)d[h%4][Math.floor(h/
4)]=e[h];d=a.addRoundKey(d,b,0,4);for(h=1;h<c;h++)d=a.subBytes(d,4),d=a.shiftRows(d,4),d=a.mixColumns(d,4),d=a.addRoundKey(d,b,h,4);d=a.subBytes(d,4);d=a.shiftRows(d,4);d=a.addRoundKey(d,b,c,4);c=Array(16);for(h=0;16>h;h++)c[h]=d[h%4][Math.floor(h/4)];return c};a.keyExpansion=function(e){for(var b=e.length/4,c=b+6,d=Array(4*(c+1)),h=Array(4),g=0;g<b;g++)d[g]=[e[4*g],e[4*g+1],e[4*g+2],e[4*g+3]];for(g=b;g<4*(c+1);g++){d[g]=Array(4);for(e=0;4>e;e++)h[e]=d[g-1][e];if(0==g%b)for(h=a.subWord(a.rotWord(h)),
e=0;4>e;e++)h[e]^=a.rCon[g/b][e];else 6<b&&4==g%b&&(h=a.subWord(h));for(e=0;4>e;e++)d[g][e]=d[g-b][e]^h[e]}return d};a.subBytes=function(e,b){for(var c=0;4>c;c++)for(var d=0;d<b;d++)e[c][d]=a.sBox[e[c][d]];return e};a.shiftRows=function(a,b){for(var c=Array(4),d=1;4>d;d++){for(var h=0;4>h;h++)c[h]=a[d][(h+d)%b];for(h=0;4>h;h++)a[d][h]=c[h]}return a};a.mixColumns=function(a,b){for(var c=0;4>c;c++){for(var d=Array(4),h=Array(4),g=0;4>g;g++)d[g]=a[g][c],h[g]=a[g][c]&128?a[g][c]<<1^283:a[g][c]<<1;a[0][c]=
h[0]^d[1]^h[1]^d[2]^d[3];a[1][c]=d[0]^h[1]^d[2]^h[2]^d[3];a[2][c]=d[0]^d[1]^h[2]^d[3]^h[3];a[3][c]=d[0]^h[0]^d[1]^d[2]^h[3]}return a};a.addRoundKey=function(a,b,c,d){for(var h=0;4>h;h++)for(var g=0;g<d;g++)a[h][g]^=b[4*c+g][h];return a};a.subWord=function(e){for(var b=0;4>b;b++)e[b]=a.sBox[e[b]];return e};a.rotWord=function(a){for(var b=a[0],c=0;3>c;c++)a[c]=a[c+1];a[3]=b;return a};a.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,
164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,
149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];a.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];a.Ctr={};a.Ctr.encrypt=function(e,b,c){if(128!=c&&192!=c&&256!=c)throw Error("Key size is not 128 / 192 / 256");
e=a.utf8Encode(e);b=a.utf8Encode(b);var d=c/8,h=Array(d);for(c=0;c<d;c++)h[c]=c<b.length?b.charCodeAt(c):0;h=a.cipher(h,a.keyExpansion(h));h=h.concat(h.slice(0,d-16));b=Array(16);c=(new Date).getTime();var d=c%1E3,g=Math.floor(c/1E3),k=Math.floor(65535*Math.random());for(c=0;2>c;c++)b[c]=d>>>8*c&255;for(c=0;2>c;c++)b[c+2]=k>>>8*c&255;for(c=0;4>c;c++)b[c+4]=g>>>8*c&255;d="";for(c=0;8>c;c++)d+=String.fromCharCode(b[c]);for(var h=a.keyExpansion(h),g=Math.ceil(e.length/16),k="",f=0;f<g;f++){for(c=0;4>
c;c++)b[15-c]=f>>>8*c&255;for(c=0;4>c;c++)b[15-c-4]=f/4294967296>>>8*c;var l=a.cipher(b,h),m=f<g-1?16:(e.length-1)%16+1,n=Array(m);for(c=0;c<m;c++)n[c]=l[c]^e.charCodeAt(16*f+c),n[c]=String.fromCharCode(n[c]);k+=n.join("");"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&0==f%1E3&&self.postMessage({progress:f/g})}return k=a.base64Encode(d+k)};a.Ctr.decrypt=function(e,b,c){if(128!=c&&192!=c&&256!=c)throw Error("Key size is not 128 / 192 / 256");e=a.base64Decode(e);b=a.utf8Encode(b);
var d=c/8,h=Array(d);for(c=0;c<d;c++)h[c]=c<b.length?b.charCodeAt(c):0;h=a.cipher(h,a.keyExpansion(h));h=h.concat(h.slice(0,d-16));b=Array(8);d=e.slice(0,8);for(c=0;8>c;c++)b[c]=d.charCodeAt(c);d=a.keyExpansion(h);h=Math.ceil((e.length-8)/16);c=Array(h);for(var g=0;g<h;g++)c[g]=e.slice(8+16*g,16*g+24);e=c;for(var k="",g=0;g<h;g++){for(c=0;4>c;c++)b[15-c]=g>>>8*c&255;for(c=0;4>c;c++)b[15-c-4]=(g+1)/4294967296-1>>>8*c&255;var f=a.cipher(b,d),l=Array(e[g].length);for(c=0;c<e[g].length;c++)l[c]=f[c]^
e[g].charCodeAt(c),l[c]=String.fromCharCode(l[c]);k+=l.join("");"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&0==g%1E3&&self.postMessage({progress:g/h})}return k=a.utf8Decode(k)};POLARIS.plugins.add("aes",{init:function(e){e.addCommand("encrypt_aes",{exec:function(b,c){c.returnValue=a.Ctr.encrypt(c.t,c.p,128)},editorFocus:0});e.addCommand("decrypt_aes",{exec:function(b,c){c.returnValue=a.Ctr.decrypt(c.c,c.p,128)},editorFocus:0})}})})();"use strict";(function(){function a(a){function b(){g=
a.document;k=g[POLARIS.env.ie?"getBody":"getDocumentElement"]();f=POLARIS.env.quirks?g.getBody():g.getDocumentElement();var b=POLARIS.env.quirks?f:f.findOne("body");b&&(b.setStyle("height","auto"),b.setStyle("min-height",POLARIS.env.safari?"0%":"auto"));l=POLARIS.dom.element.createFromHtml('\x3cspan style\x3d"margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;"\x3e'+(POLARIS.env.webkit?"\x26nbsp;":"")+"\x3c/span\x3e",g)}function c(){k.append(l);var a=l.getDocumentPosition(g).y+
l.$.offsetHeight;l.remove();return a}function d(){v&&f.setStyle("overflow-y","hidden");var b=a.window.getViewPaneSize().height,d=Math.max(b,c()),d=d+m,d=Math.max(d,n),d=Math.min(d,q);d!=b&&h!=d&&(d=a.fire("autoGrow",{currentHeight:b,newHeight:d}).newHeight,a.resize(a.container.getStyle("width"),d,!0),h=d);v||(d<q&&f.$.scrollHeight>f.$.clientHeight?f.setStyle("overflow-y","hidden"):f.removeStyle("overflow-y"))}var h,g,k,f,l,m=a.config.autoGrow_bottomSpace||0,n=void 0!==a.config.autoGrow_minHeight?
a.config.autoGrow_minHeight:200,q=a.config.autoGrow_maxHeight||Infinity,v=!a.config.autoGrow_maxHeight;a.addCommand("autogrow",{exec:d,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var r={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1,insertHtml:1},p;for(p in r)a.on(p,function(b){"wysiwyg"==b.editor.mode&&setTimeout(function(){var b=a.getCommand("maximize");!a.window||b&&b.state==POLARIS.TRISTATE_ON?h=null:(d(),v||d())},100)});a.on("afterCommandExec",function(a){"maximize"==
a.data.name&&"wysiwyg"==a.editor.mode&&(a.data.command.state==POLARIS.TRISTATE_ON?f.removeStyle("overflow-y"):d())});a.on("contentDom",b);b();a.config.autoGrow_onStartup&&a.editable().isVisible()&&a.execCommand("autogrow")}POLARIS.plugins.add("autogrow",{init:function(e){if(e.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&e.config.autogrow)e.on("instanceReady",function(){e.editable().isInline()?e.ui.space("contents").setStyle("height","auto"):a(e)},void 0,void 0,7)}})})();POLARIS.plugins.add("basicstyles",
{init:function(a){var e=0,b=function(b,d,g,h){if(h){h=new POLARIS.style(h);var k=c[g];k.unshift(h);a.addCommand(g,new POLARIS.styleCommand(h,{contentForms:k}));a.ui.addButton&&a.ui.addButton(b,{label:d,command:g,toolbar:"basicstyles,"+(e+=10)})}},c={bold:["strong","b",["span",function(a){a=a.styles["font-weight"];return"bold"==a||700<=+a}]],italic:["i",["span",function(a){return"italic"==a.styles["font-style"]}]],underline:["u",["span",function(a){return"underline"==a.styles["text-decoration"]}]],
strike:["s","strike",["span",function(a){return"line-through"==a.styles["text-decoration"]}]],subscript:["sub"],superscript:["sup"],emphasis:["em"]},d=a.config,h=a.lang.basicstyles;b("Bold",h.bold,"bold",d.coreStyles_bold);b("Italic",h.italic,"italic",d.coreStyles_italic);b("Underline",h.underline,"underline",d.coreStyles_underline);b("Strike",h.strike,"strike",d.coreStyles_strike);b("Subscript",h.subscript,"subscript",d.coreStyles_subscript);b("Superscript",h.superscript,"superscript",d.coreStyles_superscript);
b("Emphasis",h.emphasis,"emphasis",d.coreStyle_emphasis);var g=[{command:"bold",styleDefinition:d.coreStyles_bold},{command:"italic",styleDefinition:d.coreStyles_italic},{command:"underline",styleDefinition:d.coreStyles_underline},{command:"strike",styleDefinition:d.coreStyles_strike},{command:"subscript",styleDefinition:d.coreStyles_subscript},{command:"superscript",styleDefinition:d.coreStyles_superscript},{command:"emphasis",styleDefinition:d.coreStyle_emphasis}],k=function(b,c){var d=c._.definition,
e=POLARIS.style.getStyleText(d);if(!d.styleName)return null;for(var d=a.elementPath(b).elements,g=0,h;g<d.length;g++){h=d[g];var k;k=c;k=k.checkElementStyleMatch(h)?k.getDefinition().style:null;h=h.getStyle(c._.definition.styleName);if(!k&&h&&-1<e.indexOf(h))return h;if(k)return k}return null};a.on("selectionChange",function(b){var c=a.getSelection(),d=c.getRanges()[0];b=[];if(!a.readOnly){if((c=POLARIS.plugins.tabletools.getSelectedCells(c))&&0<c.length&&POLARIS.plugins.tabletools.hasSelectedCell(c))for(d=
0;d<c.length;d++){var e=c[d],h=e.getTextBrNodes();b=b.concat(h);0>h.length&&b.push(e)}else for(d=new POLARIS.dom.walker(d);node=d.next();)node.type==POLARIS.NODE_TEXT&&b.push(node);e=[];for(h=d=0;c=b[d];){var v=c.getParent();v.type!==POLARIS.NODE_ELEMENT||v.hasAttribute("style")?""===c.getText().replace(/\u200b/g,"")&&(h=e.push(d)):h=e.push(d);d++}for(;h--;)b.splice(e[h],1);for(d=0;d<g.length;d++){c=g[d].styleDefinition;e=new POLARIS.style(c);h=POLARIS.style.getStyleText(c);c=g[d].command;a:{for(var v=
e,r=b,p=void 0,t=0;t<r.length;t++){var w=r[t];if(w.type!=POLARIS.NODE_TEXT||0!=w.getText()){w=k(w,v);if(p&&p!=w){v=!1;break a}p=w}}v=!0}v?(e=k(b[0],e),e=-1<h.indexOf(e)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF,a.getCommand(c).setState(e)):a.getCommand(c).setState(POLARIS.TRISTATE_OFF)}}});a.setKeystroke([[POLARIS.CTRL+66,"bold"],[POLARIS.CTRL+73,"italic"],[POLARIS.CTRL+85,"underline"],[POLARIS.ALT+POLARIS.SHIFT+66,"bold"],[POLARIS.ALT+POLARIS.SHIFT+73,"italic"],[POLARIS.ALT+POLARIS.SHIFT+85,"underline"]])}});
POLARIS.config.coreStyles_bold={element:"span",attributes:{style:"font-weight:bold"},overrides:["strong","b"],styleName:"font-weight"};POLARIS.config.coreStyles_italic={element:"span",attributes:{style:"font-style:italic"},overrides:"i",styleName:"font-style"};POLARIS.config.coreStyles_underline={element:"span",attributes:{style:"text-decoration:underline"},overrides:["u",{element:"u",styles:{"text-underline":null}}],fullMatch:!0,styleName:"text-decoration"};POLARIS.config.coreStyles_strike={element:"span",
attributes:{style:"text-decoration:line-through"},overrides:["strike","s"],fullMatch:!0,styleName:"text-decoration"};POLARIS.config.coreStyles_subscript={element:"sub"};POLARIS.config.coreStyles_superscript={element:"sup"};POLARIS.config.coreStyle_emphasis={element:"em"};(function(){function a(a,b,c,d){if(!a.isReadOnly()&&!a.equals(c.editable())){POLARIS.dom.element.setMarker(d,a,"bidi_processed",1);d=a;for(var e=c.editable();(d=d.getParent())&&!d.equals(e);)if(d.getCustomData("bidi_processed")){a.removeStyle("direction");
a.removeAttribute("dir");return}d="useComputedState"in c.config?c.config.useComputedState:1;(d?a.getComputedStyle("direction"):a.getStyle("direction")||a.hasAttribute("dir"))!=b&&(a.removeStyle("direction"),d?(a.removeAttribute("dir"),b!=a.getComputedStyle("direction")&&a.setAttribute("dir",b)):a.setAttribute("dir",b),c.forceNextSelectionCheck())}}function e(a,b,c){var d=a.getCommonAncestor(!1,!0);a=a.clone();a.enlarge(c==POLARIS.ENTER_BR?POLARIS.ENLARGE_LIST_ITEM_CONTENTS:POLARIS.ENLARGE_BLOCK_CONTENTS);
if(a.checkBoundaryOfElement(d,POLARIS.START)&&a.checkBoundaryOfElement(d,POLARIS.END)){for(var e;d&&d.type==POLARIS.NODE_ELEMENT&&(e=d.getParent())&&1==e.getChildCount()&&!(d.getName()in b);)d=e;return d.type==POLARIS.NODE_ELEMENT&&d.getName()in b&&d}}function b(b){return{context:"p",allowedContent:{"h1 h2 h3 h4 h5 h6 table ul ol blockquote div tr p div li td":{propertiesOnly:!0,attributes:"dir"}},requiredContent:"p[dir]",refresh:function(a,b){var c=a.config.useComputedState,d,c=void 0===c||c;if(!c){d=
b.lastElement;for(var e=a.editable();d&&!(d.getName()in g||d.equals(e));){var f=d.getParent();if(!f)break;d=f}}d=d||b.block||b.blockLimit;d.equals(a.editable())&&(e=a.getSelection().getRanges()[0].getEnclosedNode())&&e.type==POLARIS.NODE_ELEMENT&&(d=e);d&&(c=c?d.getComputedStyle("direction"):d.getStyle("direction")||d.getAttribute("dir"),a.getCommand("bidirtl").setState("rtl"==c?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF),a.getCommand("bidiltr").setState("ltr"==c?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF));
c=(b.block||b.blockLimit||a.editable()).getDirection(1);c!=(a._.selDir||a.lang.dir)&&(a._.selDir=c,a.fire("contentDirChanged",c))},exec:function(c){var f=c.getSelection(),g=c.config.enterMode,k=f.getRanges();if(k&&k.length){for(var l={},t=f.createBookmarks(),k=k.createIterator(),w,A=0;w=k.getNextRange(1);){var x=w.getEnclosedNode();x&&(!x||x.type==POLARIS.NODE_ELEMENT&&x.getName()in h)||(x=e(w,d,g));x&&a(x,b,c,l);var C=new POLARIS.dom.walker(w),u=t[A].startNode,B=t[A++].endNode;C.evaluator=function(a){var b=
g==POLARIS.ENTER_P?"p":"div",c;if(c=(a?a.type==POLARIS.NODE_ELEMENT:!1)&&a.getName()in d){if(b=a.is(b))b=(b=a.getParent())?b.type==POLARIS.NODE_ELEMENT:!1;c=!(b&&a.getParent().is("blockquote"))}return!!(c&&a.getPosition(u)&POLARIS.POSITION_FOLLOWING&&(a.getPosition(B)&POLARIS.POSITION_PRECEDING+POLARIS.POSITION_CONTAINS)==POLARIS.POSITION_PRECEDING)};for(;x=C.next();)a(x,b,c,l);w=w.createIterator();for(w.enlargeBr=g!=POLARIS.ENTER_BR;x=w.getNextParagraph(g==POLARIS.ENTER_P?"p":"div");)a(x,b,c,l)}POLARIS.dom.element.clearAllMarkers(l);
c.forceNextSelectionCheck();f.selectBookmarks(t);c.focus()}}}}function c(a){var b=a==k.setAttribute,c=a==k.removeAttribute,d=/\bdirection\s*:\s*(.*?)\s*(:?$|;)/;return function(e,f){var g;if(g=e==(b||c?"dir":"direction")||"style"==e&&(c||d.test(f))){a:{g=this;for(var h=g.getDocument().getBody().getParent();g;){if(g.equals(h)){g=!1;break a}g=g.getParent()}g=!0}g=!g}return g&&!this.isReadOnly()&&(g=this.getDirection(1),h=a.apply(this,arguments),g!=this.getDirection(1))?(this.getDocument().fire("dirChanged",
this),h):a.apply(this,arguments)}}var d={table:1,ul:1,ol:1,blockquote:1,div:1},h={},g={};POLARIS.tools.extend(h,d,{tr:1,p:1,div:1,li:1});POLARIS.tools.extend(g,h,{td:1});POLARIS.plugins.add("bidi",{init:function(a){function c(b,d,e,f,g){a.addCommand(e,new POLARIS.command(a,f));a.ui.addButton&&a.ui.addButton(b,{label:d,command:e,toolbar:"bidi,"+g})}if(!a.config.wordprocessor&&!a.blockless){var d=a.lang.bidi;c("BidiLtr",d.ltr,"bidiltr",b("ltr"),10);c("BidiRtl",d.rtl,"bidirtl",b("rtl"),20);a.on("contentDom",
function(){a.document.on("dirChanged",function(b){a.fire("dirChanged",{node:b.data,dir:b.data.getDirection(1)})})});a.on("contentDirChanged",function(b){b=(a.lang.dir!=b.data?"add":"remove")+"Class";var c=a.ui.space(a.config.toolbarLocation);if(c)c[b]("polaris_mixed_dir_content")})}}});for(var k=POLARIS.dom.element.prototype,f=["setStyle","removeStyle","setAttribute","removeAttribute"],l=0;l<f.length;l++)k[f[l]]=POLARIS.tools.override(k[f[l]],c)})();POLARIS.plugins.add("bgimage",{requires:"dialog",
init:function(a){if(!a.config.wordprocessor){var e=new POLARIS.dialogCommand("bgImage");e.requiredContent="body";a.addCommand("bgImage",e);POLARIS.dialog.add("bgImage",this.path+"dialogs/bgimage.js");a.ui.addButton&&a.ui.addButton("bgImage",{label:a.lang.bgimage.label,command:"bgImage",toolbar:"document,30"})}}});(function(){var a={exec:function(a){var b=a.getCommand("blockquote").state,c=a.getSelection(),d=c&&c.getRanges()[0];if(d){var h=c.createBookmarks();if(POLARIS.env.ie){var g=h[0].startNode,
k=h[0].endNode,f;if(g&&"blockquote"==g.getParent().getName())for(f=g;f=f.getNext();)if(f.type==POLARIS.NODE_ELEMENT&&f.isBlockBoundary()){g.move(f,!0);break}if(k&&"blockquote"==k.getParent().getName())for(f=k;f=f.getPrevious();)if(f.type==POLARIS.NODE_ELEMENT&&f.isBlockBoundary()){k.move(f);break}}var l=d.createIterator();l.enlargeBr=a.config.enterMode!=POLARIS.ENTER_BR;if(b==POLARIS.TRISTATE_OFF){for(g=[];b=l.getNextParagraph();)g.push(b);1>g.length&&(b=a.document.createElement(a.config.enterMode==
POLARIS.ENTER_P?"p":"div"),k=h.shift(),d.insertNode(b),b.append(new POLARIS.dom.text("﻿",a.document)),d.moveToBookmark(k),d.selectNodeContents(b),d.collapse(!0),k=d.createBookmark(),g.push(b),h.unshift(k));f=g[0].getParent();d=[];for(k=0;k<g.length;k++)b=g[k],f=f.getCommonAncestor(b.getParent());for(b={table:1,tbody:1,tr:1,ol:1,ul:1};b[f.getName()];)f=f.getParent();for(k=null;0<g.length;){for(b=g.shift();!b.getParent().equals(f);)b=b.getParent();b.equals(k)||d.push(b);k=b}for(;0<d.length;)if(b=d.shift(),
"blockquote"==b.getName()){for(k=new POLARIS.dom.documentFragment(a.document);b.getFirst();)k.append(b.getFirst().remove()),g.push(k.getLast());k.replace(b)}else g.push(b);d=a.document.createElement("blockquote");for(d.insertBefore(g[0]);0<g.length;)b=g.shift(),d.append(b)}else if(b==POLARIS.TRISTATE_ON){k=[];for(f={};b=l.getNextParagraph();){for(g=d=null;b.getParent();){if("blockquote"==b.getParent().getName()){d=b.getParent();g=b;break}b=b.getParent()}d&&g&&!g.getCustomData("blockquote_moveout")&&
(k.push(g),POLARIS.dom.element.setMarker(f,g,"blockquote_moveout",!0))}POLARIS.dom.element.clearAllMarkers(f);b=[];g=[];for(f={};0<k.length;)l=k.shift(),d=l.getParent(),l.getPrevious()?l.getNext()?(l.breakParent(l.getParent()),g.push(l.getNext())):l.remove().insertAfter(d):l.remove().insertBefore(d),d.getCustomData("blockquote_processed")||(g.push(d),POLARIS.dom.element.setMarker(f,d,"blockquote_processed",!0)),b.push(l);POLARIS.dom.element.clearAllMarkers(f);for(k=g.length-1;0<=k;k--){d=g[k];a:{f=
d;for(var l=0,m=f.getChildCount(),n=void 0;l<m&&(n=f.getChild(l));l++)if(n.type==POLARIS.NODE_ELEMENT&&n.isBlockBoundary()){f=!1;break a}f=!0}f&&d.remove()}if(a.config.enterMode==POLARIS.ENTER_BR)for(d=!0;b.length;)if(l=b.shift(),"div"==l.getName()){k=new POLARIS.dom.documentFragment(a.document);!d||!l.getPrevious()||l.getPrevious().type==POLARIS.NODE_ELEMENT&&l.getPrevious().isBlockBoundary()||k.append(a.document.createElement("br"));for(d=l.getNext()&&!(l.getNext().type==POLARIS.NODE_ELEMENT&&l.getNext().isBlockBoundary());l.getFirst();)l.getFirst().remove().appendTo(k);
d&&k.append(a.document.createElement("br"));k.replace(l);d=!1}}c.selectBookmarks(h);a.focus()}},refresh:function(a,b){this.setState(a.elementPath(b.block||b.blockLimit).contains("blockquote",1)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"};POLARIS.plugins.add("blockquote",{init:function(e){e.config.wordprocessor||e.blockless||(e.addCommand("blockquote",a),e.ui.addButton&&e.ui.addButton("Blockquote",{label:e.lang.blockquote.toolbar,
command:"blockquote",toolbar:"blocks,10"}))}})})();(function(){var a='\x3ca id\x3d"{id}" class\x3d"polaris{buttonType}_button polaris_button__{name} polaris_button_{state} {cls}"'+(POLARIS.env.gecko&&!POLARIS.env.hc?"":" href\x3d\"javascript:void('{titleJs}')\"")+' title\x3d"{title}" tabindex\x3d"-1" hidefocus\x3d"true" role\x3d"button" draggable\x3d"false" aria-labelledby\x3d"{id}_label" aria-haspopup\x3d"{hasArrow}" aria-disabled\x3d"{ariaDisabled}"';POLARIS.env.gecko&&POLARIS.env.mac&&(a+=' onkeypress\x3d"return false;"');
POLARIS.env.gecko&&(a+=' onblur\x3d"this.style.cssText \x3d this.style.cssText;"');var a=a+(' onkeydown\x3d"return POLARIS.tools.callFunction({keydownFn},event);" onfocus\x3d"return POLARIS.tools.callFunction({focusFn},event);" '+(POLARIS.env.ie?'onclick\x3d"return false;" onmouseup':"onclick")+'\x3d"POLARIS.tools.callFunction({clickFn},this);return false;"\x3e\x3cspan class\x3d"polaris_button_icon polaris_button__{iconName}_icon {iconSize}" style\x3d"{style}"'),a=a+'\x3e\x26nbsp;\x3c/span\x3e\x3cspan id\x3d"{id}_label" class\x3d"polaris_button_label polaris_button__{name}_label {labelPos}" aria-hidden\x3d"false"\x3e{label}\x3c/span\x3e{arrowHtml}\x3c/a\x3e',
e='\x3cspan class\x3d"polaris_button_arrow_bottom"\x3e'+(POLARIS.env.hc?"\x26#9660;":"")+"\x3c/span\x3e",b=POLARIS.addTemplate("buttonArrow",'\x3cspan class\x3d"polaris_button_arrow"\x3e'+(POLARIS.env.hc?"\x26#9660;":"")+"\x3c/span\x3e"),c=POLARIS.addTemplate("buttonArrowBottom",e);btnTpl=POLARIS.addTemplate("button",a);POLARIS.plugins.add("button",{beforeInit:function(a){a.ui.addHandler(POLARIS.UI_BUTTON,POLARIS.ui.button.handler)}});POLARIS.UI_BUTTON="button";POLARIS.ui.button=function(a){POLARIS.tools.extend(this,
a,{title:a.label,click:a.click||function(b){b.execCommand(a.command)}});this._={}};POLARIS.ui.button.handler={create:function(a){return new POLARIS.ui.button(a)}};POLARIS.ui.button.prototype={render:function(a,e){function g(){var b=a.mode;b&&(b=this.modes[b]?void 0!==t[b]?t[b]:POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,b=a.readOnly&&!this.readOnly?POLARIS.TRISTATE_DISABLED:b,this.setState(b),this.refresh&&this.refresh())}var k=POLARIS.env,f=this._.id=POLARIS.tools.getNextId(),l="",m=this.command,
n;this._.editor=a;var q={id:f,button:this,editor:a,focus:function(){POLARIS.document.getById(f).focus()},execute:function(){this.button.click(a)},attach:function(a){this.button.attach(a)}},v=q.keydownFn=POLARIS.tools.addFunction(function(a){if(q.onkey)return a=new POLARIS.dom.event(a),!1!==q.onkey(q,a.getKeystroke())}),r=q.focusFn=POLARIS.tools.addFunction(function(a){var b;q.onfocus&&(b=!1!==q.onfocus(q,new POLARIS.dom.event(a)));return b}),p=0;q.clickFn=n=POLARIS.tools.addFunction(function(){p&&
(a.unlockSelection(1),p=0);q.execute();k.iOS&&a.focus()});if(this.modes){var t={};a.on("beforeModeUnload",function(){a.mode&&this._.state!=POLARIS.TRISTATE_DISABLED&&(t[a.mode]=this._.state)},this);a.on("activeFilterChange",g,this);a.on("mode",g,this);!this.readOnly&&a.on("readOnly",g,this)}m&&(!this.modes||this.useCommandState)&&(m=a.getCommand(m))&&(m.on("state",function(){this.setState(m.state)},this),l+=m.state==POLARIS.TRISTATE_ON?"on":m.state==POLARIS.TRISTATE_DISABLED?"disabled":"off");if(this.directional)a.on("contentDirChanged",
function(b){var c=POLARIS.document.getById(this._.id),e=c.getFirst();b=b.data;b!=a.lang.dir?c.addClass("polaris_"+b):c.removeClass("polaris_ltr").removeClass("polaris_rtl");e.setAttribute("style",POLARIS.skin.getIconStyle(A,"rtl"==b,this.icon,this.iconOffset))},this);m||(l+="off");var w=this.name||this.command,A=w;this.icon&&!/\./.test(this.icon)&&(A=this.icon,this.icon=null);"bottom"==this.showLabel?(this.className=this.className?this.className+" polaris_button_size_label_bottom":"polaris_button_size_label_bottom",
A="ribbon_big_ico_"+A):"inline"==this.showLabel&&(this.className=this.className?this.className+" polaris_button_size_label_inline":"polaris_button_size_label_inline");var x="";this.hasArrow&&(x="bottom"==this.showLabel?c.output():b.output());"bottom"==this.showLabel&&(this.overrideSize="32px");"bottom"==this.showLabel&&(this.iconSize="polaris_button_icon_large");"bottom"==this.showLabel?this.labelPos="polaris_button_label_bottom":"inline"==this.showLabel&&(this.labelPos="polaris_button_label_inline");
l={id:f,name:w,iconName:A,buttonType:"",label:this.label,cls:this.className||"",state:l,ariaDisabled:"disabled"==l?"true":"false",title:this.title,titleJs:k.gecko&&!k.hc?"":(this.title||"").replace("'",""),hasArrow:this.hasArrow?"true":"false",keydownFn:v,focusFn:r,clickFn:n,style:POLARIS.skin.getIconStyle(A,"rtl"==a.lang.dir,this.icon,this.iconOffset,this.overrideSize),iconSize:this.iconSize,labelPos:this.labelPos,arrowHtml:x};btnTpl.output(l,e);if(this.onRender)this.onRender();return q},setState:function(a){if(this._.state==
a)return!1;this._.state=a;var b=POLARIS.document.getById(this._.id);return b?(b.setState(a,"polaris_button"),a==POLARIS.TRISTATE_DISABLED?b.setAttribute("aria-disabled",!0):b.removeAttribute("aria-disabled"),this.hasArrow?(a=a==POLARIS.TRISTATE_ON?this._.editor.lang.button.selectedLabel.replace(/%1/g,this.label):this.label,POLARIS.document.getById(this._.id+"_label").setText(a)):a==POLARIS.TRISTATE_ON?b.setAttribute("aria-pressed",!0):b.removeAttribute("aria-pressed"),!0):!1},getState:function(){return this._.state},
toFeature:function(a){if(this._.feature)return this._.feature;var b=this;this.allowedContent||this.requiredContent||!this.command||(b=a.getCommand(this.command)||b);return this._.feature=b}};POLARIS.ui.prototype.addButton=function(a,b){this.add(a,POLARIS.UI_BUTTON,b)}})();(function(){var a=function(a){a=a.editor;selection=a.getSelection();startElement=selection.getStartElement();for(var b=a.document.find("article[doc-data-field]"),c=0;c<b.count();c++){var d=b.getItem(c);d.removeClass("polarisClickHere")}if((b=
startElement&&startElement.getAscendant("article",!0))&&b.hasAttribute("doc-data-field"))for(var h=b.getAttribute("polaris-splitted"),b=a.document.find("article[doc-data-field]"),c=0;c<b.count();c++)d=b.getItem(c),d.getAttribute("polaris-splitted")==h&&d.addClass("polarisClickHere")};POLARIS.plugins.add("clickhere",{lang:"en,ko",icons:"clickhere",hidpi:!0,init:function(e){e.ui.addButton&&e.ui.addButton("ClickHere",{label:e.lang.clickhere.label,command:"clickheredialog",toolbar:"clickhere,15"});POLARIS.dialog.add("clickheredialog",
this.path+"dialogs/clickhere.js");e.addCommand("clickheredialog",new POLARIS.dialogCommand("clickheredialog"));e.on("selectionChange",a)}})})();"use strict";(function(){function a(a){function b(){var c=a.editable();c.on(E,function(a){POLARIS.env.ie&&G||C(a)});if(POLARIS.env.ie)c.on("paste",function(b){y||(q(),b.data.preventDefault(),C(b),r("paste")||a.openDialog("paste"))});POLARIS.env.ie&&(c.on("contextmenu",v,null,null,0),c.on("beforepaste",function(a){!a.data||a.data.$.ctrlKey||a.data.$.shiftKey||
v()},null,null,0));c.on("beforecut",function(){!G&&t(a)});var d;c.attachListener(POLARIS.env.ie?c:a.document.getDocumentElement(),"mouseup",function(){d=setTimeout(function(){u()},0)});a.on("destroy",function(){clearTimeout(d)});c.on("keyup",u)}function c(a){return{type:a,canUndo:"cut"==a,startDisabled:!0,exec:function(a){"cut"==this.type&&t();var b=function(b){var c=a.getSelection(),c=POLARIS.plugins.tabletools.getSelectedCells(c);if(POLARIS.plugins.tabletools.hasSelectedCell(c))return POLARIS.plugins.tabletools.copyCustomDataToClipboard(a,
"cut"==b),!0;if(POLARIS.env.ie)return r(b);try{return a.document.$.execCommand(b,!1,null)}catch(d){return!1}}(this.type);b||alert(a.lang.clipboard[this.type+"Error"]);return b}}}function d(){return{canUndo:!1,async:!0,exec:function(a,b){var c=function(b,c){b&&p(b.type,b.dataValue,!!c);a.fire("afterCommandExec",{name:"paste",command:d,returnValue:!!b})},d=this;"string"==typeof b?c({type:"auto",dataValue:b},1):a.getClipboardData(c)}}}function e(){return{canUndo:!1,async:!0,exec:function(a,b){}}}function h(){return{canUndo:!0,
async:!0,startDisabled:!0,exec:function(a,b){var c=a.getSelection(),d=c.getRanges(),e=c.getType()==POLARIS.SELECTION_NONE||1==d.length&&d[0].collapsed;if(d[0]){if(!e){if(POLARIS.env.webkit&&(e=d[0].cloneContents(),d=e.getFirst(),e=e.getLast(),d.$==e.$&&d.is)){if(d.is("br"))return;d.is("img")&&(d=a.createRange(),d.selectNodeContents(c.getSelectedElement()),d.select())}a.fire("saveSnapshot");d=!1;(c=c.getSelectedElement())&&"img"==c.getName()&&(c=c.getAscendant("figure"))&&(c.remove(),d=!0);d||(a.document.$.execCommand("Delete",
!1),(d=a.elementPath())&&(c=d.elements[0])&&c.is("li")&&""===c.getText().trim()&&!c.getNext()&&!c.getPrevious()&&(c=d.elements[1])&&(c.is("ol")||c.is("ul"))&&(c.getNext()||(d=d.elements[2],d.is("td")?d.appendBogus():(d=a.document.createElement("p"),d.appendBogus(),d.insertAfter(c))),c.remove()),POLARIS.plugins.objectresize.detach(a),a.fire("change"),a.fire("contentChange",{type:"cut"}));POLARIS.tools.setTimeout(function(){a.getSelection().scrollIntoView()},0,this)}u()}}}}function q(){y=1;setTimeout(function(){y=
0},100)}function v(){G=1;setTimeout(function(){G=0},10)}function r(b){var c=a.document,d=c.getBody(),e=!1,f=function(){e=!0};d.on(b,f);(7<POLARIS.env.version?c.$:c.$.selection.createRange()).execCommand(b);d.removeListener(b,f);return e}function p(b,c,d,e,f){b={type:b};if(d&&!1===a.fire("beforePaste",b)||!c)return!1;b.dataValue=c;b.fromMSOffice=f;return a.fire("paste",b)}function t(){if(POLARIS.env.ie&&!POLARIS.env.quirks){var b=a.getSelection(),c,d,e;b.getType()==POLARIS.SELECTION_ELEMENT&&(c=b.getSelectedElement())&&
(d=b.getRanges()[0],e=a.document.createText(""),e.insertBefore(c),d.setStartBefore(e),d.setEndAfter(c),b.selectRanges([d]),setTimeout(function(){c.getParent()&&(e.remove(),b.selectElement(c))},0))}}function w(b,c){if(POLARIS.env.chrome){b.data.preventDefault();var d=b.data.$.clipboardData.getData("text/html"),e=a.getSelection(),f=e&&e.getStartElement(),h,e=0<=d.indexOf('xmlns:o\x3d"urn:schemas-microsoft-com:office:office"');h=d.lastIndexOf("\x3c/html\x3e");-1!==h&&(d=d.substring(0,h));d&&(d=H(d));
!d&&(h=b.data.$.clipboardData.getData("text"))&&(d=f&&f.hasAscendant("pre",!0)?POLARIS.ENTER_BR:a.activeEnterMode,d=POLARIS.tools.transformPlainTextToHtml(h,d));d=d.replace(/(^\s*)|(\s*$)/g,"");return c(d,e)}var e=a.document,k=a.editable(),l=function(a){a.cancel()},m;if(!e.getById("polaris_pastebin")){var n=a.getSelection(),r=n.createBookmarks();POLARIS.env.ie&&n.root.fire("selectionchange");var q=new POLARIS.dom.element(!POLARIS.env.webkit&&!k.is("body")||POLARIS.env.ie?"div":"body",e);q.setAttributes({id:"polaris_pastebin",
"data-polaris-temp":"1"});d=0;e=e.getWindow();POLARIS.env.webkit?(k.append(q),q.addClass("polaris_editable"),k.is("body")||(d="static"!=k.getComputedStyle("position")?k:POLARIS.dom.element.get(k.$.offsetParent),d=d.getDocumentPosition().y)):k.getAscendant(POLARIS.env.ie?"body":"html",1).append(q);q.setStyles({position:"absolute",top:e.getScrollPosition().y-d+10+"px",width:"1px",height:Math.max(1,e.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0});POLARIS.env.safari&&q.setStyles(POLARIS.tools.cssVendorPrefix("user-select",
"text"));(d=q.getParent().isReadOnly())?(q.setOpacity(0),q.setAttribute("contenteditable",!0)):q.setStyle("ltr"==a.config.contentsLangDirection?"left":"right","-1000px");a.on("selectionChange",l,null,null,0);if(POLARIS.env.webkit||POLARIS.env.gecko)m=k.once("blur",l,null,null,-100);d&&q.focus();d=new POLARIS.dom.range(q);d.selectNodeContents(q);var w=d.select();POLARIS.env.ie&&(m=k.once("blur",function(){a.lockSelection(w)}));var x=POLARIS.document.getWindow().getScrollPosition().y;setTimeout(function(){POLARIS.env.webkit&&
(POLARIS.document.getBody().$.scrollTop=x);m&&m.removeListener();POLARIS.env.ie&&k.focus();n.selectBookmarks(r);q.remove();var b;POLARIS.env.webkit&&(b=q.getFirst())&&b.is&&b.hasClass("Apple-style-span")&&(q=b);a.removeListener("selectionChange",l);c(q.getHtml())},0)}}function A(){if(POLARIS.env.ie){a.focus();q();var b=a.focusManager;b.lock();if(a.editable().fire(E)&&!r("paste"))return b.unlock(),!1;b.unlock()}else try{if(a.editable().fire(E)&&!a.document.$.execCommand("Paste",!1,null))throw 0;}catch(c){return!1}return!0}
function x(b){if("wysiwyg"==a.mode)switch(b.data.keyCode){case POLARIS.CTRL+86:case POLARIS.SHIFT+45:b=a.editable();q();POLARIS.env.ie||b.fire("beforepaste");break;case POLARIS.CTRL+88:case POLARIS.SHIFT+46:a.fire("saveSnapshot"),setTimeout(function(){a.fire("saveSnapshot");a.fire("contentChange",{type:"cut"})},50)}}function C(b){var c={type:"auto"},d=a.fire("beforePaste",c);w(b,function(a,b){a=a.replace(/<span[^>]+data-polaris-bookmark[^<]*?<\/span>/ig,"");d&&p(c.type,a,0,1,b)})}function u(){if("wysiwyg"==
a.mode){var b=B("paste");a.getCommand("cut").setState(B("cut"));a.getCommand("copy").setState(B("copy"));a.getCommand("delete").setState(B("delete"));a.getCommand("paste").setState(b);a.fire("pasteState",b)}}function B(b){if(F&&b in{paste:1,cut:1,"delete":1})return POLARIS.TRISTATE_DISABLED;if("paste"==b)return POLARIS.TRISTATE_OFF;var c=a.getSelection(),d=c.getRanges();(d=c.getType()==POLARIS.SELECTION_NONE||1==d.length&&d[0].collapsed)&&"delete"!=b&&(b=POLARIS.plugins.tabletools.getSelectedCells(c),
d=POLARIS.plugins.tabletools.hasSelectedCell(b)?!1:!0);return d?POLARIS.TRISTATE_DISABLED:POLARIS.TRISTATE_OFF}var G=0,y=0,F=0,E=POLARIS.env.ie?"beforepaste":"paste";(function(){a.on("key",x);a.on("contentDom",b);a.on("selectionChange",function(a){a.data.selection.getRanges()[0]&&(F=a.data.selection.getRanges()[0].checkReadOnly(),u())});a.contextMenu&&a.contextMenu.addListener(function(a,b){if(b){var c=b.getRanges()[0];if(c)return F=c.checkReadOnly(),{cut:B("cut"),copy:B("copy"),paste:B("paste"),
"delete":B("delete")}}})})();(function(){function b(c,d,e,f,h){var k=a.lang.clipboard[d];a.addCommand(d,e);a.ui.addButton&&a.ui.addButton(c,{label:k,command:d,toolbar:"clipboard,"+f});a.addMenuItems&&a.addMenuItem(d,{label:k,command:d,group:"clipboard",order:h})}b("Cut","cut",c("cut"),10,1);b("Copy","copy",c("copy"),20,4);b("Paste","paste",d(),30,8);b("CopyFormat","copyformat",e(),40,12);b("Delete","delete",h(),50,13)})();a.addCommand("pasteOption",{});a.addMenuGroup("dropdownPasteOption");a.addMenuItems({paste_all:{label:a.lang.clipboard.paste,
group:"dropdownPasteOption",command:"paste"},paste_text:{label:a.lang.pastetext.title,group:"dropdownPasteOption",command:"pastetext"},paste_word:{label:a.lang.pastefromword.toolbar,group:"dropdownPasteOption",command:"pastefromword"}});a.ui.add&&a.ui.add("PasteOption",POLARIS.UI_MENUBUTTON,{title:a.lang.clipboard.paste,label:a.lang.clipboard.paste,command:"pasteOption",toolbar:"clipboard,100",onMenu:function(){return{paste_all:POLARIS.TRISTATE_OFF,paste_text:POLARIS.TRISTATE_OFF,paste_word:POLARIS.TRISTATE_OFF}}});
a.getClipboardData=function(b,c){function d(a){a.removeListener();a.cancel();c(a.data)}function e(a){a.removeListener();a.cancel();l=!0;c({type:k,dataValue:a.data})}function f(){this.customTitle=b&&b.title}var h=!1,k="auto",l=!1;c||(c=b,b=null);a.on("paste",d,null,null,0);a.on("beforePaste",function(a){a.removeListener();h=!0;k=a.data.type},null,null,1E3);!1===A()&&(a.removeListener("paste",d),h&&a.fire("pasteDialog",f)?(a.on("pasteDialogCommit",e),a.on("dialogHide",function(a){a.removeListener();
a.data.removeListener("pasteDialogCommit",e);setTimeout(function(){l||c(null)},10)})):c(null))};var H=function(a,b){function c(a,b){if(a)for(var d=0,e=a.length;d<e;d++)b(a[d],d)}function d(a){c(a.styleSheets,function(b){c(b.rules||b.cssRules,function(b){try{c(a.querySelectorAll(b.selectorText),function(a){a.style.cssText+=b.style.cssText})}catch(d){}})})}var e=b.createElement("iframe");e.style.position="absolute";e.style.left="-1000px";e.style.top="-1000px";b.body.appendChild(e);return function(a){e.contentWindow.location.reload("");
var c=e.contentWindow.document;c.head.innerHTML="";c.body.innerHTML="";c.write(a);e.contentWindow.location.reload("");d(c);if(null===c.body){c=a.substring(a.toLowerCase().indexOf("\x3cbody"),a.toLowerCase().indexOf("\x3c/body\x3e")+7);a=b.createElement("iframe");b.body.appendChild(a);var f=a.contentWindow.document;f.write("\x3chtml\x3e"+c+"\x3c/html\x3e");c=f.body.innerHTML;b.body.removeChild(a);b.body.removeChild(e);return c}return c=c.body.innerHTML}}(window,document)}function e(a){if(POLARIS.env.webkit){if(!a.match(/^[^<]*$/g)&&
!a.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(POLARIS.env.ie){if(!a.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!a.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else if(POLARIS.env.gecko){if(!a.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}else return"html";return"htmlifiedtext"}function b(a,b){function c(a){return POLARIS.tools.repeat("\x3c/p\x3e\x3cp\x3e",~~(a/2))+(1==a%2?"\x3cbr\x3e":"")}b=b.replace(/\s+/g," ").replace(/> +</g,"\x3e\x3c").replace(/<br ?\/>/gi,
"\x3cbr\x3e");b=b.replace(/<\/?[A-Z]+>/g,function(a){return a.toLowerCase()});if(b.match(/^[^<]$/))return b;POLARIS.env.webkit&&-1<b.indexOf("\x3cdiv\x3e")&&(b=b.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"\x3cbr\x3e").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"\x3cdiv\x3e\x3c/div\x3e"),b.match(/<div>(<br>|)<\/div>/)&&(b="\x3cp\x3e"+b.replace(/(<div>(<br>|)<\/div>)+/g,function(a){return c(a.split("\x3c/div\x3e\x3cdiv\x3e").length+1)})+"\x3c/p\x3e"),b=b.replace(/<\/div><div>/g,"\x3cbr\x3e"),
b=b.replace(/<\/?div>/g,""));POLARIS.env.gecko&&a.enterMode!=POLARIS.ENTER_BR&&(POLARIS.env.gecko&&(b=b.replace(/^<br><br>$/,"\x3cbr\x3e")),-1<b.indexOf("\x3cbr\x3e\x3cbr\x3e")&&(b="\x3cp\x3e"+b.replace(/(<br>){2,}/g,function(a){return c(a.length/4)})+"\x3c/p\x3e"));return h(a,b)}function c(){var a=new POLARIS.htmlParser.filter,b={blockquote:1,dl:1,fieldset:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ol:1,p:1,table:1,ul:1},c=POLARIS.tools.extend({br:0},POLARIS.dtd.$inline),d={p:1,br:1,"polaris:br":1},e=POLARIS.dtd,
h=POLARIS.tools.extend({area:1,basefont:1,embed:1,iframe:1,map:1,object:1,param:1},POLARIS.dtd.$nonBodyContent,POLARIS.dtd.$cdata),q=function(a){delete a.name;a.add(new POLARIS.htmlParser.text(" "))},v=function(a){for(var b=a,c;(b=b.next)&&b.name&&b.name.match(/^h\d$/);)for(c=new POLARIS.htmlParser.element("polaris:br"),c.isEmpty=!0,a.add(c);c=b.children.shift();)a.add(c)};a.addRules({elements:{h1:v,h2:v,h3:v,h4:v,h5:v,h6:v,img:function(a){a=POLARIS.tools.trim(a.attributes.alt||"");var b=" ";a&&!a.match(/(^http|\.(jpe?g|gif|png))/i)&&
(b=" ["+a+"] ");return new POLARIS.htmlParser.text(b)},input:function(a){if(a.attributes.alt){a=POLARIS.tools.trim(a.attributes.alt||"");var b=" ";a&&!a.match(/(^http|\.(jpe?g|gif|png))/i)&&(b=" ["+a+"] ");return new POLARIS.htmlParser.text(b)}},td:q,th:q,$:function(a){var g=a.name,q;if(h[g])return!1;a.attributes={};if("br"==g)return a;if(b[g])a.name="p";else if(c[g])delete a.name;else if(e[g]){q=new POLARIS.htmlParser.element("polaris:br");q.isEmpty=!0;if(POLARIS.dtd.$empty[g])return q;a.add(q,0);
q=q.clone();q.isEmpty=!0;a.add(q);delete a.name}d[a.name]||delete a.name;return a}}},{applyToAll:!0});return a}function d(a,b,c){b=new POLARIS.htmlParser.fragment.fromHtml(b);var d=new POLARIS.htmlParser.basicWriter;b.writeHtml(d,c);b=d.getHtml();b=b.replace(/\s*(<\/?[a-z:]+ ?\/?>)\s*/g,"$1").replace(/(<polaris:br \/>){2,}/g,"\x3cpolaris:br /\x3e").replace(/(<polaris:br \/>)(<\/?p>|<br \/>)/g,"$2").replace(/(<\/?p>|<br \/>)(<polaris:br \/>)/g,"$1").replace(/<(polaris:)?br( \/)?>/g,"\x3cbr\x3e").replace(/<p><\/p>/g,
"");var e=0;b=b.replace(/<\/?p>/g,function(a){if("\x3cp\x3e"==a){if(1<++e)return"\x3c/p\x3e\x3cp\x3e"}else if(0<--e)return"\x3c/p\x3e\x3cp\x3e";return a}).replace(/<p><\/p>/g,"");return h(a,b)}function h(a,b){a.enterMode==POLARIS.ENTER_BR?b=b.replace(/(<\/p><p>)+/g,function(a){return POLARIS.tools.repeat("\x3cbr\x3e",a.length/7*2)}).replace(/<\/?p>/g,""):a.enterMode==POLARIS.ENTER_DIV&&(b=b.replace(/<(\/)?p>/g,"\x3c$1div\x3e"));return b}POLARIS.plugins.add("clipboard",{requires:"dialog",init:function(g){var h;
a(g);POLARIS.dialog.add("paste",POLARIS.getUrl(this.path+"dialogs/paste.js"));POLARIS.dialog.add("imageCopy",POLARIS.getUrl(this.path+"dialogs/imageCopy.js"));g.on("paste",function(a){var b=a.data.dataValue,c=POLARIS.dtd.$block;-1<b.indexOf("Apple-")&&(b=b.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=a.data.type&&(b=b.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(a,b){return b.replace(/\t/g,"\x26nbsp;\x26nbsp; \x26nbsp;")})),-1<b.indexOf('\x3cbr class\x3d"Apple-interchange-newline"\x3e')&&
(a.data.startsWithEOL=1,a.data.preSniffing="html",b=b.replace(/<br class="Apple-interchange-newline">/,"")),b=b.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1"));if(b.match(/^<[^<]+polaris_(editable|contents)/i)){var d,e,g=new POLARIS.dom.element("div");for(g.setHtml(b);1==g.getChildCount()&&(d=g.getFirst())&&d.type==POLARIS.NODE_ELEMENT&&(d.hasClass("polaris_editable")||d.hasClass("polaris_contents"));)g=e=d;e&&(b=e.getHtml().replace(/<br>$/i,""))}POLARIS.env.ie?b=b.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,
function(b,d){return d.toLowerCase()in c?(a.data.preSniffing="html","\x3c"+d):b}):POLARIS.env.webkit?b=b.replace(/<\/(\w+)><div><br><\/div>$/,function(b,d){return d in c?(a.data.endsWithEOL=1,"\x3c/"+d+"\x3e"):b}):POLARIS.env.gecko&&(b=b.replace(/(\s)<br>$/,"$1"));a.data.dataValue=b},null,null,3);g.on("paste",function(a){a=a.data;var l=a.type,m=a.dataValue,n,q=g.config.clipboard_defaultContentType||"html";n="html"==l||"html"==a.preSniffing?"html":e(m);var v=/<([a-z]+)(?=[\s>])(?:[^>=]|='[^']*'|="[^"]*"|=[^'"\s]*)*\s?\/?>/gi,
r,p,t;if(RegExp.prototype.test.bind(v)(m)){if(v=m.match(v),r=m.split(/<br.*?>/gi),v.length==r.length-1){p="";m=0;for(v=r.length;m<v;m++)p+="\x3cp\x3e"+r[m]+"\x3c/p\x3e";m=p}}else{r=m.split("\r\n");p="";m=0;for(v=r.length;m<v;m++)p+="\x3cp\x3e"+r[m]+"\x3c/p\x3e";m=p}"htmlifiedtext"==n?m=b(g.config,m):"text"==l&&"html"==n&&(m=d(g.config,m,h||(h=c(g))));a.startsWithEOL&&(m='\x3cbr data-polaris-eol\x3d"1"\x3e'+m);a.endsWithEOL&&(m+='\x3cbr data-polaris-eol\x3d"1"\x3e');"auto"==l&&(l="html"==n||"html"==
q?"html":"text");if("html"==l){n=document.createElement("div");n.innerHTML=m;q=n.querySelectorAll("*");if(-1<m.indexOf("polaris-page-body")){m=0;for(v=q.length;m<v;m++)if(r=q[m],("DIV"==r.nodeName||"div"==r.nodeName)&&r.getAttribute("doc-data-role")&&"polaris-page-body"==r.getAttribute("doc-data-role")){n.innerHTML=r.innerHTML;break}q=n.querySelectorAll("*")}m=0;for(v=q.length;m<v;m++)if(r=q[m],"ARTICLE"==r.tagName||"article"==r.tagName)r.outerHTML=r.innerHTML;else if(p=r.style.cssText,"TABLE"!=r.nodeName&&
"table"!=r.nodeName||"removable-pubdocbody"!=r.getAttribute("doc-data-role")||r.parentNode.removeChild(r),r.style.cssText){if("p"==r.nodeName.toLowerCase()){""!=r.style.wordBreak&&r.style.removeProperty("word-break");if(""!=r.style.fontWeight&&0<r.childElementCount){t=parseInt(r.style.fontWeight);p="";if(0<t&&400<t||"bold"==r.style.fontWeight)p="bold";for(t=0;t<r.childElementCount;t++)"span"==r.childNodes[t].nodeName.toLowerCase()&&"bold"==p&&(r.childNodes[t].style.fontWeight=p);r.style.removeProperty("font-weight")}""!=
r.style.background&&(r.style.cssText=POLARIS.tools.convertRgbToHex(r.getAttribute("style")),r.style.removeProperty("background"));""!=r.style.backgroundColor&&r.style.removeProperty("background-color");p=r.style.cssText}r.style.cssText=p.replace(/(\d+\.\d+)(\w+)/g,function(a,b,c,d){return"mm"==c?a:1<b?Math.max(1,b)+c:a})}m=n.innerHTML}a.type=l;a.dataValue=m;delete a.preSniffing;delete a.startsWithEOL;delete a.endsWithEOL},null,null,6);g.on("paste",function(a){var b=a.data;if("html"==b.type){var c=
!1;a=document.createElement("div");a.innerHTML=b.dataValue;var d=a.querySelectorAll("img");a=0;for(var e=d.length;a<e;a++){var h=d[a];if(!1===/^https?:\/\//.test(h.src)&&"polaris_anchor"!=h.className&&"polaris_flash"!=h.className&&"polaris_iframe"!=h.className){c=!0;break}}!0===c&&g.openDialog("imageCopy")}a=function(a,b){for(;a;){if(a.type==POLARIS.NODE_ELEMENT){var c=a.getStyle(b);if(c)return c}a=a.getParent()}return""};var c=g.getSelection().getStartElement(),d=a(c,"line-height"),e=a(c,"font-family"),
k=new POLARIS.dom.element("div");k.$.innerHTML=b.dataValue;var h=function(a){for(;a&&!a.is("body");){if(a.getStyle("font-family"))return!0;a=a.getParent()}return!1},p=function(a){for(;a&&!a.is("body");){if(a.getStyle("line-height"))return!0;a=a.getParent()}return!1};a=new POLARIS.dom.range(k);a.selectNodeContents(k);a=new POLARIS.dom.walker(a);a.breakOnFalse=1;a.evaluator=function(a){return a.type==POLARIS.NODE_TEXT&&0<a.getLength()};for(var t=[],w;w=a.next();)t.push(w);for(a=0;a<t.length;a++)w=t[a].getParent(),
h(w)||w.setStyle("font-family",e),p(w)||w.setStyle("line-height",d);d=(c=c.getAscendant(function(a){if(a.type==POLARIS.NODE_ELEMENT){if(a.is("p")||a.is("td")||a.is("th")||a.is("tr"))return!0;if(a.is("div"))return POLARIS.plugins.div.isTextbox(a)}return!1},!0))?0===POLARIS.tools.trim(c.getText()).replace(/\u200B/g,"").length:void 0;e=function(a){for(;a&&!a.is("body");){if(a.getStyle("text-align"))return!0;a=a.getParent()}return!1};if(POLARIS.env.chrome)for(h=k.getChildren(),a=0;a<h.count();a++)p=h.getItem(a),
p.type==POLARIS.NODE_ELEMENT&&p.is("span")&&(e(p)&&(0===a&&d&&c&&c.setStyle("text-align",p.getStyle("text-align")),p.removeStyle("text-align")),p.removeStyle("text-shadow"));c=k.find("p");d=c.count();for(a=0;a<d;a++)e=c.getItem(a),e.hasAttribute("doc-data-field-position")&&e.removeAttribute("doc-data-field-position");setTimeout(function(){if(!g.config.blockPaste){var a=k.$.innerHTML,c=g.document.getSelection(),d=g.document.getSelection().getStartElement(),e=d&&d.getAscendant({table:1},!0),f=d&&d.getAscendant({td:1},
!0),a=a.replace(/\x3c!--StartFragment--\x3e/g,""),a=a.replace(/\x3c!--EndFragment--\x3e/g,""),h=a.lastIndexOf("\x3c/table\x3e")==a.length-8?!0:!1,m=b.type;(d=POLARIS.plugins.tabletools.getSelectedCells(c))&&(f=d[0]);if(h&&!POLARIS.tools.isEmptyValue(f)&&e){e=POLARIS.tools.buildTableMap(e);h=POLARIS.plugins.tabletools.getCellIndex(f,e);f=h[0];h=h[1];m=new POLARIS.dom.element("table");m.setHtml(a);for(var a=POLARIS.tools.buildTableMap(m),n=0,q=0,m=n;m<a.length;m++){var w=a[n],p=e[m+f];if(w&&p)for(var t=
q;t<w.length;t++){var v=w[t]?new POLARIS.dom.element(w[t]):null,z=p[t+h]?new POLARIS.dom.element(p[t+h]):null,v=v&&v.getHtml();z&&!POLARIS.tools.isEmptyValue(v)&&z.setHtml(v);q++}n++;q=0}b.isPasteInTable=!0}else if(e&&d&&1<d.length){for(m=0;m<d.length;m++)d[m].setHtml(a);b.isPasteInTable=!0}else g.insertHtml(a,m),b.isPasteInTable=!1;(f=d[0])&&b.isPasteInTable&&((c=c.getRanges()[0])&&c.moveToLeafElementEditablePosition(f,!0),c&&c.select())}g.fire("afterPaste",b)},0)},null,null,1E3);g.on("pasteDialog",
function(a){setTimeout(function(){g.openDialog("paste",a.data)},0)})}})})();POLARIS.plugins.add("panelbutton",{requires:"button",onLoad:function(){function a(a){var b=this._;b.state!=POLARIS.TRISTATE_DISABLED&&(this.createPanel(a),b.on?b.panel.hide():b.panel.showBlock(this._.id,this.document.getById(this._.id),4))}POLARIS.ui.panelButton=POLARIS.tools.createClass({base:POLARIS.ui.button,$:function(e){POLARIS.tools.extend(this,e,{title:e.label,modes:{wysiwyg:1},editorFocus:1});var b=this.panel||{};
delete this.panel;this.base(e);this.document=b.parent&&b.parent.getDocument()||POLARIS.document;b.block={attributes:b.attributes};this.hasArrow=b.toolbarRelated=!0;this.click=a;this._={panelDefinition:b}},statics:{handler:{create:function(a){return new POLARIS.ui.panelButton(a)}}},proto:{createPanel:function(a){var b=this._;if(!b.panel){var c=this._.panelDefinition,d=this._.panelDefinition.block,h=c.parent||POLARIS.document.getBody(),g=this._.panel=new POLARIS.ui.floatPanel(a,h,c),c=g.addBlock(b.id,
d),k=this;g.onShow=function(){k.className&&this.element.addClass(k.className+"_panel");k.setState(POLARIS.TRISTATE_ON);b.on=1;k.editorFocus&&a.focus();if(k.onOpen)k.onOpen()};g.onHide=function(c){k.className&&this.element.getFirst().removeClass(k.className+"_panel");k.setState(k.modes&&k.modes[a.mode]?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED);b.on=0;if(!c&&k.onClose)k.onClose()};g.onEscape=function(){g.hide(1);k.document.getById(b.id).focus()};if(this.onBlock)this.onBlock(g,c);c.onHide=function(){b.on=
0;k.setState(POLARIS.TRISTATE_OFF)}}}}})},beforeInit:function(a){a.ui.addHandler(POLARIS.UI_PANELBUTTON,POLARIS.ui.panelButton.handler)}});POLARIS.UI_PANELBUTTON="panelbutton";(function(){POLARIS.plugins.add("panel",{beforeInit:function(a){a.ui.addHandler(POLARIS.UI_PANEL,POLARIS.ui.panel.handler)}});POLARIS.UI_PANEL="panel";POLARIS.ui.panel=function(a,b){b&&POLARIS.tools.extend(this,b);POLARIS.tools.extend(this,{className:"",css:[]});this.id=POLARIS.tools.getNextId();this.document=a;this.isFramed=
this.forceIFrame||this.css.length;this._={blocks:{}}};POLARIS.ui.panel.handler={create:function(a){return new POLARIS.ui.panel(a)}};var a=POLARIS.addTemplate("panel",'\x3cdiv lang\x3d"{langCode}" id\x3d"{id}" dir\x3d{dir} class\x3d"polaris polaris_reset_all {editorId} polaris_panel polaris_panel {cls} polaris_{dir}" style\x3d"z-index:{z-index}" role\x3d"presentation"\x3e{frame}\x3c/div\x3e'),e=POLARIS.addTemplate("panel-frame",'\x3ciframe id\x3d"{id}" class\x3d"polaris_panel_frame" role\x3d"presentation" frameborder\x3d"0" src\x3d"{src}"\x3e\x3c/iframe\x3e'),
b=POLARIS.addTemplate("panel-frame-inner",'\x3c!DOCTYPE html\x3e\x3chtml class\x3d"polaris_panel_container {env}" dir\x3d"{dir}" lang\x3d"{langCode}"\x3e\x3chead\x3e{css}\x3c/head\x3e\x3cbody class\x3d"polaris_{dir}" style\x3d"margin:0;padding:0" onload\x3d"{onload}"\x3e\x3c/body\x3e\x3c/html\x3e');POLARIS.ui.panel.prototype={render:function(c,d){this.getHolderElement=function(){var a=this._.holder;if(!a){if(this.isFramed){var a=this.document.getById(this.id+"_frame"),c=a.getParent(),a=a.getFrameDocument();
POLARIS.env.iOS&&c.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"});c=POLARIS.tools.addFunction(POLARIS.tools.bind(function(){var a=this;POLARIS.tools.setTimeout(function(){a.isLoaded=!0;if(a.onLoad)a.onLoad()},100,this)},this));POLARIS.env.chrome?(a.write(b.output(POLARIS.tools.extend({css:"",onload:"window.parent.POLARIS.tools.callFunction("+c+");"},h))),a.getHead().appendHtml(POLARIS.tools.buildStyleHtml(this.css))):a.write(b.output(POLARIS.tools.extend({css:POLARIS.tools.buildStyleHtml(this.css),
onload:"window.parent.POLARIS.tools.callFunction("+c+");"},h)));a.getWindow().$.POLARIS=POLARIS;a.on("keydown",function(a){var b=a.data.getKeystroke(),c=this.document.getById(this.id).getAttribute("dir");this._.onKeyDown&&!1===this._.onKeyDown(b)?a.data.preventDefault():(27==b||b==("rtl"==c?39:37))&&this.onEscape&&!1===this.onEscape(b)&&a.data.preventDefault()},this);a=a.getBody();a.unselectable();POLARIS.env.air&&POLARIS.tools.callFunction(c)}else a=this.document.getById(this.id);this._.holder=a}return a};
var h={editorId:c.id,id:this.id,langCode:c.langCode,dir:c.lang.dir,cls:this.className,frame:"",env:POLARIS.env.cssClass,"z-index":c.config.baseFloatZIndex+1};if(this.isFramed){var g=POLARIS.env.air?"javascript:void(0)":POLARIS.env.ie?"javascript:void(function(){"+encodeURIComponent("document.open();("+POLARIS.tools.fixDomain+")();document.close();")+"}())":"";h.frame=e.output({id:this.id+"_frame",src:g})}g=a.output(h);d&&d.push(g);return g},addBlock:function(a,b){b=this._.blocks[a]=b instanceof POLARIS.ui.panel.block?
b:new POLARIS.ui.panel.block(this.getHolderElement(),b);this._.currentBlock||this.showBlock(a);return b},getBlock:function(a){return this._.blocks[a]},showBlock:function(a){var b=this._.blocks[a];a=this._.currentBlock;var e=!this.forceIFrame||POLARIS.env.ie?this._.holder:this.document.getById(this.id+"_frame");a&&a.hide();this._.currentBlock=b;POLARIS.fire("ariaWidget",e);b._.focusIndex=-1;this._.onKeyDown=b.onKeyDown&&POLARIS.tools.bind(b.onKeyDown,b);POLARIS.tools.setTimeout(function(){b.show()},
0);return b},destroy:function(){this.element&&this.element.remove()}};POLARIS.ui.panel.block=POLARIS.tools.createClass({$:function(a,b){this.element=a.append(a.getDocument().createElement("div",{attributes:{tabindex:-1,"class":"polaris_panel_block"},styles:{outline:0,display:"none"}}));b&&POLARIS.tools.extend(this,b);this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]});this.keys=
{};this._.focusIndex=-1;this.element.disableContextMenu()},_:{markItem:function(a){-1!=a&&(a=this.element.getElementsByTag("a").getItem(this._.focusIndex=a),POLARIS.env.webkit&&a.getDocument().getWindow().focus(),a.focus(),this.onMark&&this.onMark(a))}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){this.onHide&&!0===this.onHide.call(this)||this.element.setStyle("display","none")},onKeyDown:function(a,b){var e=this.keys[a];switch(e){case "next":for(var g=this._.focusIndex,
e=this.element.getElementsByTag("a"),k;k=e.getItem(++g);)if(k.getAttribute("_polaris_focus")&&k.$.offsetWidth){this._.focusIndex=g;k.focus();break}return k||b?!1:(this._.focusIndex=-1,this.onKeyDown(a,1));case "prev":g=this._.focusIndex;for(e=this.element.getElementsByTag("a");0<g&&(k=e.getItem(--g));){if(k.getAttribute("_polaris_focus")&&k.$.offsetWidth){this._.focusIndex=g;k.focus();break}k=null}return k||b?!1:(this._.focusIndex=e.count(),this.onKeyDown(a,1));case "click":case "mouseup":return g=
this._.focusIndex,(k=0<=g&&this.element.getElementsByTag("a").getItem(g))&&(k.$[e]?k.$[e]():k.$["on"+e]()),!1;case "F5":return!1}return!0}}})})();POLARIS.plugins.add("floatpanel",{requires:"panel"});(function(){function a(a,c,d,h,g){g=POLARIS.tools.genKey(c.getUniqueId(),d.getUniqueId(),a.lang.dir,a.uiColor||"",h.css||"",g||"");var k=e[g];k||(k=e[g]=new POLARIS.ui.panel(c,h),k.element=d.append(POLARIS.dom.element.createFromHtml(k.render(a),c)),k.element.setStyles({display:"none",position:"absolute"}));
return k}var e={};POLARIS.ui.floatPanel=POLARIS.tools.createClass({$:function(b,c,d,e){function g(){m.hide()}d.forceIFrame=1;c=POLARIS.document.getById("polaris_"+b.name)||c;var k=c.getDocument();e=a(b,k,c,d,e||0);var f=e.element,l=f.getFirst(),m=this;f.disableContextMenu();this.element=f;this._={editor:b,panel:e,parentElement:c,definition:d,document:k,iframe:l,children:[],dir:b.lang.dir};b.on("mode",g);b.on("resize",g);if(!POLARIS.env.iOS)k.getWindow().on("resize",g)},proto:{addBlock:function(a,
c){return this._.panel.addBlock(a,c)},addListBlock:function(a,c){return this._.panel.addListBlock(a,c)},getBlock:function(a){return this._.panel.getBlock(a)},showBlock:function(a,c,d,e,g,k){var f=this._.panel,l=f.showBlock(a);this.allowBlur(!1);var m=this._.editor;a=this._.editor.editable();this._.returnFocus=a.hasFocus?a:new POLARIS.dom.element(POLARIS.document.$.activeElement);this._.hideTimeout=0;var n=this.element;a=this._.iframe;a=POLARIS.env.ie?a:new POLARIS.dom.window(a.$.contentWindow);var q=
n.getDocument(),v=this._.parentElement.getPositionedAncestor(),r=c.getDocumentPosition(q),q=v?v.getDocumentPosition(q):{x:0,y:0},p="rtl"==this._.dir,t=r.x+(e||0)-q.x,w=r.y+(g||0)-q.y;!p||1!=d&&4!=d?p||2!=d&&3!=d||(t+=c.$.offsetWidth-1):t+=c.$.offsetWidth;if(3==d||4==d)w+=c.$.offsetHeight-1;this._.panel._.offsetParentId=c.getId();n.setStyles({top:w+"px",left:0,display:""});n.setOpacity(0);n.getFirst().removeStyle("width");this._.editor.focusManager.add(a);this._.blurSet||(POLARIS.event.useCapture=
!0,a.on("blur",function(a){function b(){delete this._.returnFocus;this.hide()}this.allowBlur()&&a.data.getPhase()==POLARIS.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild&&(POLARIS.env.iOS?this._.hideTimeout||(this._.hideTimeout=POLARIS.tools.setTimeout(b,0,this)):b.call(this))},this),a.on("focus",function(){this._.focused=!0;this.hideChild();this.allowBlur(!0)},this),POLARIS.env.iOS&&(a.on("touchstart",function(){clearTimeout(this._.hideTimeout)},this),a.on("touchend",function(){this._.hideTimeout=
0;this.focus()},this)),POLARIS.event.useCapture=!1,this._.blurSet=1);f.onEscape=POLARIS.tools.bind(function(a){if(this.onEscape&&!1===this.onEscape(a))return!1},this);POLARIS.tools.setTimeout(function(){var a=POLARIS.tools.bind(function(){n.removeStyle("width");if(l.autoSize){var a=l.element.getDocument(),a=(POLARIS.env.webkit?l.element:a.getBody()).$.scrollWidth;POLARIS.env.ie&&POLARIS.env.quirks&&0<a&&(a+=(n.$.offsetWidth||0)-(n.$.clientWidth||0)+3);n.setStyle("width",a+10+"px");a=l.element.$.scrollHeight;
POLARIS.env.ie&&POLARIS.env.quirks&&0<a&&(a+=(n.$.offsetHeight||0)-(n.$.clientHeight||0)+3);n.setStyle("height",a+"px");f._.currentBlock.element.setStyle("display","none").removeStyle("display")}else n.removeStyle("height");p&&(t-=n.$.offsetWidth);n.setStyle("left",t+"px");var b=f.element.getWindow(),a=n.$.getBoundingClientRect(),b=b.getViewPaneSize(),c=a.width||a.right-a.left,d=a.height||a.bottom-a.top,e=p?a.right:b.width-a.left,g=p?b.width-a.right:a.left,h=!1,q=!1;m&&m.container&&(editorViewportSize=
(m.container.getFirst(function(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasClass("polaris_inner")})||m.container).getClientRect(),editorViewportSize.bottom<a.bottom&&(h=!0),editorViewportSize.right<a.right&&(q=!0));if(p)e<c&&(t=g>c?t+c:b.width>c?t-a.left:t-a.right+b.width);else if(e<c||q)t=g>c?t-c:b.width>c?t-a.right+b.width:t-a.left;c=a.top;if(b.height-a.top<d||h)w=c>d?w-d:b.height>d?w-a.bottom+b.height:w-a.top;POLARIS.env.ie&&(b=a=new POLARIS.dom.element(n.$.offsetParent),"html"==b.getName()&&
(b=b.getDocument().getBody()),"rtl"==b.getComputedStyle("direction")&&(t=POLARIS.env.ie8Compat?t-2*n.getDocument().getDocumentElement().$.scrollLeft:t-(a.$.scrollWidth-a.$.clientWidth)));var a=n.getFirst(),r;(r=a.getCustomData("activePanel"))&&r.onHide&&r.onHide.call(this,1);a.setCustomData("activePanel",this);n.setStyles({top:w+"px",left:t+"px"});n.setOpacity(1);k&&k()},this);f.isLoaded?a():f.onLoad=a;POLARIS.tools.setTimeout(function(){var a=POLARIS.env.webkit&&POLARIS.document.getWindow().getScrollPosition().y;
this.focus();l.element.focus();POLARIS.env.webkit&&(POLARIS.document.getBody().$.scrollTop=a);this.allowBlur(!0);this._.editor.fire("panelShow",this)},0,this)},POLARIS.env.air?200:0,this);this.visible=1;this.onShow&&this.onShow.call(this)},focus:function(){if(POLARIS.env.webkit){var a=POLARIS.document.getActive();a&&!a.equals(this._.iframe)&&a.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var a=this._.iframe.getFrameDocument().getActive();a&&
a.is("a")&&(this._.lastFocused=a)},hide:function(a){if(this.visible&&(!this.onHide||!0!==this.onHide.call(this))){this.hideChild();POLARIS.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur();this.element.setStyle("display","none");this.visible=0;this.element.getFirst().removeCustomData("activePanel");if(a=a&&this._.returnFocus)POLARIS.env.webkit&&a.type&&a.getWindow().$.focus(),a.focus();delete this._.lastFocused;this._.editor.fire("panelHide",this)}},allowBlur:function(a){var c=this._.panel;
void 0!==a&&(c.allowBlur=a);return c.allowBlur},showAsChild:function(a,c,d,e,g,k){if(this._.activeChild!=a||a._.panel._.offsetParentId!=d.getId())this.hideChild(),a.onHide=POLARIS.tools.bind(function(){POLARIS.tools.setTimeout(function(){this._.focused||this.hide()},0,this)},this),this._.activeChild=a,this._.focused=!1,a.showBlock(c,d,e,g,k),this.blur(),(POLARIS.env.ie7Compat||POLARIS.env.ie6Compat)&&setTimeout(function(){a.element.getChild(0).$.style.cssText+=""},100)},hideChild:function(a){var c=
this._.activeChild;c&&(delete c.onHide,delete this._.activeChild,c.hide(),a&&this.focus())}}});POLARIS.on("instanceDestroyed",function(){var a=POLARIS.tools.isEmpty(POLARIS.instances),c;for(c in e){var d=e[c];a?d.destroy():d.element.hide()}a&&(e={})})})();POLARIS.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",init:function(a){function e(c,e,f,l){var m=new POLARIS.style(d["colorButton_"+e+"Style"]),n=POLARIS.tools.getNextId()+"_colorBox";a.ui.add(c,POLARIS.UI_PANELBUTTON,{label:f,title:f,
modes:{wysiwyg:1},editorFocus:0,toolbar:"colors,"+l,allowedContent:m,requiredContent:m,panel:{css:POLARIS.skin.getPath("editor"),attributes:{role:"listbox","aria-label":h.panelTitle}},onBlock:function(c,d){this._.panel._.iframe.getFrameDocument().getById(n)&&(n+="2");d.autoSize=!0;d.element.addClass("polaris_colorblock");d.element.setHtml(b(c,e,n));d.element.getDocument().getBody().setStyle("overflow","hidden");POLARIS.ui.fire("ready",this);var f=d.keys,g="rtl"==a.lang.dir;f[g?37:39]="next";f[40]=
"next";f[9]="next";f[g?39:37]="prev";f[38]="prev";f[POLARIS.SHIFT+9]="prev";f[32]="click";f[116]="F5"},refresh:function(){a.activeFilter.check(m)||this.setState(POLARIS.TRISTATE_DISABLED)},onOpen:function(){var b=a.getSelection(),b=b&&b.getStartElement(),b=a.elementPath(b),c;if(b){b=b.block||b.blockLimit||a.document.getBody();do c=b&&b.getComputedStyle("back"==e?"background-color":"color")||"transparent";while("back"==e&&"transparent"==c&&b&&(b=b.getParent()));c&&"transparent"!=c||(c="#ffffff");this._.panel._.iframe.getFrameDocument().getById(n)&&
this._.panel._.iframe.getFrameDocument().getById(n).setStyle("background-color",c);return c}}})}function b(b,e,f){f=[];var l=d.colorButton_colors.split(","),m=a.plugins.uicolor&&!1!==d.colorButton_enableMore,n=l.length+(m?2:1),q=POLARIS.tools.addFunction(function(e,f){function h(a){this.removeListener("ok",h);this.removeListener("cancel",h);"ok"==a.name&&l(this.getContentElement("picker","txtPickerColor").getValue(),f)}var k=a.getSelection(),l=arguments.callee;if("?"==e)a.openDialog("uicolor",function(){this.on("ok",
h);this.on("cancel",h)});else{a.focus();b.hide();a.fire("saveSnapshot");var m=a.getSelection().getRanges()[0];m&&!m.collapsed&&a.removeStyle(new POLARIS.style(d["colorButton_"+f+"Style"],{color:"inherit"}));if(e){var m=d["colorButton_"+f+"Style"],n=new POLARIS.style(m,{color:e});if((k=POLARIS.plugins.tabletools.getSelectedCells(k))&&0<k.length&&POLARIS.plugins.tabletools.hasSelectedCell(k))for(var r=0;r<k.length;r++){var q=k[r],m=new POLARIS.dom.range(a.document);m.selectNodeContents(q);n.applyToRange(m)}else m.childRule=
"back"==f?function(a){return c(a)}:function(a){return!(a.is("a")||a.getElementsByTag("a").count())||c(a)},a.applyStyle(new POLARIS.style(m,{color:e}))}a.fire("saveSnapshot")}});f.push('\x3ctable role\x3d"presentation" cellspacing\x3d0 cellpadding\x3d0 width\x3d"100%"\x3e');for(var v=0;v<l.length;v++){0===v%8&&f.push("\x3c/tr\x3e\x3ctr\x3e");var r=l[v].split("/"),p=r[0],t=r[1]||p;r[1]||(p="#"+p.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3"));r=a.lang.colorbutton.colors[t]||t;f.push('\x3ctd\x3e\x3ca class\x3d"polaris_colorbox" _polaris_focus\x3d1 hidefocus\x3dtrue title\x3d"',
r,'" onclick\x3d"POLARIS.tools.callFunction(',q,",'",p,"','",e,"'); return false;\" href\x3d\"javascript:void('",r,'\')" role\x3d"option" aria-posinset\x3d"',v+2,'" aria-setsize\x3d"',n,'"\x3e\x3cspan class\x3d"polaris_colorbox" style\x3d"background-color:#',t,'"\x3e\x3c/span\x3e\x3c/a\x3e\x3c/td\x3e')}l=POLARIS.tools.addFunction(function(b){a.focus();POLARIS.plugins.tabletools.selectedCellIterator(a,function(c,e){var f=new POLARIS.dom.range(a.document);f.selectNodeContents(e);f.select();a.removeStyle(new POLARIS.style(d["colorButton_"+
b+"Style"],{color:"inherit"}))});a.removeStyle(new POLARIS.style(d["colorButton_"+b+"Style"],{color:"inherit"}))});"back"==e?f.push('\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"8" align\x3d"center" style\x3d"border-bottom: 1px solid silver; padding-bottom:3px;"\x3e\x3ca class\x3d"polaris_colormore" _polaris_focus\x3d1 hidefocus\x3dtrue title\x3d"',h.defaultColor[e],'" onclick\x3d"POLARIS.tools.callFunction(',l,",'",e,"');return false;\" href\x3d\"javascript:void('",h.defaultColor[e],"')\"",' role\x3d"option" aria-posinset\x3d"',
n,'" aria-setsize\x3d"',n,'"\x3e',h.defaultColor[e],"\x3c/a\x3e\x3c/td\x3e"):"fore"==e&&f.push('\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"8" align\x3d"center" valign\x3d"middle" style\x3d"border-bottom: 1px solid silver; padding-bottom:3px;"\x3e\x3ca class\x3d"polaris_colormore" _polaris_focus\x3d1 hidefocus\x3dtrue title\x3d"',h.defaultColor[e],'" onclick\x3d"POLARIS.tools.callFunction(',l,",'",e,"');return false;\" href\x3d\"javascript:void('",h.defaultColor[e],"')\"",' role\x3d"option" aria-posinset\x3d"',
n,'" aria-setsize\x3d"',n,'"\x3e\x3cspan class\x3d"polaris_colorbox" style\x3d"background-color:#000000;margin-top:1px;"\x3e\x3c/span\x3e\x26nbsp;',h.defaultColor[e],"\x3c/a\x3e\x3c/td\x3e");m&&f.push('\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d8 align\x3dcenter\x3e\x3ca class\x3d"polaris_colormore" _polaris_focus\x3d1 hidefocus\x3dtrue title\x3d"',h.more,'" onclick\x3d"POLARIS.tools.callFunction(',q,",'?','",e,"');return false;\" href\x3d\"javascript:void('",h.more,"')\"",' role\x3d"option" aria-posinset\x3d"',
n,'" aria-setsize\x3d"',n,'"\x3e',h.more,"\x3c/a\x3e\x3c/td\x3e");f.push("\x3c/tr\x3e\x3c/table\x3e");return f.join("")}function c(a){return"false"==a.getAttribute("contentEditable")||a.getAttribute("data-nostyle")}var d=a.config,h=a.lang.colorbutton;POLARIS.env.hc||(e("TextColor","fore",h.textColorTitle,10),e("BGColor","back",h.bgColorTitle,20))}});POLARIS.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF";
POLARIS.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};POLARIS.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};POLARIS.plugins.colordialog={requires:"dialog",init:function(a){var e=new POLARIS.dialogCommand("colordialog");e.editorFocus=!1;a.addCommand("colordialog",e);POLARIS.dialog.add("colordialog",this.path+"dialogs/colordialog.js");a.getColorFromDialog=function(b,c){var d=function(a){this.removeListener("ok",
d);this.removeListener("cancel",d);a="ok"==a.name?this.getValueOf("picker","selectedColor"):null;b.call(c,a)},e=function(a){a.on("ok",d);a.on("cancel",d)};a.execCommand("colordialog");if(a._.storedDialogs&&a._.storedDialogs.colordialog)e(a._.storedDialogs.colordialog);else POLARIS.on("dialogDefinition",function(a){if("colordialog"==a.data.name){var b=a.data.definition;a.removeListener();b.onLoad=POLARIS.tools.override(b.onLoad,function(a){return function(){e(this);b.onLoad=a;"function"==typeof a&&
a.call(this)}})}})}}};POLARIS.plugins.add("colordialog",POLARIS.plugins.colordialog);POLARIS.plugins.add("menu",{requires:"floatpanel",beforeInit:function(a){for(var e=a.config.menu_groups.split(","),b=a._.menuGroups={},c=a._.menuItems={},d=0;d<e.length;d++)b[e[d]]=d+1;a.addMenuGroup=function(a,c){b[a]=c||100};a.addMenuItem=function(a,d){b[d.group]&&(c[a]=new POLARIS.menuItem(this,a,d))};a.addMenuItems=function(a){for(var b in a)this.addMenuItem(b,a[b])};a.getMenuItem=function(a){return c[a]};a.removeMenuItem=
function(a){delete c[a]}}});(function(){function a(a){a.sort(function(a,b){return a.group<b.group?-1:a.group>b.group?1:a.order<b.order?-1:a.order>b.order?1:0})}var e='\x3cspan class\x3d"polaris_menuitem"\x3e\x3ca id\x3d"{id}" class\x3d"polaris_menubutton polaris_menubutton__{name} polaris_menubutton_{state} {cls}" href\x3d"{href}" title\x3d"{title}" tabindex\x3d"-1"_polaris_focus\x3d1 hidefocus\x3d"true" role\x3d"{role}" aria-haspopup\x3d"{hasPopup}" aria-disabled\x3d"{disabled}" draggable\x3d"false" {ariaChecked}';
POLARIS.env.gecko&&POLARIS.env.mac&&(e+=' onkeypress\x3d"return false;"');POLARIS.env.gecko&&(e+=' onblur\x3d"this.style.cssText \x3d this.style.cssText;"');var e=e+(' onmouseover\x3d"POLARIS.tools.callFunction({hoverFn},{index});" onmouseout\x3d"POLARIS.tools.callFunction({moveOutFn},{index});" '+(POLARIS.env.ie?'onclick\x3d"return false;" onmouseup':"onclick")+'\x3d"POLARIS.tools.callFunction({clickFn},{index}); return false;"\x3e'),b=POLARIS.addTemplate("menuItem",e+'\x3cspan class\x3d"polaris_menubutton_inner"\x3e\x3cspan class\x3d"polaris_menubutton_icon"\x3e\x3cspan class\x3d"polaris_button_icon polaris_button__{iconName}_icon" style\x3d"{iconStyle}"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"polaris_menubutton_label"\x3e{label}\x3c/span\x3e{arrowHtml}\x3c/span\x3e\x3c/a\x3e\x3c/span\x3e'),
c=POLARIS.addTemplate("menuArrow",'\x3cspan class\x3d"polaris_menuarrow"\x3e\x3cspan\x3e{label}\x3c/span\x3e\x3c/span\x3e');POLARIS.menu=POLARIS.tools.createClass({$:function(a,b){b=this._.definition=b||{};this.id=POLARIS.tools.getNextId();this.editor=a;this.items=[];this._.listeners=[];this._.level=b.level||1;var c=POLARIS.tools.extend({},b.panel,{css:[POLARIS.skin.getPath("editor")],level:this._.level-1,block:{}}),e=c.block.attributes=c.attributes||{};!e.role&&(e.role="menu");this._.panelDefinition=
c},_:{onShow:function(a){var b=this.editor.getSelection(),c=b&&b.getStartElement(),e=this.editor.elementPath(),f=this._.listeners;this.removeAll();for(var l=0;l<f.length;l++){var m=f[l](c,b,e,a);if(m)for(var n in m){var q=this.editor.getMenuItem(n);q&&(!q.command||this.editor.getCommand(q.command).state||q.disableshow)&&(q.state=m[n],this.add(q))}}},onClick:function(a){this.hide();if(a.onClick)a.onClick();else a.command&&this.editor.execCommand(a.command)},onEscape:function(a){var b=this.parent;b?
b._.panel.hideChild(1):27==a&&this.hide(1);return!1},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(a){var b=this._.subMenu,c=this.items[a];if(c=c.getItems&&c.getItems()){b?b.removeAll():(b=this._.subMenu=new POLARIS.menu(this.editor,POLARIS.tools.extend({},this._.definition,{level:this._.level+1},!0)),b.parent=this,b._.onClick=POLARIS.tools.bind(this._.onClick,this));for(var e in c){var f=this.editor.getMenuItem(e);f&&(f.state=c[e],b.add(f))}var l=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+
String(a));setTimeout(function(){b.show(l,2)},0)}else this._.panel.hideChild(1)}},proto:{add:function(a){a.order||(a.order=this.items.length);this.items.push(a)},removeAll:function(){this.items=[]},show:function(b,c,e,k){if(!this.parent){var f;b.$&&(f=b.$.id);this._.onShow(f);if(!this.items.length)return}c=c||("rtl"==this.editor.lang.dir?2:1);f=this.items;var l=this.editor,m=this._.panel,n=this._.element;if(!m){m=this._.panel=new POLARIS.ui.floatPanel(this.editor,POLARIS.document.getBody(),this._.panelDefinition,
this._.level);m.onEscape=POLARIS.tools.bind(function(a){if(!1===this._.onEscape(a))return!1},this);m.onShow=function(){m._.panel.getHolderElement().getParent().addClass("polaris polaris_reset_all")};m.onHide=POLARIS.tools.bind(function(){this._.onHide&&this._.onHide()},this);l.on("hidePanel",function(){m&&m.hide&&m.hide()});n=m.addBlock(this.id,this._.panelDefinition.block);n.autoSize=!0;var q=n.keys;q[40]="next";q[9]="next";q[38]="prev";q[POLARIS.SHIFT+9]="prev";q["rtl"==l.lang.dir?37:39]=POLARIS.env.ie?
"mouseup":"click";q[32]=POLARIS.env.ie?"mouseup":"click";POLARIS.env.ie&&(q[13]="mouseup");q[116]="F5";n=this._.element=n.element;q=n.getDocument();q.getBody().setStyle("overflow","hidden");q.getElementsByTag("html").getItem(0).setStyle("overflow","hidden");this._.itemOverFn=POLARIS.tools.addFunction(function(a){clearTimeout(this._.showSubTimeout);this._.showSubTimeout=POLARIS.tools.setTimeout(this._.showSubMenu,l.config.menu_subMenuDelay||400,this,[a])},this);this._.itemOutFn=POLARIS.tools.addFunction(function(){clearTimeout(this._.showSubTimeout)},
this);this._.itemClickFn=POLARIS.tools.addFunction(function(a){var b=this.items[a];if(b.state==POLARIS.TRISTATE_DISABLED||b.state==POLARIS.TRISTATE_CHECKED)this.hide(1);else if(b.getItems)this._.showSubMenu(a);else this._.onClick(b)},this)}a(f);for(var q=(q=l.elementPath())&&q.direction()!=l.lang.dir?" polaris_mixed_dir_content":"",q=["\x3cstyle\x3e.polaris_menubutton:hover, .polaris_menubutton:focus, .polaris_menubutton:active{"+(l.config.menuItemHoverColor?"background-color:"+l.config.menuItemHoverColor+
";":"")+"}.polaris_menubutton_on{"+(l.config.menuItemSelectedColor?"background-color:"+l.config.menuItemSelectedColor+";":"")+"}.polaris_menuseparator{"+(l.config.menuItemSeperatorColor?"background-color:"+l.config.menuItemSeperatorColor+";":"")+"}\x3c/style\x3e",'\x3cdiv class\x3d"polaris_menu'+q+'" role\x3d"presentation"\x3e'],v=f.length,r=v&&f[0].group,p=0;p<v;p++){var t=f[p];r!=t.group&&(q.push('\x3cdiv class\x3d"polaris_menuseparator" role\x3d"separator"\x3e\x3c/div\x3e'),r=t.group);t.render(this,
p,q)}q.push("\x3c/div\x3e");n.setHtml(q.join(""));POLARIS.ui.fire("ready",this);this.parent?this.parent._.panel.showAsChild(m,this.id,b,c,e,k):m.showBlock(this.id,b,c,e,k);l.fire("menuShow",[m])},addListener:function(a){this._.listeners.push(a)},hide:function(a){this._.onHide&&this._.onHide();this._.panel&&this._.panel.hide(a)}}});POLARIS.menuItem=POLARIS.tools.createClass({$:function(a,b,c){POLARIS.tools.extend(this,c,{order:0,className:"polaris_menubutton__"+b});this.group=a._.menuGroups[this.group];
this.editor=a;this.name=b},proto:{render:function(a,e,g){var k=a.id+String(e),f="undefined"==typeof this.state?POLARIS.TRISTATE_OFF:this.state,l="",m=f==POLARIS.TRISTATE_ON?"on":f==POLARIS.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(l=' aria-checked\x3d"'+(f==POLARIS.TRISTATE_ON||f==POLARIS.TRISTATE_CHECKED?"true":"false")+'"');var n=this.getItems,q="\x26#"+("rtl"==this.editor.lang.dir?"9668":"9658")+";",v=this.name;this.command&&(v=this.command);this.icon&&
!/\./.test(this.icon)&&(v=this.icon);if(f==POLARIS.TRISTATE_ON||f==POLARIS.TRISTATE_CHECKED)v="selected_check";a={id:k,name:this.name,iconName:v,label:this.label,cls:this.className||"",state:m,hasPopup:n?"true":"false",disabled:f==POLARIS.TRISTATE_DISABLED,title:this.label,href:"javascript:void('"+(this.label||"").replace("'")+"')",hoverFn:a._.itemOverFn,moveOutFn:a._.itemOutFn,clickFn:a._.itemClickFn,index:e,iconStyle:this.noIcon?"":POLARIS.skin.getIconStyle(v,"rtl"==this.editor.lang.dir,v==this.icon?
null:this.icon,this.iconOffset),arrowHtml:n?c.output({label:q}):"",role:this.role?this.role:"menuitem",ariaChecked:l};b.output(a,g)}}})})();POLARIS.config.menu_groups="clipboard,specialchar,print,style,object,form,tablecell,tablecellproperties,tablerowcolumn,table,tableblockcalculation,tablecalculation,tablethousand,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div";POLARIS.plugins.add("contextmenu",{requires:"menu",onLoad:function(){POLARIS.plugins.contextMenu=
POLARIS.tools.createClass({base:POLARIS.menu,$:function(a){this.base.call(this,a,{panel:{className:"polaris_menu_panel",attributes:{"aria-label":a.lang.contextmenu.options}}})},proto:{addTarget:function(a,e){a.on("contextmenu",function(a){a=a.data;var c=POLARIS.env.webkit?b:POLARIS.env.mac?a.$.metaKey:a.$.ctrlKey;if(!e||!c){a.preventDefault();if(POLARIS.env.mac&&POLARIS.env.webkit){var c=this.editor,g=(new POLARIS.dom.elementPath(a.getTarget(),c.editable())).contains(function(a){return a.hasAttribute("contenteditable")},
!0);g&&"false"==g.getAttribute("contenteditable")&&c.getSelection().fake(g)}if(2!=this.editor.config.editMode||!a.getTarget().getAscendant(function(a){return a.type==POLARIS.NODE_ELEMENT&&a.is("td")&&a.getAttribute("doc-data-field")&&!a.isEditable()?!0:!1},1)){var g=a.getTarget().getDocument(),k=a.getTarget().getDocument().getDocumentElement(),c=!g.equals(POLARIS.document),g=g.getWindow().getScrollPosition(),f=c?a.$.clientX:a.$.pageX||g.x+a.$.clientX,l=c?a.$.clientY:a.$.pageY||g.y+a.$.clientY;POLARIS.tools.setTimeout(function(){this.editor.readOnly||
this.open(k,null,f,l)},POLARIS.env.ie?200:0,this)}}},this);if(POLARIS.env.webkit){var b,c=function(){b=0};a.on("keydown",function(a){b=POLARIS.env.mac?a.data.$.metaKey:a.data.$.ctrlKey});a.on("keyup",c);a.on("contextmenu",c)}},open:function(a,e,b,c){this.editor.focus();a=a||POLARIS.document.getDocumentElement();this.editor.selectionChange(1);this.editor.readOnly||this.show(a,e,b,c)}}})},beforeInit:function(a){var e=a.contextMenu=new POLARIS.plugins.contextMenu(a);a.on("contentDom",function(){e.addTarget(a.document,
!1!==a.config.browserContextMenuOnCtrl)});a.addCommand("contextMenu",{exec:function(){a.contextMenu.open(a.document.getBody())}});a.setKeystroke(POLARIS.SHIFT+121,"contextMenu");a.setKeystroke(POLARIS.CTRL+POLARIS.SHIFT+121,"contextMenu")}});(function(){POLARIS.plugins.add("div",{requires:"dialog",init:function(a){if(!a.blockless){var e=a.lang.div,b="div(*)";POLARIS.dialog.isTabEnabled(a,"editdiv","advanced")&&(b+=";div[dir,id,lang,title]{*}");a.addCommand("creatediv",new POLARIS.dialogCommand("creatediv",
{allowedContent:b,requiredContent:"div",contextSensitive:!0,refresh:function(a,b){var e=a.config.div_wrapTable?b.root:b.blockLimit,e=e&&e.getDtd&&e.getDtd()?"div"in e.getDtd():!1;POLARIS.plugins.div.getSurroundDiv(a)&&(e=!1);this.setState(e?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED)}}));a.addCommand("textbox",{allowedContent:b,requiredContent:"div",contextSensitive:!0,refresh:function(a,b){var e=a.config.div_wrapTable?b.root:b.blockLimit,e=e&&e.getDtd&&e.getDtd()?"div"in e.getDtd():!1;POLARIS.plugins.div.getSurroundDiv(a)&&
(e=!1);this.setState(e?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED)},exec:function(a){a.openDialog("creatediv",function(){this.parts.title.setHtml(e.textbox)})}});a.addCommand("editdiv",new POLARIS.dialogCommand("editdiv",{allowedContent:b,requiredContent:"div",contextSensitive:!0,startDisabled:!0,refresh:function(a,b){POLARIS.plugins.div.getSurroundDiv(a)?this.setState(POLARIS.TRISTATE_OFF):this.setState(POLARIS.TRISTATE_DISABLED)}}));a.addCommand("removediv",{requiredContent:"div",exec:function(a){function b(d){(d=
POLARIS.plugins.div.getSurroundDiv(a,d))&&!d.data("polaris-div-added")&&(f.push(d),d.data("polaris-div-added"))}for(var e=a.getSelection(),g=e&&e.getRanges(),k,f=[],l=k=0;l<g.length;l++)k=g[l],k.collapsed?b(e.getStartElement()):(k=new POLARIS.dom.walker(k),k.evaluator=b,k.lastForward());k=f.length;for(l=0;l<k;l++)f[l].remove()}});a.addCommand("forwardDiv",{requiredContent:"div",exec:function(a){var b=POLARIS.plugins.div.getAllDiv(a);a=a.elementPath().contains("div");POLARIS.plugins.div.sortDivByZindex(b);
var e=a.getStyle("z-index"),b=POLARIS.plugins.div.findDivByZindex(b,Number(e)+1);if(null!=b){var g=b.getStyle("z-index");a.setStyle("z-index",g);b.setStyle("z-index",e)}}});a.addCommand("backwardDiv",{requiredContent:"div",exec:function(a){var b=POLARIS.plugins.div.getAllDiv(a);a=a.elementPath().contains("div");POLARIS.plugins.div.sortDivByZindex(b);var e=a.getStyle("z-index"),b=POLARIS.plugins.div.findDivByZindex(b,Number(e)-1);if(null!=b){var g=b.getStyle("z-index");a.setStyle("z-index",g);b.setStyle("z-index",
e)}}});a.ui.addButton&&a.ui.addButton("CreateDiv",{label:e.createToolbar,command:"creatediv",toolbar:"blocks,50"});a.ui.addButton&&a.ui.addButton("ForwardDiv",{label:e.forwardToolbar,command:"forwardDiv",toolbar:"blocks,51"});a.ui.addButton&&a.ui.addButton("BackwardDiv",{label:e.backwardToolbar,command:"backwardDiv",toolbar:"blocks,52"});a.ui.addButton&&a.ui.addButton("TextBox",{label:e.textbox,command:"textbox",toolbar:"blocks,53"});a.ui.addButton&&a.ui.addButton("EditDiv",{label:e.edit,command:"editdiv",
toolbar:"blocks,54"});a.addMenuItems&&(a.addMenuItems({editdiv:{label:e.edit,command:"editdiv",group:"div",order:1},removediv:{label:e.remove,command:"removediv",group:"div",order:5}}),a.contextMenu&&a.contextMenu.addListener(function(b){return!b||b.isReadOnly()?null:POLARIS.plugins.div.getSurroundDiv(a)?{editdiv:POLARIS.TRISTATE_OFF,removediv:POLARIS.TRISTATE_OFF}:null}));POLARIS.dialog.add("creatediv",this.path+"dialogs/div.js");POLARIS.dialog.add("editdiv",this.path+"dialogs/div.js");a.on("objectresize",
function(b){var d=b.data.element,e=b.data.prevRect,g=b.data.currRect;if(d.is("div")){b=g.width/e.width;e=g.height/e.height;if(1!=b){var k=d.getStyle("width"),g=k.replace(/[0-9|.]/g,""),k=parseFloat(k);d.setStyle("width",k*b+g)}1!=e&&(b=d.getStyle("min-height"),g=b.replace(/[0-9|.]/g,""),b=parseFloat(b),isNaN(b)&&(b=d.getStyle("height"),g=b.replace(/[0-9|.]/g,""),b=parseFloat(b)),d.setStyle("min-height",b*e+g),d.removeStyle("height"),POLARIS.tools.setTimeout(function(){var b=d.getClientRect().height;
a.pagination&&(b=100*b/a.pagination.getScaleRatio());b=POLARIS.tools.convertPxToMm(b);d.setStyle("min-height",b+a.lang.common.unitMm)},0,this))}});POLARIS.env.ie&&(a.on("contentDom",function(){function b(c){c=(new POLARIS.dom.event(c)).getTarget();var d=new POLARIS.dom.range(a.document);d.setStartBefore(c);d.setEndAfter(c);d.select()}var d=a.editable().$;d.addEventListener?d.addEventListener("mscontrolselect",function(a){a.preventDefault();b(a)}):d.attachEvent("oncontrolselect",function(a){a.returnValue=
!1;b(a)})}),a.on("doubleclick",function(b){b=b.data.element;if(POLARIS.plugins.div.getSurroundDiv(a,b)){var d=new POLARIS.dom.range(a.document);d.moveToElementEditEnd(b);d.select()}}),a.on("mousedownright",function(b){b=b.data.element;var d=a&&a.getSelection(),d=d&&d.getRanges()[0];POLARIS.plugins.div.getSurroundDiv(a,b)&&(!d||b&&b.is("div"))&&(d=new POLARIS.dom.range(a.document),d.moveToElementEditEnd(b),d.select())}))}}});POLARIS.plugins.div={getSurroundDiv:function(a,e){var b=null,c=a.elementPath(e);
(c=c?a.elementPath(c.blockLimit):null)&&(b=c.contains(function(a){return POLARIS.plugins.div.isTextbox(a)},1));return b},isTextbox:function(a){return"div"!=a.getName()||!a.isEditable()||a.isReadOnly()||a.getStyle("position")||null!=a.getAttribute("doc-data-role")&&"polaris-textbox"!=a.getAttribute("doc-data-role")?!1:!0},getAllDiv:function(a){return allDiv=a.document.find("div")},sortDivByZindex:function(a){for(var e=[],b=[],c=0,d,h=0;h<a.count();h++)d=a.getItem(h),zIndexOfcurrentDiv=d.getStyle("z-index"),
""==zIndexOfcurrentDiv?d.setStyle("z-index",++c):(e.push(d),b.push(zIndexOfcurrentDiv));b.sort(function(a,b){return a-b});for(a=0;a<b.length;a++)for(h=0;h<e.length;h++)d=e[h],zIndexOfcurrentDiv=d.getStyle("z-index"),zIndexOfcurrentDiv==b[a]&&d.setStyle("z-index",++c)},findDivByZindex:function(a,e){for(var b=0;b<a.count();b++)if(currentDiv=a.getItem(b),zIndexOfcurrentDiv=currentDiv.getStyle("z-index"),zIndexOfcurrentDiv==e)return currentDiv;return null}}})();(function(){function a(a,b,c){c=a.config.forceEnterMode||
c;if("wysiwyg"==a.mode){b||(b=a.activeEnterMode);var d=a.elementPath();d&&!d.isContextFor("p")&&(b=POLARIS.ENTER_BR,c=1);a.fire("saveSnapshot");b==POLARIS.ENTER_BR?g(a,b,null,c):k(a,b,null,c);a.fire("saveSnapshot");a.fire("contentChange",{type:"enter",sync:!0})}}function e(a){a=a.getSelection().getRanges(!0);for(var b=a.length-1;0<b;b--)a[b].deleteContents();return a[0]}function b(a){var b=a.startContainer.getAscendant(function(a){return a.type==POLARIS.NODE_ELEMENT&&"true"==a.getAttribute("contenteditable")},
!0);if(a.root.equals(b))return a;b=new POLARIS.dom.range(b);b.moveToRange(a);return b}POLARIS.plugins.add("enterkey",{init:function(b){b.addCommand("enter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(b){a(b)}});b.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(b){a(b,b.activeShiftEnterMode,1)}});b.setKeystroke([[13,"enter"],[POLARIS.SHIFT+13,"shiftEnter"]])}});var c=POLARIS.dom.walker.whitespaces(),d=POLARIS.dom.walker.bookmark();POLARIS.plugins.enterkey={enterBlock:function(a,
h,k,q){if(k=k||e(a)){k=b(k);var v=k.document,r=k.checkStartOfBlock(),p=k.checkEndOfBlock(),t=a.elementPath(k.startContainer),w=t.block,A=h==POLARIS.ENTER_DIV?"div":"p",x;if(t&&t.elements[0]&&t.elements[0].is("ruby")&&t.elements[1]&&t.elements[1].is("p"))x=v.createElement(h==POLARIS.ENTER_P?"p":"div"),x.appendBogus(),x.insertAfter(t.elements[1]),k=new POLARIS.dom.range(v),k.moveToElementEditStart(x),k.select(),k.scrollIntoView();else{if(r&&p){if(w&&(w.is("li")||w.getParent().is("li"))){w.is("li")||
(w=w.getParent());k=w.getParent();x=k.getParent();r=!w.hasPrevious();p=!w.hasNext();q=a.getSelection();var A=q.createBookmarks(),C=w.getDirection(1),u=w.getAttribute("class"),B=w.getAttribute("style"),G=x.getDirection(1)!=C;a=a.enterMode!=POLARIS.ENTER_BR||G||B||u;if(x.is("li"))if(r||p)w[r?"insertBefore":"insertAfter"](x);else w.breakParent(x);else{if(a){t.block.is("li")?(x=v.createElement(h==POLARIS.ENTER_P?"p":"div"),G&&x.setAttribute("dir",C),B&&x.setAttribute("style",B),u&&x.setAttribute("class",
u),w.moveChildren(x)):x=t.block;if(r||p)x[r?"insertBefore":"insertAfter"](k);else w.breakParent(k),x.insertAfter(k);for(;p=w.getLast();)p.insertAfter(k)}else if(w.appendBogus(!0),r||p)for(;p=w[r?"getFirst":"getLast"]();)p[r?"insertBefore":"insertAfter"](k);else for(w.breakParent(k);p=w.getLast();)p.insertAfter(k);w.remove()}POLARIS.plugins.list.reOrder(v);q.selectBookmarks(A);return}if(w&&w.getParent().is("blockquote")){w.breakParent(w.getParent());w.getPrevious().getFirst(POLARIS.dom.walker.invisible(1))||
w.getPrevious().remove();w.getNext().getFirst(POLARIS.dom.walker.invisible(1))||w.getNext().remove();k.moveToElementEditStart(w);k.select();return}}else if(w&&w.is("pre")&&!p){g(a,h,k,q);return}if(G=k.splitBlock(A)){B=G.previousBlock;w=G.nextBlock;h=G.wasStartOfBlock;t=G.wasEndOfBlock;B&&B.removeAttribute("polaris-splitted");w?(C=w.getParent(),C.is("li")&&(w.breakParent(C),w.move(w.getNext(),1))):B&&(C=B.getParent())&&C.is("li")&&(B.breakParent(C),C=B.getNext(),k.moveToElementEditStart(C),B.move(B.getPrevious()));
if(h||t){if(B){if(B.is("li")||!f.test(B.getName())&&!B.is("pre"))if(x=B.clone(),POLARIS.env.chrome&&B.is("p")){var y=B.getChildren(),F,E=!0;a=0;for(F=y.immutableLength;a<F;a+=1)if((p=y.getItem(a))&&p.type===POLARIS.NODE_ELEMENT&&p.getBogus()){E=!1;break}E&&B.appendBogus()}}else w&&(x=w.clone());x?q&&!x.is("li")&&x.renameNode(A):C&&C.is("li")?x=C:(x=v.createElement(A),B&&(u=B.getDirection())&&x.setAttribute("dir",u));if(q=G.elementPath)for(a=0,A=q.elements.length;a<A;a++){p=q.elements[a];if(p.equals(q.block)||
p.equals(q.blockLimit))break;POLARIS.dtd.$removeEmpty[p.getName()]&&(p=p.clone(),x.moveChildren(p),x.append(p))}x.appendBogus();x.getParent()||(k.endContainer&&k.endContainer.is&&k.endContainer.is("figure")&&k.collapsed?r?x.insertBefore(k.startContainer):x.insertAfter(k.endContainer):(k.insertNode(x),POLARIS.plugins.list.reOrder(v)));x.is("li")&&x.removeAttribute("value");x.is("p")&&(x.removeStyle("margin-right"),x.removeStyle("padding-left"),x.removeStyle("padding-right"),x.removeStyle("border"),
x.removeStyle("background"),x.removeStyle("background-color"));x.removeAttribute("polaris-splitted");x.removeAttribute("doc-data-field");x.removeAttribute("doc-data-field-editable");v=x.find('[doc-data-role\x3d"page-number"]');for(a=0;a<v.count();a++)v.getItem(a).removeAttribute("doc-data-role");!POLARIS.env.ie||!h||t&&B.getChildCount()||(k.moveToElementEditStart(t?B:x),k.select());v=function(a){if(a&&a.type==POLARIS.NODE_ELEMENT){if(0<a.getText().replace(/\u200b/g,"").length)return!1;var b,c=a.getChildCount();
for(b=0;b<c;b++)if(a.getChild(b).type==POLARIS.NODE_ELEMENT)return!1;return!0}};r=x.find("[style]");for(a=0;a<r.count();a++)q=r.getItem(a),v(q)&&q.setHtml("​");k.moveToElementEditStart(h&&!t?w:x)}else w.is("li")&&(x=k.clone(),x.selectNodeContents(w),x=new POLARIS.dom.walker(x),x.evaluator=function(a){return!(d(a)||c(a)||a.type==POLARIS.NODE_ELEMENT&&a.getName()in POLARIS.dtd.$inline&&!(a.getName()in POLARIS.dtd.$empty))},(C=x.next())&&C.type==POLARIS.NODE_ELEMENT&&C.is("ul","ol")&&(POLARIS.env.needsBrFiller?
v.createElement("br"):v.createText(" ")).insertBefore(C)),w&&k.moveToElementEditStart(w),POLARIS.plugins.list.reOrder(v);k.select();k.scrollIntoView()}}}},enterBr:function(a,b,c,d){if(c=c||e(a)){var g=c.document,h=c.checkEndOfBlock(),p=new POLARIS.dom.elementPath(a.getSelection().getStartElement()),t=p.block,w=t&&p.block.getName();d||"li"!=w?(!d&&h&&f.test(w)?(h=t.getDirection())?(g=g.createElement("div"),g.setAttribute("dir",h),g.insertAfter(t),c.setStart(g,0)):(g.createElement("br").insertAfter(t),
POLARIS.env.gecko&&g.createText("").insertAfter(t),c.setStartAt(t.getNext(),POLARIS.env.ie?POLARIS.POSITION_BEFORE_START:POLARIS.POSITION_AFTER_START)):(a="pre"==w&&POLARIS.env.ie&&8>POLARIS.env.version?g.createText("\r"):g.createElement("br"),c.deleteContents(),c.insertNode(a),POLARIS.env.needsBrFiller?(g.createText("﻿").insertAfter(a),h&&(t||p.blockLimit).appendBogus(),a.getNext().$.nodeValue="",c.setStartAt(a.getNext(),POLARIS.POSITION_AFTER_START)):c.setStartAt(a,POLARIS.POSITION_AFTER_END)),
c.collapse(!0),c.select(),c.scrollIntoView()):k(a,b,c,d)}}};var h=POLARIS.plugins.enterkey,g=h.enterBr,k=h.enterBlock,f=/^h[1-6]$/})();(function(){function a(a,b){var c={},d=[],h={nbsp:" ",shy:"­",gt:"\x3e",lt:"\x3c",amp:"\x26",apos:"'",quot:'"'};a=a.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(a,e){var f=b?"\x26"+e+";":h[e];c[f]=b?h[e]:"\x26"+e+";";d.push(f);return""});if(!b&&a){a=a.split(",");var g=document.createElement("div"),k;g.innerHTML="\x26"+a.join(";\x26")+";";k=g.innerHTML;
g=null;for(g=0;g<k.length;g++){var f=k.charAt(g);c[f]="\x26"+a[g]+";";d.push(f)}}c.regex=d.join(b?"|":"");return c}POLARIS.plugins.add("entities",{afterInit:function(e){function b(a){return f[a]}function c(a){return"force"!=d.entities_processNumerical&&g[a]?g[a]:"\x26#"+a.charCodeAt(0)+";"}var d=e.config;if(e=(e=e.dataProcessor)&&e.htmlFilter){var h=[];!1!==d.basicEntities&&h.push("nbsp,gt,lt,amp");d.entities&&(h.length&&h.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),
d.entities_latin&&h.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),d.entities_greek&&h.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),
d.entities_additional&&h.push(d.entities_additional));var g=a(h.join(",")),k=g.regex?"["+g.regex+"]":"a^";delete g.regex;d.entities&&d.entities_processNumerical&&(k="[^ -~]|"+k);var k=new RegExp(k,"g"),f=a("nbsp,gt,lt,amp,shy",!0),l=new RegExp(f.regex,"g");e.addRules({text:function(a){return a.replace(l,b).replace(k,c)}},{applyToAll:!0,excludeNestedEditable:!0})}}})})();POLARIS.config.basicEntities=!0;POLARIS.config.entities=!0;POLARIS.config.entities_latin=!0;POLARIS.config.entities_greek=!0;POLARIS.config.entities_additional=
"#39";(function(){POLARIS.plugins.add("externalmedia",{init:function(a){var e=a.lang.externalmedia;a.ui.add("InsertExternalVideoUrl",POLARIS.UI_BUTTON,{label:e.insertvideourl,command:"insertExternalVideoUrl",toolbar:"externalmedia,10"});a.ui.add("InsertExternalDocumentUrl",POLARIS.UI_BUTTON,{label:e.insertdocumenturl,command:"insertExternalDocumentUrl",toolbar:"externalmedia,20"});a.addCommand("insertExternalVideoUrl",{exec:function(a,c){a.openDialog("insertExternalMediaUrl",function(){this.parts.title.setHtml(e.insertvideourl)})}});
a.addCommand("insertExternalDocumentUrl",{exec:function(a,c){a.openDialog("insertExternalMediaUrl",function(){this.parts.title.setHtml(e.insertdocumenturl)})}});POLARIS.dialog.add("insertExternalMediaUrl",this.path+"dialogs/insertExternalMediaUrl.js");a.addMenuGroup("externalmedia",120);a.addMenuItems&&a.addMenuItems({insertExternalVideoUrl:{label:e.editvideourl,command:"insertExternalVideoUrl",group:"externalmedia",order:1},insertExternalDocumentUrl:{label:e.editdocumenturl,command:"insertExternalDocumentUrl",
group:"externalmedia",order:5}});a.contextMenu&&a.contextMenu.addListener(function(a){if(!a||a.isReadOnly())return null;var c={},d=(a=a.getAscendant("a",1))&&a.getAscendant("figure",1);a&&d&&a.getAttribute("href")&&a.getChildCount()&&(a=d.getAttribute("doc-data-role"),"video"==a?c={insertVideoUrl:POLARIS.TRISTATE_OFF}:"document"==a&&(c={insertDocumentUrl:POLARIS.TRISTATE_OFF}));return c})}})})();(function(){function a(a,b){var d=c.exec(a),e=c.exec(b);if(d){if(!d[2]&&"px"==e[2])return e[1];if("px"==
d[2]&&!e[2])return e[1]+"px"}return b}var e=POLARIS.htmlParser.cssStyle,b=POLARIS.tools.cssLength,c=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,d={elements:{$:function(b){var c=b.attributes;if((c=(c=(c=c&&c["data-polaris-realelement"])&&new POLARIS.htmlParser.fragment.fromHtml(decodeURIComponent(c)))&&c.children[0])&&b.attributes["data-polaris-resizable"]){var d=(new e(b)).rules;b=c.attributes;var f=d.width,d=d.height;f&&(b.width=a(b.width,f));d&&(b.height=a(b.height,d))}return c}}};POLARIS.plugins.add("fakeobjects",
{init:function(a){a.filter.allow("img[!data-polaris-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(a){(a=(a=a.dataProcessor)&&a.htmlFilter)&&a.addRules(d,{applyToAll:!0})}});POLARIS.editor.prototype.createFakeElement=function(a,c,d,f){var l=this.lang.fakeobjects,l=l[d]||l.unknown;c={"class":c,"data-polaris-realelement":encodeURIComponent(a.getOuterHtml()),"data-polaris-real-node-type":a.type,alt:l,title:l,align:a.getAttribute("align")||""};POLARIS.env.hc||(c.src=POLARIS.tools.transparentImageData);
d&&(c["data-polaris-real-element-type"]=d);f&&(c["data-polaris-resizable"]=f,d=new e,f=a.getAttribute("width"),a=a.getAttribute("height"),f&&(d.rules.width=b(f)),a&&(d.rules.height=b(a)),d.populate(c));return this.document.createElement("img",{attributes:c})};POLARIS.editor.prototype.createFakeParserElement=function(a,c,d,f){var l=this.lang.fakeobjects,l=l[d]||l.unknown,m;m=new POLARIS.htmlParser.basicWriter;a.writeHtml(m);m=m.getHtml();c={"class":c,"data-polaris-realelement":encodeURIComponent(m),
"data-polaris-real-node-type":a.type,alt:l,title:l,align:a.attributes.align||""};POLARIS.env.hc||(c.src=POLARIS.tools.transparentImageData);d&&(c["data-polaris-real-element-type"]=d);f&&(c["data-polaris-resizable"]=f,f=a.attributes,a=new e,d=f.width,f=f.height,void 0!==d&&(a.rules.width=b(d)),void 0!==f&&(a.rules.height=b(f)),a.populate(c));return new POLARIS.htmlParser.element("img",c)};POLARIS.editor.prototype.restoreRealElement=function(b){if(b.data("polaris-real-node-type")!=POLARIS.NODE_ELEMENT)return null;
var c=POLARIS.dom.element.createFromHtml(decodeURIComponent(b.data("polaris-realelement")),this.document);if(b.data("polaris-resizable")){var d=b.getStyle("width");b=b.getStyle("height");d&&c.setAttribute("width",a(c.getAttribute("width"),d));b&&c.setAttribute("height",a(c.getAttribute("height"),b))}return c}})();POLARIS.plugins.add("find",{requires:"dialog",init:function(a){var e=a.addCommand("find",new POLARIS.dialogCommand("find"));e.canUndo=!1;e.readOnly=1;a.addCommand("replace",new POLARIS.dialogCommand("replace")).canUndo=
!1;a.ui.addButton&&(a.ui.addButton("Find",{label:a.lang.find.find,command:"find",toolbar:"find,10"}),a.ui.addButton("Replace",{label:a.lang.find.replace,command:"replace",toolbar:"find,20"}));POLARIS.dialog.add("find",this.path+"dialogs/find.js");POLARIS.dialog.add("replace",this.path+"dialogs/find.js")}});POLARIS.config.find_highlight={element:"span",styles:{"background-color":"#004",color:"#fff"}};POLARIS.plugins.add("popup");POLARIS.tools.extend(POLARIS.editor.prototype,{popup:function(a,e,b,c,
d){e=e||"80%";b=b||"70%";"string"==typeof e&&1<e.length&&"%"==e.substr(e.length-1,1)&&(e=parseInt(window.screen.width*parseInt(e,10)/100,10));"string"==typeof b&&1<b.length&&"%"==b.substr(b.length-1,1)&&(b=parseInt(window.screen.height*parseInt(b,10)/100,10));420>e&&(e=420);420>b&&(b=420);var h=parseInt((window.screen.height-b)/2,10),g=parseInt((window.screen.width-e)/2,10);c=(c||"location\x3dno,menubar\x3dno,toolbar\x3dno,dependent\x3dyes,minimizable\x3dno,modal\x3dyes,alwaysRaised\x3dyes,resizable\x3dyes,scrollbars\x3dyes")+
",width\x3d"+e+",height\x3d"+b+",top\x3d"+h+",left\x3d"+g;var k=window.open("",null,c,!0);if(!k)return!1;try{-1==navigator.userAgent.toLowerCase().indexOf(" chrome/")&&(k.moveTo(g,h),k.resizeTo(e,b)),k.focus(),k.location.href=a}catch(f){k=window.open(a,null,c,!0)}window.setTimeout(function(){void 0!=d&&null!=d&&d(k)},500);return!0}});(function(){function a(a,b){var c=[];if(b)for(var d in b)c.push(d+"\x3d"+encodeURIComponent(b[d]));else return a;return a+(-1!=a.indexOf("?")?"\x26":"?")+c.join("\x26")}
function e(a){a+="";return a.charAt(0).toUpperCase()+a.substr(1)}function b(){var b=this.getDialog(),c=b.getParentEditor();c._.filebrowserSe=this;var d=c.config["filebrowser"+e(b.getName())+"WindowWidth"]||c.config.filebrowserWindowWidth||"80%",b=c.config["filebrowser"+e(b.getName())+"WindowHeight"]||c.config.filebrowserWindowHeight||"70%",g=this.filebrowser.params||{};g.POLARISEditor=c.name;g.POLARISEditorFuncNum=c._.filebrowserFn;g.langCode||(g.langCode=c.langCode);g=a(this.filebrowser.url,g);c.popup(g,
d,b,c.config.filebrowserWindowFeatures||c.config.fileBrowserWindowFeatures)}function c(){var a=this.getDialog();a.getParentEditor()._.filebrowserSe=this;return a.getContentElement(this["for"][0],this["for"][1]).getInputElement().$.value&&a.getContentElement(this["for"][0],this["for"][1]).getAction()?!0:!1}function d(b,c,d){var e=d.params||{};e.POLARISEditor=b.name;e.POLARISEditorFuncNum=b._.filebrowserFn;e.langCode||(e.langCode=b.langCode);c.action=a(d.url,e);c.filebrowser=d}function h(a,g,k,n){if(n&&
n.length)for(var q,v=n.length;v--;)if(q=n[v],"hbox"!=q.type&&"vbox"!=q.type&&"fieldset"!=q.type||h(a,g,k,q.children),q.filebrowser)if("string"==typeof q.filebrowser&&(q.filebrowser={action:"fileButton"==q.type?"QuickUpload":"Browse",target:q.filebrowser}),"Browse"==q.filebrowser.action){var r=q.filebrowser.url;void 0===r&&(r=a.config["filebrowser"+e(g)+"BrowseUrl"],void 0===r&&(r=a.config.filebrowserBrowseUrl));r&&(q.onClick=b,q.filebrowser.url=r,q.hidden=!1)}else if("QuickUpload"==q.filebrowser.action&&
q["for"]&&(r=q.filebrowser.url,void 0===r&&(r=a.config["filebrowser"+e(g)+"UploadUrl"],void 0===r&&(r=a.config.filebrowserUploadUrl)),r)){var p=q.onClick;q.onClick=function(a){var b=a.sender;return p&&!1===p.call(b,a)?!1:c.call(b,a)};q.filebrowser.url=r;q.hidden=!1;d(a,k.getContents(q["for"][0]).get(q["for"][1]),q.filebrowser)}}function g(a,b,c){if(-1!==c.indexOf(";")){c=c.split(";");for(var d=0;d<c.length;d++)if(g(a,b,c[d]))return!0;return!1}return(a=a.getContents(b).get(c).filebrowser)&&a.url}function k(a,
b){var c=this._.filebrowserSe.getDialog(),d=this._.filebrowserSe["for"],e=this._.filebrowserSe.filebrowser.onSelect;d&&c.getContentElement(d[0],d[1]).reset();if("function"!=typeof b||!1!==b.call(this._.filebrowserSe))if(!e||!1!==e.call(this._.filebrowserSe,a,b))if("string"==typeof b&&b&&alert(b),a&&(d=this._.filebrowserSe,c=d.getDialog(),d=d.filebrowser.target||null))if(d=d.split(":"),e=c.getContentElement(d[0],d[1]))e.setValue(a),c.selectPage(d[0])}POLARIS.plugins.add("filebrowser",{requires:"popup",
init:function(a){a._.filebrowserFn=POLARIS.tools.addFunction(k,a);a.on("destroy",function(){POLARIS.tools.removeFunction(this._.filebrowserFn)})}});POLARIS.on("dialogDefinition",function(a){if(a.editor.plugins.filebrowser)for(var b=a.data.definition,c,d=0;d<b.contents.length;++d)if(c=b.contents[d])h(a.editor,a.data.name,b,c.elements),c.hidden&&c.filebrowser&&(c.hidden=!g(b,c.id,c.filebrowser))})})();(function(){function a(a){a=a.attributes;return"application/x-shockwave-flash"==a.type||b.test(a.src||
"")}function e(a,b){return a.createFakeParserElement(b,"polaris_flash","flash",!0)}var b=/\.swf(?:$|\?)/i;POLARIS.plugins.add("flash",{requires:"dialog,fakeobjects",onLoad:function(){POLARIS.addCss("img.polaris_flash{background-image: url("+POLARIS.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(a){if(!a.config.wordprocessor){var b="object[classid,codebase,height,hspace,vspace,width];param[name,value];embed[height,hspace,pluginspage,src,type,vspace,width]";
POLARIS.dialog.isTabEnabled(a,"flash","properties")&&(b+=";object[align]; embed[allowscriptaccess,quality,scale,wmode]");POLARIS.dialog.isTabEnabled(a,"flash","advanced")&&(b+=";object[id]{*}; embed[bgcolor]{*}(*)");a.addCommand("flash",new POLARIS.dialogCommand("flash",{allowedContent:b,requiredContent:"embed"}));a.ui.addButton&&a.ui.addButton("Flash",{label:a.lang.common.flash,command:"flash",toolbar:"insert,20"});POLARIS.dialog.add("flash",this.path+"dialogs/flash.js");a.addMenuItems&&a.addMenuItems({flash:{label:a.lang.flash.properties,
command:"flash",group:"flash"}});a.on("doubleclick",function(a){var b=a.data.element;b.is("img")&&"flash"==b.data("polaris-real-element-type")&&(a.data.dialog="flash")});a.contextMenu&&a.contextMenu.addListener(function(a){if(a&&a.is("img")&&!a.isReadOnly()&&"flash"==a.data("polaris-real-element-type"))return{flash:POLARIS.TRISTATE_OFF}})}},afterInit:function(b){if(!b.config.wordprocessor){var d=b.dataProcessor;(d=d&&d.dataFilter)&&d.addRules({elements:{"polaris:object":function(d){var g=d.attributes;
if(!(g.classid&&String(g.classid).toLowerCase()||a(d))){for(g=0;g<d.children.length;g++)if("polaris:embed"==d.children[g].name){if(!a(d.children[g]))break;return e(b,d)}return null}return e(b,d)},"polaris:embed":function(d){return a(d)?e(b,d):null}}},5)}}})})();POLARIS.tools.extend(POLARIS.config,{flashEmbedTagOnly:!1,flashAddEmbedTag:!0,flashConvertOnEdit:!1});(function(){function a(a){var d=a.config,h=a.fire("uiSpace",{space:"top",html:""}).html,g=function(){function h(a,c,d){f.setStyle(c,b(d));
f.setStyle("position",a)}function k(a){var b=m.getDocumentPosition();switch(a){case "top":h("absolute","top",b.y-A-u);break;case "pin":h("fixed","top",G);break;case "bottom":h("absolute","top",b.y+(t.height||t.bottom-t.top)+u)}l=a}var l,m,p,t,w,A,x,C=d.floatSpaceDockedOffsetX||0,u=d.floatSpaceDockedOffsetY||0,B=d.floatSpacePinnedOffsetX||0,G=d.floatSpacePinnedOffsetY||0;return function(d){if(m=a.editable())if(d&&"focus"==d.name&&f.show(),f.removeStyle("left"),f.removeStyle("right"),p=f.getClientRect(),
t=m.getClientRect(),w=e.getViewPaneSize(),A=p.height,x="pageXOffset"in e.$?e.$.pageXOffset:POLARIS.document.$.documentElement.scrollLeft,l){A+u<=t.top?k("top"):A+u>w.height-t.bottom?k("pin"):k("bottom");d=w.width/2;d=0<t.left&&t.right<w.width&&t.width>p.width?"rtl"==a.config.contentsLangDirection?"right":"left":d-t.left>t.right-d?"left":"right";var h;p.width>w.width?(d="left",h=0):(h="left"==d?0<t.left?t.left:0:t.right<w.width?w.width-t.right:0,h+p.width>w.width&&(d="left"==d?"right":"left",h=0));
f.setStyle(d,b(("pin"==l?B:C)+h+("pin"==l?0:"left"==d?x:-x)))}else l="pin",k("pin"),g(d)}}();if(h){var k=new POLARIS.template('\x3cdiv id\x3d"polaris_{name}" class\x3d"polaris {id} polaris_reset_all polaris_chrome polaris_editor_{name} polaris_float polaris_{langDir} '+POLARIS.env.cssClass+'" dir\x3d"{langDir}" title\x3d"'+(POLARIS.env.gecko?" ":"")+'" lang\x3d"{langCode}" role\x3d"application" style\x3d"{style}"'+(a.title?' aria-labelledby\x3d"polaris_{name}_arialbl"':" ")+"\x3e"+(a.title?'\x3cspan id\x3d"polaris_{name}_arialbl" class\x3d"polaris_voice_label"\x3e{voiceLabel}\x3c/span\x3e':
" ")+'\x3cdiv class\x3d"polaris_inner"\x3e\x3cdiv id\x3d"{topId}" class\x3d"polaris_top" role\x3d"presentation"\x3e{content}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),f=POLARIS.document.getBody().append(POLARIS.dom.element.createFromHtml(k.output({content:h,id:a.id,langDir:a.lang.dir,langCode:a.langCode,name:a.name,style:"display:none;z-index:"+(d.baseFloatZIndex-1),topId:a.ui.spaceId("top"),voiceLabel:a.title}))),l=POLARIS.tools.eventsBuffer(500,g),m=POLARIS.tools.eventsBuffer(100,g);f.unselectable();
f.on("mousedown",function(a){a=a.data;a.getTarget().hasAscendant("a",1)||a.preventDefault()});a.on("focus",function(b){g(b);a.on("change",l.input);e.on("scroll",m.input);e.on("resize",m.input)});a.on("blur",function(){f.hide();a.removeListener("change",l.input);e.removeListener("scroll",m.input);e.removeListener("resize",m.input)});a.on("destroy",function(){e.removeListener("scroll",m.input);e.removeListener("resize",m.input);f.clearCustomData();f.remove()});a.focusManager.hasFocus&&f.show();a.focusManager.add(f,
1)}}var e=POLARIS.document.getWindow(),b=POLARIS.tools.cssLength;POLARIS.plugins.add("floatingspace",{init:function(b){b.on("loaded",function(){a(this)},null,null,20)}})})();POLARIS.plugins.add("listblock",{requires:"panel",onLoad:function(){var a=POLARIS.addTemplate("panel-list",'\x3cul role\x3d"presentation" class\x3d"polaris_panel_list"\x3e{items}\x3c/ul\x3e'),e=POLARIS.addTemplate("panel-list-item",'\x3cli id\x3d"{id}" class\x3d"polaris_panel_listItem" role\x3dpresentation\x3e\x3ca id\x3d"{id}_option" _polaris_focus\x3d1 hidefocus\x3dtrue title\x3d"{title}" href\x3d"javascript:void(\'{val}\')"  {onclick}\x3d"POLARIS.tools.callFunction({clickFn},\'{val}\'); return false;" role\x3d"option"\x3e{text}\x3c/a\x3e\x3c/li\x3e'),
b=POLARIS.addTemplate("panel-list-group",'\x3ch1 id\x3d"{id}" class\x3d"polaris_panel_grouptitle" role\x3d"presentation" \x3e{label}\x3c/h1\x3e'),c=/\'/g;POLARIS.ui.panel.prototype.addListBlock=function(a,b){return this.addBlock(a,new POLARIS.ui.listBlock(this.getHolderElement(),b))};POLARIS.ui.listBlock=POLARIS.tools.createClass({base:POLARIS.ui.panel.block,$:function(a,b){b=b||{};var c=b.attributes||(b.attributes={});(this.multiSelect=!!b.multiSelect)&&(c["aria-multiselectable"]=!0);!c.role&&(c.role=
"listbox");this.base.apply(this,arguments);this.element.setAttribute("role",c.role);c=this.keys;c[40]="next";c[9]="next";c[38]="prev";c[POLARIS.SHIFT+9]="prev";c[32]=POLARIS.env.ie?"mouseup":"click";POLARIS.env.ie&&(c[13]="mouseup");c[116]="F5";this._.pendingHtml=[];this._.pendingList=[];this._.items={};this._.groups={}},_:{close:function(){if(this._.started){var b=a.output({items:this._.pendingList.join("")});this._.pendingList=[];this._.pendingHtml.push(b);delete this._.started}},getClick:function(){this._.click||
(this._.click=POLARIS.tools.addFunction(function(a){var b=this.toggle(a);if(this.onClick)this.onClick(a,b)},this));return this._.click}},proto:{add:function(a,b,g){var k=POLARIS.tools.getNextId();this._.started||(this._.started=1,this._.size=this._.size||0);this._.items[a]=k;var f;f=POLARIS.tools.htmlEncodeAttr(a).replace(c,"\\'");a={id:k,val:f,onclick:POLARIS.env.ie?'onclick\x3d"return false;" onmouseup':"onclick",clickFn:this._.getClick(),title:POLARIS.tools.htmlEncodeAttr(g||a),text:b||a};this._.pendingList.push(e.output(a))},
startGroup:function(a){this._.close();var c=POLARIS.tools.getNextId();this._.groups[a]=c;this._.pendingHtml.push(b.output({id:c,label:a}))},commit:function(){this._.close();this.element.appendHtml(this._.pendingHtml.join(""));delete this._.size;this._.pendingHtml=[]},toggle:function(a){var b=this.isMarked(a);b?this.unmark(a):this.mark(a);return!b},hideGroup:function(a){var b=(a=this.element.getDocument().getById(this._.groups[a]))&&a.getNext();a&&(a.setStyle("display","none"),b&&"ul"==b.getName()&&
b.setStyle("display","none"))},hideItem:function(a){this.element.getDocument().getById(this._.items[a]).setStyle("display","none")},showAll:function(){var a=this._.items,b=this._.groups,c=this.element.getDocument(),e;for(e in a)c.getById(a[e]).setStyle("display","");for(var f in b)a=c.getById(b[f]),e=a.getNext(),a.setStyle("display",""),e&&"ul"==e.getName()&&e.setStyle("display","")},mark:function(a){this.multiSelect||this.unmarkAll();a=this._.items[a];var b=this.element.getDocument().getById(a);
null!=b&&(b.addClass("polaris_selected"),this.element.getDocument().getById(a+"_option").setAttribute("aria-selected",!0),this.onMark&&this.onMark(b))},unmark:function(a){var b=this.element.getDocument();a=this._.items[a];var c=b.getById(a);c.removeClass("polaris_selected");b.getById(a+"_option").removeAttribute("aria-selected");this.onUnmark&&this.onUnmark(c)},unmarkAll:function(){var a=this._.items,b=this.element.getDocument(),c;for(c in a){var e=a[c];b.getById(e).removeClass("polaris_selected");
b.getById(e+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(a){return this.element.getDocument().getById(this._.items[a]).hasClass("polaris_selected")},focus:function(a){this._.focusIndex=-1;var b=this.element.getElementsByTag("a"),c,e=-1;if(a)for((a=this.element.getDocument().getById(this._.items[a]))&&(c=a.getFirst());a=b.getItem(++e);){if(a.equals(c)){this._.focusIndex=e;break}}else this.element.focus();c&&setTimeout(function(){c.focus()},0)}}})}});
POLARIS.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(a){a.ui.addHandler(POLARIS.UI_RICHCOMBO,POLARIS.ui.richCombo.handler)}});(function(){var a='\x3cspan id\x3d"{id}" class\x3d"polaris_combo polaris_combo__{name} {cls}" role\x3d"presentation"\x3e\x3cspan id\x3d"{id}_label" class\x3d"polaris_combo_label"\x3e{label}\x3c/span\x3e\x3ca class\x3d"polaris_combo_button" title\x3d"{title}" tabindex\x3d"-1"'+(POLARIS.env.gecko&&!POLARIS.env.hc?"":" href\x3d\"javascript:void('{titleJs}')\"")+
' hidefocus\x3d"true" role\x3d"button" aria-labelledby\x3d"{id}_label" aria-haspopup\x3d"true"';POLARIS.env.gecko&&POLARIS.env.mac&&(a+=' onkeypress\x3d"return false;"');POLARIS.env.gecko&&(a+=' onblur\x3d"this.style.cssText \x3d this.style.cssText;"');var e=a+'\x3e\x3cspan class\x3d"polaris_combo_ico" style\x3d"{iconStyle}"\x3e\x3c/span\x3e\x3cinput type\x3d"text" id\x3d"{id}_text" class\x3d"polaris_combo_text"  onclick\x3d"this.select();" onkeydown\x3d"return POLARIS.tools.callFunction({inputKeyDownFn},event,this);"\x3e\x3cspan class\x3d"polaris_combo_open" onkeydown\x3d"return POLARIS.tools.callFunction({keydownFn},event,this);" onfocus\x3d"return POLARIS.tools.callFunction({focusFn},event);" '+
(POLARIS.env.ie?'onclick\x3d"return false;" onmouseup':"onclick")+'\x3d"POLARIS.tools.callFunction({clickFn},this);return false;"\x3e\x3cspan class\x3d"polaris_combo_arrow"\x3e'+(POLARIS.env.hc?"\x26#9660;":POLARIS.env.air?"\x26nbsp;":"")+"\x3c/span\x3e\x3c/span\x3e\x3c/a\x3e\x3c/span\x3e",b=POLARIS.addTemplate("combo",a+' onkeydown\x3d"return POLARIS.tools.callFunction({keydownFn},event,this);" onfocus\x3d"return POLARIS.tools.callFunction({focusFn},event);" '+(POLARIS.env.ie?'onclick\x3d"return false;" onmouseup':
"onclick")+'\x3d"POLARIS.tools.callFunction({clickFn},this);return false;"\x3e\x3cspan class\x3d"polaris_combo_ico" style\x3d"{iconStyle}"\x3e\x3c/span\x3e\x3cspan id\x3d"{id}_text" class\x3d"polaris_combo_text polaris_combo_inlinelabel"\x3e{label}\x3c/span\x3e\x3cspan class\x3d"polaris_combo_open"\x3e\x3cspan class\x3d"polaris_combo_arrow"\x3e'+(POLARIS.env.hc?"\x26#9660;":POLARIS.env.air?"\x26nbsp;":"")+"\x3c/span\x3e\x3c/span\x3e\x3c/a\x3e\x3c/span\x3e"),c=POLARIS.addTemplate("editableCombo",e);
POLARIS.UI_RICHCOMBO="richcombo";POLARIS.ui.richCombo=POLARIS.tools.createClass({$:function(a){POLARIS.tools.extend(this,a,{canGroup:!1,title:a.label,modes:{wysiwyg:1},editorFocus:1});a=this.panel||{};delete this.panel;this.id=POLARIS.tools.getNextNumber();this.document=a.parent&&a.parent.getDocument()||POLARIS.document;a.className="polaris_combopanel";a.block={multiSelect:a.multiSelect,attributes:a.attributes};a.toolbarRelated=!0;this._={panelDefinition:a,items:{}};if(this.onCreate)this.onCreate()},
proto:{renderHtml:function(a){var b=[];this.render(a,b);return b.join("")},render:function(a,e){function g(){if(!(this.onUpdateState&&this.onUpdateState()||this.getState()==POLARIS.TRISTATE_ON)){var b=this.modes[a.mode]?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;a.readOnly&&!this.readOnly&&(b=POLARIS.TRISTATE_DISABLED);this.setState(b);this.setValue("");b!=POLARIS.TRISTATE_DISABLED&&this.refresh&&this.refresh()}}var k=POLARIS.env,f="polaris_"+this.id,l=POLARIS.tools.addFunction(function(b){p&&
(a.unlockSelection(1),p=0);n.execute(b)},this),m=this,n={id:f,combo:this,focus:function(){POLARIS.document.getById(f).getChild(1).focus()},execute:function(b){var c=m._;if(c.state!=POLARIS.TRISTATE_DISABLED)if(m.createPanel(a),c.on)c.panel.hide();else{m.commit();var e=m.getValue();e?c.list.mark(e):c.list.unmarkAll();b=new POLARIS.dom.element(b);this.combo.option&&this.combo.option.isEditable&&(e=b.getAscendant("a"),b&&b.hasClass("polaris_combo_open")&&e&&e.hasClass("polaris_combo_button")&&(b=e));
c.panel.showBlock(m.id,b,4)}},clickFn:l};a.on("activeFilterChange",g,this);a.on("mode",g,this);a.on("selectionChange",g,this);!this.readOnly&&a.on("readOnly",g,this);var q=POLARIS.tools.addFunction(function(b,c){b=new POLARIS.dom.event(b);var e=b.getKeystroke();if(40==e)a.once("panelShow",function(a){a.data._.panel._.currentBlock.onKeyDown(40)});switch(e){case 13:case 32:case 40:POLARIS.tools.callFunction(l,c);break;default:n.onkey(n,e)}b.preventDefault()}),v=POLARIS.tools.addFunction(function(b,
c){var e=new POLARIS.dom.event(b),f=e.getKeystroke(),g=c.value,h=c.getAttribute("value"),k=n.combo.option&&n.combo.option.isAllowOnlyNumber;13==f?(""==g||k&&isNaN(Number(g))?(c.value=h,c.setAttribute("value",h)):(100<parseInt(g)?g=100:8>parseInt(g)&&(g=8),f="\x3ctable\x3e\x3cthead\x3e\x3ctr\x3e",f+="\x3cth colspan\x3d3\x3e글꼴의 크기는 8이상 100이하이어야 합니다.\x3cbr\x3e\x3cbr\x3e\x3c/th\x3e",f+="\x3c/tr\x3e",f+="\x3c/thead\x3e",f+="\x3c/table\x3e",(new POLARIS.plugins.notification(a,{message:f,type:"info",duration:3E3,
width:300,valign:"top",align:"center"})).show(),n.combo.onClick(g),c.value=g,c.setAttribute("value",g)),e.preventDefault()):27==f?(c.value=h,c.setAttribute("value",h),e.preventDefault()):116===f&&e.preventDefault()}),r=POLARIS.tools.addFunction(function(){n.onfocus&&n.onfocus()}),p=0;n.keyDownFn=q;n.inputKeyDownFn=v;k={id:f,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:k.gecko&&!k.hc?"":(this.title||"").replace("'",""),keydownFn:q,inputKeyDownFn:v,focusFn:r,
clickFn:l,maxlength:this.option&&this.option.maxlength?this.option.maxlength:"4",iconStyle:POLARIS.skin.getIconStyle(this.name||this.command)};this.option&&this.option.isEditable?c.output(k,e):b.output(k,e);if(this.onRender)this.onRender();return n},createPanel:function(a){if(!this._.panel){var b=this._.panelDefinition,c=this._.panelDefinition.block,e=b.parent||POLARIS.document.getBody(),f="polaris_combopanel__"+this.name,l=new POLARIS.ui.floatPanel(a,e,b),m=l.addListBlock(this.id,c),n=this;l.onShow=
function(){this.element.addClass(f);n.setState(POLARIS.TRISTATE_ON);n._.on=1;n.editorFocus&&!a.focusManager.hasFocus&&a.focus();if(n.onOpen)n.onOpen();a.once("panelShow",function(){m.focus(!m.multiSelect&&n.getValue())})};l.onHide=function(b){this.element.removeClass(f);n.setState(n.modes&&n.modes[a.mode]?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED);n._.on=0;if(!b&&n.onClose)n.onClose()};l.onEscape=function(){l.hide(1)};m.onClick=function(a,b){n.onClick&&n.onClick.call(n,a,b);l.hide()};this._.panel=
l;this._.list=m;l.getBlock(this.id).onHide=function(){n._.on=0;n.setState(POLARIS.TRISTATE_OFF)};this.init&&this.init()}},setValue:function(a,b){this._.value=a;var c=this.document.getById("polaris_"+this.id+"_text");c&&(a||b||(b=this.label),this.option&&this.option.isEditable?(c.setValue("undefined"!=typeof b?b:a),c.setAttribute("value","undefined"!=typeof b?b:a)):(a||b?c.removeClass("polaris_combo_inlinelabel"):c.addClass("polaris_combo_inlinelabel"),c.setText("undefined"!=typeof b?b:a)))},getValue:function(){return this._.value||
""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(a){this._.list.mark(a)},hideItem:function(a){this._.list.hideItem(a)},hideGroup:function(a){this._.list.hideGroup(a)},showAll:function(){this._.list.showAll()},add:function(a,b,c){this._.items[a]=c||a;this._.list.add(a,b,c)},startGroup:function(a){this._.list.startGroup(a)},commit:function(){this._.committed||(this._.list.commit(),this._.committed=1,POLARIS.ui.fire("ready",this));this._.committed=1},setState:function(a){if(this._.state!=
a){var b=this.document.getById("polaris_"+this.id);b.setState(a,"polaris_combo");a==POLARIS.TRISTATE_DISABLED?b.setAttribute("aria-disabled",!0):b.removeAttribute("aria-disabled");this._.state=a}},getState:function(){return this._.state},enable:function(){this._.state==POLARIS.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){this._.state!=POLARIS.TRISTATE_DISABLED&&(this._.lastState=this._.state,this.setState(POLARIS.TRISTATE_DISABLED))}},statics:{handler:{create:function(a){return new POLARIS.ui.richCombo(a)}}}});
POLARIS.ui.prototype.addRichCombo=function(a,b){this.add(a,POLARIS.UI_RICHCOMBO,b)}})();(function(){function a(a,c,e,h,m,n,q,v,r){n=a.config;var p=new POLARIS.style(q),t=m.split(";");m=[];for(var w={},A=0;A<t.length;A++){var x=t[A];if(x){var x=x.split("/"),C={},u=t[A]=x[0];C[e]=m[A]=x[1]||u;w[u]=new POLARIS.style(q,C);w[u]._.definition.name=u}else t.splice(A--,1)}var B=[];a.ui.addRichCombo(c,{label:h.panelTitle,title:h.panelTitle,toolbar:"styles,"+v,allowedContent:p,requiredContent:p,option:r,panel:{css:[POLARIS.skin.getPath("editor")].concat(n.contentsCss),
multiSelect:!1,attributes:{"aria-label":h.panelTitle}},onCreate:function(){var e=function(a,b){var c=0;if(0<a.indexOf("%")){a=parseFloat(a.replace(/[^0-9|.]/g,""));"lineheightwide"==b?c=a+10:"lineheightnarrow"==b&&(c=a-10);if(10>c||400<c)return a+"%";c+="%"}else if(0<a.indexOf("mm")){a=parseFloat(a.replace(/[^0-9|.]/g,""));"lineheightwide"==b?c=a+1:"lineheightnarrow"==b&&(c=a-1);if(.4>c||16.9<c)return a+"mm";c+="mm"}else if(0<a.indexOf("pt")){a=parseFloat(a.replace(/[^0-9|.]/g,""));"lineheightwide"==
b?c=a+1:"lineheightnarrow"==b&&(c=a-1);if(1.2>c||48<c)return a+"pt";c+="pt"}else if(0<a.indexOf("px")){a=parseFloat(a.replace(/[^0-9|.]/g,""));"lineheightwide"==b?c=a+1:"lineheightnarrow"==b&&(c=a-1);if(1.6>c||64<c)return a+"px";c+="px"}else if(a=parseFloat(a),"lineheightwide"==b?c=a+.1:"lineheightnarrow"==b&&(c=a-.1),.1>c||4<c)return a;return c},f=function(c){c=c.data;a.focus();a.fire("saveSnapshot");var f=function(){a.fire("contentChange","fontChange")},h=a.getSelection(),k=this.getValue(),l=w[c];
l||q&&"font-size"==q.styleName&&(l=new POLARIS.style(q,{size:c+"pt"}));var m=POLARIS.plugins.tabletools.getSelectedCells(h);if(m&&0<m.length&&POLARIS.plugins.tabletools.hasSelectedCell(m)){for(h=0;h<m.length;h++){c=m[h];var n=new POLARIS.dom.range(a.document);n.selectNodeContents(c);l.applyToRange(n)}a.fire("saveSnapshot");a.fire("change");a.fire("selectionChange",{selection:a.getSelection(),path:a.elementPath()})}else{if("lineheight"==this.name){if(l&&"p"==l.element){l=POLARIS.tools.getSelectedParagraph(a);
for(h=0;h<l.length;h++)if(n=l[h],k!=c){n.setStyle("line-height",c);for(var m=n.find("span"),r=0;r<m.count();r++){var p=m.getItem(r);p.getStyle("line-height")&&p.setStyle("line-height","")}}a.fire("saveSnapshot");a.fire("selectionChange",{selection:a.getSelection(),path:a.elementPath()});f();return}if(!l&&("lineheightwide"==c||"lineheightnarrow"==c)){l=POLARIS.tools.getSelectedParagraph(a);for(h=0;h<l.length;h++){n=l[h];m=n.find("[style]");for(r=0;r<m.count();r++)(p=m.getItem(r))&&(k=p.getStyle("line-height"))&&
(k=e(k,c))&&p.setStyle("line-height",k);(k=n.getStyle("line-height"))||(k=b(n,"line-height"));(k=e(k,c))&&n.setStyle("line-height",k)}a.fire("saveSnapshot");a.fire("selectionChange",{selection:a.getSelection(),path:a.elementPath()});f();return}}if(k&&c!=k){var x=w[k],n=a.getSelection().getRanges()[0];if(n.collapsed){if(r=a.elementPath(),h=r.lastElement,m=r.contains(function(a){return x?x.checkElementRemovable(a):!1})){var p=n.checkBoundaryOfElement(m,POLARIS.START),u=n.checkBoundaryOfElement(m,POLARIS.END);
if(p&&u){for(p=n.createBookmark();r=m.getFirst();)r.insertBefore(m);m.remove();n.moveToBookmark(p)}else p?(n.moveToPosition(m,POLARIS.POSITION_BEFORE_START),0==m.equals(h)&&d(n,r.elements.slice(),m)):u?(n.moveToPosition(m,POLARIS.POSITION_AFTER_END),0==m.equals(h)&&d(n,r.elements.slice(),m)):(n.splitElement(m),n.moveToPosition(m,POLARIS.POSITION_AFTER_END),d(n,r.elements.slice(),m));a.getSelection().selectRanges([n]);POLARIS.plugins.inputmethod.cleanZWSPInElement(h,{isRemoveEmptyNode:!1,isRecursion:!1})}}else x&&
a.removeStyle(x)}a[k==c?"removeStyle":"applyStyle"](l);a.fire("saveSnapshot")}f()};if(!a.hasListeners("onClick"+c))a.on("onClick"+c,f,this);B.push(this)},init:function(){this.startGroup(h.panelTitle);for(var b=0;b<t.length;b++){var c=t[b];h.label!=a.lang.font.fontSpacing.label&&h.label!=a.lang.font.lineHeight.label?this.add(c,w[c].buildPreview(),c):this.add(c,w[c].name,c)}},onClick:function(b){a.fire("onClick"+c,b)},onRender:function(){},onUpdateState:function(){return!0},refresh:function(){a.activeFilter.check(p)||
this.setState(POLARIS.TRISTATE_DISABLED)},getStyles:function(){return w},setComboValue:function(a,b){for(var c=0;c<B.length;c++){var d=B[c];d&&b==d.name&&d.setValue(a)}}})}function e(a,b,c,d){a=a.elementPath(b).elements;for(var e=0;e<a.length;e++){b=a[e];b.is("br")&&(b=b.getParent());var h;a:{h=b;var q=c,v=void 0;for(v in q){var r=q[v].getDefinition().styleName,r=h.getStyle(r);if(POLARIS.tools.isEmptyValue(r)){h=null;break a}if(q[v].checkElementStyleMatch(h)){h=v;break a}}h=null}b=b.getStyle(d);"font-size"==
d?0<b.indexOf("px")&&(b=Math.round(.7568*parseInt(b))):"letter-spacing"==d&&("normal"==b?b="0pt":0<b.indexOf("px")&&(b=Math.round(.7568*parseInt(b))+"pt"));if(!h&&b)return b;if(h)return h}return null}function b(a,b){for(var c;!a.hasAttribute||!a.hasAttribute(b);){if(a.getStyle(b)){c=a.getStyle(b).replace(/'/g,"");break}var d=a.getParent();if(!d)break;a=d}return c}function c(a,b){var c;if(""==b)return 0;for(var d=0;d<a.length;d++){var e=a[d];if(e&&1<e.split("/").length){if(e=e.split("/"),e[0].toLowerCase()==
b.toLowerCase()||e[1].toLowerCase()==b.toLowerCase()){c=d;break}}else if(e==b){c=d;break}}return c}function d(a,b,c){var e=b.pop();if(e){if(c)return d(a,b,e.equals(c)?null:c);c=e.clone();a.insertNode(c);a.moveToPosition(c,POLARIS.POSITION_AFTER_START);d(a,b)}}var h=function(a,b,c){this.editor=a;this.comboName=b;this.commandName=c};h.prototype={editorFocus:0,exec:function(a,d){var e=a.getSelection().getStartElement();if("fontsizesmall"==this.commandName||"fontsizebig"==this.commandName){var h=a.config.fontSize_sizes.split(";"),
e=b(e,"font-size");e||(e=a.config.documentFontSize);e=c(h,e);void 0==e&&(e=c(h,a.config.documentFontSize));e="fontsizesmall"==this.commandName?e-1:e+1;(d=h[e])&&a.fire("onClick"+this.comboName,d.split("/")[0])}else"letterspacingwide"==this.commandName||"letterspacingnarrow"==this.commandName?(h=a.config.letter_space.split(";"),e=b(e,"letter-spacing"),e||(e=a.config.letterSpace_defaultLabel),e=c(h,e),void 0==e&&(e=c(h,a.config.letterSpace_defaultLabel)),e="letterspacingnarrow"==this.commandName?e-
1:e+1,(d=h[e])&&a.fire("onClick"+this.comboName,d)):"lineheightnarrow"==this.commandName||"lineheightwide"==this.commandName?a.fire("onClick"+this.comboName,this.commandName):"nextfont"==this.commandName||"previousfont"==this.commandName?(h=a.config.font_names.split(";"),e=b(e,"font-family"),e||(e=a.config.documentFontFamily),e=c(h,e),void 0==e&&(e=c(h,a.config.documentFontFamily)),e="previousfont"==this.commandName?e-1:e+1,(d=h[e])&&a.fire("onClick"+this.comboName,d.split("/")[0])):"fontsize"==this.commandName&&
d&&(h=e.getStyle("font-size"),isNaN(parseFloat(h))?(d=parseFloat(d),a.fire("onClick"+this.comboName,d)):e.setStyle("font-size",d))}};POLARIS.plugins.add("font",{requires:"richcombo",icons:"font,fontshape",hidpi:!0,init:function(b){var c=b.config,d=a(b,"Font","family",b.lang.font,b.config.font_names,c.documentFontFamily,c.font_style,30);a(b,"FontSize","size",b.lang.font.fontSize,c.fontSize_sizes,c.documentFontSize,c.fontSize_style,40,{isEditable:!0,isAllowOnlyNumber:!0});a(b,"letter-spacing","letter-spacing",
b.lang.font.fontSpacing,c.letter_space,c.letterSpace_defaultLabel,c.letter_spacing,8);a(b,"lineheight","size",b.lang.font.lineHeight,c.line_height,c.lineHeight_defaultLabel,c.lineHeight_style,40);b.ui.addButton&&b.ui.addButton("FontShape",{label:b.lang.font.label,command:"fontShape",toolbar:"style,100"});b.addCommand("fontShape",new POLARIS.dialogCommand("fontShape"));POLARIS.dialog.add("fontShape",this.path+"dialogs/fontshape.js");b.addMenuItems({font_shape:{label:b.lang.font.label,group:"style",
command:"fontShape"}});b.contextMenu&&b.contextMenu.addListener(function(a,b,c){if(!a||a.isReadOnly()||!c)return null;if(!c||!c.contains({td:1,th:1,img:1},1))return{font_shape:POLARIS.TRISTATE_OFF}});var l=new h(b,"FontSize","fontsizesmall"),m=new h(b,"FontSize","fontsizebig"),n=new h(b,"letter-spacing","letterspacingwide"),q=new h(b,"letter-spacing","letterspacingnarrow"),v=new h(b,"Font","nextfont"),r=new h(b,"Font","previousfont"),p=new h(b,"lineheight","lineheightwide"),t=new h(b,"lineheight",
"lineheightnarrow");fontSize=new h(b,"FontSize","fontsize");b.addCommand("fontsizesmall",l);b.addCommand("fontsizebig",m);b.addCommand("letterspacingwide",n);b.addCommand("letterspacingnarrow",q);b.addCommand("nextfont",v);b.addCommand("previousfont",r);b.addCommand("lineheightwide",p);b.addCommand("lineheightnarrow",t);b.addCommand("fontsize",fontSize);b.on("contentDom",function(a){a=a.editor.document.findOne("body");a.setStyle("font-size",c.documentFontSize+"pt");a.setStyle("font-family",c.documentFontFamily);
a.setStyle("line-height",POLARIS.config.lineHeight_defaultLabel);a.setStyle("letter-spacing",POLARIS.config.letterSpace_defaultLabel)});b.setKeystroke([[POLARIS.ALT+POLARIS.SHIFT+69,"fontsizebig"],[POLARIS.ALT+POLARIS.SHIFT+82,"fontsizesmall"],[POLARIS.CTRL+219,"fontsizesmall"],[POLARIS.CTRL+221,"fontsizebig"],[POLARIS.ALT+POLARIS.SHIFT+87,"letterspacingwide"],[POLARIS.ALT+POLARIS.SHIFT+78,"letterspacingnarrow"],[POLARIS.ALT+POLARIS.SHIFT+70,"nextfont"],[POLARIS.ALT+POLARIS.SHIFT+71,"previousfont"],
[POLARIS.ALT+POLARIS.SHIFT+90,"lineheightwide"],[POLARIS.ALT+POLARIS.SHIFT+65,"lineheightnarrow"],[POLARIS.CTRL+POLARIS.SHIFT+87,"lineheightwide"],[POLARIS.CTRL+POLARIS.SHIFT+81,"lineheightnarrow"],[POLARIS.ALT+76,"fontShape"]]);d=[{comboName:"Font",styleDefinition:c.font_style},{comboName:"FontSize",styleDefinition:c.fontSize_style},{comboName:"letter-spacing",styleDefinition:c.letter_spacing},{comboName:"lineheight",styleDefinition:c.lineHeight_style}];b.on("selectionChange",function(a){var c=b.getSelection(),
h=c.getRanges()[0];a=[];if(!b.readOnly){if((c=POLARIS.plugins.tabletools.getSelectedCells(c))&&0<c.length&&POLARIS.plugins.tabletools.hasSelectedCell(c))for(h=0;h<c.length;h++){var k=c[h],l=k.getTextBrNodes();a=a.concat(l);0>l.length&&a.push(k)}else for(h=new POLARIS.dom.walker(h);node=h.next();)node.type==POLARIS.NODE_TEXT&&a.push(node);for(h=0;h<d.length;h++){var c=b.ui.items[d[h].comboName],l=c.getStyles(),k=d[h].styleDefinition.styleName,m;a:{m=b;for(var n=a,r=l,q=k,p=void 0,t=0;t<n.length;t++){var v=
n[t];if(v.type!=POLARIS.NODE_TEXT||0!=v.getText()){v=e(m,v,r,q);if(p&&p!=v){m=!1;break a}p=v}}m=!0}m?(l=e(b,a[0],l,k),"font-size"==k&&"string"===typeof l&&(k=l.replace(/[0-9|.|-]/g,""),"pt"==k&&(l=l.replace(k,""))),c.setComboValue(l,c.name)):c.setComboValue("",c.name)}}})}})})();POLARIS.config.font_style={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}},{element:"font",styles:{"font-family":null}}],styleName:"font-family"};POLARIS.config.fontSize_style=
{element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}},{element:"font",styles:{"font-size":null}}],styleName:"font-size"};POLARIS.config.letter_space="-4pt;-3.9pt;-3.8pt;-3.7pt;-3.6pt;-3.5pt;-3.4pt;-3.3pt;-3.2pt;-3.1pt;-3pt;-2.9pt;-2.8pt;-2.7pt;-2.6pt;-2.5pt;-2.4pt;-2.3pt;-2.2pt;-2.1pt;-2pt;-1.9pt;-1.8pt;-1.7pt;-1.6pt;-1.5pt;-1.4pt;-1.3pt;-1.2pt;-1.1pt;-1pt;-0.9pt;-0.8pt;-0.7pt;-0.6pt;-0.5pt;-0.4pt;-0.3pt;-0.2pt;-0.1pt;0pt;0.1pt;0.2pt;0.3pt;0.4pt;0.5pt;0.6pt;0.7pt;0.8pt;0.9pt;1pt;1.1pt;1.2pt;1.3pt;1.4pt;1.5pt;1.6pt;1.7pt;1.8pt;1.9pt;2pt;2.1pt;2.2pt;2.3pt;2.4pt;2.5pt;2.6pt;2.7pt;2.8pt;2.9pt;3pt;";
POLARIS.config.letterSpace_defaultLabel="0pt";POLARIS.config.letter_spacing={element:"span",styles:{"letter-spacing":"#(letter-spacing)"},overrides:[{element:"font",attributes:{"letter-spacing":null}}],styleName:"letter-spacing"};POLARIS.config.line_height="0.6;0.7;0.8;0.9;1;1.1;1.2;1.3;1.4;1.5;1.6;1.7;1.8;1.9;2;2.1;2.2;2.3;2.4;2.5;2.6;2.7;2.8;2.9;3;3.1;3.2;3.3;3.4;3.5;3.6;3.7;3.8;3.9;4;";POLARIS.config.lineHeight_defaultLabel="1.6";POLARIS.config.lineHeight_style={element:"p",styles:{"line-height":"#(size)"},
overrides:[{element:"line-height",attributes:{size:null}}],styleName:"line-height"};POLARIS.plugins.add("format",{requires:"richcombo",icons:"paragraphcopy,style,paragraphStyle",init:function(a){if(!a.config.wordprocessor&&!a.blockless){for(var e=a.config,b=a.lang.format,c=e.format_tags.split(";"),d={},h=0,g=[],k=0;k<c.length;k++){var f=c[k],l=new POLARIS.style(e["format_"+f]);if(!a.filter.customConfig||a.filter.check(l))h++,d[f]=l,d[f]._.enterMode=a.config.enterMode,g.push(l)}0!==h&&(a.ui.addRichCombo("Format",
{label:b.label,title:b.panelTitle,toolbar:"styles,20",allowedContent:g,panel:{css:[POLARIS.skin.getPath("editor")].concat(e.contentsCss),multiSelect:!1,attributes:{"aria-label":b.panelTitle}},init:function(){this.startGroup(b.panelTitle);for(var a in d){var c=b["tag_"+a];this.add(a,d[a].buildPreview(c),c)}},onClick:function(b){a.focus();a.fire("saveSnapshot");b=d[b];var c=a.elementPath();if(b.type==POLARIS.STYLE_BLOCK&&c.block){var e=c.block;if(e.$&&e.$.style)for(var e=e.$.attributes,f=0;f<e.length;f++)"style"==
e[f].name&&(e[f].nodeValue="")}a[b.checkActive(c,a)?"removeStyle":"applyStyle"](b);setTimeout(function(){a.fire("saveSnapshot")},0)},onRender:function(){a.on("selectionChange",function(b){var c=this.getValue();b=b.data.path;this.refresh();for(var e in d)if(d[e].checkActive(b,a)){e!=c&&this.setValue(e,a.lang.format["tag_"+e]);return}this.setValue("p",a.lang.format.tag_p)},this)},onOpen:function(){this.showAll();for(var b in d)a.activeFilter.check(d[b])||this.hideItem(b)},refresh:function(){var b=a.elementPath();
if(b){if(b.isContextFor("p"))for(var c in d)if(a.activeFilter.check(d[c]))return;this.setState(POLARIS.TRISTATE_DISABLED)}}}),a.ui.addButton&&a.ui.addButton("ParagraphCopy",{label:a.lang.format.paragraphCopy,command:"paragraphCopy",toolbar:"style,100"}),a.ui.addButton&&a.ui.addButton("Style",{label:a.lang.format.style2,command:"style",toolbar:"style,100"}),a.ui.addButton&&a.ui.addButton("ParagraphStyle",{label:a.lang.format.paragraphStyle,command:"paragraphStyle",toolbar:"style,100"}))}}});POLARIS.config.format_tags=
"p;h1;h2;h3;h4;h5;h6";POLARIS.config.format_p={element:"p"};POLARIS.config.format_div={element:"div"};POLARIS.config.format_pre={element:"pre"};POLARIS.config.format_address={element:"address"};POLARIS.config.format_h1={element:"h1"};POLARIS.config.format_h2={element:"h2"};POLARIS.config.format_h3={element:"h3"};POLARIS.config.format_h4={element:"h4"};POLARIS.config.format_h5={element:"h5"};POLARIS.config.format_h6={element:"h6"};POLARIS.plugins.add("forms",{requires:"dialog,fakeobjects",onLoad:function(){POLARIS.addCss(".polaris_editable form{border: 1px dotted #FF0000;padding: 2px;}\n");
POLARIS.addCss("img.polaris_hidden{background-image: url("+POLARIS.getUrl(this.path+"images/hiddenfield.gif")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 16px !important;height: 16px !important;}")},init:function(a){var e=a.lang,b=0,c={email:1,password:1,search:1,tel:1,text:1,url:1},d={checkbox:"input[type,name,checked]",radio:"input[type,name,checked]",textfield:"input[type,name,value,size,maxlength]",textarea:"textarea[cols,rows,name]",select:"select[name,size,multiple]; option[value,selected]",
button:"input[type,name,value]",form:"form[action,name,id,enctype,target,method]",hiddenfield:"input[type,name,value]",imagebutton:"input[type,alt,src]{width,height,border,border-width,border-style,margin,float}"},h={checkbox:"input",radio:"input",textfield:"input",textarea:"textarea",select:"select",button:"input",form:"form",hiddenfield:"input",imagebutton:"input"},g=function(c,f,g){var k={allowedContent:d[f],requiredContent:h[f]};"form"==f&&(k.context="form");a.addCommand(f,new POLARIS.dialogCommand(f,
k));a.ui.addButton&&a.ui.addButton(c,{label:e.common[c.charAt(0).toLowerCase()+c.slice(1)],command:f,toolbar:"forms,"+(b+=10)});POLARIS.dialog.add(f,g)},k=this.path+"dialogs/";!a.blockless&&g("Form","form",k+"form.js");g("Checkbox","checkbox",k+"checkbox.js");g("Radio","radio",k+"radio.js");g("TextField","textfield",k+"textfield.js");g("Textarea","textarea",k+"textarea.js");g("Select","select",k+"select.js");g("Button","button",k+"button.js");var f=a.plugins.image;f&&!a.plugins.image2&&g("ImageButton",
"imagebutton",POLARIS.plugins.getPath("image")+"dialogs/image.js");g("HiddenField","hiddenfield",k+"hiddenfield.js");a.addMenuItems&&(g={checkbox:{label:e.forms.checkboxAndRadio.checkboxMenu,command:"checkbox",group:"checkbox"},radio:{label:e.forms.checkboxAndRadio.radioMenu,command:"radio",group:"radio"},textfield:{label:e.forms.textfield.menu,command:"textfield",group:"textfield"},hiddenfield:{label:e.forms.hidden.menu,command:"hiddenfield",group:"hiddenfield"},button:{label:e.forms.button.menu,
command:"button",group:"button"},select:{label:e.forms.select.menu,command:"select",group:"select"},textarea:{label:e.forms.textarea.menu,command:"textarea",group:"textarea"}},f&&(g.imagebutton={label:e.image.buttonMenu,command:"imagebutton",group:"imagebutton"}),!a.blockless&&(g.form={label:e.forms.form.menu,command:"form",group:"form"}),a.addMenuItems(g));a.contextMenu&&(!a.blockless&&a.contextMenu.addListener(function(a,b,c){if(c&&(a=c.contains("form",1))&&!a.isReadOnly())return{form:POLARIS.TRISTATE_OFF}}),
a.contextMenu.addListener(function(a){if(a&&!a.isReadOnly()){var b=a.getName();if("select"==b)return{select:POLARIS.TRISTATE_OFF};if("textarea"==b)return{textarea:POLARIS.TRISTATE_OFF};if("input"==b){var d=a.getAttribute("type")||"text";switch(d){case "button":case "submit":case "reset":return{button:POLARIS.TRISTATE_OFF};case "checkbox":return{checkbox:POLARIS.TRISTATE_OFF};case "radio":return{radio:POLARIS.TRISTATE_OFF};case "image":return f?{imagebutton:POLARIS.TRISTATE_OFF}:null}if(c[d])return{textfield:POLARIS.TRISTATE_OFF}}if("img"==
b&&"hiddenfield"==a.data("polaris-real-element-type"))return{hiddenfield:POLARIS.TRISTATE_OFF}}}));a.on("doubleclick",function(b){if(1==a.config.editMode){var d=b.data.element;if(!a.blockless&&d.is("form"))b.data.dialog="form";else if(d.is("select"))b.data.dialog="select";else if(d.is("textarea"))b.data.dialog="textarea";else if(d.is("img")&&"hiddenfield"==d.data("polaris-real-element-type"))b.data.dialog="hiddenfield";else if(d.is("input")){d=d.getAttribute("type")||"text";switch(d){case "button":case "submit":case "reset":b.data.dialog=
"button";break;case "checkbox":b.data.dialog="checkbox";break;case "radio":b.data.dialog="radio";break;case "image":b.data.dialog="imagebutton"}c[d]&&(b.data.dialog="textfield")}}})},afterInit:function(a){var e=a.dataProcessor,b=e&&e.htmlFilter,e=e&&e.dataFilter;POLARIS.env.ie&&b&&b.addRules({elements:{input:function(a){a=a.attributes;var b=a.type;b||(a.type="text");"checkbox"!=b&&"radio"!=b||"on"!=a.value||delete a.value}}},{applyToAll:!0});e&&e.addRules({elements:{input:function(b){if("hidden"==
b.attributes.type)return a.createFakeParserElement(b,"polaris_hidden","hiddenfield")}}},{applyToAll:!0})}});(function(){var a={canUndo:!1,exec:function(a){var b=a.document.createElement("hr");a.insertElement(b)},allowedContent:"hr",requiredContent:"hr"};POLARIS.plugins.add("horizontalrule",{init:function(e){e.blockless||(e.addCommand("horizontalrule",a),e.ui.addButton&&e.ui.addButton("HorizontalRule",{label:e.lang.horizontalrule.toolbar,command:"horizontalrule",toolbar:"insert,40"}))}})})();(function(){POLARIS.plugins.add("iframe",
{requires:"dialog,fakeobjects",onLoad:function(){POLARIS.addCss("img.polaris_iframe{background-image: url("+POLARIS.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(a){if(!a.config.wordprocessor){var e=a.lang.iframe;POLARIS.dialog.add("iframe",this.path+"dialogs/iframe.js");a.addCommand("iframe",new POLARIS.dialogCommand("iframe",{allowedContent:"iframe[align,longdesc,frameborder,height,name,scrolling,src,title,width]",
requiredContent:"iframe"}));a.ui.addButton&&a.ui.addButton("Iframe",{label:e.toolbar,command:"iframe",toolbar:"insert,80"});a.on("doubleclick",function(a){var c=a.data.element;c.is("img")&&"iframe"==c.data("polaris-real-element-type")&&(a.data.dialog="iframe")});a.addMenuItems&&a.addMenuItems({iframe:{label:e.menu,command:"iframe",group:"image"}});a.contextMenu&&a.contextMenu.addListener(function(a){if(a&&a.is("img")&&"iframe"==a.data("polaris-real-element-type"))return{iframe:POLARIS.TRISTATE_OFF}})}},
afterInit:function(a){if(!a.config.wordprocessor){var e=a.dataProcessor;(e=e&&e.dataFilter)&&e.addRules({elements:{iframe:function(b){return a.createFakeParserElement(b,"polaris_iframe","iframe",!0)}}})}}})})();(function(){POLARIS.plugins.add("image",{requires:"dialog",init:function(a){if(!a.plugins.image2){POLARIS.dialog.add("image",this.path+"dialogs/image.js");var e="img[alt,!src]{border-style,border-width,float,height,margin,margin-bottom,margin-left,margin-right,margin-top,width}";POLARIS.dialog.isTabEnabled(a,
"image","advanced")&&(e="img[alt,dir,id,lang,longdesc,!src,title]{*}(*)");a.addCommand("image",new POLARIS.dialogCommand("image",{allowedContent:e,requiredContent:"img[alt,src]",contentTransformations:[["img{width}: sizeToStyle","img[width]: sizeToAttribute"],["img{float}: alignmentToStyle","img[align]: alignmentToAttribute"]]}));a.ui.addButton&&a.ui.addButton("Image",{label:a.lang.common.image,command:"image",toolbar:"insert,10"});a.ui.addButton&&a.ui.addButton("ShowImageBorder",{label:a.lang.image.showImageBorder,
command:"showImageBorder",toolbar:"insert,11"});a.addCommand("showImageBorder",{exec:function(){var b;if(this.state==POLARIS.TRISTATE_OFF){this.state=POLARIS.TRISTATE_ON;b=!1;for(var c=0;c<this.uiItems.length;c++)this.uiItems[c].setState(POLARIS.TRISTATE_ON)}else for(this.state=POLARIS.TRISTATE_OFF,b=!0,c=0;c<this.uiItems.length;c++)this.uiItems[c].setState(POLARIS.TRISTATE_OFF);for(var d=a.document.find("img"),c=0;c<d.count();c++){var e=d.getItem(c);if(b){var g=e.getAttribute("src");e.setAttribute("data-polaris-saved-src",
g);e.removeAttribute("src");e.addClass("polaris_img_border")}else g=e.getAttribute("data-polaris-saved-src"),e.setAttribute("src",g),e.removeClass("polaris_img_border")}}});a.getCommand("showImageBorder").state=POLARIS.TRISTATE_ON;a.on("doubleclick",function(a){var c=a.data.element;!c.is("img")||c.data("polaris-realelement")||c.isReadOnly()||(a.data.dialog="image")});a.addMenuItems&&a.addMenuItems({image:{label:a.lang.image.menu,command:"image",group:"image"}});a.contextMenu&&a.contextMenu.addListener(function(b){b||
(b=a.getSelection().getSelectedElement());b=b&&b.is("img")&&!b.data("polaris-realelement")&&!b.isReadOnly()?b:void 0;if(b)return{image:POLARIS.TRISTATE_OFF}});a.on("afterPaste",function(b){b=a.document.find("img");for(var c=0;c<b.count();c++){var d=b.getItem(c);d.removeAttribute("data-polaris-pa-ondragstart");d.setAttribute("ondragstart","return false");var e=d.getAttribute("data-polaris-saved-src");POLARIS.tools.isEmptyValue(e)&&(e=d.getAttribute("src"));d.setAttribute("src",e);(0===d.$.width||0===
d.$.height||d.$.width>POLARIS.tools.getPageContentsSize(a).width||d.$.height>POLARIS.tools.getPageContentsSize(a).height)&&d.$.addEventListener("load",function(){var b=POLARIS.tools.getPageContentsSize(a).width,c=POLARIS.tools.getPageContentsSize(a).height,e=1;if(d.$.width>b){if(d.$.width=b,d.$.height>c&&(d.$.height=c),d.getStyle("width")||d.getStyle("height"))d.setStyle("width",d.$.width+"px"),d.setStyle("height",d.$.height+"px")}else d.$.height>c&&(e=c/d.$.height,d.$.height=c,d.$.width*e>b&&(d.$.width=
b),d.getStyle("width")||d.getStyle("height"))&&(d.setStyle("width",d.$.width+"px"),d.setStyle("height",d.$.height+"px"));d.$.removeEventListener("load",!1)},!1)}});a.on("objectresize",function(a){var c=a.data.element,d=a.data.prevRect,e=a.data.currRect;if(c.is("img")){a=e.width/d.width;d=e.height/d.height;if(1!=a){var g=c.getStyle("width"),e=g.replace(/[0-9|.]/g,""),g=parseFloat(g);c.hasAttribute("width")?(isNaN(g)&&(g=c.getAttribute("width"),g=parseFloat(g)),c.removeAttribute("width")):""==c.getStyle("width")&&
c.getClientRect().width&&(g=c.getClientRect().width);c.setStyle("width",g*a+e)}1!=d&&(a=c.getStyle("height"),e=a.replace(/[0-9|.]/g,""),a=parseFloat(a),c.hasAttribute("height")?(isNaN(a)&&(a=c.getAttribute("height"),a=parseFloat(a)),c.removeAttribute("height")):""==c.getStyle("height")&&c.getClientRect().height&&(a=c.getClientRect().height),c.setStyle("height",a*d+e))}})}},afterInit:function(a){}})})();POLARIS.config.image_removeLinkByEmptyURL=!0;POLARIS.plugins.add("imageresize",{init:function(a){if(this.support()){this.getConfig();
var e=this;a.on("instanceReady",function(){a.document.on("paste",function(b){var c=b.data.getTarget();c||(c=a.document);window.setTimeout(function(){e.resizeAll(a,c)},500);window.setTimeout(function(){e.resizeAll(a,c)},1E3);window.setTimeout(function(){e.resizeAll(a,c)},1500)});a.document.on("drop",function(b){var c=b.data.getTarget();c||(c=a.document);window.setTimeout(function(){e.resizeAll(a,c)},500);window.setTimeout(function(){e.resizeAll(a,c)},1E3);window.setTimeout(function(){e.resizeAll(a,
c)},1500)})})}},resizeAll:function(a,e,b,c){if(this.support()&&(e||(e=a.document),e&&(b||(b=this.config.maxWidth),c||(c=this.config.maxHeight),"find"in e&&"function"==typeof e.find||(e=new POLARIS.dom.node(e)),e&&"find"in e&&"function"==typeof e.find))){e=e.find("img");var d,h,g,k,f,l=e.count();for(f=0;f<l;f++){k=e.getItem(f);h=d=0;g="";try{d=k.$.width,h=k.$.height,g=k.getAttribute("src")}catch(m){h=d=0,g=""}g&&0===g.indexOf("data:")&&(d>b||h>c)&&this.resize(a,k,b,c)}}},resize:function(a,e,b,c){if(this.support()&&
e){b||(b=this.config.maxWidth);c||(c=this.config.maxHeight);var d=new Image;d.polariseditorimageresize={n:e,w:b,h:c};d.onerror=function(){this.polariseditorimageresize=null;delete this.polariseditorimageresize};d.onabort=function(){this.polariseditorimageresize=null;delete this.polariseditorimageresize};d.onload=function(){if(!(this.width<=this.polariseditorimageresize.w&&this.height<=this.polariseditorimageresize.h)){this.polariseditorimageresize.w/this.polariseditorimageresize.h>this.width/this.height?
this.polariseditorimageresize.w=this.width/this.height*this.polariseditorimageresize.h:this.polariseditorimageresize.h=Math.round(this.polariseditorimageresize.w/(this.width/this.height));var b=document.createElement("canvas");b.width=this.polariseditorimageresize.w;b.height=this.polariseditorimageresize.h;b.style.width=this.polariseditorimageresize.w+"px";b.style.height=this.polariseditorimageresize.h+"px";b.getContext("2d").drawImage(this,0,0,this.polariseditorimageresize.w,this.polariseditorimageresize.h);
if(this.polariseditorimageresize.n){/^data:image\/jpeg/i.test(this.src)||/\.(jpg|jpeg)$/i.test(this.src)?this.polariseditorimageresize.n.setAttribute("src",b.toDataURL("image/jpeg",.8)):this.polariseditorimageresize.n.setAttribute("src",b.toDataURL("image/png"));this.polariseditorimageresize.n.setAttribute("width",this.polariseditorimageresize.w);this.polariseditorimageresize.n.setAttribute("height",this.polariseditorimageresize.h);try{this.polariseditorimageresize.n.$.style.width=this.polariseditorimageresize.w+
"px",this.polariseditorimageresize.n.$.style.height=this.polariseditorimageresize.h+"px"}catch(c){}try{a.focus(),a.getSelection().scrollIntoView()}catch(d){}}this.polariseditorimageresize=null;delete this.polariseditorimageresize}};d.src=e.getAttribute("src")}},supportResult:null,support:function(){if(null===this.supportResult){this.supportResult=!1;var a=document.createElement("canvas");a&&a.getContext&&a.toDataURL&&a.getContext("2d")&&(a=a.getContext("2d"))&&a.getImageData&&a.putImageData&&(this.supportResult=
!0)}return this.supportResult},config:{maxWidth:800,maxHeight:800},getConfig:function(){if(POLARIS.config.imageResize)for(var a in this.config)POLARIS.config.imageResize[a]&&(this.config[a]=parseInt(POLARIS.config.imageResize[a],10),isNaN(this.config[a])||1>this.config[a])&&(this.config[a]=800)}});(function(){function a(a,c){var g,k;c.on("refresh",function(a){var c=[e],d;for(d in a.data.states)c.push(a.data.states[d]);this.setState(POLARIS.tools.search(c,b)?b:e)},c,null,100);c.on("exec",function(b){g=
a.getSelection();k=g.createBookmarks(1);b.data||(b.data={});b.data.done=!1},c,null,0);c.on("exec",function(){a.forceNextSelectionCheck();g.selectBookmarks(k)},c,null,100)}var e=POLARIS.TRISTATE_DISABLED,b=POLARIS.TRISTATE_OFF;POLARIS.plugins.add("indent",{init:function(b){var c=POLARIS.plugins.indent.genericDefinition;a(b,b.addCommand("indent",new c(!0)));a(b,b.addCommand("outdent",new c));b.ui.addButton&&(b.ui.addButton("Indent",{label:b.lang.indent.indent,command:"indent",directional:!0,toolbar:"indent,20"}),
b.ui.addButton("Outdent",{label:b.lang.indent.outdent,command:"outdent",directional:!0,toolbar:"indent,10"}));b.setKeystroke([[POLARIS.ALT+POLARIS.SHIFT+37,"outdent"],[POLARIS.ALT+POLARIS.SHIFT+39,"indent"]]);b.on("dirChanged",function(a){var c=b.createRange(),e=a.data.node;c.setStartBefore(e);c.setEndAfter(e);for(var h=new POLARIS.dom.walker(c),m;m=h.next();)if(m.type==POLARIS.NODE_ELEMENT)if(!m.equals(e)&&m.getDirection())c.setStartAfter(m),h=new POLARIS.dom.walker(c);else{var n=b.config.indentClasses;
if(n)for(var q="ltr"==a.data.dir?["_rtl",""]:["","_rtl"],v=0;v<n.length;v++)m.hasClass(n[v]+q[0])&&(m.removeClass(n[v]+q[0]),m.addClass(n[v]+q[1]));n=m.getStyle("margin-right");q=m.getStyle("margin-left");n?m.setStyle("margin-left",n):m.removeStyle("margin-left");q?m.setStyle("margin-right",q):m.removeStyle("margin-right")}})},afterInit:function(a){a.on("contentDom",function(){var b=a.editable();void 0===b&&(b=editable);b.on("keydown",c,a,null,9)})}});var c=function(a){var b=a.editor?a.editor:this;
if(8==a.data.getKey()){var c=this.getSelection().getRanges()[0];if(c&&c.collapsed&&c.checkStartOfBlock()&&(c=c.startContainer&&c.startContainer.getAscendant("p",!0))){var e,f,l;c.getStyle("margin-left")&&(e=c.getStyle("margin-left"),f=parseFloat(e.substr(0,e.length-2)));c.getStyle("text-indent")&&(e=c.getStyle("text-indent"),l=parseFloat(e.substr(0,e.length-2)));if(f&&0<f||l){f=c.getAttribute("polaris-splitted");l=null;e=0;var m=null,n=0;c.removeStyle("margin-left");c.removeStyle("text-indent");if(f)for(l=
b.document.find('p[polaris-splitted\x3d"'+f+'"]'),e=l.count(),n=0;n<e;n+=1)m=l.getItem(n),c.equals(m)||(m.removeStyle("margin-left"),m.removeStyle("text-indent"));a.data.preventDefault();a.cancel()}}}};POLARIS.plugins.indent={genericDefinition:function(a){this.isIndent=!!a;this.startDisabled=!this.isIndent},specificDefinition:function(a,b,c){this.name=b;this.editor=a;this.jobs={};this.enterBr=a.config.enterMode==POLARIS.ENTER_BR;this.isIndent=!!c;this.relatedGlobal=c?"indent":"outdent";this.indentKey=
c?9:POLARIS.SHIFT+9;this.database={}},registerCommands:function(a,b){a.on("pluginsLoaded",function(){for(var a in b)(function(a,b){var c=a.getCommand(b.relatedGlobal),d;for(d in b.jobs)c.on("exec",function(c){c.data.done||(a.fire("lockSnapshot"),b.execJob(a,d)&&(c.data.done=!0),a.fire("unlockSnapshot"),POLARIS.dom.element.clearAllMarkers(b.database))},this,null,d),c.on("refresh",function(c){c.data.states||(c.data.states={});c.data.states[b.name+"@"+d]=b.refreshJob(a,d,c.data.path)},this,null,d);a.addFeature(b)})(this,
b[a])})}};POLARIS.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}};POLARIS.plugins.indent.specificDefinition.prototype={execJob:function(a,b){var c=this.jobs[b];if(c.state!=e)return c.exec.call(this,a)},refreshJob:function(a,b,c){b=this.jobs[b];a.activeFilter.checkFeature(this)?b.state=b.refresh.call(this,a,c):b.state=e;return b.state},getContext:function(a){return a.contains(this.context)}}})();(function(){function a(a,b,c){if(!a.getCustomData("indent_processed")){var d=
this.editor,h=this.isIndent;if(b){c=a.$.className.match(this.classNameRegex);var n=0;c&&(c=c[1],n=POLARIS.tools.indexOf(b,c)+1);if(0>(n+=h?1:-1))return;n=Math.min(n,b.length);n=Math.max(n,0);a.$.className=POLARIS.tools.ltrim(a.$.className.replace(this.classNameRegex,""));0<n&&a.addClass(b[n-1])}else{b=e(a,c);n=d.config.indentOffset||40;c=0;c=POLARIS.tools.convertToUnit(a.getStyle(b),"pt");var q=parseInt(c),q=isNaN(q)?0:q;c=q+(h?1:-1)*n;if(0>c||h&&0>a.$.clientWidth-15)return;c=Math.max(c,0);c=Math.ceil(c/
n)*n;h&&a.$.clientWidth-15<c-q&&(c=q+a.$.clientWidth-15);c=POLARIS.tools.convertToUnit(c+"pt","mm",2);a.setStyle(b,c?c:"");if(a.getAttribute("polaris-splitted")){var h=a.getAttribute("polaris-splitted"),n=null,q=0,v=null,r=0;if(h)for(n=d.document.find('p[polaris-splitted\x3d"'+h+'"]'),q=n.count(),r=0;r<q;r+=1)v=n.getItem(r),a.equals(v)||v.setStyle(b,c?c:"")}""===a.getAttribute("style")&&a.removeAttribute("style")}POLARIS.dom.element.setMarker(this.database,a,"indent_processed",1);d.fire("contentChange",
{type:"indentChange"})}}function e(a,b){return"ltr"==(b||a.getComputedStyle("direction"))?"margin-left":"margin-right"}var b=POLARIS.dtd.$listItem,c=POLARIS.dtd.$list,d=POLARIS.TRISTATE_DISABLED,h=POLARIS.TRISTATE_OFF;POLARIS.plugins.add("indentblock",{requires:"indent",init:function(g){function k(){f.specificDefinition.apply(this,arguments);this.allowedContent={"div h1 h2 h3 h4 h5 h6 ol p pre ul":{propertiesOnly:!0,styles:l?null:"margin-left,margin-right",classes:l||null}};this.enterBr&&(this.allowedContent.div=
!0);this.requiredContent=(this.enterBr?"div":"p")+(l?"("+l.join(",")+")":"{margin-left}");this.jobs[20]={refresh:this.isIndent?function(a,b){var c=b.block||b.blockLimit;return c&&0<c.$.clientWidth-15?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED}:function(a,c){var f=c.block||c.blockLimit;f.is(b)||(f=f.getAscendant(b)||f);f.is(b)&&(f=f.getParent());if(this.enterBr||this.getContext(c)){if(l){var g;g=l;var f=f.$.className.match(this.classNameRegex),k=this.isIndent;g=f?k?f[1]!=g.slice(-1):!0:k;return g?
h:d}return this.isIndent?h:f?POLARIS[0>=(parseInt(f.getStyle(e(f)),10)||0)?"TRISTATE_DISABLED":"TRISTATE_OFF"]:d}return d},exec:function(b){var d=b.getSelection(),d=d&&d.getRanges()[0],e;if(e=b.elementPath().contains(c))a.call(this,e,l);else{d=d.createIterator();b=b.config.enterMode;var f=[],h="";d.enforceRealBlocks=!0;for(d.enlargeBr=b!=POLARIS.ENTER_BR;e=d.getNextParagraph(b==POLARIS.ENTER_P?"p":"div");)e.hasAttribute("polaris-splitted")?(h=e.getAttribute("polaris-splitted"),0>f.indexOf(h)&&(a.call(this,
e,l),POLARIS.tools.isEmptyValue(h)||f.push(h))):a.call(this,e,l)}return!0}}}var f=POLARIS.plugins.indent,l=g.config.indentClasses;f.registerCommands(g,{indentblock:new k(g,"indentblock",!0),outdentblock:new k(g,"outdentblock")});POLARIS.tools.extend(k.prototype,f.specificDefinition.prototype,{context:{div:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,p:1,pre:1,table:1},classNameRegex:l?new RegExp("(?:^|\\s+)("+l.join("|")+")(?\x3d$|\\s)"):null})}})})();(function(){function a(a){function c(e){for(var f=
v.startContainer,r=v.endContainer;f&&!f.getParent().equals(e);)f=f.getParent();for(;r&&!r.getParent().equals(e);)r=r.getParent();if(!f||!r)return!1;for(var p=[],q=!1;!q;)f.equals(r)&&(q=!0),p.push(f),f=f.getNext();if(1>p.length)return!1;f=e.getParents(!0);for(r=0;r<f.length;r++)if(f[r].getName&&g[f[r].getName()]){e=f[r];break}for(var f=d.isIndent?1:-1,r=p[0],p=p[p.length-1],q=POLARIS.plugins.list.listToArray(e,h),u=q[p.getCustomData("listarray_index")].indent,r=r.getCustomData("listarray_index");r<=
p.getCustomData("listarray_index");r++)if(q[r].indent+=f,0<f){var B=q[r].parent,G="",y=q[r].parent.getStyle("list-style-type");if(y){for(var F=["disc","circle","square"],E=["decimal","upper-alpha","lower-alpha","upper-roman","lower-roman"],H=0;H<F.length;H++)if(F[H]==y){G=H==F.length-1?F[0]:F[H+1];break}for(F=0;F<E.length;F++)if(E[F]==y){G=F==E.length-1?E[0]:E[F+1];break}}q[r].parent=new POLARIS.dom.element(B.getName(),B.getDocument());q[r].parent.setStyle("list-style-type",G)}for(r=p.getCustomData("listarray_index")+
1;r<q.length&&q[r].indent>u;r++)q[r].indent+=f;f=POLARIS.plugins.list.arrayToList(q,h,null,a.config.enterMode,e.getDirection());if(!d.isIndent){var J;if((J=e.getParent())&&J.is("li"))for(var p=f.listNode.getChildren(),I=[],L,r=p.count()-1;0<=r;r--)(L=p.getItem(r))&&L.is&&L.is("li")&&I.push(L)}f&&(f.listNode.replace(e),POLARIS.plugins.list.reOrder(v.root));if(I&&I.length)for(r=0;r<I.length;r++){for(L=e=I[r];(L=L.getNext())&&L.is&&L.getName()in g;)POLARIS.env.needsNbspFiller&&!e.getFirst(b)&&e.append(v.document.createText(" ")),
e.append(L);e.insertAfter(J)}f&&a.fire("contentDomInvalidated");return!0}for(var d=this,h=this.database,g=this.context,q=a.getSelection(),q=(q&&q.getRanges()).createIterator(),v;v=q.getNextRange();){for(var r=v.getCommonAncestor();r&&(r.type!=POLARIS.NODE_ELEMENT||!g[r.getName()]);)r=r.getParent();r||(r=v.startPath().contains(g))&&v.setEndAt(r,POLARIS.POSITION_BEFORE_END);if(!r){var p=v.getEnclosedNode();p&&p.type==POLARIS.NODE_ELEMENT&&p.getName()in g&&(v.setStartAt(p,POLARIS.POSITION_AFTER_START),
v.setEndAt(p,POLARIS.POSITION_BEFORE_END),r=p)}r&&v.startContainer.type==POLARIS.NODE_ELEMENT&&v.startContainer.getName()in g&&(p=new POLARIS.dom.walker(v),p.evaluator=e,v.startContainer=p.next());r&&v.endContainer.type==POLARIS.NODE_ELEMENT&&v.endContainer.getName()in g&&(p=new POLARIS.dom.walker(v),p.evaluator=e,v.endContainer=p.previous());if(r)return c(r)}return 0}function e(a){return a.type==POLARIS.NODE_ELEMENT&&a.is("li")}function b(a){return c(a)&&d(a)}var c=POLARIS.dom.walker.whitespaces(!0),
d=POLARIS.dom.walker.bookmark(!1,!0),h=POLARIS.TRISTATE_DISABLED,g=POLARIS.TRISTATE_OFF;POLARIS.plugins.add("indentlist",{requires:"indent",init:function(b){function c(b){d.specificDefinition.apply(this,arguments);this.requiredContent=["ul","ol"];b.on("key",function(a){if("wysiwyg"==b.mode&&a.data.keyCode==this.indentKey){var c=this.getContext(b.elementPath());!c||this.isIndent&&POLARIS.plugins.indentList.firstItemInPath(this.context,b.elementPath(),c)||(b.execCommand(this.relatedGlobal),a.cancel())}},
this);this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(a,b){var c=this.getContext(b),d=POLARIS.plugins.indentList.firstItemInPath(this.context,b,c);return c&&this.isIndent&&!d?g:h}:function(a,b){return!this.getContext(b)||this.isIndent?h:g},exec:POLARIS.tools.bind(a,this)}}var d=POLARIS.plugins.indent;d.registerCommands(b,{indentlist:new c(b,"indentlist",!0),outdentlist:new c(b,"outdentlist")});POLARIS.tools.extend(c.prototype,d.specificDefinition.prototype,{context:{ol:1,ul:1}})}});
POLARIS.plugins.indentList={};POLARIS.plugins.indentList.firstItemInPath=function(a,b,c){var d=b.contains(e);c||(c=b.contains(a));return c&&d&&d.equals(c.getFirst(e))}})();(function(){function a(a,c){function d(){var h=a.document.createText("​"),k=e.createBookmarks();b(g,!1,!1);f.collapsed&&c?h.insertAfter(k[0].startNode):h.insertBefore(k[0].startNode);e.selectBookmarks(k)}var e=a.getSelection(),f=e?e.getRanges()[0]:null,h=f?f.startPath():null,g=h?h.lastElement:null;if(g&&g.is("span")){POLARIS.dom.selection._removeFillingCharSequenceNode(a.editable());
var h=g.$.innerText,k=e.getSelectedText();f.collapsed?1>=h.length&&d():-1<k.indexOf(h)&&d()}}function e(a){if(a&&a.type==POLARIS.NODE_ELEMENT){var c=a.getDocument(),d=c.getSelection(),e;if(a.isExistText()){if(e=a.is(POLARIS.dtd.$block)&&!a.getBogus())e=a.getAttribute("polaris-splitted"),e=a.hasAttribute("polaris-splitted")&&!POLARIS.tools.isEmptyValue(e)?!0:!1,e=!e;e&&(e=d.createBookmarks(),a.appendBogus(),d.selectBookmarks(e));POLARIS.dom.selection._removeFillingCharSequenceNode(c.getBody());e=d.createBookmarks();
b(a,!0,!0);d.selectBookmarks(e)}}}function b(a,c,d){if(a&&a.type==POLARIS.NODE_ELEMENT){var e=POLARIS.dom.walker.bookmark();a=Array.prototype.slice.call(a.$.childNodes);var f=a.length,h,g;for(h=0;h<f;h++)if(g=new POLARIS.dom.node(a[h]),g.type==POLARIS.NODE_TEXT){var k=g.getText(),w=k.replace(/\u200b/g,"");c&&0==w.length?g.remove():k!=w&&g.setText(w)}else g.type!=POLARIS.NODE_ELEMENT||e(g)||g.is("br","p")||(d&&b(g,c,!0),c&&g.is("span")&&0==g.getChildCount()&&g.remove())}}POLARIS.plugins.add("inputmethod",
{init:function(a){},afterInit:function(a){a.on("contentDom",function(){var b=a.editable();b.on("keydown",f,a,null,8);b.on("keypress",f,a,null,8);b.on("keyup",f,a,null,8);a.on("selectionChange",d)})}});POLARIS.plugins.inputmethod={cleanZWSPInElement:function(a,c){if(a&&a.type==POLARIS.NODE_ELEMENT&&c){var d;c.isRemainFirstTextNode&&0==a.isExistText()?((d=(d=a.getTextNodes())?d[0]:null)&&d.setText("﻿"),b(a,c.isRemoveEmptyNode,c.isRecursion),d&&d.setText("​")):b(a,c.isRemoveEmptyNode,c.isRecursion)}},
cleanZWSPInRangeBoundary:function(a,c){if(a&&c){var d=a.startPath(),e=a.endPath(),f=d.block?d.block:d.blockLimit?d.blockLimit:null,g=e.block?e.block:e.blockLimit?e.blockLimit:null,f=f&&f.isExistText(),g=g&&g.isExistText(),h;if(a.collapsed){if(!c.isExistTextCheck||f)h=a.createBookmark(),b(d.lastElement,c.isRemoveEmptyNode,!1)}else if(!c.isExistTextCheck||f||g)h=a.createBookmark(),f&&b(d.lastElement,c.isRemoveEmptyNode,!1),g&&b(e.lastElement,c.isRemoveEmptyNode,!1);h&&a.moveToBookmark(h)}}};var c=null,
d=function(a){var b=a.data.path;a=b.block;b=b.blockLimit;c=a?a:b?b:null},h=[POLARIS.KEYCODE.TAB,POLARIS.KEYCODE.ENTER,POLARIS.KEYCODE.PAGEUP,POLARIS.KEYCODE.PAGEDOWN,POLARIS.KEYCODE.END,POLARIS.KEYCODE.HOME,POLARIS.KEYCODE.LEFT,POLARIS.KEYCODE.UP,POLARIS.KEYCODE.RIGHT,POLARIS.KEYCODE.DOWN],g=[POLARIS.KEYCODE.BACKSPACE,POLARIS.KEYCODE.DELETE],k=[POLARIS.KEYCODE.SHIFT,POLARIS.KEYCODE.CTRL,POLARIS.KEYCODE.ALT,POLARIS.KEYCODE.F1,POLARIS.KEYCODE.F2,POLARIS.KEYCODE.F3,POLARIS.KEYCODE.F4,POLARIS.KEYCODE.F6,
POLARIS.KEYCODE.F5,POLARIS.KEYCODE.F7,POLARIS.KEYCODE.F8,POLARIS.KEYCODE.F9,POLARIS.KEYCODE.F10,POLARIS.KEYCODE.F11,POLARIS.KEYCODE.F12,POLARIS.KEYCODE.L_WINDOW,POLARIS.KEYCODE.R_WINDOW,POLARIS.KEYCODE.R_CLICK],f=function(b){var d=b.data,f=d.$.type,q=d.getKey();b=b.editor?b.editor:this;var v=b.editable().isComposing;-1<k.indexOf(q)||d.$.shiftKey&&-1<h.indexOf(q)||d.$.ctrlKey||d.$.altKey||("keydown"==f?-1<g.indexOf(q)?a(b,q==POLARIS.KEYCODE.BACKSPACE):-1<h.indexOf(q)&&(v||e(c)):"keyup"==f&&-1==h.indexOf(q)&&
(v||e(c)))}})();(function(){function a(a,b){b=void 0===b||b;var c;try{if(b)c=a.getComputedStyle("text-align");else{for(;!a.hasAttribute||!a.hasAttribute("align")&&!a.getStyle("text-align");){var d=a.getParent();if(!d)break;a=d}c=a.getStyle("text-align")||a.getAttribute("align")||""}c&&(c=c.replace(/(?:-(?:moz|webkit)-)?(?:start|auto)/i,""));!c&&b&&(c="rtl"==a.getComputedStyle("direction")?"right":"left")}catch(e){c="left"}return c}function e(a,b,c){this.editor=a;this.name=b;this.value=c;this.context=
"p";b=a.config.justifyClasses;var d=a.config.enterMode==POLARIS.ENTER_P?"p":"div";if(b){switch(c){case "left":this.cssClassName=b[0];break;case "center":this.cssClassName=b[1];break;case "right":this.cssClassName=b[2];break;case "justify":this.cssClassName=b[3]}this.cssClassRegex=new RegExp("(?:^|\\s+)(?:"+b.join("|")+")(?\x3d$|\\s)");this.requiredContent=d+"("+this.cssClassName+")"}else this.requiredContent=d+"{text-align}";this.allowedContent={"caption div h1 h2 h3 h4 h5 h6 p pre td th li":{propertiesOnly:!0,
styles:this.cssClassName?null:"text-align",classes:this.cssClassName||null}};a.config.enterMode==POLARIS.ENTER_BR&&(this.allowedContent.div=!0)}function b(a){var b=a.editor,c=b.createRange();c.setStartBefore(a.data.node);c.setEndAfter(a.data.node);for(var d=new POLARIS.dom.walker(c),e;e=d.next();)if(e.type==POLARIS.NODE_ELEMENT)if(!e.equals(a.data.node)&&e.getDirection())c.setStartAfter(e),d=new POLARIS.dom.walker(c);else{var f=b.config.justifyClasses;f&&(e.hasClass(f[0])?(e.removeClass(f[0]),e.addClass(f[2])):
e.hasClass(f[2])&&(e.removeClass(f[2]),e.addClass(f[0])));f=e.getStyle("text-align");"left"==f?e.setStyle("text-align","right"):"right"==f&&e.setStyle("text-align","left")}}function c(a,b,c){var d=a.getSelection();if(d){var d=a.elementPath(d.getStartElement()),d=d.block||d.blockLimit,e=POLARIS.tools.convertToUnit(d.getStyle("text-indent"),"mm",2),e=parseFloat(e),e=isNaN(e)?0:e,f=POLARIS.tools.convertToUnit(d.getStyle("margin-left"),"mm",2),f=parseFloat(f),f=isNaN(f)?0:f;0>e&&(f+=e);null!=b?e+=b:(0!=
f&&0>c&&(c+=f),e=c);e=parseFloat(e.toFixed(1));d.setStyle("text-indent",e+"mm");0>e&&d.setStyle("margin-left",(f+-e).toFixed(1)+"mm");a.fire("contentChange",{type:"indentChange"})}}function d(a,b,c){var d=a.getSelection();if(d){var d=a.elementPath(d.getStartElement()),d=d.block||d.blockLimit,e=POLARIS.tools.convertToUnit(d.getStyle("margin-left"),"mm"),f=POLARIS.tools.convertToUnit(d.getStyle("margin-right"),"mm"),e=parseFloat(e),f=parseFloat(f),e=isNaN(e)?0:e,f=isNaN(f)?0:f,e=e+b,f=f+c;d.$.clientWidth-
15<POLARIS.tools.convertMmTopx(b+c)||(c=a.plugins.pagination.pageInfo,b=-parseFloat(c.marginLeft),c=-parseFloat(c.marginRight),e<b&&(e=b),f<c&&(f=c),d.setStyle("margin-left",e+"mm"),d.setStyle("margin-right",f+"mm"),a.fire("contentChange",{type:"marginChange"}))}}e.prototype={editorFocus:0,exec:function(b){function c(b){if(!b.isReadOnly()){var d=l&&(b.$.className=POLARIS.tools.ltrim(b.$.className.replace(this.cssClassRegex,""))),e=this.state==POLARIS.TRISTATE_OFF&&(!q||a(b,!0)!=this.value);e&&(b.removeAttribute("align"),
b.removeStyle("text-align"));l?e?b.addClass(l):d||b.removeAttribute("class"):e&&b.setStyle("text-align",this.value)}}function d(a,b){if(a){b?a.setStyle("text-align",b):a.removeStyle("text-align");a.removeAttribute("align");var c=a.find("p, li, table"),e,f=c.count();for(e=0;e<f;e++){var g=c.getItem(e);g.is("p","li")?b?g.setStyle("text-align",b):g.removeStyle("text-align"):g.is("table")&&(b?("left"==b?g.removeAttribute("align"):g.setAttribute("align",b),g.removeStyle("margin-left")):g.removeAttribute("align"))}}}
function e(a,b){a&&a&&("left"==b||"justify"==b?a.removeAttribute("align"):a.setAttribute("align",b),a.removeStyle("margin-left"))}var f=b.getSelection(),g=b.config.enterMode;if(f){var h=f.createBookmarks(),k=f.getRanges(),l=this.cssClassName,m,n,q=b.config.useComputedState,q=void 0===q||q,v=POLARIS.plugins.tabletools.getSelectedCells(f,"cell");m=v.length;var H;if(POLARIS.plugins.tabletools.isSelectedCell(f)||2<m)for(H=0;H<m;H++)d(v[H],this.value);else for(H=k.length-1;0<=H;H--){m=k[H];var v=!m.collapsed,
J;if(v){var I=m.startContainer&&m.startContainer.getAscendant("table",!0);n=m.endContainer&&m.endContainer.getAscendant("table",!0);if(I&&n)if(I.equals(n))J=I;else if(I.contains(n))J=I;else if(n.contains(I))J=n;else{J=I;do J=J.getAscendant("table",!1);while(J&&!J.contains(n))}}m=m.createIterator();for(m.enlargeBr=g!=POLARIS.ENTER_BR;n=m.getNextParagraph(g==POLARIS.ENTER_P?"p":"div");)(I=n&&n.getParent())&&I.type==POLARIS.NODE_ELEMENT&&I.is("li")?c.call(this,I):c.call(this,n),v&&(n=n.getAscendant("table",
!0))&&!n.equals(J)&&e(n,this.value)}b.focus();b.forceNextSelectionCheck();f.selectBookmarks(h);b={left:b.getCommand("justifyleft"),right:b.getCommand("justifyright"),center:b.getCommand("justifycenter"),justify:b.getCommand("justifyblock")};for(command in b)this.value===command?b[command].setState(POLARIS.TRISTATE_ON):b[command].setState(POLARIS.TRISTATE_OFF)}}};var h={exec:function(a){c(a,-1)}},g={exec:function(a){c(a,1)}},k={exec:function(a){var b=a.getSelection();if(b){var d=b.getRanges();if(d[0].collapsed){var e=
new POLARIS.dom.element.createFromHtml("\x3cspan\x3e\x26#8203;\x3c/span\x3e");a.insertElement(e);var f=e.$.offsetLeft,g=e.$.offsetParent?e.$.offsetParent.style.paddingLeft:0;g&&(g=POLARIS.tools.convertToPx(g),f=parseInt(f-g));f=POLARIS.tools.convertPxToMm(f);e.remove();c(a,null,-f);b.selectRanges(d)}}}},f={exec:function(a){d(a,-1,0)}},l={exec:function(a){d(a,0,-1)}},m={exec:function(a){d(a,-1,-1)}},n={exec:function(a){d(a,1,0)}},q={exec:function(a){d(a,0,1)}},v={exec:function(a){d(a,1,1)}};POLARIS.plugins.add("justify",
{init:function(c){if(!c.blockless){var d=new e(c,"justifyleft","left"),t=new e(c,"justifycenter","center"),w=new e(c,"justifyright","right"),A=new e(c,"justifyblock","justify");c.addCommand("justifyleft",d);c.addCommand("justifycenter",t);c.addCommand("justifyright",w);c.addCommand("justifyblock",A);c.ui.addButton&&(c.ui.addButton("JustifyLeft",{label:c.lang.justify.left,command:"justifyleft",toolbar:"align,10"}),c.ui.addButton("JustifyCenter",{label:c.lang.justify.center,command:"justifycenter",
toolbar:"align,20"}),c.ui.addButton("JustifyRight",{label:c.lang.justify.right,command:"justifyright",toolbar:"align,30"}),c.ui.addButton("JustifyBlock",{label:c.lang.justify.block,command:"justifyblock",toolbar:"align,40"}),c.ui.addButton&&c.ui.addButton("ParagraphForm",{label:c.lang.pagination.paragraphform,command:"paragraphform",toolbar:"document,50"}),c.addCommand("paragraphform",new POLARIS.dialogCommand("paragraphform")),POLARIS.dialog.add("paragraphform",this.path+"dialogs/paragraphform.js"));
c.addCommand("paragraphoutdent",h);c.addCommand("paragraphindent",g);c.addCommand("paragraphautooutdent",k);c.addCommand("decreaseleftmargin",f);c.addCommand("increaseleftmargin",n);c.addCommand("increaserightmargin",q);c.addCommand("decreaserightmargin",l);c.addCommand("decreaseleftrightmargin",m);c.addCommand("increaseleftrightmargin",v);c.on("dirChanged",b);c.setKeystroke([[POLARIS.CTRL+POLARIS.SHIFT+77,"justifyblock"],[POLARIS.CTRL+POLARIS.SHIFT+76,"justifyleft"],[POLARIS.CTRL+POLARIS.SHIFT+82,
"justifyright"],[POLARIS.CTRL+POLARIS.SHIFT+67,"justifycenter"],[POLARIS.ALT+84,"paragraphform"],[POLARIS.CTRL+116,"paragraphoutdent"],[POLARIS.CTRL+117,"paragraphindent"],[POLARIS.CTRL+POLARIS.SHIFT+79,"paragraphoutdent"],[POLARIS.CTRL+POLARIS.SHIFT+73,"paragraphindent"],[POLARIS.SHIFT+9,"paragraphautooutdent"],[POLARIS.CTRL+POLARIS.ALT+116,"decreaseleftmargin"],[POLARIS.CTRL+POLARIS.SHIFT+69,"decreaseleftmargin"],[POLARIS.CTRL+POLARIS.ALT+117,"increaseleftmargin"],[POLARIS.CTRL+POLARIS.SHIFT+71,
"increaseleftmargin"],[POLARIS.CTRL+POLARIS.ALT+118,"increaserightmargin"],[POLARIS.CTRL+POLARIS.SHIFT+68,"increaserightmargin"],[POLARIS.CTRL+POLARIS.ALT+119,"decreaserightmargin"],[POLARIS.CTRL+POLARIS.SHIFT+70,"decreaserightmargin"],[POLARIS.CTRL+118,"decreaseleftrightmargin"],[POLARIS.CTRL+119,"increaseleftrightmargin"]]);c.on("selectionChange",function(b){var d=c.getSelection(),e=d.getRanges()[0];b=[];if(!c.readOnly){var f=POLARIS.plugins.tabletools.getSelectedCells(d);if(f&&0<f.length&&POLARIS.plugins.tabletools.hasSelectedCell(f))for(d=
0;d<f.length;d++)for(var e=f[d].find("p"),g=0;g<e.count();g++){var h=e.getItem(g);b.push(h)}else 0!=e.collapsed||e.startContainer.equals(e.endContainer)?b.push(d.getStartElement()):b=POLARIS.tools.getSelectedParagraph(c);for(var f=!0,k,d=0;d<b.length;d++){h=b[d];e=a(h,c.config.useComputedState);if(k&&k!=e){f=!1;break}k=e}k=c.getCommand("justifyleft");b=c.getCommand("justifyright");d=c.getCommand("justifycenter");e=c.getCommand("justifyblock");k.setState(POLARIS.TRISTATE_OFF);b.setState(POLARIS.TRISTATE_OFF);
d.setState(POLARIS.TRISTATE_OFF);e.setState(POLARIS.TRISTATE_OFF);f&&(h=a(h,c.config.useComputedState),"left"==h?k.setState(POLARIS.TRISTATE_ON):"center"==h?d.setState(POLARIS.TRISTATE_ON):"right"==h?b.setState(POLARIS.TRISTATE_ON):"justify"==h&&e.setState(POLARIS.TRISTATE_ON))}})}}})})();(function(){function a(a){function b(c,e){if(e.length){c.items?c.items.push(a.ui.create("-")):c.items=[];for(var g;g=e.shift();)if(g="string"==typeof g?g:g.name,a.config.wordprocessor||"ZoomCombo"!=g)d&&-1!=POLARIS.tools.indexOf(d,
g)||(g=a.ui.create(g))&&a.addFeature(g)&&c.items.push(g)}}function c(a){var d=[],e,f,h;for(e=0;e<a.length;++e)f=a[e],h={},"/"==f?d.push(f):POLARIS.tools.isArray(f)?(b(h,POLARIS.tools.clone(f)),d.push(h)):f.items&&(b(h,POLARIS.tools.clone(f.items)),h.name=f.name,h.show=f.show,d.push(h));return d}var d=a.config.removeButtons,d=d&&d.split(","),e=a.config.toolbar;"string"==typeof e&&(e=a.config["toolbar_"+e]);return a.toolbar=e?c(e):[]}function e(a){return a._.toolbarGroups||(a._.toolbarGroups=[{name:"document",
groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var b=function(){this.toolbars=[];this.focusCommandExecuted=!1};b.prototype.focus=function(){for(var a=
0,b;b=this.toolbars[a++];)for(var c=0,d;d=b.items[c++];)if(d.focus){d.focus();return}};var c={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(a){a.toolbox&&(a.toolbox.focusCommandExecuted=!0,POLARIS.env.ie||POLARIS.env.air?setTimeout(function(){a.toolbox.focus()},100):a.toolbox.focus())}},d=!1;POLARIS.plugins.add("toolbar",{requires:"button",init:function(e){var g,k=function(a,b){var c,d="rtl"==e.lang.dir,q=e.config.toolbarGroupCycling,v=d?37:39,d=d?39:37,q=void 0===q||q;switch(b){case 9:case POLARIS.SHIFT+
9:for(;!c||!c.items.length;)if(c=9==b?(c?c.next:a.toolbar.next)||e.toolbox.toolbars[0]:(c?c.previous:a.toolbar.previous)||e.toolbox.toolbars[e.toolbox.toolbars.length-1],c.items.length)for(a=c.items[g?c.items.length-1:0];a&&!a.focus;)(a=g?a.previous:a.next)||(c=0);a&&a.focus();return!1;case v:c=a;do c=c.next,!c&&q&&(c=a.toolbar.items[0]);while(c&&!c.focus);c?c.focus():k(a,9);return!1;case 40:return a.button&&a.button.hasArrow?(e.once("panelShow",function(a){a.data._.panel._.currentBlock.onKeyDown(40)}),
a.execute()):k(a,40==b?v:d),!1;case d:case 38:c=a;do c=c.previous,!c&&q&&(c=a.toolbar.items[a.toolbar.items.length-1]);while(c&&!c.focus);c?c.focus():(g=1,k(a,POLARIS.SHIFT+9),g=0);return!1;case 27:return e.focus(),!1;case 13:case 32:return a.execute(),!1}return!0};e.on("uiSpace",function(c){if(c.data.space==e.config.toolbarLocation){c.removeListener();e.toolbox=new b;var g=POLARIS.tools.getNextId(),m=!1!==e.config.toolbarStartupExpanded,n,q,v=["\x3cstyle\x3ediv.polaris_toolbox{"+(e.config.toolbarBackgroundColor?
"background-color:"+e.config.toolbarBackgroundColor+";":"")+"}span.polaris_toolbar_break{"+(e.config.toolbarBreakColor?"border-bottom-color:"+e.config.toolbarBreakColor+";":"")+"}span.polaris_toolbar_separator{"+(e.config.toolbarSeperatorColor?"background-color:"+e.config.toolbarSeperatorColor+";margin-top:1px;margin-bottom:1px;height:22px;":"")+"}a.polaris_button_off:hover, a.polaris_button_off:focus, a.polaris_button_off:active, a.polaris_button_disabled:hover, a.polaris_button_disabled:focus, a.polaris_button_disabled:active{"+
(e.config.toolbarButtonHoverColor?"background-color:"+e.config.toolbarButtonHoverColor+";":"")+"}a.polaris_button_on{"+(e.config.toolbarButtonSelectedColor?"background-color:"+e.config.toolbarButtonSelectedColor+";":"")+"}\x3c/style\x3e",'\x3cspan id\x3d"',g,'" class\x3d"polaris_voice_label"\x3e',e.lang.toolbar.toolbars,"\x3c/span\x3e",'\x3cdiv id\x3d"'+e.ui.spaceId("toolbox")+'" class\x3d"polaris_toolbox" role\x3d"group" unselectable\x3d"on" ondragstart\x3d"return false;" aria-labelledby\x3d"',g,
'" on/mousedown\x3d"return false;"',m&&e.config.showToolbar?"\x3e":' style\x3d"display:none"\x3e'];POLARIS.tools.addFunction(function(a){13===a.keyCode&&e.fire("save")});e.addCommand("toolbarCollapse",{readOnly:1,exec:function(a,b){var c=a.ui.space("toolbar_collapser"),d=a.ui.space("toolbox"),e=a.ui.space("contents"),f=d.getParent(),g=parseInt(e.$.offsetHeight,10),h=f.$.offsetHeight,k=b.show,l=b.fromClickEvt;if(c){var m=c.hasClass("polaris_toolbox_collapser_min");m?(c.removeClass("polaris_toolbox_collapser_min"),
c.setAttribute("title",a.lang.toolbar.toolbarCollapse)):(c.addClass("polaris_toolbox_collapser_min"),c.setAttribute("title",a.lang.toolbar.toolbarExpand));c.getFirst().setText(m?"▲":"◀")}k?d.show():d.hide();e.isVisible()||(g=POLARIS.tools.convertToPx(e.getComputedStyle("height")));e.setStyle("height",g-(f.$.offsetHeight-h)+"px");a.fire("resize");c={};c.isVlsible=k?!0:!1;l&&a.fire("toolbarMenuVisible",c)},modes:{wysiwyg:1,source:1}});e.addCommand("toolbarShowRow",{readOnly:1,exec:function(a,b){for(var c=
a.ui.space("toolbox").getLast(),d=a.ui.space("contents"),e=c.getParent(),f=parseInt(d.$.style.height,10),g=e.$.offsetHeight,h=[],k=0;k<c.$.childNodes.length;k++){var l=c.$.childNodes[k],m=l.getAttribute("role");m&&"toolbar"==m&&h.push(l)}for(k=0;k<h.length;k++)c=new POLARIS.dom.node(h[k]),l=c.getNext(),m=(new POLARIS.dom.node(document.getElementById(c.getId()+"_label"))).getText(),b&&b.toolbarName&&m==b.toolbarName&&(b.show?(c.show(),l.show()):(c.hide(),l.hide()));d.isVisible()||(f=POLARIS.tools.convertToPx(d.getComputedStyle("height")));
d.setStyle("height",f-(e.$.offsetHeight-g)+"px");a.fire("resize")},modes:{wysiwyg:1,source:1}});e.config.toolbarCanCollapse&&e.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&v.push('\x3cspan class\x3d"polaris_toolbox_main" unselectable\x3d"on" \x3e');for(var g=e.toolbox.toolbars,m=a(e),r=0;r<m.length;r++){var p,t=0,w,A=m[r],x;if(A)if(n&&(v.push("\x3c/span\x3e"),q=n=0),"/"==A)v.push('\x3cspan class\x3d"polaris_toolbar_break"',0<r&&m[r-1]&&0==m[r-1].show?' style\x3d"display:none;"':"","\x3e\x3c/span\x3e");
else{x=A.items||A;for(var C=0;C<x.length;C++){var u=x[C],B;if(u){var G=function(a){a=a.render(e,v);y=t.items.push(a)-1;0<y&&(a.previous=t.items[y-1],a.previous.next=a);a.toolbar=t;a.onkey=k;a.onfocus=function(){e.toolbox.focusCommandExecuted||e.focus()}};B=!1!==u.canGroup;if(!t){p=POLARIS.tools.getNextId();t={id:p,items:[]};w=A.name&&(e.lang.toolbar.toolbarGroups[A.name]||A.name);v.push('\x3cspan id\x3d"',p,'" class\x3d"polaris_toolbar"',w?' aria-labelledby\x3d"'+p+'_label"':"",1==A.show?"":'style\x3d"display:none"',
' role\x3d"toolbar" unselectable\x3d"on"\x3e');0==A.show&&(d=!0);w&&v.push('\x3cspan id\x3d"',p,'_label" class\x3d"polaris_voice_label" unselectable\x3d"on"\x3e',w,"\x3c/span\x3e");v.push('\x3cspan class\x3d"polaris_toolbar_start"\x3e\x3c/span\x3e');var y=g.push(t)-1;0<y&&(t.previous=g[y-1],t.previous.next=t)}B?n||(v.push('\x3cspan class\x3d"polaris_toolgroup" role\x3d"presentation" unselectable\x3d"on"\x3e'),n=1):n&&(v.push("\x3c/span\x3e"),n=0);q&&(G(q),q=0);G(u)}}n&&(v.push("\x3c/span\x3e"),q=
n=0);t&&v.push('\x3cspan class\x3d"polaris_toolbar_end"\x3e\x3c/span\x3e\x3c/span\x3e')}}e.config.toolbarCanCollapse&&v.push("\x3c/span\x3e");v.push("\x3c/div\x3e");c.data.html+=v.join("")}},null,null,4);e.on("destroy",function(){if(this.toolbox){var a,b=0,c,d,e;for(a=this.toolbox.toolbars;b<a.length;b++)for(d=a[b].items,c=0;c<d.length;c++)e=d[c],e.clickFn&&POLARIS.tools.removeFunction(e.clickFn),e.keydownFn&&POLARIS.tools.removeFunction(e.keydownFn),e.focusFn&&POLARIS.tools.removeFunction(e.focusFn)}});
e.on("contentDom",function(){d&&e.fire("showToolbarExpandButton",{display:!0})});e.on("uiReady",function(){var a=e.ui.space("toolbox");a&&e.focusManager.add(a,1)});e.addCommand("toolbarFocus",c);e.setKeystroke(POLARIS.ALT+121,"toolbarFocus");e.ui.add("-",POLARIS.UI_SEPARATOR,{});e.ui.addHandler(POLARIS.UI_SEPARATOR,{create:function(){return{render:function(a,b){b.push('\x3cspan class\x3d"polaris_toolbar_separator" role\x3d"separator"\x3e\x3c/span\x3e');return{}}}}})}});POLARIS.ui.prototype.addToolbarGroup=
function(a,b,c){var d=e(this.editor),l=0===b,m={name:a};if(c){if(c=POLARIS.tools.search(d,function(a){return a.name==c})){!c.groups&&(c.groups=[]);if(b&&(b=POLARIS.tools.indexOf(c.groups,b),0<=b)){c.groups.splice(b+1,0,a);return}l?c.groups.splice(0,0,a):c.groups.push(a);return}b=null}b&&(b=POLARIS.tools.indexOf(d,function(a){return a.name==b}));l?d.splice(0,0,a):"number"==typeof b?d.splice(b+1,0,m):d.push(a)}})();POLARIS.UI_SEPARATOR="separator";POLARIS.config.toolbarLocation="top";"use strict";POLARIS.plugins.add("notification",
{requires:"toolbar",init:function(a){function e(a){var c=new POLARIS.dom.element("div");c.setStyles({position:"fixed","margin-left":"-9999px"});c.setAttributes({"aria-live":"assertive","aria-atomic":"true"});c.setText(a);POLARIS.document.getBody().append(c);setTimeout(function(){c.remove()},100)}a._.notificationArea=new wa(a);a.showNotification=function(b,c,d){var e,g;"progress"==c?e=d:g=d;b=new POLARIS.plugins.notification(a,{message:b,type:c,progress:e,duration:g});b.show();return b};a.on("key",
function(b){if(27==b.data.keyCode){var c=a._.notificationArea.notifications;c.length&&(e(a.lang.notification.closed),c[c.length-1].hide(),b.cancel())}})}});Fa.prototype={show:function(){!1!==this.editor.fire("notificationShow",{notification:this})&&(this.area.add(this),this._hideAfterTimeout())},update:function(a){var e=!0;!1===this.editor.fire("notificationUpdate",{notification:this,options:a})&&(e=!1);var b=this.element,c=b.findOne(".polaris_notification_message"),d=b.findOne(".polaris_notification_progress"),
h=a.type;b.removeAttribute("role");a.progress&&"progress"!=this.type&&(h="progress");h&&(b.removeClass(this._getClass()),b.removeAttribute("aria-label"),this.type=h,b.addClass(this._getClass()),b.setAttribute("aria-label",this.type),"progress"!=this.type||d?"progress"!=this.type&&d&&d.remove():(d=this._createProgressElement(),d.insertBefore(c)));void 0!==a.message&&(this.message=a.message,c.setHtml(this.message));void 0!==a.progress&&(this.progress=a.progress,d&&d.setStyle("width",this._getPercentageProgress()));
e&&a.important&&(b.setAttribute("role","alert"),this.isVisible()||this.area.add(this));this.duration=a.duration;this._hideAfterTimeout()},hide:function(){!1!==this.editor.fire("notificationHide",{notification:this})&&this.area.remove(this)},isVisible:function(){return 0<=POLARIS.tools.indexOf(this.area.notifications,this)},_createElement:function(){var a=this,e,b,c=this.editor.lang.common.close;e=new POLARIS.dom.element("div");e.addClass("polaris_notification");e.addClass(this._getClass());e.setAttributes({id:this.id,
role:"alert","aria-label":this.type});"progress"==this.type&&e.append(this._createProgressElement());b=new POLARIS.dom.element("p");b.addClass("polaris_notification_message");b.setHtml(this.message);e.append(b);b=POLARIS.dom.element.createFromHtml('\x3ca class\x3d"polaris_notification_close" href\x3d"javascript:void(0)" title\x3d"'+c+'" role\x3d"button" tabindex\x3d"-1"\x3e\x3cspan class\x3d"polaris_label"\x3eX\x3c/span\x3e\x3c/a\x3e');e.append(b);b.on("click",function(){a.editor.focus();a.hide()});
return e},_getClass:function(){return"progress"==this.type?"polaris_notification_info":"polaris_notification_"+this.type},_createProgressElement:function(){var a=new POLARIS.dom.element("span");a.addClass("polaris_notification_progress");a.setStyle("width",this._getPercentageProgress());return a},_getPercentageProgress:function(){return Math.round(100*(this.progress||0))+"%"},_hideAfterTimeout:function(){var a=this,e;this._hideTimeoutId&&clearTimeout(this._hideTimeoutId);if("number"==typeof this.duration)e=
this.duration;else if("info"==this.type||"success"==this.type)e="number"==typeof this.editor.config.notification_duration?this.editor.config.notification_duration:5E3;e&&(a._hideTimeoutId=setTimeout(function(){a.hide()},e))}};wa.prototype={add:function(a){this.notifications.push(a);this.element.append(a.element);1==this.element.getChildCount()&&(POLARIS.document.getBody().append(this.element),this._attachListeners());this._layout()},remove:function(a){var e=POLARIS.tools.indexOf(this.notifications,
a);0>e||(this.notifications.splice(e,1),a.element.remove(),this.element.getChildCount()||(this._removeListeners(),this.element.remove()))},_createElement:function(){var a=this.editor,e=a.config,b=new POLARIS.dom.element("div");b.addClass("polaris_notifications_area");b.setAttribute("id","polaris_notifications_area_"+a.name);b.setStyle("z-index",e.baseFloatZIndex-2);return b},_attachListeners:function(){var a=POLARIS.document.getWindow(),e=this.editor;a.on("scroll",this._uiBuffer.input);a.on("resize",
this._uiBuffer.input);e.on("change",this._changeBuffer.input);e.on("floatingSpaceLayout",this._layout,this,null,20);e.on("blur",this._layout,this,null,20)},_removeListeners:function(){var a=POLARIS.document.getWindow(),e=this.editor;a.removeListener("scroll",this._uiBuffer.input);a.removeListener("resize",this._uiBuffer.input);e.removeListener("change",this._changeBuffer.input);e.removeListener("floatingSpaceLayout",this._layout);e.removeListener("blur",this._layout)},_layout:function(){function a(){h.setStyles({position:"absolute",
top:A(l.y)})}function e(){h.setStyles({position:"absolute",top:A(l.y+f.height-m.height)})}function b(){h.setStyle("left",A(B))}function c(){h.setStyle("left",A(B+f.width/2-q/2-v/2))}function d(){h.setStyle("left",A(B+f.width-q-v))}if(this instanceof wa){var h=this.element,g=this.editor,k=g.ui.space("contents"),f=k.getClientRect(),l=k.getDocumentPosition(),g=g.ui.space("top"),k=g.getClientRect(),m=h.getClientRect(),n,q=this._notificationWidth,v=this._notificationMargin;n=POLARIS.document.getWindow();
var r=n.getScrollPosition(),p=n.getViewPaneSize(),t=POLARIS.document.getBody(),w=t.getDocumentPosition(),A=POLARIS.tools.cssLength,x,C;n=this.element.getChild(0);q=this._notificationWidth=n.getClientRect().width;x=this.notifications[0].align;C=this.notifications[0].valign;var u=this.notifications[0].width;u&&(n.setStyle("width",u+"px"),q=this._notificationWidth=u);v=this._notificationMargin=parseInt(n.getComputedStyle("margin-left"),10)+parseInt(n.getComputedStyle("margin-right"),10);"top"==C?a():
"bottom"==C||"middle"==C?e():g.isVisible()&&k.bottom>f.top&&k.bottom<f.bottom-m.height?h.setStyles({position:"fixed",top:A(k.bottom)}):0<f.top?a():l.y+f.height-m.height>r.y?h.setStyles({position:"fixed",top:0}):e();var B="fixed"==h.getStyle("position")?f.left:"static"!=t.getComputedStyle("position")?l.x-w.x:l.x;"left"==x?b():"center"==x?c():"right"==x?d():f.width<q+v?l.x+q+v>r.x+p.width?d():b():l.x+q+v>r.x+p.width?b():l.x+f.width/2+q/2+v>r.x+p.width?h.setStyle("left",A(B-l.x+r.x+p.width-q-v)):0>f.left+
f.width-q-v?d():0>f.left+f.width/2-q/2?h.setStyle("left",A(B-l.x+r.x)):c()}}};POLARIS.plugins.notification=Fa;(function(){function a(a,c,d){this.editor=a;this.notification=null;this._message=new POLARIS.template(c);this._singularMessage=d?new POLARIS.template(d):null;this._tasks=[];this._doneTasks=this._doneWeights=this._totalWeights=0}function e(a){this._weight=a||1;this._doneWeight=0;this._isCanceled=!1}POLARIS.plugins.add("notificationaggregator",{requires:"notification"});a.prototype={createTask:function(a){a=
a||{};var c=!this.notification,d;c&&(this.notification=this._createNotification());d=this._addTask(a);d.on("updated",this._onTaskUpdate,this);d.on("done",this._onTaskDone,this);d.on("canceled",function(){this._removeTask(d)},this);this.update();c&&this.notification.show();return d},update:function(){this._updateNotification();this.isFinished()&&this.fire("finished")},getPercentage:function(){return 0===this.getTaskCount()?1:this._doneWeights/this._totalWeights},isFinished:function(){return this.getDoneTaskCount()===
this.getTaskCount()},getTaskCount:function(){return this._tasks.length},getDoneTaskCount:function(){return this._doneTasks},_updateNotification:function(){this.notification.update({message:this._getNotificationMessage(),progress:this.getPercentage()})},_getNotificationMessage:function(){var a=this.getTaskCount(),c={current:this.getDoneTaskCount(),max:a,percentage:Math.round(100*this.getPercentage())};return(1==a&&this._singularMessage?this._singularMessage:this._message).output(c)},_createNotification:function(){return new POLARIS.plugins.notification(this.editor,
{type:"progress"})},_addTask:function(a){a=new e(a.weight);this._tasks.push(a);this._totalWeights+=a._weight;return a},_removeTask:function(a){var c=POLARIS.tools.indexOf(this._tasks,a);-1!==c&&(a._doneWeight&&(this._doneWeights-=a._doneWeight),this._totalWeights-=a._weight,this._tasks.splice(c,1),this.update())},_onTaskUpdate:function(a){this._doneWeights+=a.data;this.update()},_onTaskDone:function(){this._doneTasks+=1;this.update()}};POLARIS.event.implementOn(a.prototype);e.prototype={done:function(){this.update(this._weight)},
update:function(a){if(!this.isDone()&&!this.isCanceled()){a=Math.min(this._weight,a);var c=a-this._doneWeight;this._doneWeight=a;this.fire("updated",c);this.isDone()&&this.fire("done")}},cancel:function(){this.isDone()||this.isCanceled()||(this._isCanceled=!0,this.fire("canceled"))},isDone:function(){return this._weight===this._doneWeight},isCanceled:function(){return this._isCanceled}};POLARIS.event.implementOn(e.prototype);POLARIS.plugins.notificationAggregator=a;POLARIS.plugins.notificationAggregator.task=
e})();(function(){function a(a,b){var c='\x3cspan style\x3d"color:red;"\x3e\x3cb\x3e'+a.lang.license.licenseNotCorrect+"\x3c/b\x3e\x3c/span\x3e\x3cbr\x3e\x3cbr\x3e",c=c+('\x3cspan style\x3d"color:blue;"\x3e\x3cb\x3ePOLARIS EDITOR: v'+b.version+"\x3c/b\x3e\x3c/span\x3e\x3cbr\x3e\x3cbr\x3e"),c=c+'\x3cb\x3eWebSite: \x3ca href\x3d"http://www.infraware-global.com"\x3ewww.infraware-global.com\x3c/a\x3e\x3c/b\x3e\x3cbr\x3e\x3cb\x3eEmail: \x3ca href\x3d"mailto:se_support@infrawareglobal.com"\x3ese_support@infrawareglobal.com\x3c/a\x3e\x3c/b\x3e\x3cbr\x3e\x3cbr\x3e\x3cbr\x3e',
c=c+("Customer: "+b.company+"\x3cbr\x3e"),c=c+("System: "+b.system+"\x3cbr\x3e"),c=c+("Users: "+b.users+"\x3cbr\x3e"),c=c+("Domain: "+b.domainlist+"\x3cbr\x3e"),c=c+("License Serial Number: "+b.serial+"\x3cbr\x3e"),c=c+("License Expiry Date: "+b.expiryDate+"\x3cbr\x3e"),d="rgba(255,255,0,0.7)";POLARIS.env.ie&&8>=POLARIS.env.version&&(d="rgb(255,255,0)");var e=new POLARIS.dom.element("div");e.setAttribute("oncontextmenu","return false");e.setAttribute("id","polaris_progress_cover");e.setStyles({"background-color":d,
width:"100%",height:"100%",top:"0",left:"0",position:"absolute",visibility:"visible","z-index":"2000",cursor:"not-allowed"});e.setHtml('\x3cdiv style\x3d"display:table;width:100%;height:100%;"\x3e\x3cdiv style\x3d"text-align:center;vertical-align:middle;display:table-cell;"\x3e'+c+"\x3c/div\x3e\x3c/div\x3e");a.showProgress(!0,"license",e.getOuterHtml());setInterval(function(){a.showProgress(!1,"license");a.showProgress(!0,"license")},3E3)}function e(b,e){function k(){try{var a=new Date,b=new Date(m.expiryDate);
isNaN(b.getTime())&&(b=new Date(m.expiryDate.replace(/-/g,"/")));return a.getTime()-864E5<=b.getTime()}catch(c){}return!1}var f=POLARIS.getUrl("license.js"),l={};l.c=e;l.p="I LOVE "+c+d+"FOREVER";b.getCommand("decrypt_aes").setState(POLARIS.TRISTATE_ON);b.execCommand("decrypt_aes",l);var m=JSON.parse(l.returnValue);(function(){try{if(void 0==m.domainlist||null==m.domainlist)m.domainlist=[];var a=m.domainlist.slice(0);a.push("file://");a.push("://localhost");a.push("://127.0.0.1");for(var b=0;b<a.length;b++){if("*"==
a[b])return!0;if("string"!=typeof a[b]||0!=a[b].replace(/(^\s*)|(\s*$)/gi,"").length){var c=a[b].replace("*.","");if(1==(new RegExp(c,"gi")).test(f))return!0}}}catch(d){POLARIS.log.plugin(d)}return!1})()&&k()||a(b,m)}var b=function(){this.serial=this.version=this.company="";this.domainlist=[];this.expiryDate=""},c="LEE ";POLARIS.plugins.add("license",{lang:"en,ko",requires:"aes,notificationaggregator",afterInit:function(h){h.addCommand("getlicenseinfo",{exec:function(a,b){var e={};e.c=POLARIS.License;
e.p="I LOVE "+c+d+"FOREVER";a.getCommand("decrypt_aes").setState(POLARIS.TRISTATE_ON);a.execCommand("decrypt_aes",e);b&&(e=JSON.parse(e.returnValue),void 0==e.company&&(e.company="N/A"),void 0==e.system&&(e.system="N/A"),void 0==e.serial&&(e.serial="N/A"),void 0==e.users&&(e.users="N/A"),void 0==e.version&&(e.version="N/A"),void 0==e.expiryDate&&(e.expiryDate="N/A"),b.returnValue=e)}});h.on("contentDom",function(){POLARIS.scriptLoader.load(POLARIS.getUrl("license.js"),function(c){0==c?(c=new b,c.company=
"no name",c.system="no system",c.users="no user number",c.version="no version",c.serial="no serial",c.domainlist=[],c.expiryDate="no expiry date",a(h,c)):e(h,POLARIS.License)})})}});var d="YOUNGNAM "})();"use strict";(function(){function a(a,b){POLARIS.tools.extend(this,{editor:a,editable:a.editable(),doc:a.document,win:a.window},b,!0);this.frame=this.win.getFrame();this.inline=this.editable.isInline();this.target=this[this.inline?"editable":"doc"]}function e(a,b){POLARIS.tools.extend(this,b,{editor:a},
!0)}function b(a,b){var c=a.editable();POLARIS.tools.extend(this,{editor:a,editable:c,doc:a.document,win:a.window,container:POLARIS.document.getBody(),winTop:POLARIS.document.getWindow()},b,!0);this.hidden={};this.visible={};this.inline=c.isInline();this.inline||(this.frame=this.win.getFrame());this.queryViewport();var e=POLARIS.tools.bind(this.queryViewport,this),g=POLARIS.tools.bind(this.hideVisible,this),k=POLARIS.tools.bind(this.removeAll,this);c.attachListener(this.winTop,"resize",e);c.attachListener(this.winTop,
"scroll",e);c.attachListener(this.winTop,"resize",g);c.attachListener(this.win,"scroll",g);c.attachListener(this.inline?c:this.frame,"mouseout",function(a){var b=a.data.$.clientX;a=a.data.$.clientY;this.queryViewport();(b<=this.rect.left||b>=this.rect.right||a<=this.rect.top||a>=this.rect.bottom)&&this.hideVisible();(0>=b||b>=this.winTopPane.width||0>=a||a>=this.winTopPane.height)&&this.hideVisible()},this);c.attachListener(a,"resize",e);c.attachListener(a,"mode",k);a.on("destroy",k);this.lineTpl=
(new POLARIS.template('\x3cdiv data-polaris-lineutils-line\x3d"1" class\x3d"polaris_reset_all" style\x3d"{lineStyle}"\x3e\x3cspan style\x3d"{tipLeftStyle}"\x3e\x26nbsp;\x3c/span\x3e\x3cspan style\x3d"{tipRightStyle}"\x3e\x26nbsp;\x3c/span\x3e\x3c/div\x3e')).output({lineStyle:POLARIS.tools.writeCssText(POLARIS.tools.extend({},h,this.lineStyle,!0)),tipLeftStyle:POLARIS.tools.writeCssText(POLARIS.tools.extend({},d,{left:"0px","border-left-color":"red","border-width":"6px 0 6px 6px"},this.tipCss,this.tipLeftStyle,
!0)),tipRightStyle:POLARIS.tools.writeCssText(POLARIS.tools.extend({},d,{right:"0px","border-right-color":"red","border-width":"6px 6px 6px 0"},this.tipCss,this.tipRightStyle,!0))})}function c(a){var b;if(b=a&&a.type==POLARIS.NODE_ELEMENT)b=!(g[a.getComputedStyle("float")]||g[a.getAttribute("align")]);return b&&!k[a.getComputedStyle("position")]}POLARIS.plugins.add("lineutils");POLARIS.LINEUTILS_BEFORE=1;POLARIS.LINEUTILS_AFTER=2;POLARIS.LINEUTILS_INSIDE=4;a.prototype={start:function(a){var b=this,
c=this.editor,d=this.doc,e,g,h,k=POLARIS.tools.eventsBuffer(50,function(){c.readOnly||"wysiwyg"!=c.mode||(b.relations={},e=new POLARIS.dom.element(d.$.elementFromPoint(g,h)),b.traverseSearch(e),isNaN(g+h)||b.pixelSearch(e,g,h),a&&a(b.relations,g,h))});this.listener=this.editable.attachListener(this.target,"mousemove",function(a){g=a.data.$.clientX;h=a.data.$.clientY;k.input()});this.editable.attachListener(this.inline?this.editable:this.frame,"mouseout",function(a){k.reset()})},stop:function(){this.listener&&
this.listener.removeListener()},getRange:function(){var a={};a[POLARIS.LINEUTILS_BEFORE]=POLARIS.POSITION_BEFORE_START;a[POLARIS.LINEUTILS_AFTER]=POLARIS.POSITION_AFTER_END;a[POLARIS.LINEUTILS_INSIDE]=POLARIS.POSITION_AFTER_START;return function(b){var c=this.editor.createRange();c.moveToPosition(this.relations[b.uid].element,a[b.type]);return c}}(),store:function(){function a(b,c,d){var e=b.getUniqueId();e in d?d[e].type|=c:d[e]={element:b,type:c}}return function(b,d){var e;d&POLARIS.LINEUTILS_AFTER&&
c(e=b.getNext())&&e.isVisible()&&(a(e,POLARIS.LINEUTILS_BEFORE,this.relations),d^=POLARIS.LINEUTILS_AFTER);d&POLARIS.LINEUTILS_INSIDE&&c(e=b.getFirst())&&e.isVisible()&&(a(e,POLARIS.LINEUTILS_BEFORE,this.relations),d^=POLARIS.LINEUTILS_INSIDE);a(b,d,this.relations)}}(),traverseSearch:function(a){var b,d,e;do if(e=a.$["data-polaris-expando"],!(e&&e in this.relations)){if(a.equals(this.editable))break;if(c(a))for(b in this.lookups)(d=this.lookups[b](a))&&this.store(a,d)}while((!a||a.type!=POLARIS.NODE_ELEMENT||
"true"!=a.getAttribute("contenteditable"))&&(a=a.getParent()))},pixelSearch:function(){function a(d,e,f,g,h){for(var k=0,t;h(f);){f+=g;if(25==++k)break;if(t=this.doc.$.elementFromPoint(e,f))if(t==d)k=0;else if(b(d,t)&&(k=0,c(t=new POLARIS.dom.element(t))))return t}}var b=POLARIS.env.ie||POLARIS.env.webkit?function(a,b){return a.contains(b)}:function(a,b){return!!(a.compareDocumentPosition(b)&16)};return function(b,d,e){var g=this.win.getViewPaneSize().height,h=a.call(this,b.$,d,e,-1,function(a){return 0<
a});d=a.call(this,b.$,d,e,1,function(a){return a<g});if(h)for(this.traverseSearch(h);!h.getParent().equals(b);)h=h.getParent();if(d)for(this.traverseSearch(d);!d.getParent().equals(b);)d=d.getParent();for(;h||d;){h&&(h=h.getNext(c));if(!h||h.equals(d))break;this.traverseSearch(h);d&&(d=d.getPrevious(c));if(!d||d.equals(h))break;this.traverseSearch(d)}}}(),greedySearch:function(){this.relations={};for(var a=this.editable.getElementsByTag("*"),b=0,d,e,g;d=a.getItem(b++);)if(!d.equals(this.editable)&&
(d.hasAttribute("contenteditable")||!d.isReadOnly())&&c(d)&&d.isVisible())for(g in this.lookups)(e=this.lookups[g](d))&&this.store(d,e);return this.relations}};e.prototype={locate:function(){function a(b,d){var e=b.element[d===POLARIS.LINEUTILS_BEFORE?"getPrevious":"getNext"]();return e&&c(e)?(b.siblingRect=e.getClientRect(),d==POLARIS.LINEUTILS_BEFORE?(b.siblingRect.bottom+b.elementRect.top)/2:(b.elementRect.bottom+b.siblingRect.top)/2):d==POLARIS.LINEUTILS_BEFORE?b.elementRect.top:b.elementRect.bottom}
var b,d;return function(c){this.locations={};for(d in c)b=c[d],b.elementRect=b.element.getClientRect(),b.type&POLARIS.LINEUTILS_BEFORE&&this.store(d,POLARIS.LINEUTILS_BEFORE,a(b,POLARIS.LINEUTILS_BEFORE)),b.type&POLARIS.LINEUTILS_AFTER&&this.store(d,POLARIS.LINEUTILS_AFTER,a(b,POLARIS.LINEUTILS_AFTER)),b.type&POLARIS.LINEUTILS_INSIDE&&this.store(d,POLARIS.LINEUTILS_INSIDE,(b.elementRect.top+b.elementRect.bottom)/2);return this.locations}}(),sort:function(){var a,b,c,d,e,g;return function(h,k){a=this.locations;
b=[];for(d in a)for(e in a[d])if(c=Math.abs(h-a[d][e]),b.length){for(g=0;g<b.length;g++)if(c<b[g].dist){b.splice(g,0,{uid:+d,type:e,dist:c});break}g==b.length&&b.push({uid:+d,type:e,dist:c})}else b.push({uid:+d,type:e,dist:c});return"undefined"!=typeof k?b.slice(0,k):b}}(),store:function(a,b,c){this.locations[a]||(this.locations[a]={});this.locations[a][b]=c}};var d={display:"block",width:"0px",height:"0px","border-color":"transparent","border-style":"solid",position:"absolute",top:"-6px"},h={height:"0px",
"border-top":"1px dashed red",position:"absolute","z-index":9999};b.prototype={removeAll:function(){for(var a in this.hidden)this.hidden[a].remove(),delete this.hidden[a];for(a in this.visible)this.visible[a].remove(),delete this.visible[a]},hideLine:function(a){var b=a.getUniqueId();a.hide();this.hidden[b]=a;delete this.visible[b]},showLine:function(a){var b=a.getUniqueId();a.show();this.visible[b]=a;delete this.hidden[b]},hideVisible:function(){for(var a in this.visible)this.hideLine(this.visible[a])},
placeLine:function(a,b){var c,d,e;if(c=this.getStyle(a.uid,a.type)){for(e in this.visible)if(this.visible[e].getCustomData("hash")!==this.hash){d=this.visible[e];break}if(!d)for(e in this.hidden)if(this.hidden[e].getCustomData("hash")!==this.hash){this.showLine(d=this.hidden[e]);break}d||this.showLine(d=this.addLine());d.setCustomData("hash",this.hash);this.visible[d.getUniqueId()]=d;d.setStyles(c);b&&b(d)}},getStyle:function(a,b){var c=this.relations[a],d=this.locations[a][b],e={};e.width=c.siblingRect?
Math.max(c.siblingRect.width,c.elementRect.width):c.elementRect.width;e.top=this.inline?d+this.winTopScroll.y:this.rect.top+this.winTopScroll.y+d;if(e.top-this.winTopScroll.y<this.rect.top||e.top-this.winTopScroll.y>this.rect.bottom)return!1;this.inline?e.left=c.elementRect.left:(0<c.elementRect.left?e.left=this.rect.left+c.elementRect.left:(e.width+=c.elementRect.left,e.left=this.rect.left),0<(c=e.left+e.width-(this.rect.left+this.winPane.width))&&(e.width-=c));e.left+=this.winTopScroll.x;for(var g in e)e[g]=
POLARIS.tools.cssLength(e[g]);return e},addLine:function(){var a=POLARIS.dom.element.createFromHtml(this.lineTpl);a.appendTo(this.container);return a},prepare:function(a,b){this.relations=a;this.locations=b;this.hash=Math.random()},cleanup:function(){var a,b;for(b in this.visible)a=this.visible[b],a.getCustomData("hash")!==this.hash&&this.hideLine(a)},queryViewport:function(){this.winPane=this.win.getViewPaneSize();this.winTopScroll=this.winTop.getScrollPosition();this.winTopPane=this.winTop.getViewPaneSize();
this.rect=this.inline?this.editable.getClientRect():this.frame.getClientRect()}};var g={left:1,right:1,center:1},k={absolute:1,fixed:1};POLARIS.plugins.lineutils={finder:a,locator:e,liner:b}})();"use strict";(function(){function a(a){return a.replace(/'/g,"\\$\x26")}function e(a){for(var b,c=a.length,d=[],e=0;e<c;e++)b=a.charCodeAt(e),d.push(b);return"String.fromCharCode("+d.join(",")+")"}function b(b,c){var d=b.plugins.link,e=d.compiledProtectionFunction.params,f,g;g=[d.compiledProtectionFunction.name,
"("];for(var h=0;h<e.length;h++)d=e[h].toLowerCase(),f=c[d],0<h&&g.push(","),g.push("'",f?a(encodeURIComponent(c[d])):"","'");g.push(")");return g.join("")}function c(a){a=a.config.emailProtection||"";var b;a&&"encode"!=a&&(b={},a.replace(/^([^(]+)\(([^)]+)\)$/,function(a,c,d){b.name=c;b.params=[];d.replace(/[^,\s]+/g,function(a){b.params.push(a)})}));return b}POLARIS.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function a(b,c){var d="rtl"==b?"right":"left",e="polaris_contents_"+
b;return"."+e+" a.polaris_anchor,."+e+" a.polaris_anchor_empty,.polaris_editable."+e+" a[name],.polaris_editable."+e+" a[data-polaris-saved-name]{background:url("+c+") no-repeat "+d+" center;border:1px dotted #00f;background-size:16px;padding-"+d+":18px;cursor:auto;}."+e+" img.polaris_anchor{background:url("+c+") no-repeat "+d+" center;border:1px dotted #00f;background-size:16px;width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}"}var b=POLARIS.getUrl(this.path+"images"+(POLARIS.env.hidpi?
"/hidpi":"")+"/anchor.png");POLARIS.addCss(a("ltr",b)+a("rtl",b))},init:function(a){var b="a[!href]";POLARIS.dialog.isTabEnabled(a,"link","advanced")&&(b=b.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type]{*}(*)"));POLARIS.dialog.isTabEnabled(a,"link","target")&&(b=b.replace("]",",target,onclick]"));a.addCommand("link",new POLARIS.dialogCommand("link",{allowedContent:b,requiredContent:"a[href]"}));a.addCommand("anchor",new POLARIS.dialogCommand("anchor",{allowedContent:"a[!name,id]",
requiredContent:"a[name]"}));a.addCommand("unlink",new POLARIS.unlinkCommand);a.addCommand("removeAnchor",new POLARIS.removeAnchorCommand);a.setKeystroke(POLARIS.CTRL+76,"link");a.ui.addButton&&(a.ui.addButton("Link",{label:a.lang.link.toolbar,command:"link",toolbar:"links,10"}),a.ui.addButton("Unlink",{label:a.lang.link.unlink,command:"unlink",toolbar:"links,20"}),a.ui.addButton("Anchor",{label:a.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"}));POLARIS.dialog.add("link",this.path+
"dialogs/link.js");POLARIS.dialog.add("anchor",this.path+"dialogs/anchor.js");a.on("doubleclick",function(b){var c=POLARIS.plugins.link.getSelectedLink(a)||b.data.element;c.isReadOnly()||(c.is("a")?(b.data.dialog=!c.getAttribute("name")||c.getAttribute("href")&&c.getChildCount()?"link":"anchor",b.data.link=c):POLARIS.plugins.link.tryRestoreFakeAnchor(a,c)&&(b.data.dialog="anchor"))},null,null,0);a.on("doubleclick",function(b){b.data.dialog in{link:1,anchor:1}&&b.data.link&&a.getSelection().selectElement(b.data.link)},
null,null,20);a.on("mouseup",function(b){if("BAI"===a.config.customer){if(0!=b.data.buttonType)return}else if(0!=b.data.buttonType||b.data.isDragging||!b.data.ctrlKey&&0!=a.config.editMode)return;var c=b.data.element,d=a.getSelection();if(c.is({img:1,figcaption:1,span:1,font:1})){var e=c.getAscendant("a");e&&(c=e)}if(c.is("a")){e=document.createElement("a");e.href=c.getAttribute("href");if(c.$.hash&&0==c.$.hash.indexOf("#")){var f=POLARIS.plugins.link.getElementByFakeAnchorId(a,c.$.hash.slice(1));
if(f){POLARIS.env.ie&&d.selectElement(c);f.scrollIntoView();return}if(POLARIS.env.gecko&&(f=c.$.hash.slice(1),0==f.indexOf("%"))){f=POLARIS.plugins.link.getElementByFakeAnchorId(a,decodeURIComponent(f));f.scrollIntoView();return}}else 0!=e.href.indexOf("mailto")&&(e.target="_blank");POLARIS.env.ie&&b.data.ctrlKey&&0==a.config.editMode?d.selectElement(c):POLARIS.env.gecko||(c.getAttribute("data-polaris-pa-onclick")&&e.setAttribute("onclick",c.getAttribute("data-polaris-pa-onclick")),e.display="hidden",
document.body.appendChild(e),POLARIS.tools.clickLink(e),document.body.removeChild(e),d.selectElement(c))}});a.addMenuItems&&a.addMenuItems({anchor:{label:a.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:a.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},newlink:{label:a.lang.link.title,command:"link",group:"link",order:1},link:{label:a.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:a.lang.link.unlink,command:"unlink",group:"link",
order:5}});a.contextMenu&&a.contextMenu.addListener(function(b){if(!b||b.isReadOnly())return null;var c=POLARIS.plugins.link.tryRestoreFakeAnchor(a,b);b={};if(!c&&!(c=POLARIS.plugins.link.getSelectedLink(a))){b={newlink:POLARIS.TRISTATE_OFF};if("CLOUD ONNARA"===a.config.customer||"SNT"==a.config.customer)c=a.document.getSelection(),POLARIS.plugins.tabletools.isSelectedCell(c)&&delete b.newlink;return b}if(c.getAscendant("figure",1))return b;c.getAttribute("href")&&c.getChildCount()&&(b={link:POLARIS.TRISTATE_OFF,
unlink:POLARIS.TRISTATE_OFF});c&&c.hasAttribute("name")&&(b.anchor=b.removeAnchor=POLARIS.TRISTATE_OFF);return b});this.compiledProtectionFunction=c(a)},afterInit:function(a){a.dataProcessor.dataFilter.addRules({elements:{a:function(b){return b.attributes.name?b.children.length?null:a.createFakeParserElement(b,"polaris_anchor","anchor"):null}}});var b=a._.elementsPath&&a._.elementsPath.filters;b&&b.push(function(b,c){if("a"==c&&(POLARIS.plugins.link.tryRestoreFakeAnchor(a,b)||b.getAttribute("name")&&
(!b.getAttribute("href")||!b.getChildCount())))return"anchor"})}});var d=/^javascript:/,h=/^mailto:([^?]+)(?:\?(.+))?$/,g=/subject=([^;?:@&=$,\/]*)/,k=/body=([^;?:@&=$,\/]*)/,f=/^#(.*)$/,l=/^((?:http|https|ftp|news):\/\/)?(.*)$/,m=/^(_(?:self|top|parent|blank))$/,n=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,q=/^javascript:([^(]+)\(([^)]+)\)$/,v=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/,
r=/(?:^|,)([^=]+)=(\d+|yes|no)/gi,p={id:"advId",dir:"advLangDir",accessKey:"advAccessKey",name:"advName",lang:"advLangCode",tabindex:"advTabIndex",title:"advTitle",type:"advContentType","class":"advCSSClasses",charset:"advCharset",style:"advStyles",rel:"advRel"};POLARIS.plugins.link={getSelectedLink:function(a){var b=a.getSelection(),c=b.getSelectedElement();return c&&c.is("a")?c:(b=b.getRanges()[0])?(b.shrink(POLARIS.SHRINK_TEXT),a.elementPath(b.getCommonAncestor()).contains("a",1)):null},getElementByFakeAnchorId:function(a,
b){for(var c=a.editable(),c=c.isInline()&&!a.plugins.divarea?a.document:c,d=c.getElementsByTag("img"),e=0,f,g;f=d.getItem(e++);)if((g=this.tryRestoreFakeAnchor(a,f))&&b&&b==g.getAttribute("id"))return f;if(g=c.findOne('a[name\x3d"'+b+'"]'))return g},getEditorAnchors:function(a){for(var b=a.editable(),c=b.isInline()&&!a.plugins.divarea?a.document:b,b=c.getElementsByTag("a"),c=c.getElementsByTag("img"),d=[],e=0,f;f=b.getItem(e++);)(f.data("polaris-saved-name")||f.hasAttribute("name"))&&d.push({name:f.data("polaris-saved-name")||
f.getAttribute("name"),id:f.getAttribute("id")});for(e=0;f=c.getItem(e++);)(f=this.tryRestoreFakeAnchor(a,f))&&d.push({name:f.getAttribute("name"),id:f.getAttribute("id")});return d},fakeAnchor:!0,tryRestoreFakeAnchor:function(a,b){if(b&&b.data("polaris-real-element-type")&&"anchor"==b.data("polaris-real-element-type")){var c=a.restoreRealElement(b);if(c.data("polaris-saved-name"))return c}},parseLinkAttributes:function(a,b){var c=b&&(b.data("polaris-saved-href")||b.getAttribute("href"))||"",e=a.plugins.link.compiledProtectionFunction,
C=a.config.emailProtection,u,B={};c.match(d)&&("encode"==C?c=c.replace(n,function(a,b,c){return"mailto:"+String.fromCharCode.apply(String,b.split(","))+(c&&c.replace(/\\'/g,"'"))}):C&&c.replace(q,function(a,b,c){if(b==e.name){B.type="email";a=B.email={};b=/(^')|('$)/g;c=c.match(/[^,\s]+/g);for(var d=c.length,f,g,h=0;h<d;h++)f=decodeURIComponent,g=c[h].replace(b,"").replace(/\\'/g,"'"),g=f(g),f=e.params[h].toLowerCase(),a[f]=g;a.address=[a.name,a.domain].join("@")}}));if(!B.type)if(C=c.match(f))B.type=
"anchor",B.anchor={},B.anchor.name=B.anchor.id=C[1];else if(C=c.match(h)){u=c.match(g);c=c.match(k);B.type="email";var G=B.email={};G.address=C[1];u&&(G.subject=decodeURIComponent(u[1]));c&&(G.body=decodeURIComponent(c[1]))}else c&&(u=c.match(l))&&(B.type="url",B.url={},B.url.protocol=u[1],B.url.url=u[2],b?(B.url.text=b.getText(),B.url.subject=b.getAttribute("subject")):(B.url.text=u[2],B.url.subject=""));if(b){if(c=b.getAttribute("target"))B.target={type:c.match(m)?c:"frame",name:c};else if(c=(c=
b.data("polaris-pa-onclick")||b.getAttribute("onclick"))&&c.match(v))for(B.target={type:"popup",name:c[1]};C=r.exec(c[2]);)"yes"!=C[2]&&"1"!=C[2]||C[1]in{height:1,width:1,top:1,left:1}?isFinite(C[2])&&(B.target[C[1]]=C[2]):B.target[C[1]]=!0;var c={},y;for(y in p)(C=b.getAttribute(y))&&(c[p[y]]=C);if(y=b.data("polaris-saved-name")||c.advName)c.advName=y;POLARIS.tools.isEmpty(c)||(B.advanced=c)}return B},getLinkAttributes:function(c,d){var f=c.config.emailProtection||"",g={};switch(d.type){case "url":var f=
d.url&&void 0!==d.url.protocol?d.url.protocol:"http://",h=d.url&&POLARIS.tools.trim(d.url.url)||"";d.url&&POLARIS.tools.trim(d.url.text);g["data-polaris-saved-href"]=0===h.indexOf("/")?h:f+h;g.target="_blank";break;case "anchor":f=d.anchor&&d.anchor.id;g["data-polaris-saved-href"]="#"+(d.anchor&&d.anchor.name||f||"");break;case "email":var k=d.email,h=k.address;switch(f){case "":case "encode":var l=encodeURIComponent(k.subject||""),m=encodeURIComponent(k.body||""),k=[];l&&k.push("subject\x3d"+l);
m&&k.push("body\x3d"+m);k=k.length?"?"+k.join("\x26"):"";"encode"==f?(f=["javascript:void(location.href\x3d'mailto:'+",e(h)],k&&f.push("+'",a(k),"'"),f.push(")")):f=["mailto:",h,k];break;default:f=h.split("@",2),k.name=f[0],k.domain=f[1],f=["javascript:",b(c,k)]}g["data-polaris-saved-href"]=f.join("")}g.style=g.style?"color: #1109FF;"+g.style:"color: #1109FF";g.title=c.lang.link.tooltip;if(d.target)if("popup"==d.target.type){for(var f=["window.open(this.href, '",d.target.name||"","', '"],n="resizable status location toolbar menubar fullscreen scrollbars dependent".split(" "),
h=n.length,l=function(a){d.target[a]&&n.push(a+"\x3d"+d.target[a])},k=0;k<h;k++)n[k]+=d.target[n[k]]?"\x3dyes":"\x3dno";l("width");l("left");l("height");l("top");f.push(n.join(","),"'); return false;");g["data-polaris-pa-onclick"]=f.join("")}else"notSet"!=d.target.type&&d.target.name&&(g.target=d.target.name);if(d.advanced){for(var r in p)(f=d.advanced[p[r]])&&(g[r]=f);g.name&&(g["data-polaris-saved-name"]=g.name)}g["data-polaris-saved-href"]&&(g.href=g["data-polaris-saved-href"]);r=POLARIS.tools.extend({target:1,
onclick:1,"data-polaris-pa-onclick":1,"data-polaris-saved-name":1},p);for(var q in g)delete r[q];return{set:g,removed:POLARIS.tools.objectKeys(r)}}};POLARIS.unlinkCommand=function(){};POLARIS.unlinkCommand.prototype={exec:function(a){var b=a.getSelection(),c=b.createBookmarks();if(a=POLARIS.plugins.link.getSelectedLink(a)){for(var d=a.find("u, span"),e=0;e<d.count();e++){var f=d.getItem(e);f.is("u")?f.remove(!0):f.is("span")&&f.removeStyle("color")}b.selectBookmarks(c);a.remove(1)}},refresh:function(a,
b){var c=b.lastElement&&b.lastElement.getAscendant("a",!0);c&&"a"==c.getName()&&c.getAttribute("href")&&c.getChildCount()?this.setState(POLARIS.TRISTATE_OFF):this.setState(POLARIS.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]"};POLARIS.removeAnchorCommand=function(){};POLARIS.removeAnchorCommand.prototype={exec:function(a){var b=a.getSelection(),c=b.createBookmarks(),d;if(b&&(d=b.getSelectedElement())&&(d.getChildCount()?d.is("a"):POLARIS.plugins.link.tryRestoreFakeAnchor(a,
d))){a=d.find("u, span");for(var e=0;e<a.count();e++){var f=a.getItem(e);f.is("u")?f.remove(!0):f.is("span")&&f.removeStyle("color")}d.remove(1)}else if(d=POLARIS.plugins.link.getSelectedLink(a))if(d.hasAttribute("href"))d.removeAttributes({name:1,"data-polaris-saved-name":1}),d.removeClass("polaris_anchor");else{a=d.find("u, span");for(e=0;e<a.count();e++)f=a.getItem(e),f.is("u")?f.remove(!0):f.is("span")&&f.removeStyle("color");d.remove(1)}b.selectBookmarks(c)},requiredContent:"a[name]"};POLARIS.tools.extend(POLARIS.config,
{linkShowAdvancedTab:!1,linkShowTargetTab:!1})})();(function(){function a(a,b,c,d){for(var e=POLARIS.plugins.list.listToArray(b.root,c),f=[],g=0;g<b.contents.length;g++){var h=b.contents[g];(h=h.getAscendant("li",!0))&&!h.getCustomData("list_item_processed")&&(f.push(h),POLARIS.dom.element.setMarker(c,h,"list_item_processed",!0))}for(var h=b.root.getDocument(),k,l,g=0;g<f.length;g++){var m=f[g].getCustomData("listarray_index");k=e[m].parent;k.is(this.type)?e[m].parent.getStyle("list-style-type")!=
this.style&&e[m].parent.setStyle("list-style-type",this.style):(l=h.createElement(this.type),k.copyAttributes(l,{start:1,type:1}),l.setStyle("list-style-type",this.style),e[m].parent=l)}c=POLARIS.plugins.list.arrayToList(e,c,null,a.config.enterMode);for(var n,e=c.listNode.getChildCount(),g=0;g<e&&(n=c.listNode.getChild(g));g++)n.getName()==this.type&&d.push(n);c.listNode.replace(b.root);a.fire("contentDomInvalidated")}function e(a,b,c){var d=b.contents,e=b.root.getDocument(),f=[];if(1==d.length&&
d[0].equals(b.root)){var g=e.createElement("div");d[0].moveChildren&&d[0].moveChildren(g);d[0].append(g);d[0]=g}b=b.contents[0].getParent();for(g=0;g<d.length;g++)b=b.getCommonAncestor(d[g].getParent());a=a.config.useComputedState;var h,k;a=void 0===a||a;for(g=0;g<d.length;g++)for(var l=d[g],m;m=l.getParent();){if(m.equals(b)){f.push(l);!k&&l.getDirection()&&(k=1);l=l.getDirection(a);null!==h&&(h=h&&h!=l?null:l);break}l=m}if(!(1>f.length)){d=f[f.length-1].getNext();g=e.createElement(this.type);g.setStyle("list-style-type",
this.style);g.is("ol")&&g.setAttribute("data-ol-group",POLARIS.plugins.list.setOlGroupId());for(c.push(g);f.length;)c=f.shift(),a=e.createElement("li"),l=c,l.is("pre")||r.test(l.getName())||"false"==l.getAttribute("contenteditable")?c.appendTo(a):(c.copyAttributes(a),h&&c.getDirection()&&(a.removeStyle("direction"),a.removeAttribute("dir")),c.moveChildren(a),c.remove()),POLARIS.plugins.list.applyStyles(a),a.appendTo(g);h&&k&&g.setAttribute("dir",h);d?g.insertBefore(d):g.appendTo(b)}}function b(a,
b,c){function d(c){if(!(!(l=k[c?"getFirst":"getLast"]())||l.is&&l.isBlockBoundary()||!(m=b.root[c?"getPrevious":"getNext"](POLARIS.dom.walker.invisible(!0)))||m.is&&m.isBlockBoundary({br:1})))a.document.createElement("br")[c?"insertBefore":"insertAfter"](l)}for(var e=POLARIS.plugins.list.listToArray(b.root,c),f=[],g=0;g<b.contents.length;g++){var h=b.contents[g];(h=h.getAscendant("li",!0))&&!h.getCustomData("list_item_processed")&&(f.push(h),POLARIS.dom.element.setMarker(c,h,"list_item_processed",
!0))}h=null;for(g=0;g<f.length;g++)h=f[g].getCustomData("listarray_index"),e[h].indent=-1;for(g=h+1;g<e.length;g++)if(e[g].indent>e[g-1].indent+1){f=e[g-1].indent+1-e[g].indent;for(h=e[g].indent;e[g]&&e[g].indent>=h;)e[g].indent+=f,g++;g--}var k=POLARIS.plugins.list.arrayToList(e,c,null,a.config.enterMode,b.root.getAttribute("dir")).listNode,l,m;d(!0);d();console.dir(b.root);k.replace(b.root);a.fire("contentDomInvalidated")}function c(a,b,c){this.name=a;this.context=this.type=b;this.allowedContent=
b+" li";this.requiredContent=b;this.style=c}function d(a,b,c,d){for(var e,f;e=a[d?"getLast":"getFirst"](p);)(f=e.getDirection(1))!==b.getDirection(1)&&e.setAttribute("dir",f),e.remove(),c?e[d?"insertBefore":"insertAfter"](c):b.append(e,d)}function h(a){function b(c){var e=a[c?"getPrevious":"getNext"](q);e&&e.type==POLARIS.NODE_ELEMENT&&e.is(a.getName())&&a.data("ol-group")==e.data("ol-group")&&(d(a,e,null,!c),a.remove(),a=e)}b();b(1)}function g(a){return a.type==POLARIS.NODE_ELEMENT&&(a.getName()in
POLARIS.dtd.$block||a.getName()in POLARIS.dtd.$listItem)&&POLARIS.dtd[a.getName()]["#"]}function k(a,b,c){a.fire("saveSnapshot");c.enlarge(POLARIS.ENLARGE_LIST_ITEM_CONTENTS);var e=c.extractContents();b.trim(!1,!0);var g=b.createBookmark(),k=new POLARIS.dom.elementPath(b.startContainer),l=k.block,k=k.lastElement.getAscendant("li",1)||l,m=new POLARIS.dom.elementPath(c.startContainer),n=m.contains(POLARIS.dtd.$listItem),m=m.contains(POLARIS.dtd.$list);l?(l=l.getBogus())&&l.remove():m&&(l=m.getPrevious(q))&&
v(l)&&l.remove();(l=e.getLast())&&l.type==POLARIS.NODE_ELEMENT&&l.is("br")&&l.remove();(l=b.startContainer.getChild(b.startOffset))?e.insertBefore(l):b.startContainer.append(e);n&&(e=f(n))&&(k.contains(n)?(d(e,n.getParent(),n),e.remove()):k.append(e));for(;c.checkStartOfBlock()&&c.checkEndOfBlock();){m=c.startPath();e=m.block;if(!e)break;e.is("li")&&(k=e.getParent(),e.equals(k.getLast(q))&&e.equals(k.getFirst(q))&&(e=k));c.moveToPosition(e,POLARIS.POSITION_BEFORE_START);e.remove();POLARIS.plugins.list.reOrder(c.root);
b.moveToRange(c)}c=c.clone();e=a.editable();c.setEndAt(e,POLARIS.POSITION_BEFORE_END);c=new POLARIS.dom.walker(c);c.evaluator=function(a){return q(a)&&!v(a)};(c=c.next())&&c.type==POLARIS.NODE_ELEMENT&&c.getName()in POLARIS.dtd.$list&&h(c);b.moveToBookmark(g);b.select();a.fire("saveSnapshot")}function f(a){return(a=a.getLast(q))&&a.type==POLARIS.NODE_ELEMENT&&a.getName()in l?a:null}var l={ol:1,ul:1},m=POLARIS.dom.walker.whitespaces(),n=POLARIS.dom.walker.bookmark(),q=function(a){return!(m(a)||n(a))},
v=POLARIS.dom.walker.bogus();POLARIS.plugins.list={setOlGroupId:function(){return POLARIS.tools.generateUUID(!1)},paragraphInit:function(a){var b=a.getSelection(),c,d;if(c=b.getStartElement()){c=c.getAscendant(POLARIS.dtd.$listItem,!0);d=c.getParent();var e=d.getAttribute("data-ol-group"),f=POLARIS.plugins.list.setOlGroupId();if(c.is("li")&&d.is("ol"))if(c.$.previousSibling){var g=c.clone();g.insertBefore(c);g.breakParent(d);c=c.getParent();g.remove();for(b.getRanges()[0].select(!0);null!=c;)!c.is("ol")||
c.data("ol-group")!=e&&c.data("ol-group")||c.setAttribute("data-ol-group",f),c=c.getNext()}else for(;null!=d;)d.is("ol")&&d.data("ol-group")==e&&d.setAttribute("data-ol-group",f),d=d.getNext();POLARIS.plugins.list.reOrder(a.document)}},reOrder:function(a,b){var c=a.find("ol[data-ol-group]"),d={},e,f;e=0;for(f=c.immutableLength;e<f;e++){var g=c.getItem(e),h=g.data("ol-group");d[h]||(d[h]=b?b:1);g.setAttribute("start",d[h]);d[h]+=g.getChildCount()}},listToArray:function(a,b,c,d,e){if(!l[a.getName()])return[];
d||(d=0);c||(c=[]);for(var f=0,g=a.getChildCount();f<g;f++){var h=a.getChild(f);h.type==POLARIS.NODE_ELEMENT&&h.getName()in POLARIS.dtd.$list&&POLARIS.plugins.list.listToArray(h,b,c,d+1);if("li"==h.$.nodeName.toLowerCase()){var k={parent:a,indent:d,element:h,contents:[]};e?k.grandparent=e:(k.grandparent=a.getParent(),k.grandparent&&"li"==k.grandparent.$.nodeName.toLowerCase()&&(k.grandparent=k.grandparent.getParent()));b&&POLARIS.dom.element.setMarker(b,h,"listarray_index",c.length);c.push(k);for(var m=
0,n=h.getChildCount(),p;m<n;m++)p=h.getChild(m),p.type==POLARIS.NODE_ELEMENT&&l[p.getName()]?POLARIS.plugins.list.listToArray(p,b,c,d+1,k.grandparent):k.contents.push(p)}}return c},arrayToList:function(a,b,c,d,e){c||(c=0);if(!a||a.length<c+1)return null;for(var f,g=a[c].parent.getDocument(),h=new POLARIS.dom.documentFragment(g),k=null,m=c,p=Math.max(a[c].indent,0),r=null,v,t,z=d==POLARIS.ENTER_P?"p":"div";;){var D=a[m];f=D.grandparent;v=D.element.getDirection(1);if(D.indent==p){k&&a[m].parent.getName()==
k.getName()||(k=a[m].parent.clone(!1,1),e&&k.setAttribute("dir",e),h.append(k));r=k.append(D.element.clone(0,1));v!=k.getDirection(1)&&r.setAttribute("dir",v);for(f=0;f<D.contents.length;f++)r.append(D.contents[f].clone(1,1));m++}else if(D.indent==Math.max(p,0)+1)D=a[m-1].element.getDirection(1),m=POLARIS.plugins.list.arrayToList(a,null,m,d,D!=v?v:null),!r.getChildCount()&&POLARIS.env.needsNbspFiller&&7>=g.$.documentMode&&r.append(g.createText(" ")),r.append(m.listNode),m=m.nextIndex;else if(-1==
D.indent&&!c&&f){l[f.getName()]?(r=D.element.clone(!1,!0),v!=f.getDirection(1)&&r.setAttribute("dir",v)):r=new POLARIS.dom.documentFragment(g);var k=f.getDirection(1)!=v,O=D.element,P=O.getAttribute("class"),X=O.getAttribute("style"),S=r.type==POLARIS.NODE_DOCUMENT_FRAGMENT&&(d!=POLARIS.ENTER_BR||k||X||P),N,U=D.contents.length,na;for(f=0;f<U;f++)if(N=D.contents[f],n(N)&&1<U)S?na=N.clone(1,1):r.append(N.clone(1,1));else if(N.type==POLARIS.NODE_ELEMENT&&N.isBlockBoundary()){k&&!N.getDirection()&&N.setAttribute("dir",
v);t=N;var V=O.getAttribute("style");V&&t.setAttribute("style",V.replace(/([^;])$/,"$1;")+(t.getAttribute("style")||""));P&&N.addClass(P);t=null;na&&(r.append(na),na=null);r.append(N.clone(1,1))}else S?(t||(t=g.createElement(z),r.append(t),k&&t.setAttribute("dir",v)),X&&t.setAttribute("style",X),P&&t.setAttribute("class",P),na&&(t.append(na),na=null),t.append(N.clone(1,1))):r.append(N.clone(1,1));na&&((t||r).append(na),na=null);r.type==POLARIS.NODE_DOCUMENT_FRAGMENT&&m!=a.length-1&&(POLARIS.env.needsBrFiller&&
(v=r.getLast())&&v.type==POLARIS.NODE_ELEMENT&&v.is("br")&&v.remove(),(v=r.getLast(q))&&v.type==POLARIS.NODE_ELEMENT&&v.is(POLARIS.dtd.$block)||r.append(g.createElement("br")));v=r.$.nodeName.toLowerCase();"div"!=v&&"p"!=v||r.appendBogus();h.append(r);k=null;m++}else return null;t=null;if(a.length<=m||Math.max(a[m].indent,0)<p)break}if(b)for(a=h.getFirst();a;){if(a.type==POLARIS.NODE_ELEMENT&&(POLARIS.dom.element.clearMarkers(b,a),a.getName()in POLARIS.dtd.$listItem&&(c=a,g=e=d=void 0,d=c.getDirection()))){for(e=
c.getParent();e&&!(g=e.getDirection());)e=e.getParent();d==g&&c.removeAttribute("dir")}a=a.getNextSourceNode()}return{listNode:h,nextIndex:m}},applyStyles:function(a){function b(a){var c,d,f,g=0,h=POLARIS.dom.walker.bookmark();f=a.getChildren();c=0;for(d=f.count();c<d;c+=1){var k=f.getItem(c);k&&(k.type===POLARIS.NODE_ELEMENT?h(k)||k.is&&k.is("span")&&k.hasAttribute("style")&&(g+=b(k)):""!==k.getText().replace(/\u200b/g,"")&&(g+=1))}g||(g=1);a.is("li")||(a=a.getAttribute("style"),e[a]=e[a]?e[a]+g:
g);return g}function c(a){var b,d,e={};a=a.split(";").filter(function(a){return a.trim()});b=0;for(d=a.length;b<d;b+=1){var g,h;g=a[b].split(":");h=g[0].trim();g=g[1].trim();f.some(function(a){return a===h.toLowerCase()})&&(e[h]||(e[h]=g))}return e}function d(a){var b,c=[];for(b in a)c.push(b+":"+a[b]);return c.join(";")}if(a){var e={},f="color letter-spacing line-height font-family font-style font-size font-weight text-align".split(" "),g=a.clone(!0),h;h=b(g);var k,g="";for(k in e)e[k]===h&&(g+=
k);k=c("text-align:"+(a.getStyle("text-align")||"left")+";")||{};g=c(g)||{};(k=d(POLARIS.tools.extend({},k,g)))&&a.setAttribute("style",k)}}};var r=/^h[1-6]$/,p=POLARIS.dom.walker.nodeType(POLARIS.NODE_ELEMENT),t=function(c,d,f){var g=c.config,h=c.getSelection(),k=h&&h.getRanges();if(d.state==POLARIS.TRISTATE_OFF){var m=c.editable();if(m.getFirst(q)){var n=1==k.length&&k[0];(g=n&&n.getEnclosedNode())&&g.is&&d.type==g.getName()&&d.setState(POLARIS.TRISTATE_ON)}else g.enterMode==POLARIS.ENTER_BR?m.appendBogus():
k[0].fixBlock(1,g.enterMode==POLARIS.ENTER_P?"p":"div"),h.selectRanges(k)}for(var g=h.createBookmarks(!0),m=[],r={},k=k.createIterator(),p=0;(n=k.getNextRange())&&++p;){var v=n.getBoundaryNodes(),t=v.startNode,I=v.endNode;t.type==POLARIS.NODE_ELEMENT&&"td"==t.getName()&&n.setStartAt(v.startNode,POLARIS.POSITION_AFTER_START);I.type==POLARIS.NODE_ELEMENT&&"td"==I.getName()&&n.setEndAt(v.endNode,POLARIS.POSITION_BEFORE_END);n=n.createIterator();for(n.forceBrBreak=d.state==POLARIS.TRISTATE_OFF;v=n.getNextParagraph();)if(!v.getCustomData("list_block")){POLARIS.dom.element.setMarker(r,
v,"list_block",1);for(var L=c.elementPath(v),t=L.elements,I=0,L=L.blockLimit,z,D=t.length-1;0<=D&&(z=t[D]);D--)if(l[z.getName()]&&L.contains(z)){L.removeCustomData("list_group_object_"+p);(t=z.getCustomData("list_group_object"))?t.contents.push(v):(t={root:z,contents:[v]},m.push(t),POLARIS.dom.element.setMarker(r,z,"list_group_object",t));I=1;break}I||(I=L,I.getCustomData("list_group_object_"+p)?I.getCustomData("list_group_object_"+p).contents.push(v):(t={root:I,contents:[v]},POLARIS.dom.element.setMarker(r,
I,"list_group_object_"+p,t),m.push(t)))}}for(z=[];0<m.length;)t=m.shift(),d.state==POLARIS.TRISTATE_OFF?l[t.root.getName()]?d.style?a.call(d,c,t,r,z):b.call(d,c,t,r):d.style?e.call(d,c,t,z):d.refresh(c,c.elementPath()):d.state==POLARIS.TRISTATE_ON&&l[t.root.getName()]&&(d.style==t.root.getStyle("list-style-type")?b.call(d,c,t,r):f?d.style?a.call(d,c,t,r,z):b.call(d,c,t,r):b.call(d,c,t,r));POLARIS.dom.element.clearAllMarkers(r);h.selectBookmarks(g)};c.prototype={exec:function(a,b){this.refresh(a,a.elementPath());
var c=b&&b.fromPopup||!1,d=this;POLARIS.plugins.tabletools.selectedCellIterator(a,function(b,e){if(""!=e.getText().trim()){var f=new POLARIS.dom.range(a.document);f.selectNodeContents(e);f.select();t(a,d,c)}})||("paragraphinit"===d.name?POLARIS.plugins.list.paragraphInit(a):(a.pagination&&a.pagination.adjustCaret(a),t(a,this,c),a.focus()))},refresh:function(a,b){var c=b.contains(l,1),d=b.blockLimit||b.root;c&&d.contains(c)?this.setState(c.is(this.type)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF):this.setState(POLARIS.TRISTATE_OFF)}};
POLARIS.plugins.add("list",{requires:"indentlist",init:function(a){if(!a.blockless){var b=a.lang.list;a.addCommand("bulletedlist",new c("bulletedlist","ul",b.bulletedParagraphType.disc));"ko"==POLARIS.lang.detect()?a.addCommand("bulledtednone_kr",new c("numberedlist","ol",null)):a.addCommand("bulledtednone",new c("numberedlist","ol",null));a.addCommand(b.bulletedShapeNameList.disc,new c("bulletedlist","ul",b.bulletedParagraphType.disc));a.addCommand(b.bulletedShapeNameList.circle,new c("bulletedlist",
"ul",b.bulletedParagraphType.circle));a.addCommand(b.bulletedShapeNameList.square,new c("bulletedlist","ul",b.bulletedParagraphType.square));a.addCommand("numberedlist",new c("numberedlist","ol",b.numberedParagraphType.decimal));a.addCommand(b.numberedShapeNameList.decimal,new c("numberedlist","ol",b.numberedParagraphType.decimal));a.addCommand(b.numberedShapeNameList.upperalpha,new c("numberedlist","ol",b.numberedParagraphType.upperAlpha));a.addCommand(b.numberedShapeNameList.loweralpha,new c("numberedlist",
"ol",b.numberedParagraphType.lowerAlpha));a.addCommand(b.numberedShapeNameList.upperroman,new c("numberedlist","ol",b.numberedParagraphType.upperRoman));a.addCommand(b.numberedShapeNameList.lowerroman,new c("numberedlist","ol",b.numberedParagraphType.lowerRoman));a.addCommand("paragraphinit",new c("paragraphinit","ol",null));a.addCommand("removelist",new c("numberedlist","ol",null));a.ui.addButton&&(a.ui.addButton("NumberedList",{label:a.lang.list.numberedlist,command:"numberedlist",directional:!0,
toolbar:"list,10"}),a.ui.addButton("BulletedList",{label:a.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"}),a.ui.addButton("NumberedParagraph",{label:a.lang.list.numberedParagraph,command:"paragraphformat",toolbar:"list,30"}),a.ui.addButton("MultiLevel",{label:a.lang.list.multiLevel,command:"multiLevel",toolbar:"list,40"}));a.ui.add&&a.ui.add("NumberedParagraphFormat",POLARIS.UI_BUTTON,{label:a.lang.list.numberedParagraph,command:"paragraphformat"});a.addCommand("paragraphformat",
new POLARIS.dialogCommand("paragraphformat"));POLARIS.dialog.add("paragraphformat",this.path+"dialogs/paragraphformat.js");a.setKeystroke([[POLARIS.CTRL+POLARIS.SHIFT+45,"numberedlist"],[POLARIS.CTRL+POLARIS.SHIFT+46,"bulletedlist"]]);a.ui.add&&a.ui.add("NumberedParagraph",POLARIS.UI_MENUBUTTON,{title:a.lang.list.numberedParagraph,label:a.lang.list.numberedParagraph,command:"paragraphformat",toolbar:"display,100",onMenu:function(){return{open_dialog:POLARIS.TRISTATE_OFF,set_numberedlist:POLARIS.TRISTATE_OFF,
set_bulletedlist:POLARIS.TRISTATE_OFF,set_indent:POLARIS.TRISTATE_OFF,set_ountdent:POLARIS.TRISTATE_OFF}}});a.addMenuGroup("dropdownParagraph");a.addMenuItems({open_dialog:{label:a.lang.list.paragraphFormatLabel,group:"dropdownParagraph",command:"paragraphformat"},set_numberedlist:{label:a.lang.list.numberedParagraphLabel,group:"dropdownParagraph",command:"numberedlist"},set_bulletedlist:{label:a.lang.list.bulletedParagraphLabel,group:"dropdownParagraph",command:"bulletedlist"},set_indent:{label:a.lang.list.indentLabel,
group:"dropdownParagraph",command:"indent"},set_ountdent:{label:a.lang.list.outdentLabel,group:"dropdownParagraph",command:"outdent"}});a.addMenuItems({paragraph_format:{label:a.lang.pagination.paragraphform,group:"style",command:"paragraphform"},paragraph_init:{label:a.lang.list.paragraphinit,group:"style",command:"paragraphinit"}});a.contextMenu&&a.contextMenu.addListener(function(a,b,c){if(!a||a.isReadOnly()||!c)return null;if(!c||!c.contains({td:1,th:1,img:1},1)){a={};c=c.elements;b=a=!1;for(var d=
0;d<c.length;d++){var e=c[d];if(e&&e.is){if(e.is("li")){a=!0;continue}e.is("ol")&&(b=!0)}if(a&&b)break}return a=a&&b?{paragraph_format:POLARIS.TRISTATE_OFF,paragraph_init:POLARIS.TRISTATE_OFF}:{paragraph_format:POLARIS.TRISTATE_OFF}}});if(a.config.removeParagraphNumber)a.on("afterPaste",function(b){b=a.getSelection().getStartElement();b={"font-size":b.getComputedStyle("font-size"),"line-height":b.getComputedStyle("line-height"),"font-family":b.getComputedStyle("font-family")};for(var c=a.document.find("ol,ul"),
d=0;d<c.count();d++){for(var e=c.getItem(d),f=e.find("li"),g=0;g<f.count();g++){var h=f.getItem(g),k=new POLARIS.dom.element("p");k.setStyles(b);for(var l=0,m=h.getChildCount(),n=0;n<m;n++){var r=h.getChild(n-l);if(r.type==POLARIS.NODE_TEXT||r.type==POLARIS.NODE_ELEMENT&&!r.is("p"))k.append(r),l++}h.append(k);h.remove(!0)}e.remove(!0)}});a.on("key",function(b){var c=b.data.domEvent.getKey(),d;if("wysiwyg"==a.mode&&c in{8:1,46:1}){var e=a.getSelection().getRanges()[0],h=e&&e.startPath();if(e&&e.collapsed){var m=
8==c,n=a.editable(),r=new POLARIS.dom.walker(e.clone());r.evaluator=function(a){return q(a)&&!v(a)};r.guard=function(a,b){return!(b&&a.type==POLARIS.NODE_ELEMENT&&a.is("table"))};c=e.clone();if(m){var p;(p=h.contains(l))&&e.checkBoundaryOfElement(p,POLARIS.START)&&(p=p.getParent())&&p.is("li")&&(p=f(p))?(d=p,p=p.getPrevious(q),c.moveToPosition(p&&v(p)?p:d,POLARIS.POSITION_BEFORE_START)):(r.range.setStartAt(n,POLARIS.POSITION_AFTER_START),e.startContainer&&(e.startContainer.type!==POLARIS.NODE_ELEMENT||
e.startContainer.isExistText()?r.range.setEnd(e.startContainer,e.startOffset):r.range.setEnd(e.startContainer,0)),(p=r.previous())&&p.type==POLARIS.NODE_ELEMENT&&(p.getName()in l||p.is("li"))&&(p.is("li")||(r.range.selectNodeContents(p),r.reset(),r.evaluator=g,p=r.previous()),d=p,c.moveToElementEditEnd(d)));d?(k(a,c,e),b.cancel()):(c=h.contains(l))&&e.checkBoundaryOfElement(c,POLARIS.START)&&(d=c.getFirst(q),e.checkBoundaryOfElement(d,POLARIS.START)&&(p=c.getPrevious(q),f(d)?p&&(e.moveToElementEditEnd(p),
e.select()):a.execCommand("outdent"),b.cancel()))}else(d=h.contains("li"))?(r.range.setEndAt(n,POLARIS.POSITION_BEFORE_END),d=(h=d.getLast(q))&&g(h)?h:d,n=0,(p=r.next())&&p.type==POLARIS.NODE_ELEMENT&&p.getName()in l&&p.equals(h)?(n=1,p=r.next()):e.checkBoundaryOfElement(d,POLARIS.END)&&(n=1),n&&p&&(e=e.clone(),e.moveToElementEditStart(p),k(a,c,e),b.cancel())):(r.range.setEndAt(n,POLARIS.POSITION_BEFORE_END),(p=r.next())&&p.type==POLARIS.NODE_ELEMENT&&p.is(l)&&(p=p.getFirst(q),h.block&&e.checkStartOfBlock()&&
e.checkEndOfBlock()?(h.block.remove(),e.moveToElementEditStart(p),e.select()):f(p)?(e.moveToElementEditStart(p),e.select()):(e=e.clone(),e.moveToElementEditStart(p),k(a,c,e)),b.cancel()));setTimeout(function(){a.selectionChange(1)})}}})}}})})();(function(){POLARIS.plugins.liststyle={requires:"dialog,contextmenu",init:function(a){if(!a.blockless){var e;e=new POLARIS.dialogCommand("numberedListStyle",{requiredContent:"ol",allowedContent:"ol{list-style-type}[start]"});e=a.addCommand("numberedListStyle",
e);a.addFeature(e);POLARIS.dialog.add("numberedListStyle",this.path+"dialogs/liststyle.js");e=new POLARIS.dialogCommand("bulletedListStyle",{requiredContent:"ul",allowedContent:"ul{list-style-type}"});e=a.addCommand("bulletedListStyle",e);a.addFeature(e);POLARIS.dialog.add("bulletedListStyle",this.path+"dialogs/liststyle.js");a.addMenuGroup("list",108);a.addMenuItems({numberedlist:{label:a.lang.liststyle.numberedTitle,group:"list",command:"numberedListStyle"},bulletedlist:{label:a.lang.liststyle.bulletedTitle,
group:"list",command:"bulletedListStyle"}})}}};POLARIS.plugins.add("liststyle",POLARIS.plugins.liststyle)})();"use strict";(function(){function a(a,b,c){return n(b)&&n(c)&&c.equals(b.getNext(function(a){return!(ea(a)||ga(a)||q(a))}))}function e(a){this.upper=a[0];this.lower=a[1];this.set.apply(this,a.slice(2))}function b(a){var b=a.element;if(b&&n(b)&&(b=b.getAscendant(a.triggers,!0))&&a.editable.contains(b)){var c=g(b);if(null==c||-1<["polaris-page-endnote","field-editable-div","removable-pubdocbody"].indexOf(c.getAttribute("doc-data-role"))||
0==c.isEditable(!1))return null;if(c&&"true"==c.getAttribute("contenteditable"))return b;if(c&&c.is(a.triggers))return c}return null}function c(a,b,c){C(a,b);C(a,c);a=b.size.bottom;c=c.size.top;return a&&c?0|(a+c)/2:a||c}function d(a,b,c){return b=b[c?"getPrevious":"getNext"](function(b){return b&&b.type==POLARIS.NODE_TEXT&&!ea(b)||n(b)&&!q(b)&&!m(a,b)})}function h(a,b,c){return a>b&&a<c}function g(a,b){if(a.data("polaris-editable"))return null;for(b||(a=a.getParent());a&&!a.data("polaris-editable");){if(a.hasAttribute("contenteditable"))return a;
a=a.getParent()}return null}function k(a){var b=a.doc,c=E('\x3cspan contenteditable\x3d"false" style\x3d"'+ba+"position:absolute;border-top:1px dashed "+a.boxColor+'"\x3e\x3c/span\x3e',b),d=POLARIS.getUrl(this.path+"images/"+(H.hidpi?"hidpi/":"")+"icon"+(a.rtl?"-rtl":"")+".png");y(c,{attach:function(){this.wrap.getParent()||(a.editor.config.wordprocessor?this.wrap.appendTo(a.editor.editable(),!0):this.wrap.appendTo(a.editable,!0));return this},lineChildren:[y(E('\x3cspan title\x3d"'+a.editor.lang.magicline.title+
'" contenteditable\x3d"false"\x3e\x26#8629;\x3c/span\x3e',b),{base:ba+"height:17px;width:17px;"+(a.rtl?"left":"right")+":17px;background:url("+d+") center no-repeat "+a.boxColor+";cursor:pointer;"+(H.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(H.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px; border-radius: 2px;","top:-17px; border-radius: 2px 2px 0px 0px;","top:-1px; border-radius: 0px 0px 2px 2px;"]}),y(E(oa,b),{base:Ba+"left:0px;border-left-color:"+
a.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),y(E(oa,b),{base:Ba+"right:0px;border-right-color:"+a.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){this.wrap.getParent()&&this.wrap.remove();return this},mouseNear:function(){C(a,this);var b=1;a.editor.config.wordprocessor&&(b=a.editor.pagination.getScaleRatio()/
100);var b=a.holdDistance*b,c=this.size;return c&&h(a.mouse.y,c.top-b,c.bottom+b)&&h(a.mouse.x,c.left-b,c.right+b)?!0:!1},place:function(){var b=a.view,c=a.editable,d=a.trigger,e=d.upper,f=d.lower,g=e||f,k=g.getParent(),l={};this.trigger=d;e&&C(a,e,!0);f&&C(a,f,!0);C(a,k,!0);a.inInlineMode&&u(a,!0);k.equals(c)?(l.left=b.scroll.x,l.right=-b.scroll.x,l.width=""):(l.left=g.size.left-(a.inInlineMode?b.editable.left+b.editable.border.left:0),l.width=g.size.outerWidth,l.right="");e&&f?l.top=e.size.margin.bottom===
f.size.margin.top?0|e.size.bottom+e.size.margin.bottom/2:e.size.margin.bottom<f.size.margin.top?e.size.bottom+e.size.margin.bottom:e.size.bottom+e.size.margin.bottom-f.size.margin.top:e?f||(l.top=e.size.bottom+e.size.margin.bottom):l.top=f.size.top-f.size.margin.top;d.is(X)||h(l.top,b.scroll.y-15,b.scroll.y+5)?this.look(X):d.is(S)||h(l.top,b.pane.bottom-5,b.pane.bottom+15)?(l.top=a.inInlineMode?b.editable.height+b.editable.padding.top+b.editable.padding.bottom:b.pane.bottom-1,this.look(S)):(a.inInlineMode&&
(l.top-=b.editable.top+b.editable.border.top),this.look(N));a.inInlineMode&&(l.top--,l.top+=b.editable.scroll.top,l.left+=b.editable.scroll.left);for(var m in l)l[m]=POLARIS.tools.cssLength(l[m]);this.setStyles(l);b=this.findOne("span[title]");g&&g.$&&(g=g.$.getBoundingClientRect(),k.equals(c)?g.right<a.view.pane.width&&(b.removeStyle("right"),b.setStyle("left",POLARIS.tools.cssLength(g.right-17))):g.width<a.view.pane.width&&(b.removeStyle("right"),b.setStyle("left",POLARIS.tools.cssLength(g.width-
17))))},look:function(a){if(this.oldLook!=a){for(var b=this.lineChildren.length,c;b--;)(c=this.lineChildren[b]).setAttribute("style",c.base+c.looks[0|a/2]);this.oldLook=a}},wrap:new F("span",a.doc)});for(b=c.lineChildren.length;b--;)c.lineChildren[b].appendTo(c);c.look(N);c.appendTo(c.wrap);c.unselectable();c.lineChildren[0].on("mouseup",function(b){c.detach();f(a,function(b){var c=a.line.trigger;b[c.is(z)?"insertBefore":"insertAfter"](c.is(z)?c.lower:c.upper)},!0);a.editor.focus();H.ie||a.enterMode==
POLARIS.ENTER_BR||a.hotNode.scrollIntoView();b.data.preventDefault(!0)});c.on("mousedown",function(a){a.data.preventDefault(!0)});a.line=c}function f(a,b,c){var d=new POLARIS.dom.range(a.doc),e=a.editor,f;H.ie&&a.enterMode==POLARIS.ENTER_BR?f=a.doc.createText(U):(f=(f=g(a.element,!0))&&f.data("polaris-enter-mode")||a.enterMode,f=new F(L[f],a.doc),f.is("br")||a.doc.createText(U).appendTo(f));c&&e.fire("saveSnapshot");b(f);d.moveToPosition(f,POLARIS.POSITION_AFTER_START);e.getSelection().selectRanges([d]);
a.hotNode=f;c&&e.fire("saveSnapshot")}function l(a,c){return{canUndo:!0,modes:{wysiwyg:1},exec:function(){function e(b){var d=H.ie&&9>H.version?" ":U,g=a.hotNode&&a.hotNode.getText()==d&&a.element.equals(a.hotNode)&&a.lastCmdDirection===!!c;f(a,function(d){g&&a.hotNode&&a.hotNode.remove();d[c?"insertAfter":"insertBefore"](b);d.setAttributes({"data-polaris-magicline-hot":1,"data-polaris-magicline-dir":!!c});a.lastCmdDirection=!!c});H.ie||a.enterMode==POLARIS.ENTER_BR||a.hotNode.scrollIntoView();a.line.detach()}
return function(f){f=f.getSelection().getStartElement();var h;f=f.getAscendant(ka,1);if(!p(a,f)&&f&&!f.equals(a.editable)&&!f.contains(a.editable)){(h=g(f))&&"false"==h.getAttribute("contenteditable")&&(f=h);a.element=f;h=d(a,f,!c);var k;n(h)&&h.is(a.triggers)&&h.is(Z)&&(!d(a,h,!c)||(k=d(a,h,!c))&&n(k)&&k.is(a.triggers))?e(h):(k=b(a,f),n(k)&&(d(a,k,!c)?(f=d(a,k,!c))&&n(f)&&f.is(a.triggers)&&e(k):e(k)))}}}()}}function m(a,b){if(!b||b.type!=POLARIS.NODE_ELEMENT||!b.$)return!1;var c=a.line;return c.wrap.equals(b)||
c.wrap.contains(b)}function n(a){return a&&a.type==POLARIS.NODE_ELEMENT&&a.$}function q(a){if(!n(a))return!1;if(a.is("table"))return v(a);var b;(b=v(a))||(n(a)?(b={left:1,right:1,center:1},b=!(!b[a.getComputedStyle("float")]&&!b[a.getAttribute("align")])):b=!1);return b}function v(a){return!!{absolute:1,fixed:1}[a.getComputedStyle("position")]}function r(a,b){return-1<["polaris-page-endnote","field-editable-div","removable-pubdocbody"].indexOf(b.getAttribute("doc-data-role"))||0==b.isEditable(!1)?
null:n(b)?b.is(a.triggers):null}function p(a,b){if(!b)return!1;for(var c=b.getParents(1),d=c.length;d--;)for(var e=a.tabuList.length;e--;)if(c[d].hasAttribute(a.tabuList[e]))return!0;return!1}function t(a,b,c){b=b[c?"getLast":"getFirst"](function(b){return a.isRelevant(b)&&!b.is(V)});if(!b)return!1;C(a,b);return c?b.size.top>a.mouse.y:b.size.bottom<a.mouse.y}function w(a){if(a.editor.config.wordprocessor){var b=a.editor.plugins.pagination.getPage(a.editor.document,a.editor.plugins.pagination.getCurrentPageNumber(a.editor));
b&&(a.editable=b.body)}var c=a.editable,b=a.mouse,d=a.view,f=a.triggerOffset;u(a);var g=b.y>(a.inInlineMode?d.editable.top+d.editable.height/2:Math.min(d.editable.height,d.pane.height)/2),c=c[g?"getLast":"getFirst"](function(a){return!(ea(a)||ga(a))});if(!c)return null;m(a,c)&&(c=a.line.wrap[g?"getPrevious":"getNext"](function(a){return!(ea(a)||ga(a))}));if(!n(c)||q(c)||!r(a,c))return null;C(a,c);return!g&&0<=c.size.top&&h(b.y,0,c.size.top+f)?(a=a.inInlineMode||0===d.scroll.y?X:N,new e([null,c,z,
P,a])):g&&c.size.bottom<=d.pane.height&&h(b.y,c.size.bottom-f,d.pane.height)?(a=a.inInlineMode||h(c.size.bottom,d.pane.height-f,d.pane.height)?S:N,new e([c,null,D,P,a])):null}function A(a){var c=a.mouse,f=a.view,g=a.triggerOffset,k=b(a);if(!k||-1<["polaris-page-endnote","field-editable-div","removable-pubdocbody"].indexOf(k.getAttribute("doc-data-role"))||0==k.isEditable(!1))return null;C(a,k);var g=Math.min(g,0|k.size.outerHeight/2),l=[],m,p;if(h(c.y,k.size.top-1,k.size.top+g))p=!1;else if(h(c.y,
k.size.bottom-g,k.size.bottom+1))p=!0;else return null;if(q(k)||t(a,k,p)||k.getParent().is(na))return null;var v=d(a,k,!p);if(v){if(v&&v.type==POLARIS.NODE_TEXT)return null;if(n(v)){if(q(v)||!r(a,v)||v.getParent().is(na))return null;l=[v,k][p?"reverse":"concat"]().concat([O,P])}}else k.equals(a.editable[p?"getLast":"getFirst"](a.isRelevant))?(u(a),p&&h(c.y,k.size.bottom-g,f.pane.height)&&h(k.size.bottom,f.pane.height-g,f.pane.height)?m=S:h(c.y,0,k.size.top+g)&&(m=X)):m=N,l=[null,k][p?"reverse":"concat"]().concat([p?
D:z,P,m,k.equals(a.editable[p?"getLast":"getFirst"](a.isRelevant))?p?S:X:N]);return 0 in l?new e(l):null}function x(a,b,c,d){for(var e=b.getDocumentPosition(),f={},g={},h={},k={},l=la.length;l--;)f[la[l]]=parseInt(b.getComputedStyle.call(b,"border-"+la[l]+"-width"),10)||0,h[la[l]]=parseInt(b.getComputedStyle.call(b,"padding-"+la[l]),10)||0,g[la[l]]=parseInt(b.getComputedStyle.call(b,"margin-"+la[l]),10)||0;c&&!d||B(a,d);d=1;a.editor.config.wordprocessor&&(d=a.editor.pagination.getScaleRatio()/100);
k.top=e.y-(c?0:a.view.scroll.y);k.left=e.x-(c?0:a.view.scroll.x);k.outerWidth=b.$.offsetWidth*d;k.outerHeight=b.$.offsetHeight*d;k.height=k.outerHeight-(h.top+h.bottom+f.top+f.bottom);k.width=k.outerWidth-(h.left+h.right+f.left+f.right);k.bottom=k.top+k.outerHeight;k.right=k.left+k.outerWidth;a.inInlineMode&&(k.scroll={top:b.$.scrollTop,left:b.$.scrollLeft});return y({border:f,padding:h,margin:g,ignoreScroll:c},k,!0)}function C(a,b,c){if(!n(b))return b.size=null;if(!b.size)b.size={};else if(b.size.ignoreScroll==
c&&b.size.date>new Date-R)return null;return y(b.size,x(a,b,c),{date:+new Date},!0)}function u(a,b){a.view.editable=x(a,a.editable,b,!0)}function B(a,b){a.view||(a.view={});var c=a.view;if(!(!b&&c&&c.date>new Date-R)){var d=a.win,c=d.getScrollPosition(),d=d.getViewPaneSize();y(a.view,{scroll:{x:c.x,y:c.y,width:a.doc.$.documentElement.scrollWidth-d.width,height:a.doc.$.documentElement.scrollHeight-d.height},pane:{width:d.width,height:d.height,bottom:d.height+c.y},date:+new Date},!0)}}function G(a,
b,c,d){for(var f=d,g=d,h=0,k=!1,l=!1,m=a.view.pane.height,n=a.mouse;n.y+h<m&&0<n.y-h;){k||(k=b(f,d));l||(l=b(g,d));!k&&0<n.y-h&&(f=c(a,{x:n.x,y:n.y-h}));!l&&n.y+h<m&&(g=c(a,{x:n.x,y:n.y+h}));if(k&&l)break;h+=2}return new e([f,g,null,null])}POLARIS.plugins.add("magicline",{init:function(a){var c=a.config,g=c.magicline_triggerOffset||30,h={editor:a,enterMode:c.enterMode,triggerOffset:g,holdDistance:0|g*(c.magicline_holdDistance||.5),boxColor:c.magicline_color||"#0073d6",rtl:"rtl"==c.contentsLangDirection,
tabuList:["data-polaris-hidden-sel"].concat(c.magicline_tabuList||[]),triggers:c.magicline_everywhere?ka:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1,figure:1}},r,z,t;h.isRelevant=function(a){return n(a)&&!m(h,a)&&!q(a)};a.on("contentDom",function(){var g=a.editable(),n=a.document,q=a.window;y(h,{editable:g,inInlineMode:g.isInline(),doc:n,win:q,hotNode:null},!0);h.boundary=h.inInlineMode?h.editable:h.doc.getDocumentElement();g.is(I.$inline)||(h.inInlineMode&&!v(g)&&g.setStyles({position:"relative",
top:null,left:null}),k.call(this,h),B(h),g.attachListener(a,"beforeUndoImage",function(){h.line.detach()}),g.attachListener(a,"beforeGetData",function(){h.line.wrap.getParent()&&(h.line.detach(),a.once("getData",function(){h.line.attach()},null,null,1E3))},null,null,0),g.attachListener(n.getWindow().getFrame(),"mouseout",function(b){if("wysiwyg"==a.mode)if(h.inInlineMode){var c=b.data.$.clientX;b=b.data.$.clientY;B(h);u(h,!0);var d=h.view.editable,e=h.view.scroll;c>d.left-e.x&&c<d.right-e.x&&b>d.top-
e.y&&b<d.bottom-e.y||(clearTimeout(t),t=null,h.line.detach())}else clearTimeout(t),t=null,h.line.detach()}),g.attachListener(g,"keyup",function(){h.hiddenMode=0}),g.attachListener(g,"keydown",function(b){if("wysiwyg"==a.mode)switch(b.data.getKeystroke()){case 2228240:case 16:h.hiddenMode=1,h.line.detach()}}),g.attachListener(g,"mousemove",function(b){z=!0;if(!("wysiwyg"!=a.mode||a.readOnly||t||0==a.config.editMode||a.document.objResize&&a.document.objResize.attached)){var c={x:b.data.$.clientX,y:b.data.$.clientY};
t=setTimeout(function(){try{h.mouse=c,t=h.trigger=null,B(h),z&&!h.hiddenMode&&(a.config.wordprocessor||a.focusManager.hasFocus)&&!h.line.mouseNear()&&(h.element=da(h,!0))&&((h.trigger=w(h)||A(h)||aa(h))&&!p(h,h.trigger.upper||h.trigger.lower)?h.line.attach().place():(h.trigger=null,h.line.detach()),z=!1)}catch(b){}},30)}}),g.attachListener(q,"scroll",function(){"wysiwyg"==a.mode&&(h.line.detach(),H.webkit&&(h.hiddenMode=1,clearTimeout(r),r=setTimeout(function(){h.mouseDown||(h.hiddenMode=0)},50)))}),
g.attachListener(J?n:q,"mousedown",function(){"wysiwyg"==a.mode&&(h.line.detach(),h.hiddenMode=1,h.mouseDown=1)}),g.attachListener(J?n:q,"mouseup",function(){h.hiddenMode=0;h.mouseDown=0}),a.addCommand("accessPreviousSpace",l(h)),a.addCommand("accessNextSpace",l(h,!0)),a.setKeystroke([[c.magicline_keystrokePrevious,"accessPreviousSpace"],[c.magicline_keystrokeNext,"accessNextSpace"]]),a.on("loadSnapshot",function(){var b,c,d,e;for(e in{p:1,br:1,div:1})for(b=a.document.getElementsByTag(e),d=b.count();d--;)if((c=
b.getItem(d)).data("polaris-magicline-hot")){h.hotNode=c;h.lastCmdDirection="true"===c.data("polaris-magicline-dir")?!0:!1;return}}),this.backdoor={accessFocusSpace:f,boxTrigger:e,isLine:m,getAscendantTrigger:b,getNonEmptyNeighbour:d,getSize:x,that:h,triggerEdge:A,triggerEditable:w,triggerExpand:aa})},this)}});var y=POLARIS.tools.extend,F=POLARIS.dom.element,E=F.createFromHtml,H=POLARIS.env,J=POLARIS.env.ie&&9>POLARIS.env.version,I=POLARIS.dtd,L={},z=128,D=64,O=32,P=16,X=4,S=2,N=1,U=" ",na=I.$listItem,
V=I.$tableContent,Z=y({},I.$nonEditable,I.$empty),ka=I.$block,R=100,ba="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",Ba=ba+"border-color:transparent;display:block;border-style:solid;",oa="\x3cspan\x3e"+U+"\x3c/span\x3e";L[POLARIS.ENTER_BR]="br";L[POLARIS.ENTER_P]="p";L[POLARIS.ENTER_DIV]="div";e.prototype={set:function(a,b,c){this.properties=a+b+(c||N);return this},is:function(a){return(this.properties&a)==a}};
var da=function(){function a(b,c){var d=b.$.elementFromPoint(c.x,c.y);return d&&d.nodeType?new POLARIS.dom.element(d):null}return function(b,c,d){if(!b.mouse)return null;var e=b.doc,f=b.line.wrap;d=d||b.mouse;var g=a(e,d);c&&m(b,g)&&(f.hide(),g=a(e,d),f.show());return!g||g.type!=POLARIS.NODE_ELEMENT||!g.$||H.ie&&9>H.version&&!b.boundary.equals(g)&&!b.boundary.contains(g)?null:g}}(),ea=POLARIS.dom.walker.whitespaces(),ga=POLARIS.dom.walker.nodeType(POLARIS.NODE_COMMENT),aa=function(){function b(e){var f=
e.element,g,k,l;if(!n(f)||f.contains(e.editable)||f.isReadOnly())return null;l=G(e,function(a,b){return!b.equals(a)},function(a,b){return da(a,!0,b)},f);g=l.upper;k=l.lower;if(a(e,g,k))return l.set(O,8);if(g&&f.contains(g))for(;!g.getParent().equals(f);)g=g.getParent();else g=f.getFirst(function(a){return d(e,a)});if(k&&f.contains(k))for(;!k.getParent().equals(f);)k=k.getParent();else k=f.getLast(function(a){return d(e,a)});if(!g||!k)return null;C(e,g);C(e,k);if(!h(e.mouse.y,g.size.top,k.size.bottom))return null;
for(var f=Number.MAX_VALUE,m,p,r,q;k&&!k.equals(g)&&(p=g.getNext(e.isRelevant));)m=Math.abs(c(e,g,p)-e.mouse.y),m<f&&(f=m,r=g,q=p),g=p,C(e,g);if(!r||!q||!h(e.mouse.y,r.size.top,q.size.bottom))return null;l.upper=r;l.lower=q;return l.set(O,8)}function d(a,b){return!(b&&b.type==POLARIS.NODE_TEXT||ga(b)||q(b)||m(a,b)||b.type==POLARIS.NODE_ELEMENT&&b.$&&b.is("br"))}return function(c){var d=b(c),e;if(e=d){e=d.upper;var f=d.lower;e=!e||!f||q(f)||q(e)||f.equals(e)||e.equals(f)||f.contains(e)||e.contains(f)?
!1:r(c,e)&&r(c,f)&&a(c,e,f)?!0:!1}return e?d:null}}(),la=["top","left","right","bottom"]})();POLARIS.config.magicline_keystrokePrevious=POLARIS.CTRL+POLARIS.SHIFT+51;POLARIS.config.magicline_keystrokeNext=POLARIS.CTRL+POLARIS.SHIFT+52;(function(){function a(a){if(!a||a.type!=POLARIS.NODE_ELEMENT||"form"!=a.getName())return[];for(var b=[],c=["style","className"],d=0;d<c.length;d++){var e=a.$.elements.namedItem(c[d]);e&&(e=new POLARIS.dom.element(e),b.push([e,e.nextSibling]),e.remove())}return b}function e(a,
b){if(a&&a.type==POLARIS.NODE_ELEMENT&&"form"==a.getName()&&0<b.length)for(var c=b.length-1;0<=c;c--){var d=b[c][0],e=b[c][1];e?d.insertBefore(e):d.appendTo(a)}}function b(b,c){var d=a(b),f={},l=b.$;c||(f["class"]=l.className||"",l.className="");f.inline=l.style.cssText||"";c||(l.style.cssText="position: static; overflow: visible");e(d);return f}function c(b,c){var d=a(b),f=b.$;"class"in c&&(f.className=c["class"]);"inline"in c&&(f.style.cssText=c.inline);e(d)}function d(a){if(!a.editable().isInline()){var b=
POLARIS.instances,c;for(c in b){var d=b[c];"wysiwyg"!=d.mode||d.readOnly||(d=d.document.getBody(),d.setAttribute("contentEditable",!1),d.setAttribute("contentEditable",!0),a.editable().hasFocus=!0)}a.editable().hasFocus&&(a.toolbox.focus(),a.focus())}}POLARIS.plugins.add("maximize",{init:function(a){function e(){var b=l.getViewPaneSize();a.resize(b.width,b.height,null,!0)}if(a.elementMode!=POLARIS.ELEMENT_MODE_INLINE){var k=a.lang,f=POLARIS.document,l=f.getWindow(),m,n,q,v,r=function(k){var r=a.container.getFirst(function(a){return a.type==
POLARIS.NODE_ELEMENT&&a.hasClass("polaris_inner")}),w=a.ui.space("contents");if("wysiwyg"==a.mode){var A=a.getSelection();m=A&&A.getRanges();n=l.getScrollPosition()}else{var x=a.editable().$;m=!POLARIS.env.ie&&[x.selectionStart,x.selectionEnd];n=[x.scrollLeft,x.scrollTop]}if("maximize"==k.name){l.on("resize",e);q=l.getScrollPosition();for(A=a.container;A=A.getParent();)A.setCustomData("maximize_saved_styles",b(A)),A.setStyle("z-index",a.config.baseFloatZIndex-5);w.setCustomData("maximize_saved_styles",
b(w,!0));r.setCustomData("maximize_saved_styles",b(r,!0));w={width:0,height:0};f.getDocumentElement().setStyles(w);!POLARIS.env.gecko&&f.getDocumentElement().setStyle("position","fixed");POLARIS.env.gecko&&POLARIS.env.quirks||f.getBody().setStyles(w);POLARIS.env.ie?setTimeout(function(){l.$.scrollTo(0,0)},0):l.$.scrollTo(0,0);r.setStyle("position",POLARIS.env.gecko&&POLARIS.env.quirks?"fixed":"absolute");r.$.offsetLeft;r.setStyles({"z-index":a.config.baseFloatZIndex-5,left:"0px",top:"0px"});r.addClass("polaris_maximized");
if(w=document.getElementById("insert-file"))w.className="polaris_maximized";e();w=r.getDocumentPosition();r.setStyles({left:-1*w.x+"px",top:-1*w.y+"px"});POLARIS.env.gecko&&d(a)}else if("minimize"==k.name){l.removeListener("resize",e);w=[w,r];for(A=0;A<w.length;A++)c(w[A],w[A].getCustomData("maximize_saved_styles")),w[A].removeCustomData("maximize_saved_styles");for(A=a.container;A=A.getParent();)c(A,A.getCustomData("maximize_saved_styles")),A.removeCustomData("maximize_saved_styles");POLARIS.env.ie?
setTimeout(function(){l.$.scrollTo(q.x,q.y)},0):l.$.scrollTo(q.x,q.y);r.removeClass("polaris_maximized");if(w=document.getElementById("insert-file"))w.className="";POLARIS.env.webkit&&(r.setStyle("display","inline"),setTimeout(function(){r.setStyle("display","block")},0));a.fire("resize")}d(a);"wysiwyg"==a.mode?m?(POLARIS.env.gecko&&d(a),a.getSelection().selectRanges(m),(x=a.getSelection().getStartElement())&&x.scrollIntoView(!0)):l.$.scrollTo(n.x,n.y):(m&&(x.selectionStart=m[0],x.selectionEnd=m[1]),
x.scrollLeft=n[0],x.scrollTop=n[1]);m=n=null;v=k.name};a.addCommand("maximize",{modes:{wysiwyg:!POLARIS.env.iOS,source:!POLARIS.env.iOS},readOnly:1,editorFocus:!1,exec:function(){this.state!=POLARIS.TRISTATE_ON&&(a.getCommand("maximize").setState(POLARIS.TRISTATE_ON),a.getCommand("minimize").setState(POLARIS.TRISTATE_OFF),r(this),a.fire("maximize",this.state))},canUndo:!1});a.addCommand("minimize",{modes:{wysiwyg:!POLARIS.env.iOS,source:!POLARIS.env.iOS},readOnly:1,editorFocus:!1,exec:function(){this.state!=
POLARIS.TRISTATE_ON&&(a.getCommand("minimize").setState(POLARIS.TRISTATE_ON),a.getCommand("maximize").setState(POLARIS.TRISTATE_OFF),r(this),a.fire("minimize",this.state))},canUndo:!1});a.ui.addButton&&a.ui.addButton("Maximize",{label:k.maximize.maximize,command:"maximize",toolbar:"tools,10"});a.ui.addButton&&a.ui.addButton("Minimize",{label:k.maximize.minimize,command:"minimize",toolbar:"tools,20"});a.getCommand("minimize").state=POLARIS.TRISTATE_ON;a.on("mode",function(){"maximize"==v?(a.getCommand("maximize").setState(POLARIS.TRISTATE_ON),
a.getCommand("minimize").setState(POLARIS.TRISTATE_OFF)):"minimize"==v&&(a.getCommand("minimize").setState(POLARIS.TRISTATE_ON),a.getCommand("maximize").setState(POLARIS.TRISTATE_OFF))},null,null,100)}}})})();POLARIS.plugins.add("menubutton",{requires:"button,menu",lang:"en,ko",onLoad:function(){var a=function(a){var b=this._,c=b.menu;if(b.state!==POLARIS.TRISTATE_DISABLED){var d=a.getCommand(this.command);d&&d.state==POLARIS.TRISTATE_DISABLED||(b.on&&c?c.hide():(b.previousState=b.state,c||(c=b.menu=
new POLARIS.menu(a,{panel:{className:"polaris_menu_panel",attributes:{"aria-label":a.lang.common.options}}}),c.onHide=POLARIS.tools.bind(function(){var c=this.command?a.getCommand(this.command).modes:this.modes;this.setState(!c||c[a.mode]?b.previousState:POLARIS.TRISTATE_DISABLED);b.on=0},this),this.onMenu&&c.addListener(this.onMenu)),this.setState(POLARIS.TRISTATE_ON),b.on=1,setTimeout(function(){c.show(POLARIS.document.getById(b.id),4)},0)))}};POLARIS.ui.menuButton=POLARIS.tools.createClass({base:POLARIS.ui.button,
$:function(e){delete e.panel;this.base(e);this.hasArrow=!0;this.click=a},statics:{handler:{create:function(a){return new POLARIS.ui.menuButton(a)}}}});POLARIS.ui.menuTextButton=POLARIS.tools.createClass({base:POLARIS.ui.textbutton,$:function(e){delete e.panel;this.base(e);this.hasArrow=!0;this.click=a},statics:{handler:{create:function(a){return new POLARIS.ui.menuTextButton(a)}}}});POLARIS.ui.menuSettingButton=POLARIS.tools.createClass({base:POLARIS.ui.button,$:function(e){delete e.panel;this.base(e);
this.click=a},statics:{handler:{create:function(a){return new POLARIS.ui.menuSettingButton(a)}}}})},beforeInit:function(a){a.ui.addHandler(POLARIS.UI_MENUBUTTON,POLARIS.ui.menuButton.handler);a.ui.addHandler(POLARIS.UI_MENU_TEXT_BUTTON,POLARIS.ui.menuTextButton.handler);a.ui.addHandler(POLARIS.UI_MENU_SETTING_BUTTON,POLARIS.ui.menuSettingButton.handler)},init:function(a){a.addMenuGroup("menuSetting");a.addMenuItems({toolbarMode:{label:a.lang.menubutton.settingOptionGeneral,group:"menuSetting",onClick:function(){a.ui.toolbarMode=
1;a.execCommand("ribbonCollapse",{show:!1,fromClickEvt:!0});a.execCommand("qatoolbarCollapse",!1);a.config.showMenubar&&a.execCommand("menubarCollapse",!0);a.config.showToolbar&&a.execCommand("toolbarCollapse",{show:!0,fromClickEvt:!0})}},ribbonMode:{label:a.lang.menubutton.settingOptionRibbon,group:"menuSetting",onClick:function(){a.ui.toolbarMode=2;a.execCommand("menubarCollapse",!1);a.execCommand("toolbarCollapse",{show:!1,fromClickEvt:!0});a.config.showRibbon&&a.execCommand("ribbonCollapse",{show:!0,
fromClickEvt:!0});a.config.showQuickAccessToolbar&&a.execCommand("qatoolbarCollapse",!0)}}});1==a.config.toolbarMode?(a.config.ribbonStartupExpanded=!1,a.config.qatoolbarStartupExpanded=!1,a.config.menubarStartupExpanded=!0,a.config.toolbarStartupExpanded=!0):2==a.config.toolbarMode&&(a.config.ribbonStartupExpanded=!0,a.config.qatoolbarStartupExpanded=!0,a.config.menubarStartupExpanded=!1,a.config.toolbarStartupExpanded=!1);a.ui.toolbarMode=a.config.toolbarMode}});POLARIS.UI_MENUBUTTON="menubutton";
POLARIS.UI_MENU_TEXT_BUTTON="menutextbutton";POLARIS.UI_MENU_SETTING_BUTTON="menusettingbutton";POLARIS.plugins.add("newpage",{init:function(a){a.addCommand("newpage",{modes:{wysiwyg:1,source:1},exec:function(a){var b=this;POLARIS.plugins.get("wysiwygarea").setApplyContentCss(!1);a.setData(a.config.newpage_html||"",function(){a.focus();setTimeout(function(){a.fire("afterCommandExec",{name:"newpage",command:b});a.selectionChange()},200)})},async:!0});a.ui.addButton&&a.ui.addButton("NewPage",{label:a.lang.newpage.toolbar,
command:"newpage",toolbar:"document,20"})}});"use strict";(function(){function a(a){return{"aria-label":a,"class":"polaris_pagebreak",contenteditable:"false","data-polaris-display-name":"pagebreak","data-polaris-pagebreak":1,style:"page-break-after: always",title:a}}POLARIS.plugins.add("pagebreak",{requires:"fakeobjects",onLoad:function(){var a=("background:url("+POLARIS.getUrl(this.path+"images/pagebreak.gif")+") no-repeat center center;clear:both;width:100%;border-top:#999 1px dotted;border-bottom:#999 1px dotted;padding:0;height:5px;cursor:default;").replace(/;/g,
" !important;");POLARIS.addCss("div.polaris_pagebreak{"+a+"}")},init:function(a){a.blockless||(a.addCommand("pagebreak",POLARIS.plugins.pagebreakCmd),a.ui.addButton&&a.ui.addButton("PageBreak",{label:a.lang.pagebreak.toolbar,command:"pagebreak",toolbar:"insert,70"}),POLARIS.env.webkit&&a.on("contentDom",function(){a.document.on("click",function(b){b=b.data.getTarget();b.is("div")&&b.hasClass("polaris_pagebreak")&&a.getSelection().selectElement(b)})}))},afterInit:function(e){function b(b){POLARIS.tools.extend(b.attributes,
a(e.lang.pagebreak.alt),!0);b.children.length=0}var c=e.dataProcessor,d=c&&c.dataFilter,c=c&&c.htmlFilter,h=/page-break-after\s*:\s*always/i,g=/display\s*:\s*none/i;c&&c.addRules({attributes:{"class":function(a,b){var c=a.replace("polaris_pagebreak","");if(c!=a){var d=POLARIS.htmlParser.fragment.fromHtml('\x3cspan style\x3d"display: none;"\x3e\x26nbsp;\x3c/span\x3e').children[0];b.children.length=0;b.add(d);d=b.attributes;delete d["aria-label"];delete d.contenteditable;delete d.title}return c}}},
{applyToAll:!0,priority:5});d&&d.addRules({elements:{div:function(a){if(a.attributes["data-polaris-pagebreak"])b(a);else if(h.test(a.attributes.style)){var c=a.children[0];c&&"span"==c.name&&g.test(c.attributes.style)&&b(a)}}}})}});POLARIS.plugins.pagebreakCmd={exec:function(e){var b=e.document.createElement("div",{attributes:a(e.lang.pagebreak.alt)});e.insertElement(b)},context:"div",allowedContent:{div:{styles:"!page-break-after"},span:{match:function(a){return(a=a.parent)&&"div"==a.name&&a.styles&&
a.styles["page-break-after"]},styles:"display"}},requiredContent:"div{page-break-after}"}})();(function(){POLARIS.plugins.add("pagelayout",{requires:"dialog",init:function(a){POLARIS.dialog.add("pagelayout",POLARIS.getUrl(this.path+"dialogs/pagelayout.js"));a.addCommand("pagelayout",new POLARIS.dialogCommand("pagelayout"));a.ui.addButton&&a.ui.addButton("PageLayout",{label:a.lang.pagelayout.button,command:"pagelayout",toolbar:"doctools,10"})}});var a={},e={};POLARIS.addLayouts=function(b,c){a[b]=
c};POLARIS.getLayouts=function(b){return a[b]};POLARIS.loadLayouts=function(a,c){for(var d=[],h=0,g=a.length;h<g;h++)e[a[h]]||(d.push(a[h]),e[a[h]]=1);d.length?POLARIS.scriptLoader.load(d,c):setTimeout(c,0)}})();POLARIS.config.layouts_files=[POLARIS.getUrl("plugins/pagelayout/layouts/default.js")];(function(){function a(a,c,d){var e=POLARIS.cleanWord;e?d():(a=POLARIS.getUrl(a.config.pasteFromWordCleanupFile||c+"filter/default.js"),POLARIS.scriptLoader.load(a,d,null,!0));return!e}function e(a){a.data.type=
"html"}POLARIS.plugins.add("pastefromword",{requires:"clipboard",init:function(b){var c=0,d=this.path;b.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(a){var b=this;c=1;a.once("beforePaste",e);a.getClipboardData({title:a.lang.pastefromword.title},function(c){c&&a.fire("paste",{type:"html",dataValue:c.dataValue});a.fire("afterCommandExec",{name:"pastefromword",command:b,returnValue:!!c})})}});b.ui.addButton&&b.ui.addButton("PasteFromWord",{label:b.lang.pastefromword.toolbar,command:"pastefromword",
toolbar:"clipboard,50"});b.on("pasteState",function(a){b.getCommand("pastefromword").setState(a.data)});b.on("paste",function(e){var g=e.data,k=g.dataValue;if(k&&(c||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(k))){var f=a(b,d,function(){if(f)b.fire("paste",g);else if(!b.config.pasteFromWordPromptCleanup||c||confirm(b.lang.pastefromword.confirmCleanup))g.dataValue=POLARIS.cleanWord(k,b);c=0});f&&e.cancel()}},null,null,3)}})})();(function(){var a={canUndo:!1,async:!0,exec:function(e){e.getClipboardData({title:e.lang.pastetext.title},
function(b){b&&e.fire("paste",{type:"text",dataValue:b.dataValue});e.fire("afterCommandExec",{name:"pastetext",command:a,returnValue:!!b})})}};POLARIS.plugins.add("pastetext",{requires:"clipboard",init:function(e){e.addCommand("pastetext",a);e.ui.addButton&&e.ui.addButton("PasteText",{label:e.lang.pastetext.button,command:"pastetext",toolbar:"clipboard,40"});if(e.config.forcePasteAsPlainText)e.on("beforePaste",function(a){"html"!=a.data.type&&(a.data.type="text")});e.on("pasteState",function(a){e.getCommand("pastetext").setState(a.data)})}})})();
(function(){var a,e={modes:{wysiwyg:1,source:1},canUndo:!1,readOnly:1,exec:function(b){POLARIS.plugins.tabletools.clearSelectedCell();var c,d=b.config,e=d.baseHref?'\x3cbase href\x3d"'+d.baseHref+'"/\x3e':"";if(!1===b.fire("beforeContentPreview"))return!1;if(d.fullPage){d=b.document&&b.document.getBody();d.setStyle("width","100%");d.setStyle("margin-left","auto");d.setStyle("margin-right","auto");var g=b.document&&b.document.getDocumentElement();if(g){g=g.clone(!0);c=g.find("[contenteditable]");for(var k=
0;k<c.count();k++)c.getItem(k).removeAttribute("contenteditable");c=g.getOuterHtml().replace(/<head>/,"$\x26"+e).replace(/[^>]*(?=<\/title>)/,"$\x26 \x26mdash; "+b.lang.preview.preview)}else c=b.getData().replace(/<head>/,"$\x26"+e).replace(/[^>]*(?=<\/title>)/,"$\x26 \x26mdash; "+b.lang.preview.preview),c=c.replace(/contenteditable/,""),c=c.replace(/contentEditable/,"");d.removeStyle("width");d.removeStyle("margin")}else{g="\x3cbody ";if(d=b.document&&b.document.getBody())d.getAttribute("id")&&(g+=
'id\x3d"'+d.getAttribute("id")+'" '),d.getAttribute("class")&&(g+='class\x3d"'+d.getAttribute("class")+'" ');g+="\x3e";c=b.config.docType+'\x3chtml dir\x3d"'+b.config.contentsLangDirection+'"\x3e\x3chead\x3e'+e+"\x3ctitle\x3e"+b.lang.preview.preview+"\x3c/title\x3e"+POLARIS.tools.buildStyleHtml(b.config.contentsCss)+"\x3c/head\x3e"+g+b.getData()+"\x3c/body\x3e\x3c/html\x3e"}e=640;d=420;g=80;try{var f=window.screen,e=Math.round(.7*f.width),d=Math.round(.7*f.height),g=Math.round(.1*f.width)}catch(l){}if(!1===
b.fire("contentPreview",b={dataValue:c}))return!1;var f="",m;POLARIS.env.ie&&(window._polaris_htmlToLoad=b.dataValue,m="javascript:void( (function(){document.open();"+("("+POLARIS.tools.fixDomain+")();").replace(/\/\/.*?\n/g,"").replace(/parent\./g,"window.opener.")+"document.write( window.opener._polaris_htmlToLoad );document.close();window.opener._polaris_htmlToLoad \x3d null;})() )",f="");POLARIS.env.gecko&&(window._polaris_htmlToLoad=b.dataValue,f=POLARIS.getUrl(a+"preview.html"));f=window.open(f,
null,"toolbar\x3dyes,location\x3dno,status\x3dyes,menubar\x3dyes,scrollbars\x3dyes,resizable\x3dyes,width\x3d"+e+",height\x3d"+d+",left\x3d"+g);POLARIS.env.ie&&f&&(f.location=m);POLARIS.env.ie||POLARIS.env.gecko||(m=f.document,m.open(),m.write(b.dataValue),m.close());return!0}};POLARIS.plugins.add("preview",{init:function(b){b.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&(a=this.path,b.addCommand("preview",e),b.ui.addButton&&b.ui.addButton("Preview",{label:b.lang.preview.preview,command:"preview",toolbar:"document,40"}))}})})();
POLARIS.plugins.add("print",{init:function(a){a.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&(a.addCommand("print",POLARIS.plugins.print),a.ui.addButton&&a.ui.addButton("Print",{label:a.lang.print.toolbar,command:"print",toolbar:"document,50"}),a.addMenuItems({print:{label:a.lang.print.toolbar,group:"print",command:"print"}}),a.contextMenu&&a.contextMenu.addListener(function(a,b,c){if(a&&!a.isEditable()||!c)return null;if(!c||!c.contains({td:1,th:1},1))return{print:POLARIS.TRISTATE_OFF}}))}});POLARIS.plugins.print=
{exec:function(a,e){var b=function(){if(a.config.wordprocessor&&a.config.useDocConvertServer&&1<a.config.docConvertingUrl.length){a.showProgress(!0,"print");var b={};a.execCommand("getCurrDocumentId",b);var c=b.returnValue?b.returnValue:"",d=POLARIS.tools.getRandomFileName(36);params={pageInfo:1,returnValue:"",withCSS:1,convertBRToNBSP:1,convertZWSPToNBSP:1,isDocConvert:1,filePath:d};a.plugins.pagination.generateHtml(a,params);b=params.returnValue;b={html:b,id:c,path:d+".files/"};a.execCommandAbs("removeRemoteAddrToImgSrc",
b);b=b.returnValue;a.execCommandAbs("getBase64EncodeImageInfo",{id:c,path:d+".files/",fileName:d,html:b,callback:function(b){a.execCommandAbs("requestConvertHTMLToDocAtOnce",{id:c,fileName:d+".html",extension:"pdf",html:b.content,imgNames:b.imgNames,imgUris:b.imgUris,resultPath:"",callback:function(b){a.resetDirty();b={id:b.convertId,returnValue:"",stamp:b.stamp};a.execCommand("getPDFFileUrl",b);var c=a.document.getWindow().getViewPaneSize();a.popup(b.returnValue,c.width,c.height,a.config.filebrowserWindowFeatures||
a.config.fileBrowserWindowFeatures,e);a.showProgress(!1,"print")}})}})}else{if(!1===a.fire("beforeContentPrint"))return!1;if(POLARIS.env.gecko)a.window.$.print();else{var b=a.document.$.getElementById("header"),f=a.document.$.getElementById("footer");b&&(b.style.display="none");f&&(f.style.display="none");a.document.$.execCommand("Print")}if(!1===a.fire("afterContentPrint"))return!1}};if(a.config.onPrintClick){var c={pageInfo:1,withCSS:1,convertBRToNBSP:1};a.execCommandAbs("generateHtml",c);var c=
c.returnValue,d=POLARIS.tools.getRandomFileName(36);a.execCommandAbs("getBase64EncodeImageInfo",{id:"",path:"",fileName:d,html:c,callback:function(c){var e=c.content,k=c.imgNames;c=c.imgUris;var f=new FormData,e=new Blob([e],{type:"text/html"});f.append("html",e,d+".html");if(c)for(e=0;e<c.length;e++){for(var l=c[e],m=atob(l.split(",")[1]),l=l.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(m.length),q=new Uint8Array(n),v=0;v<m.length;v++)q[v]=m.charCodeAt(v);m=new Blob([n],{type:l});
f.append("images",m,k[e])}(c=a.config.onPrintClick(a,f))||b()}})}else b()},canUndo:!1,readOnly:1,modes:{wysiwyg:1}};(function(){var a=function(a,b){var c=function(a){function b(a){c=c.concat(a)}var c=[],d=["align","char","charoff"],e=["valign"],c=c.concat(["id"]);if("p"==a)b(["style","align"]);else if("a"==a)b(["name","href","rel","rev"]);else if("img"==a)b("src alt name longdesc height width align border hspace vspace".split(" "));else if("table"==a)b("summary width height border cellspacing cellpadding align".split(" "));
else if("caption"==a)b(["align"]);else if("colgroup"==a||"col"==a)b(["span","width"]),c=c.concat(d),c=c.concat(e);else if("thead"==a||"tfoot"==a||"tbody"==a||"tr"==a)c=c.concat(d),c=c.concat(e);else if("th"==a||"td"==a)b("abbr axis headers scope rowspan colspan nowrap width height".split(" ")),c=c.concat(d),c=c.concat(e);return{name:a,attr:c}},d=[],h={style:1,link:1,meta:1,title:1},g={content:1,sub:1,sup:1,i:1,b:1,u:1,p:1,ul:1,ol:1,li:1,a:1,img:1,table:1,caption:1,thead:1,tfoot:1,tbody:1,colgroup:1,
col:1,tr:1,th:1,td:1};(function(a){for(name in g){var b=new c(name);a[name]=b}})(d);var k;k='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e\r\n\x3c!DOCTYPE pubdoc [\x3c!ENTITY nbsp "\x26#160;"\x3e]\x3e\r\n';k+="\x3cpubdoc\x3e\x3cbody\x3e";var f=a.getSelection().getRanges()[0],f=f&&f.startContainer&&f.startContainer.getAscendant(function(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute("doc-data-field")},1);k+=function(a,b){function c(a){var b="";if(a.type==POLARIS.NODE_ELEMENT&&h[a.getName()])return b;
if(a.type==POLARIS.NODE_ELEMENT){"span"==a.getName()&&("bold"==a.getStyle("font-weight")&&(b+="\x3cb\x3e"),"italic"==a.getStyle("font-style")&&(b+="\x3ci\x3e"),"underline"==a.getStyle("text-decoration")&&(b+="\x3cu\x3e"));if(d[a.getName()]){for(var b=b+("\x3c"+a.getName()),e="",f=d[a.getName()],g=0;g<f.attr.length;g++){var k=f.attr[g];if(a.getStyle(k))var e=e+(" "+k+'\x3d"'),l=a.getStyle(k),k="border"==k?"none"==l?"0":"1":"width"==k||"height"==k?POLARIS.tools.convertToPx(l):l,e=e+k,e=e+'"';else a.hasAttribute(k)&&
(e+=" "+k+'\x3d"'+a.getAttribute(k)+'"')}b=b+e+"\x3e"}if(a.hasAttribute("doc-data-field")&&"article"!=a.getName())b+=POLARIS.tools.htmlEncode(a.getText());else for(f=0;f<a.getChildCount();f++)g=a.getChild(f),g.type==POLARIS.NODE_ELEMENT?b+=c(g):g.type!=POLARIS.NODE_COMMENT&&(b+=POLARIS.tools.htmlEncode(g.getText()));d[a.getName()]&&(b+="\x3c/"+a.getName()+"\x3e");"span"==a.getName()&&("underline"==a.getStyle("text-decoration")&&(b+="\x3c/u\x3e"),"italic"==a.getStyle("font-style")&&(b+="\x3c/i\x3e"),
"bold"==a.getStyle("font-weight")&&(b+="\x3c/b\x3e"))}else b+=POLARIS.tools.htmlEncode(a.getText());return b}a.document.getBody().append(b);for(var e=b.find("br"),f=0;f<e.count();f++){var g=e.getItem(f);if(g.getNext()){var k=g.getParent(),t=new POLARIS.dom.range(k.getDocument());t.moveToPosition(g,POLARIS.POSITION_BEFORE_START);t.collapse(!0);t.splitBlock("p");g.remove()}}for(f=b.getFirst();f;){if(f.type==POLARIS.NODE_TEXT){t=new POLARIS.dom.range(a.document);t.selectNodeContents(f);e=a.document.createElement("p");
if(k=f.getParent())e.setStyle("font-size",k.getComputedStyle("font-size")),e.setStyle("line-height",k.getComputedStyle("line-height")),e.setStyle("font-family",k.getComputedStyle("font-family"));e.setText(f.getText());t.insertNode(e);f.remove()}f=f.getNext()}k=function(a,b){var c="",d=null;(d=(d=b&&b.getTextNodes())&&d[0]?d[0].getParent():b)&&(c=d.getComputedStyle(a));return c};t=b.find("p");for(f=0;f<t.count();f++){e=t.getItem(f);e.getStyle("text-align")?("justify"==e.getStyle("text-align")?e.setAttribute("align",
"adjust"):e.setAttribute("align",e.getStyle("text-align")),e.removeStyle("text-align")):e.setAttribute("align","left");g=e.getStyle("line-height");""!=g&&0>g.indexOf("%")&&(g=100*g+"%",e.setStyle("line-height",g));g=e.getHtml();""!=g&&"\x3cbr\x3e"!=g||e.setHtml("\x26nbsp;");var g=k("font-family",e),w=k("font-size",e);POLARIS.tools.isEmptyValue(g)||e.setStyle("font-family",g);POLARIS.tools.isEmptyValue(w)||(w=POLARIS.tools.convertToUnit(w,"pt"),e.setStyle("font-size",w))}e=b.find("table");for(f=0;f<
e.count();f++){t=e.getItem(f);if(0==parseFloat(t.getStyle("border-width"))||"none"==t.getStyle("border-style"))t.removeStyle("border"),t.setAttribute("border","0");k=t.find("td");for(w=0;w<k.count();w++)if(g=k.getItem(w),parseFloat(g.getStyle("border-width"))&&""!=g.getStyle("border-style")&&"none"!=g.getStyle("border-style")){t.removeStyle("border");t.setAttribute("border","1");break}}k=b.find("td");for(f=0;f<k.count();f++)for(g=k.getItem(f),t=g.find("p"),0==t.count()&&0<g.getText().trim().length&&
g.getFirst()&&(g.trim(),t=new POLARIS.dom.range(a.document),t.setStartAt(g,POLARIS.POSITION_AFTER_START),t.setEndAt(g,POLARIS.POSITION_BEFORE_END),t.fixBlock(!0,"p"),t=g.find("p")),w=0;w<t.count();w++)e=t.getItem(w),e.getAttribute("align")||(g.getStyle("text-align")?"justify"==g.getStyle("text-align")?e.setAttribute("align","adjust"):e.setAttribute("align",g.getStyle("text-align")):e.setAttribute("align","left"));b.remove();return c(b)}(a,function(a,b,c){var d=a.document.createElement("content"),
e="";a.config.wordprocessor?(e={returnValue:"",dontMergeClickHere:1},a.plugins.pagination.generateHtml(a,e),e=e.returnValue):e=a.document.getBody().getHtml();if(c){var f=new POLARIS.dom.element("div");f.setHtml(e);c=f.find("[doc-data-field\x3d"+c.getAttribute("doc-data-field")+"]");for(e=0;e<c.count();e++)f=c.getItem(e),d.appendHtml(f.getHtml())}else d.appendHtml(e);c=a.checkDirty();e=b&&b.convertBRToNBSP;f=d.find("[doc-data-role\x3dremovable]");for(b=0;b<f.count();b++){var g=f.getItem(b);g.remove()}f=
d.find("table");for(b=0;b<f.count();b++)f.getItem(b).removeClass("polaris_table_border");f=d.find("td");for(b=0;b<f.count();b++)f.getItem(b).removeClass("polaris_table_border");f=d.find('[doc-data-role\x3d"removable-pubdocbody"]');for(b=0;b<f.count();b++)g=f.getItem(b),g.remove();f=d.find('[doc-data-role\x3d"polaris-page-header"]');for(b=0;b<f.count();b++)g=f.getItem(b),g.removeAttribute("ondblclick");f=d.find('[doc-data-role\x3d"polaris-page-footer"]');for(b=0;b<f.count();b++)g=f.getItem(b),g.removeAttribute("ondblclick");
f=d.find('[doc-data-role\x3d"footnote"]');for(b=0;b<f.count();b++)g=f.getItem(b),g.removeAttribute("contentEditable"),g.removeAttribute("title"),g.removeAttribute("onclick"),g.removeAttribute("id"),g.removeStyle("cursor"),g.removeStyle("display");f=d.find('[doc-data-role\x3d"endnote"]');for(b=0;b<f.count();b++)g=f.getItem(b),g.removeAttribute("contentEditable"),g.removeAttribute("title"),g.removeAttribute("onclick"),g.removeAttribute("id"),g.removeStyle("cursor"),g.removeStyle("display");f=d.find("img");
for(b=0;b<f.count();b++)g=f.getItem(b),g.hasClass("polaris_img_border")&&(g.removeClass("polaris_img_border"),g.setAttribute("src",g.getAttribute("data-polaris-saved-src")));f=d.find("a[title]");for(b=0;b<f.count();b++)f.getItem(b).removeAttribute("title");f=d.find("br");for(b=0;b<f.count();b++){var g=f.getItem(b),h=g.getParent();null!=h&&"td"==h.getName()&&"polaris-page-body"!=h.getAttribute("doc-data-role")&&(h.trim(),g.equals(h.getLast())&&g.remove(),e&&0==h.getChildCount()&&h.setHtml("\x26nbsp;"))}f=
d.find('td[contenteditable\x3d"false"]');for(b=0;b<f.count();b++)g=f.getItem(b),g.setAttribute("doc-data-protected","true"),g.removeAttribute("contenteditable");if(e)for(f=d.find("br"),b=0;b<f.count();b++)g=f.getItem(b),h=g.getParent(),null!=h&&"p"==h.getName()&&(h.trim(),0==h.getChildCount()?h.setHtml("\x26nbsp;"):1==h.getChildCount()&&(e=h.getChild(0),e.type==POLARIS.NODE_ELEMENT&&e.is("span")&&0==e.getChildCount()&&e.setHtml("\x26nbsp;")));e=d.find("[unselectable]");for(b=0;b<e.count();b++)e.getItem(b).removeAttribute("unselectable");
c||a.resetDirty();return d}(a,b,f));k+="\x3c/body\x3e\x3c/pubdoc\x3e";k=k.replace(/>\u200B</g,"\x3e\x26nbsp;\x3c");k=k.replace(/\u200B/g,"");k=k.replace(/\u00A0/g,"\x26nbsp;");b.returnValue=k};POLARIS.plugins.add("pubdocbody",{lang:"en,ko",icons:"pubdocbody",hidpi:!0,init:function(e){e.addCommand("generatePubDoc",{modes:{wysiwyg:1},readOnly:1,exec:a})}})})();POLARIS.plugins.add("table",{requires:"dialog",init:function(a){function e(a){return POLARIS.tools.extend(a||{},{contextSensitive:1,refresh:function(a,
b){var c=POLARIS.TRISTATE_DISABLED;if(b.contains({td:1,th:1,table:1},1))switch(this.name){case "tableproperties":c=POLARIS.TRISTATE_OFF;break;case "tabledelete":c=POLARIS.TRISTATE_OFF;break;case "tableindent":c=POLARIS.TRISTATE_OFF;break;case "tableleft":c=POLARIS.plugins.tabletools.setTableAlign(a,"left",!0)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;break;case "tablecenter":c=POLARIS.plugins.tabletools.setTableAlign(a,"center",!0)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;break;case "tableright":c=
POLARIS.plugins.tabletools.setTableAlign(a,"right",!0)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;break;case "tableoutdent":c=POLARIS.plugins.tabletools.setTableIndent(a,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "samewidth":c=POLARIS.plugins.tabletools.sameCellWidth(!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "sameheight":c=POLARIS.plugins.tabletools.sameCellHeight(!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;default:c=POLARIS.TRISTATE_OFF}this.setState(c)}})}
if(!a.blockless){var b=a.lang.table;a.addCommand("table",new POLARIS.dialogCommand("table",{context:"table",allowedContent:"table{width,height}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];",requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"]],contextSensitive:1,refresh:function(a,b){POLARIS.plugins.div.getSurroundDiv(a)&&this.setState(POLARIS.TRISTATE_DISABLED)}}));a.addCommand("tableProperties",
new POLARIS.dialogCommand("tableProperties",e()));a.addCommand("tableDelete",e({exec:function(a,b){var e,g;g=b?b:(e=a.elementPath())&&e.contains("table",1);if(g){var k=null;"polaris-table-paginated"==g.getAttribute("doc-data-role")&&(k=g.getAttribute("doc-data-value"));e=g.getParent();var f=a.editable(),l=g.getPrevious(),m=g.getNext();a.plugins.tabletools.clearSelectedTables(a);if(a.config.wordprocessor&&k){e=a.document.find('[doc-data-value\x3d"'+k+'"]');for(l=0;l<e.count();l++)m=e.getItem(l),0==
l&&m.getParent(),m.remove();a.fire("selectionChange",{selection:a.getSelection(),path:a.elementPath()})}else 1!=e.getChildCount()||e.is("td","th")||e.equals(f)||(g=e),g.remove(),g=a.createRange(),m&&0==m.is("table")?(g.moveToElementEditablePosition(m),g.select()):l&&0==l.is("table")?(g.moveToElementEditablePosition(l),g.select()):m?POLARIS.plugins.tabletools.placeCursorInTableCell(m):l?POLARIS.plugins.tabletools.placeCursorInTableCell(l):(g.moveToElementEditablePosition(e),g.select())}}}));a.addCommand("tableIndent",
e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.setTableIndent(a,!0)}}));a.addCommand("tableOutdent",e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.setTableIndent(a,!1)}}));a.addCommand("tableLeft",e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.setTableAlign(a,"left")}}));a.addCommand("tableCenter",e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.setTableAlign(a,"center")}}));a.addCommand("tableRight",e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.setTableAlign(a,
"right")}}));a.addCommand("sameWidth",e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.sameCellWidth()}}));a.addCommand("sameHeight",e({startDisabled:!0,exec:function(a){POLARIS.plugins.tabletools.sameCellHeight()}}));a.ui.addButton&&a.ui.addButton("Table",{label:b.toolbar,command:"table",toolbar:"insert,30"});a.ui.addButton&&a.ui.addButton("TableIndent",{label:b.tableIndent,command:"tableIndent",toolbar:"tabletools,31"});a.ui.addButton&&a.ui.addButton("TableOutdent",{label:b.tableOutdent,
command:"tableOutdent",toolbar:"tabletools,32"});a.ui.addButton&&a.ui.addButton("TableLeft",{label:b.tableLeft,command:"tableLeft",toolbar:"tabletools,33"});a.ui.addButton&&a.ui.addButton("TableCenter",{label:b.tableCenter,command:"tableCenter",toolbar:"tabletools,34"});a.ui.addButton&&a.ui.addButton("TableRight",{label:b.tableRight,command:"tableRight",toolbar:"tabletools,35"});a.ui.addButton&&a.ui.addButton("SameWidth",{label:b.sameCellWidth,command:"sameWidth",toolbar:"tabletools,29"});a.ui.addButton&&
a.ui.addButton("SameHeight",{label:b.sameCellHeight,command:"sameHeight",toolbar:"tabletools,30"});a.addCommand("showTableBorder",{exec:function(a){var b;if(this.state==POLARIS.TRISTATE_OFF){this.state=POLARIS.TRISTATE_ON;b=!0;for(var e=0;e<this.uiItems.length;e++)this.uiItems[e].setState(POLARIS.TRISTATE_ON)}else for(this.state=POLARIS.TRISTATE_OFF,b=!1,e=0;e<this.uiItems.length;e++)this.uiItems[e].setState(POLARIS.TRISTATE_OFF);for(var g=a.document.find("table"),e=0;e<g.count();e++){var k=g.getItem(e);
b?k.addClass("polaris_show_border"):k.removeClass("polaris_show_border");POLARIS.plugins.tabletools.displayRedBorder(k,b,a)}}});a.ui.addButton&&a.ui.addButton("ShowTableBorder",{label:b.showTableBorder,command:"showTableBorder",toolbar:"tabletools,31"});a.ui.addButton&&a.ui.addButton("TableProperties",{label:b.menu,command:"tableProperties",toolbar:"tabletools,20"});POLARIS.dialog.add("table",this.path+"dialogs/table.js");POLARIS.dialog.add("tableProperties",this.path+"dialogs/table.js");a.addMenuItems&&
a.addMenuItems({table:{label:b.menu,command:"tableProperties",group:"table",order:6},tabledelete:{label:b.deleteTable,command:"tableDelete",group:"table",order:5},sameCellWidth:{label:b.sameCellWidth,command:"sameWidth",group:"table",disableshow:1,order:3},sameCellHeight:{label:b.sameCellHeight,command:"sameHeight",group:"table",disableshow:1,order:4}});a.contextMenu&&a.contextMenu.addListener(function(b,d,e){if(b&&d&&e&&(d=a.getSelection(),POLARIS.plugins.tabletools.existSelectedCell(d))){if(2==
a.config.editMode&&(b=e.contains({table:1},1))&&0<b.find("[doc-data-field]").count())return;if((e=e.contains({table:1,td:1,th:1},1))&&!e.getAscendant(function(a){if(a.getAttribute&&("polaris-page-header"==a.getAttribute("doc-data-role")||"polaris-page-footer"==a.getAttribute("doc-data-role"))&&"false"==a.getAttribute("contenteditable"))return!0}))return e&&e.isReadOnly()?{table:POLARIS.TRISTATE_OFF}:{tabledelete:POLARIS.TRISTATE_OFF,table:POLARIS.TRISTATE_OFF}}})}}});POLARIS.plugins.add("quicktable",
{requires:"table,panelbutton,floatpanel",afterInit:function(a){var e,b;function c(b){return new POLARIS.dom.element(b,a.document)}function d(a,b){if(a)for(var c=a.elements,d=0,e;d<c.length;d++)if(e=c[d],e=e.getStyle(b))return e;return null}function h(b,e){POLARIS.plugins.tabletools.clearSelectedCell();a.pagination&&a.pagination.adjustCaret(a);if(!POLARIS.plugins.div.getSurroundDiv(a)){var f=a.getSelection().getStartElement();if(f){var g=a.elementPath(f),h={},k={};h["line-height"]=a.config.documentLineHeight?
a.config.documentLineHeight:d(g,"line-height");k["font-family"]=a.config.documentFontFamily?a.config.documentFontFamily:d(g,"font-family");k["font-size"]=a.config.documentFontSize?a.config.documentFontSize+"pt":d(g,"font-size");x=g?parseFloat((g.block||g.blockLimit||f).getSize("width",!0))-2:parseFloat(f.getSize("width",!0));for(var f=c("table"),l=f.append(c("colgroup")),g=f.append(c("tbody")),m=POLARIS.plugins.tabletools.getSplittedCellSize(x,e),y=0;y<e;y++)l.append(c("col")).setStyle("width",POLARIS.tools.cssLength(m[y]));
C=32*b;POLARIS.tools.convertToPx(n);for(y=0;y<b;y++)for(var l=g.append(c("tr")),G=0;G<e;G++){var B=l.append(c("td"));B.setStyle("width",POLARIS.tools.cssLength(m[G]));B.setStyle("height",POLARIS.tools.cssLength(32));B.setStyle("border-width",n);B.setStyle("border-color",q);B.setStyle("border-style",v);B.setStyle("padding-left",t);B.setStyle("padding-right",t);var S=new POLARIS.dom.element("p"),N=new POLARIS.dom.element("span");N.setStyles(k);N.setHtml("\x26#8203;");S.append(N);S.setStyles(h);B.append(S)}f.setStyle("table-layout",
"fixed");f.setStyle("border-spacing",w);f.setStyle("border-collapse",A);f.data("polaris-border",n);f.setStyle("border-width","0px");f.setStyle("border-color",q);f.setStyle("border-style",v);f.setAttribute("class",p);f.setStyles(r);f.setStyle("width",x+a.lang.common.unitPx);f.setStyle("height",C+a.lang.common.unitPx);f.setStyle("word-break",u);a.insertElementWithBlockSplit(f);a.fire("removeFormatCleanup",f)}}}function g(a){var b=[],c=POLARIS.tools.addFunction(function(b,c){h(parseInt(b,10)+1,parseInt(c,
10)+1);a.hide()});b.push('\x3ca style\x3d"display:block" _polaris_focus\x3d1 hidefocus\x3dtrue href\x3d"javascript:void(1)"\x3e\x3ctable role\x3d"presentation" cellspacing\x3d1 cellpadding\x3d1 style\x3d"width: 100%; margin: 0 auto 3px;table-layout:fixed;"\x3e');for(var d=0;d<l;d++){b.push("\x3ctr\x3e");for(var e=0;e<m;e++)b.push('\x3ctd style\x3d"border: '+G+";width:"+B+";height:"+B+';" data-i\x3d"'+d+'" data-j\x3d"'+e+'" onclick\x3d"POLARIS.tools.callFunction(',c,",'",d,"','",e,"'); return false;\"\x3e\x3c/td\x3e");
b.push("\x3c/tr\x3e")}b.push("\x3c/table\x3e\x3c/a\x3e");return b.join("")}function k(c,d,f,g){d=d.$.tBodies[0].rows;for(var h=0;h<d.length;h++)for(var k=d[h].cells,l=0;l<k.length;l++)k[l].style.background=h<f&&l<g?y:"";e=f-1;b=g-1;c.setText(f+" × "+g+" "+a.lang.table.toolbar)}var f=a.config,l=f.qtRows||8,m=f.qtColumns||10,n=f.qtBorder||"0.12mm",q=f.qtBorderColor||"#000000",v=f.qtBorderStyle||"solid",r=f.qtStyle||null,p=f.qtClass||"",t=f.qtCellPadding||"2mm",w=f.qtCellSpacing||"0",A=f.qtCellCollapse||
"collapse",x=f.qtWidth||parseInt(f.width,10)-parseInt(f.paddingright,10)-parseInt(f.paddingleft,10)-parseInt(f.scrollWidth,10)+"px",C=f.qtHeight,u=f.qtWordBreak||"break-all",B=f.qtPreviewSize||"14px",G=f.qtPreviewBorder||"1px solid #999ea4",y=f.qtPreviewBackground||"#f0f1f4";b=e=-1;a.ui.add("Table",POLARIS.UI_PANELBUTTON,{label:a.lang.table.toolbar,command:"table",modes:{wysiwyg:1},useCommandState:!0,editorFocus:0,toolbar:"insert,30",caption:null,table:null,panel:{css:POLARIS.skin.getPath("editor"),
attributes:{role:"listbox","aria-label":a.lang.table.toolbar}},onBlock:function(a,b){b.autoSize=!0;b.element.addClass("polaris_colorblock");var c=new POLARIS.dom.element("div");c.setStyles({"text-align":"center",margin:"3px 0"});b.element.append(c);this.caption=c;c=POLARIS.dom.element.createFromHtml(g(a));this.table=this.addEvents(c);b.element.append(c);c=this.createMoreButton();b.element.append(c);POLARIS.ui.fire("ready",this);b.keys=this.assignKeys(b.keys)},assignKeys:function(b){var c="rtl"==a.lang.dir;
b[c?37:39]="next";b[40]="next";b[9]="next";b[c?39:37]="prev";b[38]="prev";b[POLARIS.SHIFT+9]="prev";b[32]="click";b[116]="F5";return b},addEvents:function(c){var d=this.table=c.getFirst(),f=this.caption;d.on("mouseleave",function(a){k(f,d,1,1)});d.on("mousemove",function(a){var b=a.data.getTarget();"td"==b.getName()&&(a=parseInt(b.getAttribute("data-i"),10),b=parseInt(b.getAttribute("data-j"),10),k(f,d,a+1,b+1))});c.on("keydown",function(c){var g=c.data.getKeystroke(),n=e,p=b;switch(g){case 37:p--;
break;case 39:p++;break;case 40:n++;break;case 38:n--;break;case 13:case 32:h(n+1,p+1);return;default:return}0>n||0>p?this.panel.hide():((n>l-1||p>m-1)&&a.execCommand("table"),k(f,d,n+1,p+1),c.data.preventDefault(),c.data.stopPropagation())});return d},createMoreButton:function(){var b=new POLARIS.dom.element("a");b.setAttributes({_polaris_focus:1,hidefocus:!0,title:a.lang.quicktable.more,href:'javascript:void("'+a.lang.quicktable.more+'")',role:"option"});b.addClass("polaris_colormore");b.setText(a.lang.quicktable.more);
b.setStyle("text-align","center");b.on("click",function(b){a.execCommand("table");b.data.preventDefault()});return b},onOpen:function(){k(this.caption,this.table,1,1)}})}});POLARIS.plugins.add("removeformat",{init:function(a){a.addCommand("removeFormat",POLARIS.plugins.removeformat.commands.removeformat);a.ui.addButton&&a.ui.addButton("RemoveFormat",{label:a.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}});POLARIS.plugins.removeformat={commands:{removeformat:{exec:function(a){for(var e=
a._.removeFormatRegex||(a._.removeFormatRegex=new RegExp("^(?:"+a.config.removeFormatTags.replace(/,/g,"|")+")$","i")),b=a._.removeAttributes||(a._.removeAttributes=a.config.removeFormatAttributes.split(",")),c=POLARIS.plugins.removeformat.filter,d=a.getSelection().getRanges(),h=d.createIterator(),g=function(a){return a.type==POLARIS.NODE_ELEMENT},k;k=h.getNextRange();){k.collapsed||k.enlarge(POLARIS.ENLARGE_ELEMENT);var f=k.createBookmark(),l=f.startNode,m=f.endNode,n=function(b){for(var d=a.elementPath(b),
f=d.elements,g=1,h;(h=f[g])&&!h.equals(d.block)&&!h.equals(d.blockLimit);g++)e.test(h.getName())&&c(a,h)&&b.breakParent(h)};n(l);if(m)for(n(m),l=l.getNextSourceNode(!0,POLARIS.NODE_ELEMENT);l&&!l.equals(m);)if(l.isReadOnly()){if(l.getPosition(m)&POLARIS.POSITION_CONTAINS)break;l=l.getNext(g)}else n=l.getNextSourceNode(!1,POLARIS.NODE_ELEMENT),"img"==l.getName()&&l.data("polaris-realelement")||!c(a,l)||(e.test(l.getName())?l.remove(1):(l.removeAttributes(b),a.fire("removeFormatCleanup",l))),l=n;k.moveToBookmark(f)}a.forceNextSelectionCheck();
a.getSelection().selectRanges(d)}}},filter:function(a,e){for(var b=a._.removeFormatFilters||[],c=0;c<b.length;c++)if(!1===b[c](e))return!1;return!0}};POLARIS.editor.prototype.addRemoveFormatFilter=function(a){this._.removeFormatFilters||(this._.removeFormatFilters=[]);this._.removeFormatFilters.push(a)};POLARIS.config.removeFormatTags="b,big,cite,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var";POLARIS.config.removeFormatAttributes="class,lang,width,height,align,hspace,valign";
(function(){var a={readOnly:1,exec:function(a){a.fire("save")}};POLARIS.plugins.add("save",{init:function(e){e.elementMode==POLARIS.ELEMENT_MODE_REPLACE&&(e.addCommand("save",a).modes={wysiwyg:!!e.element.$.form},e.ui.addButton&&e.ui.addButton("Save",{label:e.lang.save.toolbar,command:"save",toolbar:"document,10"}))}})})();"use strict";POLARIS.plugins.add("scayt",{requires:"menubutton,dialog",tabToOpen:null,dialogName:"scaytDialog",init:function(a){if(!a.config.wordprocessor){var e=this,b=POLARIS.plugins.scayt;
this.bindEvents(a);this.parseConfig(a);this.addRule(a);POLARIS.dialog.add(this.dialogName,POLARIS.getUrl(this.path+"dialogs/options.js"));this.addMenuItems(a);var c=a.lang.scayt,d=POLARIS.env;a.ui.add("Scayt",POLARIS.UI_MENUBUTTON,{label:c.text_title,title:a.plugins.wsc?a.lang.wsc.title:c.text_title,modes:{wysiwyg:!(d.ie&&(8>d.version||d.quirks))},toolbar:"spellchecker,20",refresh:function(){var c=a.ui.instances.Scayt.getState();a.scayt&&(c=b.state[a.name]?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF);
a.fire("scaytButtonState",c)},onRender:function(){var b=this;a.on("scaytButtonState",function(a){void 0!==typeof a.data&&b.setState(a.data)})},onMenu:function(){var c=a.scayt;a.getMenuItem("scaytToggle").label=a.lang.scayt[c&&b.state[a.name]?"btn_disable":"btn_enable"];c={scaytToggle:POLARIS.TRISTATE_OFF,scaytOptions:c?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,scaytLangs:c?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,scaytDict:c?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,scaytAbout:c?POLARIS.TRISTATE_OFF:
POLARIS.TRISTATE_DISABLED,WSC:a.plugins.wsc?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED};a.config.scayt_uiTabs[0]||delete c.scaytOptions;a.config.scayt_uiTabs[1]||delete c.scaytLangs;a.config.scayt_uiTabs[2]||delete c.scaytDict;return c}});a.contextMenu&&a.addMenuItems&&(a.contextMenu.addListener(function(b,c){var d=a.scayt,f;if(d){var l=d.getSelectionNode();if(l=l?l.getAttribute(d.getNodeAttribute()):l)f=e.menuGenerator(a,l,e),d.showBanner("."+a.contextMenu._.definition.panel.className.split(" ").join(" ."))}return f}),
a.contextMenu._.onHide=POLARIS.tools.override(a.contextMenu._.onHide,function(b){return function(){var c=a.scayt;c&&c.hideBanner();return b.apply(this)}}))}},addMenuItems:function(a){var e=this,b=POLARIS.plugins.scayt;a.addMenuGroup("scaytButton");var c=a.config.scayt_contextMenuItemsOrder.split("|");if(c&&c.length)for(var d=0;d<c.length;d++)a.addMenuGroup("scayt_"+c[d],d-10);c={scaytToggle:{label:a.lang.scayt.btn_enable,group:"scaytButton",onClick:function(){var c=a.scayt;b.state[a.name]=!b.state[a.name];
!0===b.state[a.name]?c||b.createScayt(a):c&&b.destroy(a)}},scaytOptions:{label:a.lang.scayt.btn_options,group:"scaytButton",onClick:function(){a.scayt.tabToOpen="options";a.lockSelection();a.openDialog(e.dialogName)}}};a.plugins.wsc&&(c.WSC={label:a.lang.wsc.toolbar,group:"scaytButton",onClick:function(){var b=POLARIS.plugins.scayt,c=a.scayt,d=a.elementMode==POLARIS.ELEMENT_MODE_INLINE?a.container.getText():a.document.getBody().getText();(d=d.replace(/\s/g,""))?(c&&b.state[a.name]&&c.setMarkupPaused&&
c.setMarkupPaused(!0),a.lockSelection(),a.execCommand("checkspell")):alert("Nothing to check!")}});a.addMenuItems(c)},bindEvents:function(a){function e(){var b=a.scayt;b&&(b.removeMarkupInSelectionNode(),b.fire("startSpellCheck"))}var b=POLARIS.plugins.scayt,c=a.elementMode==POLARIS.ELEMENT_MODE_INLINE;POLARIS.on("dialogDefinition",function(a){if("scaytDialog"===a.data.name)a.data.definition.dialog.on("cancel",function(a){return!1},this,null,-1)});var d=function(){a.scayt&&b.destroy(a)},h=function(){b.state[a.name]&&
!a.readOnly&&b.createScayt(a)},g=function(){var b=a.editable();b.attachListener(b,"focus",function(b){b=POLARIS.plugins.scayt&&POLARIS.plugins.scayt.state[a.name]&&a.scayt;var d,e;if((c||b)&&a._.savedSelection){b=a._.savedSelection.getSelectedElement();b=!b&&a._.savedSelection.getRanges();for(var f=0;f<b.length;f++)e=b[f],d=e.startContainer.getText().length,(d<e.startOffset||d<e.endOffset)&&a.unlockSelection(!1)}},this,null,-10)},k=function(){c?(a.on("blur",d),a.on("focus",h),a.focusManager.hasFocus&&
h()):h();g()};a.on("contentDom",k);a.on("beforeCommandExec",function(c){var d;if(c.data.name in b.options.disablingCommandExec&&"wysiwyg"==a.mode){if(d=a.scayt)b.destroy(a),a.fire("scaytButtonState",POLARIS.TRISTATE_DISABLED)}else if("bold"===c.data.name||"italic"===c.data.name||"underline"===c.data.name||"strike"===c.data.name||"subscript"===c.data.name||"superscript"===c.data.name)if(d=a.scayt)d.removeMarkupInSelectionNode(),setTimeout(function(){d.fire("startSpellCheck")},0)});a.on("beforeSetMode",
function(c){if("source"==c.data){if(c=a.scayt)b.destroy(a),a.fire("scaytButtonState",POLARIS.TRISTATE_DISABLED);a.document&&(a.document.getBody().removeAttribute("_jquid"),a.document.getBody().removeAttribute("dir"))}});a.on("afterCommandExec",function(b){var c;"wysiwyg"!=a.mode||"undo"!=b.data.name&&"redo"!=b.data.name||(c=a.scayt)&&setTimeout(function(){c.fire("startSpellCheck")},250)});a.on("readOnly",function(c){var d;c&&(d=a.scayt,!0===c.editor.readOnly?d&&d.fire("removeMarkupInDocument",{}):
d?d.fire("startSpellCheck"):"wysiwyg"==c.editor.mode&&!0===b.state[c.editor.name]&&(b.createScayt(a),c.editor.fire("scaytButtonState",POLARIS.TRISTATE_ON)))});a.on("beforeDestroy",d);a.on("setData",function(){d();a.elementMode==POLARIS.ELEMENT_MODE_INLINE&&k()},this,null,50);a.on("insertElement",function(){POLARIS.env.ie?setTimeout(function(){e()},50):e()},this,null,50);a.on("insertHtml",function(){e()},this,null,50);a.on("insertText",function(){e()},this,null,50);a.on("scaytDialogShown",function(b){b.data.selectPage(a.scayt.tabToOpen)})},
parseConfig:function(a){var e=POLARIS.plugins.scayt;e.replaceOldOptionsNames(a.config);"boolean"!==typeof a.config.scayt_autoStartup&&(a.config.scayt_autoStartup=!1);e.state[a.name]=a.config.scayt_autoStartup;a.config.scayt_contextCommands||(a.config.scayt_contextCommands="ignore|ignoreall|add");a.config.scayt_contextMenuItemsOrder||(a.config.scayt_contextMenuItemsOrder="suggest|moresuggest|control");a.config.scayt_sLang||(a.config.scayt_sLang="en_US");if(void 0===a.config.scayt_maxSuggestions||"number"!=
typeof a.config.scayt_maxSuggestions||0>a.config.scayt_maxSuggestions)a.config.scayt_maxSuggestions=5;if(void 0===a.config.scayt_customDictionaryIds||"string"!==typeof a.config.scayt_customDictionaryIds)a.config.scayt_customDictionaryIds="";if(void 0===a.config.scayt_userDictionaryName||"string"!==typeof a.config.scayt_userDictionaryName)a.config.scayt_userDictionaryName=null;if("string"===typeof a.config.scayt_uiTabs&&3===a.config.scayt_uiTabs.split(",").length){var b=[],c=[];a.config.scayt_uiTabs=
a.config.scayt_uiTabs.split(",");POLARIS.tools.search(a.config.scayt_uiTabs,function(a){1===Number(a)||0===Number(a)?(c.push(!0),b.push(Number(a))):c.push(!1)});null===POLARIS.tools.search(c,!1)?a.config.scayt_uiTabs=b:a.config.scayt_uiTabs=[1,1,1]}else a.config.scayt_uiTabs=[1,0,0];"string"!=typeof a.config.scayt_serviceProtocol&&(a.config.scayt_serviceProtocol=null);"string"!=typeof a.config.scayt_serviceHost&&(a.config.scayt_serviceHost=null);"string"!=typeof a.config.scayt_servicePort&&(a.config.scayt_servicePort=
null);"string"!=typeof a.config.scayt_servicePath&&(a.config.scayt_servicePath=null);a.config.scayt_moreSuggestions||(a.config.scayt_moreSuggestions="on");"string"!==typeof a.config.scayt_customerId&&(a.config.scayt_customerId="1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2");"string"!==typeof a.config.scayt_srcUrl&&(e=document.location.protocol,e=-1!=e.search(/https?:/)?e:"http:",a.config.scayt_srcUrl=e+"//svc.webspellchecker.net/spellcheck31/lf/scayt3/ckscayt/ckscayt.js");
"boolean"!==typeof POLARIS.config.scayt_handleCheckDirty&&(POLARIS.config.scayt_handleCheckDirty=!0);"boolean"!==typeof POLARIS.config.scayt_handleUndoRedo&&(POLARIS.config.scayt_handleUndoRedo=!0);if(a.config.scayt_disableOptionsStorage){var e=POLARIS.tools.isArray(a.config.scayt_disableOptionsStorage)?a.config.scayt_disableOptionsStorage:"string"===typeof a.config.scayt_disableOptionsStorage?[a.config.scayt_disableOptionsStorage]:void 0,d="all options lang ignore-all-caps-words ignore-domain-names ignore-words-with-mixed-cases ignore-words-with-numbers".split(" "),
h=["lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],g=POLARIS.tools.search,k=POLARIS.tools.indexOf;a.config.scayt_disableOptionsStorage=function(a){for(var b=[],c=0;c<a.length;c++){var e=a[c],q=!!g(a,"options");if(!g(d,e)||q&&g(h,function(a){if("lang"===a)return!1}))return;g(h,e)&&h.splice(k(h,e),1);if("all"===e||q&&g(a,"lang"))return[];"options"===e&&(h=["lang"])}return b=b.concat(h)}(e)}},addRule:function(a){var e=a.dataProcessor,
b=e&&e.htmlFilter,c=a._.elementsPath&&a._.elementsPath.filters,e=e&&e.dataFilter,d=a.addRemoveFormatFilter,h=function(b){var c=POLARIS.plugins.scayt;if(a.scayt&&b.hasAttribute(c.options.data_attribute_name))return!1},g=function(b){var c=POLARIS.plugins.scayt,d=!0;a.scayt&&b.hasAttribute(c.options.data_attribute_name)&&(d=!1);return d};c&&c.push(h);e&&e.addRules({elements:{span:function(b){var c=POLARIS.plugins.scayt;c&&c.state[a.name]&&b.classes&&POLARIS.tools.search(b.classes,c.options.misspelled_word_class)&&
(b.classes&&b.parent.type===POLARIS.NODE_DOCUMENT_FRAGMENT?(delete b.attributes.style,delete b.name):delete b.classes[POLARIS.tools.indexOf(b.classes,c.options.misspelled_word_class)]);return b}}});b&&b.addRules({elements:{span:function(b){var c=POLARIS.plugins.scayt;c&&c.state[a.name]&&b.hasClass(c.options.misspelled_word_class)&&b.attributes[c.options.data_attribute_name]&&(b.removeClass(c.options.misspelled_word_class),delete b.attributes[c.options.data_attribute_name],delete b.name);return b}}});
d&&d.call(a,g)},scaytMenuDefinition:function(a){var e=this;a=a.scayt;return{scayt_ignore:{label:a.getLocal("btn_ignore"),group:"scayt_control",order:1,exec:function(a){a.scayt.ignoreWord()}},scayt_ignoreall:{label:a.getLocal("btn_ignoreAll"),group:"scayt_control",order:2,exec:function(a){a.scayt.ignoreAllWords()}},scayt_add:{label:a.getLocal("btn_addWord"),group:"scayt_control",order:3,exec:function(a){var c=a.scayt;setTimeout(function(){c.addWordToUserDictionary()},10)}},option:{label:a.getLocal("btn_options"),
group:"scayt_control",order:4,exec:function(a){a.scayt.tabToOpen="options";a.lockSelection();a.openDialog(e.dialogName)},verification:function(a){return 1==a.config.scayt_uiTabs[0]?!0:!1}},language:{label:a.getLocal("btn_langs"),group:"scayt_control",order:5,exec:function(a){a.scayt.tabToOpen="langs";a.lockSelection();a.openDialog(e.dialogName)},verification:function(a){return 1==a.config.scayt_uiTabs[1]?!0:!1}},dictionary:{label:a.getLocal("btn_dictionaries"),group:"scayt_control",order:6,exec:function(a){a.scayt.tabToOpen=
"dictionaries";a.lockSelection();a.openDialog(e.dialogName)},verification:function(a){return 1==a.config.scayt_uiTabs[2]?!0:!1}},about:{label:a.getLocal("btn_about"),group:"scayt_control",order:7,exec:function(a){a.scayt.tabToOpen="about";a.lockSelection();a.openDialog(e.dialogName)}}}},buildSuggestionMenuItems:function(a,e){var b={},c={},d=a.scayt;if(0<e.length&&"no_any_suggestions"!==e[0])for(var h=0;h<e.length;h++){var g="scayt_suggest_"+POLARIS.plugins.scayt.suggestions[h].replace(" ","_");a.addCommand(g,
this.createCommand(POLARIS.plugins.scayt.suggestions[h]));h<a.config.scayt_maxSuggestions?(a.addMenuItem(g,{label:e[h],command:g,group:"scayt_suggest",order:h+1}),b[g]=POLARIS.TRISTATE_OFF):(a.addMenuItem(g,{label:e[h],command:g,group:"scayt_moresuggest",order:h+1}),c[g]=POLARIS.TRISTATE_OFF,"on"===a.config.scayt_moreSuggestions&&(a.addMenuItem("scayt_moresuggest",{label:d.getLocal("btn_moreSuggestions"),group:"scayt_moresuggest",order:10,getItems:function(){return c}}),b.scayt_moresuggest=POLARIS.TRISTATE_OFF))}else b.no_scayt_suggest=
POLARIS.TRISTATE_DISABLED,a.addCommand("no_scayt_suggest",{exec:function(){}}),a.addMenuItem("no_scayt_suggest",{label:d.getLocal("btn_noSuggestions")||"no_scayt_suggest",command:"no_scayt_suggest",group:"scayt_suggest",order:0});return b},menuGenerator:function(a,e){var b=a.scayt,c=this.scaytMenuDefinition(a),d={},h=a.config.scayt_contextCommands.split("|");b.fire("getSuggestionsList",{lang:b.getLang(),word:e});d=this.buildSuggestionMenuItems(a,POLARIS.plugins.scayt.suggestions);if("off"==a.config.scayt_contextCommands)return d;
for(var g in c)if(-1!=POLARIS.tools.indexOf(h,g.replace("scayt_",""))||"all"==a.config.scayt_contextCommands)d[g]=POLARIS.TRISTATE_OFF,"function"!==typeof c[g].verification||c[g].verification(a)||delete d[g],a.addCommand(g,{exec:c[g].exec}),a.addMenuItem(g,{label:a.lang.scayt[c[g].label]||c[g].label,command:g,group:c[g].group,order:c[g].order});return d},createCommand:function(a){return{exec:function(e){e.scayt.replaceSelectionNode({word:a})}}}});POLARIS.plugins.scayt={state:{},suggestions:[],loadingHelper:{loadOrder:[]},
isLoading:!1,options:{disablingCommandExec:{source:!0,newpage:!0,templates:!0},data_attribute_name:"data-scayt-word",misspelled_word_class:"scayt-misspell-word"},backCompatibilityMap:{scayt_service_protocol:"scayt_serviceProtocol",scayt_service_host:"scayt_serviceHost",scayt_service_port:"scayt_servicePort",scayt_service_path:"scayt_servicePath",scayt_customerid:"scayt_customerId"},replaceOldOptionsNames:function(a){for(var e in a)e in this.backCompatibilityMap&&(a[this.backCompatibilityMap[e]]=a[e],
delete a[e])},createScayt:function(a){var e=this;this.loadScaytLibrary(a,function(a){var c={lang:a.config.scayt_sLang,container:"BODY"==a.editable().$.nodeName?a.document.getWindow().$.frameElement:a.editable().$,customDictionary:a.config.scayt_customDictionaryIds,userDictionaryName:a.config.scayt_userDictionaryName,localization:a.langCode,customer_id:a.config.scayt_customerId,debug:a.config.scayt_debug,data_attribute_name:e.options.data_attribute_name,misspelled_word_class:e.options.misspelled_word_class,
"options-to-restore":a.config.scayt_disableOptionsStorage,focused:a.editable().hasFocus,ignoreElementsRegex:a.config.scayt_elementsToIgnore};a.config.scayt_serviceProtocol&&(c.service_protocol=a.config.scayt_serviceProtocol);a.config.scayt_serviceHost&&(c.service_host=a.config.scayt_serviceHost);a.config.scayt_servicePort&&(c.service_port=a.config.scayt_servicePort);a.config.scayt_servicePath&&(c.service_path=a.config.scayt_servicePath);c=new SCAYT.CKSCAYT(c,function(){},function(){});c.subscribe("suggestionListSend",
function(a){for(var b={},c=[],e=0;e<a.suggestionList.length;e++)b["word_"+a.suggestionList[e]]||(b["word_"+a.suggestionList[e]]=a.suggestionList[e],c.push(a.suggestionList[e]));POLARIS.plugins.scayt.suggestions=c});a.scayt=c;a.fire("scaytButtonState",a.readOnly?POLARIS.TRISTATE_DISABLED:POLARIS.TRISTATE_ON)})},destroy:function(a){a.scayt&&a.scayt.destroy();delete a.scayt;a.fire("scaytButtonState",POLARIS.TRISTATE_OFF)},loadScaytLibrary:function(a,e){var b=this;"undefined"===typeof window.SCAYT||"function"!==
typeof window.SCAYT.CKSCAYT?(this.loadingHelper[a.name]=e,this.loadingHelper.loadOrder.push(a.name),POLARIS.scriptLoader.load(a.config.scayt_srcUrl,function(a){POLARIS.fireOnce("scaytReady");for(var d=0;d<b.loadingHelper.loadOrder.length;d++){a=b.loadingHelper.loadOrder[d];if("function"===typeof b.loadingHelper[a])b.loadingHelper[a](POLARIS.instances[a]);delete b.loadingHelper[a]}b.loadingHelper.loadOrder=[]})):window.SCAYT&&"function"===typeof window.SCAYT.CKSCAYT&&(POLARIS.fireOnce("scaytReady"),
a.scayt||"function"===typeof e&&e(a))}};POLARIS.on("scaytReady",function(){if(!0===POLARIS.config.scayt_handleCheckDirty){var a=POLARIS.editor.prototype;a.checkDirty=POLARIS.tools.override(a.checkDirty,function(a){return function(){var c=null,d=this.scayt;if(POLARIS.plugins.scayt&&POLARIS.plugins.scayt.state[this.name]&&this.scayt){if(c="ready"==this.status)var e=d.removeMarkupFromString(this.getSnapshot()),d=d.removeMarkupFromString(this._.previousValue),c=c&&d!==e}else c=a.call(this);return c}});
a.resetDirty=POLARIS.tools.override(a.resetDirty,function(a){return function(){var c=this.scayt;POLARIS.plugins.scayt&&POLARIS.plugins.scayt.state[this.name]&&this.scayt?this._.previousValue=c.removeMarkupFromString(this.getSnapshot()):a.call(this)}})}if(!0===POLARIS.config.scayt_handleUndoRedo){var a=POLARIS.plugins.undo.Image.prototype,e="function"==typeof a.equalsContent?"equalsContent":"equals";a[e]=POLARIS.tools.override(a[e],function(a){return function(c){var d=c.editor.scayt,e=this.contents,
g=c.contents,k=null;POLARIS.plugins.scayt&&POLARIS.plugins.scayt.state[c.editor.name]&&c.editor.scayt&&(this.contents=d.removeMarkupFromString(e)||"",c.contents=d.removeMarkupFromString(g)||"");k=a.apply(this,arguments);this.contents=e;c.contents=g;return k}})}});(function(){POLARIS.plugins.add("selectall",{init:function(a){a.addCommand("selectAll",{modes:{wysiwyg:1,source:1},exec:function(a){POLARIS.plugins.tabletools.clearSelectedCell();var b=a.editable();if(b.is("textarea"))a=b.$,POLARIS.env.ie?
a.createTextRange().execCommand("SelectAll"):(a.selectionStart=0,a.selectionEnd=a.value.length),a.focus();else{if(a.config.wordprocessor)a.fire("selectAll");else if(b.is("body"))a.document.$.execCommand("SelectAll",!1,null);else{var c=a.createRange();c.selectNodeContents(b);c.select()}a.forceNextSelectionCheck();a.selectionChange()}},canUndo:!1});a.ui.addButton&&a.ui.addButton("SelectAll",{label:a.lang.selectall.toolbar,command:"selectAll",toolbar:"selection,10"})}})})();(function(){function a(a,
c,d){var h=POLARIS.document.getById(d),g;h&&(d=a.fire("uiSpace",{space:c,html:""}).html)&&(a.on("uiSpace",function(a){a.data.space==c&&a.cancel()},null,null,1),g=h.append(POLARIS.dom.element.createFromHtml(e.output({id:a.id,name:a.name,langDir:a.lang.dir,langCode:a.langCode,space:c,spaceId:a.ui.spaceId(c),content:d}))),h.getCustomData("polaris_hasshared")?g.hide():h.setCustomData("polaris_hasshared",1),g.unselectable(),g.on("mousedown",function(a){a=a.data;a.getTarget().hasAscendant("a",1)||a.preventDefault()}),
a.focusManager.add(g,1),a.on("focus",function(){for(var a=0,b,c=h.getChildren();b=c.getItem(a);a++)b.type==POLARIS.NODE_ELEMENT&&!b.equals(g)&&b.hasClass("polaris_shared")&&b.hide();g.show()}),a.on("destroy",function(){g.remove()}))}var e=POLARIS.addTemplate("sharedcontainer",'\x3cdiv id\x3d"polaris_{name}" class\x3d"polaris {id} polaris_reset_all polaris_chrome polaris_editor_{name} polaris_shared polaris_detached polaris_{langDir} '+POLARIS.env.cssClass+'" dir\x3d"{langDir}" title\x3d"'+(POLARIS.env.gecko?
" ":"")+'" lang\x3d"{langCode}" role\x3d"presentation"\x3e\x3cdiv class\x3d"polaris_inner"\x3e\x3cdiv id\x3d"{spaceId}" class\x3d"polaris_{space}" role\x3d"presentation"\x3e{content}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');POLARIS.plugins.add("sharedspace",{init:function(b){b.on("loaded",function(){var c=b.config.sharedSpaces;if(c)for(var d in c)a(b,d,c[d])},null,null,9)}})})();(function(){var a={readOnly:1,preserveState:!0,editorFocus:!1,exec:function(a){this.toggleState();this.refresh(a);a.focus()},
refresh:function(a){if(a.document){var b=this.state!=POLARIS.TRISTATE_ON||a.elementMode==POLARIS.ELEMENT_MODE_INLINE&&!a.focusManager.hasFocus?"removeClass":"attachClass";a.editable()[b]("polaris_show_blocks")}}};POLARIS.plugins.add("showblocks",{onLoad:function(){var a="p div pre address blockquote h1 h2 h3 h4 h5 h6".split(" "),b,c,d,h,g=POLARIS.getUrl(this.path),k=!(POLARIS.env.ie&&9>POLARIS.env.version),f=k?":not([contenteditable\x3dfalse]):not(.polaris_show_blocks_off)":"",l,m;for(b=c=d=h="";l=
a.pop();)m=a.length?",":"",b+=".polaris_show_blocks "+l+f+m,d+=".polaris_show_blocks.polaris_contents_ltr "+l+f+m,h+=".polaris_show_blocks.polaris_contents_rtl "+l+f+m,c+=".polaris_show_blocks "+l+f+"{background-image:url("+POLARIS.getUrl(g+"images/block_"+l+".png")+")}";POLARIS.addCss((b+"{background-repeat:no-repeat;border:1px dotted gray;padding-top:8px}").concat(c,d+"{background-position:top left;padding-left:8px}",h+"{background-position:top right;padding-right:8px}"));k||POLARIS.addCss(".polaris_show_blocks [contenteditable\x3dfalse],.polaris_show_blocks .polaris_show_blocks_off{border:none;padding-top:0;background-image:none}.polaris_show_blocks.polaris_contents_rtl [contenteditable\x3dfalse],.polaris_show_blocks.polaris_contents_rtl .polaris_show_blocks_off{padding-right:0}.polaris_show_blocks.polaris_contents_ltr [contenteditable\x3dfalse],.polaris_show_blocks.polaris_contents_ltr .polaris_show_blocks_off{padding-left:0}")},
init:function(e){function b(){c.refresh(e)}if(!e.config.wordprocessor&&!e.blockless){var c=e.addCommand("showblocks",a);c.canUndo=!1;e.config.startupOutlineBlocks&&c.setState(POLARIS.TRISTATE_ON);e.ui.addButton&&e.ui.addButton("ShowBlocks",{label:e.lang.showblocks.toolbar,command:"showblocks",toolbar:"tools,20"});e.on("mode",function(){c.state!=POLARIS.TRISTATE_DISABLED&&c.refresh(e)});e.elementMode==POLARIS.ELEMENT_MODE_INLINE&&(e.on("focus",b),e.on("blur",b));e.on("contentDom",function(){c.state!=
POLARIS.TRISTATE_DISABLED&&c.refresh(e)})}}})})();(function(){var a={preserveState:!0,editorFocus:!1,readOnly:1,exec:function(a){this.toggleState();this.refresh(a)},refresh:function(a){if(a.document){var b=this.state==POLARIS.TRISTATE_ON?"attachClass":"removeClass";a.editable()[b]("polaris_show_borders")}}};POLARIS.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){},init:function(e){var b=e.addCommand("showborders",a);b.canUndo=!1;e.ui.addButton&&e.ui.addButton("ShowBorders",{label:e.lang.showborders.label,
command:"showborders",toolbar:"showborders,1"});!1!==e.config.startupShowBorders&&b.setState(POLARIS.TRISTATE_ON);e.on("mode",function(){b.state!=POLARIS.TRISTATE_DISABLED&&b.refresh(e)},null,null,100);e.on("contentDom",function(){b.state!=POLARIS.TRISTATE_DISABLED&&b.refresh(e)});e.on("removeFormatCleanup",function(a){a=a.data;e.getCommand("showborders").state==POLARIS.TRISTATE_ON&&a.is("table")&&(!a.hasAttribute("border")||0>=parseInt(a.getAttribute("border"),10))&&a.addClass("polaris_show_border")})},
afterInit:function(a){var b=a.dataProcessor;a=b&&b.dataFilter;b=b&&b.htmlFilter;a&&a.addRules({elements:{table:function(a){a=a.attributes;var b=a["class"],e=parseInt(a.border,10);e&&!(0>=e)||b&&-1!=b.indexOf("polaris_show_border")||(a["class"]=(b||"")+" polaris_show_border")}}});b&&b.addRules({elements:{table:function(a){a=a.attributes;var b=a["class"];b&&(a["class"]=b.replace("polaris_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}});POLARIS.on("dialogDefinition",function(a){var b=
a.data.name;if("table"==b||"cellProperties"==b){a=a.data.definition;var c=a.getContents("cellProperties"==b?"background":"info"),d=c.get("selBorderStyle"),c=c.get("selBorderWidth"),h=d.commit,g=c.commit;"table"==b?(d.commit=POLARIS.tools.override(h,function(a){return function(b,c){a.apply(this,arguments);var d=parseInt(this.getValue(),10);c[d&&"none"!=d?"removeClass":"addClass"]("polaris_show_border")}}),c.commit=POLARIS.tools.override(g,function(a){return function(b,c){a.apply(this,arguments);var d=
parseInt(this.getValue(),10);c[!d||0>=d?"addClass":"removeClass"]("polaris_show_border")}})):(d.commit=POLARIS.tools.override(h,function(a){return function(b){a.apply(this,arguments);var c=parseInt(this.getValue(),10);b.getAscendant("table",1)[c&&"none"!=c?"removeClass":"addClass"]("polaris_show_border")}}),c.commit=POLARIS.tools.override(g,function(a){return function(b){a.apply(this,arguments);var c=parseInt(this.getValue(),10);b.getAscendant("table",1)[!c||0>=c?"addClass":"removeClass"]("polaris_show_border")}}));
if(b=(b=a.getContents("advanced"))&&b.get("advCSSClasses"))b.setup=POLARIS.tools.override(b.setup,function(a){return function(){a.apply(this,arguments);this.setValue(this.getValue().replace(/polaris_show_border/,""))}}),b.commit=POLARIS.tools.override(b.commit,function(a){return function(b,c){a.apply(this,arguments);parseInt(c.getAttribute("border"),10)||c.addClass("polaris_show_border")}})}})})();POLARIS.plugins.add("smiley",{requires:"dialog",init:function(a){a.config.wordprocessor||(a.config.smiley_path=
a.config.smiley_path||this.path+"images/",a.addCommand("smiley",new POLARIS.dialogCommand("smiley",{allowedContent:"img[alt,height,!src,title,width]",requiredContent:"img"})),a.ui.addButton&&a.ui.addButton("Smiley",{label:a.lang.smiley.toolbar,command:"smiley",toolbar:"insert,50"}),POLARIS.dialog.add("smiley",this.path+"dialogs/smiley.js"))}});POLARIS.config.smiley_images="regular_smile.png sad_smile.png wink_smile.png teeth_smile.png confused_smile.png tongue_smile.png embarrassed_smile.png omg_smile.png whatchutalkingabout_smile.png angry_smile.png angel_smile.png shades_smile.png devil_smile.png cry_smile.png lightbulb.png thumbs_down.png thumbs_up.png heart.png broken_heart.png kiss.png envelope.png".split(" ");
POLARIS.config.smiley_descriptions="smiley;sad;wink;laugh;frown;cheeky;blush;surprise;indecision;angry;angel;cool;devil;crying;enlightened;no;yes;heart;broken heart;kiss;mail".split(";");(function(){POLARIS.plugins.add("sourcearea",{init:function(e){function b(){var a=d&&this.equals(POLARIS.document.getActive());this.hide();this.setStyle("height",this.getParent().$.clientHeight+"px");this.setStyle("width",this.getParent().$.clientWidth+"px");this.show();a&&this.focus()}if(!e.config.wordprocessor&&
e.elementMode!=POLARIS.ELEMENT_MODE_INLINE){var c=POLARIS.plugins.sourcearea;e.addMode("source",function(c){var d=e.ui.space("contents").getDocument().createElement("textarea");d.setStyles(POLARIS.tools.extend({width:POLARIS.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left","margin-left":"auto","margin-right":"auto"},POLARIS.tools.cssVendorPrefix("tab-size",e.config.sourceAreaTabSize||4)));d.setAttribute("dir","ltr");d.addClass("polaris_source polaris_reset polaris_enable_context_menu");
e.ui.space("contents").append(d);d=e.editable(new a(e,d));d.setData(e.getData(1));POLARIS.env.ie&&(d.attachListener(e,"resize",b,d),d.attachListener(POLARIS.document.getWindow(),"resize",b,d),POLARIS.tools.setTimeout(b,0,d));e.fire("ariaWidget",this);c();e.focus()});e.addCommand("source",c.commands.source);e.ui.addButton&&e.ui.addButton("Source",{label:e.lang.sourcearea.toolbar,command:"source",toolbar:"mode,10"});e.on("mode",function(){e.getCommand("source").setState("source"==e.mode?POLARIS.TRISTATE_ON:
POLARIS.TRISTATE_OFF)});var d=POLARIS.env.ie&&9==POLARIS.env.version}}});var a=POLARIS.tools.createClass({base:POLARIS.editable,proto:{setData:function(a){this.setValue(a);this.status="ready";this.editor.fire("dataReady")},getData:function(){return this.getValue()},insertHtml:function(){},insertElement:function(){},insertText:function(){},setReadOnly:function(a){this[(a?"set":"remove")+"Attribute"]("readOnly","readonly")},detach:function(){a.baseProto.detach.call(this);this.clearCustomData();this.remove()}}})})();
POLARIS.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:!1,readOnly:1,exec:function(a){"wysiwyg"==a.mode&&a.fire("saveSnapshot");a.getCommand("source").setState(POLARIS.TRISTATE_DISABLED);a.setMode("source"==a.mode?"wysiwyg":"source")},canUndo:!1}}};POLARIS.plugins.add("specialchar",{availableLangs:{en:1,ko:1},requires:"dialog",init:function(a){var e=this;POLARIS.dialog.add("specialchar",this.path+"dialogs/specialchar.js");a.addCommand("specialchar",{exec:function(){var b=
a.langCode,b=e.availableLangs[b]?b:e.availableLangs[b.replace(/-.*/,"")]?b.replace(/-.*/,""):"en";if(POLARIS.env.ie){var c=a.getSelection(),d=c&&c.getRanges()[0];d&&d.collapsed&&(d=c.createBookmarks(),c.selectBookmarks(d))}POLARIS.scriptLoader.load(POLARIS.getUrl(e.path+"dialogs/lang/"+b+".js"),function(){POLARIS.tools.extend(a.lang.specialchar,e.langEntries[b]);a.openDialog("specialchar")})},modes:{wysiwyg:1},canUndo:!1});a.ui.addButton&&a.ui.addButton("SpecialChar",{label:a.lang.specialchar.toolbar,
command:"specialchar",toolbar:"insert,50"});a.setKeystroke([[POLARIS.CTRL+121,"specialchar"]]);a.addMenuItems({special_char:{label:a.lang.specialchar.toolbar,group:"specialchar",command:"specialchar"}});a.contextMenu&&a.contextMenu.addListener(function(a,c,d){if(a&&c&&d&&!c.getRanges()[0].checkReadOnly()){if(!a.isEditable())return null;if(!d||!d.contains({td:1,th:1},1))return{special_char:POLARIS.TRISTATE_OFF}}})}});POLARIS.config.symbolChars="□○‒※◁▷△▽◇♤♡☆♧☜☞☏■●◎▣◀▶▲▼◆♠♥★♣◐◑☎→←↑↓↔↕↗↙↖↘◉◦▪▫◈▒▤▥▨▧▦▩　、。·‥…¨〃―∥＼∼‘’“”〔〕〈〉《》「」『』【】±×÷≠≤≥∞∴°′″℃Å￠￡￥♂♀∠⊥⌒∂∇≡≒§〓≪≫√∽∝∵∫∬∈∋⊆⊇⊂⊃∪∩∧∨￢⇒⇔∀∃´˜ˇ˘˝˚˙¸˛¡¿ː∮∑∏¤℉‰♨¶†‡♭♩♪♬㉿㈜№㏇™㏂㏘℡€®".split("");
POLARIS.config.mathChars="+±÷×\x3c\x3e\x3d|{}()[]〚〛⟦⟧⟨⟩⟪⟫╶╷╺╻₩     ⦀⦁⦂⦃⦄⦅⦆⦇⦈⦉⦊⦋⦌⦍⦎⦏⦐⦑⦒⦓⦔⦕⦖⦗⦘⦙⦚     ∀∁∂∃∄∅∆∇∈∉∊∋∌∍  ∎∏∐∑−∓∔∕∖∗∘∙√∛∜∝∞∟∠∡∢∣∤∥∦∧∨∩∪∫∬∭∮∯∰∱∲∳          ∴∵∶∷∸∹∺∻∼∽∾∿≀≁≂≃≄≅≆≇≈≉≊≋≌≍≎≏≐≑≒≓≔≕≖≗≘≙≚≛≜≝≞≟≠≡≢≣≤≥≦≧≨≩≪≫≬≭≮≯≰≱≲≳≴≵≶≷≸≹≺≻≼≽≾≿⊀⊁  ⊂⊃⊄⊅⊆⊇⊈⊉⊊⊋⊌⊍⊎⊏⊐⊑⊒⊓⊔⊕⊖⊗⊘⊙⊚⊛⊜⊝    ⊞⊟⊠⊡⊢⊣⊤⊥⊦⊧⊨⊩⊪⊫⊬⊭⊮⊯⊰⊱⊲⊳⊴⊵⊶⊷⊸⊹    ⊺⊻⊼⊽⊾⊿⋀⋁⋂⋃⋄⋅⋆⋇⋈⋉⋊⋋⋌⋍⋎⋏⋐⋑⋒⋓⋔⋕    ⋖⋗⋘⋙⋚⋛⋜⋝⋞⋟⋠⋡⋢⋣⋤⋥⋦⋧⋨⋩⋪⋫⋬⋭⋮⋯⋰⋱    ⋲⋳⋴⋵⋶⋷⋸⋹⋺⋻⋼⋽⋾⋿  ⟐⟑⟒⟓⟔⟕⟖⟗⟘⟙⟚⟛⟜⟝⟞⟟⟠⟡⟢⟣⟤⟥          ⦛⦜⦝⦞⦟⦠⦡⦢⦣⦤⦥⦦⦧⦨⦩⦪⦫⦬⦭⦮⦯           ⦰⦱⦲⦳⦴⦵⦶⦷⦸⦹⦺⦻⦼⦽⦾⦿⧀⧁⧂⧃            ⧄⧅⧆⧇⧈⧉⧊⧋⧌⧍⧎⧏⧐⧑⧒⧓⧔⧕⧖⧗⧘⧙⧚⧛        ⧜⧝⧞⧟⧠⧡⧢⧣⧤⧥⧦⧧    ⧨⧩⧪⧫⧬⧭⧮⧯⧰⧱⧲⧳    ⧴⧵⧶⧷⧸⧹⧺⧻⧼⧽⧾     ‐‑‒–—―‖‗†‡•‣․‥…‰‱′″‴‵‶‷‸‹›※‼‽‾‿⁀⁁⁂⁃⁄⁅⁆✡〫△▽○⍳+±÷".split("");
POLARIS.config.latinChars="ⅰⅱⅲⅳⅴⅵⅶⅷⅸⅹ      ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩ      ΑΒΓΔΕΖΗΘΙΚΛΜΝΞOΠΡΣΤΥΦΧΨΩαβγδεζηθικλμνξοπρστυφχψω".split("");POLARIS.config.hangulChars1="①;②;③;④;⑤;⑥;⑦;⑧;⑨;⑩; ; ; ; ; ; ;❶;❷;❸;❹;❺;❻;❼;❽;❾;❿; ; ; ; ; ; ;➀;➁;➂;➃;➄;➅;➆;➇;➈;➉; ; ; ; ; ; ;⓵;⓶;⓷;⓸;⓹;⓺;⓻;⓼;⓽;⓾; ; ; ; ; ; ;➊;➋;➌;➍;➎;➏;➐;➑;➒;➓; ; ; ; ; ; ;㊀;㊁;㊂;㊃;㊄;㊅;㊆;㊇;㊈;㊉; ; ; ; ; ; ;⓫;⓬;⓭;⓮;⓯; ; ; ; ; ; ; ; ; ; ; ;⑪;⑫;⑬;⑭;⑮; ; ; ; ; ; ; ; ; ; ; ;㉠;㉡;㉢;㉣;㉤;㉥;㉦;㉧;㉨;㉩;㉪;㉫;㉬;㉭; ; ;㉮;㉯;㉰;㉱;㉲;㉳;㉴;㉵;㉶;㉷;㉸;㉹;㉺;㉻; ; ;Ⓐ;Ⓑ;Ⓒ;Ⓓ;Ⓔ;Ⓕ;Ⓖ;Ⓗ;Ⓘ;Ⓙ;Ⓚ;Ⓛ;Ⓜ; ; ; ;Ⓝ;Ⓞ;Ⓟ;Ⓠ;Ⓡ;Ⓢ;Ⓣ;Ⓤ;Ⓥ;Ⓦ;Ⓧ;Ⓨ;Ⓩ; ; ; ;ⓐ;ⓑ;ⓒ;ⓓ;ⓔ;ⓕ;ⓖ;ⓗ;ⓘ;ⓙ;ⓚ;ⓛ;ⓜ; ; ; ;ⓝ;ⓞ;ⓟ;ⓠ;ⓡ;ⓢ;ⓣ;ⓤ;ⓥ;ⓦ;ⓧ;ⓨ;ⓩ; ; ; ;㊊;㊋;㊌;㊍;㊎;㊏;㊐; ; ; ; ; ; ; ; ; ;㊑;㊒;㊓;㊔,;㊕;㊖;㊗;㊘;㊙;㊚;㊛;㊜;㊝;㊞;㊟;㊠;㊡;㊢;㊣;㊤;㊥;㊦;㊧;㊨;㊩;㊪;㊫;㊬;㊭;㊮;㊯;㊰".split(";");
POLARIS.config.hangulChars2="⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂ ㈠㈡㈢㈣㈤㈥㈦㈧㈨㈩      ㈀㈁㈂㈃㈄㈅㈆㈇㈈㈉㈊㈋㈌㈍  ㈎㈏㈐㈑㈒㈓㈔㈕㈖㈗㈘㈙㈚㈛  ⒜⒝⒞⒟⒠⒡⒢⒣⒤⒥⒦⒧⒨   ⒩⒪⒫⒬⒭⒮⒯⒰⒱⒲⒳⒴⒵   ㈜               ㈪㈫㈬㈭㈮㈯㈰         ㈱㈲㈳㈴㈵㈶㈷㈸㈹㈺㈻㈼㈽㈾㈿㉀㉁㉂㉃".split("");POLARIS.config.unitChars="㎜㎝㎞㎟㎠㎡㎢㎣㎤㎥㎦㎙㎚㎛  ㎧㎨㎩㎪㎫㎬㏂㏘㎀㎁㎂㎃㎄㎅㎆㎇㎈㎉㎊㎋㎌㎍㎎㎏㎐㎑㎒㎓㎔   ㎭㎮㎯㎰㎱㎲㎳㎕㎖㎗ℓ㎘    ㎴㎵㎶㎷㎸㎹㎺㎻㎼㎽㎾㎿    Ω㏀㏁㏃㏄㏅㏆㏇㏈㏉㏊㏋㏌㏍㏎㏏㏐㏑㏒㏓㏔㏕㏖㏗㏙㏚㏛㏜㏝   ㍱㍲㍳㍴㍵㍶℉Kµ".split("");(function(){POLARIS.plugins.add("stylescombo",{requires:"richcombo",init:function(a){var e=a.config,b=a.lang.stylescombo,c={},d=[],h=[];a.on("stylesSet",function(b){if(b=
b.data.styles){for(var k,f,l,m=0,n=b.length;m<n;m++)(k=b[m],a.blockless&&k.element in POLARIS.dtd.$block||(f=k.name,k=new POLARIS.style(k),a.filter.customConfig&&!a.filter.check(k)))||(k._name=f,k._.enterMode=e.enterMode,k._.type=l=k.assignedTo||k.type,k._.weight=m+1E3*(l==POLARIS.STYLE_OBJECT?1:l==POLARIS.STYLE_BLOCK?2:3),c[f]=k,d.push(k),h.push(k));d.sort(function(a,b){return a._.weight-b._.weight})}});a.ui.addRichCombo("Styles",{label:b.label,title:b.panelTitle,toolbar:"styles,10",allowedContent:h,
panel:{css:[POLARIS.skin.getPath("editor")].concat(e.contentsCss),multiSelect:!0,attributes:{"aria-label":b.panelTitle}},init:function(){var a,c,e,h,m,n;m=0;for(n=d.length;m<n;m++)a=d[m],c=a._name,h=a._.type,h!=e&&(this.startGroup(b["panelTitle"+String(h)]),e=h),this.add(c,a.type==POLARIS.STYLE_OBJECT?c:a.buildPreview(),c);this.commit()},onClick:function(b){a.focus();a.fire("saveSnapshot");b=c[b];var d=a.elementPath();a[b.checkActive(d,a)?"removeStyle":"applyStyle"](b);a.fire("saveSnapshot")},onRender:function(){a.on("selectionChange",
function(b){var d=this.getValue();b=b.data.path.elements;for(var e=0,h=b.length,m;e<h;e++){m=b[e];for(var n in c)if(c[n].checkElementRemovable(m,!0,a)){n!=d&&this.setValue(n);return}}this.setValue("")},this)},onOpen:function(){var d=a.getSelection().getSelectedElement(),d=a.elementPath(d),e=[0,0,0,0];this.showAll();this.unmarkAll();for(var f in c){var h=c[f],m=h._.type;h.checkApplicable(d,a,a.activeFilter)?e[m]++:this.hideItem(f);h.checkActive(d,a)&&this.mark(f)}e[POLARIS.STYLE_BLOCK]||this.hideGroup(b["panelTitle"+
String(POLARIS.STYLE_BLOCK)]);e[POLARIS.STYLE_INLINE]||this.hideGroup(b["panelTitle"+String(POLARIS.STYLE_INLINE)]);e[POLARIS.STYLE_OBJECT]||this.hideGroup(b["panelTitle"+String(POLARIS.STYLE_OBJECT)])},refresh:function(){var b=a.elementPath();if(b){for(var d in c)if(c[d].checkApplicable(b,a,a.activeFilter))return;this.setState(POLARIS.TRISTATE_DISABLED)}},reset:function(){c={};d=[]}})}})})();POLARIS.plugins.add("symbol",{availableLangs:{en:1},lang:"en",requires:"dialog",icons:"symbol",init:function(a){if(!a.config.wordprocessor){var e=
this;POLARIS.dialog.add("symbol",this.path+"dialogs/symbol.js");a.addCommand("symbol",{exec:function(){if(a.config.removeSymbolRanges&&0<a.config.removeSymbolRanges.length)for(var b=a.config.removeSymbolRanges.length-1;0<=b;b--){var c=a.config.removeSymbolRanges[b];c<a.config.symbolRanges.length&&a.config.symbolRanges.splice(c,1)}var d=a.langCode,d=e.availableLangs[d]?d:e.availableLangs[d.replace(/-.*/,"")]?d.replace(/-.*/,""):"en";POLARIS.scriptLoader.load(POLARIS.getUrl(e.path+"dialogs/lang/"+d+
".js"),function(){POLARIS.tools.extend(a.lang.symbol,e.langEntries[d]);a.openDialog("symbol")})},modes:{wysiwyg:1},canUndo:!1});a.ui.addButton&&a.ui.addButton("Symbol",{label:"Insert symbol",command:"symbol",toolbar:"insert"})}}});POLARIS.config.symbolRanges=[["Basic Latin","0020-007E"],["Latin-1 Supplement","00A0-00B0,00B1,00B2-00FF"],["Latin Extended-A","0100-017F"],["Latin Extended-B","0180-024F"],["IPA Extensions","0250-02AF"],["Spacing Modifier Letters","02B0-02FF"],["Combining Diacritical Marks",
"0300-036F*"],["Greek and Coptic","0370-03FF"],["Cyrillic","0400-04FF"],["Cyrillic Supplementary","0500-052F"],["Armenian","0530-058F"],["Hebrew","0590-05FF"],["Arabic","0600-06FF"],["Syriac","0700-074F"],["Thaana","0780-07BF"],["Devanagari","0900-097F"],["Bengali","0980-09FF"],["Gurmukhi","0A00-0A7F"],["Gujarati","0A80-0AFF"],["Oriya","0B00-0B7F"],["Tamil","0B80-0BFF"],["Telugu","0C00-0C7F"],["Kannada","0C80-0CFF"],["Malayalam","0D00-0D7F"],["Sinhala","0D80-0DFF"],["Thai","0E00-0E7F"],["Lao","0E80-0EFF"],
["Tibetan","0F00-0FFF"],["Myanmar","1000-109F"],["Georgian","10A0-10FF"],["Hangul Jamo","1100-11FF"],["Ethiopic","1200-137F"],["Cherokee","13A0-13FF"],["Unified Canadian Aboriginal Syllabics","1400-167F"],["Ogham","1680-169F"],["Runic","16A0-16FF"],["Tagalog","1700-171F"],["Hanunoo","1720-173F"],["Buhid","1740-175F"],["Tagbanwa","1760-177F"],["Khmer","1780-17FF"],["Mongolian","1800-18AF"],["Limbu","1900-194F"],["Tai Le","1950-197F"],["Khmer Symbols","19E0-19FF"],["Phonetic Extensions","1D00-1D7F"],
["Latin Extended Additional","1E00-1EFF"],["Greek Extended","1F00-1FFF"],["General Punctuation","2000-206F"],["Superscripts and Subscripts","2070-209F"],["Currency Symbols","20A0-20CF"],["Combining Diacritical Marks for Symbols","20D0-20FF"],["Letterlike Symbols","2100-214F"],["Number Forms","2150-218F"],["Arrows","2190-21FF"],["Mathematical Operators","2200-22FF"],["Miscellaneous Technical","2300-23FF"],["Control Pictures","2400-243F"],["Optical Character Recognition","2440-245F"],["Enclosed Alphanumerics",
"2460-24FF"],["Box Drawing","2500-257F"],["Block Elements","2580-259F"],["Geometric Shapes","25A0-25FF"],["Miscellaneous Symbols","2600-26FF"],["Dingbats","2700-27BF"],["Miscellaneous Mathematical Symbols-A","27C0-27EF"],["Supplemental Arrows-A","27F0-27FF"],["Braille Patterns","2800-28FF"],["Supplemental Arrows-B","2900-297F"],["Miscellaneous Mathematical Symbols-B","2980-29FF"],["Supplemental Mathematical Operators","2A00-2AFF"],["Miscellaneous Symbols and Arrows","2B00-2BFF"],["CJK Radicals Supplement",
"2E80-2EFF"],["Kangxi Radicals","2F00-2FDF"],["Ideographic Description Characters","2FF0-2FFF"],["CJK Symbols and Punctuation","3000-303F"],["Hiragana","3040-309F"],["Katakana","30A0-30FF"],["Bopomofo","3100-312F"],["Hangul Compatibility Jamo","3130-318F"],["Kanbun","3190-319F"],["Bopomofo Extended","31A0-31BF"],["Katakana Phonetic Extensions","31F0-31FF"],["Enclosed CJK Letters and Months","3200-32FF"],["CJK Compatibility","3300-33FF"],["CJK Unified Ideographs Extension A","3400-4DBF"],["Yijing Hexagram Symbols",
"4DC0-4DFF"],["CJK Unified Ideographs","4E00-9FFF"],["Yi Syllables","A000-A48F"],["Yi Radicals","A490-A4CF"],["Hangul Syllables","AC00-D7AF"],["High Surrogates","D800-DB7F"],["High Private Use Surrogates","DB80-DBFF"],["Low Surrogates","DC00-DFFF"],["Private Use Area","E000-F8FF"],["CJK Compatibility Ideographs","F900-FAFF"],["Alphabetic Presentation Forms","FB00-FB4F"],["Arabic Presentation Forms-A","FB50-FDFF"],["Variation Selectors","FE00-FE0F"],["Combining Half Marks","FE20-FE2F"],["CJK Compatibility Forms",
"FE30-FE4F"],["Small Form Variants","FE50-FE6F"],["Arabic Presentation Forms-B","FE70-FEFF"],["Halfwidth and Fullwidth Forms","FF00-FFEF"],["Specials","FFF0-FFFF"]];(function(){function a(a){return{editorFocus:!1,canUndo:!1,modes:{wysiwyg:1},exec:function(b){if(b.editable().hasFocus||POLARIS.env.chrome){var c=b.getSelection(),e;if(e=(new POLARIS.dom.elementPath(c.getCommonAncestor(),c.root)).contains({td:1,th:1},1)){var c=b.createRange(),f=POLARIS.tools.tryThese(function(){var b=e.getParent().$.cells[e.$.cellIndex+
(a?-1:1)];b.parentNode.parentNode;return b},function(){var b=e.getParent(),b=b.getAscendant("table").$.rows[b.$.rowIndex+(a?-1:1)];return b.cells[a?b.cells.length-1:0]});if(f||a)if(f)f=new POLARIS.dom.element(f),c.moveToElementEditStart(f),c.checkStartOfBlock()&&c.checkEndOfBlock()||c.selectNodeContents(f);else return!0;else{for(var l=e.getAscendant("table").$,f=e.getParent().$.cells,l=new POLARIS.dom.element(l.insertRow(-1),b.document),m=0,n=f.length;m<n;m++)l.append((new POLARIS.dom.element(f[m],
b.document)).clone(!1,!1)).appendBogus();c.moveToElementEditStart(l)}c.select(!0);return!0}}return!1}}}var e={editorFocus:!1,modes:{wysiwyg:1,source:1}},b={exec:function(a){a.container.focusNext(!0,a.tabIndex)}},c={exec:function(a){a.container.focusPrevious(!0,a.tabIndex)}};POLARIS.plugins.add("tab",{init:function(d){for(var h=!1!==d.config.enableTabKeyTools,g=d.config.tabSpaces||0,k="";g--;)k+=" ";d.on("key",function(a){var b=a.editor;if(h){var c=b&&b.document.getSelection(),c=c&&c.getStartElement(),
d=a.data.keyCode,e=!1;if(9===d){d=!1;if(e=c&&c.getAscendant("table",!0)){var e=POLARIS.tools.buildTableMap(e),g=e.length-1,r=e[g].length-1;(c=c.getAscendant("td",!0))&&c.$==e[g][r]&&(d=!0)}d&&(b.execCommand("rowInsertAfter"),b.fire("change"),b.fire("contentChange",{type:"tableresize"}));e=b.execCommand("selectNextCell")}else d===POLARIS.SHIFT+9&&(e=b.execCommand("selectPreviousCell"));if(e){a.data.domEvent.preventDefault();a.cancel();return}}k&&9===a.data.keyCode&&(b.insertText(k),a.cancel())});d.addCommand("blur",
POLARIS.tools.extend(b,e));d.addCommand("blurBack",POLARIS.tools.extend(c,e));d.addCommand("selectNextCell",a());d.addCommand("selectPreviousCell",a(!0))}})})();POLARIS.dom.element.prototype.focusNext=function(a,e){var b=void 0===e?this.getTabIndex():e,c,d,h,g,k,f;if(0>=b)for(k=this.getNextSourceNode(a,POLARIS.NODE_ELEMENT);k;){if(k.isVisible()&&0===k.getTabIndex()){h=k;break}k=k.getNextSourceNode(!1,POLARIS.NODE_ELEMENT)}else for(k=this.getDocument().getBody().getFirst();k=k.getNextSourceNode(!1,
POLARIS.NODE_ELEMENT);){if(!c)if(!d&&k.equals(this)){if(d=!0,a){if(!(k=k.getNextSourceNode(!0,POLARIS.NODE_ELEMENT)))break;c=1}}else d&&!this.contains(k)&&(c=1);if(k.isVisible()&&!(0>(f=k.getTabIndex()))){if(c&&f==b){h=k;break}f>b&&(!h||!g||f<g)?(h=k,g=f):h||0!==f||(h=k,g=f)}}h&&h.focus()};POLARIS.dom.element.prototype.focusPrevious=function(a,e){for(var b=void 0===e?this.getTabIndex():e,c,d,h,g=0,k,f=this.getDocument().getBody().getLast();f=f.getPreviousSourceNode(!1,POLARIS.NODE_ELEMENT);){if(!c)if(!d&&
f.equals(this)){if(d=!0,a){if(!(f=f.getPreviousSourceNode(!0,POLARIS.NODE_ELEMENT)))break;c=1}}else d&&!this.contains(f)&&(c=1);if(f.isVisible()&&!(0>(k=f.getTabIndex())))if(0>=b){if(c&&0===k){h=f;break}k>g&&(h=f,g=k)}else{if(c&&k==b){h=f;break}k<b&&(!h||k>g)&&(h=f,g=k)}}h&&h.focus()};(function(){function a(a){var b=a.getStyle("width"),c=0;return c="px"!=b.replace(/[0-9|.]/g,"")?POLARIS.env.ie?a.$.clientWidth:parseInt(a.getComputedStyle("width"),10):parseInt(b.replace(/[^0-9|.]/g,""))}function e(a){var b=
a.getStyle("height"),c=0;return c="px"!=b.replace(/[0-9|.]/g,"")?POLARIS.env.ie?a.$.clientHeight:parseInt(a.getComputedStyle("height"),10):parseInt(b.replace(/[^0-9|.]/g,""))}function b(a){var b=0;a=a.find("tr");for(var c=0;c<a.count();c++){var d=a.getItem(c);if(!(1>d.getChildCount())){for(var e=0,d=d.find("td"),f=0;f<d.count();f++){var g;g=d.getItem(f);g=g.getStyle("height")?g.getStyle("height"):g.getAttribute("height");g=parseInt(POLARIS.tools.convertToUnit(g,"px"));e=0==f?g:Math.min(e,g)}trHeight=
e;b+=trHeight}}return b}function c(a){var b=0;a=a.find("tr");for(var c=0;c<a.count();c++){var d;d=0;for(var e=a.getItem(c).find("td"),f=0;f<e.count();f++){var g=e.getItem(f),g=g.getStyle("width")?g.getStyle("width"):g.getAttribute("width"),g=parseInt(POLARIS.tools.convertToUnit(g,"px"));d+=g}b=0==c?d:Math.min(b,d)}return b}function d(a){var b=!1,c=k(a);(a=(a=a.getStartElement())&&a.getAscendant("table",1))&&POLARIS.tools.buildTableMap(a);for(a=0;a<c.length;a++){var d=c[a],e=parseInt(d.getAttribute("colspan")),
d=parseInt(d.getAttribute("rowspan"));if(1<e||1<d){b=!0;break}}return b}function h(a,b){var c=a.document.getSelection(),d=new POLARIS.dom.element("div");d.setAttribute("contentEditable",!0);d.setStyle("position","absolute");d.setStyle("left","0px");d.setStyle("top","0px");POLARIS.document.getById("polaris_"+a.name).append(d);d.setAttribute("unselectable","off");d.setHtml(g(c));d.focus();document.execCommand("SelectAll");document.execCommand("Copy");d.remove();if(b)for(c=POLARIS.plugins.tabletools.getSelectedCells(c),
d=0;d<c.length;d++)c[d].setHtml("")}function g(a){if(a=K.getAscendant("table")){a=a.clone(!0);var b=a.find("colgroup");if(b)for(var c=0;c<b.count();c++)b.getItem(c).remove();b=a.find("td");for(c=0;c<b.count();c++){var d=b.getItem(c),f=d.hasClass("cell_selection");d.removeClass("cell_selection");f||d.remove()}b=0;d=a.find("tr");for(c=0;c<d.count();c++)if(f=d.getItem(c),1>f.getChildCount())f.remove();else{var g=e(f);if(isNaN(g)||POLARIS.tools.isEmptyValue(g)||1>g)f=f.find("td").getItem(0),g=e(f);b+=
g}0<b&&(a.removeAttribute("height"),a.setStyle("height",b))}return a&&a.getOuterHtml?a.getOuterHtml():""}function k(a,b){var c=[];return c="text"==b?f(a):"cell"==b?l(K,M):"field"==b?l(fa,Y):null==K||void 0==K||null==M||void 0==M?f(a):l(K,M)}function f(a){function b(a){0<c.length||a.type!=POLARIS.NODE_ELEMENT||!wa.test(a.getName())||a.getCustomData("selected_cell")||(POLARIS.dom.element.setMarker(d,a,"selected_cell",!0),c.push(a))}var c=[],d={};if(null==a||void 0==a)return c;a=a.getRanges();for(var e=
0;e<a.length;e++){var f=a[e];if(f.collapsed)f=f.getCommonAncestor(),(f=f.getAscendant("td",!0)||f.getAscendant("th",!0))&&c.push(f);else{var f=new POLARIS.dom.walker(f),g;f.guard=b;for(var h=null,k=null;g=f.next();)if(g.type!=POLARIS.NODE_ELEMENT||!g.is(POLARIS.dtd.table)){var l=g.getParent(),m=null;(m=l&&h&&l.$===h.$?k:g.getAscendant("td",!0)||g.getAscendant("th",!0))&&!m.getCustomData("selected_cell")&&(POLARIS.dom.element.setMarker(d,m,"selected_cell",!0),c.push(m));k=m;h=g}}}POLARIS.dom.element.clearAllMarkers(d);
return c}function l(a,b){var c=[];if(null==a||void 0==a||null==b||void 0==b)return c;if(a.equals(b))return c.push(a),c;var d=a.getAscendant("table",1),d=POLARIS.tools.buildTableMap(d),e=U(a,d);if(null==e||void 0==e)return c;var f=e[0],e=e[1],g=U(b,d);if(null==g||void 0==g)return c;var h=g[0],g=g[1],k=a.$.rowSpan||1,l=a.$.colSpan||1,m=b.$.rowSpan||1,n=b.$.colSpan||1;e>g?(n=e,e=g,g=n+l-1):g=g+n-1;f>h?(n=f,f=h,h=n+k-1):h=h+m-1;for(;f<=h&&!(f>=d.length);f++)for(k=e;k<=g;k++)if(l=d[f][k]){a:{m=c.length;
for(n=0;n<m;n++)if(l===c[n].$){m=!1;break a}m=!0}m&&c.push(new POLARIS.dom.element(l))}return c}function m(a,b,c,d){var e=k(a,d);if(c)return 1==e.length?!0:!1;c=e[0];d=c.getAscendant("table");c=c.getDocument();a=e[0].getParent();var f=a.$.rowIndex,e=e[e.length-1],g=e.getParent().$.rowIndex+e.$.rowSpan-1,e=new POLARIS.dom.element(d.$.rows[g]),f=b?f:g;a=b?a:e;e=POLARIS.tools.buildTableMap(d);d=e[f];f=b?e[f-1]:e[f+1];e=e[0].length;c=c.createElement("tr");for(g=0;g<e;g++)if(d[g]){var h;if(1<d[g].rowSpan&&
f&&d[g]==f[g])h=d[g],h.rowSpan+=1;else{h=ha(d[g],!0);var l=Number(d[g].getAttribute("rowspan"));1<l&&(l=POLARIS.tools.convertToPx(h.getStyle("height"))/l,h.setStyle("height",l+"px"));c.append(h);h=h.$}g+=h.colSpan-1}b?c.insertBefore(a):c.insertAfter(a)}function n(a,b){for(var c=b?k(a,b):k(a),d=c[0].getAscendant("table"),e=POLARIS.tools.buildTableMap(d),f=na(c,e),g=f.row.startIndex,h=f.row.endIndex,c=[],l=g;l<=h;l++){for(var m=e[l],n=new POLARIS.dom.element(d.$.rows[l]),p=0;p<m.length;p++)if(m[p]){var r=
new POLARIS.dom.element(m[p]);if(1==r.$.rowSpan)r.remove();else{var q=r.getParent().$.rowIndex;--r.$.rowSpan;if(q==l)a:{for(var q=r,z=l+1,v=p,t=e[l+1],D=void 0,u=void 0,D=void 0,D=v;0<=D;D--)if((u=t[D]?new POLARIS.dom.element(t[D]):void 0)&&u.getParent().$.rowIndex==z){q.insertAfter(u);break a}for(D=v;D<t.length;D++)if((u=t[D]?new POLARIS.dom.element(t[D]):void 0)&&u.getParent().$.rowIndex==z){q.insertBefore(u);break a}(D=q.getAscendant("table").$.rows[z])&&(new POLARIS.dom.element(D)).append(q,1)}}p+=
r.$.colSpan-1}c.push(n)}e=d.$.rows;e=new POLARIS.dom.element(e[h+1]||(0<g?e[g-1]:null)||d.$.previousSibling||d.$.parentNode);g=c.length;if(g==f.table.rowCount)d.remove();else for(d=0;d<g;d++)c[d].remove();return e.getFirst()}function q(a,b,c){a=k(a);var d=a.length;if(c)return 1==d?!0:!1;c=a[0].getAscendant("table");var e=POLARIS.tools.buildTableMap(c);a=na(a,e);var f=b?a.col.startIndex:a.col.endIndex,g=b?f-1:f+1;a=POLARIS.tools.getClientRectWithoutTransform(c).width;var d=[],h=[],l=e.length,m=c.findOne("colgroup");
if(m=m&&m.find("col")){var m=m.getItem(f),n=(new POLARIS.dom.element(m.$)).clone();n[b?"insertBefore":"insertAfter"].call(n,new POLARIS.dom.element(m.$))}for(m=0;m<l;m++)d.push(e[m][f]),h.push(e[m][g]);for(m=0;m<l;m++)d[m]&&(e=d[m],f=h[m],1<e.colSpan&&f==e?e.colSpan+=1:(f=(new POLARIS.dom.element(e)).clone(),f.removeAttribute("colSpan"),f.appendBogus(),f[b?"insertBefore":"insertAfter"].call(f,new POLARIS.dom.element(e)),e=f.$),m+=e.rowSpan-1);b=POLARIS.tools.getClientRectWithoutTransform(c).width;
h=a/b;l=(b=c.findOne("colgroup"))&&b.find("col");b=0;if(l)for(a=0;a<l.count();a++)e=l.getItem(a),d=Math.round(aa(e)*h),b+=d,e.setStyle("width",d),e.hasAttribute("width")&&e.removeAttribute("width");h=c.find("tr");for(a=l=0;a<h.count();a++)for(e=h.getItem(a).find("td"),f=0;f<e.count();f++)g=e.getItem(f),d=g.getSize("width"),0==a&&(l+=d),g.setStyle("width",d),g.hasAttribute("width")&&g.removeAttribute("width");c.setStyle("width",0<b?b:l+"px");c.removeAttribute("width")}function v(a){var b=a.findOne("colgroup");
if(b)return b;var c,d=POLARIS.tools.buildTableMap(a),b="";c=[];for(var e=d.length,f=0,g=0,h=null,k=0,l=0,l=null,f=0;f<e;f+=1)for(h=d[f],k=h.length,g=0;g<k;g+=1)h[g]&&(l=new POLARIS.dom.element(h[g]),l.isVisible()&&(l=h[g].offsetWidth,null==c[g]||c[g]>l))&&(c[g]=l);d=c.length;for(f=0;f<d;f++)b+='\x3ccol style\x3d"width: '+c[f]+'px;"\x3e';c=b;b=a.append("colgroup",!0);b.setHtml(c);return b}function r(a){if(a){for(var b=function(a,b,c){a.removeAttribute("width");a.removeAttribute("height");a.setStyle("width",
b);a.setStyle("height",c)},c=function(a){a.removeAttribute("width");a.removeAttribute("height");a.removeStyle("width");a.removeStyle("height")},d=a.$.offsetWidth,e=a.$.offsetHeight,f=function(a,b){for(var c=a.find(b),d=[],e=c.count(),f=0;f<e;f++){var g=c.getItem(f);d.push({element:g,width:g.$.offsetWidth,height:g.$.offsetHeight})}return d}(a,"td, th"),g=f.length,h=0;h<g;h++){var k=f[h].element;k.is("tr")?c(k):b(k,f[h].width,f[h].height)}b(a,d,e)}}function p(a,b,c){if(null!=a){var d=a.getDocument(),
e=POLARIS.document;POLARIS.env.ie&&10==POLARIS.env.version&&(e.focus(),d.focus());(e=a.isEditable())||a.setAttribute("contentEditable",!0);d=new POLARIS.dom.range(d);e?d["moveToElementEdit"+(b?"End":"Start")](a)||(d.selectNodeContents(a),d.collapse(b?!1:!0)):d.moveToLeafElementEditablePosition(a)||(d.selectNodeContents(a),d.collapse(b?!1:!0));1!=c&&(M=K=a,null!=fa&&(fa=a),null!=Y&&(Y=a));d.select(!0);e||a.setAttribute("contentEditable",e)}}function t(a,b,c){a=a[b];if("undefined"==typeof c){c=[];for(b=
0;b<a.length;b++)c.push(a[b]),1<a[b].colSpan&&(b+=a[b].colSpan-1);return c}for(b=0;a&&b<a.length;b++){if(c.is&&a[b]==c.$)return b;if(b==c)return new POLARIS.dom.element(a[b])}return c.is?-1:null}function w(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];c.push(e[b]);1<e[b].rowSpan&&(d+=e[b].rowSpan-1)}return c}function A(b,c,d,f){f=k(b,f);var g;if((c?1!=f.length:2>f.length)||(g=b.getCommonAncestor())&&g.type==POLARIS.NODE_ELEMENT&&g.is("table"))return!1;var h;b=f[0];g=b.getAscendant("table");var l=
POLARIS.tools.buildTableMap(g),m=l.length,n=l[0].length,p=b.getParent().$.rowIndex,r=t(l,p,b);if(c){var q;try{var z=parseInt(b.getAttribute("rowspan"),10)||1;h=parseInt(b.getAttribute("colspan"),10)||1;q=l["up"==c?p-z:"down"==c?p+z:p]["left"==c?r-h:"right"==c?r+h:r]}catch(v){return!1}if(!q||b.$==q)return!1;f["up"==c||"left"==c?"unshift":"push"](new POLARIS.dom.element(q))}c=b.getDocument();var D=p,z=q=0,u=!d&&new POLARIS.dom.documentFragment(c),y=0;if(!d){var w=0,x=0;for(c=0;c<f.length;c++)h=f[c],
w+=a(h),x+=e(h)}for(c=0;c<f.length;c++){h=f[c];var w=h.getParent(),x=h.getFirst(),F=h.$.colSpan,O=h.$.rowSpan,w=w.$.rowIndex,E=t(l,w,h),y=y+F*O,z=Math.max(z,E-r+F);q=Math.max(q,w-p+O);d||(F=h,(O=F.getBogus())&&O.remove(),F.trim(),h.getChildren().count()&&(w==D||!x||x.isBlockBoundary&&x.isBlockBoundary({br:1})||(D=u.getLast(POLARIS.dom.walker.whitespaces(!0)),!D||D.is&&D.is("br")||u.append("br")),D=h.getText().replace(/\u200B{7}/g,""),(h.hasImageAsChild()||!c||0!=D.length&&(1!=D.length||10!=D.charCodeAt(0)&&
160!=D.charCodeAt(0)&&8203!=D.charCodeAt(0)))&&h.moveChildren(u)),c?h.remove():h.setHtml(""));D=w}if(d)return q*z==y;u.moveChildren(b);if(1<z&&q==l.length)b.setAttribute("colspan",z),b.setAttribute("rowspan",q);else{0==b.getChildCount()&&b.appendBogus();if(z>=n)b.removeAttribute("rowSpan");else if(d=!1,b.hasPrevious()&&(d=q==b.getPrevious().rowSpan?!0:!1),b.hasNext()&&(d=q==b.getNext().rowSpan?!0:!1),1<q||!d)b.$.rowSpan=q;q>=m?b.removeAttribute("colSpan"):1<z&&(b.$.colSpan=z);d=b.getAscendant("table");
d=POLARIS.tools.buildTableMap(d);optimizeCellIndex=U(b);for(f=0;f<b.$.rowSpan;f++)if(m=optimizeCellIndex[0]+f,l=d[m]){n=Number.MAX_VALUE;for(p=0;p<l.length;p++)l[p]&&l[p].rowSpan<n&&(n=l[p].rowSpan);if(1<n&&n<Number.MAX_VALUE){for(c=r=0;c<n-1;c++){for(p=q=0;p<l.length;p++)z=new POLARIS.dom.element(d[m+c][p]),h=new POLARIS.dom.element(d[m+c+1][p]),z.equals(h)&&q++;q==l.length&&r++}for(p=0;p<l.length;p+=l[p].colSpan)l[p].rowSpan-=r,2>l[p].rowSpan&&l[p].removeAttribute("rowSpan")}}}g=new POLARIS.dom.nodeList(g.$.rows);
d=g.count();for(c=d-1;0<=c;c--)f=g.getItem(c),f.$.cells.length||(f.remove(),d++);g=POLARIS.tools.getClientRectWithoutTransform(b).width;d=POLARIS.tools.getClientRectWithoutTransform(b).height;b.setStyle("width",ia(g));b.setStyle("height",ia(d));T=0;return Q=M=K=b}function x(a){function b(a){for(var c=0,d=null,c=l,d=p,e=[],f=a.getAscendant("table",1),g=f&&f.findOne("colgroup"),g=g&&g.find("col"),f=POLARIS.tools.buildTableMap(f),h=a.getParent().$.rowIndex,h=t(f,h,a),k=0;k<d;k++){var m;m=g?parseInt(g.getItem(h+
k).getStyle("width")):parseInt(f[h+k][0].clientWidth);var n=0,n=k<c-Math.floor(m)*d?Math.ceil(m):Math.floor(m);e.push(n)}a.setStyle("width",e[0]);a.removeAttribute("width");a.setAttribute("colspan",1);for(c=1;c<p;c+=1)d=ha(a,!0),d.insertAfter(a),d.setAttribute("colspan",1),d.setStyle("width",e[c]),d.removeAttribute("width")}function c(){for(var a=0,d=0,f=null,k=null,l=null,q=0,z=null,q=g,a=m,f=r,v=[],l=a,d=q.getAscendant("table",1),d=POLARIS.tools.buildTableMap(d),t=q=q.getParent().$.rowIndex;t<q+
f;t++){for(var D=0;D<d[q].length;D++)l=Math.min(l,parseInt(d[t][D].clientHeight));v.push(l);l=a}g.setStyle("height",v[0]);g.removeAttribute("height");g.setAttribute("rowspan",1);for(a=1;a<r;a+=1){f=ha(g,!0);f.setStyle("height",v[a]);k=k?k.getNext():h.getNext();k||(k=h.clone(),k.insertAfter(h));d=l=e[n+a];q=g;t=-1;for(D=D=0;D<d.length;D+=1)if(d[D].isEqualNode(q.$)){t=D;break}q=t;for(d=0;d<l.length;d+=1)if(z=l[d],z.parentNode===k.$&&d>q){f.insertBefore(new POLARIS.dom.element(z));break}else z=null;
z||k.append(f);1<p&&b(f)}}var d=(a=k(a))&&a[0],e=(d=d&&d.getAscendant("table"))&&POLARIS.tools.buildTableMap(d),f=0,g=null,h=null,l=0,m=0,n=0,p=0,r=0;if(e){for(f=0;f<a.length;f+=1)u(a[f]);e=d&&POLARIS.tools.buildTableMap(d);for(f=0;f<a.length;f+=1)g=a[f],g.isVisible()&&(l=g.getSize("width"),m=g.getSize("height"),h=g.getParent(),n=h.$.rowIndex,t(e,n,g),p=Number(g.getAttribute("colspan")),r=Number(g.getAttribute("rowspan")),1<r&&c(),1<p&&b(g));return g}}function C(a){var b,c=a?a.length:0;for(b=0;b<
c;b++){var d=a[b],e=new POLARIS.dom.elementPath(d.getTextNodes()[0],d),f=new POLARIS.dom.element("p"),g=new POLARIS.dom.element("span"),h=void 0,k=void 0,h={"line-height":POLARIS.tools.getStyleInPath(e,"line-height")},k={"font-size":POLARIS.tools.getStyleInPath(e,"font-size"),"font-family":POLARIS.tools.getStyleInPath(e,"font-family")};g.setStyles(k);g.setText("​");f.append(g);f.setStyles(h);d.setHtml(f.getOuterHtml())}}function u(a){if("polaris-spanned-td"==a.getAttribute("doc-data-role")&&a.isVisible()){for(var b=
a.getAttribute("doc-data-value"),b=a.getAscendant("table").find('td[doc-data-value\x3d"'+b+'"]'),c=b.count(),d=0;d<c;d++){var e=b.getItem(d);a.$!=e.$&&"none"==e.getStyle("display")&&e.remove()}a.removeAttribute("doc-data-value");a.removeAttribute("doc-data-role")}}function B(a,b){var c;c=fa&&Y?k(a,"field"):k(a);if(1<c.length)return!1;if(b)return!0;c=c[0];var d=c.getParent(),e=d.getAscendant("table"),f=POLARIS.tools.buildTableMap(e),g=d.$.rowIndex,h=t(f,g,c),l=c.$.rowSpan,m;if(1<l){m=Math.ceil(l/2);
var l=Math.floor(l/2),d=g+m,e=new POLARIS.dom.element(e.$.rows[d]),f=t(f,d),n,d=ha(c,!1);(g=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b.$)return c}(f,c))&&POLARIS.tools.isNumber(g)&&(h=g);for(g=0;g<f.length;g++)if(n=f[g],n.parentNode==e.$&&g>h){d.insertBefore(new POLARIS.dom.element(n));break}else n=null;n||e.append(d)}else for(l=m=1,e=d.clone(),e.insertAfter(d),d=ha(c,!1),e.append(d),n=t(f,g),h=0;h<n.length;h++)n[h].rowSpan++;n=c.getStyle("height")||c.getAttribute("height")||c.$.offsetHeight+
"px";n=n.replace(/((?:\d*\.\d+)|(?:\d+))(\w*)/g,function(a,b,c){return Math.max(1,b)/2+c});c.setStyle("height",n);d.setStyle("height",n);if(n=d.getChild(0))for(;n&&n.type==POLARIS.NODE_ELEMENT;)n.is("p")&&0==n.getHtml().length&&n.appendBogus(),n=n.getChild(0);else d.appendBogus();c.$.rowSpan=m;d.$.rowSpan=l;1==m&&c.removeAttribute("rowSpan");1==l&&d.removeAttribute("rowSpan");return d}function G(a,b,c){a=k(a);if(1<a.length)return!1;if(b)return!0;b=a[0];a=b.getParent();var d=a.getAscendant("table"),
e=POLARIS.tools.buildTableMap(d),f=t(e,a.$.rowIndex,b),d=b.$.colSpan;if(1<d)a=Math.ceil(d/2),d=Math.floor(d/2);else for(d=a=1,e=w(e,f),f=0;f<e.length;f++)e[f].colSpan++;b.hasAttribute("width")?(e=b.getAttribute("width"),e=e.replace(/((?:\d*\.\d+)|(?:\d+))(\w*)/g,function(a,b,c){return Math.max(1,b)/2+c}),b.setAttribute("width",e)):b.$.style.width&&(b.$.style.width=b.$.style.width.replace(/((?:\d*\.\d+)|(?:\d+))(\w*)/g,function(a,b,d){return void 0!=c?c+d:Math.max(1,b)/2+d}));e=b.clone();e.insertAfter(b);
e.appendBogus();b.$.colSpan=a;e.$.colSpan=d;1==a&&b.removeAttribute("colSpan");1==d&&e.removeAttribute("colSpan");return e}function y(a,b,c,d){function e(a,b){if(!a)return-1;for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function f(a,b){var c=NaN;e(a,function(a){a=a.$.innerText.trim().replace(/\u200b|,/g,"");a=parseFloat(a);isNaN(a)||(a=+a,c=isNaN(c)?a:b(c,a))});return c}c=c||function(a){return a};var g=0,h=0,k=[],l=[],m=!1,n=!1,p=!1,r=!1,q=0,z=0;e(a,function(a){var b=a.getText(),c=U(a),d=c[0],c=c[1];l[d]=
l[d]||[];l[d].push(a);k[c]=k[c]||[];k[c].push(a);if(0==b.length||1==b.length&&10==b.charCodeAt(0))h<c&&(m=!0),g<d&&(n=!0);g==d?p=!0:(z++,p=!1);g=Math.max(g,d);h==c?r=!0:(q++,r=!1);h=Math.max(h,c)});0==m&&1==p&&(h+=1);0==n&&1==r&&(g+=1);var D=Q.getAscendant("table"),v=POLARIS.tools.buildTableMap(D);if(!v[g]||!v[g][h])return alert(d.lang.table.blockCalcErrorMsg.errorBlock),-1;1==m&&0==n&&(r=!1);0==m&&1==n&&(p=!1);1==p&&e(l,function(a,d){if(!a)return-1;var e=f(a,b),g=v[d][h],e=c(e,a.length);isNaN(e)||
X(g,e)});var t=!1;0==m&&0==n&&1<q&&1<z&&(t=!0);var u=NaN;1==r&&e(k,function(a,d){if(!a)return-1;var e=f(a,b),h=v[g][d],k=c(e,a.length);isNaN(k)||X(h,k);1==t&&(u=isNaN(u)?e:b(u,e))});1==t&&X(v[g][h],c(u,a.length));1==p&&e(l,function(a,d){if(!a)return-1;var e=f(a,b),g=v[d][h],e=c(e,a.length);isNaN(e)&&X(g,"0")});1==r&&e(k,function(a,d){if(!a)return-1;var e=f(a,b),h=v[g][d],e=c(e,a.length);isNaN(e)&&X(h,"0")})}function F(a,b,c,d,e){var f=k(a);if(b)return 2<=f.length?!0:!1;a=k(a);b=Q.getAscendant("table",
!0);POLARIS.tools.buildTableMap(b);for(var g=0,h=0;h<b.$.rows.length;h++)g+=b.$.rows[h].children.length;a.length==g?(alert(c.lang.table.blockCalcErrorMsg.errorBlock),a=!1):a=!0;0!=a&&-1!=y(f,d,e,c)&&alert(c.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function E(a,b,c){return F(a,b,c,function(a,b){return a+b})}function H(a,b,c){return F(a,b,c,function(a,b){return a*b})}function J(a,b,c){return F(a,b,c,function(a,b){return a+b},function(a,b){return a/b})}function I(a,b,c){if(1<k(b).length)return!1;
if(c)return!0;b=Q.getAscendant("table");b=POLARIS.tools.buildTableMap(b);c=U(Q)[1];for(var d=0,e,f=0;f<b.length;f++)if(b[f][c]){var g=new POLARIS.dom.element(b[f][c]);if(Q.equals(g))break;if(!g.equals(e)){var h=g.$.innerText.trim().replace(/\u200b|,/g,""),h=parseFloat(h);isNaN(h)||(d+=h,e=g)}}a.insertText(d.toString());alert(a.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function L(a,b,c){if(1<k(b).length)return!1;if(c)return!0;b=Q.getAscendant("table");b=POLARIS.tools.buildTableMap(b);c=U(Q)[0];
for(var d=0,e,f=0;f<b[c].length;f++)if(b[c][f]){var g=new POLARIS.dom.element(b[c][f]);if(Q.equals(g))break;if(!g.equals(e)){var h=g.$.innerText.trim().replace(/\u200b|,/g,""),h=parseFloat(h);isNaN(h)||(d+=h,e=g)}}a.insertText(d.toString());alert(a.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function z(a,b,c){if(1<k(b).length)return!1;if(c)return!0;b=Q.getAscendant("table");b=POLARIS.tools.buildTableMap(b);c=U(Q)[1];for(var d=0,e,f=0,g=0;g<b.length;g++)if(b[g][c]){var h=new POLARIS.dom.element(b[g][c]);
if(Q.equals(h))break;if(!h.equals(e)){var l=h.$.innerText.trim().replace(/\u200b|,/g,""),l=parseFloat(l);isNaN(l)||(f++,d+=l,e=h)}}0==d&&0==f?a.insertText("0"):a.insertText((d/f).toString());alert(a.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function D(a,b,c){if(1<k(b).length)return!1;if(c)return!0;b=Q.getAscendant("table");b=POLARIS.tools.buildTableMap(b);c=U(Q)[0];for(var d=0,e,f=0,g=0;g<b[c].length;g++)if(b[c][g]){var h=new POLARIS.dom.element(b[c][g]);if(Q.equals(h))break;if(!h.equals(e)){var l=
h.$.innerText.trim().replace(/\u200b|,/g,""),l=parseFloat(l);isNaN(l)||(f++,d+=l,e=h)}}0==d&&0==f?a.insertText("0"):a.insertText((d/f).toString());alert(a.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function O(a,b,c){if(1<k(b).length)return!1;if(c)return!0;b=Q.getAscendant("table");b=POLARIS.tools.buildTableMap(b);c=U(Q)[1];for(var d=1,e,f=0,g=0;g<b.length;g++)if(b[g][c]){var h=new POLARIS.dom.element(b[g][c]);if(Q.equals(h))break;if(!h.equals(e)){var l=h.$.innerText.trim().replace(/\u200b|,/g,
""),l=parseFloat(l);isNaN(l)||(f++,d*=l,e=h)}}0==f&&(d=0);a.insertText(d.toString());alert(a.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function P(a,b,c){if(1<k(b).length)return!1;if(c)return!0;b=Q.getAscendant("table");b=POLARIS.tools.buildTableMap(b);c=U(Q)[0];for(var d=1,e,f=0,g=0;g<b[c].length;g++)if(b[c][g]){var h=new POLARIS.dom.element(b[c][g]);if(Q.equals(h))break;if(!h.equals(e)){var l=h.$.innerText.trim().replace(/\u200b|,/g,""),l=parseFloat(l);isNaN(l)||(f++,d*=l,e=h)}}0==f&&(d=0);
a.insertText(d.toString());alert(a.lang.table.blockCalcErrorMsg.errorNotAutoCalc)}function X(a,b){var c=new POLARIS.dom.element(a),d=new POLARIS.dom.range(c.getDocument());d.selectNodeContents(c);d=new POLARIS.dom.walker(d);d.guard=function(a){return!a.equals(c)};for(var e=null,f=null;f=d.next();)f.type==POLARIS.NODE_TEXT&&(null==e&&(e=f),f.setText(""));e?e.getParent().setHtml(b):(d=new POLARIS.dom.element("p"),d.setHtml(b),c.trim(),c.append(d))}function S(a,b,c){a=k(b,"cell");if(c)return!0;if(0==
ea(b)&&0==ga(b))return alert("셀 블록을 설정해 주세요."),!1;for(b=0;b<a.length;b++){c=a[b];var d=c.$.innerHTML.replace(/[^>]*,\d+[^>]*(?=<)/g,function(a){return a.replace(/\u200b/,"").replace(/,(\d+)/g,function(a,b){return b})}),d=d.replace(/[^>]*\d{4}[^>]*(?=<)/g,function(a){a=a.toString().split(".");return a[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")+(a[1]?"."+a[1]:"")});c.setHtml(d)}p(a[0],!0,!0)}function N(a,b){var c=k(a,"cell");if(b)return!0;if(0==ea(a)&&0==ga(a))return alert("셀 블록을 설정해 주세요."),!1;for(var d=
0;d<c.length;d++){var e=c[d],f=e.$.innerHTML.replace(/[^>]*,\d+[^>]*(?=<)/g,function(a){return a.replace(/\u200b/,"").replace(/,(\d+)/g,function(a,b){return b})});e.setHtml(f)}p(c[0],!0,!0)}function U(a,b){if(null!=a&&void 0!=a){var c=a.getAscendant("table",1);if(null!=c&&void 0!=c){var d=b;if(null==d||void 0==d)d=POLARIS.tools.buildTableMap(c);for(var c=[],e=0;e<d.length;e++)for(var f=d[e],g=0;g<f.length;g++)if(d[e][g]&&(new POLARIS.dom.element(d[e][g])).equals(a))return c.push(e),c.push(g),c;return c}}}
function na(a,b){if(a&&Array.isArray(a)){var c;if(null==b||void 0==b||!Array.isArray(b)||0==b.length){c=a[0].getAscendant("table",1);if(null==c||void 0==c)return;b=POLARIS.tools.buildTableMap(c)}c=[];var d=a.length,e=b.length,f=b[e-1].length,g,h,k,l;for(g=0;g<e;g++)for(h=0;h<f;h++)if(b[g][h])for(l=new POLARIS.dom.element(b[g][h]),k=0;k<d;k++)a[k].equals(l)&&"undefined"==typeof c[k]&&(c[k]={row:g,col:h,rowspan:l.$.rowSpan,colspan:l.$.colSpan});var m,n,p,r;for(g=0;g<d;g++){k=c[g];h=[k.col,k.col+k.colspan-
1];k=[k.row,k.row+k.rowspan-1];if("undefined"==typeof m||h[0]<m)m=h[0];if("undefined"==typeof n||n<h[1])n=h[1];if("undefined"==typeof p||k[0]<p)p=k[0];if("undefined"==typeof r||r<k[1])r=k[1]}return{indexs:c,col:{startIndex:m,endIndex:n,count:n-m+1},row:{startIndex:p,endIndex:r,count:r-p+1},isSelectedTableCol:0==p&&r==e-1,isSelectedTableRow:0==m&&n==f-1,table:{colCount:f,rowCount:e}}}}function V(){void 0!=K&&null!=K&&ba(K);M=K=null;ja=!1;T=0}function Z(a){a=a.document.find("table");for(var b=0;b<a.count();b++){var c=
a.getItem(b);ba(c)}}function ka(){fa&&ba(fa);Y&&ba(Y);Y=fa=null}function R(a,b,c){if(null==a||void 0==a||null==a||void 0==a)if(null!=K&&void 0!=K||null!=M&&void 0!=M)a=K,b=M;else return;if(null!=a){var d=a.getAscendant("body");if(null!=d&&void 0!=d){var e=a.getAscendant("table",1);if(null!=e&&void 0!=e&&(c||!a.equals(b))){c=e.getStyle("background-color");a=l(a,b);for(b=0;b<a.length;b++)e=a[b].getStyle("background-color"),"rgb(0, 216, 255)"==c||"rgb(0, 216, 255)"==e?a[b].addClass("cell_bgcolor_selection"):
a[b].addClass("cell_selection");ma=!0;d.addClass("hiden_text_selection")}}}}function ba(a){if(null==a||void 0==a){if(null==K||void 0==K||T)return;a=K}var b=a.getAscendant("body");if(null!=b&&void 0!=b&&(a=a.getAscendant("table",1),null!=a&&void 0!=a)){for(var c=a.find(".cell_selection"),d=0;d<c.count();d++){var e=c.getItem(d);e.removeClass("cell_selection")}c=a.find(".cell_bgcolor_selection");for(d=0;d<c.count();d++)e=c.getItem(d),e.removeClass("cell_bgcolor_selection");ma=!1;b.removeClass("hiden_text_selection")}}
function Ba(a){var b=l(K,M);if(2>b.length)return!1;var c=b[0],d=b[b.length-1],e=U(c),f=U(d),g=c.getAscendant("table",1),h=POLARIS.tools.buildTableMap(g);if(0==e[1]-f[1])return!1;if(a)return!0;for(var k=0,m=0,n=K,p=M,r=h.length-1,q=0;q<r+1;q++){a=e[1];var z=Number(d.getAttribute("colspan"));2>z&&(z=1);for(var c=f[1]+z-1,v=a;v<c+1;v++)if(h[q][v]){var D=new POLARIS.dom.element(h[q][v]),z=Number(D.getAttribute("colspan"));2>z&&(z=1);k+=Number(D.getStyle("width").replace(/[^-\d\.]/g,""))/z;m++;0==q&&v==
a?n=D:q==r&&v==c&&(p=D)}}d=function(a,c,d,e,f){for(c=0;c<b.length;c++){var g=b[c],h=Number(g.getAttribute("colspan"));2>h&&(h=1);g.setStyle("width",d*h+"px")}a=(a=a.findOne("colgroup"))&&a.find("col");g=0;if(a)for(d=e;d<f+1;d++)if(c=a.getItem(d))c=aa(c),g+=c;g=la(g,f+1-e);h=0;for(d=e;d<f+1;d++){if(c=a.getItem(d))c.setStyle("width",g[h]),c.hasAttribute("width")&&c.removeAttribute("width");h++}};k/=m;a=e[1];c=f[1];b=l(n,p);d(g,b,k,a,c);e=[];g=n.getAscendant("table");if(g.hasAttribute("doc-data-value")&&
"polaris-table-paginated"==g.getAttribute("doc-data-role"))for(h=g.getAttribute("doc-data-value"),h=g.getAscendant("body",1).find('table[doc-data-value\x3d"'+h+'"]'),q=0;q<h.count();q++)f=h.getItem(q),g.$!=f.$&&e.push(f);for(v=0;v<e.length;v++)f=e[v],h=POLARIS.tools.buildTableMap(f),g=h[0][a]?new POLARIS.dom.element(h[0][a]):null,h=h[h.length-1][c]?new POLARIS.dom.element(h[h.length-1][c]):null,b=l(g,h),d(f,b,k,a,c)}function oa(a){var b=l(K,M);if(2>b.length)return!1;var c=b[0],b=b[b.length-1],d=U(c),
e=U(b),c=c.getAscendant("table",1),f=POLARIS.tools.buildTableMap(c),c=0;if(0==d[0]-e[0])return!1;if(a)return!0;for(var g=0,h=0,k=K,m=M,n=f[0].length-1,p=0;p<n+1;p++){var r=d[0],q=Number(b.getAttribute("rowspan"));2>q&&(q=1);for(var z=e[0]+q-1,v=r;v<z+1;v++)if(f[v][p]){a=new POLARIS.dom.element(f[v][p]);for(var D=q=0;D<a.getChildCount();D++)var t=a.getChild(D),q=q+POLARIS.tools.getClientRectWithoutTransform(t).height;c<q&&(c=q);q=Number(a.getAttribute("rowspan"));2>q&&(q=1);g+=Number(a.getStyle("height").replace(/[^-\d\.]/g,
""))/q;h++;0==p&&v==r?k=a:p==n&&v==z&&(m=a)}}d=g/h;b=l(k,m);for(e=0;e<b.length;e++)a=b[e],q=Number(a.getAttribute("rowspan")),2>q&&(q=1),a.setStyle("height",(c>d?c:d)*q+"px")}function da(a){a=f(a);var b=l(K,M);return null!=K&&void 0!=K&&null!=M&&void 0!=M&&a.length<=b.length?!0:!1}function ea(a){a=(a=a.getStartElement())&&a.getAscendant("body");return null!=a&&void 0!=a&&a.hasClass("hiden_text_selection")?!0:!1}function ga(a){a=a.getStartElement();null==a&&(a=K);if(null==a)return!1;a=a.getAscendant("table",
1);if(null==a)return!1;a=POLARIS.tools.buildTableMap(a);for(var b=!0,c=0,d=a.length;c<d;c++)for(var e=0,f=a[c].length;e<f;e++)if(a[c][e]){var g=new POLARIS.dom.element(a[c][e]);if(0==g.hasClass("cell_selection")&&0==g.hasClass("cell_bgcolor_selection")&&1==g.isVisible()&&"none"!=g.getComputedStyle("display")){b=!1;break}}return b}function aa(a){var b=a.getStyle("width")?a.getStyle("width"):a.getAttribute("width");b&&(-1<b.indexOf("pt")?b=POLARIS.tools.convertPtToPx(b):-1<b.indexOf("mm")?b=POLARIS.tools.convertMmTopx(parseFloat(b)):
-1<b.indexOf("px")&&(b=parseFloat(b)));if(isNaN(b)||POLARIS.tools.isEmptyValue(b)||0==b)b=a.getSize("width");return parseFloat(b)}function la(a,b){for(var c=[],d=a/b,e=a-Math.floor(d)*b,f=0;f<b;f++){var g=0,g=f<e?Math.ceil(d):Math.floor(d);c.push(g)}return c}function pa(a,b,c){b=k(b);if(0<b.length){if(c)return c=b[0].getStyle("vertical-align"),c==a||"middle"==a&&""==c?!0:!1;for(c=0;c<b.length;c++)b[c].setStyle("vertical-align",a)}else return!1}function za(a){this.value=a}function Ja(b){var c=b.editor,
d=c.document.getSelection(),f=d&&d.getStartElement(),g=f&&f.getAscendant("body"),l=g&&g.hasClass("hiden_text_selection"),m=b.data.domEvent.$.ctrlKey||b.data.domEvent.$.metaKey,n=b.data.domEvent.$.altKey,r=b.data.domEvent.$.shiftKey,q=m||n||r,g=b.data.domEvent.getKey(),v=b.data.keyCode;if(!f)return!1;if(f&&!f.getAscendant({td:1,th:1},!0)&&!K)return V(),!1;if(q&&(16<=g&&18>=g||91==g))return!1;if(m&&l&&(1114179==v||67==v||1114200==v||88==v))return h(b.editor,1114200==v||88==v),b.data.domEvent.preventDefault(),
!0;if(116==b.data.keyCode)return 0==T&&(M=K=f.getAscendant("td",!0)||f.getAscendant("th",!0)),T++,1==T?R(M,M,T):3==T&&(q=K.getAscendant("table"),f=POLARIS.tools.buildTableMap(q),c=f.length-1,g=f[c].length-1,K=f[0][0]?new POLARIS.dom.element(f[0][0]):null,M=f[c][g]?new POLARIS.dom.element(f[c][g]):null,R(K,M,T),p(M,!1,!0),T=2),!0;if(27==b.data.keyCode)return ja=!1,T=0,ba(M),p(M),!0;if(T&&q&&37<=g&&40>=g){var t=function(b,c,d,f,g,h,k,l,m,n){if((b.hasClass("cell_selection")||b.hasClass("cell_bgcolor_selection"))&&
0==k[c][d])if("columnResizer"==m){n=(c=l?39==f:37==f)?-n:n;if(!b.getNext(F))return 0;(b=(f=(f=b.getAscendant("table"))&&f.findOne("colgroup"))&&f.find("col"))&&0<b.count()&&(f=b.getItem(d+(l?1:0)),b=b.getItem(d+(l?0:1)),l=c?aa(f)+n:aa(b)+n,20>l&&(l=20,n=0),0!=n&&(f&&f.setStyle("width",ia(aa(f)+n)),b&&b.setStyle("width",ia(aa(b)-n))));if(c)for(c=0;c<g.length;c++)f=new POLARIS.dom.element(g[c][d]),b=f.getNext(F),l=a(f)+n,20>l&&(l=20,n=0),0!=n&&(f&&f.setStyle("width",ia(a(f)+n)),b&&b.setStyle("width",
ia(a(b)-n)));else for(c=0;c<g.length;c++)f=new POLARIS.dom.element(g[c][d]),b=f.getNext(F),l=a(b)+n,20>l&&(l=20,n=0),0!=n&&(f&&f.setStyle("width",ia(a(f)+n)),b&&b.setStyle("width",ia(a(b)-n)))}else"rowResizer"==m&&(l=function(a,b){for(var c=b,d=null,f=[],h=0;h<g[a].length;h++){var k=new POLARIS.dom.element(g[a][h]);null==d&&(d=k.getAscendant("tr"));var l=Math.max(parseInt(k.getComputedStyle("min-height")),u(k)),m=e(k),n=m-b;l>n&&(n=l,c=0);f.push({cell:k,newHeight:n,cellHeight:m})}for(h=0;h<f.length;h++)d=
f[h],d.cell.setStyle("height",ia(d.newHeight));return 0==c?!1:!0},b=function(a,b){for(var c=null,d=[],f=0;f<g[a].length;f++){var h=new POLARIS.dom.element(g[a][f]);null==c&&(c=h.getAscendant("tr"));var k=e(h)+b;d.push({cell:h,newHeight:k})}for(f=0;f<d.length;f++)c=d[f],c.cell.setStyle("height",ia(c.newHeight))},d=c+1,d<g.length&&(38==f?l(c,n)&&b(d,n):l(d,n)&&b(c,n)));return 0};b=function(b,c,d,f,g,h,k,l,m,n,p){var r=0;if((b.hasClass("cell_selection")||b.hasClass("cell_bgcolor_selection"))&&0==k[c][d])if("columnResizer"==
m){n=(h=l?39==f:37==f)?-n:n;c=[];b=b.getAscendant("table");f=b.$.offsetWidth||a(b);if(POLARIS.tools.getPageContentsSize(p).width<f+n)return;(b=(b=b&&b.findOne("colgroup"))&&b.find("col"))&&0<b.count()&&(b=b.getItem(d+(l?1:0)),h&&(h=aa(b)+n,20>h&&(n=0)),0!=n&&b&&b.setStyle("width",ia(aa(b)+n)));for(l=0;l<g.length;l++)g[l][d]&&(b=new POLARIS.dom.element(g[l][d]),h=a(b)+n,20>h&&(h=20),c.push({cell:b,newWidth:h}),k[l][d]=1);for(l=0;l<c.length;l++)k=c[l],k.cell.setStyle("width",ia(k.newWidth));r+=n}else if("rowResizer"==
m){n=38==f?-n:n;d=[];for(l=0;l<h.length;l++)h[l]&&(b=new POLARIS.dom.element(h[l]),g=Math.max(parseInt(b.getComputedStyle("min-height")),u(b)),p=e(b)+n,g>p&&(p=g,n=0),d.push({cell:b,newHeight:p}),k[c][l]=1);for(l=0;l<d.length;l++)k=d[l],k.cell.setStyle("height",ia(k.newHeight));r+=n}return r};for(var u=function(a){for(var b=0,c=0;c<a.getChildCount();c++)var d=a.getChild(c),b=b+POLARIS.tools.getClientRectWithoutTransform(d).height;c=parseFloat(a.getComputedStyle("padding-top"));a=parseFloat(a.getComputedStyle("padding-bottom"));
return b=Math.ceil(b+c+a)},l=U(M),q=M.getAscendant("table"),f=POLARIS.tools.buildTableMap(q),d=l[0],l=l[1],v=parseInt(M.getAttribute("colspan"),10)||1,r=parseInt(M.getAttribute("rowspan"),10)||1,r="rtl"==c.lang.dir,w=37==g||39==g?"columnResizer":"rowResizer",v=[],y=0;y<f.length;y++){v[y]=[];for(var x=0;x<f[y].length;x++)v[y][x]=0}var F=function(a){return a.type==POLARIS.NODE_ELEMENT};c.fire("saveSnapshot");var G=0;if(m)for(y=0;y<f.length;y++)for(m=f[y],x=0;x<m.length;x++)n=new POLARIS.dom.element(m[x]),
G+=b(n,y,x,g,f,m,v,r,w,1,c);else n&&(m=new POLARIS.dom.element(f[d][l]),t(m,d,l,g,f,f[d],v,r,w,1));0!=G&&"columnResizer"==w?q.setStyle("width",ia(a(q)+G)):0!=G&&"rowResizer"==w&&q.setStyle("height",ia(e(q)+G));c.fire("change");c.fire("contentChange",{type:"tableresize"});return!0}if((T||n)&&37<=b.data.domEvent.getKey()&&40>=b.data.domEvent.getKey()){g=Q;if(void 0==g||null==g)g=M;if(g&&g.getAscendant({td:1,th:1},!0)){if(3==T)return!0;l=U(g);q=g.getAscendant("table");f=POLARIS.tools.buildTableMap(q);
d=l[0];l=l[1];v=parseInt(g.getAttribute("colspan"),10)||1;r=parseInt(g.getAttribute("rowspan"),10)||1;38==b.data.domEvent.getKey()||40==b.data.domEvent.getKey()?d=38==b.data.domEvent.getKey()?d-1:d+r:(((r="rtl"==c.lang.dir)?39==b.data.domEvent.getKey():37==b.data.domEvent.getKey())?(--l,0>l&&0<d&&(l=f[d].length-1,--d)):(l+=v,l>f[d].length-1&&(d+1>f.length-1?l=f[d].length-1:(d+=1,l=0))),0>l&&(l=0));0>d&&(d=0);d>f.length-1&&(d=f.length-1);(m=f[d])&&(t=m[l]);t?(w=new POLARIS.dom.element(t),T&&R(w,w,
T)):38==b.data.domEvent.getKey()?q.hasPrevious()&&(w=q.getPrevious()):q.hasNext()&&(w=q.getNext());ba(w);K||(K=w);M=w;0==T?Q=K=M:1==T&&(K=M);T&&R(K,M,T);p(M,!1,!0)}return!0}if(!l||77!=b.data.keyCode&&"KeyM"!=b.data.domEvent.$.code&&"m"!=b.data.domEvent.$.key){if(l&&(46==b.data.keyCode||8==b.data.keyCode))return!1;if(l&&(76==b.data.keyCode||"KeyL"==b.data.domEvent.$.code||"l"==b.data.domEvent.$.key)){if(!q)return ca=ta=!1,c.execCommand("cellProperties"),!0}else if(l&&(67==b.data.keyCode||"KeyC"==b.data.domEvent.$.code||
"c"==b.data.domEvent.$.key)){if(!q)return ca=ta=!1,c.execCommand("cellProperties"),!0}else if(72==b.data.keyCode||"KeyH"==b.data.domEvent.$.code||"h"==b.data.domEvent.$.key){if(m&&r)return L(c,d,!1),!0}else if(86==b.data.keyCode||"KeyV"==b.data.domEvent.$.code||"v"==b.data.domEvent.$.key){if(m&&r)return I(c,d,!1),!0}else if(74==b.data.keyCode||"KeyJ"==b.data.domEvent.$.code||"j"==b.data.domEvent.$.key){if(m&&r)return D(c,d,!1),!0}else if(66==b.data.keyCode||"KeyB"==b.data.domEvent.$.code||"b"==b.data.domEvent.$.key){if(m&&
r)return z(c,d,!1),!0}else if(75==b.data.keyCode||"KeyK"==b.data.domEvent.$.code||"k"==b.data.domEvent.$.key){if(m&&r)return P(c,d,!1),!0}else if(78==b.data.keyCode||"KeyN"==b.data.domEvent.$.code||"n"==b.data.domEvent.$.key){if(m&&r)return O(c,d,!1),!0}else if(l&&(83==b.data.keyCode||"KeyS"==b.data.domEvent.$.code||"s"==b.data.domEvent.$.key)){if(m&&r)return E(d,!1,c),!0;if(r&&n)return c.execCommand("cellSplit"),!0}else if(!l||65!=b.data.keyCode&&"KeyA"!=b.data.domEvent.$.code&&"a"!=b.data.domEvent.$.key){if(l&&
(80==b.data.keyCode||"KeyP"==b.data.domEvent.$.code||"p"==b.data.domEvent.$.key))return m&&r?H(d,!1,c):c.execCommand("tableProperties"),!0;if(m&&8==g){g=c.document.getSelection().getRanges()[0];m=new POLARIS.dom.range(c.document);f=f.getAscendant("td",!0);if(null==f)return!1;m.selectNodeContents(f);m.setEnd(g.startContainer,g.startOffset);for(g=new POLARIS.dom.walker(m);m=g.previous();)if(m.type!=POLARIS.NODE_TEXT||0!=m.getLength())return!1;return c.execCommand("rowDelete")}}else if(m&&r)return J(d,
!1,c),!0}else if(r&&n){if((g=c.getCommand("cellMerge"))&&g.state!=POLARIS.TRISTATE_DISABLED)"td[colspan,rowspan]","td[colspan,rowspan]",!0,ba(K),w=A(c.document.getSelection()),p(w,!0);else{q=M.getAscendant("table");if(!q)return!1;f=POLARIS.tools.buildTableMap(q);g=k(d);for(y=count=0;y<q.$.rows.length;y++)count+=q.$.rows[y].children.length;g.length==count&&("td[colspan,rowspan]","td[colspan,rowspan]",!0,ba(K),w=A(c.document.getSelection()),p(w,!0))}c.fire("change");c.fire("contentChange",{type:"tableresize"});
return!0}g=ga(d);!m||67!=b.data.keyCode&&"KeyC"!=b.data.domEvent.$.code&&"c"!=b.data.domEvent.$.key?m&&(88==b.data.keyCode||"KeyX"==b.data.domEvent.$.code||"x"==b.data.domEvent.$.key)&&g&&(T=0,Z(c)):g&&(T=0,Z(c));q||V();return!q&&g?(T=0,V(),(g=d.getRanges()[0])&&g.moveToLeafElementEditablePosition(f),g&&g.select(),!0):!1}function Oa(a,b){var c=a.document.getSelection().getStartElement(),d=U(c),c=d[0],d=d[1];b.returnValue=0==b.type?d:c;return!0}function xa(a,b){var c=a.document.getSelection().getStartElement();
if("TableBorder"!=b.scope&&"AllCellBorder"!=b.scope&&"SelectedCellsBorder"==b.scope)for(var d in b.style){var e=c.getAscendant("td",!0);e||(e=fa);e&&e.setStyle(d,b.style[d])}else if(c)for(var e=c.getAscendant("table"),c=POLARIS.tools.buildTableMap(e),f=0;f<c.length;f++)for(var g=c[f],h=0;h<g.length;h++)if(g[h])for(d in e=new POLARIS.dom.element(g[h]),b.style)e.setStyle(d,b.style[d])}function qa(a,b){var c=a.document.getSelection();1==b.Merge&&A(a.document.getSelection());var d=b.Cols,e=b.Rows,f;f=
fa&&Y?k(c,"field"):k(c);if(0!=f.length){1!=b.Merge&&clearSeletedCell();for(var g=0;g<f.length;g++){var h=f[g],l=parseInt(h.getAttribute("colspan")?h.getAttribute("colspan"):0),n=new POLARIS.dom.range(a.document),p=h.find("table");if(p&&0<p.count()){for(var r,p=0;p<h.getChildCount();p++){var q=h.getChild(p);if(q&&q.is("p")){r=q;break}}r&&n.selectNodeContents(r)}else n.selectNodeContents(h);n.select();c=a.document.getSelection();p=h.$.style.width.replace(/((?:\d*\.\d+)|(?:\d+))(\w*)/g,function(a,b,
c){return Math.max(1,b)/d});if(1<d&&1<e){for(var z=1;z<d;z++)G(c,!1,p);for(n=1;n<e;n++)m(c,!1)}else if(1<d)for(z=1;z<d;z++)G(c,!1,p);else if(1<e)for(z=1;z<e;z++){var v=function(a,b){if(1<b.$.rowSpan){var d=new POLARIS.dom.range(a.document);d.selectNodeContents(b);d.select();c=a.document.getSelection();d=B(c);z++;1<b.$.rowSpan&&v(a,b);1<d.$.rowSpan&&v(a,d);return d}return null},q=B(c),D=q.find("table"),u=D.count();if(D&&0<u)for(var w=0;w<u;w++)(p=D.getItem(w))&&p.remove();q&&1<q.$.rowSpan&&(p=v(a,
q),null==p||1==p.$.rowSpan)&&(n.selectNodeContents(h),n.select(),c=a.document.getSelection())}if(2>l&&(p=h.getAscendant("table"),l=POLARIS.tools.buildTableMap(p),n=h.getParent().$.rowIndex,h=t(l,n,h),(l=(l=p.findOne("colgroup"))&&l.find("col"))&&1<l.count()))for(h=l.getItem(h),l=aa(h),l=la(l,d),h.setStyle("width",l[0]),z=1;z<d;z++)n=(new POLARIS.dom.element(h.$)).clone(),n.setStyle("width",l[z]),n.insertAfter(h)}}}function Ca(a,b,c){(b=b&&b.getStartElement())||(b=Y);if((M=b.getAscendant("td",!0)||
b.getAscendant("th",!0))&&M.getAscendant({td:1,th:1},!0)){if(3==T)return!0;var d=U(M);b=M.getAscendant("table");var e=POLARIS.tools.buildTableMap(b),f=d[0],d=d[1],g=parseInt(M.getAttribute("colspan"),10)||1,h=parseInt(M.getAttribute("rowspan"),10)||1;38==c||40==c?f=38==c?f-1:f+h:(("rtl"==a.lang.dir?39==c:37==c)?(--d,0>d&&0<f&&(d=e[f].length-1,--f)):(d+=g,d>e[f].length-1&&(f+1>e.length-1?d=e[f].length-1:(f+=1,d=0))),0>d&&(d=0));0>f&&(f=0);f>e.length-1&&(f=e.length-1);a=e[f];var k,l;a&&(k=a[d]);k?(l=
new POLARIS.dom.element(k),R(l,l,T)):38==c?b.hasPrevious()&&(l=b.getPrevious()):b.hasNext()&&(l=b.getNext());ba(l);K||(K=l);M=l;1==T&&(K=M);0==T?(V(),p(l,!1,!0),Y=fa=l):(R(K,M,T),p(M,!1,!0),fa=K,Y=M);return!0}}function W(b,c){var d=b.elementPath(),e=(d&&d.contains({td:1,th:1},1)).getAscendant("table"),d=e;(e=e.getAscendant("div"))&&"absolute"==e.getStyle("position")&&(d=e);var e=a(d),f=c.HorzRelTo,g=c.HorzAlign,h=c.HorzOffset,h=POLARIS.tools.convertMmTopx(h/PolarisEditor.UNIT.HWPUNIT),k=a(d.getAscendant("table")),
l=0;3==f&&(f=b.document.find("[doc-data-role\x3dpolaris-page-body]"),k=a(f.getItem(0)));0==g?l=0:1==g?l=k/2-e/2:2==g&&(l=k-e);d.setStyle("left","0px");d.setStyle("margin-left",l+h+"px")}function sa(a,b,c){function d(a){var b=a.getStyle("border"),c=a.getStyle("border-style"),e=a.getStyle("border-left"),f=a.getStyle("border-top"),g=a.getStyle("border-right");a=a.getStyle("border-bottom");b=b.split(" ");if(0<b.length&&(width=parseFloat(b[0]),!isNaN(width)&&0!=width))return!1;b=c.split(" ");if(0<b.length&&
(width=parseFloat(b[0]),!isNaN(width)&&0!=width))return!1;b=e.split(" ");if(0<b.length&&(width=parseFloat(b[0]),!isNaN(width)&&0!=width))return!1;b=f.split(" ");if(0<b.length&&(width=parseFloat(b[0]),!isNaN(width)&&0!=width))return!1;b=g.split(" ");if(0<b.length&&(width=parseFloat(b[0]),!isNaN(width)&&0!=width))return!1;b=a.split(" ");return 0<b.length&&(width=parseFloat(b[0]),!isNaN(width)&&0!=width)?!1:!0}var e=c.checkDirty();if(!a.hasClass("polaris_table_border")||!b){if(b){var f=POLARIS.tools.buildTableMap(a);
for(b=0;b<f.length;b++)for(var g=f[b],h=0;h<g.length;h++)if(g[h]){var k=new POLARIS.dom.element(g[h]);d(k)&&k.addClass("polaris_table_border")}d(a)&&a.addClass("polaris_table_border")}else for(a.removeClass("polaris_table_border"),a=a.find(".polaris_table_border"),b=0;b<a.count();b++)a.getItem(b).removeClass("polaris_table_border");a=c.checkDirty();!e&&a&&c.resetDirty()}}function ha(a,b){var c;c=a instanceof POLARIS.dom.element?a.clone(!0):(new POLARIS.dom.element(a)).clone(!0);b&&(c.removeAttribute("rowSpan"),
c.removeAttribute("doc-data-field"),c.removeAttribute("doc-data-value"),c.removeAttribute("doc-data-role"),c.removeAttribute("contenteditable"));var d=c.getChild(0);if(d)for(;d;){var e=d.getParent();d.type==POLARIS.NODE_TEXT?e.setText(d.getText()):e.setHtml(d.getOuterHtml());d=e.getChild(0);if(d.type!=POLARIS.NODE_ELEMENT){e=d.getParent();e.setHtml("​");break}else if(d.is("p")?b&&d.removeAttribute("contenteditable"):d.is("span")&&b&&d.removeAttribute("contenteditable"),!d.getChild(0)){d.is("br")||
d.setHtml("\x26nbsp;");break}d=d.getChild(0)}else c.setText(""),c.appendBogus();return c}function ya(a,b){var c=function(b,c){if(c){if(b.hasClass("polaris_table_border")){b.addClass("polaris_show_border");var d=a.document.getSelection(),e=a.document.getById("polarisSelector");POLARIS.env.ie&&null!=e&&POLARIS.plugins.tabletools.isTableSelected(d)&&(d=d.getSelectedElement())&&(d=d.getDocumentPosition(),e.setStyle("top",parseInt(d.y)+"px"))}}else b.removeClass("polaris_show_border")};if(a.getCommand("showTableBorder").state==
POLARIS.TRISTATE_OFF)if(null!=b&&void 0!=b){var d=b.getAscendant("table",!1);if(Q&&d){var e=Q.getAscendant("table",!1);e&&e.$!=d.$&&(sa(e,!1,a),c(e,!1))}d&&sa(d,!0,a);d&&c(d,!0)}else if(Q)(d=Q.getAscendant("table",!1))&&sa(d,!1,a),d&&c(d,!1);else{d=a.document.find(".polaris_table_border");for(e=0;e<d.count();e++){var f=d.getItem(e);f.removeClass("polaris_table_border")}d=a.document.find(".polaris_show_border");for(e=0;e<d.count();e++)f=d.getItem(e),c(f,!1)}a.fire("showTableBorder")}function Da(a,
b){var c=b.getStartElement();if(null!=c&&(c=c.getAscendant("table",!0),"polaris-table-paginated"==c.getAttribute("doc-data-role")&&(c=c.getAttribute("doc-data-value"),c=a.document.find('table[doc-data-value\x3d"'+c+'"]'),1<c.count()))){var d=b.createBookmarks();a.plugins.pagination.mergeSplitRows(c);b.selectBookmarks(d)}}var wa=/^(?:td|th)$/,ia=POLARIS.tools.cssLength,ta=!1,ca=!1,ja=!1,K,M,fa,Y,Q,ma=!1;za.prototype={exec:function(a){1==da()&&(a.getCommand("verticalAlignTop").setState(POLARIS.TRISTATE_OFF),
a.getCommand("verticalAlignMiddle").setState(POLARIS.TRISTATE_OFF),a.getCommand("verticalAlignBottom").setState(POLARIS.TRISTATE_OFF),a=a.document.getSelection(),pa(this.value,a),this.setState(POLARIS.TRISTATE_ON))},startDisabled:!0};var T=0;POLARIS.plugins.tabletools={requires:"table,dialog,contextmenu",icons:"rowinsertbefore,rowinsertafter,rowdelete,columninsertbefore,columninsertafter,columndelete,cellverticalsplit,cellhorizontalsplit,cellproperties,verticalaligntop,verticalalignmiddle,verticalalignbottom,columnsum,columnaverage,rowsum,rowaverage,columnmultiply,rowmultiply,addComma,cellblocksum,cellblockaverage,cellblockmultiply,sort,cellborder,cellsplit,cellmerge,cellmergecancel,cellinsert,celldelete,tablestyle,blockcalc,simplecalc,thousandanize",
init:function(f){function g(a){return POLARIS.tools.extend(a||{},{contextSensitive:1,refresh:function(a,b){var c=POLARIS.TRISTATE_DISABLED;if(b.contains({td:1,th:1,table:1},1))switch(c=a.document.getSelection(),this.name){case "rowinsertbefore":c=m(c,!0,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "rowinsertafter":c=m(c,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "columninsertbefore":c=q(c,!0,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "columninsertafter":c=
q(c,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellmerge":c=A(c,null,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellmergecancel":c=d(c)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellverticalsplit":c=B(c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellhorizontalsplit":c=G(c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "verticalaligntop":c=pa("top",c,!0)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;break;case "verticalalignmiddle":c=
pa("middle",c,!0)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;break;case "verticalalignbottom":c=pa("bottom",c,!0)?POLARIS.TRISTATE_ON:POLARIS.TRISTATE_OFF;break;case "columnsum":c=I(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "rowsum":c=L(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "columnaverage":c=z(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "rowaverage":c=D(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "columnmultiply":c=
O(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "rowmultiply":c=P(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "addcomma":c=S(a,c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "removecomma":c=N(c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellblocksum":c=E(c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellblockaverage":c=J(c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellblockmultiply":c=
H(c,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellinsert":case "celldelete":c=1==k(c).length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellsplit":c=d(c)?POLARIS.TRISTATE_DISABLED:POLARIS.TRISTATE_OFF;break;case "simplecalc":c=1==k(c).length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "thousandanize":c=POLARIS.TRISTATE_OFF;break;case "blockcalc":c=1<k(c).length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "applyForEachCell":case "applyAsSingleCell":case "cellBorder":c=
1<k(c).length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellproperties":c=0<k(c).length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;case "cellclear":c=0<k(c).length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED;break;default:c=POLARIS.TRISTATE_OFF}else if("cellproperties"==this.name)return;switch(this.name){case "tabledeleterow":case "tableinsertupperrow":case "tableinsertlowerrow":case "tableappendrow":case "tablesplitcellrow2":case "tablesplitcellaction":case "tableleftcell":case "tablerightcell":case "tableuppercell":case "tablelowercell":c=
POLARIS.TRISTATE_ON}this.setState(c)}})}function h(a){f.fire("lockSnapshot");Z(a.editor);M=K=Q;f.fire("unlockSnapshot")}function t(a,b){var c=f.addCommand(a,b);f.addFeature(c)}var u=f.lang.table;f.on("fieldDelete",function(a){if(fa&&Y){for(var b=l(fa,Y),c=0;c<b.length;c++){a=new POLARIS.dom.range(b[c].getDocument());a.selectNodeContents(b[c]);a=new POLARIS.dom.walker(a);a.guard=function(a){return!a.equals(b[c])};for(var d=null,e=null;e=a.next();)e.type==POLARIS.NODE_TEXT&&(null==d?(d=e,e.setText(" ")):
e.setText(""));b[c].appendBogus()}return!0}return!1});f.on("contentDom",function(a){f.setKeystroke([[122,"tableselect"],[POLARIS.ALT+45,"openInsertCellsDlg"],[POLARIS.ALT+46,"openDeleteCellsDlg"],[POLARIS.CTRL+13,"rowInsertWithShotcut"]]);f.document.on("keyup",function(a){37<=a.data.getKey()&&40>=a.data.getKey()&&(a=(a=f.document.getSelection().getStartElement())?a.getAscendant({td:1,th:1},!0):null,ya(f,a))})});POLARIS.dialog.add("insertcell",this.path+"dialogs/insertcell.js");f.addCommand("openInsertCellsDlg",
{exec:function(a){var b=k(a.document.getSelection());0!=b.length&&(b=(b=b[0])&&b.getAscendant("table"),POLARIS.tools.isInEditableElement(a,b)&&a.openDialog("insertcell"))},canUndo:!1,editorFocus:1});POLARIS.dialog.add("deletecell",this.path+"dialogs/deletecell.js");f.addCommand("openDeleteCellsDlg",{exec:function(a){var b=k(a.document.getSelection());0!=b.length&&(b=(b=b[0])&&b.getAscendant("table"),POLARIS.tools.isInEditableElement(a,b)&&a.openDialog("deletecell"))},canUndo:!1,editorFocus:1});f.on("beforeGetData",
function(a){V()});f.on("afterUndo",h);f.on("afterRedo",h);f.on("setData",function(){Y=fa=Q=null});f.on("mouseup",function(a){a=(a=a.data.element)?a.getAscendant({td:1,th:1},!0):null;ya(f,a)});f.on("selectionChange",function(a){if(a=f.document.getSelection().getStartElement())Q=(a=a.getAscendant({td:1,th:1,table:1},!0))?a:null});f.on("afterPaste",function(a){var b=f.document.getSelection().getStartElement(),c=b&&b.getAscendant({table:1},!0),d=a.data.dataValue.indexOf("\x3ctable");a=a.data.isPasteInTable;
if(0<=d&&null!=c&&void 0!=c){var d=POLARIS.tools.buildTableMap(c),e=d.length-1,g=d[e].length-1;d[e][g]&&!a&&(a=new POLARIS.dom.element(d[e][g]),p(a,!0));a=c.getNext();if(null==a||a.type!=POLARIS.NODE_ELEMENT||!a.is("p"))if(b=b&&b.getAscendant("p",!0)){b=b.clone(!0);if((a=b.getTextBrNodes())&&0<a.length)for(d=0;d<a.length;d++)e=a[d],0==d?e.setText("​"):e.setText("");""!=b.getStyle("text-align")&&b.setStyle("text-align","left");b.insertAfter(c)}}});f.on("mousedownleft",function(a){ka();Z(f);a=a.data.element;
var b=a.getAscendant({table:1},!0);if(null==b)return T=0,null!=c&&void 0!=c||0!=ja||V(),!1;switch(f.config.editMode){case 0:return;case 2:if(b.isReadOnly())return T=0,null!=c&&void 0!=c||0!=ja||(M=K=null),!1}var c=a.getAscendant({td:1,th:1},!0);null!=c&&void 0!=c&&0==ja?(M=K=c,c=K.getAscendant("table"),POLARIS.tools.buildTableMap(c),ja=!0):null!=c&&void 0!=c||0!=ja||(M=K=null);T=0});f.on("mousedownright",function(a){ka();a=a.data.element.getAscendant({td:1,th:1},!0);null!=a&&void 0!=a&&0==ja?void 0!=
K&&void 0!=M?K.equals(M)?M=K=a:p(a,!0,!0):void 0==K&&void 0==M&&(M=K=a):null!=a&&void 0!=a||0!=ja||(1==ma&&ba(K),M=K=null)});f.on("mouseup",function(a){1==ja&&((ja=!1,K.equals(M))?a.data.element&&!a.data.element.hasAscendant("table")&&(p(M,!0,!0),R(M,M,1)):(f.document.getSelection().removeAllRanges(),p(M,!0,!0)))});f.on("mousemove",function(a){a=a.data.element.getAscendant({td:1,th:1},!0);if(null!=a&&void 0!=a&&1==ja&&!M.equals(a)){var b=a.getAscendant("table",1);switch(f.config.editMode){case 0:return;
case 2:if(b.isReadOnly())return!1}var c=K.getAscendant("table",1);void 0!=b&&null!=b&&void 0!=c&&null!=c&&c.equals(b)&&(b.hide(),ba(a),R(K,a),M=a,T=2,b.show())}});f.on("key",function(a){ka();var b=f.document.getSelection(),c=b&&b.getStartElement(),b=c&&c.getAscendant("table",!0);if(116==a.data.keyCode&&!POLARIS.tools.isInEditableElement(f,b))a.data.domEvent.preventDefault();else if(Ja(a))a.data.domEvent.preventDefault();else if(46==a.data.keyCode||8==a.data.keyCode){if(da())for(a=l(K,M),c=0;c<a.length;c++)a[c].$.textContent=
"",a[c].appendBogus()}else if(37==a.data.keyCode||39==a.data.keyCode){var d=(b=f.document.getSelection())&&b.getStartElement(),e=b.getRanges()[0],c=37==a.data.keyCode;if(d&&d.getAscendant({td:1,th:1},!0)){var b=k(b,"text"),g=U(b[0]),b=b[0].getAscendant("table"),h=POLARIS.tools.buildTableMap(b);POLARIS.env.chrome&&e&&e.collapsed&&e[c?"checkStartOfBlock":"checkEndOfBlock"]()&&(c?(c=h[0][0]?new POLARIS.dom.element(h[0][0]):null)&&"function"===typeof c.getFirst().contains&&c.getFirst().contains(e.startContainer)&&
a.data.domEvent.preventDefault():e.checkBoundaryOfElement(b,POLARIS.END)&&a.data.domEvent.preventDefault())}else if(POLARIS.env.chrome&&e&&e.collapsed&&e[c?"checkStartOfBlock":"checkEndOfBlock"]()&&(d=(d=(d=e.startPath())?d.block:void 0)?d[c?"getPrevious":"getNext"](POLARIS.dom.walker.whitespaces(!0)):void 0)&&d.type==POLARIS.NODE_ELEMENT&&d.is("table")){var d=POLARIS.tools.buildTableMap(d),e=c?d.length-1:0,g=c?d[e].length-1:0,m=d[e][g];m&&p(new POLARIS.dom.element(m));a.data.domEvent.preventDefault()}}else if(38==
a.data.keyCode||40==a.data.keyCode)if(b=f.document.getSelection(),e=b.getRanges()[0],d=b&&b.getStartElement(),c=38==a.data.keyCode,d&&d.getAscendant({td:1,th:1},!0)){b=k(b,"text");if(POLARIS.env.chrome&&e&&(g=new POLARIS.dom.range(e.document),c?(g.setStartAt(b[0],POLARIS.POSITION_AFTER_START),g.setEnd(e.startContainer,e.startOffset)):(g.setStart(e.endContainer,e.endOffset),g.setEndAt(b[0],POLARIS.POSITION_BEFORE_END)),e=new POLARIS.dom.walker(g),g=c?"previous":"next",e.evaluator=function(a){return a.type==
POLARIS.NODE_ELEMENT&&(a.is("br")||a.is("p"))},e[g]())){if(c)return;e.evaluator=function(a){return a.type==POLARIS.NODE_TEXT||a.type==POLARIS.NODE_ELEMENT};if(e[g]())return}g=U(b[0]);b=b[0].getAscendant("table");h=POLARIS.tools.buildTableMap(b);e=g[0];g=g[1];(e=h[c?e-1:e+1])&&(m=e[g]);if(m){d=new POLARIS.dom.element(m);if(POLARIS.env.ie&&0<d.getChildCount())return;p(d,c)}else{c?b.hasPrevious()&&(d=b.getPrevious()):b.hasNext()&&(d=b.getNext());if(POLARIS.env.ie&&0<d.getChildCount())return;"table"==
d.getName()?(d=POLARIS.tools.buildTableMap(d),(c=d[c?d.length-1:0][0])&&p(new POLARIS.dom.element(c))):p(d,!c)}a.data.domEvent.preventDefault()}else POLARIS.env.chrome&&e&&(d=(d=(d=e.startPath())?d.block:void 0)?d[c?"getPrevious":"getNext"](POLARIS.dom.walker.whitespaces(!0)):void 0)&&d.type==POLARIS.NODE_ELEMENT&&d.is("table")&&(d=POLARIS.tools.buildTableMap(d),(m=d[c?d.length-1:0][0])&&p(new POLARIS.dom.element(m)),a.data.domEvent.preventDefault())},null,null,1);f.on("objectresize",function(b){var c;
c=b.data.element;if(!c||c.type===POLARIS.NODE_ELEMENT&&c.is("table")){var d,g;d=b.data.prevRect;g=b.data.currRect;k<g.width&&(g.width=k);var h=[];b=g.width/d.width;d=g.height/d.height;var k;if(f.config.wordprocessor)k=POLARIS.tools.getPageContentsSize(this).width;else{k=f.document.getBody();g=k.getSize("width");var l=parseFloat(k.getStyle("margin-left"))||0,m=parseFloat(k.getStyle("margin-right"))||0,n=parseFloat(k.getStyle("padding-left"))||0;k=parseFloat(k.getStyle("padding-right"))||0;k=g-(l+m+
n+k)}g=a(c)||c.$.offsetWidth;k<g*b&&(b=k/g);if(c.hasAttribute("doc-data-value")&&"polaris-table-paginated"==c.getAttribute("doc-data-role")){var p;g=c.getAttribute("doc-data-value");k=c.getAscendant("body",1);c=k.find('table[doc-data-value\x3d"'+g+'"]');n=0;for(p=c.count();n<p;n++)h.push(c.getItem(n))}else h.push(c);c=0;for(k=h.length;c<k;c++){l=0;g=h[c];g.hasAttribute("width")&&g.removeAttribute("width");g.getStyle("width")&&g.removeStyle("width");g.hasAttribute("height")&&g.removeAttribute("height");
g.getStyle("height")&&g.removeStyle("height");if(m=v(g)){var q;q=m.find("col");n=0;for(p=q.count();n<p;n++){var z=q.getItem(n),m=Math.round((aa(z)||z.$.offsetWidth)*b),l=l+m;z.setStyle("width",m)}z.hasAttribute("width")&&z.removeAttribute("width")}p=[];var t,n=g.find("td");q=0;for(t=n.count();q<t;q++){var u=n.getItem(q),m={};m.width=a(u)||u.$.offsetWidth;m.height=u.$.offsetHeight||e(u);p.push(m)}q=0;for(t=n.count();q<t;q++){var u=n.getItem(q),D,m=Math.round(p[q].width*b);D=Math.round(p[q].height*
d);u.removeAttribute("width");u.removeAttribute("height");u.setStyle("width",m);u.setStyle("height",D)}m=g.find("tr");for(n=0;n<m.count();n+=1)p=m.getItem(n),p.removeStyle("width"),p.removeStyle("height"),p.removeAttribute("width"),p.removeAttribute("height");n=m=0;m=l||a(g)||g.$.offsetWidth;n=g.$.offsetHeight||e(g);g.setStyle("width",m);g.setStyle("height",n);r(g)}}});f.on("doubleclick",function(a){var b=f.getSelection().getRanges()[0];if((a=a.data.element)&&!a.is("img")&&b){var c=a.getAscendant("td",
!0);c&&c.isEditable()&&0===c.getText().replace(/\u200B|\n$/g,"").length&&(b.moveToElementEditablePosition(a,!0),b.select())}});f.addCommand("getFieldDragElements",{readOnly:1,exec:function(a,b){b.fieldDragStartCellElement=fa;b.fieldDragEndCellElement=Y}});t("cellProperties",new POLARIS.dialogCommand("cellProperties",g({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",startDisabled:!0,requiredContent:"table"})));POLARIS.dialog.add("cellProperties",
this.path+"dialogs/tableCell.js");t("generalCellProperties",g({requiredContent:"table",startDisabled:!0,exec:function(a){ca=ta=!1;a.execCommand("cellProperties")}}));t("applyForEachCell",g({requiredContent:"table",startDisabled:!0,exec:function(a){ta=!1;ca=!0;a.execCommand("cellProperties")}}));t("applyAsSingleCell",g({requiredContent:"table",startDisabled:!0,exec:function(a){ta=!0;ca=!1;a.execCommand("cellProperties")}}));t("cellSplit",new POLARIS.dialogCommand("cellSplit",g({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",
startDisabled:!0,requiredContent:"table"})));POLARIS.dialog.add("cellSplit",this.path+"dialogs/cellSplit.js");t("deleteTable",new POLARIS.dialogCommand("deleteTable"));POLARIS.dialog.add("deleteTable",this.path+"dialogs/deleteTable.js");t("rowDelete",g({requiredContent:"table",startDisabled:!0,exec:function(a){ba(K);var c=a.document.getSelection();a.config.wordprocessor&&Da(a,c);(a=n(c))&&p(a,!0);if(a=a.getAscendant("table",!0))if(c=b(a),0<c&&(a.removeAttribute("height"),a.setStyle("height",c)),a=
a.find("td[rowspan]"))for(c=0;c<a.count();c++){var d=a.getItem(c);1<parseInt(d.getAttribute("rowspan"))&&(d.removeAttribute("height"),d.removeStyle("height"))}}}));t("rowInsertBefore",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();a.config.wordprocessor&&Da(a,b);m(b,!0)}}));t("rowInsertWithShotcut",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection(),b=(b=b&&b.getStartElement())&&b.getAscendant("table",!0);POLARIS.tools.isInEditableElement(a,
b)&&a.execCommandAbs("rowInsertAfter")}}));t("rowInsertAfter",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();fa&&Y?m(b,!1,void 0,"field"):(a.config.wordprocessor&&Da(a,b),m(b,!1))}}));t("TableInsertUpperRow",g({startDisable:!1,requiredContent:"table",exec:function(a){a=a.document.getSelection();m(a,!0)}}));t("TableInsertLowerRow",g({startDisable:!1,requiredContent:"table",exec:function(a){a=a.document.getSelection();fa&&Y?m(a,!1,void 0,"field"):m(a,!1)}}));
t("TableAppendRow",g({startDisable:!1,requiredContent:"table",exec:function(a){for(var b=(a=(a=a.document.getSelection())&&a.getStartElement())&&a.getDocument(),c=(a=(a=(a=a&&a.getAscendant("table",1))&&POLARIS.tools.buildTableMap(a))&&a[a.length-1])?a.length:0,d=null,b=b&&b.createElement("tr"),e=null,f=0,g=0,f=0;f<c;f+=1)0===f&&(d=(new POLARIS.dom.element(a[f])).getParent()),e=ha(a[f],!0),g=Number(e.getAttribute("rowspan")),1<g&&e.setStyle("height",POLARIS.tools.convertToPx(e.getStyle("height"))/
g+"px"),b.append(e);b.insertAfter(d);(a=b&&b.getChild(0))&&p(a)}}));t("TableSplitCellRow2",g({startDisable:!1,allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(a){a=B(a.document.getSelection());p(a)}}));t("TableDeleteRow",g({startDisable:!1,requiredContent:"table",exec:function(a){a=a.document.getSelection();ba(K);fa&&Y?(a=k(a,"field"),a=new POLARIS.dom.selection(a[0].getParent()),a=n(a,"field"),Y=fa=null):a=n(a);a&&p(a,!0)}}));t("TableSplitCellAction",g({requiredContent:"table",
exec:qa}));t("columnDelete",g({requiredContent:"table",startDisabled:!0,exec:function(a){ba(K);var b=a.document.getSelection();a.config.wordprocessor&&Da(a,b);b=k(b);a=b[0].getAscendant("table");var d=POLARIS.tools.buildTableMap(a),b=na(b,d),e,f,g=[];e=b.col.startIndex;f=b.col.endIndex;var h=a.findOne("colgroup");if(h){var l=h&&h.find("col");if(l&&0<l.count())for(h=e;h<=f;h++){var m=l.getItem(h);m&&m.remove()}}for(h=e;h<=f;h++)for(j=0;j<d.length;j++)m=d[j],l=new POLARIS.dom.element(a.$.rows[j]),m=
new POLARIS.dom.element(m[h]),m.$&&(1==m.$.colSpan?m.remove():--m.$.colSpan,j+=m.$.rowSpan-1,l.$.cells.length||g.push(l));d=a.$.rows[0]&&a.$.rows[0].cells;d=new POLARIS.dom.element(d[e]||(e?d[e-1]:a.$.previousSibling)||a.$.parentNode);g.length!=b.table.rowCount&&b.col.count!=b.table.colCount||a.remove();d&&p(d,!0);if(a=d.getAscendant("table",!0))if(b=c(a),0<b&&(a.removeAttribute("width"),a.setStyle("width",b)),a=a.find("td[colspan]"))for(b=0;b<a.count();b++)g=a.getItem(b),1<parseInt(g.getAttribute("colspan"))&&
(g.removeAttribute("width"),g.removeStyle("width"))}}));t("columnInsertBefore",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();a.config.wordprocessor&&Da(a,b);q(b,!0)}}));t("columnInsertAfter",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();a.config.wordprocessor&&Da(a,b);q(b,!1)}}));POLARIS.dialog.add("clearcell",this.path+"dialogs/clearcell.js");t("cellClear",g({startDisabled:!0,requiredContent:"table",canUndo:!1,
exec:function(a){var b=a.document.getSelection();if(0!=k(b).length){var c=k(b),d=na(c);ga(b)?C(c):d.isSelectedTableCol||d.isSelectedTableRow?a.openDialog("clearcell"):C(c)}}}));t("cellContentClear",g({startDisabled:!0,requiredContent:"table",canUndo:!1,exec:function(a){a=a.document.getSelection();0!=k(a).length&&(a=k(a),C(a))}}));t("TableMergeCell",g({readOnly:1,exec:function(a){fa&&Y?a=A(a.document.getSelection(),null,!1,"field"):(ba(K),a=A(a.document.getSelection(),null,!1),p(a,!0))}}));t("cellMerge",
g({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",startDisabled:!0,exec:function(a){ba(K);var b=A(a.document.getSelection());p(b,!0);a.fire("selectionChange",{selection:a.getSelection(),path:a.elementPath()})}}));t("cellMergeCancel",g({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",startDisabled:!0,exec:function(a){var b=x(a.document.getSelection());p(b);a.fire("selectionChange",{selection:a.getSelection(),path:a.elementPath()})}}));t("cellVerticalSplit",
g({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",startDisabled:!0,exec:function(a){a=B(a.document.getSelection());p(a)}}));t("cellHorizontalSplit",g({allowedContent:"td[colspan]",requiredContent:"td[colspan]",startDisabled:!0,exec:function(a){a=G(a.document.getSelection());p(a)}}));t("cellBlockSum",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.getSelection();E(b,!1,a)}}));t("cellBlockAverage",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.getSelection();
J(b,!1,a)}}));t("cellBlockMultiply",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.getSelection();H(b,!1,a)}}));t("columnSum",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();I(a,b)}}));t("rowSum",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();L(a,b)}}));t("columnAverage",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();z(a,b)}}));t("rowAverage",
g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();D(a,b)}}));t("columnMultiply",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();O(a,b)}}));t("rowMultiply",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();P(a,b)}}));t("addComma",g({requiredContent:"table",startDisabled:!0,exec:function(a){var b=a.document.getSelection();S(a,b)}}));t("removeComma",g({requiredContent:"table",
startDisabled:!0,exec:function(a){a=a.document.getSelection();N(a)}}));t("getTableCellAddr",g({requiredContent:"table",startDisabled:!0,exec:Oa}));t("changeCellBorder",g({requiredContent:"table",exec:xa}));t("tableSplitCell",g({requiredContent:"table",exec:qa}));t("selectionOnCurrentCursor",g({requiredContent:"table",exec:function(a){(a=(a=a.document.getSelection())&&a.getStartElement())?M=K=a.getAscendant("td",!0)||a.getAscendant("th",!0):(K=fa,M=Y);T=2;R(K,M,T);p(M,!1,!0)}}));t("SelectionOnFieldCell",
{requiredContent:"table",exec:function(a,b){if(b&&b){if(fa){var c=b.getAscendant("table",1),d=fa.getAscendant("table",1);c&&d&&d.equals(c)?R(fa,b):(fa&&ba(fa),R(b,b,2),fa=b)}else R(b,b,2),fa=b;Y=b}}});t("tableLeftCell",g({requiredContent:"table",exec:function(a){var b=a.document.getSelection();Ca(a,b,37)}}));t("tableUpperCell",g({requiredContent:"table",exec:function(a){var b=a.document.getSelection();Ca(a,b,38)}}));t("tableRightCell",g({requiredContent:"table",exec:function(a){var b=a.document.getSelection();
Ca(a,b,39)}}));t("tableLowerCell",g({requiredContent:"table",exec:function(a){var b=a.document.getSelection();Ca(a,b,40)}}));t("tablePropertyDialog",g({requiredContent:"table",exec:W}));t("cellInsert",g({startDisabled:!0,requiredContent:"table"}));t("cellDelete",g({startDisabled:!0,requiredContent:"table"}));t("simpleCalc",g({startDisabled:!0,requiredContent:"table"}));t("blockCalc",g({startDisabled:!0,requiredContent:"table"}));t("thousandanize",g({startDisabled:!0,requiredContent:"table"}));t("cellBorder",
g({startDisabled:!0,requiredContent:"table"}));var w=new za("top"),y=new za("middle"),F=new za("bottom");f.addCommand("verticalAlignTop",g(w));f.addCommand("verticalAlignMiddle",g(y));f.addCommand("verticalAlignBottom",g(F));f.addMenuItems&&f.addMenuItems({tablecell:{label:u.cell.menu,group:"tablecell",order:1,getItems:function(){var a=f.document.getSelection(),b=k(a);return{tablecell_merge:A(a,null,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecell_mergeCancel:d(a)?POLARIS.TRISTATE_OFF:
POLARIS.TRISTATE_DISABLED,tablecell_split:d(a)?POLARIS.TRISTATE_DISABLED:POLARIS.TRISTATE_OFF,sameCellWidth:Ba(!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,sameCellHeight:oa(!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecell_properties:0<b.length?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED}}},tablecell_clear:{label:u.cell.clearCell,group:"tablecell",order:2,command:"cellClear"},tablecell_background:{label:u.cellBorder,group:"tablecell",order:3,getItems:function(){return{cell_background_each:POLARIS.TRISTATE_OFF,
cell_background_single_cell:POLARIS.TRISTATE_OFF}}},tablecell_merge:{label:u.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_mergeCancel:{label:u.cell.mergeCancel,group:"tablecell",command:"cellMergeCancel",order:17},tablecell_split:{label:u.cellSplit,group:"tablecell",command:"cellSplit",order:18},tablecell_properties:{label:u.cell.title,group:"tablecellproperties",command:"generalCellProperties",order:21},tablerowcolumn_insert:{label:u.cellInsert,group:"tablerowcolumn",getItems:function(){var a=
f.document.getSelection();k(a);return{tablerow_insertBefore:m(a,!0,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablerow_insertAfter:m(a,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecolumn_insertBefore:q(a,!0,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecolumn_insertAfter:q(a,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED}}},tablerowcolumn_delete:{label:u.cellDelete,group:"tablerowcolumn",getItems:function(){var a=f.document.getSelection();k(a);return{tablerow_delete:POLARIS.TRISTATE_OFF,
tablecolumn_delete:POLARIS.TRISTATE_OFF}}},tablerow_insertBefore:{label:u.row.insertBefore,group:"tablerowcolumn",command:"rowInsertBefore"},tablerow_insertAfter:{label:u.row.insertAfter,group:"tablerowcolumn",command:"rowInsertAfter"},tablecolumn_insertBefore:{label:u.column.insertBefore,group:"tablerowcolumn",command:"columnInsertBefore"},tablecolumn_insertAfter:{label:u.column.insertAfter,group:"tablerowcolumn",command:"columnInsertAfter"},tablerow_delete:{label:u.row.deleteRow,group:"tablerowcolumn",
command:"rowDelete"},tablecolumn_delete:{label:u.column.deleteColumn,group:"tablerowcolumn",command:"columnDelete"},tableblockcalculation_sum:{label:u.cellBlockSum,group:"tableblockcalculation",command:"cellBlockSum",order:5},tableblockcalculation_average:{label:u.cellBlockAverage,group:"tableblockcalculation",command:"cellBlockAverage",order:10},tableblockcalculation_multiply:{label:u.cellBlockMultiply,group:"tableblockcalculation",command:"cellBlockMultiply",order:15},tablecalculation_rowsum:{label:u.calculation.sumRow,
group:"tablecalculation",command:"rowSum",order:5},tablecalculation_columnsum:{label:u.calculation.sumColumn,group:"tablecalculation",command:"columnSum",order:10},tablecalculation_rowaverage:{label:u.calculation.averageRow,group:"tablecalculation",command:"rowAverage",order:15},tablecalculation_columnaverage:{label:u.calculation.averageColumn,group:"tablecalculation",command:"columnAverage",order:20},tablecalculation_rowmultiply:{label:u.calculation.multiplyRow,group:"tablecalculation",command:"rowMultiply",
order:25},tablecalculation_columnmultiply:{label:u.calculation.multiplyColumn,group:"tablecalculation",command:"columnMultiply",order:30},tablethousand_addcomma:{label:u.thousand.addcomma,group:"tablethousand",command:"addComma",order:5},tablethousand_removecomma:{label:u.thousand.removecomma,group:"tablethousand",command:"removeComma",order:10},cell_background_each:{label:u.applyForEachCell,group:"tablecell",command:"applyForEachCell",order:22},cell_background_single_cell:{label:u.applyAsSingleCell,
group:"tablecell",command:"applyAsSingleCell",order:23}});f.contextMenu&&f.contextMenu.addListener(function(a,b,c){if(a&&b&&c){if(da(b)){if(2==f.config.editMode&&(a=c.contains({table:1},1))&&0<a.find("[doc-data-field]").count())return;c=c.contains({table:1,td:1,th:1},1);if(!c||c.getAscendant(function(a){if(a.getAttribute&&("polaris-page-header"==a.getAttribute("doc-data-role")||"polaris-page-footer"==a.getAttribute("doc-data-role"))&&"false"==a.getAttribute("contenteditable"))return!0}))return;if(c&&
c.isReadOnly()){if(0!=f.config.editMode)return{tablecell_properties:POLARIS.TRISTATE_OFF};return}return{tablecell:POLARIS.TRISTATE_OFF,tablecell_clear:POLARIS.TRISTATE_OFF,tablecell_background:POLARIS.TRISTATE_OFF,tablerowcolumn_insert:POLARIS.TRISTATE_OFF,tablerowcolumn_delete:POLARIS.TRISTATE_OFF}}return null}});f.ui.addButton&&(f.ui.addButton("RowDelete",{label:u.row.deleteRow,command:"rowDelete",toolbar:"tabletools,15"}),f.ui.addButton("RowInsertBefore",{label:u.row.insertBefore,command:"rowInsertBefore",
toolbar:"tabletools,5"}),f.ui.addButton("RowInsertAfter",{label:u.row.insertAfter,command:"rowInsertAfter",toolbar:"tabletools,10"}),f.ui.addButton("ColumnDelete",{label:u.column.deleteColumn,command:"columnDelete",toolbar:"tabletools,15"}),f.ui.addButton("ColumnInsertBefore",{label:u.column.insertBefore,command:"columnInsertBefore",toolbar:"tabletools,5"}),f.ui.addButton("ColumnInsertAfter",{label:u.column.insertAfter,command:"columnInsertAfter",toolbar:"tabletools,10"}),f.ui.addButton("CellMerge",
{label:u.cell.merge,command:"cellMerge",toolbar:"tabletools,16"}),f.ui.addButton("CellMergeCancel",{label:u.cell.mergeCancel,command:"cellMergeCancel",toolbar:"tabletools,17"}),f.ui.addButton("CellVerticalSplit",{label:u.cell.splitVertical,command:"cellVerticalSplit",toolbar:"tabletools,20"}),f.ui.addButton("CellHorizontalSplit",{label:u.cell.splitHorizontal,command:"cellHorizontalSplit",toolbar:"tabletools,19"}),f.ui.addButton("CellProperties",{label:u.cell.title,command:"generalCellProperties",
toolbar:"tabletools,21"}),f.ui.addButton("VerticalAlignTop",{label:u.cell.vAlignTop,command:"verticalAlignTop",toolbar:"tabletools,22"}),f.ui.addButton("VerticalAlignMiddle",{label:u.cell.vAlignMiddle,command:"verticalAlignMiddle",toolbar:"tabletools,23"}),f.ui.addButton("VerticalAlignBottom",{label:u.cell.vAlignBottom,command:"verticalAlignBottom",toolbar:"tabletools,24"}),f.ui.addButton("ColumnSum",{label:u.calculation.sumColumn,command:"columnSum",toolbar:"tabletools,25"}),f.ui.addButton("ColumnAverage",
{label:u.calculation.averageColumn,command:"columnAverage",toolbar:"tabletools,26"}),f.ui.addButton("RowSum",{label:u.calculation.sumRow,command:"rowSum",toolbar:"tabletools,27"}),f.ui.addButton("RowAverage",{label:u.calculation.averageRow,command:"rowAverage",toolbar:"tabletools,28"}),f.ui.addButton("ColumnMultiply",{label:u.calculation.multiplyColumn,command:"columnMultiply",toolbar:"tabletools,29"}),f.ui.addButton("RowMultiply",{label:u.calculation.multiplyRow,command:"rowMultiply",toolbar:"tabletools,30"}),
f.ui.addButton("AddThousandComma",{label:u.thousand.addcomma,command:"addComma",toolbar:"tabletools,31"}),f.ui.addButton("RemoveThousandComma",{label:u.removecomma,command:"removeComma",toolbar:"tabletools,32"}),f.ui.addButton("CellBlockSum",{label:u.cellBlockSum,command:"cellBlockSum",toolbar:"tabletools,33"}),f.ui.addButton("CellBlockAverage",{label:u.cellBlockAverage,command:"cellBlockAverage",toolbar:"tabletools,34"}),f.ui.addButton("Sort",{label:u.sort,command:"sort",toolbar:"tabletools,36"}),
f.ui.add("CellBorder",POLARIS.UI_MENUBUTTON,{label:u.cellBorder,title:u.cellBorder,command:"cellBorder",toolbar:"tabletools,37",onMenu:function(){return{cell_background_each:POLARIS.TRISTATE_OFF,cell_background_single_cell:POLARIS.TRISTATE_OFF}}}),f.ui.addButton("CellClear",{label:u.cell.clearCell,command:"cellClear",toolbar:"tabletools"}),f.ui.addButton("CellSplit",{label:u.cellSplit,command:"cellSplit",toolbar:"tabletools,38"}),f.ui.addButton("ApplyForEachCell",{label:u.applyForEachCell,command:"applyForEachCell",
toolbar:"tabletools,39"}),f.ui.addButton("ApplyAsSingleCell",{label:u.applyAsSingleCell,command:"applyAsSingleCell",toolbar:"tabletools,40"}),f.ui.add("CellInsert",POLARIS.UI_MENUBUTTON,{title:u.cellInsert,label:u.cellInsert,command:"cellInsert",toolbar:"tabletools,39",onMenu:function(){var a=f.document.getSelection();k(a);return{tablerow_insertBefore:m(a,!0,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablerow_insertAfter:m(a,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecolumn_insertBefore:q(a,
!0,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecolumn_insertAfter:q(a,!1,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED}}}),f.ui.add("CellDelete",POLARIS.UI_MENUBUTTON,{title:u.cellDelete,label:u.cellDelete,command:"cellDelete",toolbar:"tabletools,40",onMenu:function(){return{tablerow_delete:POLARIS.TRISTATE_OFF,tablecolumn_delete:POLARIS.TRISTATE_OFF}}}),f.ui.addButton("TableStyle",{label:u.tableStyle,command:"tableStyle",toolbar:"tabletools,41"}),f.ui.add("BlockCalc",POLARIS.UI_MENUBUTTON,
{title:u.blockCalc,label:u.blockCalc,command:"blockCalc",toolbar:"tabletools,42",onMenu:function(){var a=f.getSelection();return{tableblockcalculation_sum:E(a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_ON,tableblockcalculation_average:J(a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_ON}}}),f.ui.add("SimpleCalc",POLARIS.UI_MENUBUTTON,{title:u.simpleCalc,label:u.simpleCalc,command:"simpleCalc",toolbar:"tabletools,43",onMenu:function(){var a=f.document.getSelection();return{tablecalculation_columnsum:I(f,
a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecalculation_rowsum:L(f,a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecalculation_columnaverage:z(f,a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecalculation_rowaverage:D(f,a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecalculation_columnmultiply:O(f,a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,tablecalculation_rowmultiply:P(f,a,!0)?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED}}}),f.ui.add("Thousandanize",
POLARIS.UI_MENUBUTTON,{title:u.thousandanize,label:u.thousandanize,command:"thousandanize",toolbar:"tabletools,44",onMenu:function(){return{tablethousand_addcomma:POLARIS.TRISTATE_OFF,tablethousand_removecomma:POLARIS.TRISTATE_OFF}}}),f.ui.addButton("TableSumRow",{label:u.calculation.sumRow,command:"rowSum",toolbar:"tabletools,45"}),f.ui.addButton("TableSumColumn",{label:u.calculation.sumColumn,command:"columnSum",toolbar:"tabletools,46"}),f.ui.addButton("TableAverageRow",{label:u.calculation.averageRow,
command:"rowAverage",toolbar:"tabletools,47"}),f.ui.addButton("TableAverageColumn",{label:u.calculation.averageColumn,command:"columnAverage",toolbar:"tabletools,48"}),f.ui.addButton("TableMultiplyRow",{label:u.calculation.multiplyRow,command:"rowMultiply",toolbar:"tabletools,49"}),f.ui.addButton("TableMultiplyColumn",{label:u.calculation.multiplyColumn,command:"columnMultiply",toolbar:"tabletools,50"}),f.ui.addButton("TableAddComma",{label:u.thousand.addcomma,command:"addComma",toolbar:"tabletools,51"}),
f.ui.addButton("TableRemoveComma",{label:u.thousand.removecomma,command:"removeComma",toolbar:"tabletools,52"}))},getWidth:a,getHeight:e,getTableWidth:c,getTableHeight:b,hasSelectedCell:function(a){for(var b=!1,c=a.length,d=0;d<c;d++){var e=a[d];if(e&&e.is("table"))for(var e=e.find("td"),f=0;f<e.count();f++)e.getItem(f).hasClass("cell_selection")&&(b=!0);else e&&e.is("td")&&e.hasClass("cell_selection")&&(b=!0)}return b},getSelectedCells:k,unmarkSelectedCells:ba,markSelectedCells:R,clearSelectedFieldCell:ka,
clearSelectedCell:V,clearSelectedTables:Z,isSelectedCell:ea,getCellDrag:function(){return ja},getCellIndex:U,getCellsIndexInfo:na,getSelectedCellsIndex:function(a,b){var c=[],d=U(a);if(null==d||void 0==d)return c;var e=d[0],d=d[1],f=U(b);if(null==f||void 0==f)return c;var g=f[0],f=f[1],h=a.$.rowSpan||1,k=a.$.colSpan||1,l=b.$.rowSpan||1,m=b.$.colSpan||1;if(d>f){var n;n=d;d=f;f=n+k-1}else f=f+m-1;e>g?(n=e,e=g,g=n+h-1):g=g+l-1;c.push(e);c.push(d);c.push(h);c.push(k);c.push(g);c.push(f);c.push(l);c.push(m);
return c},setTableIndent:function(a,b,c){if(null!=K&&null!=M){var d=K.getAscendant("table",1);if(null==d)return!1;var e=parseInt(d.getStyle("margin-left"),10)||0;if(1==c)return 0==b&&0>=e?!1:!0;e=1==b?e+40:e-40;b=a.getCommand("tableOutdent");0>=e?(d.removeStyle("margin-left"),b.setState(POLARIS.TRISTATE_DISABLED)):(d.setStyle("margin-left",e+"px"),b.setState(POLARIS.TRISTATE_OFF),d.removeAttribute("align"),a.getCommand("tableLeft").setState(POLARIS.TRISTATE_OFF),a.getCommand("tableCenter").setState(POLARIS.TRISTATE_OFF),
a.getCommand("tableRight").setState(POLARIS.TRISTATE_OFF))}else if(1==c)return!1},setTableAlign:function(a,b,c){if(null!=K&&null!=M){var d=K.getAscendant("table",1);if(null==d)return!1;if(c)return d.getAttribute("align")==b?!0:!1;a.getCommand("tableLeft").setState(POLARIS.TRISTATE_OFF);a.getCommand("tableCenter").setState(POLARIS.TRISTATE_OFF);a.getCommand("tableRight").setState(POLARIS.TRISTATE_OFF);"center"==b?(a.getCommand("tableCenter").setState(POLARIS.TRISTATE_ON),d.setAttribute("align","center")):
"right"==b?(a.getCommand("tableRight").setState(POLARIS.TRISTATE_ON),d.setAttribute("align","right")):"left"==b&&(a.getCommand("tableLeft").setState(POLARIS.TRISTATE_ON),d.setAttribute("align","left"));d.removeStyle("margin-left");a.getCommand("tableOutdent").setState(POLARIS.TRISTATE_DISABLED)}},sameCellWidth:Ba,sameCellHeight:oa,existSelectedCell:da,placeCursorInTableCell:function(a){(a=POLARIS.tools.buildTableMap(a)[0][0])&&p(new POLARIS.dom.element(a))},getIsApplyAsSingleCell:function(){return ta},
getIsApplyForEachCell:function(){return ca},getDragStartCell:function(){return K},getDragEndCell:function(){return M},selectedCellIterator:function(a,b){var c=l(K,M);if(0<c.length)for(var d=0;d<c.length;d++)b(d,c[d]);return!!c.length},displayRedBorder:sa,isTableSelected:ga,getSplittedCellSize:la,getColWidth:aa,copyCustomDataToClipboard:h,addColgroup:v,placeCursorInCell:p};POLARIS.plugins.add("tabletools",POLARIS.plugins.tabletools)})();POLARIS.tools.buildTableMap=function(a){a=a.$.rows;for(var e=
-1,b=[],c=0;c<a.length;c++){e++;!b[e]&&(b[e]=[]);for(var d=-1,h=0;h<a[c].cells.length;h++){var g=a[c].cells[h];for(d++;b[e][d];)d++;var k=isNaN(g.colSpan)?1:g.colSpan,f=isNaN(g.rowSpan)?1:g.rowSpan;"polaris-spanned-td"==g.getAttribute("doc-data-role")&&(k=f=1);for(var l=0;l<f;l++){b[e+l]||(b[e+l]=[]);for(var m=0;m<k;m++)b[e+l][d+m]=a[c].cells[h],g.cellPosition=[e+l,d+m]}d+=k-1}}return b};(function(){function a(a){return a.getSize("width")}function e(a){var b=a.getStyle("width")?a.getStyle("width"):
a.getAttribute("width");b&&(-1<b.indexOf("pt")?b=POLARIS.tools.convertPtToPx(b):-1<b.indexOf("mm")?b=POLARIS.tools.convertMmTopx(parseFloat(b)):-1<b.indexOf("px")&&(b=parseFloat(b)));if(isNaN(b)||POLARIS.tools.isEmptyValue(b)||0==b)b=a.getSize("width");return parseFloat(b)}function b(a,b){var c=a.getComputedStyle("border-"+b+"-width"),d={thin:"0px",medium:"1px",thick:"2px"};0>c.indexOf("px")&&(c=c in d&&"none"!=a.getComputedStyle("border-style")?d[c]:1);return parseFloat(c,10)}function c(a){return a&&
"polaris-spanned-td"==a.getAttribute("doc-data-role")&&"none"==a.getStyle("display")?!0:!1}function d(a,d){for(var e=[],f=-1,g="rtl"==a.getComputedStyle("direction"),h,k=a.$.rows,l=0,m,n,q,y=0,F=k.length;y<F;y++){q=k[y];m=q.cells.length;var E=0,H=(new POLARIS.dom.element(q)).find("td");for(h=0;h<H.count();h++){var J=H.getItem(h);c(J)&&E++}m-=E;m>l&&(l=m,n=q)}h=n;l=k=null;null!=a.$.tBodies[0]&&(k=new POLARIS.dom.element(a.$.tBodies[0]),l=k.getDocumentPosition());q=n=null;null!=a.$.tHead&&(n=new POLARIS.dom.element(a.$.tHead),
q=n.getDocumentPosition());F=y=null;null!=a.$.tFoot&&(y=new POLARIS.dom.element(a.$.tFoot),F=y.getDocumentPosition());m=[];H=(H=(E=a.find("tr"))&&E.getItem(0))&&H.findOne("td");(H&&H.getAttribute("rowspan"))==E.count()&&H.$!=h.cells[0]&&m.push(H.$);if(h)for(E=0,H=h.cells.length;E<H;E++)m.push(h.cells[E]);h=[];J=a.find("[colspan]");E=0;for(H=J.count();E<H;E++){var I=J.getItem(E);h.push(I)}E=0;for(H=m.length;E<H;E++)if(J=new POLARIS.dom.element(m[E]),I=m[E+1]&&new POLARIS.dom.element(m[E+1]),!c(J)){var f=
f+(J.$.colSpan||1),L,z=J.getDocumentPosition().x;g?b(J,"left"):L=z+J.$.offsetWidth*d-b(J,"right");I?(z=I.getDocumentPosition().x,g?L=z+I.$.offsetWidth*d-b(I,"right"):b(I,"left")):(z=a.getDocumentPosition().x,g&&(L=z));pillarHeight=(n?n.$.offsetHeight*d:0)+(k?k.$.offsetHeight*d:0)+(y?y.$.offsetHeight*d:0);pillarTop=q?q.y:l?l.y:F.y;e.push({table:a,spannedTds:h,columnIndex:f,rowIndex:-1,x:L,y:pillarTop,width:3,height:pillarHeight,type:"col",rtl:g})}f=[];g=-1;L="rtl"==a.getComputedStyle("direction");
l=k=null;null!=a.$.tBodies[0]&&(k=new POLARIS.dom.element(a.$.tBodies[0]),l=k.getDocumentPosition());q=n=null;null!=a.$.tHead&&(n=new POLARIS.dom.element(a.$.tHead),q=n.getDocumentPosition());F=y=null;null!=a.$.tFoot&&(y=new POLARIS.dom.element(a.$.tFoot),F=y.getDocumentPosition());m=[];m=[];J=a.find("[rowspan]");E=0;for(H=J.count();E<H;E++)h=J.getItem(E),m.push(h);E=0;for(H=a.$.rows.length;E<H;E++){for(var z=a.$.rows[E],J=a.$.rows[E+1],D=null,I=null,O=0,P=Number.MAX_VALUE,O=0;O<z.childElementCount;O++){var X=
parseInt(z.cells[O].getAttribute("rowspan"),10)||1;h=new POLARIS.dom.element(z.cells[O]);X<P&&"none"!=h.getComputedStyle("display")&&(D=z.cells[O],P=X)}P=Number.MAX_VALUE;if(J)for(O=0;O<J.childElementCount;O++)X=parseInt(J.cells[O].getAttribute("rowspan"),10)||1,h=new POLARIS.dom.element(J.cells[O]),X<P&&"none"!=h.getComputedStyle("display")&&(I=J.cells[O],P=X);h=D&&new POLARIS.dom.element(D);J=J&&I&&new POLARIS.dom.element(I);null!=h&&(g+=1,h=h.getDocumentPosition().y+h.$.offsetHeight*d-b(h,"bottom"),
J?(J.getDocumentPosition(),b(J,"top")):a.getDocumentPosition(),pillarWidth=Math.max(n?n.$.offsetWidth*d:0,k?k.$.offsetWidth*d:0,y?y.$.offsetWidth*d:0),pillarLeft=q?q.x:l?l.x:F.x,f.push({table:a,spannedTds:m,columnIndex:-1,rowIndex:g,x:pillarLeft,y:h,width:pillarWidth,height:3,type:"row",rtl:L}))}g=0;for(L=f.length;g<L;g++)e.push(f[g]);return e}function h(a,b,c){for(var d=[],e=[],f=0,h=a.length;f<h;f++){var k=a[f];"col"==k.type?d.push(k):e.push(k)}for(var l=function(a,b){for(var c=0,d=0,e=b.length;d<
e;d++)if(b[d].y>a){c=d;break}return c},m=function(a,b){for(var c=0,d=0,e=b.length;d<e;d++)if(b[d].x>a){c=d;break}return c},f=0,h=a.length;f<h;f++){var k=a[f],n=k.x-2,q=k.y-2;if("col"==k.type&&b>=n&&b<=k.x+k.width+2&&!g(k.spannedTds,b,c,2))return k.rowIndex=l(c,e),k;if("row"==k.type&&c>=q&&c<=k.y+k.height+2&&!g(k.spannedTds,b,c,2))return k.columnIndex=m(b,d),k}return null}function g(a,b,c,d){for(var e=!1,f=0;f<a.length;f++){var g=a[f],h=g.getClientRect(),g=g.getDocumentPosition(),k=g.x+h.width-d,l=
g.y+d,h=g.y+h.height-d;if(b>g.x+d&&b<k&&c>l&&c<h){e=!0;break}}return e}function k(a){(a.data||a).preventDefault()}function f(d){function f(){B=0;u.setOpacity(0);y&&g();var a=x.table;setTimeout(function(){a.removeCustomData("_polaris_table_pillars")},0);C.removeListener("dragstart",k)}function g(){for(var f=x.rtl,h=f?E.length:F.length,k=x.table,l=[],m=0;m<h;m++){var p=F[m],r=E[m],q=I[m],u=L[m],q=p&&a(p),u=r&&a(r);c(p)&&(p=k.findOne('[doc-data-value\x3d"'+p.getAttribute("doc-data-value")+'"]'))&&(q=
a(p));c(r)&&(p=k.findOne('[doc-data-value\x3d"'+r.getAttribute("doc-data-value")+'"]'))&&(u=a(p));l[m]={leftCellWidth:q,rightCellWidth:u}}for(m=0;m<h;m++)p=F[m],r=E[m],q=I[m],u=L[m],POLARIS.tools.setTimeout(function(a,b,c,g,h,l,m,p,r){a&&a.removeAttribute("width");c&&c.removeAttribute("width");var q=Math.ceil(Math.max(b+l,1));g=Math.floor(Math.max(g-l,1));if(q&&isNaN(g)){var z,u;z=q-b;if(d.config.wordprocessor)u=POLARIS.tools.getPageContentsSize(d).width;else{var t=d.document.getBody();u=t.getSize("width");
var D=parseFloat(t.getStyle("margin-left"))||0,y=parseFloat(t.getStyle("margin-right"))||0,w=parseFloat(t.getStyle("padding-left"))||0,t=parseFloat(t.getStyle("padding-right"))||0;u-=D+y+w+t}u<h+z&&(l=u-h,q=b+l)}a&&a.setStyle("width",q);c&&c.setStyle("width",g);p&&(b=e(p))&&(b=Math.ceil(Math.max(b+l,1)),p.removeAttribute("width"),p.setStyle("width",b));r&&(b=e(r))&&(b=Math.floor(Math.max(b-l,1)),r.removeAttribute("width"),r.setStyle("width",b));if(h)if(r=k,a?r=a.getAscendant("table"):c&&(r=c.getAscendant("table")),
a=0,p){h=p.getAscendant("colgroup").find("col");for(l=0;l<h.count();l++)p=h.getItem(l),(c=p.getStyle("width"))||(c=p.getAttribute("width")),a+=parseInt(c);r.setStyle("width",a)}else r.setStyle("width",n(h+l*(f?-1:1)));m&&(d.fire("change"),d.fire("contentChange",{type:"tableresize"}),d.fire("tableresize"))},0,this,[p,l[m].leftCellWidth,r,l[m].rightCellWidth,(!p||!r)&&a(k)+b(k,"left")+b(k,"right"),y/z,m==h-1,q,u])}function h(b){k(b);var e=d.document.findOne("#polaris-page-container");e&&(e=Math.round(parseFloat(POLARIS.tools.getScaleRatio(e))),
100!=e&&(z=e/100));3==b.data.$.which&&(b=x.columnIndex,e=x.rowIndex,b=POLARIS.tools.buildTableMap(x.table)[e][b])&&(b=new POLARIS.dom.element(b),e=d.getSelection().getRanges()[0])&&(POLARIS.plugins.tabletools.placeCursorInCell(b),e.moveToLeafElementEditablePosition(b,!0),e.select());b=x.columnIndex;var e=[],f=[],g=[],n=[],p=Number.MAX_VALUE,r=p,q=x.rtl,t=[];if(x.table.hasAttribute("doc-data-value")&&"polaris-table-paginated"==x.table.getAttribute("doc-data-role"))for(var D=x.table.getAttribute("doc-data-value"),
D=x.table.getAscendant("body",1).find('table[doc-data-value\x3d"'+D+'"]'),R=0;R<D.count();R++)t.push(D.getItem(R));else t.push(x.table);for(D=0;D<t.length;D++){var ba=t[D],Ba=POLARIS.tools.buildTableMap(ba);if(R=ba.findOne("colgroup")){var oa=R.find("col");oa&&(R=oa.getItem(b+(q?1:0)),oa=oa.getItem(b+(q?0:1)),g.push(R),n.push(oa))}R=0;for(oa=Ba.length;R<oa;R++){var da=Ba[R],ea=da[b+(q?1:0)],da=da[b+(q?0:1)],ea=ea&&new POLARIS.dom.element(ea),da=da&&new POLARIS.dom.element(da);if(!ea||!da||!ea.equals(da)){if(c(ea)){var ga=
ba.findOne('[doc-data-value\x3d"'+ea.getAttribute("doc-data-value")+'"]');ga&&(p=Math.min(p,a(ga)))}else ea&&(p=Math.min(p,a(ea)));e.push(ea);c(da)?(ga=ba.findOne('[doc-data-value\x3d"'+da.getAttribute("doc-data-value")+'"]'))&&(r=Math.min(r,a(ga))):da&&(r=Math.min(r,a(da)));f.push(da)}}}F=e;E=f;I=g;L=n;H=x.x-(20>p?0:p-20)*z;J=x.x+(20>r?0:r-20)*z;u.setOpacity(.5);G=parseInt(u.getStyle("left"),10);y=0;B=1;u.on("mousemove",m);C.on("dragstart",k);(b=(b=d.plugins.tabletools.getDragStartCell())&&b.getAscendant("table"))&&
b.$!=x.table.$&&d.plugins.tabletools.clearSelectedCell();C.on("mouseup",l,this)}function l(a){a.removeListener();f()}function m(a){D(a.data.getPageOffset().x)}this.resizerType="columnResizer";var x,C,u,B,G,y,F,E,H,J,I,L,z=1;C=d.document;u=POLARIS.dom.element.createFromHtml('\x3cdiv data-polaris-temp\x3d1 contenteditable\x3dfalse unselectable\x3don style\x3d"position:absolute;cursor:col-resize;filter:alpha(opacity\x3d0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"\x3e\x3c/div\x3e',
C);d.on("destroy",function(){u.remove()});q||C.getDocumentElement().append(u);this.attachTo=function(a){B||(q&&(C.getBody().append(u),y=0),x=a,u.setStyles({width:n(a.width),height:n(a.height),left:n(a.x),top:n(a.y)}),q&&u.setOpacity(.25),u.on("mousedown",h,this),C.getBody().setStyle("cursor","col-resize"),u.show())};var D=this.move=function(a){if(!x)return 0;var b=x.x-2;if(!B&&(a<=b||a>=x.x+x.width+2))return x=null,B=y=0,C.removeListener("mouseup",l),u.removeListener("mousedown",h),u.removeListener("mousemove",
m),C.getBody().setStyle("cursor","auto"),q?u.remove():u.hide(),0;a-=Math.round(u.$.offsetWidth/2);if(B){if(a==H||a==J)return 1;a=Math.max(a,H);a=Math.min(a,J);y=a-G}u.setStyle("left",n(a));return 1}}function l(a){function b(){B=0;m.setOpacity(0);y&&d();var a=h.table;setTimeout(function(){a.removeCustomData("_polaris_table_pillars")},0);l.removeListener("dragstart",k)}function d(){for(var b=F.length,c=0;c<b;c++){var e=F[c],f=E[c],g=h.table;POLARIS.tools.setTimeout(function(b,c,d,e,f,h,k){if(b){for(e=
d=0;e<b.getChildCount();e++){var l=b.getChild(e);l&&l.type==POLARIS.NODE_ELEMENT&&(l.is("span")||(d+=POLARIS.tools.getClientRectWithoutTransform(l).height))}e=POLARIS.tools.convertToPx(b.getComputedStyle("border-top-width"));l=POLARIS.tools.convertToPx(b.getComputedStyle("border-bottom-width"));d+=e+l;c=Math.max(c+h,1);c=c>d?n(c):d;b.setStyle("height",c);b=b.getAscendant("tr");b.removeStyle("height");b.hasAttribute("height")&&b.removeAttribute("height")}g.setStyle("height",n(f+h));k&&(a.fire("change",
{isObjectResize:!0}),a.fire("tableresize"),a.fire("contentChange",{type:"tableresize"}))},0,this,[e,e&&e.getSize("height"),f,f&&f.getSize("height"),g.getSize("height"),y/I,c==b-1])}}function e(b){k(b);var d=a.document.findOne("#polaris-page-container");d&&(d=Math.round(parseFloat(POLARIS.tools.getScaleRatio(d))),100!=d&&(I=d/100));3==b.data.$.which&&(b=h.columnIndex,d=h.rowIndex,b=POLARIS.tools.buildTableMap(h.table)[d][b])&&(b=new POLARIS.dom.element(b),d=a.getSelection().getRanges()[0])&&(POLARIS.plugins.tabletools.placeCursorInCell(b),
d.moveToLeafElementEditablePosition(b,!0),d.select());var n=h.rowIndex,p=POLARIS.tools.buildTableMap(h.table);b=[];var d=[],r=Number.MAX_VALUE,q=r;n>=p.length&&(n=p.length-1,h.rowIndex=n);for(var t=p[n],n=p[n+1],p=0,U=t.length;p<U;p++){var L=t[p],V=n&&n[p],L=L&&new POLARIS.dom.element(L),V=V&&new POLARIS.dom.element(V);if(L){var Z=L;c(Z)&&(Z=h.table.findOne('[doc-data-value\x3d"'+Z.getAttribute("doc-data-value")+'"]'));Z&&Z.isVisible()?r=Math.min(r,Z.getSize("height")):L=null;b.push(L)}V&&(Z=V,c(Z)&&
(Z=h.table.findOne('[doc-data-value\x3d"'+Z.getAttribute("doc-data-value")+'"]')),Z&&Z.isVisible()||(V=null),d.push(V))}F=b;E=d;H=h.y-(10>r?10:r-10)*I;J=h.y+(10>q?10:q-10)*I;m.setOpacity(.5);G=parseInt(m.getStyle("top"),10);y=0;B=1;m.on("mousemove",g);l.on("dragstart",k);(b=(b=a.plugins.tabletools.getDragStartCell())&&b.getAscendant("table"))&&b.$!=h.table.$&&a.plugins.tabletools.clearSelectedCell();l.on("mouseup",f,this)}function f(a){a.removeListener();b()}function g(a){L(a.data.getPageOffset().y)}
this.resizerType="rowResizer";var h,l,m,B,G,y,F,E,H,J,I=1;l=a.document;m=POLARIS.dom.element.createFromHtml('\x3cdiv data-polaris-temp\x3d1 contenteditable\x3dfalse unselectable\x3don style\x3d"position:absolute;cursor:row-resize;filter:alpha(opacity\x3d0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"\x3e\x3c/div\x3e',l);a.on("destroy",function(){m.remove()});q||l.getDocumentElement().append(m);this.attachTo=function(a){B||(q&&(l.getBody().append(m),y=
0),h=a,m.setStyles({width:n(a.width),height:n(a.height),left:n(a.x),top:n(a.y)}),q&&m.setOpacity(.25),m.on("mousedown",e,this),l.getBody().setStyle("cursor","row-resize"),m.show())};var L=this.move=function(a){if(!h)return 0;var b=h.y-2;if(!B&&(a<=b||a>=h.y+h.height+2))return h=null,B=y=0,l.removeListener("mouseup",f),m.removeListener("mousedown",e),m.removeListener("mousemove",g),l.getBody().setStyle("cursor","auto"),q?m.remove():m.hide(),0;a-=Math.round(m.$.offsetHeight/2);if(B){if(a==H||a==J)return 1;
a=Math.max(a,H);a=Math.min(a,J);y=a-G}m.setStyle("top",n(a));return 1}}function m(a){var b;if("objectresize"==a.name)b=a.data.element;else{if("change"==a.name){for(a=(a=a.data&&a.data.selection)&&a.getStartElement();a;)a.type==POLARIS.NODE_ELEMENT&&a.is("table")&&a.removeCustomData("_polaris_table_pillars"),a=a.getNext();return}b=a.data.getTarget()}if("mouseout"==a.name){if(!b.is("table"))return;for(var c=new POLARIS.dom.element(a.data.$.relatedTarget||a.data.$.toElement);c&&c.$&&!c.equals(b)&&!c.is("body");)c=
c.getParent();if(!c||c.equals(b))return}(b=b&&b.getAscendant("table",1))&&b.removeCustomData("_polaris_table_pillars");a.removeListener()}var n=POLARIS.tools.cssLength,q=POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks);POLARIS.plugins.add("tableresize",{requires:"tabletools",init:function(a){a.on("contentDom",function(){var b,c,e=a.editable();e.attachListener(e,"mousemove",function(e){e=e.data;var g=e.getTarget();if(g.type==POLARIS.NODE_ELEMENT){var n=e.getPageOffset().x,q=e.getPageOffset().y;
if(b&&"columnResizer"==b.resizerType&&b&&b.move(n))k(e);else if(c&&"rowResizer"==c.resizerType&&c&&c.move(q))k(e);else{var t;if(g.is("table")||g.getAscendant("tbody",1)||g.getAscendant("thead",1)||g.getAscendant("tfoot",1))if(e=g.getAscendant("table",1),POLARIS.tools.isInEditableElement(a,e)){g=1;if(t=a.document.findOne("#polaris-page-container")){t=Math.round(parseFloat(POLARIS.tools.getScaleRatio(t)));100!=t&&(g=t/100);var B=e.getCustomData("_polaris_table_zoom_ratio");B?B&&t&&B!=t&&(e.removeCustomData("_polaris_table_pillars"),
e.setCustomData("_polaris_table_zoom_ratio",t)):(e.removeCustomData("_polaris_table_pillars"),e.setCustomData("_polaris_table_zoom_ratio",t))}(t=e.getCustomData("_polaris_table_pillars"))||(e.setCustomData("_polaris_table_pillars",t=d(e,g)),e.on("mouseout",m),e.on("mousedown",m),a.on("change",m),a.on("objectresize",m),e.on("DOMNodeInserted",m),e.on("DOMNodeRemoved",m));n=h(t,n,q);q=POLARIS.plugins.tabletools.getCellDrag();n&&0==q&&("col"==n.type?(!b&&(b=new f(a)),b.attachTo(n)):(!c&&(c=new l(a)),
c.attachTo(n)))}}}})})}})})();(function(){POLARIS.plugins.add("templates",{requires:"dialog",init:function(a){POLARIS.dialog.add("templates",POLARIS.getUrl(this.path+"dialogs/templates.js"));a.addCommand("templates",new POLARIS.dialogCommand("templates"));a.ui.addButton&&a.ui.addButton("Templates",{label:a.lang.templates.button,command:"templates",toolbar:"doctools,10"});POLARIS.dialog.add("documentPassword",POLARIS.getUrl(this.path+"dialogs/documentpassword.js"));a.ui.add("DocumentPassword",POLARIS.UI_BUTTON,
{label:a.lang.templates.documentPassword.label,command:"documentPassword"});a.addCommand("documentPassword",{readOnly:1,exec:function(a,b){a.openDialog("documentPassword")}})}});var a={},e={},b={};POLARIS.addTemplates=function(b,d){a[b]=d};POLARIS.getTemplates=function(b){return a[b]};POLARIS.addTemplateItems=function(a,b){e[a]=b};POLARIS.getTemplateItems=function(a){return e[a]};POLARIS.loadTemplates=function(a,d){for(var e=[],g=0,k=a.length;g<k;g++)b[a[g]]||(e.push(a[g]),b[a[g]]=1);e.length?POLARIS.scriptLoader.load(e,
d):setTimeout(d,0)}})();POLARIS.config.templates="onnara_documents";POLARIS.config.templates_files=[POLARIS.getUrl("plugins/templates/templates/onnara_documents.js")];POLARIS.config.templates_replaceContent=!0;"use strict";(function(){var a=[POLARIS.CTRL+90,POLARIS.CTRL+89,POLARIS.CTRL+POLARIS.SHIFT+90],e={8:1,46:1};POLARIS.plugins.add("undo",{init:function(c){function d(a){var b=a.data.name;n.enabled&&!1!==a.data.command.canUndo&&n.save(void 0,void 0,void 0,"enter"!==b?!0:!1)}function e(a){n.enabled&&
!1!==a.data.action.canUndo&&n.save(void 0,void 0,void 0,!0)}function g(){n.enabled=c.readOnly?!1:"wysiwyg"==c.mode;n.onChange()}var n=c.undoManager=new b(c),q=n.editingHandler=new h(n),v=c.addCommand("undo",{exec:function(){POLARIS.plugins.tabletools.clearSelectedCell();n.undo()&&(c.selectionChange(),c.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),r=c.addCommand("redo",{exec:function(){POLARIS.plugins.tabletools.clearSelectedCell();n.redo()&&(c.selectionChange(),c.fire("afterRedo"))},startDisabled:!0,
canUndo:!1});c.setKeystroke([[a[0],"undo"],[a[1],"redo"],[a[2],"redo"]]);n.onChange=function(){v.setState(n.undoable()?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED);r.setState(n.redoable()?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED)};c.on("beforeCommandExec",d);c.on("afterCommandExec",d);c.on("beforeActionExec",e);c.on("afterActionExec",e);c.on("saveSnapshot",function(a){n.save(a.data&&a.data.contentOnly)});c.on("contentDom",q.attachListeners,q);c.on("instanceReady",function(){c.fire("saveSnapshot")});
c.on("beforeModeUnload",function(){"wysiwyg"==c.mode&&n.save(!0)});c.on("mode",g);c.on("readOnly",g);c.ui.addButton&&(c.ui.addButton("Undo",{label:c.lang.undo.undo,command:"undo",toolbar:"undo,10"}),c.ui.addButton("Redo",{label:c.lang.undo.redo,command:"redo",toolbar:"undo,20"}));c.resetUndo=function(){n.reset();c.fire("saveSnapshot")};c.on("updateSnapshot",function(){n.currentImage&&n.update()});c.on("lockSnapshot",function(a){a=a.data;n.lock(a&&a.dontUpdate,a&&a.forceUpdate)});c.on("unlockSnapshot",
n.unlock,n)}});POLARIS.plugins.undo={};var b=POLARIS.plugins.undo.UndoManager=function(a){this.strokesRecorded=[0,0];this.locked=null;this.previousKeyGroup=-1;this.limit=a.config.undoStackSize||20;this.strokesLimit=15;this.editor=a;this.reset()};b.prototype={type:function(a,c){var d=b.getKeyGroup(a),e=this.strokesRecorded[d]+1;c=c||e>=this.strokesLimit;this.typing||(this.typing=!0,this.hasUndo=this.undoable(),this.hasRedo=this.redoable(),this.onChange());if(c)e=0,this.editor.fire("saveSnapshot");
else{var g=!0;116==a&&(g=!1);1==g&&this.editor.fire("change")}this.strokesRecorded[d]=e;this.previousKeyGroup=d},keyGroupChanged:function(a){return b.getKeyGroup(a)!=this.previousKeyGroup},reset:function(){this.snapshots=[];this.index=-1;this.currentImage=null;this.hasRedo=this.hasUndo=!1;this.locked=null;this.resetType()},resetType:function(){this.strokesRecorded=[0,0];this.typing=!1;this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(!0);this.hasRedo=!!this.getNextImage(!1);
this.resetType();this.onChange()},save:function(a,b,d,e){a=this.editor;if(this.locked||"ready"!=a.status||"wysiwyg"!=a.mode)return!1;var g=a.editable();if(!g||"ready"!=g.status)return!1;g=this.snapshots;b||(b=new c(a));if(!1===b.contents)return!1;if(this.currentImage){if(b.equalsContent(this.currentImage))return!1;!1!==d&&(a.fire("change"),e&&a.fire("contentChange",{type:"saveImage"}))}g.splice(this.index+1,g.length-this.index-1);g.length==this.limit&&g.shift();this.index=g.push(b)-1;this.currentImage=
b;this.refreshState();return!0},restoreImage:function(a){var b=this.editor,c;a.bookmarks&&(b.focus(),c=b.getSelection());this.locked={level:999};this.editor.loadSnapshot(a.contents);a.bookmarks?c.selectBookmarks(a.bookmarks):POLARIS.env.ie&&(c=this.editor.document.getBody().$.createTextRange(),c.collapse(!0),c.select());this.locked=null;this.index=a.index;this.currentImage=this.snapshots[this.index];this.update();this.refreshState();b.fire("change",{restoreImage:!0,selection:b.getSelection()})},getNextImage:function(a){var b=
this.snapshots,c=this.currentImage,d;if(c)if(a)for(d=this.index-1;0<=d;d--){if(a=b[d],!c.equalsContent(a))return a.index=d,a}else for(d=this.index+1;d<b.length;d++)if(a=b[d],!c.equalsContent(a))return a.index=d,a;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var a=this.getNextImage(!0);if(a)return this.restoreImage(a),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),
this.redoable())){var a=this.getNextImage(!1);if(a)return this.restoreImage(a),!0}return!1},update:function(a){if(!this.locked){a||(a=new c(this.editor));for(var b=this.index,d=this.snapshots;0<b&&this.currentImage.equalsContent(d[b-1]);)--b;d.splice(b,this.index-b+1,a);this.index=b;this.currentImage=a}},updateSelection:function(a){if(!this.snapshots.length)return!1;var b=this.snapshots,c=b[b.length-1];return c.equalsContent(a)&&!c.equalsSelection(a)?(this.currentImage=b[b.length-1]=a,!0):!1},lock:function(a,
b){if(this.locked)this.locked.level++;else if(a)this.locked={level:1};else{var d=null;if(b)d=!0;else{var e=new c(this.editor,!0);this.currentImage&&this.currentImage.equalsContent(e)&&(d=e)}this.locked={update:d,level:1}}},unlock:function(){if(this.locked&&!--this.locked.level){var a=this.locked.update;this.locked=null;if(!0===a)this.update();else if(a){var b=new c(this.editor,!0);a.equalsContent(b)||this.update()}}}};b.navigationKeyCodes={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1};b.keyGroups={PRINTABLE:0,
FUNCTIONAL:1};b.isNavigationKey=function(a){return!!b.navigationKeyCodes[a]};b.getKeyGroup=function(a){var c=b.keyGroups;return e[a]?c.FUNCTIONAL:c.PRINTABLE};b.getOppositeKeyGroup=function(a){var c=b.keyGroups;return a==c.FUNCTIONAL?c.PRINTABLE:c.FUNCTIONAL};b.ieFunctionalKeysBug=function(a){return POLARIS.env.ie&&b.getKeyGroup(a)==b.keyGroups.FUNCTIONAL};var c=POLARIS.plugins.undo.Image=function(a,b){this.editor=a;a.fire("beforeUndoImage");var c=a.getSnapshot();POLARIS.env.ie&&c&&(c=c.replace(/\s+data-polaris-expando=".*?"/g,
""));this.contents=c;b||(this.bookmarks=(c=c&&a.document.getSelection())&&c.createBookmarks2(!0));a.fire("afterUndoImage")},d=/\b(?:href|src|name)="[^"]*?"/gi;c.prototype={equalsContent:function(a){var b=this.contents;a=a.contents;POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks)&&(b=b.replace(d,""),a=a.replace(d,""));b=b.replace(/(?:\s*class)="[^"]*?"|(?:\s*transform[^:]*)[^";]*;?"/gi,"");a=a.replace(/(?:\s*class)="[^"]*?"|(?:\s*transform[^:]*)[^";]*;?"/gi,"");return b!=a?!1:!0},equalsSelection:function(a){var b=
this.bookmarks;a=a.bookmarks;if(b||a){if(!b||!a||b.length!=a.length)return!1;for(var c=0;c<b.length;c++){var d=b[c],e=a[c];if(d.startOffset!=e.startOffset||d.endOffset!=e.endOffset||!POLARIS.tools.arrayCompare(d.start,e.start)||!POLARIS.tools.arrayCompare(d.end,e.end))return!1}}return!0}};var h=POLARIS.plugins.undo.NativeEditingHandler=function(a){this.undoManager=a;this.ignoreInputEvent=!1;this.keyEventsStack=new g;this.lastKeydownImage=null};h.prototype={onKeydown:function(d){var e=d.data.getKey();
if(229!==e)if(-1<POLARIS.tools.indexOf(a,d.data.getKeystroke()))d.data.preventDefault();else if(this.keyEventsStack.cleanUp(d),d=this.undoManager,this.keyEventsStack.getLast(e)||this.keyEventsStack.push(e),this.lastKeydownImage=new c(d.editor),b.isNavigationKey(e)||this.undoManager.keyGroupChanged(e))if(d.strokesRecorded[0]||d.strokesRecorded[1])d.save(!1,this.lastKeydownImage,!1),d.resetType()},onInput:function(){if(this.ignoreInputEvent)this.ignoreInputEvent=!1;else{var a=this.keyEventsStack.getLast();
a||(a=this.keyEventsStack.push(0));this.keyEventsStack.increment(a.keyCode);this.keyEventsStack.getTotalInputs()>=this.undoManager.strokesLimit&&(this.undoManager.type(a.keyCode,!0),this.keyEventsStack.resetInputs())}},onKeyup:function(a){var d=this.undoManager;a=a.data.getKey();var e=this.keyEventsStack.getTotalInputs();this.keyEventsStack.remove(a);if(!(b.ieFunctionalKeysBug(a)&&this.lastKeydownImage&&this.lastKeydownImage.equalsContent(new c(d.editor,!0))))if(0<e)d.type(a);else if(b.isNavigationKey(a))this.onNavigationKey(!0)},
onNavigationKey:function(a){var b=this.undoManager;!a&&b.save(!0,null,!1)||b.updateSelection(new c(b.editor));b.resetType()},ignoreInputEventListener:function(){this.ignoreInputEvent=!0},attachListeners:function(){var a=this.undoManager.editor,c=a.editable(),d=this;c.attachListener(c,"keydown",function(a){d.onKeydown(a);if(b.ieFunctionalKeysBug(a.data.getKey()))d.onInput()},null,null,999);POLARIS.env.ie?(c.attachListener(c,"compositionstart",d.onInput,d,null,999),c.attachListener(c,"keypress",d.onInput,
d,null,999)):c.attachListener(c,"input",d.onInput,d,null,999);c.attachListener(c,"keyup",d.onKeyup,d,null,999);c.attachListener(c,"paste",d.ignoreInputEventListener,d,null,999);c.attachListener(c,"drop",d.ignoreInputEventListener,d,null,999);c.attachListener(c.isInline()?c:a.document.getDocumentElement(),"click",function(){d.onNavigationKey()},null,null,999);c.attachListener(this.undoManager.editor,"blur",function(){d.keyEventsStack.remove(9)},null,null,999)}};var g=POLARIS.plugins.undo.KeyEventsStack=
function(){this.stack=[]};g.prototype={push:function(a){a=this.stack.push({keyCode:a,inputs:0});return this.stack[a-1]},getLastIndex:function(a){if("number"!=typeof a)return this.stack.length-1;for(var b=this.stack.length;b--;)if(this.stack[b].keyCode==a)return b;return-1},getLast:function(a){a=this.getLastIndex(a);return-1!=a?this.stack[a]:null},increment:function(a){this.getLast(a).inputs++},remove:function(a){a=this.getLastIndex(a);-1!=a&&this.stack.splice(a,1)},resetInputs:function(a){if("number"==
typeof a)this.getLast(a).inputs=0;else for(a=this.stack.length;a--;)this.stack[a].inputs=0},getTotalInputs:function(){for(var a=this.stack.length,b=0;a--;)b+=this.stack[a].inputs;return b},cleanUp:function(a){a=a.data.$;a.ctrlKey||a.metaKey||this.remove(17);a.shiftKey||this.remove(16);a.altKey||this.remove(18)}}})();(function(){function a(a){var b=this.editor,c=a.document,k=c.body,f=c.getElementById("polaris_actscrpt");f&&f.parentNode.removeChild(f);(f=c.getElementById("polaris_shimscrpt"))&&f.parentNode.removeChild(f);
(f=c.getElementById("polaris_basetagscrpt"))&&f.parentNode.removeChild(f);k.contentEditable=!0;POLARIS.env.ie&&(k.hideFocus=!0,k.disabled=!0,k.removeAttribute("disabled"));POLARIS.env.ie&&k.style&&(k.style.imeMode="active");delete this._.isLoadingData;this.$=k;c=new POLARIS.dom.document(c);this.setup();b.config.wordprocessor||this.fixInitialSelection();POLARIS.env.ie&&(c.getDocumentElement().addClass(c.$.compatMode),b.config.enterMode!=POLARIS.ENTER_P&&this.attachListener(c,"selectionchange",function(){var a=
c.getBody(),d=b.getSelection(),e=d&&d.getRanges()[0];e&&a.getHtml().match(/^<p>(?:&nbsp;|<br>)<\/p>$/i)&&e.startContainer.equals(a)&&setTimeout(function(){e=b.getSelection().getRanges()[0];e.startContainer.equals("body")||(a.getFirst().remove(1),e.moveToElementEditEnd(a),e.select())},0)}));if(POLARIS.env.webkit||POLARIS.env.ie&&10<POLARIS.env.version)c.getDocumentElement().on("mousedown",function(a){if(a.data.getTarget().is("html"))setTimeout(function(){b.editable().focus()});else if(a.data.getTarget().is("body")&&
!b.config.wordprocessor){var c=a.data.getTarget();(a=a.data.getTarget().getLast())&&a.is&&!a.is("p")&&(a=new POLARIS.dom.element("p",b.document),a.appendBogus(),c.append(a))}});else c.getDocumentElement().on("mousedown",function(a){if(a.data.getTarget().is("body")){var c=a.data.getTarget();(a=a.data.getTarget().getLast())&&a.is&&!a.is("p")&&(a=new POLARIS.dom.element("p",b.document),a.appendBogus(),c.append(a))}});e(b);try{b.document.$.execCommand("2D-position",!1,!0)}catch(l){}(POLARIS.env.gecko||
POLARIS.env.ie&&"CSS1Compat"==b.document.$.compatMode)&&this.attachListener(this,"keydown",function(a){var c=a.data.getKeystroke();if(33==c||34==c)if(POLARIS.env.ie)setTimeout(function(){b.getSelection().scrollIntoView()},0);else if(b.window.$.innerHeight>this.$.offsetHeight){var d=b.createRange();d[33==c?"moveToElementEditStart":"moveToElementEditEnd"](this);d.select();a.data.preventDefault()}});POLARIS.env.ie&&this.attachListener(c,"blur",function(){try{c.$.selection.empty()}catch(a){}});POLARIS.env.iOS&&
this.attachListener(c,"touchend",function(){a.focus()});k=b.document.getElementsByTag("title").getItem(0);k.data("polaris-title",k.getText());POLARIS.env.ie&&(b.document.$.title=this._.docTitle);POLARIS.tools.setTimeout(function(){"unloaded"==this.status&&(this.status="ready");b.fire("contentDom");this._.isPendingFocus&&(b.focus(),this._.isPendingFocus=!1);setTimeout(function(){b.fire("dataReady")},0);POLARIS.env.ie&&setTimeout(function(){if(b.document){var a=b.document.$.body;a.runtimeStyle.marginBottom=
"0px";a.runtimeStyle.marginBottom=""}},1E3)},0,this)}function e(a){function b(){var e;a.editable().attachListener(a,"selectionChange",function(){var b=a.getSelection().getSelectedElement();b&&(e&&(e.detachEvent("onresizestart",c),e=null),b.$.attachEvent("onresizestart",c),e=b.$)})}function c(a){a.returnValue=!1}if(POLARIS.env.gecko)try{var e=a.document.$;e.execCommand("enableObjectResizing",!1,!a.config.disableObjectResizing);e.execCommand("enableInlineTableEditing",!1,!a.config.disableNativeTableHandles)}catch(f){}else POLARIS.env.ie&&
11>POLARIS.env.version&&a.config.disableObjectResizing&&b(a)}function b(){var a=[];8<=POLARIS.document.$.documentMode?a.push("html.CSS1Compat [contenteditable\x3dfalse]{min-height:0}"):POLARIS.env.gecko&&(a.push("html{height:100% !important}"),a.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"));a.push("html{cursor:text;cursor:auto}");a.push("img,input,textarea{cursor:default}");return a.join("\n")}POLARIS.plugins.add("wysiwygarea",{init:function(a){a.config.fullPage&&
a.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"});a.addMode("wysiwyg",function(b){function e(g){g&&g.removeListener();a.editable(new c(a,f.$.contentWindow.document.body));a.setData(a.getData(1),b)}var k="document.open();"+(POLARIS.env.ie?"("+POLARIS.tools.fixDomain+")();":"")+"document.close();",k=POLARIS.env.air?"javascript:void(0)":POLARIS.env.ie?"javascript:void(function(){"+encodeURIComponent(k)+"}())":"",f=POLARIS.dom.element.createFromHtml('\x3ciframe src\x3d"'+
k+'" frameBorder\x3d"0"\x3e\x3c/iframe\x3e');f.setStyles({width:"100%",height:"100%"});f.addClass("polaris_wysiwyg_frame polaris_reset");a.config.wordprocessor&&a.config.pageBgColor&&f.setStyle("background-color",a.config.pageBgColor);k=a.ui.space("contents");k.append(f);var l=POLARIS.env.ie||POLARIS.env.gecko;if(l)f.on("load",e);var m=a.title,n=a.fire("ariaEditorHelpLabel",{}).label;m&&(POLARIS.env.ie&&n&&(m+=", "+n),f.setAttribute("title",m));if(n){var m=POLARIS.tools.getNextId(),q=POLARIS.dom.element.createFromHtml('\x3cspan id\x3d"'+
m+'" class\x3d"polaris_voice_label"\x3e'+n+"\x3c/span\x3e");k.append(q,1);f.setAttribute("aria-describedby",m)}a.on("beforeModeUnload",function(a){a.removeListener();q&&q.remove()});f.setAttributes({tabIndex:a.tabIndex,allowTransparency:"true"});!l&&e();a.fire("ariaWidget",f)})},setApplyContentCss:function(a){applyContentCss=a}});POLARIS.editor.prototype.addContentsCss=function(a){var b=this.config,c=b.contentsCss;POLARIS.tools.isArray(c)||(b.contentsCss=c?[c]:[]);b.contentsCss.push(a)};var c=POLARIS.tools.createClass({$:function(){this.base.apply(this,
arguments);this._.frameLoadedHandler=POLARIS.tools.addFunction(function(b){POLARIS.tools.setTimeout(a,0,this,b)},this);this._.docTitle=this.getWindow().getFrame().getAttribute("title")},base:POLARIS.editable,proto:{setData:function(a,c){var e=this.editor;if(c){var k=document.createElement("iframe");document.body.appendChild(k);var f=k.contentWindow.document;f.write(a);var l=f.body.attributes;this.$.style.cssText=l&&l.style?l.style.value:"";document.body.removeChild(k);this.setHtml(a);this.fixInitialSelection();
e.fire("dataReady")}else{this._.isLoadingData=!0;e._.dataStore={id:1};var l=e.config,m=l.fullPage,n=l.docType,q=POLARIS.tools.buildStyleHtml(b()).replace(/<style>/,'\x3cstyle data-polaris-temp\x3d"1"\x3e'),q=q+POLARIS.tools.buildStyleHtml(e.config.contentsCss),k=l.baseHref?'\x3cbase href\x3d"'+l.baseHref+'" data-polaris-temp\x3d"1" /\x3e':"";m&&(a=a.replace(/<!DOCTYPE[^>]*>/i,function(a){e.docType=n=a;return""}).replace(/<\?xml\s[^\?]*\?>/i,function(a){e.xmlDeclaration=a;return""}));a=e.dataProcessor.toHtml(a).replace('\x3clink href\x3d"'+
e.config.contentsCss+'" rel\x3d"stylesheet" type\x3d"text/css" /\x3e',"");m?(/<body[\s|>]/.test(a)||(a="\x3cbody\x3e"+a),/<html[\s|>]/.test(a)||(a="\x3chtml\x3e"+a+"\x3c/html\x3e"),/<head[\s|>]/.test(a)?/<title[\s|>]/.test(a)||(a=a.replace(/<head[^>]*>/,"$\x26\x3ctitle\x3e\x3c/title\x3e")):a=a.replace(/<html[^>]*>/,"$\x26\x3chead\x3e\x3ctitle\x3e\x3c/title\x3e\x3c/head\x3e"),k&&(a=a.replace(/<head[^>]*?>/,"$\x26"+k)),a=a.replace(/<\/head\s*>/,q+"$\x26"),a=n+a,void 0==e.docType&&(e.docType=n)):a=l.docType+
'\x3chtml dir\x3d"'+l.contentsLangDirection+'" lang\x3d"'+(l.contentsLanguage||e.langCode)+'"\x3e\x3chead\x3e\x3ctitle\x3e'+this._.docTitle+"\x3c/title\x3e"+k+q+"\x3c/head\x3e\x3cbody"+(l.bodyId?' id\x3d"'+l.bodyId+'"':"")+(l.bodyClass?' class\x3d"'+l.bodyClass+'"':"")+"\x3e"+a+"\x3c/body\x3e\x3c/html\x3e";POLARIS.env.gecko&&(a=a.replace(/<body/,'\x3cbody contenteditable\x3d"true" '),2E4>POLARIS.env.version&&(a=a.replace(/<body[^>]*>/,"$\x26\x3c!-- polaris-content-start --\x3e")));l='\x3cscript id\x3d"polaris_actscrpt" type\x3d"text/javascript"'+
(POLARIS.env.ie?' defer\x3d"defer" ':"")+"\x3evar wasLoaded\x3d0;function onload(){if(!wasLoaded)window.parent.POLARIS.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded\x3d1;}"+(POLARIS.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"\x3c/script\x3e";POLARIS.env.ie&&9>POLARIS.env.version&&(l+='\x3cscript id\x3d"polaris_shimscrpt"\x3ewindow.parent.POLARIS.tools.enableHtml5Elements(document)\x3c/script\x3e');k&&POLARIS.env.ie&&10>POLARIS.env.version&&
(l+='\x3cscript id\x3d"polaris_basetagscrpt"\x3evar baseTag \x3d document.querySelector( "base" );baseTag.href \x3d baseTag.href;\x3c/script\x3e');a=a.replace(/(?=\s*<\/(:?head)>)/,l);this.clearCustomData();this.clearListeners();e.fire("contentDomUnload");f=this.getDocument();try{f.write(a)}catch(v){setTimeout(function(){f.write(a)},0)}}},getData:function(a){if(a)return this.getOuterHtml();a=this.editor;var b=a.config,c=b.fullPage,e=c&&a.docType,f=c&&a.xmlDeclaration,l=this.getDocument(),c=c?l.getDocumentElement().getOuterHtml():
l.getBody().getHtml();POLARIS.env.gecko&&b.enterMode!=POLARIS.ENTER_BR&&(c=c.replace(/<br>(?=\s*(:?$|<\/body>))/,""));c=a.dataProcessor.toDataFormat(c);f&&(c=f+"\n"+c);e&&(c=e+"\n"+c);return c},focus:function(){this._.isLoadingData?this._.isPendingFocus=!0:c.baseProto.focus.call(this)},detach:function(){var a=this.editor,b=a.document,a=a.window.getFrame();c.baseProto.detach.call(this);this.clearCustomData();b.getDocumentElement().clearCustomData();a.clearCustomData();POLARIS.tools.removeFunction(this._.frameLoadedHandler);
(b=a.removeCustomData("onResize"))&&b.removeListener();a.remove()}}})})();POLARIS.config.disableObjectResizing=!1;POLARIS.config.disableNativeTableHandles=!0;POLARIS.config.disableNativeSpellChecker=!0;POLARIS.config.contentsCss=[POLARIS.getUrl("contents.css"),POLARIS.getUrl("fonts/fonts.css")];(function(){POLARIS.plugins.add("xml",{});POLARIS.xml=function(a){var e=null;if("object"==typeof a)e=a;else if(a=(a||"").replace(/&nbsp;/g," "),"ActiveXObject"in window){try{e=new ActiveXObject("MSXML2.DOMDocument")}catch(b){try{e=
new ActiveXObject("Microsoft.XmlDom")}catch(c){}}e&&(e.async=!1,e.resolveExternals=!1,e.validateOnParse=!1,e.loadXML(a))}else window.DOMParser&&(e=(new DOMParser).parseFromString(a,"text/xml"));this.baseXml=e};POLARIS.xml.prototype={selectSingleNode:function(a,e){var b=this.baseXml;if(e||(e=b)){if("selectSingleNode"in e)return e.selectSingleNode(a);if(b.evaluate)return(b=b.evaluate(a,e,null,9,null))&&b.singleNodeValue||null}return null},selectNodes:function(a,e){var b=this.baseXml,c=[];if(e||(e=b)){if("selectNodes"in
e)return e.selectNodes(a);if(b.evaluate&&(b=b.evaluate(a,e,null,5,null)))for(var d;d=b.iterateNext();)c.push(d)}return c},getInnerXml:function(a,e){var b=this.selectSingleNode(a,e),c=[];if(b)for(b=b.firstChild;b;)b.xml?c.push(b.xml):window.XMLSerializer&&c.push((new XMLSerializer).serializeToString(b)),b=b.nextSibling;return c.length?c.join(""):null}}})();(function(){POLARIS.plugins.add("ajax",{requires:"xml"});POLARIS.ajax=function(){function a(){if(!POLARIS.env.ie||"file:"!=location.protocol)try{return new XMLHttpRequest}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(b){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}return null}
function e(a){return 4==a.readyState&&(200<=a.status&&300>a.status||304==a.status||0===a.status||1223==a.status)}function b(a){return e(a)?a.responseText:null}function c(a){if(e(a)){var b=a.responseXML;return new POLARIS.xml(b&&b.firstChild?b:a.responseText)}return null}function d(b,c,d){var e=!!c,h=a();if(!h)return null;h.open("GET",b,e);e&&(h.onreadystatechange=function(){4==h.readyState&&(c(d(h)),h=null)});h.send(null);return e?"":d(h)}function h(b,c,d,e,h){var n=a();if(!n)return null;n.open("POST",
b,!0);n.onreadystatechange=function(){4==n.readyState&&(e(h(n)),n=null)};n.setRequestHeader("Content-type",d||"application/x-www-form-urlencoded; charset\x3dUTF-8");n.send(c)}return{load:function(a,c){return d(a,c,b)},post:function(a,c,d,e){return h(a,c,d,e,b)},loadXml:function(a,b){return d(a,b,c)}}}()})();(function(){function a(a,c,d,f){if(a.config.wordprocessor)b(a,c,"odt",function(b){e(a,b.convertId,d,f)});else{a.documentconvert.mCurrRequestCode=x.CONVERT_DOC_TO_PDF;var g={};g.id=c;g.convertType=
"HPDF";g.extension=d;POLARIS.log.docconv("request url \x3d /file/html, params.id \x3d "+g.id+", params.convertType \x3d "+g.convertType+" , params.extension \x3d "+g.extension);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/html",g,"POST","application/x-www-form-urlencoded",f,!0)}}function e(a,b,c,d){a.documentconvert.mCurrRequestCode=x.CONVERT_DOC_TO_PDF;var e={};e.id=b;e.convertType="PDF";e.extension=c;a.documentconvert.mCurrDocmentStamp&&(e.stamp=a.documentconvert.mCurrDocmentStamp);POLARIS.log.docconv("request url \x3d /file/html, params.id \x3d "+
e.id+", params.convertType \x3d "+e.convertType+" , params.extension \x3d "+e.extension);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/html",e,"POST","application/x-www-form-urlencoded",d,!0)}function b(a,b,c,d){a.documentconvert.mCurrRequestCode=x.CONVERT_HTML_TO_DOC;var e={};e.id=b;var f;b=c.toLowerCase();"odt"==b||"docx"==b||"pdf"==b?f=A.HTOD:"jpeg"==b?f=A.JPEG:"png"==b?f=A.PNG:"html"==b&&(f=A.DTOH);e.convertType=f;e.extension=c;a.documentconvert.mCurrDocmentStamp&&(e.stamp=a.documentconvert.mCurrDocmentStamp);
POLARIS.log.docconv("request url \x3d /file/html, params.id \x3d "+e.id+", params.convertType \x3d "+e.convertType+" , params.extension \x3d "+e.extension);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/html",e,"POST","application/x-www-form-urlencoded",d,!0)}function c(a,b,c){a.documentconvert.mCurrRequestCode=x.CONVERT_FILE_STATUS_CHECK;POLARIS.log.docconv("request url \x3d /file/convert/"+b);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/convert/"+b,"","GET","",c,!0)}function d(a,b,c,d,e){h(a,b,
c,d,function(b){b=b.convertId;a.documentconvert.mCurrRequestCode=x.CONVERT_ODT_TO_HTML;var c={};c.id=b;c.convertType="DTOH";a.documentconvert.mCurrDocmentStamp&&(c.stamp=a.documentconvert.mCurrDocmentStamp);POLARIS.log.docconv("request url \x3d /file/html, params.id \x3d "+c.id);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/html",c,"POST","application/x-www-form-urlencoded",e,!0)})}function h(a,b,c,d,e){a.documentconvert.mCurrRequestCode=x.CONVERT_HWP_TO_ODT;var f="",g={},h="",k=A.SAVE;if("multipartfile"===
b)g=new FormData,g.append("file",c),g.append("convertType",k),g.append("extension","odt"),f="",h="POST";else if("cloud"===b||"local"===b)g.type=b,g.url=c,g.name=encodeURIComponent(d),g.convertType=k,g.extension="odt",f="application/x-www-form-urlencoded",h="GET";POLARIS.log.docconv("request url \x3d /file/upload, openType \x3d "+b+", filePath \x3d "+c+" , contentType \x3d "+f);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/upload",g,h,f,e,!0)}function g(a,b,c,d,e){a.documentconvert.mCurrRequestCode=
x.SAVE_HTML;var f={};f.id=b;f.subject=encodeURIComponent(c);f.content=encodeURIComponent(d);a.documentconvert.mCurrDocmentStamp&&(f.stamp=a.documentconvert.mCurrDocmentStamp);POLARIS.log.docconv("request url \x3d /html/save, params.id \x3d "+f.id+", params.subject \x3d "+f.subject+" , params.content \x3d "+f.content.length);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/save",f,"POST","application/x-www-form-urlencoded",e,!0)}function k(a,b){a.documentconvert.mCurrRequestCode=x.GET_HTML;var c=b.fileName;
POLARIS.log.docconv("request url \x3d /file/download/, params.id \x3d "+b.id+", params.fileName \x3d "+b.pdfFileName+", params.stamp \x3d "+b.stamp);var d=a.documentconvert.DYNAMIC_BASE_URL+"/file/download/"+b.id+".pdf";POLARIS.tools.isEmpty(b.stamp)||(d+="?stamp\x3d"+b.stamp);var e=q();e.open("POST",d,!0);e.responseType="arraybuffer";e.onload=function(a){if(200===this.status)if(a=new Blob([this.response],{type:"application/pdf"}),"undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,
c);else{var b=window.URL||window.webkitURL,d=b.createObjectURL(a);c?(a=document.createElement("a"),"undefined"===typeof a.download?window.location=d:(a.href=d,a.download=c,document.body.appendChild(a),a.click())):window.location=d;setTimeout(function(){b.revokeObjectURL(d)},100)}};d="pdfFileName\x3d"+encodeURIComponent(c);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.send(d)}function f(a,b,c,d,e){a.documentconvert.mCurrRequestCode=x.UPLOAD_IMAGE;var f={};f.id=b;f.raw=encodeURIComponent(c);
f.name=d;a.documentconvert.mCurrDocmentStamp&&(f.stamp=a.documentconvert.mCurrDocmentStamp);POLARIS.log.docconv("request url \x3d /html/upload, id \x3d "+b+", name \x3d "+d+", raw \x3d "+c?c.length:0);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/upload",f,"POST","application/x-www-form-urlencoded",e)}function l(a,b,c,d,e,f){var g=t(a,e);if(1>g)f({id:b,fileName:"",content:e});else{var h=[],k=[],l=0,m=new POLARIS.htmlParser.filter,n=e;m.addRules({elements:{img:function(e){e=e.attributes.src;if(0<=
e.toLowerCase().indexOf("data:image")){var m=POLARIS.tools.getExtensionOfBase64EncodeImage(e),m=POLARIS.tools.getRandomString(36)+m;"BAI"!==a.config.customer||void 0!=c&&""!=c?0<b&&c?(n=n.replace(e,"./"+c+m),n=n.replace(e,"./"+c+m)):(n=n.replace(e,"./"+d+".files/"+m),n=n.replace(e,"./"+d+".files/"+m)):(n=n.replace(e,"./"+m),n=n.replace(e,"./"+m));h[l]=m;k[l]=e;l++;g==l&&f({id:b,fileName:"",content:n,imgNames:h,imgUris:k})}},td:function(a){}}},{applyToAll:!0});e=POLARIS.htmlParser.fragment.fromHtml(e);
var p=new POLARIS.htmlParser.basicWriter;m.applyTo(e);e.writeHtml(p)}}function m(a,b,c,d,e){var h=t(a,d);if(1>h)e({id:b,fileName:"",content:d});else{var k=function(b,c,d){var e=0,g=new POLARIS.htmlParser.filter,k=c;g.addRules({elements:{img:function(c){var g=c.attributes.src;if(0<=g.toLowerCase().indexOf("data:image")){c=POLARIS.tools.getExtensionOfBase64EncodeImage(g);c=POLARIS.tools.getRandomString(36)+c;var l=POLARIS.tools.getImageStreamOfBase64EncodeImage(g);f(a,b,l,c,function(a){k=k.replace(g,
a);k=k.replace(g,a);e++;h==e&&d({id:b,fileName:"",content:k})})}},td:function(a){}}},{applyToAll:!0});c=POLARIS.htmlParser.fragment.fromHtml(c);var l=new POLARIS.htmlParser.basicWriter;g.applyTo(c);c.writeHtml(l)};0>b?g(a,"",c,"\x3cp\x3e\x3cbr\x3e\x3c/p\x3e",function(a){POLARIS.log.docconv("HTML file is created. id \x3d "+a.id);k(a.id,d,e)}):k(b,d,e)}}function n(a,b,c,d,e,f,g){B=new POLARIS.ElapseTime;var h=q();h.onreadystatechange=function(){v(a,h,f)};h.onload=function(){};if("application/x-www-form-urlencoded"===
e){for(var k="",l=0,m=0;m<Object.keys(c).length;m++){var n=Object.keys(c)[m];c[n]&&(0<l&&(k+="\x26"),k+=n+"\x3d"+c[n]);l++}c=k}g||(g=!1);try{"GET"==d?(c=c?"?"+c+"\x26t\x3d"+(new Date).getTime():"?t\x3d"+(new Date).getTime(),h.open(d,b+c,!1),h.send()):(h.open(d,b,!1),e&&h.setRequestHeader("Content-type",e),h.send(c))}catch(p){f({success:!1}),POLARIS.log.docconv("There was a problem with the request.("+p+")")}}function q(){var a;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=
new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}return a?a:(alert("Giving up :( Cannot create an XMLHTTP instance"),!1)}function v(a,b,d){if(4===b.readyState)if(200===b.status){var e=eval("("+b.responseText+")");b=e.write?e.write:0;var f=e.totalTime?e.totalTime:0;if(a.documentconvert.mCurrRequestCode==x.CONVERT_DOC_TO_HTML||a.documentconvert.mCurrRequestCode==x.CONVERT_HTML_TO_DOC||a.documentconvert.mCurrRequestCode==x.CONVERT_DOC_TO_PDF||a.documentconvert.mCurrRequestCode==
x.CONVERT_HTML_TO_DOC_AT_ONCE||a.documentconvert.mCurrRequestCode==x.CONVERT_HWP_TO_ODT||a.documentconvert.mCurrRequestCode==x.CONVERT_ODT_TO_HTML){if(e.success){u=new POLARIS.ElapseTime;var g=a.documentconvert.mDocConvertPollingCnt=0,h=a.documentconvert.mDocConvertPollingTime[g],h=h?h:500;POLARIS.log.docconv("Document converting request is successed. result.id \x3d "+e.id+", elapsed "+B.elapse()+", write \x3d "+b+", totalTime \x3d "+f+", pollingCnt \x3d "+g+", pollingTime \x3d "+h);setTimeout(function(){c(a,
e.id,d)},h);a.documentconvert.mCurrRequestCode==x.CONVERT_DOC_TO_HTML&&(a.documentconvert.mCurrDocToHtmlId=e.id);e.stamp&&(a.documentconvert.mCurrDocmentStamp=e.stamp,a.documentconvert.mOpenedDocumentStamp&&a.documentconvert.mCurrRequestCode!=x.CONVERT_DOC_TO_HTML&&a.documentconvert.mCurrRequestCode!=x.CONVERT_ODT_TO_HTML||(a.documentconvert.mOpenedDocumentStamp=e.stamp))}}else a.documentconvert.mCurrRequestCode==x.CONVERT_FILE_STATUS_CHECK?e.status==w.S?(b=u?u.elapse():0,POLARIS.log.docconv("Document converting is successed. result['convertId'] \x3d "+
e.convertId+", RequestElapser elapsed "+B.elapse()+", ConvertElapser elapsed "+b),a.documentconvert.mSavedDocumentIdList.push(e.convertId),e.success=!0,e.stamp=a.documentconvert.mCurrDocmentStamp,d(e),a.fire("updateFilenameCode",e.originalname)):e.status!=w.F?(a.documentconvert.mDocConvertPollingCnt++,g=a.documentconvert.mDocConvertPollingCnt,h=(h=a.documentconvert.mDocConvertPollingTime[g])?h:500,POLARIS.log.docconv("Document converting is in progress...convert status\x3d"+e.status+", elapsed "+
B.elapse()+", pollingCnt \x3d "+g+", pollingTime \x3d "+h),setTimeout(function(){c(a,e.convertId,d)},h)):(POLARIS.log.docconv("Document converting is failed, elapsed "+B.elapse()),e.success=!1,d(e)):a.documentconvert.mCurrRequestCode==x.DOCUMENT_DELETE?(POLARIS.log.docconv("onResponse DOCUMENT_DELETE result \x3d "+e.success+", elapsed "+B.elapse()),e.success&&(a.documentconvert.mCurrDocumentId=-1,a.documentconvert.mCurrDocumentPath="",a.documentconvert.mCurrDocToHtmlId=-1),d(e)):a.documentconvert.mCurrRequestCode==
x.GET_DOCUMENT_LIST?d(e):a.documentconvert.mCurrRequestCode==x.GET_DOCUMENT_INFO?(POLARIS.log.docconv("onResponse GET_DOCUMENT_INFO result \x3d "+e.success+", elapsed "+B.elapse()),d(e)):a.documentconvert.mCurrRequestCode==x.SAVE_HTML?(POLARIS.log.docconv("onResponse SAVE_HTML result \x3d "+e.success+", result['id'] \x3d "+e.id+", elapsed "+B.elapse()+", write \x3d "+b+", totalTime \x3d "+f),e.stamp&&(a.documentconvert.mCurrDocmentStamp=e.stamp,a.documentconvert.mOpenedDocumentStamp=e.stamp),e.success&&
(a.documentconvert.mCurrDocumentId=e.id,a.documentconvert.mCurrDocumentPath=e.path),d(e)):a.documentconvert.mCurrRequestCode==x.SAVE_HTML_FRAGMENT?(POLARIS.log.docconv("onResponse SAVE_HTML_FRAGMENT result \x3d "+e.success+", result['id'] \x3d "+e.id+", elapsed "+B.elapse()+", write \x3d "+b+", totalTime \x3d "+f),e.stamp&&(a.documentconvert.mCurrDocmentStamp=e.stamp,a.documentconvert.mOpenedDocumentStamp=e.stamp),e.success&&a.documentconvert.mSavedDocumentIdList.push(e.id),d(e)):a.documentconvert.mCurrRequestCode==
x.GET_HTML?(POLARIS.log.docconv("onResponse GET_HTML result \x3d "+e.success+", result['id'] \x3d "+e.id+", elapsed "+B.elapse()),e.success&&(a.documentconvert.mCurrDocumentId=e.id,a.documentconvert.mCurrDocumentPath=e.path,b=e.content,65279==b.charCodeAt(0)&&(b=b.slice(1)),b=r(a,b,e.id,e.path),d(b))):a.documentconvert.mCurrRequestCode==x.GET_HTML_FILE_URL?(POLARIS.log.docconv("onResponse GET_HTML_FILE_URL result \x3d "+e.success+", elapsed "+B.elapse()),d(e.convertId.documentconvert.STATIC_BASE_URL+
"/"+e.filename+"/undefined.html",e.convertId)):a.documentconvert.mCurrRequestCode==x.UPLOAD_IMAGE?(POLARIS.log.docconv("onResponse UPLOAD_IMAGE result \x3d "+e.success+", elapsed "+B.elapse()+", write \x3d "+b+", totalTime \x3d "+f),d(a.documentconvert.STATIC_BASE_URL+"/"+a.documentconvert.mCurrDocumentId+"/"+e.path)):a.documentconvert.mCurrRequestCode==x.FILE_COPY_TO_SHARE_STORAGE?(POLARIS.log.docconv("onResponse FILE_COPY_TO_SHARE_STORAGE result \x3d "+e.success+", elapsed "+B.elapse()+", write \x3d "+
b+", totalTime \x3d "+f),d(e)):a.documentconvert.mCurrRequestCode==x.IMAGE_COPY?(POLARIS.log.docconv("onResponse IMAGE_COPY result \x3d "+e.success+", elapsed "+B.elapse()+", write \x3d "+b+", totalTime \x3d "+f),d(e)):a.documentconvert.mCurrRequestCode==x.SAVE_PUBDOCBODY?(POLARIS.log.docconv("onResponse SAVE_PUBDOCBODY result \x3d "+e.success+", elapsed "+B.elapse()+", write \x3d "+b+", totalTime \x3d "+f),d(e)):a.documentconvert.mCurrRequestCode==x.READ_FILE_TO_RAW_DATA?(POLARIS.log.docconv("onResponse READ_FILE_TO_RAW_DATA result \x3d "+
e.success+", elapsed "+B.elapse()),d(e)):a.documentconvert.mCurrRequestCode==x.GET_IMAGE_PATH?(POLARIS.log.docconv("onResponse GET_IMAGE_PATH result \x3d "+e.success+", elapsed "+B.elapse()),e={path:e.originalname+".files/"},d(e)):(POLARIS.log.docconv("Request code is not vaild.. "+a.documentconvert.mCurrRequestCode+", elapsed "+B.elapse()),d({success:!1}))}else d({success:!1}),POLARIS.log.docconv("There was a problem with the request.("+b.status+")")}function r(a,b,c){var d=new POLARIS.htmlParser.filter;
d.addRules({elements:{page:function(b){if(b.attributes["background-image"]){var d=b.attributes["background-image"],e,f;0<=(e=d.indexOf("./"))?f=d.substr(e+2,d.length):0<=(e=d.indexOf("//"))&&(f=d.substr(e+2,d.length));d=a.documentconvert.STATIC_BASE_URL+"/"+c+"/"+f;b.attributes["background-image"]=d}},img:function(b){var d=b.attributes.src;if(!(0<=d.indexOf("data:image"))){var e,f;0<=(e=d.indexOf("./"))?f=d.substr(e+2,d.length):0<=(e=d.indexOf("//"))&&(f=d.substr(e+2,d.length));d=a.documentconvert.STATIC_BASE_URL+
"/"+c+"/"+f;b.attributes.src=d}},td:function(b){if(void 0!==b.attributes.style&&"string"==typeof b.attributes.style&&0<b.attributes.style.indexOf("background-image")){var d=b.attributes.style,e=d.match(/(background-image[\s:]*url\s*\(\s*(?:"|'|&quot;)+)([\s\S]*[^'"])((?:"|'|&quot;)+\s*\))/i);if(null!=e){var f=e[2],g,h;0<=(g=f.indexOf("./"))?h=f.substr(g+2,f.length):0<=(g=f.indexOf("//"))&&(h=f.substr(g+2,f.length));f=a.documentconvert.STATIC_BASE_URL+"/"+c+"/"+h;b.attributes.style=d.replace(e[0],
e[1]+f+e[3])}}}}},{applyToAll:!0});b=POLARIS.htmlParser.fragment.fromHtml(b);var e=new POLARIS.htmlParser.basicWriter;d.applyTo(b);b.writeHtml(e);return e.getHtml(!0)}function p(a,b,c,d){var e=new POLARIS.htmlParser.filter;e.addRules({elements:{page:function(b){if(b.attributes["background-image"]){var e=b.attributes["background-image"],f=a.documentconvert.STATIC_BASE_URL+"/"+c+"/",f=e.indexOf(f)+f.length;d?(f=e.lastIndexOf("/"),e=e.substr(f+1,e.length),e=d.indexOf("/")==d.length-1?"./"+d+e:"./"+d+
"/"+e):e="./"+e.substr(f,e.length);b.attributes["background-image"]=e}},img:function(b){var e=b.attributes.src;if(!(0<=e.indexOf("data:image"))){var f=a.documentconvert.STATIC_BASE_URL+"/"+c+"/",f=e.indexOf(f)+f.length;d?(f=e.lastIndexOf("/"),e=e.substr(f+1,e.length),e=d.indexOf("/")==d.length-1?"./"+d+e:"./"+d+"/"+e):e="./"+e.substr(f,e.length);POLARIS.log.docconv("id \x3d "+c+", path \x3d "+d+", relativePath \x3d "+e+", src \x3d "+b.attributes.src);b.attributes.src=e}},td:function(b){if(void 0!==
b.attributes.style&&"string"==typeof b.attributes.style&&0<b.attributes.style.indexOf("background-image")){var e=b.attributes.style,f=e.match(/(background-image[\s:]*url\s*\(\s*(?:"|'|&quot;)+)([\s\S]*[^'"])((?:"|'|&quot;)+\s*\))/i);if(null!=f){var g=f[2],h=a.documentconvert.STATIC_BASE_URL+"/"+c+"/",h=g.indexOf(h)+h.length;d?(h=g.lastIndexOf("/"),g=g.substr(h+1,g.length),g=d.indexOf("/")==d.length-1?"./"+d+g:"./"+d+"/"+g):g="./"+g.substr(h,g.length);b.attributes.style=e.replace(f[0],f[1]+g+f[3])}}}}},
{applyToAll:!0});b=POLARIS.htmlParser.fragment.fromHtml(b);var f=new POLARIS.htmlParser.basicWriter;e.applyTo(b);b.writeHtml(f);return f.getHtml(!0)}function t(a,b){var c=[],d=new POLARIS.htmlParser.filter;d.addRules({elements:{img:function(a){a=a.attributes.src;0<=a.toLowerCase().indexOf("data:image")&&c.push(a)},td:function(a){}}},{applyToAll:!0});var e=POLARIS.htmlParser.fragment.fromHtml(b),f=new POLARIS.htmlParser.basicWriter;d.applyTo(e);e.writeHtml(f);return c.length}var w={Q:"Q",R:"R",P:"P",
C:"C",S:"S",F:"F"},A={JPEG:"JPEG",PNG:"PNG",PDF:"PDF",HTOD:"HTOD",HTOP:"HTOP",DTOH:"DTOH",SAVE:"SAVE"},x={CONVERT_HTML_TO_DOC:0,CONVERT_DOC_TO_HTML:1,CONVERT_FILE_STATUS_CHECK:2,GET_DOCUMENT_LIST:3,GET_HTML:4,GET_HTML_FILE_URL:5,SAVE_HTML:6,UPLOAD_IMAGE:7,DELETE_UPLOADED_IMAGE:8,DOCUMENT_DELETE:9,CONVERT_DOC_TO_PDF:10,FILE_COPY_TO_SHARE_STORAGE:11,IMAGE_COPY:12,SAVE_PUBDOCBODY:13,SAVE_HTML_FRAGMENT:14,READ_FILE_TO_RAW_DATA:15,GET_DOCUMENT_INFO:16,CONVERT_HTML_TO_DOC_AT_ONCE:17,GET_IMAGE_PATH:18,CONVERT_HWP_TO_ODT:19,
CONVERT_ODT_TO_HTML:20},C=function(){this.STATIC_BASE_URL=this.DYNAMIC_BASE_URL="";this.mCurrRequestCode=null;this.mCurrDocumentId=-1;this.mCurrDocumentPath="";this.mSavedDocumentIdList=[];this.mCurrDocToHtmlId=-1;this.mOpenedDocumentStamp=this.mCurrDocmentStamp=null;this.mDocConvertPollingTime=[400,100,100,100,100,100,100];this.mDocConvertPollingCnt=0};POLARIS.plugins.add("documentconvert",{init:function(h){h.documentconvert=new C;h.documentconvert.DYNAMIC_BASE_URL=h.config.docConvertingUrl;h.documentconvert.STATIC_BASE_URL=
h.config.docConvertingUrl;h.addCommand("requestGetFileList",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.page,d=b.size,e=b.key,f=b.mode,g=b.callback;a.documentconvert.mCurrRequestCode=x.GET_DOCUMENT_LIST;var h={};h.key=e;h.mode=f;h.page=c;h.size=d;n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/list",h,"GET","application/x-www-form-urlencoded",g,!0)}});h.addCommand("requestGetConvertedFileStatus",{editorFocus:!1,readOnly:1,exec:function(a,b){c(a,b.id,b.callback)}});h.addCommand("requestConvertFileToHTML",
{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.openType,d=b.filePath,e=b.name,f=b.callback;a.documentconvert.mCurrRequestCode=x.CONVERT_DOC_TO_HTML;var g="",h={},k="",l=A.DTOH;if("multipartfile"===c)h=new FormData,h.append("file",d),h.append("convertType",l),g="",k="POST";else if("cloud"===c||"local"===c)h.type=c,h.url=d,h.name=encodeURIComponent(e),h.convertType=l,g="application/x-www-form-urlencoded",k="GET";POLARIS.log.docconv("request url \x3d /file/upload, openType \x3d "+c+", filePath \x3d "+
d+" , contentType \x3d "+g);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/upload",h,k,g,f,!0)}});h.addCommand("requestConvertDocToPDF",{editorFocus:!1,readOnly:1,exec:function(a,b){e(a,b.id,b.extension,b.callback)}});h.addCommand("requestConvertHTMLToDoc",{editorFocus:!1,readOnly:1,exec:function(a,c){b(a,c.id,c.extension,c.callback)}});h.addCommand("requestConvertHTMLToPDF",{editorFocus:!1,readOnly:1,exec:function(b,c){a(b,c.id,c.extension,c.callback)}});h.addCommand("requestConvertHTMLToDocAtOnce",
{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.fileName,e=b.extension,f=b.html,g=b.imgNames,h=b.imgUris,k=b.resultPath,l=b.callback;a.documentconvert.mCurrRequestCode=x.CONVERT_HTML_TO_DOC_AT_ONCE;var m=A.HTOD;"pdf"==e&&(m=A.HTOP,e="odt");var p=new FormData,r=[];r.push(c);p.append("extension","odt");p.append("convertType",m);p.append("name",encodeURIComponent(d));k&&""!==k&&p.append("result",k);-1<c&&p.append("baseId",r);f=new Blob([f],{type:"text/html"});p.append("html",f,d);if(h)for(f=
0;f<h.length;f++){for(var r=h[f],k=atob(r.split(",")[1]),r=r.split(",")[0].split(":")[1].split(";")[0],q=new ArrayBuffer(k.length),t=new Uint8Array(q),u=0;u<k.length;u++)t[u]=k.charCodeAt(u);k=new Blob([q],{type:r});p.append("images",k,g[f])}POLARIS.log.docconv("request url \x3d /html/convert, id \x3d "+c+", extension \x3d "+e+", convertType \x3d "+m+", fileName \x3d "+d);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/convert",p,"POST","",l,!0)}});h.addCommand("requestConvertHWPToODTToHTML",{editorFocus:!1,
readOnly:1,exec:function(a,b){d(a,b.openType,b.filePath,b.name,b.callback)}});h.addCommand("requestSaveHTML",{editorFocus:!1,readOnly:1,exec:function(a,b){g(a,b.id,b.fileName,b.html,b.callback)}});h.addCommand("requestSaveHTMLFragment",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.fileName,e=b.html,f=b.callback;a.documentconvert.mCurrRequestCode=x.SAVE_HTML_FRAGMENT;var g={};g.id=c;g.subject=encodeURIComponent(d);g.content=encodeURIComponent(e);POLARIS.log.docconv("request url \x3d /html/save, params.id \x3d "+
g.id+", params.subject \x3d "+g.subject+" , params.content \x3d "+g.content.length);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/save",g,"POST","application/x-www-form-urlencoded",f,!0)}});h.addCommand("requestGetHTML",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.callback;a.documentconvert.mCurrRequestCode=x.GET_HTML;var e={};e.id=c;a.documentconvert.mCurrDocmentStamp&&(e.stamp=a.documentconvert.mCurrDocmentStamp);POLARIS.log.docconv("request url \x3d /html/download, params.id \x3d "+
e.id);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/download",e,"POST","application/x-www-form-urlencoded",d,!0)}});h.addCommand("getPDFFileUrl",{editorFocus:!1,readOnly:1,exec:function(a,b){POLARIS.log.docconv("getPDFFileUrl, url \x3d /file/download/"+b.id+".pdf");b.returnValue=a.documentconvert.DYNAMIC_BASE_URL+"/file/download/"+b.id+".pdf";POLARIS.tools.isEmpty(b.stamp)||(b.returnValue+="?stamp\x3d"+b.stamp)}});h.addCommand("getODTFileUrl",{editorFocus:!1,readOnly:1,exec:function(a,b){POLARIS.log.docconv("getPDFFileUrl, url \x3d /file/download/"+
b.id+".pdf");b.returnValue=a.documentconvert.DYNAMIC_BASE_URL+"/file/download/"+b.id+".odt?type\x3dHTOD";POLARIS.tools.isEmpty(b.stamp)||(b.returnValue+="\x26stamp\x3d"+b.stamp)}});h.addCommand("requestGetPDFFileDownload",{editorFocus:!1,readOnly:1,exec:function(a,b){k(a,b)}});h.addCommand("requestGetHTMLFileURL",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.callback;a.documentconvert.mCurrRequestCode=x.GET_HTML_FILE_URL;POLARIS.log.docconv("request url \x3d /file/convert/"+c);n(a,
a.documentconvert.DYNAMIC_BASE_URL+"/file/convert/"+c,"","GET","",d,!0)}});h.addCommand("requestDeleteFile",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.callback;a.documentconvert.mCurrRequestCode=x.DOCUMENT_DELETE;var e={};e.id=c;POLARIS.log.docconv("request url \x3d /file/delete, params.id \x3d "+e.id);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/delete",e,"POST","application/x-www-form-urlencoded",d)}});h.addCommand("requestDeleteSavedFiles",{editorFocus:!1,readOnly:1,exec:function(a,
b){var c=b.callback;a.documentconvert.mCurrRequestCode=x.DOCUMENT_DELETE;var d={};d.id=a.documentconvert.mSavedDocumentIdList;!d.id||1>d.id.length?POLARIS.log.docconv("request url \x3d /file/delete, params.id is null "):(POLARIS.log.docconv("request url \x3d /file/delete, params.id \x3d "+d.id),n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/delete",d,"POST","application/x-www-form-urlencoded",c))}});h.addCommand("requestUploadLocalImage",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.file,
e=b.callback;a.documentconvert.mCurrRequestCode=x.UPLOAD_IMAGE;var f=new FormData;f.append("id",c);f.append("file",d);POLARIS.log.docconv("request url \x3d /html/upload, id \x3d "+c+", file \x3d "+d);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/upload",f,"POST","application/x-www-form-urlencoded",e)}});h.addCommand("requestUploadExternalImage",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.url,e=b.callback;a.documentconvert.mCurrRequestCode=x.UPLOAD_IMAGE;var f=d.split("/"),f=f[f.length-
1],g={};g.id=c;g.url=d;g.name=f;a.documentconvert.mOpenedDocumentStamp&&(g.stamp=a.documentconvert.mOpenedDocumentStamp);POLARIS.log.docconv("request url \x3d /html/upload, id \x3d "+c+", url \x3d "+d+", name \x3d "+f);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/upload",g,"POST","application/x-www-form-urlencoded",e)}});h.addCommand("requestUploadBase64EncodedImage",{editorFocus:!1,readOnly:1,exec:function(a,b){f(a,b.id,b.raw,b.name,b.callback)}});h.addCommand("requestDeleteUploadedImage",{editorFocus:!1,
readOnly:1,exec:function(a,b){var c=b.id,d=b.name,e=b.callback;a.documentconvert.mCurrRequestCode=x.DELETE_UPLOADED_IMAGE;var f={};f.id=c;f.name=d;POLARIS.log.docconv("request url \x3d /html/delete, params.id \x3d "+f.id+", params.name \x3d "+f.name);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/delete",f,"POST",contentType,e)}});h.addCommand("appendRemoteAddrToImgSrc",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=r(a,b.html,b.id)}});h.addCommand("removeRemoteAddrToImgSrc",{editorFocus:!1,
readOnly:1,exec:function(a,b){b.returnValue=p(a,b.html,b.id,b.path)}});h.addCommand("getStaticUrlByIdAndName",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.STATIC_BASE_URL+"/"+b.id+"/"+b.filename+".html"}});h.addCommand("getCurrDocumentId",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.mCurrDocumentId}});h.addCommand("getCurrDocumentPath",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.mCurrDocumentPath}});
h.addCommand("getOpenedDocumentStamp",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.mOpenedDocumentStamp}});h.addCommand("getImgPath",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.fileName,e=b.callback;0<c?(a.documentconvert.mCurrRequestCode=x.GET_IMAGE_PATH,POLARIS.log.docconv("request url \x3d /file/convert/"+c),n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/convert/"+c,"","GET","",e,!0)):e({path:d+".files/"})}});h.addCommand("setCurrDocumentId",{editorFocus:!1,
readOnly:1,exec:function(a,b){a.documentconvert.mCurrDocumentId=b.id;b.returnValue=void 0}});h.addCommand("setOpenedDocumentStamp",{editorFocus:!1,readOnly:1,exec:function(a,b){a.documentconvert.mOpenedDocumentStamp=b.stamp;b.returnValue=void 0}});h.addCommand("getCurrDocToHtmlId",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.mCurrDocToHtmlId}});h.addCommand("getDataForImageUpload",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue={url:a.documentconvert.DYNAMIC_BASE_URL+
"/html/upload",formData:{id:b.id,stamp:b.stamp,name:b.filename,upload:b.file},headers:{"Content-type":""}}}});h.addCommand("getStaticUrlForUploadedImage",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.STATIC_BASE_URL+"/"+b.id+"/"+b.filename}});h.addCommand("getSavedDocumentIdList",{editorFocus:!1,readOnly:1,exec:function(a,b){b.returnValue=a.documentconvert.mSavedDocumentIdList}});h.addCommand("requestFileCopyToShareStorage",{editorFocus:!1,readOnly:1,exec:function(a,
b){var c=b.id,d=b.path,e=b.name,f=b.callback;a.documentconvert.mCurrRequestCode=x.FILE_COPY_TO_SHARE_STORAGE;var g={};g.id=c;g.path=d;g.name=encodeURIComponent(e);POLARIS.log.docconv("request url \x3d /file/copy, id \x3d "+c+", path \x3d "+d);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/copy",g,"POST","application/x-www-form-urlencoded",f,!0)}});h.addCommand("requestImageCopy",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.fromId,d=b.toId,e=b.callback;a.documentconvert.mCurrRequestCode=x.IMAGE_COPY;
var f={};f.from=c;f.to=d;POLARIS.log.docconv("request url \x3d /html/copy, fromId \x3d "+c+", toId \x3d "+d);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/html/copy",f,"POST","application/x-www-form-urlencoded",e)}});h.addCommand("requestSavePubDocBody",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.fileName,d=b.content,e=b.callback;a.documentconvert.mCurrRequestCode=x.SAVE_PUBDOCBODY;var f={};f.subject=encodeURIComponent(c);f.content=encodeURIComponent(d);POLARIS.log.docconv("request url \x3d /file/save, fileName \x3d "+
c);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/save",f,"POST","application/x-www-form-urlencoded",e,!0)}});h.addCommand("getBase64EncodeImageInfo",{editorFocus:!1,readOnly:1,exec:function(a,b){l(a,b.id,b.path,b.fileName,b.html,b.callback)}});h.addCommand("requestBase64EncodeImageUploadBeforeSaveHTML",{editorFocus:!1,readOnly:1,exec:function(a,b){m(a,b.id,b.fileName,b.html,b.callback)}});h.addCommand("requestReadFileToRawData",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.path,d=b.name,e=
b.callback;a.documentconvert.mCurrRequestCode=x.READ_FILE_TO_RAW_DATA;var f={};f.path=c;f.name=d;POLARIS.log.docconv("request url \x3d /file/content, path \x3d "+c+" , name \x3d "+d);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/content",f,"POST","application/x-www-form-urlencoded",e)}});h.addCommand("requestDocumentInfo",{editorFocus:!1,readOnly:1,exec:function(a,b){var c=b.id,d=b.callback;a.documentconvert.mCurrRequestCode=x.GET_DOCUMENT_INFO;var e={};e.id=c;POLARIS.log.docconv("request url \x3d /file/info, id \x3d "+
c);n(a,a.documentconvert.DYNAMIC_BASE_URL+"/file/info",e,"GET","application/x-www-form-urlencoded",d,!0)}})}});var u,B})();(function(){function a(a,b){function g(b){b=n.list[b];if(b.equals(a.editable())||"true"==b.getAttribute("contenteditable")){var c=a.createRange();c.selectNodeContents(b);c.select()}else a.getSelection().selectElement(b);a.focus()}function k(){l&&l.setHtml('\x3cspan class\x3d"polaris_path_empty"\x3e\x26nbsp;\x3c/span\x3e');delete n.list}var f=a.ui.spaceId("path"),l,m=function(){l||
(l=POLARIS.document.getById(f));return l},n=a._.elementsPath,q=n.idBase;b.html+='\x3cspan id\x3d"'+f+'_label" class\x3d"polaris_voice_label"\x3e'+a.lang.elementspath.eleLabel+'\x3c/span\x3e\x3cspan id\x3d"'+f+'" class\x3d"polaris_path" role\x3d"group" aria-labelledby\x3d"'+f+'_label"\x3e\x3cspan class\x3d"polaris_path_empty"\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e';a.on("uiReady",function(){var b=a.ui.space("path");b&&a.focusManager.add(b,1)});n.onClick=g;var v=POLARIS.tools.addFunction(g),r=POLARIS.tools.addFunction(function(b,
c){var e=n.idBase,f;c=new POLARIS.dom.event(c);f="rtl"==a.lang.dir;switch(c.getKeystroke()){case f?39:37:case 9:return(f=POLARIS.document.getById(e+(b+1)))||(f=POLARIS.document.getById(e+"0")),f.focus(),!1;case f?37:39:case POLARIS.SHIFT+9:return(f=POLARIS.document.getById(e+(b-1)))||(f=POLARIS.document.getById(e+(n.list.length-1))),f.focus(),!1;case 27:return a.focus(),!1;case 13:case 32:return g(b),!1}return!0});a.on("selectionChange",function(){var b=[],e=m();if(e&&e.isVisible()){if(a.config.wordprocessor){var f=
function(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute("doc-data-field")};if(!a.plugins.pagination.isDocumentLoaded())return;var g=a.plugins.pagination.getCurrentPageNumber(a),h=a.plugins.pagination.getTotalPageCount(a.document),k="",k='\x3cspan class\x3d"polaris_path_item"\x3e'+g+" / "+h+" "+a.lang.elementspath.page+"\x3c/span\x3e",f=(g=(g=a.document.getSelection())&&g.getStartElement())&&g.getAscendant(f,!0);1==a.config.showFieldName&&f&&f.isEditable()&&(f=f.getAttribute("doc-data-field"),
k+='\x3cspan class\x3d"polaris_path_item"\x3e\x26nbsp;\x26nbsp;[ '+a.lang.table.cell.cellField+": "+f+" ]\x3c/span\x3e");POLARIS.config.pagination_debug?b.unshift(k):b=[k]}else{for(var g=n.list=[],k=[],h=n.filters,l=!0,B=a.elementPath().elements,G=B.length;G--;){var y=B[G],F=0,f=y.data("polaris-display-name")?y.data("polaris-display-name"):y.data("polaris-real-element-type")?y.data("polaris-real-element-type"):y.getName();(l=y.hasAttribute("contenteditable")?"true"==y.getAttribute("contenteditable"):
l)||y.hasAttribute("contenteditable")||(F=1);for(var E=0;E<h.length;E++){var H=h[E](y,f);if(!1===H){F=1;break}f=H||f}F||(g.unshift(y),k.unshift(f))}g=g.length;for(h=0;h<g;h++)f=k[h],l=a.lang.elementspath.eleTitle.replace(/%1/,f),f=c.output({id:q+h,label:l,text:f,jsTitle:"javascript:void('"+f+"')",index:h,keyDownFn:r,clickFn:v}),b.unshift(f)}e.setHtml(b.join("")+'\x3cspan class\x3d"polaris_path_empty"\x3e\x26nbsp;\x3c/span\x3e');a.fire("elementsPathUpdate",{space:e})}});a.addCommand("showStatusBar",
{modes:{wysiwyg:1},exec:function(a,b){var c=m();b?c.show():c.hide()}});a.on("readOnly",k);a.on("contentDomUnload",k);a.addCommand("elementsPathFocus",e.toolbarFocus);a.setKeystroke(POLARIS.ALT+122,"elementsPathFocus")}var e={toolbarFocus:{editorFocus:!1,readOnly:1,exec:function(a){(a=POLARIS.document.getById(a._.elementsPath.idBase+"0"))&&a.focus(POLARIS.env.ie||POLARIS.env.air)}}},b="";POLARIS.env.gecko&&POLARIS.env.mac&&(b+=' onkeypress\x3d"return false;"');POLARIS.env.gecko&&(b+=' onblur\x3d"this.style.cssText \x3d this.style.cssText;"');
var c=POLARIS.addTemplate("pathItem",'\x3ca id\x3d"{id}" href\x3d"{jsTitle}" tabindex\x3d"-1" class\x3d"polaris_path_item" title\x3d"{label}"'+b+' hidefocus\x3d"true"  onkeydown\x3d"return POLARIS.tools.callFunction({keyDownFn},{index}, event );" onclick\x3d"POLARIS.tools.callFunction({clickFn},{index}); return false;" role\x3d"button" aria-label\x3d"{label}"\x3e{text}\x3c/a\x3e');POLARIS.plugins.add("elementspath",{init:function(b){b.config.wordprocessor&&(b._.elementsPath={idBase:"polaris_elementspath_"+
POLARIS.tools.getNextNumber()+"_",filters:[]},b.on("uiSpace",function(c){"bottom"==c.data.space&&a(b,c.data)}))}})})();(function(){var a=function(){this.dom=null;this.toolbars=[];this.is_visible=!1;this.hide_on_blur=!0;this.editoroffset=this.toolbarsize=!1;this.mousepos={x:0,y:0}};POLARIS.plugins.add("floating-tools",{requires:"toolbar",init:function(e){e.on("uiSpace",function(b){b.removeListener();e.floatingtools=new a;for(var c=POLARIS.tools.getNextId(),d=["\x3cstyle\x3e",".pos-relative {position:relative}",
".polaris_floatingtools{","position:absolute;","left:0;","top:-50000px;","border:1px solid #b1b1b1;","border-radius:3px;","box-shadow: 0 1px 10px rgba(0,0,0,0.3);","background: #ffffff;","}","\x3c/style\x3e",'\x3cspan id\x3d"',c,'" class\x3d"polaris_voice_label"\x3e',e.lang.toolbar.toolbars,"\x3c/span\x3e",'\x3cspan id\x3d"'+e.ui.spaceId("floatingtools")+'" class\x3d"polaris_floatingtools polaris_top" role\x3d"group" aria-labelledby\x3d"',c,'" onmousedown\x3d"return false;"\x3e'],h,g,c=e.floatingtools.toolbars,
k=getFloatingToolbarConfig(e),f=0;f<k.length;f++){var l,m=0,n,q=k[f],v;if(q)if(h&&(d.push("\x3c/span\x3e"),g=h=0),"/"===q)d.push('\x3cspan class\x3d"polaris_toolbar_break"\x3e\x3c/span\x3e');else{v=q.items||q;for(var r=0;r<v.length;r++){var p=v[r],t;if(p){var w=function(a){a=a.render(e,d);A=m.items.push(a)-1;0<A&&(a.previous=m.items[A-1],a.previous.next=a);a.toolbar=m};if(p.type==POLARIS.UI_SEPARATOR)g=h&&p;else{t=!1!==p.canGroup;if(!m){l=POLARIS.tools.getNextId();m={id:l,items:[]};n=q.name&&(e.lang.toolbar.toolbarGroups[q.name]||
q.name);d.push('\x3cspan id\x3d"',n,'" class\x3d"polaris_toolbar"',n?' aria-labelledby\x3d"'+l+'_label"':"",' role\x3d"toolbar"\x3e');n&&d.push('\x3cspan id\x3d"',l,'_label" class\x3d"polaris_voice_label"\x3e',n,"\x3c/span\x3e");d.push('\x3cspan class\x3d"polaris_toolbar_start"\x3e\x3c/span\x3e');var A=c.push(m)-1;0<A&&(m.previous=c[A-1],m.previous.next=m)}t?h||(d.push('\x3cspan class\x3d"polaris_toolgroup" role\x3d"presentation"\x3e'),h=1):h&&(d.push("\x3c/span\x3e"),h=0);g&&(w(g),g=0);w(p)}}}h&&
(d.push("\x3c/span\x3e"),g=h=0);m&&d.push('\x3cspan class\x3d"polaris_toolbar_end"\x3e\x3c/span\x3e\x3c/span\x3e')}}d.push("\x3c/span\x3e");b.data.html+=d.join("")});e.on("contentDom",function(a){unfocus_toolbar();e.document.on("mouseup",function(a){data=a.data.$;if(0!==data.button||data.ctrlKey||data.altKey||data.shiftKey)return hide_toolbar(e),!0;if(2==e.config.editMode){var b=a.data.getTarget();if(b&&b.type==POLARIS.NODE_ELEMENT&&!b.isEditable()){hide_toolbar(e);a.data.preventDefault();return}}setTimeout(function(){is_table_selected()||
is_text_selected()||is_table_focused()?(set_mousepos(a.data.$),e.execCommand("showFloatingTools")):e.execCommand("hideFloatingTools")},100)});e.document.on("keyup",function(a){hide_toolbar(e)});e.on("blur",function(a){e.floatingtools.hide_on_blur&&hide_toolbar(e)});toolbar=get_element(e);toolbar.on("mouseover",function(a){focus_toolbar()});toolbar.on("mouseout",function(a){unfocus_toolbar()});e.container.addClass("pos-relative");e.on("beforeCommandExec",function(a){"copy"!=a.data.name&&"cut"!=a.data.name&&
"paste"!=a.data.name&&"pastetext"!=a.data.name&&"pastefromword"!=a.data.name||hide_toolbar(e)})});e.addCommand("showFloatingTools",{canUndo:!1,exec:function(a){if(is_table_selected()||is_text_selected()||is_table_focused()){var c=POLARIS.document.getById("FloatingCol1"),d=POLARIS.document.getById("FloatingCol2"),e=POLARIS.document.getById("FloatingCol3"),g=POLARIS.document.getById("FloatingTableAlign"),k=POLARIS.document.getById("FloatingCellAlign");c.removeStyle("display");d.removeStyle("display");
e.removeStyle("display");g.removeStyle("display");k.removeStyle("display");is_table_selected()?(d.setStyle("display","none"),e.setStyle("display","none"),g.setStyle("display","none"),k.setStyle("display","none")):is_text_selected()?(c.setStyle("display","none"),g.setStyle("display","none"),k.setStyle("display","none")):is_table_focused()&&(c.setStyle("display","none"),d.setStyle("display","none"),e.setStyle("display","none"));toolbar=get_element(a);unfocus_toolbar();toolbar.show();size=get_toolbar_size();
offset=get_editor_offset();pos=get_mousepos();toolpos=calculate_position(pos,size,offset);toolbar.setStyles({left:toolpos.x+"px",top:toolpos.y+"px"});a.floatingtools.is_visible=!0}}});e.addCommand("hideFloatingTools",{editorFocus:!1,canUndo:!1,exec:function(a){hide_toolbar(a)}});hide_toolbar=function(a){a&&(e=a);0!=e.floatingtools.is_visible&&(toolbar=get_element(e),toolbar.hide(),e.floatingtools.is_visible=!1)};set_mousepos=function(a,c){c&&(e=c);e.floatingtools.mousepos={left:a.clientX,top:a.clientY}};
get_mousepos=function(a){a&&(e=a);return e.floatingtools.mousepos};get_element=function(a){a&&(e=a);e.floatingtools.dom||(a=e.ui.spaceId("floatingtools"),e.floatingtools.dom=POLARIS.document.getById(a));return e.floatingtools.dom};get_editor_offset=function(a){a&&(e=a);e.floatingtools.editoroffset||(a=e.ui.spaceId("contents"),a=POLARIS.document.getById(a),e.floatingtools.editoroffset={left:a.$.offsetLeft,top:a.$.offsetTop,width:a.$.offsetWidth,height:a.$.offsetHeight});return e.floatingtools.editoroffset};
calculate_position=function(a,c,d){toolpos={x:a.left+d.left-c.width/2,y:a.top+d.top+c.height/2};toolpos.x<d.left+2&&(toolpos.x=d.left+2);a.left+c.width/2>=d.left+d.width-2&&(toolpos.x=d.left+d.width-c.width-2);toolpos.y<d.top&&(toolpos.y=d.top);d.top+a.top>toolpos.y&&d.top+a.top<toolpos.y+c.height&&(toolpos.y=d.top+a.top+24);return toolpos};get_toolbar_size=function(a){a&&(e=a);e.floatingtools.toolbarsize||(a=get_element(e),e.floatingtools.toolbarsize={width:a.$.offsetWidth,height:a.$.offsetHeight});
return e.floatingtools.toolbarsize};is_text_selected=function(){var a=e.getSelection().getSelectedText(),c=e.getSelection().getType();replaceText=a&&a.replace(/(^\s*)|(\s*$)/gi,"");isTextSelected=!1;""!=replaceText&&c==POLARIS.SELECTION_TEXT&&(isTextSelected=!0);return isTextSelected};is_table_selected=function(){var a=!1;1<POLARIS.plugins.tabletools.getSelectedCells(e.getSelection(),"cell").length&&(a=!0);return a};is_table_focused=function(){if(!e.config.showTableAlignFloatingTool)return!1;var a=
!1;1==POLARIS.plugins.tabletools.getSelectedCells(e.getSelection(),"cell").length&&(a=!0);return a};focus_toolbar=function(){obj=get_element(e)};unfocus_toolbar=function(){};getFloatingToolbarConfig=function(a){function c(){var c=getPrivateFloatingToolbarGroups(a);return e(c)}function d(c,d){if(d.length){c.items?c.items.push(a.ui.create("-")):c.items=[];for(var e;e=d.shift();)e="string"==typeof e?e:e.name,g&&-1!=POLARIS.tools.indexOf(g,e)||(e=a.ui.create(e))&&a.addFeature(e)&&c.items.push(e)}}function e(a){var b=
[],c,g,h;for(c=0;c<a.length;++c)g=a[c],h={},"/"==g?b.push(g):POLARIS.tools.isArray(g)?(d(h,POLARIS.tools.clone(g)),b.push(h)):g.items&&(d(h,POLARIS.tools.clone(g.items)),h.name=g.name,b.push(h));return b}var g=a.config.removeButtons,g=g&&g.split(","),k=a.config.floatingtools;"string"==typeof k&&(k=a.config["floatingtools_"+k]);return a.toolbar=k?e(k):c()};getPrivateFloatingToolbarGroups=function(a){return a._.floatingToolsGroups||(a._.floatingToolsGroups=[{name:"FloatingCol1",items:"CellMerge CellMergeCancel CellSplit CellProperties - ApplyForEachCell ApplyAsSingleCell".split(" ")},
"/",{name:"FloatingTableAlign",items:"TableIndent TableOutdent - TableLeft TableCenter TableRight".split(" ")},"/",{name:"FloatingCellAlign",items:["VerticalAlignTop","VerticalAlignMiddle","VerticalAlignBottom"]},"/",{name:"FloatingCol2",items:["Cut","Copy","Paste","PasteText","PasteFromWord"]},"/",{name:"FloatingCol3",items:"Bold Italic Underline Strike TextColor BGColor".split(" ")}])}}})})();POLARIS.plugins.add("htmlwriter",{init:function(a){var e=new POLARIS.htmlWriter;e.forceSimpleAmpersand=
a.config.forceSimpleAmpersand;e.indentationChars=a.config.dataIndentationChars||"\t";a.dataProcessor.writer=e}});POLARIS.htmlWriter=POLARIS.tools.createClass({base:POLARIS.htmlParser.basicWriter,$:function(){this.base();this.indentationChars="\t";this.selfClosingEnd=" /\x3e";this.lineBreakChars="\n";this.sortAttributes=1;this._.indent=0;this._.indentation="";this._.inPre=0;this._.rules={};var a=POLARIS.dtd,e;for(e in POLARIS.tools.extend({},a.$nonBodyContent,a.$block,a.$listItem,a.$tableContent))this.setRules(e,
{indent:!a[e]["#"],breakBeforeOpen:1,breakBeforeClose:!a[e]["#"],breakAfterClose:1,needsSpace:e in a.$block&&!(e in{li:1,dt:1,dd:1})});this.setRules("br",{breakAfterOpen:1});this.setRules("title",{indent:0,breakAfterOpen:0});this.setRules("style",{indent:0,breakBeforeClose:1});this.setRules("pre",{breakAfterOpen:1,indent:0})},proto:{openTag:function(a){var e=this._.rules[a];this._.afterCloser&&e&&e.needsSpace&&this._.needsSpace&&this._.output.push("\n");this._.indent?this.indentation():e&&e.breakBeforeOpen&&
(this.lineBreak(),this.indentation());this._.output.push("\x3c",a);this._.afterCloser=0},openTagClose:function(a,e){var b=this._.rules[a];e?(this._.output.push(this.selfClosingEnd),b&&b.breakAfterClose&&(this._.needsSpace=b.needsSpace)):(this._.output.push("\x3e"),b&&b.indent&&(this._.indentation+=this.indentationChars));b&&b.breakAfterOpen&&this.lineBreak();"pre"==a&&(this._.inPre=1)},attribute:function(a,e){"string"==typeof e&&(this.forceSimpleAmpersand&&(e=e.replace(/&amp;/g,"\x26")),e=POLARIS.tools.htmlEncodeAttr(e));
this._.output.push(" ",a,'\x3d"',e,'"')},closeTag:function(a){var e=this._.rules[a];e&&e.indent&&(this._.indentation=this._.indentation.substr(this.indentationChars.length));this._.indent?this.indentation():e&&e.breakBeforeClose&&(this.lineBreak(),this.indentation());this._.output.push("\x3c/",a,"\x3e");"pre"==a&&(this._.inPre=0);e&&e.breakAfterClose&&(this.lineBreak(),this._.needsSpace=e.needsSpace);this._.afterCloser=1},text:function(a){this._.indent&&(this.indentation(),!this._.inPre&&(a=POLARIS.tools.ltrim(a)));
this._.output.push(a)},comment:function(a){this._.indent&&this.indentation();this._.output.push("\x3c!--",a,"--\x3e")},lineBreak:function(){!this._.inPre&&0<this._.output.length&&this._.output.push(this.lineBreakChars);this._.indent=1},indentation:function(){!this._.inPre&&this._.indentation&&this._.output.push(this._.indentation);this._.indent=0},reset:function(){this._.output=[];this._.indent=0;this._.indentation="";this._.afterCloser=0;this._.inPre=0},setRules:function(a,e){var b=this._.rules[a];
b?POLARIS.tools.extend(b,e,!0):this._.rules[a]=e}}});(function(){POLARIS.plugins.add("inserttime",{lang:"en,ko",init:function(a){a.addCommand("inserttime",{exec:function(a){var b;b=a.config.insertTimeFormat?(new Date).format(a.config.insertTimeFormat):(new Date).format(a.lang.inserttime.defaultFormat);a.insertText(b)}});a.ui.add("InsertTime",POLARIS.UI_BUTTON,{label:a.lang.inserttime.insertTimeString,command:"inserttime"});a.ui.add("InsertTimeCode",POLARIS.UI_BUTTON,{label:a.lang.inserttime.insertTimeCodeLabel,
command:"insertTimeCode"});a.addCommand("insertTimeCode",{exec:function(a){var b;b=a.config.insertTimeFormat?(new Date).format(a.config.insertTimeFormat):(new Date).format(a.lang.inserttime.defaultFormat);a.insertHtml('\x3cspan contenteditable\x3d"false" ondragstart\x3d"return false;" style\x3d"display:inline" doc-data-field\x3d"last-saved-time-code"\x3e'+b+"\x3c/span\x3e")}});a.on("updateTimeCode",function(b){b=b.editor.document.find('[doc-data-field\x3d"last-saved-time-code"]');var c;c=a.config.insertTimeFormat?
(new Date).format(a.config.insertTimeFormat):(new Date).format(a.lang.inserttime.defaultFormat);for(var d=0;d<b.count();d++)b.getItem(d).setText(c),b.getItem(d).setAttribute("contenteditable","false"),b.getItem(d).setAttribute("ondragstart","return false;"),b.getItem(d).setStyle("display","inline")});a.ui.add("FilenameCode",POLARIS.UI_BUTTON,{label:a.lang.inserttime.insertFileName,command:"filenameCode"});a.addCommand("filenameCode",{exec:function(a){a.insertHtml('\x3cspan contenteditable\x3d"false" ondragstart\x3d"return false;" style\x3d"display:inline" doc-data-field\x3d"file-name-code"\x3e'+
a.lang.inserttime.defaultFileName+"\x3c/span\x3e")}});a.on("updateFilenameCode",function(b){var c=b.data;c||(c='"'+a.lang.inserttime.defaultFileName+'"');b=b.editor.document.find('[doc-data-field\x3d"file-name-code"]');for(var d=0;d<b.count();d++)b.getItem(d).setText(c),b.getItem(d).setAttribute("contenteditable","false"),b.getItem(d).setAttribute("ondragstart","return false;"),b.getItem(d).setStyle("display","inline")});a.addCommand("timeformat",new POLARIS.dialogCommand("timeformat"));a.ui.add("InsertTimeFormat",
POLARIS.UI_BUTTON,{label:a.lang.inserttime.timeFormatLabel,command:"timeformat"});POLARIS.dialog.add("timeformat",this.path+"dialogs/timeformat.js");a.ui.add&&a.ui.add("Date",POLARIS.UI_MENUBUTTON,{label:a.lang.inserttime.insertTimeLabel,title:a.lang.inserttime.insertTimeLabel,command:"inserttime",toolbar:"input,100",onMenu:function(){return{insert_time:POLARIS.TRISTATE_OFF,insert_time_code:POLARIS.TRISTATE_OFF,time_format:POLARIS.TRISTATE_OFF,insert_file_name:POLARIS.TRISTATE_OFF}}});a.addMenuGroup("dropdownInsertTime");
var b=a.config.removeButtons;b&&(b=b&&b.split(","));var c=!0,d=!0;if(b)for(var h=0;h<b.length;h++)"InsertTimeCode"==b[h]?c=!1:"FilenameCode"==b[h]&&(d=!1);a.addMenuItems({insert_time:{label:a.lang.inserttime.insertTimeString,group:"dropdownInsertTime",command:"inserttime"}});c&&a.addMenuItems({insert_time_code:{label:a.lang.inserttime.insertTimeCodeLabel,group:"dropdownInsertTime",command:"insertTimeCode"}});a.addMenuItems({time_format:{label:a.lang.inserttime.timeFormatLabel,group:"dropdownInsertTime",
command:"timeformat"}});d&&a.addMenuItems({insert_file_name:{label:a.lang.inserttime.insertFileName,group:"dropdownInsertTime",command:"filenameCode"}})}});var a=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){a=String(a);for(b=b||2;a.length<b;)a="0"+a;return a};return function(h,g,k){var f=a;1!=arguments.length||
"[object String]"!=Object.prototype.toString.call(h)||/\d/.test(h)||(g=h,h=void 0);h=h?new Date(h):new Date;if(isNaN(h))throw SyntaxError("invalid date");g=String(f.masks[g]||g||f.masks["default"]);"UTC:"==g.slice(0,4)&&(g=g.slice(4),k=!0);var l=k?"getUTC":"get",m=h[l+"Date"](),n=h[l+"Day"](),q=h[l+"Month"](),v=h[l+"FullYear"](),r=h[l+"Hours"](),p=h[l+"Minutes"](),t=h[l+"Seconds"](),l=h[l+"Milliseconds"](),w=k?0:h.getTimezoneOffset(),A={d:m,dd:d(m),ddd:f.i18n.dayNames[n],dddd:f.i18n.dayNames[n+7],
m:q+1,mm:d(q+1),mmm:f.i18n.monthNames[q],mmmm:f.i18n.monthNames[q+12],yy:String(v).slice(2),yyyy:v,h:r%12||12,hh:d(r%12||12),H:r,HH:d(r),M:p,MM:d(p),s:t,ss:d(t),l:d(l,3),L:d(99<l?Math.round(l/10):l),t:12>r?"a":"p",tt:12>r?"am":"pm",T:12>r?"A":"P",TT:12>r?"AM":"PM",Z:k?"UTC":(String(h).match(b)||[""]).pop().replace(c,""),o:(0<w?"-":"+")+d(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),S:["th","st","nd","rd"][3<m%10?0:(10!=m%100-m%10)*m%10]};return g.replace(e,function(a){return a in A?A[a]:a.slice(1,
a.length-1)})}}();a.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};a.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};
Date.prototype.format=function(e,b){return a(this,e,b)}})();(function(){function a(a){function c(d){if(d)for(var f=0;f<d.length;f++){var l=d[f];if(!l)break;if("-"===l.name)g++,k="menubar_group_"+g,a.addMenuGroup(k,g);else if(!e||-1==POLARIS.tools.indexOf(e,l.name))if(l.items){c(l.items);var v=l.name,r=a.ui.get(l.name);r||(v=a.lang.label[v]);a.addMenuItem("menubar_item_"+l.name,{label:v,group:k,items:l.items,menubarIcon:l.name,disableshow:!0,getItems:function(){for(var c={},d=0;d<this.items.length;d++){var e=
this.items[d];a.ui.create(e.name);var f=a.ui.get(e.name);f?(e=a.getCommand(f.command),c["menubar_item_"+f.name]=e?e.state:POLARIS.TRISTATE_OFF):c["menubar_item_"+e.name]=POLARIS.TRISTATE_DISABLED}return c}})}else e&&-1!=POLARIS.tools.indexOf(e,l.name)||(a.ui.create(l.name),(r=a.ui.get(l.name))?a.addMenuItem("menubar_item_"+r.name,{label:r.label,command:r.command,group:k,menubarIcon:l.name,disableshow:!0}):a.addMenuItem("menubar_item_"+l.name,{label:l.name,group:k,menubarIcon:l.name,disableshow:!0}))}}
var d=a.config.menubar;if(d){a.config.removeParagraphNumber&&(d[4].items[2]={name:"label_outdentIndent",items:[{name:"Outdent"},{name:"Indent"}]});var e=a.config.removeButtons,e=e&&e.split(","),g=1E3,k="menubar_group_"+g;a.addMenuGroup(k,g);for(var f=0;f<d.length;f++){var l=d[f];l&&l.items&&c(l.items)}}}var e=function(){this.menus=[];this.menuItems=[];this.menuButtons=[]};POLARIS.plugins.add("menubar",{requires:"menubutton",lang:"en,ko",init:function(b){b.on("uiSpace",function(c){if(c.data.space==
b.config.menuLocation){c.removeListener();b.menubar=new e;a(b);var d=POLARIS.tools.getNextId(),h=!1!==b.config.menubarStartupExpanded,d=["\x3cstyle\x3ediv.polaris_menubar{"+(b.config.menubarBackgroundColor?"background-color:"+b.config.menubarBackgroundColor+";":"")+(b.config.menubarBorderColor?"border-bottom: 1px solid "+b.config.menubarBorderColor+";":"")+(b.config.menubarTextColor?"color:"+b.config.menubarTextColor+";":"")+"}ul.polaris_menubar_menus li.polaris_menubar_menu a.polaris_menubar_menu_button{"+
(b.config.menubarTextColor?"color:"+b.config.menubarTextColor+";":"")+"}ul.polaris_menubar_menus li.polaris_menubar_menu a.polaris_menubar_menu_button:hover{"+(b.config.menubarButtonHoverColor?"background-color:"+b.config.menubarButtonHoverColor+";":"")+"}ul.polaris_menubar_menus li.polaris_menubar_menu a.polaris_text_button_on{"+(b.config.menubarButtonSelectedColor?"background-color:"+b.config.menubarButtonSelectedColor+";border:1px solid transparent;":"")+"}\x3c/style\x3e",'\x3cspan id\x3d"',d,
'" class\x3d"polaris_voice_label"\x3e',b.lang.menubar.menubar,"\x3c/span\x3e",'\x3cdiv id\x3d"'+b.ui.spaceId("menubar")+'" class\x3d"polaris_menubar" onselectstart\x3d"return false;" ondragstart\x3d"return false;" role\x3d"menubar" aria-labelledby\x3d"',d,'" on/mousedown\x3d"return false;"'+(h&&b.config.showMenubar?"\x3e":' style\x3d"display:none"\x3e')];b.addCommand("menubarCollapse",{readOnly:1,exec:function(a,b){var c=a.ui.space("menubar"),d=a.ui.space("contents"),e=parseInt(d.$.offsetHeight,10),
f=c.getParent(),g=f.$.offsetHeight;b?c.show():c.hide();d.isVisible()||(e=POLARIS.tools.convertToPx(d.getComputedStyle("height")));d.setStyle("height",e-(f.$.offsetHeight-g)+"px");a.fire("resize")},modes:{wysiwyg:1,source:1}});b.config.menubarCanCollapse&&b.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&d.push('\x3cspan class\x3d"polaris_menubar_main" unselectable\x3d"on" \x3e');d.push('\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"width: 100%;"\x3e');h=b.config.menubar?b.config.menubar:[];for(var g=
0,k=0;k<h.length;k++){var f=h[k];if(f){var l=f.name,m=b.ui.get(f.name);m||(l=b.lang.label[l]);m="menubar_menu_button_"+f.name.toLowerCase();b.ui.add(m,POLARIS.UI_MENU_TEXT_BUTTON,{label:l,modes:{wysiwyg:1,source:1},toolbar:"menubar_menu_button",onMenu:function(a,c,d,e){if(a=b.menubar.menuItems[e])for(var f in a)if(c=b.getMenuItem(f))if(c=b.getCommand(c.command))a[f]=c.state;b.fire("ribbonMenuShow");return b.menubar.menuItems[e]}});if(l=b.ui.create(m)){0==b.menubar.menuButtons.length&&(d.push('\x3cul class\x3d"polaris_menubar_menus"\x3e'),
g=1);d.push('\x3cli class\x3d"polaris_menubar_menu"\x3e');l.hasArrow=!1;m=l.render(b,d,"_menubar_menu");b.menubar.menus.push(m);d.push("\x3c/li\x3e");for(var n={},q=0;q<f.items.length;q++){var v=f.items[q];v&&((m=b.ui.get(v.name))?n["menubar_item_"+m.name]=POLARIS.TRISTATE_OFF:"-"!==v.name&&(n["menubar_item_"+v.name]=v.items?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED))}b.menubar.menuItems[l._.id]=n;b.menubar.menuButtons.push(l)}}}g&&d.push("\x3c/ul\x3e");d.push("\x3c/td\x3e\x3ctd\x3e");var r=
POLARIS.tools.getNextId();d.push('\x3cspan class\x3d"polaris_toolbar_expand_button" style\x3d"display:none" id\x3d"'+r+'"\x3e');b.on("showToolbarExpandButton",function(a){a=a.data.display;var c=POLARIS.document.getById(r);c&&(a?(c.removeStyle("display"),b.getCommand("toolbarExpander").state=POLARIS.TRISTATE_OFF):c.setStyle("display","none"))});b.addCommand("toolbarExpander",{modes:{wysiwyg:1},readOnly:1,exec:function(a){if(this.state==POLARIS.TRISTATE_OFF){this.state=POLARIS.TRISTATE_ON;for(var b=
0;b<this.uiItems.length;b++){var c=this.uiItems[b];(c=POLARIS.document.getById(c._.id))&&c.setText(a.lang.menubar.collapseToolbar)}if(c=a.config.toolbar)for(b=0;b<c.length;b++){var d=c[b];"/"!=d&&0==d.show&&a.execCommand("toolbarShowRow",{position:b+1,show:!0,toolbarName:d.name})}}else{this.state=POLARIS.TRISTATE_OFF;for(b=0;b<this.uiItems.length;b++)c=this.uiItems[b],(c=POLARIS.document.getById(c._.id))&&c.setText(a.lang.menubar.expandToolbar);if(c=a.config.toolbar)for(b=0;b<c.length;b++)d=c[b],
"/"!=d&&0==d.show&&a.execCommand("toolbarShowRow",{position:b+1,show:!1,toolbarName:d.name})}}});m="menubar_menu_button_expand";b.ui.add(m,POLARIS.UI_TEXT_BUTTON,{label:b.lang.menubar.expandToolbar,command:"toolbarExpander"});if(h=b.ui.create(m))h.className="polaris_toolbox_collapser",h.hasArrow=!1,h.render(b,d,"_menubar_menu");d.push("\x3c/span\x3e\x3c/td\x3e");b.ui.toolbarMode&&(b.ui.add("setting",POLARIS.UI_MENU_SETTING_BUTTON,{title:b.lang.menubar.changeToolMode,toolbar:"menubar_setting",onMenu:function(){b.fire("ribbonMenuShow");
return{toolbarMode:1==b.ui.toolbarMode?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,ribbonMode:2==b.ui.toolbarMode?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF}}}),h=b.ui.create("setting"))&&(d.push("\x3c/td\x3e\x3ctd\x3e"),h.render(b,d),d.push("\x3c/td\x3e"));d.push("\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e");b.config.menubarCanCollapse&&d.push("\x3c/span\x3e");d.push("\x3c/div\x3e");c.data.html+=d.join("")}},null,null,2);b.on("destroy",function(){if(this.menubar)for(var a=this.menubar.menus,b=
0;b<a.length;b++){var e=a[b];e.clickFn&&POLARIS.tools.removeFunction(e.clickFn);e.keydownFn&&POLARIS.tools.removeFunction(e.keydownFn);e.focusFn&&POLARIS.tools.removeFunction(e.focusFn)}})}})})();POLARIS.config.menuLocation="top";(function(){function a(a){var b=a.document;a={};var c={};a["line-height"]=b.getBody().getStyle("line-height");c["font-family"]=b.getBody().getStyle("font-family");c["font-size"]=b.getBody().getStyle("font-size");var b=new POLARIS.dom.element("p"),d=new POLARIS.dom.element("span");
d.setStyles(c);d.setHtml("\x26#8203;");b.append(d);b.setStyles(a);return b}function e(a){var b=a.getText(),c=new POLARIS.dom.documentFragment(a.getDocument()),d=new POLARIS.dom.element("span"),e=0,f=null,g=null,f=null,h=b.split(/\u00a0|\u0020/g),k=b.match(/\u00a0|\u0020/g),l=h.length;if(h&&1<l)for(e=0;e<l;e++)g=h[e],f=k[e],e<l-1&&f&&(g+=f),f=new POLARIS.dom.element("span"),f.setAttribute(r.letterSplitIdentifier,""),f.setText(g),c.append(f);else 0<b.length&&(f=new POLARIS.dom.element("span"),f.setAttribute(r.letterSplitIdentifier,
""),f.setText(b),c.append(f));c.moveChildren(d);d.insertBefore(a);a.remove();return d}function b(a){for(var b=a.getText(),c=new POLARIS.dom.element("span"),d=0,e=b.length,f=null;d<e;d++)f=new POLARIS.dom.element("span"),f.setAttribute(r.letterSplitIdentifier,""),f.setText(b.charAt(d)),c.append(f);a.setHtml(c.getHtml());return a}function c(a,b){for(var c=0,d=0,e=a.find("["+r.letterSplitIdentifier+"]"),f=e.count();c<f;c++){var g=e.getItem(c);g.getClientRect().bottom<b&&(d+=g.getText().length)}return d}
function d(a,b,c){var d=0,e=0;a=a.find("["+r.letterSplitIdentifier+"]");for(var f=a.count();d<f;d++){var g=a.getItem(d),h=g.getClientRect();b+h.width<c&&(e+=g.getText().length);b+=h.width}return e}function h(a,b){var c=a?a.startContainer:null,c=c?c.getAscendant("p",!0):null;return b&&c?b.equals(c):!1}function g(a,b){var c=0,d=a.getClientRect(),e=b.getClientRect(),c=d.right-e.right;d.left===e.left&&(c=0);return c}function k(a){var b=new POLARIS.dom.element("span"),c=b.getUniqueId();b.setAttribute(p.caretPosition,
"1");b.setAttribute("id",c);a.append(b);return b}function f(a,b){a.moveToPosition(b,POLARIS.POSITION_BEFORE_START);b.remove()}function l(a,b,c){var d=a&&a.getDocument(),e=b&&b.getAscendant(ja,!0),f=b&&b.getParent(),g=c&&c.getParent(),d=d&&new POLARIS.dom.range(d);if(a&&b&&c&&f&&g)for(d.setStartAt(e,POLARIS.POSITION_AFTER_START),d.setEndAt(c,POLARIS.POSITION_AFTER_END),d=d.extractContents(),d.moveChildren(a);g&&g.type===POLARIS.NODE_ELEMENT&&0===g.getChildCount()&&g.getAttribute(p.role)!==r.pageBody;)g.remove(),
g=g.getParent()}function m(a,b){var c=a.find("br"),d=c.count(),e,f,g;for(e=0;e<d;e++)if(f=c.getItem(e),(g=f.getParent())&&"p"==g.getName())f.equals(g.getLast())&&1==g.find("br").count()&&(f.remove(),0==g.getText().length&&g.appendHtml(Aa(b)));else if(g&&"td"==g.getName())g.trim(),f.equals(g.getLast())&&f.remove(),0==g.getChildCount()&&g.setHtml(Aa(b));else if(f.hasAscendant("td")&&!f.hasAscendant("p")){var h=f.getAscendant("td"),k;k=new POLARIS.dom.range(a);k.selectNodeContents(h);k.setStartAfter(f);
k=new POLARIS.dom.walker(k);k.guard=function(a){return!a.equals(h)};k.next()||(f.remove(),0==g.getText().length&&g.appendHtml(Aa(b)))}}function n(a){var b=a&&a.getSelection(),c=(b=b&&b.getRanges()[0])&&b.startContainer,d=c&&c.getAscendant("article"),e="",e=null;if(!b||!b.collapsed||!d||c&&c.getAscendant({ol:1,ul:1}))return!1;if(b.checkBoundaryOfElement(d,POLARIS.START))if(d.hasAttribute("polaris-splitted")){if(e=d.getAttribute("polaris-splitted"),(e=a.document.find('article[polaris-splitted\x3d"'+
e+'"]'))&&0<e.count()&&e.getItem(0).equals(d))return!0}else return!0;return!1}function q(a){var b=a&&a.getSelection(),c=(b=b&&b.getRanges()[0])&&b.startContainer,c=c&&c.getAscendant("article"),d="",d=null;if(!b||!b.collapsed||!c)return!1;if(b.checkBoundaryOfElement(c,POLARIS.END))if(c.hasAttribute("polaris-splitted")){if(d=c.getAttribute("polaris-splitted"),(d=a.document.find('article[polaris-splitted\x3d"'+d+'"]'))&&0<d.count()&&d.getItem(d.count()-1).equals(c))return!0}else return!0;return!1}var v=
function(){this.ratio=1;this.zoomType=0},r={container:"polaris-page-container",style:"polaris-page-style",page:"polaris-page",pageBreak:"polaris-page-break",pageMarginTop:"polaris-page-margin-top",pageHeader:"polaris-page-header",pageBackground:"polaris-page-background",pageGrid:"polaris-page-grid",pageContent:"polaris-page-content",pageBody:"polaris-page-body",pageEndnote:"polaris-page-endnote",pageFootnote:"polaris-page-footnote",pageFooter:"polaris-page-footer",pageMarginBottom:"polaris-page-margin-bottom",
pageCorner:"polaris-page-corner",pageCornerLeftTop:"polaris-page-left-top-corner",pageCornerRightTop:"polaris-page-right-top-corner",pageCornerLeftBottom:"polaris-page-left-bottom-corner",pageCornerRightBottom:"polaris-page-right-bottom-corner",placeHolderContainer:"polaris-placeholder-container",placeHolder:"polaris-placeholder",pagedTable:"polaris-table-paginated",nurum:"누름틀",bonmun:"본문",removablePubdocbody:"removable-pubdocbody",spannedTd:"polaris-spanned-td",letterSplitIdentifier:"doc-lb"},p=
{role:"doc-data-role",field:"doc-data-field",value:"doc-data-value",page:"polaris-page",split:"polaris-splitted",temp:"polaris-temp",caretPosition:"polaris-caret-position",bookmark:"data-polaris-bookmark",bookmarkPageBreak:"data-polaris-bookmark-pagebreak"},t=function(a,b){return"["+a+'\x3d"'+b+'"]'},w={container:"#"+r.container,page:t(p.role,r.page),pageBreak:t(p.role,r.pageBreak),pageMarginTop:t(p.role,r.pageMarginTop),pageHeader:t(p.role,r.pageHeader),pageBackground:t(p.role,r.pageBackground),
pageGrid:t(p.role,r.pageGrid),pageContent:t(p.role,r.pageContent),pageBody:t(p.role,r.pageBody),pageEndnote:t(p.role,r.pageEndnote),pageFootnote:t(p.role,r.pageFootnote),pageFooter:t(p.role,r.pageFooter),pageMarginBottom:t(p.role,r.pageMarginBottom),pageCorner:t(p.role,r.pageCorner),pageCornerLeftTop:"#"+r.pageCornerLeftTop,pageCornerRightTop:"#"+r.pageCornerRightTop,pageCornerLeftBottom:"#"+r.pageCornerLeftBottom,pageCornerRightBottom:"#"+r.pageCornerRightBottom,placeHolderContainer:"#"+r.placeHolderContainer,
placeHolder:"#"+r.placeHolder,pagedTable:t(p.role,r.pagedTable),nurum:t(p.role,r.nurum),bonmun:t(p.field,r.bonmun),removablePubdocbody:t(p.role,r.removablePubdocbody),findFootnote:"a"+t(p.role,"footnote"),spannedTd:t(p.role,r.spannedTd),split:"["+p.split+"]",getByAttr:t,getById:function(a){return"#"+a},getByClass:function(a){return"."+a},getTemp:"span"+t(p.temp,"1"),getCaretPosition:"span"+t(p.caretPosition),bookmark:"span"+t(p.bookmark,"1"),bookmarkPageBreak:"span"+t(p.bookmarkPageBreak,"1")},A=
function(a){this.owner=a;this.marginTop=a.findOne(w.pageMarginTop);this.header=a.findOne(w.pageHeader);this.background=a.findOne(w.pageBackground);this.grid=a.findOne(w.pageGrid);this.content=a.findOne(w.pageContent);this.body=a.findOne(w.pageBody);this.footnote=a.findOne(w.pageFootnote);this.footer=a.findOne(w.pageFooter);this.marginBottom=a.findOne(w.pageMarginBottom);this.corner={owner:null,leftTop:null,rightTop:null,leftBottom:null,rightBottom:null};this.corner.owner=a.findOne(w.pageCorner);this.corner.owner&&
(this.corner.leftTop=this.corner.owner.findOne(w.pageCornerLeftTop),this.corner.rightTop=this.corner.owner.findOne(w.pageCornerRightTop),this.corner.leftBottom=this.corner.owner.findOne(w.pageCornerLeftBottom),this.corner.rightBottom=this.corner.owner.findOne(w.pageCornerRightBottom))},x={size:"a4",width:"210mm",height:"297mm",orientation:"portrait",marginLeft:"30mm",marginTop:"20mm",marginRight:"30mm",marginBottom:"20mm",borderLeft:"",borderLeftMargin:"5mm",borderTop:"",borderTopMargin:"5mm",borderRight:"",
borderRightMargin:"5mm",borderBottom:"",borderBottomMargin:"5mm",backgroundColor:"",backgroundImage:"",backgroundRepeat:"",footnoteHeight:"15mm",pageHeader:{height:"15mm",first:{innerHtml:""},both:{innerHtml:""},odd:{innerHtml:""},even:{innerHtml:""}},pageFooter:{height:"15mm",first:{innerHtml:""},both:{innerHtml:""},odd:{innerHtml:""},even:{innerHtml:""}}},C=function(a){return{height:x[a].height,first:{innerHtml:x[a].first.innerHtml},both:{innerHtml:x[a].both.innerHtml},odd:{innerHtml:x[a].odd.innerHtml},
even:{innerHtml:x[a].even.innerHtml},getPageNumberType:function(a){if(a){var b="",b=this.first.innerHtml,c=this.odd.innerHtml,d=this.even.innerHtml;return b=1==a&&b?"first":c||d?0==a%2?"even":"odd":"both"}},setInnerHtml:function(a,b){if(a)switch(a){case "first":this.first.innerHtml=b;break;case "odd":this.odd.innerHtml=b;this.even.innerHtml||(this.even.innerHtml=this.both.innerHtml);this.both.innerHtml="";break;case "even":this.even.innerHtml=b;this.odd.innerHtml||(this.odd.innerHtml=this.both.innerHtml);
this.both.innerHtml="";break;case "both":this.both.innerHtml=b,this.odd.innerHtml="",this.even.innerHtml=""}},createInfoElements:function(b){function c(a,d){var g=b.document.createElement(e);g.setAttribute("display",a);g.setAttribute("height",f);g.setHtml(d);return g}if(b){var d=[],e=a.toLowerCase(),f=this.height,g=this.first.innerHtml,h=this.odd.innerHtml,k=this.even.innerHtml,l=this.both.innerHtml;g&&d.push(c("first",g));h||k?(d.push(c("odd",h)),d.push(c("even",k))):d.push(c("both",l));return d}},
updateByInfoElements:function(a){if(a){var b=a.count(),c,d,e;if(0<b)for(c=0;c<b;c++)switch(d=a.getItem(c),e=d.getAttribute("display"),e){case "first":case "odd":case "even":case "both":this.setInnerHtml(e,d.getHtml());d.hasAttribute("height")&&(this.height=d.getAttribute("height"));break;case "init":this.setInnerHtml("both","");d.hasAttribute("height")&&(this.height=d.getAttribute("height"));break;case "none":this.setInnerHtml("both",""),this.height="0mm"}}}}},u={size:"a4",width:"210mm",height:"297mm",
orientation:"portrait",marginLeft:"30mm",marginTop:"20mm",marginRight:"30mm",marginBottom:"20mm",borderLeft:"1px solid #000000",borderLeftMargin:"5mm",borderTop:"1px solid #000000",borderTopMargin:"5mm",borderRight:"1px solid #000000",borderRightMargin:"5mm",borderBottom:"1px solid #000000",borderBottomMargin:"5mm",backgroundColor:"#ffffff",backgroundImage:"#ffffff",backgroundRepeat:"#ffffff",footnoteHeight:"15mm",pageHeader:C("pageHeader"),pageFooter:C("pageFooter"),footnotes:null,endnotes:null,
footnoteSeperator:{width:"25%",align:"left",height:"1pt",style:"solid",color:"#000000"},getFootnoteSeperator:function(){return this.footnoteSeperator.height+" "+this.footnoteSeperator.style+" "+this.footnoteSeperator.color},setFootnoteSeperator:function(a){var b=new POLARIS.dom.element("span");b.setStyle("border",a);this.footnoteSeperator.color=b.getStyle("border-color");this.footnoteSeperator.style=b.getStyle("border-style");this.footnoteSeperator.height=b.getStyle("border-width")},endnoteSeperator:{width:"25%",
align:"left",height:"1pt",style:"solid",color:"#000000"},getEndnoteSeperator:function(){return this.endnoteSeperator.height+" "+this.endnoteSeperator.style+" "+this.endnoteSeperator.color},setEndnoteSeperator:function(a){var b=new POLARIS.dom.element("span");b.setStyle("border",a);this.endnoteSeperator.color=b.getStyle("border-color");this.endnoteSeperator.style=b.getStyle("border-style");this.endnoteSeperator.height=b.getStyle("border-width")},grid:{visible:!1,type:"horizon",overlay:!1,hSpace:"5mm",
vSpace:"5mm",position:"paper",hMargin:"0mm",vMargin:"0mm"},startPageNumbers:[1],initialize:function(){this.size=x.size;this.width=x.width;this.height=x.height;this.orientation=x.orientation;this.marginLeft=x.marginLeft;this.marginTop=x.marginTop;this.marginRight=x.marginRight;this.marginBottom=x.marginBottom;this.borderLeft=x.borderLeft;this.borderLeftMargin=x.borderLeftMargin;this.borderTop=x.borderTop;this.borderTopMargin=x.borderTopMargin;this.borderRight=x.borderRight;this.borderRightMargin=x.borderRightMargin;
this.borderBottom=x.borderBottom;this.borderBottomMargin=x.borderBottomMargin;this.backgroundColor=x.backgroundColor;this.backgroundImage=x.backgroundImage;this.backgroundRepeat=x.backgroundRepeat;this.footnoteHeight=x.footnoteHeight;this.pageHeader.height=x.pageHeader.height;this.pageHeader.first.innerHtml=x.pageHeader.first.innerHtml;this.pageHeader.both.innerHtml=x.pageHeader.both.innerHtml;this.pageHeader.odd.innerHtml=x.pageHeader.odd.innerHtml;this.pageHeader.even.innerHtml=x.pageHeader.even.innerHtml;
this.pageFooter.height=x.pageFooter.height;this.pageFooter.first.innerHtml=x.pageFooter.first.innerHtml;this.pageFooter.both.innerHtml=x.pageFooter.both.innerHtml;this.pageFooter.odd.innerHtml=x.pageFooter.odd.innerHtml;this.pageFooter.even.innerHtml=x.pageFooter.even.innerHtml},getHeight:function(){return"landscape"==this.orientation?this.width:this.height},getWidth:function(){return"landscape"==this.orientation?this.height:this.width},getPageTopHeight:function(){return parseInt(this.marginTop)+
parseInt(this.pageHeader.height)+"mm"},getPageBottomHeight:function(){return parseInt(this.marginBottom)+parseInt(this.pageFooter.height)+"mm"},getPageContentTop:function(a){var b=parseInt(this.marginTop);a&&(b+=parseInt(this.pageHeader.height));return b+"mm"},getPageContentWidth:function(){return parseInt(this.getWidth())-parseInt(this.marginLeft)-parseInt(this.marginRight)+"mm"},getPageContentHeight:function(a,b,c){var d=parseInt(this.getHeight())-parseInt(this.marginTop)-parseInt(this.marginBottom);
a&&this.pageHeader.height&&(d-=parseInt(this.pageHeader.height));b&&this.pageFooter.height&&(d-=parseInt(this.pageFooter.height));return c?d:d+"mm"}};u.initialize();var B=[],G=[],y=!1,F=!1,E=!0,H=!1,J=!1,I=!1,L=!1,z=null,D=null,O=1,P=function(a){return a.findOne(w.container)},X=[],S=function(a,b){var c=[],d=0,c=new POLARIS.dom.nodeList(c,!0);if(null==a||void 0==a)return c;a&&a.hasAttribute&&a.hasAttribute("workingPageIndex")&&(d=Number(a.getAttribute("workingPageIndex")));for(var e=a.find(w.page),
f=e.count(),g=0;g<f;g++)if(0<d&&g<d&&!b)c.$.push(X[g]);else{var h=new A(e.getItem(g));c.$.push(h);X[g]=h}return c},N=function(a,b){var c=a.find(w.page);return(c=c.getItem((1>b?1:b)-1))?new A(c):null},U=function(a){return(a=a.getNext(function(a){try{return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute(p.role)&&a.getAttribute(p.role)==r.page}catch(b){return!1}}))?new A(a):null},na=function(a){return(a=a.getPrevious(function(a){try{return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute(p.role)&&a.getAttribute(p.role)==
r.page}catch(b){return!1}}))?new A(a):null},V=function(a){a=(a=(a=a.elementPath())&&a.contains(function(a){return a.getAttribute(p.role)==r.page}))?a.getAttribute(r.page):1;return Number(a)},Z=function(a){return a.find(w.page).count()},ka=function(a,b){for(var c=a.find(w.pageCorner),d=c.count(),e=0;e<d;e++){var f=c.getItem(e);b?f.show():f.hide()}},R=function(a){a=a.editor;var b=a.document;a.execCommand("showRuler",!0);ka(b,!0)},ba=function(a){a=a.editor;var b=a.document;a.execCommand("showRuler",
!1);ka(b,!1)},Ba=function(a){var b=a.data.type,c=a.data.sync;a=a.data.isRelayoutAll;var d=V(this),e=d-1,e=0>e?0:e;a&&(e=0);POLARIS.log.plugin("[onContentChanged] type \x3d "+b+", sync \x3d "+c+" 현재 페이지번호["+d+"], 작업할 페이지의 인덱스["+e+"]");Q(this,e,c)},oa=function(a){for(var b=P(a.editor.document),b=S(b),c=b.count(),d=0;d<c;d++)b.getItem(d).body.setAttribute("contentEditable",!a.editor.readOnly)},da=function(a){var b=a.editor,c=b.document,d=P(c),e=S(d),f=a.data;a=f?f.type:0;var g=f?f.ratio:100,h=c.getDocumentElement(),
k=c.getWindow().getFrame(),f=f?f.updateScrollbarVisibility:0;0!=a&&(1==a?(g=.97*k.getSize("height"),e=e.getItem(0).owner.getSize("height"),g=g/e*100):2==a&&(e=.99*h.getSize("width"),d&&(g=d.getSize("width"),g=e/g*100)));if(d){var e=b.checkDirty(),l=d.getSize("width"),h=d.getSize("height"),k=d.getSize("width")*(g/100),m=c.getBody().getSize("width");d.getSize("height");c.getBody().getSize("height");var n=d.$.offsetLeft;b.fire("lockSnapshot");m>l&&m>k?POLARIS.tools.scaleElement(d,g,"center","top"):k>
m?POLARIS.tools.scaleElement(d,g,"left","top",-n):(l=Math.max((m-k)/2-n,0),POLARIS.tools.scaleElement(d,g,"left","top",l));(f||2==a)&&c.getBody().setStyle("overflow-x",k<m?"hidden":"visible");c.getBody().setStyle("height",g/100*h+"px");b.pagination.setScaleRatio(g);b.pagination.setZoomType(a);b.fire("unlockSnapshot");e||b.resetDirty()}},ea=function(a){return!E||0==a.getClientRect().height||isNaN(parseInt(a.getStyle("height")))||0==parseInt(a.getStyle("height"))?!1:!0},ga=function(a,b){var c=a.document,
d=P(c),e=S(d),f=c.getBody();POLARIS.log.plugin("[updatePageStyle] 페이지 스타일을 변경한다. targetPageNumber["+b+"]");c=a.config.pageBgColor;f.setStyle("background-color",c);f=E?parseInt(u.getWidth().replace("mm","")):parseInt(u.getPageContentWidth().replace("mm",""));d.setStyle("width",f+1+"mm");d.setStyle("background-color",E?c:"");d.setStyle("margin","auto");d.setStyle("padding-left","10px");d.setStyle("padding-top","10px");d.setStyle("padding-right","10px");d.setStyle("padding-bottom","10px");c=void 0==
b?0:b-1;for(f=e.count();c<f;c++){var g=e.getItem(c),h=g.owner,k=g.marginTop,l=g.header,m=g.content,n=g.body,p=g.footnote,q=g.footer,t=g.marginBottom,D=c+1;h.setAttribute(r.page,D);h.setStyle("position","relative");h.setStyle("width",E?u.getWidth():u.getPageContentWidth());h.setStyle("height",E?u.getHeight():u.getPageContentHeight());h.setStyle("background-color","white");h.setStyle("page-break-after","always");h.setStyle("z-index","0");m.setStyle("z-index","0");n.setStyle("z-index","0");E?(h.setStyle("margin",
"0 auto"),1<e.count()&&0<c&&h.setStyle("margin-top","10px"),h.setStyle("border","1px solid "+a.config.pageBorderColor)):(1<e.count()&&0<c&&h.setStyle("margin-top","10px"),h.removeStyle("border",""),h.setStyle("border-bottom","1px dotted #FF0000"));k.setStyle("position","absolute");k.setStyle("top","0");k.setStyle("width",u.getPageContentWidth());k.setStyle("height",u.marginTop);k.setStyle("margin-left",u.marginLeft);k.setStyle("padding",u.getPageContentWidth()+" auto");E?k.show():k.hide();var k=a,
z=g.header,v=g.footer;z&&(z.setStyle("z-index",1),z.setStyle("position","absolute"),z.setStyle("top",u.marginTop),z.setStyle("width",u.getPageContentWidth()),z.setStyle("height",u.pageHeader.height),z.setStyle("margin-left",u.marginLeft),z.setStyle("padding",u.getPageContentWidth()+" auto"),z.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+ya(k)+", "+D+', "header");'),z.setStyle("overflow","hidden"),E?z.setStyle("display",""):z.setStyle("display","none"));v&&(v.setStyle("position",
"absolute"),v.setStyle("bottom",u.marginBottom),v.setStyle("width",u.getPageContentWidth()),v.setStyle("height",u.pageFooter.height),v.setStyle("margin-left",u.marginLeft),v.setStyle("padding",u.getPageContentWidth()+" auto"),v.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+ya(k)+", "+D+', "footer");'),v.setStyle("overflow","hidden"),E?v.setStyle("display",""):v.setStyle("display","none"));D=k=!1;l&&(k=ea(l));q&&(D=ea(q));m.setStyle("position","absolute");m.setStyle("top",E?u.getPageContentTop(k):
"");m.setStyle("width",u.getPageContentWidth());m.setStyle("height",u.getPageContentHeight(k,D));m.setStyle("margin-left",E?u.marginLeft:"");m.setStyle("background-color","transparent");n.setStyle("width",u.getPageContentWidth());n.setStyle("height",u.getPageContentHeight(k,D));p&&(p.setStyle("display","none"),p.setStyle("position","absolute"),p.setStyle("bottom",0),p.setStyle("width",u.getPageContentWidth()),p.setStyle("min-height",u.footnoteHeight),p.setStyle("max-height",u.getPageContentHeight(k,
D,!0)/2+"mm"));t&&(t.setStyle("width",u.getPageContentWidth()),t.setStyle("height",u.marginBottom),t.setStyle("margin-left",u.marginLeft),t.setStyle("padding",u.getPageContentWidth()+" auto"),E?t.show():t.hide());n=g.background;E?n.setStyles({position:"absolute",left:u.borderLeftMargin,top:u.borderTopMargin,right:u.borderRightMargin,bottom:u.borderBottomMargin,borderLeft:u.borderLeft,borderTop:u.borderTop,borderRight:u.borderRight,borderBottom:u.borderBottom,backgroundColor:u.backgroundColor,backgroundImage:u.backgroundImage,
backgroundRepeat:u.backgroundRepeat}):n.setStyles({position:"absolute",left:0,top:0,right:0,bottom:0,borderLeft:0,borderTop:0,borderRight:0,borderBottom:0,backgroundColor:u.backgroundColor,backgroundImage:u.backgroundImage,backgroundRepeat:u.backgroundRepeat});Ca(a,g);qa(a,g,k,D);la(d,h,l,m,q);if(b)break}void 0!=b||F||Q(a,0)},aa=function(a,b){var c=a.document,d=null,e;b||(b=S(c));var f=b,g=f.count(),h,k,l,m,n=0;for(h=0;h<g;h++){d=f.getItem(h);k=d.header;l=d.footer;k&&(m=u.pageHeader.getPageNumberType(h+
1),k.setHtml(u.pageHeader[m].innerHtml));l&&(m=u.pageFooter.getPageNumberType(h+1),l.setHtml(u.pageFooter[m].innerHtml));k=!1;l=u.startPageNumbers;m=l.length;for(var q=0;q<m;q++)l[q]==h+1&&(k=!0);k?n=1:n++;k=n;l=d.owner.find(t(p.role,"page-number"));m=l.count();for(q=0;q<m;q++){var D=l.getItem(q),z=D.$.innerText;if(0<z.length&&NaN!=parseInt(z)){var v=D.$.querySelectorAll("span"),w=v.length;0<w&&v[0].innerText==z?v[w-1].innerText==z&&(v[w-1].innerText=k):D.$.innerText=k}else z=D.getText(),length=z.length,
0==length&&D.setText(k)}k=g;d=d.owner.find(t(p.role,"total-page-number"));l=d.count();for(m=0;m<l;m++)q=d.getItem(m),(v=q.getChild(0))?(D=v.getText(),z=D.length,(0==z||NaN!=parseInt(v.getText())&&D!=String(k))&&v.setText(k)):(D=q.getText(),z=D.length,0==z&&q.setText(k))}h=k=0;l=b.count();for(f=0;f<l;f++){d=b.getItem(f);m=d.footnote;q=d.owner.find(t(p.role,"footnote"));m.setHtml('\x3cdiv style\x3d"text-align:'+u.footnoteSeperator.align+';line-height:0px;" contenteditable\x3d"false"\x3e\x3cdiv style\x3d"border-top:'+
u.getFootnoteSeperator()+";width:"+u.footnoteSeperator.width+';display:inline-block;"\x3e\x3c/div\x3e\x3c/div\x3e');D=q.count();for(g=0;g<D;g++)(n=POLARIS.dom.element.createFromHtml(B[k],c))&&n.type==POLARIS.NODE_ELEMENT&&(k++,n.setAttribute("id","footnote-item"+k),(z=n.findOne(t(p.role,"footnote-item-number")))?(z.setText(k+") "),z.setAttribute("contentEditable","false")):(z='\x3cspan contentEditable\x3d"false" '+p.role+'\x3d"footnote-item-number"\x3e'+k+") \x3c/span\x3e ",z=POLARIS.dom.element.createFromHtml(z,
c),n.append(z,!0)),m.append(n),n=q.getItem(g))&&(n.setAttribute("id","footnote"+k),n.setAttribute("contentEditable","false"),n.setAttribute("title",a.lang.pagination.comment.footnote),n.setHtml("\x3csup\x3e"+k+")\x3c/sup\x3e"),n.setAttribute("onclick","parent.POLARIS.tools.callFunction("+ia(a)+", "+k+")"),n.setStyle("cursor","pointer"),n.setStyle("display","inline"));0<q.count()?m.removeStyle("display"):m.setStyle("display","none");q=d.owner.find(t(p.role,"endnote"));m=q.count();for(g=0;g<m;g++)n=
q.getItem(g),h++,n&&(n.setAttribute("id","endnote"+h),n.setAttribute("contentEditable","false"),n.setAttribute("title",a.lang.pagination.comment.endnote),n.setHtml("\x3csup\x3e"+h+")\x3c/sup\x3e"),n.setAttribute("onclick","parent.POLARIS.tools.callFunction("+ta(a)+", "+h+")"),n.setStyle("cursor","pointer"),n.setStyle("display","inline"));f==b.count()-1&&(e=d)}g=c.find(t(p.role,r.pageEndnote+"-cover"));h=g.count();for(f=0;f<h;f++)g.getItem(f).remove();q=c.find(t(p.role,"endnote"));if(0<q.count())for(z=
'\x3cdiv contenteditable\x3d"false" '+p.role+'\x3d"'+r.pageEndnote+'-cover" \x3e\x3cdiv id\x3d"'+r.pageEndnote+'" '+p.role+'\x3d"'+r.pageEndnote+'" contenteditable\x3d"false" ondblclick\x3d"parent.POLARIS.tools.callFunction('+wa(a)+')"\x3e\x3cdiv style\x3d"text-align:'+u.endnoteSeperator.align+';line-height:0px;" contenteditable\x3d"false"\x3e\x3cdiv style\x3d"border-top:'+u.getEndnoteSeperator()+";width:"+u.endnoteSeperator.width+';display:inline-block;"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
g=POLARIS.dom.element.createFromHtml(z,c),e.body.append(g),m=q.count(),f=0;f<m;f++)(n=POLARIS.dom.element.createFromHtml(G[f],c))&&n.type==POLARIS.NODE_ELEMENT&&(h=f+1,n.setAttribute("id","endnote-item"+h),(e=n.findOne(t(p.role,"endnote-item-number")))?(e.setText(h+") "),e.setAttribute("contentEditable","false")):(z='\x3cspan contentEditable\x3d"false" '+p.role+'\x3d"endnote-item-number"\x3e'+h+") \x3c/span\x3e ",e=POLARIS.dom.element.createFromHtml(z,c),n.append(e,!0)),g.findOne(t(p.role,r.pageEndnote)).append(n));
e=c.find("ruby");h=e.count();for(f=0;f<h;f++)if(g=e.getItem(f),1==g.getChildCount())g.remove();else if(n=g.findOne("rt"))for(n=n.find("br"),d=n.count(),g=0;g<d;g++)n.getItem(g).remove();else g.remove();if(POLARIS.env.ie)for(c=c.find("ul, ol"),f=0,e=c.immutableLength;f<e;f+=1)g=c.getItem(f),g.findOne("li")||(h=g.getParent(),n=a.createRange(),g.remove(),n.moveToElementEditablePosition(h,!0),n.select(!0),a.focus());this.paginated||(a.resetUndo(),this.paginated=!0)},la=function(a,b,c,d,e){if(a.$.attachEvent){var f=
function(a){a.returnValue=!1};a.$.attachEvent("onresizestart",f);b.$.attachEvent("onresizestart",f);c&&c.$.attachEvent("onresizestart",f);d.$.attachEvent("onresizestart",f);e&&e.$.attachEvent("onresizestart",f);a.$.attachEvent("ondragstart",f);b.$.attachEvent("ondragstart",f);c&&c.$.attachEvent("ondragstart",f);d.$.attachEvent("ondragstart",f);e&&e.$.attachEvent("ondragstart",f)}},pa=function(a){a.config.useDocConvertServer&&POLARIS.tools.isEmptyValue(a.config.docConvertingUrl);return"body { background-color: #f5f5f5; word-wrap:break-word; }body:focus { outline: 0; }div"+
w.container+":focus { outline: 0; }div"+w.page+":focus { outline: 0; }div"+w.page+" { overflow: hidden; }div"+w.pageHeader+":focus { outline: 0; }div"+w.pageBackground+":focus { outline: 0; }div"+w.pageGrid+":focus { outline: 0; }div"+w.pageContent+":focus { outline: 0; }div"+w.pageBody+":focus { outline: 0; }div"+w.pageFootnote+":focus { outline: 0; }div"+w.pageFooter+":focus { outline: 0; }div"+w.pageEndnote+":focus { outline: 0; }article:focus, section:focus, div:focus, td:focus, p:focus { outline: 0; }article \x3e div { position: static  }body {\tfont-family: Malgun Gothic; font-size: 12pt; line-height: 1.6; }p.vertical-align-top { } p.vertical-align-top span { position: relative; }p.vertical-align-middle { }p.vertical-align-bottom { } p.vertical-align-bottom span { position: relative; }p { margin: 0px 0px 0px 0px; }td { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }@media print {\t.polaris-page { left: 0; margin: 0; box-shadow: 0; } .polaris-page-container { border:none; padding: 0; } @page { margin: 0; } }"},
za=function(a,b,c){var d="",e="";c.config.documentFontFamily&&(e+="font-family: "+c.config.documentFontFamily+";");c.config.documentFontSize&&(e+="font-size: "+c.config.documentFontSize+"pt;");c.config.documentLineHeight&&(e+="line-height: "+c.config.documentLineHeight+";");c=0==O||2==O?!1:!0;1==a&&(d+='\x3cdiv id\x3d"'+r.container+'" '+p.role+'\x3d"'+r.container+'" contenteditable\x3d"false"\x3e');d+="\x3cdiv "+p.role+'\x3d"'+r.page+'" '+p.page+"\x3d"+a+"\x3e\x3cdiv "+p.role+'\x3d"'+r.pageMarginTop+
'" unselectable\x3d"on"\x3e\x3c/div\x3e\x3cdiv '+p.role+'\x3d"'+r.pageHeader+'"\x3e\x3c/div\x3e\x3cdiv '+p.role+'\x3d"'+r.pageBackground+'"\x3e\x3c/div\x3e\x3cdiv '+p.role+'\x3d"'+r.pageGrid+'"\x3e\x3c/div\x3e\x3cdiv '+p.role+'\x3d"'+r.pageContent+'"\x3e\x3cdiv '+p.role+'\x3d"'+r.pageBody+'" contenteditable\x3d"'+c+'"\x3e'+(b?'\x3cp style\x3d"'+e+'"\x3e\x3cbr\x3e\x3c/p\x3e':"")+"\x3c/div\x3e\x3cdiv "+p.role+'\x3d"'+r.pageFootnote+'"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv '+p.role+'\x3d"'+r.pageFooter+
'"\x3e\x3c/div\x3e\x3cdiv '+p.role+'\x3d"'+r.pageMarginBottom+'" unselectable\x3d"on"\x3e\x3c/div\x3e\x3c/div\x3e';1==a&&(d+="\x3c/div\x3e");return d},Ja=function(a,b){var c=a.document,d=P(c),e=za(b,!1,a);d.appendHtml(e);c=N(c,b);xa(a,b);ga(a,b);c.header.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+ya(a)+", "+b+', "header");');c.footer.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+ya(a)+", "+b+', "footer");');c.footnote.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+
Da(a)+", "+b+")");c.body.setAttribute("contentEditable",0==O||2==O?!1:!0)},Oa=function(a,b){var c=a.document,d=P(c),d=S(d).getItem(b-1);b++;var e=za(b,!1,a);POLARIS.dom.element.createFromHtml(e).insertAfter(d.owner);xa(a,b);ga(a,b);c=N(c,b);c.header.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+ya(a)+", "+b+', "header");');c.footer.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+ya(a)+", "+b+', "footer");');c.footnote.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+
Da(a)+", "+b+")")},xa=function(a,b){var c=a.document,d=N(c,b);d.corner.owner||d.owner.appendHtml('\x3cdiv id\x3d"'+r.pageCorner+'" '+p.role+'\x3d"'+r.pageCorner+'" style\x3d"background-color: transparent;"\x3e'+('\x3cdiv id\x3d"'+r.pageCornerLeftTop+'" style\x3d"position: absolute; width: 5mm; height: 5mm; left: 0mm; top: 0mm; border-right: 2px solid lightgray; border-bottom: 2px solid lightgray;"\x3e\x3c/div\x3e')+('\x3cdiv id\x3d"'+r.pageCornerRightTop+'" style\x3d"position: absolute; width: 5mm; height: 5mm; left: 0mm; top: 0mm; border-left: 2px solid lightgray; border-bottom: 2px solid lightgray;"\x3e\x3c/div\x3e')+
('\x3cdiv id\x3d"'+r.pageCornerLeftBottom+'" style\x3d"position: absolute; width: 5mm; height: 5mm; left: 0mm; top: 0mm; border-right: 2px solid lightgray; border-top: 2px solid lightgray;"\x3e\x3c/div\x3e')+('\x3cdiv id\x3d"'+r.pageCornerRightBottom+'" style\x3d"position: absolute; width: 5mm; height: 5mm; left: 0mm; top: 0mm; border-left: 2px solid lightgray; border-top: 2px solid lightgray;"\x3e\x3c/div\x3e')+"\x3c/div\x3e");var e=!1,f=!1;d.header&&(e=ea(d.header));d.footer&&(f=ea(d.footer));d=
N(c,b);qa(a,d,e,f)},qa=function(a,b,c,d){if(b.corner){a=b.corner.leftTop;var e=b.corner.rightTop,f=b.corner.leftBottom,g=b.corner.rightBottom,h=0,k=0,l=0,m=0,h=parseInt(u.marginLeft)-0,k=parseInt(u.marginTop),l=parseInt(u.getPageContentWidth()),m=u.getPageContentHeight(c,d,!0);c&&(k+=parseInt(u.pageHeader.height));a.setStyle("left",h-5+"mm");a.setStyle("top",k-5+"mm");e.setStyle("left",h+l+"mm");e.setStyle("top",k-5+"mm");f.setStyle("left",h-5+"mm");f.setStyle("top",k+m+"mm");g.setStyle("left",h+
l+"mm");g.setStyle("top",k+m+"mm");E?b.corner.owner.show():b.corner.owner.hide()}},Ca=function(a,b){function c(a,b,d){function e(a){for(var c=(parseInt(d)-parseInt(u.grid.vMargin))/parseInt(u.grid.vSpace),f=0;f<c;f++){var g='\x3cdiv style\x3d"width: '+b+"; height: 0px; padding: 0; margin: 0; border-top: 1px solid lightgray; position: absolute; top: "+(f*parseInt(u.grid.vSpace)+parseInt(u.grid.vMargin))+'mm;"\x3e\x3c/div\x3e';POLARIS.dom.element.createFromHtml(g).appendTo(a)}}function f(a){for(var c=
(parseInt(b)-parseInt(u.grid.hMargin))/parseInt(u.grid.hSpace),e=0;e<=c;e++){var g='\x3cdiv style\x3d"width: 0px; height: '+d+"; padding: 0; margin: 0; border-left: 1px solid lightgray; position: absolute; left: "+(e*parseInt(u.grid.hSpace)+parseInt(u.grid.hMargin))+'mm;"\x3e\x3c/div\x3e';POLARIS.dom.element.createFromHtml(g).appendTo(a)}}a.getCustomData("grid.type");a.getCustomData("grid.position");a.setHtml("");"dotted"!=u.grid.type&&("horizon"==u.grid.type?e(a):"vertical"==u.grid.type?f(a):"grid"==
u.grid.type&&(e(a),f(a)));a.setCustomData("grid.type",u.grid.type);a.setCustomData("grid.position",u.grid.position)}var d=b.grid,e=0==u.grid.visible||0==E?"none":"",f=u.getWidth(),g=u.getHeight(),h=g=!1,e={position:"absolute",left:0,top:0,zIndex:0,backgroundColor:"transparent",display:e};b.header&&(g=ea(b.header));b.footer&&(h=ea(b.footer));"page"==u.grid.position?(E&&(e.left=u.marginLeft,e.top=u.getPageContentTop(g)),f=u.getPageContentWidth(),g=u.getPageContentHeight(g,h)):E?(f=u.getWidth(),g=u.getHeight()):
(f=u.getPageContentWidth(),g=u.getPageContentHeight(g,h));u.grid.overlay&&(e.zIndex=1);d.setStyles(e);u.grid.visible?(c(d,f,g),d.show()):d.hide()},W=function(b){this.paginated=!1;O=1;var c=b.document;var d=b.document;u.initialize();var e=b.config;void 0!=e.paperWidth&&null!=e.paperWidth&&(u.width=e.paperWidth);void 0!=e.paperHeight&&null!=e.paperHeight&&(u.height=e.paperHeight);void 0!=e.pageOrientation&&null!=e.pageOrientation&&(u.orientation=e.pageOrientation);void 0!=e.pageMarginLeft&&null!=e.pageMarginLeft&&
(u.marginLeft=e.pageMarginLeft);void 0!=e.pageMarginTop&&null!=e.pageMarginTop&&(u.marginTop=e.pageMarginTop);void 0!=e.pageMarginRight&&null!=e.pageMarginRight&&(u.marginRight=e.pageMarginRight);void 0!=e.pageMarginBottom&&null!=e.pageMarginBottom&&(u.marginBottom=e.pageMarginBottom);void 0!=e.pageHeaderHeight&&null!=e.pageHeaderHeight&&(u.pageHeader.height=e.pageHeaderHeight);void 0!=e.pageFooterHeight&&null!=e.pageFooterHeight&&(u.pageFooter.height=e.pageFooterHeight);var f=d.findOne("page");POLARIS.env.ie&&
8>=POLARIS.env.version&&(f=d.findOne("[border-bottom-margin]"));if(f){var g=f;g.hasAttribute("size")?u.size=g.getAttribute("size"):u.size=x.size;g.hasAttribute("width")&&(u.width=g.getAttribute("width"));g.hasAttribute("height")&&(u.height=g.getAttribute("height"));g.hasAttribute("orientation")&&(u.orientation=g.getAttribute("orientation"));g.hasAttribute("margin-left")&&(u.marginLeft=g.getAttribute("margin-left"));g.hasAttribute("margin-top")&&(u.marginTop=g.getAttribute("margin-top"));g.hasAttribute("margin-right")&&
(u.marginRight=g.getAttribute("margin-right"));g.hasAttribute("margin-bottom")&&(u.marginBottom=g.getAttribute("margin-bottom"));g.hasAttribute("border-left")&&(u.borderLeft=g.getAttribute("border-left"));g.hasAttribute("border-left-margin")&&(u.borderLeftMargin=g.getAttribute("border-left-margin"));g.hasAttribute("border-top")&&(u.borderTop=g.getAttribute("border-top"));g.hasAttribute("border-top-margin")&&(u.borderTopMargin=g.getAttribute("border-top-margin"));g.hasAttribute("border-right")&&(u.borderRight=
g.getAttribute("border-right"));g.hasAttribute("border-right-margin")&&(u.borderRightMargin=g.getAttribute("border-right-margin"));g.hasAttribute("border-bottom")&&(u.borderBottom=g.getAttribute("border-bottom"));g.hasAttribute("border-bottom-margin")&&(u.borderBottomMargin=g.getAttribute("border-bottom-margin"));g.hasAttribute("background-color")&&(u.backgroundColor=g.getAttribute("background-color"));!g.hasAttribute("border-left-margin")&&g.hasAttribute("margin-left")&&(u.borderLeftMargin=g.getAttribute("margin-left"));
!g.hasAttribute("border-top-margin")&&g.hasAttribute("margin-top")&&(u.borderTopMargin=g.getAttribute("margin-top"));!g.hasAttribute("border-right-margin")&&g.hasAttribute("margin-right")&&(u.borderRightMargin=g.getAttribute("margin-right"));!g.hasAttribute("border-bottom-margin")&&g.hasAttribute("margin-bottom")&&(u.borderBottomMargin=g.getAttribute("margin-bottom"));g.hasAttribute("background-image")&&(u.backgroundImage='url("'+g.getAttribute("background-image")+'")');g.hasAttribute("background-repeat")&&
(u.backgroundRepeat=g.getAttribute("background-repeat"));g.hasAttribute("footnote-seperator")&&u.setFootnoteSeperator(g.getAttribute("footnote-seperator"));g.hasAttribute("footnote-seperator-align")&&(u.footnoteSeperator.align=g.getAttribute("footnote-seperator-align"));g.hasAttribute("footnote-seperator-width")&&(u.footnoteSeperator.width=g.getAttribute("footnote-seperator-width"));g.hasAttribute("endnote-seperator")&&u.setEndnoteSeperator(g.getAttribute("endnote-seperator"));g.hasAttribute("endnote-seperator-align")&&
(u.endnoteSeperator.align=g.getAttribute("endnote-seperator-align"));g.hasAttribute("endnote-seperator-width")&&(u.endnoteSeperator.width=g.getAttribute("endnote-seperator-width"));if(f.hasAttribute("start-page-numbers")){var h=f.getAttribute("start-page-numbers");u.startPageNumbers=h.split(",")}var k=f.find("pageheader, header");u.pageHeader.updateByInfoElements(k);var l=f.find("pagefooter, footer");u.pageFooter.updateByInfoElements(l);var m=f.findOne("footnotes");if(m)for(var n=m.find("footnote"),
q=n.count(),t=0;t<q;t++){var z=n.getItem(t),D=z.getAttribute("number");if(D){var v=D.replace(/[^0-9]/g,"");if(0<v){var C="\x3cdiv "+p.role+'\x3d"footnote-item"\x3e'+z.getHtml()+"\x3c/div\x3e",A=POLARIS.dom.element.createFromHtml(C,d),X='\x3cspan contentEditable\x3d"false" '+p.role+'\x3d"footnote-item-number"\x3e'+v+") \x3c/span\x3e",U=POLARIS.dom.element.createFromHtml(X,d),F=A.findOne("p");F?F.append(U,!0):A.append(U,!0);B[v-1]=A.getOuterHtml()}}}var S=f.findOne("endnotes");if(S)for(n=S.find("endnote"),
q=n.count(),t=0;t<q;t++)if(z=n.getItem(t),D=z.getAttribute("number"))if(v=D.replace(/[^0-9]/g,""),0<v){var C="\x3cdiv "+p.role+'\x3d"endnote-item"\x3e'+z.getHtml()+"\x3c/div\x3e",E=POLARIS.dom.element.createFromHtml(C,d),X='\x3cspan contentEditable\x3d"false" '+p.role+'\x3d"endnote-item-number"\x3e'+v+") \x3c/span\x3e";endnoteNumberItem=POLARIS.dom.element.createFromHtml(X,d);(F=E.findOne("p"))?F.append(endnoteNumberItem,!0):E.append(endnoteNumberItem,!0);G[v-1]=E.getOuterHtml()}if(f.hasAttribute("orientation")&&
(u.orientation=f.getAttribute("orientation"),"landscape"==u.orientation)){var na=u.width;u.width=u.height;u.height=na}f.remove()}var H=null,I=null,J=b.document,V=J.findOne('[doc-data-field\x3d"표준기안문"]');if(V){var L=J.findOne('[doc-data-field\x3d"기관명"]');L&&(I=L.getAscendant("table"))&&(I.setAttribute("doc-data-role","removable-pubdocbody"),I.setStyle("table-layout","auto"));var H=V.getAscendant("table"),K=H.getAscendant("table");K&&(H=K);var Ja=H.getAscendant("div");Ja&&Ja.getAttribute(p.role)!=r.pageBody&&
(Ja.remove(!0),H.setStyles({position:"absolute",bottom:"0px"}));H.setAttribute("doc-data-role","removable-pubdocbody");var M=J.findOne('[doc-data-field\x3d"발신명의"]');if(M){var Oa=M.getAscendant("table");if(Oa){var ka=Oa.getParent();ka&&ka.is("td")&&ka.setStyle("position","relative");Oa.setStyle("table-layout","auto");Oa.setStyle("width","100%")}}if(H){H.removeStyle("height");H.removeAttribute("height");var Q=H.find("table",!0);if(Q)for(var R=0;R<Q.count();R++){var ba=Q.getItem(R);ba.removeStyle("height");
ba.removeAttribute("height")}}}else for(var T=J.find("div"),fa=T.count(),R=0;R<fa;R++){var ea=T.getItem(R),aa=ea.getChild(0);if("absolute"==ea.getStyle("position")&&"0px"==ea.getStyle("bottom")&&aa.is("table")){var da=aa.getClientRect();if(da){var Y=da.width,qa=da.height,Ca=J.findOne(w.container);if(Ca){var W=POLARIS.tools.getScaleRatio(Ca);W&&(Y=100*Y/W,qa=100*qa/W)}aa.setStyle("width",Y);aa.setStyle("height",qa)}aa.setStyle("position","absolute");aa.setStyle("bottom","0px")}}var la=J.findOne('[doc-data-field\x3d"본문"]');
la&&"본문을 입력하십시오"===la.getText()&&(la.setHtml(""),la.appendBogus());Zb(c);for(var Sb=c.find("span[style], br[style]"),ha=Sb.count(),ja=0;ja<ha;ja++){var ma=Sb.getItem(ja),Ba=ma.getAttribute("style").indexOf("page-break-before"),oa=ma.getAttribute("style").indexOf("page-break-after");if(-1<Ba||-1<oa){var ia=ma.getAscendant("p");if(ia){var ya=new POLARIS.dom.element("p");ya&&ya.setAttribute(p.role,r.pageBreak);ya.insertAfter(ia);0===ia.getText().length&&ia.remove()}else(ia=ma.getNext(ca))&&ia.setAttribute(p.role,
r.pageBreak);ma.remove()}}for(var Ga=c.find("table"),Aa=Ga.count(),ta=0;ta<Aa;ta++){for(var lb=Ga.getItem(ta),Tb=!1,vb=lb.getAscendant("table",!0);vb;){if("removable-pubdocbody"==vb.getAttribute("doc-data-role")){Tb=!0;break}vb=vb.getAscendant("table")}if(!Tb){var wa=lb.getParent();if(wa&&wa.type==POLARIS.NODE_ELEMENT&&wa.is("div")){var mb=wa,ua=mb.getChildCount(),Na=mb.$.attributes.length,ec=mb.$.style.length,Ub=mb.getAttribute("align");1==ua&&""!=Ub&&1==Na&&0==ec&&(lb.setAttribute("align",Ub),mb.remove(!0))}var Vb=
lb.findOne("colgroup");if(null!=Vb){var Ea=Vb.find("col");Ea&&0<Ea.count()&&lb.setStyle("table-layout","fixed")}}}var Fa=c.find("p");if(Fa)for(var Hb=0;Hb<Fa.count();Hb++){var Ib=Fa.getItem(Hb);if(Ib){var ra=Ib.getStyle("line-height");"0.65"==ra?ra="0.6":"0.81"==ra?ra="0.8":"1.11"==ra?ra="1.1":"1.79"==ra?ra="1.8":"2.11"==ra?ra="2.1":"2.41"==ra?ra="2.4":"3.09"==ra?ra="3.1":"3.41"==ra?ra="3.4":"3.71"==ra&&(ra="3.7");Ib.setStyle("line-height",ra)}}var La=c.find("p");if(La)for(var Ha=0;Ha<La.count();Ha++){var Ma=
La.getItem(Ha);if(Ma){var Ka,Pa="0",Qa=Ma.find("span");if(Qa)for(var Ta=0;Ta<Qa.count();Ta++){var Ya=Qa.getItem(Ta);if(Ya){var Za=Ya.getStyle("font-size");parseInt(Za)>parseInt(Pa)&&(Pa=Za)}}Ka=Pa;""!==Ka&&"0"!==Ka&&Ma.setStyle("font-size",Ka)}}for(var $a=c.find(w.spannedTd),jb=$a.count(),Ua=0;Ua<jb;Ua++){var wb=$a.getItem(Ua);wb.getAttribute(p.role)==r.spannedTd&&wb.removeAttribute(p.role);wb.getAttribute(p.value)&&wb.removeAttribute(p.value)}if(!c.getById(r.style)){var kb=pa(b),xb=c.appendStyleText(kb),
xb=new POLARIS.dom.element(xb.ownerNode||xb.owningElement);xb.setAttribute("id",r.style)}var Xa=1,Va=P(c);if(Va)Xa=Z(Va),Sa(b,Va,!0);else{var qb=za(1,!1,b),Va=POLARIS.dom.element.createFromHtml(qb),Jb=N(Va,1),ab=Jb.body,Kb=c.getBody();Kb.removeClass("polaris_pagesize");Kb.moveChildren(ab,!0);Kb.append(Va);var bb=ab.getLast(),tb=ab.getLast(ca),Ra=null,db=null,eb=null,fb=null;bb?null===tb&&bb.type===POLARIS.NODE_TEXT?(Ra=a(b),fb=(eb=(db=Ra.getTextNodes())&&db[0])&&eb.getParent(),ab.moveChildren(fb),
ab.append(Ra)):bb.type===POLARIS.NODE_ELEMENT&&bb.is("br")&&(Ra=a(b),Ra.insertAfter(bb),Ra.append(bb)):(Ra=a(b),ab.append(Ra))}Wb(b,Va);for(var Wa=0;Wa<Xa;Wa++){var gb=b,hb=Wa+1,Ia=N(gb.document,hb),yb=Ia.marginTop,zb=Ia.header,Ab=Ia.background,Bb=Ia.grid,cb=Ia.content,Lb=Ia.body,Mb=Ia.footnote,Cb=Ia.footer,Nb=Ia.marginBottom;if(null==yb){var va="\x3cdiv "+p.role+'\x3d"'+r.pageMarginTop+'" unselectable\x3d"on"\x3e\x3c/div\x3e',yb=POLARIS.dom.element.createFromHtml(va);Ia.owner.append(yb,!0)}null==
zb&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageHeader+'"\x3e\x3c/div\x3e',zb=POLARIS.dom.element.createFromHtml(va),zb.insertAfter(yb));null==Ab&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageBackground+'"\x3e\x3c/div\x3e',Ab=POLARIS.dom.element.createFromHtml(va),Ab.insertAfter(zb));null==Bb&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageGrid+'"\x3e\x3c/div\x3e',Bb=POLARIS.dom.element.createFromHtml(va),Bb.insertAfter(Ab));null==cb&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageContent+'"\x3e\x3c/div\x3e',cb=POLARIS.dom.element.createFromHtml(va),
cb.insertAfter(Bb));null==Lb&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageBody+'" contenteditable\x3d"'+(0==O||2==O?!1:!0)+'"\x3e\x3c/div\x3e',Lb=POLARIS.dom.element.createFromHtml(va),cb.append(Lb,!0));null==Mb&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageFootnote+'"\x3e\x3c/div\x3e',Mb=POLARIS.dom.element.createFromHtml(va),cb.append(Mb));null==Cb&&(va="\x3cdiv "+p.role+'\x3d"'+r.pageFooter+'"\x3e\x3c/div\x3e',Cb=POLARIS.dom.element.createFromHtml(va),Cb.insertAfter(cb));null==Nb&&(va="\x3cdiv "+p.role+'\x3d"'+
r.pageMarginBottom+'" unselectable\x3d"on"\x3e\x3c/div\x3e',Nb=POLARIS.dom.element.createFromHtml(va),Nb.insertAfter(Cb));null==Ia.corner.owner&&xa(gb,hb)}ga(b);Jb&&Jb.footnote.setAttribute("ondblclick","parent.POLARIS.tools.callFunction("+Da(b)+", "+Xa+")");if(b.getCommand("showImageBorder").state==POLARIS.TRISTATE_OFF)for(var ib=c.find("img"),ub=ib.count(),Wa=0;Wa<ub;Wa++){var Db=ib.getItem(Wa),Fb=Db.getAttribute("src");Db.setAttribute("data-polaris-saved-src",Fb);Db.removeAttribute("src");Db.addClass("polaris_img_border")}Rb(c);
for(var ob=b.document.getBody().find("img, div, hr"),Ob=0;Ob<ob.count();Ob++){var Eb=ob.getItem(Ob);if("div"!=Eb.getName()||POLARIS.plugins.div.isTextbox(Eb))Eb.removeAttribute("data-polaris-pa-ondragstart"),Eb.setAttribute("ondragstart","return false")}for(var pb=b.document.getBody().find("div"),nb,rb,sb,Gb=pb.count(),Pb=0;Pb<Gb;Pb++)nb=pb.getItem(Pb),POLARIS.plugins.div.isTextbox(nb)&&(rb=nb.getStyle("height"),sb=nb.getStyle("min-height"),rb==sb&&nb.removeStyle("height"));b.fire("updateTimeCode");
y=!1;sa(b);Qb(c.findOne("div[doc-data-role\x3dpolaris-page-body]"));b.fire("contentChange",{type:"contentDomComplete",sync:!0});return!0},sa=function(a){var b=0,c=null,d="";a=a.document.find("span");for(var e=function(a){return a.type===POLARIS.NODE_ELEMENT&&a.is({div:1,p:1,ol:1,ul:1,dl:1,li:1,article:1,th:1,td:1,br:1})?!1:!0},f="",d="",g=function(a){if(!a)return!1;for(a=a.getPreviousSourceNode(!0,POLARIS.NODE_TEXT,e);a;){if(0<a.getText().length)return!1;a=a.getPreviousSourceNode(!0,POLARIS.NODE_TEXT,
e)}return!0},h=function(a){if(!a)return null;for(a=a.getPreviousSourceNode(!0,POLARIS.NODE_TEXT,e);a&&!(0<a.getText().length);)a=a.getPreviousSourceNode(!0,POLARIS.NODE_TEXT,e);return(a=a&&a.getText())&&a.charAt(a.length-1)},k=function(a){if(!a)return null;for(a=a.getNextSourceNode(!0,POLARIS.NODE_TEXT,e);a&&!(0<a.getText().length);)a=a.getNextSourceNode(!0,POLARIS.NODE_TEXT,e);return(a=a&&a.getText())&&a.charAt(0)},b=0;b<a.count();b+=1)c=a.getItem(b),d=c.getHtml(),/^&nbsp;$/i.test(d)?g(c)||(f=h(c),
d=k(c),f&&d&&" "!==f&&" "!==d&&c.setHtml(" ")):!/^&nbsp;/i.test(d)||/^&nbsp; /i.test(d)||g(c)||(f=h(c)," "!==f&&c.setHtml(d.replace(/^&nbsp;/," ")))},ha=function(a){},ya=function(a){return POLARIS.tools.addFunction(function(b,c){0!=a.element.$.GetEditMode()&&a.fire("showHeaderFooterTool",{type:c,pageNumber:b})})},Da=function(a){return POLARIS.tools.addFunction(function(){a.fire("showCommentTool",{command:"footnote"})})},wa=function(a){return POLARIS.tools.addFunction(function(){a.fire("showCommentTool",
{command:"endnote"})})},ia=function(a){return POLARIS.tools.addFunction(function(b){a.fire("showCommentTool",{command:"footnote",newCommentNumber:b,editComment:!0})})},ta=function(a){return POLARIS.tools.addFunction(function(b){a.fire("showCommentTool",{command:"endnote",newCommentNumber:b,editComment:!0})})},ca=function(a){return a.type==POLARIS.NODE_ELEMENT},ja=function(a){return a.type==POLARIS.NODE_ELEMENT&&a.getAttribute(p.role)==r.pageBody},K=function(a){return a.type==POLARIS.NODE_ELEMENT&&
a.getAttribute(p.role)==r.page},M=function(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute(p.field)&&!a.is("td")},fa=function(a){return a&&"absolute"===a.getStyle("position")&&0===parseInt(a.getStyle("bottom"))?!0:!1},Y=null,Q=function(a,b,c){POLARIS.log.plugin("[requestForceLayout] 페이지를 갱신 요청한다. 페이지번호["+(b?b:0)+"]");Y&&clearTimeout(Y);c?T(a,b?b:0):Y=POLARIS.tools.setTimeout(T,100,a,[a,b?b:0])},ma=[],T=function(a,b,c){if(!(H||J||I)){var d=b;if(F){POLARIS.log.plugin("[forceLayout] 페이지 갱신이 진행중인 상태에서 다시 페이지 갱신 요청이 발생했다.");
for(var e=0;e<ma.length;e++)POLARIS.log.plugin("[forceLayout] 인덱스["+e+"], requestId["+ma[e].requestId+"], asyncReqId["+ma[e].asyncReqId+"]"),ma[e].asyncReqId&&(POLARIS.log.plugin("[forceLayout] 이전에 갱신작업을 진행중이던 작업을 취소 시킨다. 취소시키는 작업의 요청ID["+ma[e].requestId+"]"),clearTimeout(ma[e].asyncReqId),ma.splice(e,1),F=!1)}var f={};f.requestId=POLARIS.tools.getNextId();ma.push(f);POLARIS.log.plugin("[forceLayout] 페이지 갱신을 요청이 발생했다. 작업의 요청ID["+f.requestId+"]");a=a?a:this;var g=a.document,h=g.getSelection();if(!h||
F)c||(c=S(g)),aa(a,c),F=!1;else{a.fire("lockSnapshot",{dontUpdate:!0});for(var k=[],l=g.find(t(p.role,"footnote")),m=l.count(),e=0;e<m;e++){var n=l.getItem(e),n=parseInt(n.getText());k.push(B[n-1])}B=k;k=[];l=g.find(t(p.role,"endnote"));m=l.count();for(e=0;e<m;e++)n=l.getItem(e),n=parseInt(n.getText()),k.push(G[n-1]);G=k;var r=h.getStartElement(),e=h.getRanges()[0],h=function(a){return a.hasClass&&a.hasClass("polaris-page-footnote")},e=r&&r.getAscendant(h)?null:e,g=P(g);b=parseInt(b);if(isNaN(b)||
0>b)b=0;g&&g.setAttribute("workingPageIndex",b);e&&(z=r?r.getAscendant(K,!0):null);POLARIS.log.plugin("[forceLayout] 페이지 갱신을 요청한다. 갱신할 페이지의 인덱스["+b+"]");Ua(a,f.requestId,r,e,c,b,d);POLARIS.config.pagination_debug&&(r&&r.addClass("polaris-debug-area"),POLARIS.tools.setTimeout(function(){r&&r.removeClass("polaris-debug-area")},500,this))}}},La=function(a,b,c,d){var e=a.document;if(H||J)a.fire("unlockSnapshot");else{if(d){var f=d.startContainer?d.startContainer.getAscendant(K,!0):null;if(f&&z&&0==f.equals(z)){f=
d.startContainer;if(0==f.getText().replace(/\u200B/g,"").length&&f.type==POLARIS.NODE_ELEMENT){var g=f.getHtml().replace(/\u200B{7}/g,"");f.setHtml(g);d.moveToLeafElementEditablePosition(f,!1);d.select()}else a.getSelection().selectRanges([d]);d.scrollIntoView()}}if(D)for(f=D.getParent(),D.remove(),D=null,0==f.getChildCount()&&f.appendBogus(),d=a.getSelection().getRanges()[0],d.setStart(f,0),d.setEnd(f,0),d.select(),f.scrollIntoView(!0),f=e.find(w.bookmarkPageBreak),g=f.count(),d=0;d<g;d++)f.getItem(d).remove();
f=a.checkDirty();c.removeAttribute("workingPageIndex");if(a.getCommand("grid").state==POLARIS.TRISTATE_ON)for(c=Z(c),d=0;d<c;d++)g=N(e,d+1),Ca(a,g);c=!0;a.getCommand("showImageBorder").state==POLARIS.TRISTATE_OFF&&(c=!1);var g=e.find("img"),h=g.count();for(d=0;d<h;d++){var k=g.getItem(d);if(c){var l=k.getAttribute("src");l||(l=k.getAttribute("data-polaris-saved-src"),k.setAttribute("src",l),k.removeClass("polaris_img_border"))}else if(l=k.getAttribute("src"))k.setAttribute("data-polaris-saved-src",
l),k.removeAttribute("src"),k.addClass("polaris_img_border")}c=!1;a.getCommand("showTableBorder").state==POLARIS.TRISTATE_ON&&(c=!0);g=e.find("table");h=g.count();for(d=0;d<h;d++)k=g.getItem(d),k.removeClass("polaris_show_border"),c&&k.addClass("polaris_show_border"),POLARIS.plugins.tabletools.displayRedBorder(k,c,a);if("SNT"==a.config.customer)for(c=a.document.getBody().find("meta"),d=0;d<c.count();d++)c.getItem(d).remove();aa(a);F=!1;POLARIS.tools.setTimeout(function(){a.fire("paginationReady")},
50,a);for(d=0;d<ma.length;d++)ma[d].requestId==b&&(POLARIS.log.plugin("[finishLayout] 페이지 갱신을 종료한다. 작업중이던 request를 map에서 삭제한다. 작업 요청ID["+b+"]"),ma.splice(d,1));e.getBody().removeAttribute("contentEditable");e=a.checkDirty();!f&&e&&a.resetDirty();a.fire("unlockSnapshot");0==y&&(a.resetUndo(),y=!0);POLARIS.log.plugin("[finishLayout] 페이지 갱신을 종료한다. 작업 요청ID["+b+"]")}},Sa=function(a,b,c,d){var e=b.find("[contenteditable]"),f=e.count();for(a=0;a<f;a++){var g=e.getItem(a);0==c&&!0===d?g.removeAttribute("contenteditable"):
g.setAttribute("contenteditable",c)}e=b.find("[contentEditable]");f=e.count();for(a=0;a<f;a++)g=e.getItem(a),0==c&&!0===d?g.removeAttribute("contentEditable"):g.setAttribute("contentEditable",c);b=S(b);d=b.count();for(a=0;a<d;a++)(e=b.getItem(a).body)&&e.setAttribute("contenteditable",c)},Fa=function(a){var b=0,c=a.getLast(function(a){var b="";if(POLARIS.NODE_ELEMENT===a.type&&(a.is("br")||!a.isVisible()))return!1;if(a.type===POLARIS.NODE_ELEMENT&&!a.is("img")||a.type===POLARIS.NODE_TEXT)if(b=a.getText(),
0===b.length)return!1;return!0}),d=null;c&&c.type==POLARIS.NODE_TEXT?(d=e(c),b=d.getClientRect().bottom,c.insertBefore(d),d.remove()):b=c&&c.type!=POLARIS.NODE_COMMENT?c.getClientRect().bottom:a.getClientRect().bottom;return b},Ta=function(a){var b=0,c=null;if(!a)return b;a.is("p")?b=Fa(a):a.is("article")?(c=a.getLast(function(a){return a.type===POLARIS.NODE_ELEMENT&&!a.is("article")}),b=Fa(c?c:a)):b=a.getClientRect().bottom;return b},Ya=function(a,b){if(!a||!b||a&&b&&a.equals(b))return!1;var c=a.getClientRect().bottom,
d=Ta(b),e=Math.floor(c)<Math.floor(d);POLARIS.log.plugin("[relayoutPages][isBottomExceeded] bottomOfEl1 \x3d "+c+", bottomOfEl2 \x3d "+d);return e},Ga=function(a,b){if(!a||!b||a&&b&&a.equals(b))return!1;var c=a.getClientRect().top,d=Ta(b),e=Math.floor(c)<Math.floor(d);POLARIS.log.plugin("[relayoutPages][isTopExceeded] topOfEl1 \x3d "+c+", bottomOfEl2 \x3d "+d);return e},tb=function(a,b,c){var d=a.find(w.pagedTable),e=d.count();if(0==e)return null;a=null;if(c)for(c=0;c<e;c++){a=d.getItem(c);var f=
$a(a);if(f)a=null;else break}else for(c=e-1;0<=c;c--)if(a=d.getItem(c),f=$a(a))a=null;else break;d=null;d=a&&a.getAttribute(p.value);return d==b.getAttribute(p.value)?a:null},db=function(a,b,c){var d=a.$.rows,e=[],f=[],g=0,h=d.length;POLARIS.log.plugin("[getRowsToMove] 테이블분리를 위한 계산 시작.");for(var k=0;k<h;k++){var l=new POLARIS.dom.element(d[k]),m=l.getClientRect().height;1==d.length&&(m=a.getClientRect().height);var n;n=g+m<=b?!0:0==g&&m>=c&&0<b?!0:!1;POLARIS.log.plugin("[getRowsToMove] 로우 넘버["+k+
"], 로우 높이["+m+"], accumulated + rowHeight["+(g+m)+"], givenHeight["+b+"], pageBodyHeight["+c+"], isFormerRow["+n+"]");n?e.push(l):f.push(l);g+=m}d.length==e.length&&a.getClientRect().height>b&&(POLARIS.log.plugin("[getRowsToMove] 다음테이블로 분리함. 테이블 전체 크기가 크다. "),f.push(e.pop()));POLARIS.log.plugin("[getRowsToMove] 테이블분리를 위한 계산 끝.");return{broken:!1,breakable:0!=e.length&&0!=f.length,movable:0==e.length||0==f.length,formerRows:new POLARIS.dom.nodeList(e,!0),latterRows:new POLARIS.dom.nodeList(f,!0)}},
eb=function(a,b,c){for(var d=new POLARIS.dom.element("table"),e=b.count(),f=0;f<e;f++)b.getItem(f).move(d);b=a;(a=a.findOne("tbody"))&&(b=a);d.moveChildren(b,c)},Ea=function(a,b,c){var d=a.$.rows;if(d.length==b||0==d.length)a.remove();else{a.getClientRect();for(var e=0,f=[],g=0;g<b;g++){var h=new POLARIS.dom.element(d[c?g:d.length-g-1]),e=e+h.getClientRect().height;f.push(h)}b=f.length;for(g=0;g<b;g++)f[g].remove();a.removeAttribute("height");a.removeStyle("height")}},Gb=function(a,b){function c(a,
b,d){var e=a.clone();e.removeAttribute("colspan");e.removeAttribute("rowspan");b&&d&&e.setStyle("height",d.height+"px");a.removeStyle("height");e.removeStyle("height");b=a.getUniqueId();d=parseInt(a.getAttribute(p.value));a.hasAttribute(p.value)&&!isNaN(d)?b=a.getAttribute(p.value):(a.setAttribute(p.value,b),a.setAttribute(p.role,r.spannedTd));e.setAttribute(p.value,b);e.setAttribute(p.role,r.spannedTd);e.hide();return e}for(var d=POLARIS.tools.buildTableMap(a),e=d.length,f=0;f<e;f++)if((b=new POLARIS.dom.element(a.$.rows[f]))&&
b.$)for(var g=b.getClientRect(),h=null,k=null,l=0;l<d[f].length;l++){var m=new POLARIS.dom.element(d[f][l]);if(m&&m.$){var n=null;isNaN(m.$.colSpan)&&0==m.hasAttribute(p.role)&&(m.$.colSpan=1);isNaN(m.$.rowSpan)&&0==m.hasAttribute(p.role)&&(m.$.rowSpan=1);b.$!=m.getParent().$?(n=c(m,b,g),k?n.insertAfter(k):(k=b.getFirst())&&n.insertBefore(k),k=n):k=m;if(null==n&&null!=h&&h.$==m.$&&0==m.hasAttribute(p.role))for(var q=0;q<m.$.colSpan-1;q++)n=c(m,null),n.removeAttribute(p.field),n.insertAfter(h),h=n;
h=m}}},Pa=function(a){for(var b=a.find(w.spannedTd),c=b.count(),d={},e=0;e<c;e++){var f=b.getItem(e).getAttribute(p.value);d[f]=f}for(f in d){for(var b=a.find(w.getByAttr(p.value,f)),d=c=1,g=e=null,h=b.count(),k=0,l=0;l<h;l++){var m=b.getItem(l);0==l?(g=m,m.getParent(),m.show()):(g.getParent().$==m.getParent().$?d++:(e.$!=m.getParent().$&&c++,m.getParent()),m.$.rowSpan=1,m.$.colSpan=1,m.hide());e=m.getParent();k+=e&&e.getSize("height")}g&&(g.$.rowSpan!=c&&0<k&&(g.removeAttribute("height"),g.removeStyle("height")),
g.$.rowSpan=c,g.$.colSpan=d)}},Za=function(a,b,c,d){if(null==c){if(!a.breakable)return null;c=b.getUniqueId();b.hasAttribute(p.role)&&b.hasAttribute(p.value)&&(c=b.getAttribute(p.value));b.setAttribute(p.value,c);b.setAttribute(p.role,r.pagedTable);POLARIS.plugins.tabletools.addColgroup(b);Gb(b);c=b.clone(!0,!0);d?(Ea(b,a.formerRows.count(),!0),Ea(c,a.latterRows.count(),!1)):(Ea(b,a.latterRows.count(),!1),Ea(c,a.formerRows.count(),!0));Pa(b);Pa(c);a.broken=0<a.formerRows.count()||0<a.latterRows.count();
return c}d?(Ea(b,a.formerRows.count(),!0),eb(c,a.formerRows),a.broken=0<a.formerRows.count()):(Ea(b,a.latterRows.count(),!1),eb(c,a.latterRows,!0),a.broken=0<a.latterRows.count());Pa(b);Pa(c);return null},Ha=function(a,b){for(var c=a.getItem(0),d=a.count(),e=1;e<d;e++){for(var f=a.getItem(e),g=[],h=f.$.rows.length,k=0;k<h;k++)g.push(new POLARIS.dom.element(f.$.rows[k]));g=new POLARIS.dom.nodeList(g,!0);Za({broken:!1,breakable:!1,movable:!0,formerRows:g,latterRows:null},f,c,!0)}b&&(c.removeAttribute(p.role),
c.removeAttribute(p.value));d=c.find(w.spannedTd);f=d.count();for(e=0;e<f;e++)g=d.getItem(e),"none"==g.getStyle("display")&&"1"==g.getAttribute("rowspan")&&"1"==g.getAttribute("colspan")?g.remove():(g.removeAttribute(p.role),g.removeAttribute(p.value));return c},fb=function(a){a=a.find(w.pagedTable);for(var b=[],c=null,d=a.count(),e=0;e<d;e++){var f=a.getItem(e);null==c&&(c=f.getAttribute(p.value));var g=f.getAttribute(p.value);c!=g&&(1<b.length&&Ha(new POLARIS.dom.nodeList(b,!0),!1),c=g,b=[]);b.push(f)}1<
b.length&&Ha(new POLARIS.dom.nodeList(b,!0),!1)},Xb=function(a){for(var b=a.find(w.pagedTable),c=[],d=null,e=b.count(),f=0;f<e;f++){var g=b.getItem(f);null==d&&(d=g.getAttribute(p.value));var h=g.getAttribute(p.value);d!=h&&(1<c.length&&Ha(new POLARIS.dom.nodeList(c,!0),!0),d=h,c=[]);c.push(g)}1<c.length&&Ha(new POLARIS.dom.nodeList(c,!0),!0);a=a.find(w.spannedTd);b=a.count();for(c=0;c<b;c++)(d=a.getItem(c))&&"none"==d.getStyle("display")&&d.remove()},Yb=function(a){if(a&&a.body){for(var b=a.body,
c=!0,d=b.getChildCount(),e=0;e<d;e++)if(0<b.getChild(e).getClientRect().height){c=!1;break}c&&a.owner.remove()}},gb=function(a,b){var c=a.document,d=b.find("div[style]");if(d)for(var e=d.count(),f=0;f<e;f++){var g=d.getItem(f);if(g&&"absolute"==g.getStyle("position")&&"0px"==g.getStyle("bottom")&&!g.getAttribute("doc-data-role")){var h=g.findOne("table");h&&(g.removeStyle("width"),g.removeStyle("height"),g.removeStyle("min-height"),h.removeStyle("position"),h.removeStyle("bottom"))}}e=d=null;if(f=
c.findOne('[doc-data-field\x3d"표준기안문"]'))if(f=f.getAscendant("table"))(d=f.getAscendant("table"))&&(f=d),d=f.getClientRect().width,e=f.getClientRect().height,c=c.findOne(w.container),c=POLARIS.tools.getScaleRatio(c),e=100*e/c+"px",d=100*d/c+"px";if(c=b.findOne('[doc-data-field\x3d"표준기안문"]'))if(f=c.getAscendant("table"))(c=f.getAscendant("table"))&&(f=c),c=new POLARIS.dom.element("div"),c.insertBefore(f),c.append(f.remove()),c.setStyle("position",f.getStyle("position")),c.setStyle("bottom",f.getStyle("bottom")),
c.setStyle("width",d),c.setStyle("height",e),f.removeStyle("position"),f.removeStyle("bottom");if(d=b.findOne('[doc-data-field\x3d"인"]'))if(e=d.getAscendant("table"))e.getParent()&&e.getParent().is("div")?(c=e.getParent(),d=POLARIS.tools.convertToUnit(c.getStyle("margin-left"),"px"),c.setStyle("margin-left",d),c.setStyle("z-index",-1)):(c=new POLARIS.dom.element("div"),c.insertBefore(e),c.append(e.remove()),c.setStyle("position",e.getStyle("position")),c.setStyle("top",e.getStyle("top")),c.setStyle("left",
e.getStyle("left")),c.setStyle("width",d.getStyle("width")),c.setStyle("height",d.getStyle("height")),c.setStyle("z-index",-1),e.removeStyle("position"),e.removeStyle("top"),e.removeStyle("left"))},Zb=function(a){function b(c,d){var e=new POLARIS.dom.element(POLARIS.env.ie&&8>=POLARIS.env.version?"div":"article");if(c&&d){e.setAttribute("doc-data-field",c.getAttribute("doc-data-field"));e.setAttribute("doc-data-field-editable",c.getAttribute("doc-data-field-editable"));e.setAttribute("doc-data-field-position",
"both");c.removeAttribute("doc-data-field");c.removeAttribute("doc-data-field-editable");c.removeAttribute("doc-data-field-position");d.removeAttribute("doc-data-field");d.removeAttribute("doc-data-field-editable");d.removeAttribute("doc-data-field-position");e.insertBefore(c);var f=new POLARIS.dom.range(a);f.setStartBefore(c);f.setEndAfter(d);f.extractContents().appendTo(e)}else f=null==c?d:c,e.setAttribute("doc-data-field",f.getAttribute("doc-data-field")),e.setAttribute("doc-data-field-editable",
f.getAttribute("doc-data-field-editable")),e.setAttribute("doc-data-field-position","both"),f.removeAttribute("doc-data-field"),f.removeAttribute("doc-data-field-editable"),f.removeAttribute("doc-data-field-position"),e.insertBefore(f),e.append(f.remove());POLARIS.env.ie&&e.setStyle("ime-mode","active")}for(var c=a.find("p[doc-data-field]"),d=null,e=null,f=c.count(),g=0;g<f;g++){var h=c.getItem(g);"start"==h.getAttribute("doc-data-field-position")?(d&&b(d,null),d=h):"end"==h.getAttribute("doc-data-field-position")?
null==d?b(null,h):(e&&b(null,e),e=h):b(h,null);d&&e&&(b(d,e),e=d=null)}null==d&&null==e||b(d,e)},$b=function(a,b){for(var c=b.find("p[doc-data-field]"),d=c.count(),e=0,e=0;e<d;e++){var f=c.getItem(e);f.removeAttribute("doc-data-field");f.removeAttribute("doc-data-field-editable");f.removeAttribute("doc-data-field-position")}},ac=function(a,b,c){if(a.config.clickHereConvert){a=b.find("[doc-data-field-position]");for(var d=b=null,e=a.count(),f=0;f<e;f++){var g=a.getItem(f);b=g.getFirst(ca);d=g.getLast(ca);
if(null==b&&null==d){b=d=new POLARIS.dom.element("p");var h=g.getText();h&&(b.setText(h),g.setText(""));g.append(b)}0==b.is("p")&&(h=new POLARIS.dom.element("p"),h.setHtml(Aa(c)),h.insertBefore(b),b=h);0==d.is("p")&&(h=new POLARIS.dom.element("p"),h.setHtml(Aa(c)),h.insertAfter(d),d=h);b.setAttribute("doc-data-field",g.getAttribute("doc-data-field"));b.setAttribute("doc-data-field-editable",g.getAttribute("doc-data-field-editable"));b.setAttribute("doc-data-field-position","start");d.setAttribute("doc-data-field",
g.getAttribute("doc-data-field"));d.setAttribute("doc-data-field-editable",g.getAttribute("doc-data-field-editable"));d.setAttribute("doc-data-field-position","end");0==b.getText().length&&"\x3cbr\x3e"!=b.getHtml()&&(b.findOne("img")||b.setHtml(Aa(c)));0==d.getText().length&&"\x3cbr\x3e"!=d.getHtml()&&(d.findOne("img")||d.setHtml(Aa(c)));b.$==d.$&&b.removeAttribute("doc-data-field-position");g.removeAttribute("doc-data-field");g.removeAttribute("doc-data-field-editable");g.removeAttribute("doc-data-field-position");
g.remove(!0)}}},Qb=function(a){if(a&&a.findOne('[doc-data-field\x3d"표준기안문"]')){var b=a.find("article"),c=a.find("table[doc-data-role\x3dremovable-pubdocbody]");if(b&&1===b.count()&&c&&2===c.count()){var b=b.getItem(0),d=c.getItem(0),c=c.getItem(1),e=b.getParent(),f=d.getParent(),g=c.getParent();g.equals(b)&&(c.insertAfter(b),g=c.getParent());if(a.equals(e)&&a.equals(f)&&a.equals(g)){for(a=b.getPrevious();a&&!a.equals(d);)(e=b.getChild(0))?a.insertBefore(e):b.append(a),a=b.getPrevious();for(d=b.getNext();d&&
!d.equals(c);)b.append(d),d=b.getNext()}}}},hb=function(a,b,c){var d=a.getClientRect().width,e=a.getClientRect().height;d>b?(a.setAttribute("width",b+"px"),a.setStyle("width",b+"px"),b=b/d*e,a.setAttribute("height",b+"px"),a.setStyle("height",b+"px")):e>c&&(a.setAttribute("height",c+"px"),a.setStyle("height",c+"px"),b=c/e*d,a.setAttribute("width",b+"px"),a.setStyle("width",b+"px"))},Rb=function(a){var b=N(a,1),c=b.body.getClientRect().width,b=b.body.getClientRect().height;a=a.find("img");for(var d=
0;d<a.count();d++){var e=a.getItem(d);hb(e,c,b)}},bc=function(a){var b=a.editor,c=N(b.document,1).body.getClientRect().width;a=a.data.element;"img"==a.getName()&&(hb(a,c),Q(b,0))},ib=function(a,b){for(var c=b.find('img[data-polaris-real-element-type\x3d"anchor"]'),d=c.count(),e=0;e<d;e++){var f=c.getItem(e),g=POLARIS.plugins.link&&POLARIS.plugins.link.tryRestoreFakeAnchor(a,f);g&&(g.removeAttribute("data-polaris-saved-name"),g.insertBefore(f),f.remove())}c=b.find("a[data-polaris-saved-href]");d=c.count();
for(e=0;e<d;e++)c.getItem(e).removeAttribute("data-polaris-saved-href")},$a=function(a){return null==a?null:"absolute"==a.getStyle("position")&&"0px"==a.getStyle("bottom")?a:null},Ma=function(a,d){if(a.getAscendant("table",1)||a.is("div")||a.getClientRect().top>d)return{previousBlock:null,nextBlock:a};var f=!1,g=0,h=null,k=null,l=null,m=null,n=0,q=null,t=null,u=0,z=null,t=0,D=g=n=null,D=POLARIS.dom.walker.bookmark(),v=function(b){return!b.equals(a)},m=new POLARIS.dom.range(a.getDocument());m.selectNodeContents(a);
var w=new POLARIS.dom.walker(m);w.guard=v;var x=function(a){for(a=a.getPreviousSourceNode(!0,POLARIS.NODE_ELEMENT,v);a;){if(a.is("img"))return!0;a=a.getPreviousSourceNode(!0,POLARIS.NODE_ELEMENT,v)}return!1};for(a.mergeTextNodes();null!==(m=w.next());)if(m.type===POLARIS.NODE_ELEMENT){if(m.is({img:1,div:1,br:1})&&m.getClientRect().bottom>d){n=new POLARIS.dom.range(a.getDocument());n.moveToElementEditStart(m);n.checkStartOfBlock()?h=a:(h=n.splitElement(a),k=a);break}}else if(m.type===POLARIS.NODE_TEXT&&
!D(m.getParent())){g=0;null!=l||x(m)||(l=m);POLARIS.log.plugin("[relayoutPages][lineBreak] text \x3d "+m.getText());q=e(m);t=q.find("["+r.letterSplitIdentifier+"]");u=t.count();for(n=n=0;n<u;n+=1){z=t.getItem(n);if(z.getClientRect().bottom>d){f=!0;b(z);t=c(z,d);g+=t;m.insertBefore(q);q.remove();if(l&&l.equals(m)&&0==n){h=a;break}n=new POLARIS.dom.range(a.getDocument());n.setStart(m,g);n.setEnd(m,g);g=n.splitElement(a);k=a;k.mergeSiblingAllElements();g.mergeSiblingAllElements();h=g;h.trim();break}g+=
z.getText().length}if(f)break;else m.insertBefore(q),q.remove()}k&&h?(D=k.getUniqueId(),k.hasAttribute(p.split)&&(D=k.getAttribute(p.split)),k.setAttribute(p.split,D),h.setAttribute(p.split,D),h.getStyle("text-indent")&&h.removeStyle("text-indent")):null===k&&null===h&&(a.getClientRect().bottom>d?nextBlock=a:previousBlock=a);k&&POLARIS.log.plugin("[relayoutPages][lineBreak] previousBlockTag \x3d "+k.getHtml());h&&POLARIS.log.plugin("[relayoutPages][lineBreak] nextBlockTag \x3d "+h.getHtml());return{previousBlock:k,
nextBlock:h}},cc=function(a,c,f){var g=null,h=null,k=null,l=0,m=!1,n=null,q=null,t=0,u=0,z=0,D=!1,v=null,w=null,x=0,y=null,O=z=null,P=0,C=null,A=null,u=0,u=w=D=u=u=null,B=a&&a.getClientRect(),X=0,k=new POLARIS.dom.range(a.getDocument());k.selectNodeContents(a);var U=new POLARIS.dom.walker(k);U.guard=function(b){return!b.equals(a)};var F=function(a,b,c){var d=0,d=B?B.width:0;if(b>=c){var e=0;if(0<c)for(var f=c;b>=f;)f+=c,e+=1;d=a+d*e}else d=a;return d};for(POLARIS.log.plugin("[relayoutPages][letterBreak] 글자분리 시작");null!==
(k=U.next());)if(k.type==POLARIS.NODE_TEXT){null==n&&(n=k);v=e(k);w=v.find("["+r.letterSplitIdentifier+"]");x=w.count();for(u=t=0;u<x;u+=1)if(D=!1,y=w.getItem(u),z=y.getClientRect(),q=k,X=F(c,f,z.height),l+z.width<X)l+=z.width,t+=y.getText().length;else{b(y);O=y.find("["+r.letterSplitIdentifier+"]");P=O.count();for(z=0;z<P;z+=1)if(C=O.getItem(z),A=C.getClientRect(),X=F(c,f,A.height),l+A.width<X)l+=A.width,t+=C.getText().length;else{D=!0;break}if(D){u=d(y,l,c);t+=u;m=!0;k.insertBefore(v);v.remove();
null!=q&&0<=t&&(u=new POLARIS.dom.range(a.getDocument()),u.setStart(q,t),u.setEnd(q,t),u=u.splitElement(a),h=a,h.mergeSiblingAllElements(),u.mergeSiblingAllElements(),D=h.getHtml(),w=D.substring(D.length-1)," "==w&&(h.setHtml(D.substring(0,D.length-1)),h.appendHtml("\x26nbsp;")),g=u,g.trim(),h&&(h.trim(),u=h.getUniqueId(),h.hasAttribute(p.split)&&(u=h.getAttribute(p.split)),h.setAttribute(p.split,u),g.setAttribute(p.split,u)),q=null,t=-1);break}}if(m)break;else k.insertBefore(v),v.remove()}0==m&&
null!=q&&0<=t&&(h=a,g=null);h&&POLARIS.log.plugin("[relayoutPages][letterBreak] previousBlockTag \x3d "+h.getHtml());g&&POLARIS.log.plugin("[relayoutPages][letterBreak] nextBlockTag \x3d "+g.getHtml());POLARIS.log.plugin("[relayoutPages][letterBreak] 글자분리 끝.");return{previousBlock:h,nextBlock:g}},jb=function(a,b){var c=a&&a.getParent(),d=null,e=null,f="";if(!a||!b||a.is("div")&&"absolute"==a.getStyle("position")&&"0px"==a.getStyle("bottom"))return a;for(;c&&c.$!=b.$;)a.equals(c.getFirst(ca))?a=c:
(a.breakParent(c),d=a.getPrevious(),e=a.getNext(),a.appendTo(e,!0),f=d.getUniqueId(),d.hasAttribute(p.split)&&(f=d.getAttribute(p.split)),d.setAttribute(p.split,f),e.setAttribute(p.split,f),a=e),c=a&&a.getParent();return a},Na=function(a,b){function c(a){a=a.find(w.split);for(var b=a.count(),d=0;d<b;d++)a.getItem(d).removeAttribute(p.split)}function d(a){a=a.find("br");for(var b=a.count(),c=0;c<b;c++){var e=a.getItem(c).getAttribute("style");if(e&&-1<e.indexOf("page-break-before"))return!0}return!1}
function e(a,b){var c=!1;a.$!=b.$&&(a.getParent().equals(b.getParent())||a.contains(b))&&(c=!0);return c}var f=null,g=a.find(w.split),h=g.count();if(!(1>=h))for(var k=0;k<h;k++){var l=g.getItem(k),f=l.getAttribute(p.split);if(null!=f&&0!=f.length&&"null"!==f){var m=a.find("["+p.split+'\x3d"'+f+'"]'),n=m.count();if(1<n){for(var r=0;r<n;r++)f=m.getItem(r),!e(l,f)||l.is("p")&&f.is("p")&&(d(l.getParent())||d(f.getParent()))||(f.moveChildren(l),f.remove());l.is({p:1,span:1})&&(l.mergeTextNodes(),l.mergeSiblingAllElements())}}}!0===
b&&c(a)},Qa=function(a,b,c){var d=null;isPageExceeded=!1;do{if(a&&!a.is({div:1,table:1,br:1,p:1,font:1,a:1})){for(var e=a.getFirst(ca);e&&e.isBlockBoundary()&&!e.is({div:1,table:1,br:1,p:1,font:1,a:1});)a=e,e=e.getFirst(ca);null!=e&&(a=e)}if(null==a)break;if(c(d,a)){isPageExceeded=!0;break}e=a.getNext(ca);if(null==e)for(d=a;null==e&&(d=d.getParent())&&d.getAttribute(p.role)!=r.pageBody;)e=d.getNext(ca);d=a;if(null==e)break;a=e}while(a);return{element:b?d:a,isPageExceeded:b?null!=d:isPageExceeded}},
ub=function(a,b){var c=b&&b.getFirst(ca);return c&&a&&c.equals(a)?!0:!1},dc=function(a,b){if(!a||a.type!==POLARIS.NODE_ELEMENT||!b||b.type!==POLARIS.NODE_ELEMENT)return null;if(!ub(a,b))return!0;var c=b.getClientRect().height,d=null,e=function(a){for(var b=a&&a.count(),d=null,e=d=0;e<b;e+=1)if(d=a.getItem(e),d=d.getClientRect().height,d>c)return!0;return!1};if(a.is("div")){if(d=new POLARIS.dom.nodeList([a.$]),e(d))return!1}else if(a.is("table")){if(d=a.find("tr"),1===d.count()&&e(d))return!1}else if(d=
a.find("img"),e(d))return!1;return!0},Ua=function(a,b,c,d,e,f,k){try{var m=null,n=null,q=null,t=0,u=null,z=null,D=null,v=null,x=null,y=null,O=null,C=null,A=0,B=null,X=null,N=null,E=null,G=null,H=0,I=null,za=!1,J=!1,V=!1,L=!1,Z=!1,K=!1,M=!1,R=!1,ka=!1,Q=0,m=a.document;if(n=P(m))if(q=e?e:S(n),t=f?f:0,u=q.getItem(t))if(z=u&&u.owner,A=z.getAttribute(r.page),D=u.body,B=u.footnote,X=D&&D.getFirst(ca),N=D&&D.getLast(ca),E=D&&D.getFirst(fa),O=N,J=k==t?!0:!1,B&&B.isVisible(),pageBreakElement=D&&D.findOne(w.pageBreak),
Q=E?E.getClientRect().top:D.getClientRect().bottom,POLARIS.log.plugin("[relayoutPages] 페이지 갱신을 시작한다. 페이지 갱신 작업 요청ID["+b+"]"),POLARIS.log.plugin("[relayoutPages] 페이지 갱신을 시작한다. 전체 작업 개수["+ma.length+"]"),POLARIS.log.plugin("[relayoutPages] 전체 페이지는 개수는 ["+q.count()+"]이고, 현재 갱신작업중인 페이지의 index는["+t+"]이다. workingPageIndex \x3d "+t+", pageNumber \x3d "+A+", isCursorInPage \x3d "+J),z.setAttribute(r.page,t+1),N){F=!0;pageBreakElement?ka=!0:B&&B.isVisible()?ka=Ga(B,N):E?(ka=Ga(E,E.getPrevious(ca)))||(ka=Ga(E,
N)):ka=Ya(D,N);POLARIS.log.plugin("[relayoutPages] 페이지를 넘어가는 내용이 있는지 체크한다. isPageExceeded \x3d "+ka);if(ka){POLARIS.log.plugin("[relayoutPages] 페이지를 넘어가는 내용이 존재한다. ");if(t==q.count()-1){var ba=q.count()+1;Ja(a,ba);R=!0;POLARIS.log.plugin("[relayoutPages] 갱신 작업 중인 페이지가 제일 마지막 이므로 페이지를 새로 생성한다. 새로 생성하는 페이지의 넘버["+ba+"]")}else e=t+1,v=q.getItem(e),v.owner.getAttribute("polaris-page-break-inserted")&&(POLARIS.log.plugin("[relayoutPages] 쪽나누기인경우 페이지를 추가한다.... 새로 생성하는 페이지의 인덱스["+e+"]"),Oa(a,e));x=(v=U(z))&&
v.body;G=Qa(X,!1,function(a,b){if(B.isVisible()&&Ga(B,b)||E&&E.equals(b)&&Ga(E,a)||E&&b.getPosition(E)===POLARIS.POSITION_FOLLOWING&&Ga(E,b)||Ya(D,b)){if(!b.hasAttribute("movedFromPreviousPage"))return!0;b.removeAttribute("movedFromPreviousPage")}return!1});ka=G.isPageExceeded;y=G.element;ka?!1===dc(y,D)&&(y=y&&y.getNext(ca)):y=null;POLARIS.log.plugin("[relayoutPages] 페이지를 넘어가는 element를 찾았는지에 대한 여부. isPageExceeded \x3d "+ka);!pageBreakElement||null!=y&&pageBreakElement.getPosition(y)!==POLARIS.POSITION_PRECEDING||
(pageBreakElement.removeAttribute(p.role),y=pageBreakElement,u.owner.setAttribute(r.pageBreak,!0),v.owner.setAttribute(r.pageBreak,!0),v.owner.setAttribute("polaris-page-break-inserted",!0),POLARIS.log.plugin("[relayoutPages] page break된 단락을 startElement로 지정한다."));if(y){POLARIS.log.plugin("[relayoutPages] 분리 작업을 해야하는 element가 존재한다.");y.is({table:1,p:1,div:1,span:1,article:1,section:1})?y.is("div")&&y.getClientRect().bottom>D.getClientRect().bottom?(Z=!0,POLARIS.log.plugin("[relayoutPages] 분리작업을 해야하는 element가 DIV이고, DIV의 높이가 페이지의 높이보다 크다. 다음페이지로 넘기지 않는다.")):
y.is("table")&&1==y.$.rows.length&&y.getClientRect().height>D.getClientRect().height&&(Z=!0,POLARIS.log.plugin("[relayoutPages] 분리작업을 해야하는 element가 테이블이고, 테이블의 높이가 페이지의 높이보다 크다. 다음페이지로 넘기지 않는다.")):y.getClientRect().bottom>D.getClientRect().bottom&&(y.getClientRect().height>D.getClientRect().height||"absolute"==y.getComputedStyle("position"))?Z=!0:y.getClientRect().height>D.getClientRect().height&&((C=y.getNext(ca))&&0==C.getClientRect().height?Z=!0:y.setAttribute("movedFromPreviousPage",t));var T=
null;0==Z&&y.is("table")&&(E&&y.getPosition(E)!==POLARIS.POSITION_PRECEDING||(M=!0));if(M){var xa=y.is("table")?y:O,aa=Math.floor(Q)-Math.floor(xa.getClientRect().top);POLARIS.log.plugin("[relayoutPages] 분리작업을 해야하는 element가 테이블이다. 테이블을 분리시작. 출력가능높이["+aa+"]");var ea=tb(x,xa,!0);POLARIS.log.plugin("[relayoutPages] 출력가능높이을 가지고 테이블을 분리한다. 출력가능높이["+aa+"]");var T=db(xa,aa,Math.floor(D.getClientRect().height)),da=Za(T,xa,ea,!1);da?(POLARIS.log.plugin("[relayoutPages] 분리된 테이블이 존재한다. 분리된 테이블을 현재페이지 이후에 삽입한다."),
da.insertAfter(xa),y.$==O.$&&(O=da),y=da):(POLARIS.log.plugin("[relayoutPages] 분리된 테이블이 존재하지 않는다."),Z=T.broken)}Z&&(POLARIS.log.plugin("[relayoutPages] 한개의 element가 페이지높이보다 크다."),(C=ub(y,D)?y.getNext(ca):y)?(POLARIS.log.plugin("[relayoutPages] 다음 element가 존재한다. 다음 element들은 다음페이지로 넘겨야한다."),Z=!1,y=C,K=!0):(POLARIS.log.plugin("[relayoutPages] 다음 element가 존재하지 않는다. 다음페이지가 빈페이지면 해당 페이지를 삭제한다."),Yb(q.getItem(t+1))));if(!Z){POLARIS.log.plugin("[relayoutPages] 한개의 element가 페이지높이보다 크지 않다.");O.hasAttribute(p.field)&&
(O=O.getLast(ca));V=h(J?d:null,y);L=J&&d&&d.checkEndOfBlock();POLARIS.log.plugin("[relayoutPages] isLastBlockEdit["+V+"], isEndOfBlock["+L+"]");V&&(d&&(I=d.createBookmark()),POLARIS.log.plugin("[relayoutPages] 페이지의 마지막 블럭이 수정하는 중이다. 커서위치를 기억한다. "));if(y&&O&&y.$==O.$){POLARIS.log.plugin("[relayoutPages] 현재 페이지에서 입력중인 element가 페이지의 마지막 element이다.");var Y=Ma(y,Q);if(null==Y.previousBlock&&null==Y.nextBlock)y=jb(y,D);else{var qa=Y.nextBlock;null!=qa&&(y=O=qa,y=jb(y,D))}var ga=x.getFirst(ca);ga&&y?ga.insertBeforeMe(y):
y&&y.appendTo(x)}else{POLARIS.log.plugin("[relayoutPages] 현재 페이지에서 입력중인 element가 페이지의 마지막 element가 아니다.");Y=Ma(y,Q);qa=Y.nextBlock;null!=qa&&(y=qa);y=jb(y,D);u=[];C=y;do if(u.push(C),C&&O&&C.$==O.$)break;while(C=C.getNext());for(;0<u.length;)moveElement=u.pop(),(ga=x.getFirst())?ga.insertBeforeMe(moveElement):moveElement.appendTo(x)}Na(D);Na(x);I&&d&&(d.moveToBookmark(I),d.select());if(pageBreakElement&&"polaris-page-break"!==pageBreakElement.getAttribute(p.role)){if(0==D.getChildCount())D.setHtml("\x3cp\x3e\x3cbr\x3e\x3c/p\x3e");
else{var Ca=D.findOne(w.bonmun);Ca&&0==Ca.getChildCount()&&Ca.setHtml("\x3cp\x3e\x3cbr\x3e\x3c/p\x3e")}pageBreakElement.is("p")&&0===pageBreakElement.getText().length&&pageBreakElement.remove()}}}else POLARIS.log.plugin("[relayoutPages] 분리 작업을 해야하는 element가 존재하지 않는다.");q=S(n);if(q.count()>t+1){POLARIS.log.plugin("[relayoutPages] 현재 갱신중인 페이지가 마지막 페이지가 아니다. 다음페이지 갱신을 요청한다. 현재 페이지 인덱스["+t+"]");POLARIS.log.plugin("[relayoutPages] isAppendNewPage["+R+"], needsToRelayoutThisPage["+K+"]");ua=t;R||K||(ua=
t+1);n.setAttribute("workingPageIndex",ua);Ka(a,b,c,d,q,t,ua,k,R);return}d&&a.getSelection().selectRanges([d]);La(a,b,n,d)}else POLARIS.log.plugin("[relayoutPages] 페이지를 넘어가는 내용이 존재하지 않는다. ");var K=!1,W=R=null,la=na(z),x=(v=U(z))&&v.body;if(!ka&&N&&x&&"true"!=z.getAttribute(r.pageBreak)){POLARIS.log.plugin("[relayoutPages] 페이지를 넘어가는 내용이 존재하지 않으나, 다음페이지에 내용이 존재한다. ");var W=x.getFirst(ca),sa=x.getLast(ca),ia=null,H=Math.floor(Q)-Math.floor(N.getClientRect().bottom),ia=$a(sa);Qa(W,!0,function(a,b){if(b.type!=
POLARIS.NODE_ELEMENT)return!1;W=b;return!0});if(!W||!W.is("table")||E||null!=ia&&W.$==ia.$){var ja=!1;N.hasAttribute(p.field)&&(N=N.getLast(ca));if(W&&(POLARIS.log.plugin("[relayoutPages] 다음페이지의 첫번째 element가 존재한다. "),N)){POLARIS.log.plugin("[relayoutPages] 현재페이지의 마지막 단락이 존재한다. ");var ha=N.getAttribute(p.split),Ba=W.getAttribute(p.split),oa=W.getAscendant("article",!0);if(null!=ha&&0<ha.length&&ha==Ba){POLARIS.log.plugin("[relayoutPages] 현재페이지의 마지막 단락과 다음페이지의 첫번째 단락이 분리되었던 단락이다. ");var ya=N.getBogus(),
pa=new POLARIS.dom.element("span");pa.setAttribute(p.temp,"1");pa.setHtml("\x26#8203;");ya?pa.insertBefore(ya):N.append(pa);var Da=g(N,pa);pa.remove();POLARIS.log.plugin("[relayoutPages] 현재페이지의 출력가능한 너비를 기준으로 단락을 분리한다. availableWidth["+Da+"]");ha={previousBlock:null,nextBlock:null};(V=h(d,N))&&d&&(I=d.createBookmark(),POLARIS.log.plugin("[relayoutPages] 커서위치를 기억한다. "),ha=cc(W,Da,H));if(null==ha.previousBlock&&null==ha.nextBlock){POLARIS.log.plugin("[relayoutPages] 분리된 블럭이 존재하지 않는다. ");var wa=x.getClientRect().top+
H,ta=Ma(W,wa).previousBlock;null!=ta&&(W=ta,ja=!0)}else if(null!=ha.previousBlock&&null==ha.nextBlock||null!=ha.previousBlock&&null!=ha.nextBlock){POLARIS.log.plugin("[relayoutPages] 분리된 블럭이 존재한다. 다음페이지의 단락을 현재페이지로 이동시킨다.");var Aa=new POLARIS.dom.element("span");Aa.setAttribute(p.temp,"1");Aa.insertAfter(ha.previousBlock);ha.previousBlock.insertAfter(N);Na(D);null!=ha.previousBlock.getParent()&&(N=ha.previousBlock);V=!1;if(V=B&&B.isVisible()?Ga(B,N):E?Ga(E,N):Ya(D,N))POLARIS.log.plugin("[relayoutPages] 글자를 이전페이지로 옮기고 났더니 내용이 페이지를 넘친다. "),
Y=Ma(N,Q),qa=Y.nextBlock,null!=qa&&(POLARIS.log.plugin("[relayoutPages] 다음 페이지로 옮길 단락이 존재한다. "),W=x.getFirst(ca),Qa(W,!0,function(a,b){if(b.type!=POLARIS.NODE_ELEMENT)return!1;W=b;return!0}),qa.insertBefore(W),W=qa,Na(x),POLARIS.log.plugin("[relayoutPages] 다음 페이지로 단락을 이동한다. "));H=Math.floor(Q)-Math.floor(N.getClientRect().bottom);I&&d&&(POLARIS.log.plugin("[relayoutPages] 이전에 기억한 커서위치로 되돌린다. "),d.moveToBookmark(I),d.select());Aa&&(Aa.remove(),W=x.getFirst(ca));oa&&0==oa.getChildCount()&&oa.remove()}}else POLARIS.log.plugin("[relayoutPages] 현재페이지의 마지막 단락과 다음페이지의 첫번째 단락이 분리된 단락이 아니다. "),
wa=x.getClientRect().top+H,ta=Ma(W,wa).previousBlock,null!=ta&&(W=ta,ja=!0)}}else{POLARIS.log.plugin("[relayoutPages] ......... ");var xa=W,Fa=tb(D,xa,!1),T=db(xa,H,Math.floor(D.getClientRect().height));if(da=Za(T,xa,Fa,!0))xa.insertBeforeMe(da),W=da;H=Math.floor(Q)-Math.floor(N.getClientRect().bottom)}var Ea=x.getClientRect().top;POLARIS.log.plugin("[relayoutPages] 다음페이지에서 현재 페이지로 이동가능한 element가 있는지 검색한다. ");G=Qa(W,!0,function(a,b){var c=0;if(b.type!=POLARIS.NODE_ELEMENT)return!1;c=Ta(b);c-=Ea;if(ia&&
b.$==ia.$){c=0;a&&a.type==POLARIS.NODE_ELEMENT&&(c=a.getClientRect().bottom-Ea);var d=POLARIS.tools.getScaleRatio(n)/100,e=b.getClientRect().height,f=POLARIS.tools.convertToUnit(b.getComputedStyle("margin-top"),"px",2),g=POLARIS.tools.convertToUnit(b.getComputedStyle("margin-bottom"),"px",2),f=isNaN(parseFloat(f))?0:parseFloat(f)*d,g=isNaN(parseFloat(g))?0:parseFloat(g)*d,c=c+(e+f+g)}if(c<H)return POLARIS.log.plugin("[relayoutPages][findFirstExceededElement] 이동시킬수 있다. "),!1;POLARIS.log.plugin("[relayoutPages][findFirstExceededElement] 이동시킬수 없다. ");
return!0});if(G.isPageExceeded){if(R=G.element)POLARIS.log.plugin("[relayoutPages] 다음페이지에서 현재 페이지로 이동가능한 element가 존재한다. endElementExceededOnNextPage["+R.getName()+"]"),POLARIS.log.plugin("[relayoutPages] 다음페이지에서 현재 페이지로 이동가능한 element가 존재한다. "),K=!0}else POLARIS.log.plugin("[relayoutPages] 다음페이지에서 현재 페이지로 이동가능한 element가 존재하지 않는다. ");!K&&ja&&(K=!0,R=W)}if(K){POLARIS.log.plugin("[relayoutPages] 다음페이지에서 현재페이지로 이동이 가능하다. ");y=W;O=R;y&&O&&(l(D,y,O),"true"==v.owner.getAttribute(r.pageBreak)&&(la&&la.owner.setAttribute(r.pageBreak,
!0),z.setAttribute(r.pageBreak,!0)));Na(D);fb(D);q=S(n);if(q.count()>t+1){POLARIS.log.plugin("[relayoutPages] 현재 갱신중인 페이지가 마지막 페이지가 아니다. 다음페이지 갱신을 요청한다. 현재 페이지 인덱스["+t+"]");ua=t+1;n.setAttribute("workingPageIndex",ua);Ka(a,b,c,d,q,t,ua,k);return}d&&a.getSelection().selectRanges([d]);La(a,b,n,d)}else POLARIS.log.plugin("[relayoutPages] 다음페이지에서 현재페이지로 이동이 불가능하다. "),fb(D);0==ka&&0==K&&(POLARIS.log.plugin("[relayoutPages] 다음페이지에서 페이지를 넘어가는 내용이 존재하지 않고 이동도 불가능하다. "),ua=za?t:t+1,q=S(n),q.count()>ua?(POLARIS.log.plugin("[relayoutPages] 현재 갱신중인 페이지가 마지막 페이지가 아니다. 다음페이지 갱신을 요청한다. 현재 페이지 인덱스["+
t+"]"),n.setAttribute("workingPageIndex",ua),Ka(a,b,c,d,q,t,ua,k)):La(a,b,n,d))}else if(POLARIS.log.plugin("[relayoutPages] 페이지에 아무런 내용이(element) 존재하지 않는다."),1<q.count()&&(za=!0,z.remove(),POLARIS.log.plugin("[relayoutPages] 페이지를 삭제한다. 전체 페이지 숫자["+q.count()+"]")),q=S(n),POLARIS.log.plugin("[relayoutPages] 페이지를 갱신한다. 전체 페이지 숫자["+q.count()+"]"),q.count()>t){POLARIS.log.plugin("[relayoutPages] 현재 갱신중인 페이지가 마지막 페이지가 아니다. 다음페이지 갱신을 요청한다. 현재 페이지 인덱스["+t+"]");var ua=t;n.setAttribute("workingPageIndex",ua);
Ka(a,b,c,d,q,t,ua,k)}else La(a,b,n)}catch(Ha){POLARIS.log.plugin(Ha),POLARIS.log.plugin("[relayoutPages] 페이지 갱신 작업중에 에러가 발생했다. "),q=S(n),q.count()>t+1?(POLARIS.log.plugin("[relayoutPages] 현재 갱신중인 페이지가 마지막 페이지가 아니다. 다음페이지 갱신을 요청한다. 현재 페이지 인덱스["+t+"]"),ua=t+1,n.setAttribute("workingPageIndex",ua),Ka(a,b,c,d,q,t,ua,k)):La(a,b,n,d)}},Ka=function(a,b,c,d,e,f,g,h,k){var l=!1;if(h<f||k)l=!0;POLARIS.log.plugin("[relayoutNextPage] workingPageIndex["+f+"], nextPageIndex["+g+"], startPageIndex["+h+"]");if(l||
POLARIS.env.chrome)for(a=POLARIS.tools.setTimeout(Ua,0,a,[a,b,c,d,e,g,h]),POLARIS.log.plugin("[relayoutNextPage][비동기호출] 현재 작업중인 페이지 인덱스["+f+"], 다음 페이지 인덱스["+g+"], requestId["+b+"]], asyncReqId["+a+"]"),f=0;f<ma.length;f++)ma[f].requestId==b&&(ma[f].asyncReqId=a,POLARIS.log.plugin("[relayoutNextPage][비동기호출] 현재 작업중인 요청에 asyncReqId설정"));else POLARIS.log.plugin("[relayoutNextPage][동기호출] 현재 작업중인 페이지 인덱스["+f+"], 다음 페이지 인덱스["+g+"]"),Ua(a,b,c,d,e,g,h)},kb=function(a,b,c,d){d=a.find("[doc-data-role\x3dremovable]");
var e=d.count();for(c=0;c<e;c++){var f=d.getItem(c);f.remove()}d=a.find("table");e=d.count();for(c=0;c<e;c++)d.getItem(c).removeClass("polaris_table_border");d=a.find("td");e=d.count();for(c=0;c<e;c++)d.getItem(c).removeClass("polaris_table_border");if(!0===b)for(d=a.find(w.removablePubdocbody),e=d.count(),c=0;c<e;c++)f=d.getItem(c),f.remove();d=a.find('[doc-data-role\x3d"polaris-page-header"]');e=d.count();for(c=0;c<e;c++)f=d.getItem(c),f.removeAttribute("ondblclick");d=a.find('[doc-data-role\x3d"polaris-page-footer"]');
d.count();for(c=0;c<d.count();c++)f=d.getItem(c),f.removeAttribute("ondblclick");d=a.find('[doc-data-role\x3d"footnote"]');e=d.count();for(c=0;c<e;c++)f=d.getItem(c),f.removeAttribute("contentEditable"),f.removeAttribute("title"),f.removeAttribute("onclick"),f.removeAttribute("id"),f.removeStyle("cursor"),f.removeStyle("display");d=a.find('[doc-data-role\x3d"endnote"]');e=d.count();for(c=0;c<e;c++)f=d.getItem(c),f.removeAttribute("contentEditable"),f.removeAttribute("title"),f.removeAttribute("onclick"),
f.removeAttribute("id"),f.removeStyle("cursor"),f.removeStyle("display");b=a.find("img");d=b.count();for(c=0;c<d;c++)e=b.getItem(c),e.hasClass("polaris_img_border")&&(e.removeClass("polaris_img_border"),e.setAttribute("src",e.getAttribute("data-polaris-saved-src")));b=a.find("a[title]");d=b.count();for(c=0;c<d;c++)b.getItem(c).removeAttribute("title");b=a.find("[unselectable]");d=b.count();for(c=0;c<d;c++)b.getItem(c).removeAttribute("unselectable");a=a.find("[doc-data-role\x3dfield-editable-div]");
c=a.count();b=null;for(d=0;d<c;d++)b=a.getItem(d),b.remove(!0)},Aa=function(a,b){var c=a?"\x3co:p\x3e\x26nbsp;\x3c/o:p\x3e":"\x26nbsp;";return b?POLARIS.dom.element.createFromHtml(c):c},Fb=function(a,b){var c=a.document;fc(a);a.fire("hideHeaderFooterTool");var d;d="\x3c!DOCTYPE html\x3e\x3chtml\x3e\x3chead\x3e";d+=function(a,b){if(b&&b.pagination){var c="",d=pa(a),e='\x3cstyle id\x3d"'+r.style+'"\x3e',e=e+d+"\x3c/style\x3e";return c+=e}return""}(a,b);d+="\x3c/head\x3e";d+='\x3cbody style\x3d"';var e=
c.getBody().getStyle("font-family");e&&(d+="font-family:"+e+";");(e=c.getBody().getStyle("font-size"))&&(d+="font-size:"+e+";");(e=c.getBody().getStyle("line-height"))&&(d+="line-height:"+e+";");d+='"\x3e';d+=function(a,b){function d(a,b,c){var e=a.find("p, td, li"),f=e.count(),g,h;for(g=0;g<f;g++){h=e.getItem(g);if(!h||h.type!=POLARIS.NODE_ELEMENT)return;POLARIS.plugins.inputmethod.cleanZWSPInElement(h,{isRemoveEmptyNode:!0,isRecursion:!0,isRemainFirstTextNode:!0});h.isExistText(!0)&&h.is(POLARIS.dtd.$block)&&
!h.getBogus()&&h.appendBogus()}a=a.getOuterHtml();a=a.replace("\b","");b&&(a=a.replace(/>\u200b{1,7}</g,"\x3e"+Aa(c)+"\x3c"),a=a.replace(/\u200B/g,""));return POLARIS.dom.element.createFromHtml(a)}var e=c.createElement("div"),f=P(c),g=S(f,!0),h=b&&b.isDocConvert,k=b&&b.convertZWSPToNBSP,l=b&&b.convertBRToNBSP;if(b&&b.pagination){E?e=f.clone(!0,!0):(Xa(a),e=f.clone(!0,!0),Xa(a));a.execCommand("removeRuler",e);for(var n=e.find(w.pageCorner),g=n.count(),f=0;f<g;f++)n.getItem(f).remove();n=e.find('[doc-data-role\x3d"polaris-page-grid"]');
g=n.count();for(f=0;f<g;f++)n.getItem(f).remove();e=d(e,k,h);kb(e,!1,l,h);POLARIS.tools.removeScaleFromElement(e);Sa(a,e,!1,!0);gb(a,e);ib(a,e);return e.getOuterHtml()}for(var q=!1,t=g.count(),f=0;f<t;f++){var n=g.getItem(f),u=n.body;if("true"==n.owner.getAttribute(r.pageBreak))if(0==q)q=!0;else{var n=new POLARIS.dom.element.createFromHtml('\x3cbr style\x3d"page-break-before:always"\x3e'),D=e.getLast(ca);D.hasAttribute("doc-data-field")?D.append(n):e.append(n)}else q=!1;e.appendHtml(u.getHtml())}f=
e.find("["+p.role+"\x3d"+r.pageBreak+"]");g=f.count();for(q=0;q<g;q++)t=f.getItem(q),t.removeAttribute(p.role),n=new POLARIS.dom.element.createFromHtml('\x3cbr style\x3d"page-break-before:always"\x3e'),t.insertBeforeMe(n);e=d(e,k,h);kb(e,!1,l,h);Sa(a,e,!1,!0);Na(e,!0);Xb(e);l&&m(e,h);Qb(e);gb(a,e);ib(a,e);$b(a,e);b&&b.dontMergeClickHere||ac(a,e,h);return e.getHtml()}(a,b);d+=function(a){if(!b||!b.pageInfo)return"";var d=c.createElement("page");d.setAttribute("size",u.size);d.setAttribute("width",
u.width);d.setAttribute("height",u.height);d.setAttribute("orientation",u.orientation);d.setAttribute("margin-left",u.marginLeft);d.setAttribute("margin-top",u.marginTop);d.setAttribute("margin-right",u.marginRight);d.setAttribute("margin-bottom",u.marginBottom);d.setAttribute("border-left",u.borderLeft);d.setAttribute("border-left-margin",u.borderLeftMargin);d.setAttribute("border-top",u.borderTop);d.setAttribute("border-top-margin",u.borderTopMargin);d.setAttribute("border-right",u.borderRight);
d.setAttribute("border-right-margin",u.borderRightMargin);d.setAttribute("border-bottom",u.borderBottom);d.setAttribute("border-bottom-margin",u.borderBottomMargin);d.setAttribute("background-color",u.backgroundColor);if(u.backgroundImage){var e=u.backgroundImage.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(a,b,c){return c});d.setAttribute("background-image",e)}d.setAttribute("background-repeat",u.backgroundRepeat);d.setAttribute("footnote-seperator",u.getFootnoteSeperator());d.setAttribute("footnote-seperator-align",
u.footnoteSeperator.align);d.setAttribute("footnote-seperator-width",u.footnoteSeperator.width);d.setAttribute("endnote-seperator",u.getEndnoteSeperator());d.setAttribute("endnote-seperator-align",u.endnoteSeperator.align);d.setAttribute("endnote-seperator-width",u.endnoteSeperator.width);d.setAttribute("start-page-numbers",u.startPageNumbers.toString());for(var f=u.pageHeader.createInfoElements(a),g=f.length,e=0;e<g;e++)d.append(f[e]);a=u.pageFooter.createInfoElements(a);f=a.length;for(e=0;e<f;e++)d.append(a[e]);
f=c.createElement("footnotes");e=0;for(a=B.length;e<a;e++)if(g=B[e],g=POLARIS.dom.element.createFromHtml(g,c)){var h=g.findOne(t(p.role,"footnote-item-number")),k=parseInt(h.getText());h.remove();f.appendHtml('\x3cfootnote number\x3d"'+k+'"\x3e'+g.getHtml()+"\x3c/footnote\x3e");g.remove()}d.append(f);f=c.createElement("endnotes");a=G.length;for(e=0;e<a;e++)if(g=G[e],g=POLARIS.dom.element.createFromHtml(g,c))h=g.findOne(t(p.role,"endnote-item-number")),k=parseInt(h.getText()),h.remove(),f.appendHtml('\x3cendnote number\x3d"'+
k+'"\x3e'+g.getHtml()+"\x3c/endnote\x3e"),g.remove();d.append(f);return d.getOuterHtml()}(a,b);d+="\x3c/body\x3e";d+="\x3c/html\x3e";b.returnValue=d},gc=function(a,b){var c=a.document,d=P(c),e=new POLARIS.dom.element("div");e.setHtml(d.getHtml());d=S(e);c.getSelection().getRanges();c=new POLARIS.dom.element("div");if(!0===b.isStandardForm){for(var d=e.find('[doc-data-field\x3d"본문"]'),f=d.count(),e=0;e<f;e++){var g=d.getItem(e);c.append(g)}Na(c)}else for(f=d.count(),e=0;e<f;e++)g=d.getItem(e).body,
c.append(g);d=c.find("p");f=d.count();for(e=0;e<f;e++)d.getItem(e).trim();b.returnValue=POLARIS.tools.getPlainText(c)},hc=function(a,b){for(var c=a.document,d=b.spara,e=b.spos,f=b.epara,g=b.epos,h=P(c),h=S(h),k=[],l=h.count(),m=0;m<l;m++){var n=h.getItem(m).body,p=a,q=n,r=d,n=e,t=f,u=g,D=p.document,z=new POLARIS.dom.range(q);z.selectNodeContents(q);z=z.createIterator();z.enforceRealBlocks=!0;p.activeEnterMode&&(z.enlargeBr=p.activeEnterMode!=POLARIS.ENTER_BR);for(var p=void 0,v=0,w=null,q=null;p=
z.getNextParagraph();){r==v+1&&(w=p);if(t==v+1){q=p;break}q=p;v++}0>n&&(n=0);0>u&&(u=0);r=new POLARIS.dom.range(D);w&&(t=w.getFirst(),D=0,D=t.type==POLARIS.NODE_TEXT?t.getLength():t.getChildCount(),n>D&&(n=D),r.setStart(t,n));p?(t=q.getFirst(),D=t.type==POLARIS.NODE_TEXT?t.getLength():t.getChildCount(),u>D&&(u=D),r.setEnd(t,u)):r.setEndAt(q,POLARIS.POSITION_BEFORE_END);k.push(r)}c.getSelection().selectRanges(k);a.focus()},ob=function(a){a=a.editor?a.editor:a;var b=a.document,c=P(b),d=S(c),c=[],e=
new POLARIS.dom.range(b),d=d.getItem(V(a)-1),f,g=d.body.findOne("article");if(g)f=g.getFirst();else for(g=0;g<d.body.$.childElementCount&&(!(f=f?f.getNext():d.body.getFirst())||f.type!=POLARIS.NODE_ELEMENT||f.getAttribute("doc-data-role")||"on"==f.getAttribute("unselectable"));g++);var h;if(g=d.body.findOne("article"))h=g.getLast();else for(g=d.body.$.childElementCount;0<=g&&(!(h=h?h.getPrevious():d.body.getLast())||h.type!=POLARIS.NODE_ELEMENT||h.getAttribute("doc-data-role")||"on"==h.getAttribute("unselectable"));g--);
e.setStartAt(f,POLARIS.POSITION_AFTER_START);e.setEndAt(h,POLARIS.POSITION_BEFORE_END);c.push(e);b.getSelection().selectRanges(c);a.focus()},ic=function(a){new POLARIS.dom.element("div");var b=a.editor,c=a.data.dataValue,d=a.data.fromMSOffice,e=c.indexOf("\x3c!--StartFragment--\x3e"),f=c.indexOf("\x3c!--EndFragment--\x3e");0<e&&0<f&&e<f&&!d&&(c=c.substring(e+20,f));d=new POLARIS.dom.element("div");d.setHtml(c);var e=P(d),f=S(d),g=f.count();if(null!=e&&0!=g){for(c=0;c<g;c++){var h=f.getItem(c);h.body&&
h.body.moveChildren(e.getParent(),!1)}e.remove()}e=d.find("div");f=e.count();for(c=0;c<f;c++)g=e.getItem(c),"polaris-textbox"!=g.getAttribute("doc-data-role")&&g.remove(!0);f=d.find("ol, ul, dl");g=f.count();for(c=0;c<g;c++)e=f.getItem(c),e.removeStyle("width");f=d.find("span");g=f.count();for(c=0;c<g;c++)e=f.getItem(c),e.findOne("img")&&e.getStyle("position")&&e.removeStyle("margin-top");e=d.find(POLARIS.env.webkit?"p, span":"p");f=e.count();for(c=0;c<f;c++)g=e.getItem(c),h=g.getStyle("background-color").toLowerCase(),
"rgb(255, 255, 255)"!=h&&"white"!=h&&"#ffffff"!=h||g.removeStyle("background-color"),POLARIS.env.webkit&&"span"==g.getName()&&g.removeStyle("line-height");if(POLARIS.env.webkit)for(e=d.find("img"),f=e.count(),c=0;c<f;c++){var g=e.getItem(c),k=g.getStyle("width"),h=g.getStyle("height"),l=g.getStyle("margin");g.setAttribute("style","");k&&g.setStyle("width",k);h&&g.setStyle("height",h);l&&g.setStyle("margin",l)}e=d.find("p");f=e.count();for(c=0;c<f;c++)g=e.getItem(c),(h=g.getStyle("text-indent"))&&
0<h.length&&"-"==h.charAt(0)&&g.setStyle("margin-left",h.substring(1,h.length));e=d.find("td \x3e p");f=e.count();for(c=0;c<f;c++)g=e.getItem(c),h=g.getStyle("text-indent"),null!=h&&0!=h.length||g.removeStyle("margin-left"),g.removeStyle("margin-right");for(c=d.getFirst();c;)c.type==POLARIS.NODE_TEXT?(e=new POLARIS.dom.element("span"),e.insertAfter(c),e.append(c.remove()),c=e,(e=c.getNext())&&e.type==POLARIS.NODE_ELEMENT&&e.is("br")&&e.remove()):c.type==POLARIS.NODE_ELEMENT&&c.is("br")&&(e=new POLARIS.dom.element("p"),
e.insertAfter(c),e.appendHtml("\x26nbsp;"),e.append(c.remove()),c=e),c=c.getNext();e=d.find('[doc-data-field\x3d"본문"]');f=e.count();for(c=0;c<f;c++)g=e.getItem(c),g.removeAttribute("doc-data-field"),g.removeAttribute("doc-data-field-editable");f=d.find("b,strong,u,i,s,strike");g=f.count();for(c=0;c<g;c++)e=f.getItem(c),e.is({b:1,strong:1})?e.setStyle("font-weight","bold"):e.is({u:1})?e.setStyle("text-decoration","underline"):e.is({i:1})?e.setStyle("font-style","italic"):e.is({s:1,strike:1})&&e.setStyle("text-decoration",
"line-through");f=d.find(w.split);g=f.count();for(c=0;c<g;c++)e=f.getItem(c),e.removeAttribute(p.split);e=d.find('[doc-data-role\x3d"footnote"], [doc-data-role\x3d"endnote"]');f=e.count();for(c=0;c<f;c++)e.getItem(c).remove();e=null;(c=b.getSelection().getStartElement())&&(c=c.getAscendant({div:1,p:1,ol:1,ul:1,dl:1,li:1,article:1,th:1,td:1},!0));c&&(e=c.getClientRect().width);f=d.find("table");g=f.count();for(c=0;c<g;c++)h=f.getItem(c),l=parseFloat(h.getAttribute("width")),isNaN(k)&&(l=POLARIS.tools.convertToPx(h.getStyle("width"))),
!isNaN(l)&&e<l&&(h.removeAttribute("width"),h.setStyle("width",POLARIS.tools.cssLength(e)));k=d.find("colgroup");for(c=0;c<k.count();c++)k.getItem(c).remove();c=d.find(w.pagedTable);e=c.count();f=null;for(k=k=0;k<e;k+=1)f=c.getItem(k),f.removeAttribute(p.role),f.removeAttribute(p.value);c=d.find(w.spannedTd);e=c.count();f=null;for(k=0;k<e;k+=1)f=c.getItem(k),f.removeAttribute(p.role),f.removeAttribute(p.value);Wb(b,d);c=d.getHtml();c=c.replace(/\x3c!--StartFragment--\x3e/g,"");c=c.replace(/\x3c!--EndFragment--\x3e/g,
"");c=c.replace(/<strong/g,"\x3cspan");c=c.replace(/<\/strong>/g,"\x3c/span\x3e");c=c.replace(/<b /g,"\x3cspan ");c=c.replace(/<\/b>/g,"\x3c/span\x3e");c=c.replace(/<u /g,"\x3cspan ");c=c.replace(/<\/u>/g,"\x3c/span\x3e");c=c.replace(/<s /g,"\x3cspan ");c=c.replace(/<\/s>/g,"\x3c/span\x3e");c=c.replace(/<strike/g,"\x3cspan ");c=c.replace(/<\/strike>/g,"\x3c/span\x3e");c=c.replace(/<i /g,"\x3cspan ");c=c.replace(/<\/i>/g,"\x3c/span\x3e");c=c.replace(/doc-data-role="footnote-item-number"/g,"");c=c.replace(/doc-data-role="endnote-item-number"/g,
"");a.data.dataValue=c},Wb=function(a,b){if(a.config.useDocConvertServer&&a.config.docConvertingUrl){var c=a.config.documentFontFamily,d=a.config.font_names,e=b.find("[style]"),f=[],g={};a.config.font_replacement&&(g=a.config.font_replacement);if(null==c||void 0==c||0==c.length)c="돋움체";if(null==d||void 0==d)d="";for(var d=(d+"symbol/symbol;Wingdings/Wingdings;").toLowerCase(),h=0,k=e.count();h<k;h++){var l=e.getItem(h),m=l.getStyle("font-family");if(0<m.length)if(m=m.toLowerCase().replace(/"/g,"").split(",")[0],
g[m]){var n=l.getAscendant("td",!0);n&&(n.hasAttribute(p.field)||n.hasAttribute("doc-data-protected"))||(f.push(m),l.setStyle("font-family",g[m]))}else 0>d.indexOf(m)&&(f.push(m),l.setStyle("font-family",c))}if(0<f.length&&a.config.showFontChangeNoti){f=POLARIS.tools.removeArrayDuplicate(f);d="\x3ctable\x3e\x3cthead\x3e\x3ctr\x3e";d+="\x3cth colspan\x3d3\x3e"+a.lang.message.font_replacement+"\x3cbr\x3e\x3cbr\x3e\x3c/th\x3e";d+="\x3c/tr\x3e";d+="\x3ctr\x3e";d+="\x3cth\x3e"+a.lang.message.font_before+
"\x3c/th\x3e\x3cth\x3e\x3c/th\x3e\x3cth\x3e"+a.lang.message.font_after+"\x3c/th\x3e";d+="\x3c/tr\x3e";d+="\x3c/thead\x3e";d+="\x3ctbody\x3e";k=f.length;for(h=0;h<k;h++)d+="\x3ctr\x3e",d+='\x3ctd width\x3d"40%"\x3e'+f[h]+'\x3c/td\x3e\x3ctd width\x3d"10%"\x3e\x3d\x3d\x3e\x3c/td\x3e\x3ctd width\x3d"40%"\x3e'+(g[f[h]]?g[f[h]]:c)+"\x3c/td\x3e",d+="\x3c/tr\x3e";d+="\x3c/tbody\x3e";d+="\x3c/table\x3e";(new POLARIS.plugins.notification(a,{message:d,type:"info",duration:3E3,width:300,valign:"top",align:"center"})).show()}}},
jc=function(a){Rb(a.editor.document)},pb=function(a){return 0==a.getChildCount()?!0:1==a.getChildCount()?0==a.getText().length:!1},qb=function(a,b){for(var c=a.find(b),d=0,e=c.count();d<e;d++){var f=c.getItem(d);0==f.getText().length&&0==f.getChildCount()&&f.remove()}},kc=function(a){var b=a.editor?a.editor:this,c=b.document,d=a.data.getKey(),e=!1,g=b.getSelection().getRanges(),h=g[0],l=h&&h.startContainer,m=!1,m=!1,t=null,m="",u=null,m=m=null,D=0,z=0,v=null;if(1!=g.length||!h.collapsed||8!=d&&46!=
d)return!1;if(8==d&&n(b)||46==d&&q(b))return a.data.preventDefault(),a.cancel(),!0;if(t=h&&h.startContainer.getAscendant("p",!0))if(8===d){if(m=h&&h.checkStartOfBlock()){if((u=t.getPrevious(ca))&&u.is("p"))for(m=u.find("span["+p.bookmark+'\x3d"1"]'),D=m.count(),z=0;z<D;z+=1)(v=m.getItem(z))&&v.remove();u&&u.is("p")&&t.hasAttribute(p.split)&&(m=t.getAttribute(p.split),POLARIS.tools.isEmptyValue(m)||u.setAttribute(p.split,m))}}else 46===d&&(m=h&&h.checkEndOfBlock())&&(m=t.getNext(ca))&&m.is("p")&&m.hasAttribute(p.split)&&
(m=m.getAttribute(p.split),POLARIS.tools.isEmptyValue(m)||t.setAttribute(p.split,m));switch(d){case 8:u=null;l.type==POLARIS.NODE_TEXT&&(l=l.getParent());if(""==l.getText().trim()&&l.getParent()&&"endnote-item1"==l.getParent().getId())return a.data.preventDefault(),a.cancel(),!0;if(m=l.getAscendant("table"))if(m=m.find("td"),1==m.count()){h=c.getSelection().getRanges()[0];e=new POLARIS.dom.range(c);e.selectNodeContents(m.getItem(0));e.setEnd(h.startContainer,h.startOffset);for(e=new POLARIS.dom.walker(e);b=
e.previous();)if(l=b.getText().trim().replace(/\u200b/g,""),b.type!=POLARIS.NODE_TEXT||0!=l.length)return!1;a.data.preventDefault();a.cancel();return!0}u=l.getPrevious(ca);null==u&&(u=l.getParent().getPrevious(ca));m=!1;h.checkStartOfBlock()&&u&&u.is("table")&&u.getAttribute(p.role)==r.removablePubdocbody&&(m=!0);if(m)return a.data.preventDefault(!0),a.cancel(),!0}t=V(b);u=Z(c);D=N(c,t);g=1<t?N(c,t-1):null;c=u>t?N(c,t+1):null;if((v=l.getAscendant(ja))&&1<u){z=b.getSelection();m=z.createBookmarks();
g&&g.body&&qb(g.body,"span");c&&c.body&&qb(c.body,"span");qb(v,"span");z.selectBookmarks(m);switch(d){case 8:if(1==t)break;if(pb(v))h.checkBoundaryOfElement(v,POLARIS.START)&&g&&(e=h.moveToElementEditablePosition(g.body,!0)),e&&(g&&h.moveToElementEditStart(g.body),b.fire("saveSnapshot"),v.setHtml(""),v.setAttribute("contentEditable",!1));else if(h.checkBoundaryOfElement(v,POLARIS.START)&&g)if(b.fire("saveSnapshot"),"true"==g.owner.getAttribute(r.pageBreak))D.owner.removeAttribute(r.pageBreak),g.owner.removeAttribute(r.pageBreak),
t=g.owner.getAttribute(r.page),e=!0,e=h.moveToLeafElementEditablePosition(g.body,!0);else if(d=l.getAscendant("p",!0),b=l&&l.getAscendant(M,!0),l=d?d:b){c=l.getAttribute(p.split);c=g.body.find("["+p.split+'\x3d"'+c+'"]');if(0<c.count()){if(d=c.getItem(c.count()-1),l.trim(),POLARIS.log.plugin("[onBackspaceOrDelete] 커서위치를 기억한다."),c=k(d),l.moveChildren(d),l.remove(),d.is({p:1,span:1})&&d.mergeTextNodes(),c)return POLARIS.log.plugin("[onBackspaceOrDelete] 기억했던 커서위치로 이동한다."),f(h,c),h.select(),!1}else if(e=
h.moveToLeafElementEditablePosition(g.body,!0,"table")){m=h.clone();l=Array.prototype.slice.call(d.$.childNodes);c=l.length;for(g=c-1;0<=g;g--)t=new POLARIS.dom.element(l[g]),g!=c-1&&t.is("br")?h.insertNode(t):(u=t.getText().replace(/\u200B/g,""),t&&0<u.length&&(t.trim(),h.insertNode(t)));d.remove();h.moveToRange(m);POLARIS.tools.setTimeout(function(){h.select()},0)}b&&0==b.getChildCount()&&b.remove()}break;case 46:if(u==t-1)break;POLARIS.dom.selection._removeFillingCharSequenceNode(b.editable());
if(pb(v))h.checkBoundaryOfElement(v,POLARIS.END)&&c&&(e=h.moveToElementEditablePosition(c.body,!1)),e&&(c&&h.moveToElementEditStart(c.body),b.fire("saveSnapshot"),v.setHtml(""),v.setAttribute("contentEditable",!1));else if(h.checkBoundaryOfElement(v,POLARIS.END)&&c&&c.body)if(b.fire("saveSnapshot"),"true"==c.owner.getAttribute(r.pageBreak))D.owner.removeAttribute(r.pageBreak),c.owner.removeAttribute(r.pageBreak),e=!0;else if(m=h.clone(),e=m.moveToLeafElementEditablePosition(c.body)){d=m.startContainer.getAscendant("p",
!0);if(null==d||0==d.isEditable()){e=!1;break}l=l.getAscendant("p",!0);l.hasAttribute(p.split)&&d.hasAttribute(p.split)&&l.getAttribute(p.split)==d.getAttribute(p.split)?(h.moveToRange(m),h.startContainer.type==POLARIS.NODE_ELEMENT&&0<h.startContainer.getChildCount()&&(h.selectNodeContents(h.startContainer.getFirst()),h.collapse(!0)),h.select(),e=!1):(z=b.getSelection(),m=z.createBookmarks(),d.renameNode("span"),d.trim(),d.removeStyle("line-height"),d.removeStyle("margin"),d.removeStyle("padding"),
h.insertNode(d),h.collapse(!0),d.mergeTextNodes(),z.selectBookmarks(m))}e&&(b=c.body.findOne("article"))&&0==b.getChildCount()&&b.remove()}if(e)return h.select(),a.data.preventDefault(),a.cancel(),!0}return!1},lc=function(a){function b(a,c,d){a.select();a.scrollIntoView();!0===d&&(c.data.preventDefault(),c.cancel());return!0}var c=a.editor?a.editor:this,d=c.document,e=a.data.$.ctrlKey||a.data.$.metaKey,f=a.data.$.altKey,g=a.data.$.shiftKey,h=a.data.getKey(),k=c.getSelection().getRanges(),l=k[0];handled=
!1;if(1>k.length)return handled;switch(h){case 33:case 34:if(g)break;f=new POLARIS.dom.element.createFromHtml("\x3cspan\x3e\x26#8203;\x3c/span\x3e");l.insertNode(f);c=c.ui.space("contents");g=parseInt(c.$.clientHeight,0);c=f.getClientRect().left;e=0;f.remove();f=d.getWindow();f.getScrollPosition();k=g;33==h&&(k=-g);h=Math.abs(k/15);e+=h;f.$.scrollBy(0,k+h);if((pointedElement=function(a,b,c){return(a=a.$.elementFromPoint(b,c))&&a.nodeType?new POLARIS.dom.element(a):null}(d,c,e))&&(h=pointedElement.getAscendant(K,
!0))&&h.type==POLARIS.NODE_ELEMENT&&h.getAttribute(p.role)==r.page)return c=h.getAttribute(r.page),e=N(d,c),d=!1,null==pointedElement.getAscendant(ja,!0)&&(pointedElement=e.body,h=e.owner.getClientRect(),Math.abs(h.top)>Math.abs(h.bottom)&&(d=!0)),l.moveToLeafElementEditablePosition(pointedElement,d,"table"),l.select(),a.data.preventDefault(),a.cancel(),!0;break;case 35:case 36:e&&(35==h?(h=Z(d),d=N(d,h),l.moveToLeafElementEditablePosition(d.body,!0,"table")):(d=N(d,1),l.moveToLeafElementEditablePosition(d.body,
!1,"table")),handled=b(l,a));break;case 37:case 39:case 38:case 40:if(e||f||g)break;c=V(c);e=N(d,c);if(37==h)1<c&&(h=l.checkBoundaryOfElement(e.body,POLARIS.START)?!0:!1)&&(d=N(d,c-1))&&(l.moveToLeafElementEditablePosition(d.body,!0,"table"),handled=b(l,a,!0));else if(39==h){if(h=l.checkBoundaryOfElement(e.body,POLARIS.END)?!0:!1)if(d=N(d,c+1))l.moveToLeafElementEditablePosition(d.body,!1,"table"),handled=b(l,a,!0)}else 38==h?1<c&&(h=l.checkBoundaryOfElement(e.body,POLARIS.START)?!0:!1)&&(d=N(d,c-
1))&&(l.moveToLeafElementEditablePosition(d.body,!0,"table"),handled=b(l,a,!0)):40==h&&(h=l.checkBoundaryOfElement(e.body,POLARIS.END)?!0:!1)&&(d=N(d,c+1))&&(l.moveToLeafElementEditablePosition(d.body,!1,"table"),handled=b(l,a,!0))}return handled},mc=function(a){void 0==a.editor&&(a.editor=this);kc(a)||lc(a)},nc=[POLARIS.KEYCODE.ENTER,POLARIS.KEYCODE.SHIFT,POLARIS.KEYCODE.CTRL,POLARIS.KEYCODE.ALT,POLARIS.KEYCODE.PAUSEBREAK,POLARIS.KEYCODE.CAPSLOOK,POLARIS.KEYCODE.HAN_ENG,POLARIS.KEYCODE.CHINESE_CHARACTER,
POLARIS.KEYCODE.ESC,POLARIS.KEYCODE.PAGEUP,POLARIS.KEYCODE.PAGEDOWN,POLARIS.KEYCODE.END,POLARIS.KEYCODE.HOME,POLARIS.KEYCODE.LEFT,POLARIS.KEYCODE.UP,POLARIS.KEYCODE.RIGHT,POLARIS.KEYCODE.DOWN,POLARIS.KEYCODE.INSERT,POLARIS.KEYCODE.L_WINDOW,POLARIS.KEYCODE.R_WINDOW,POLARIS.KEYCODE.F1,POLARIS.KEYCODE.F2,POLARIS.KEYCODE.F3,POLARIS.KEYCODE.F4,POLARIS.KEYCODE.F5,POLARIS.KEYCODE.F6,POLARIS.KEYCODE.F7,POLARIS.KEYCODE.F8,POLARIS.KEYCODE.F9,POLARIS.KEYCODE.F10,POLARIS.KEYCODE.F11,POLARIS.KEYCODE.F12,POLARIS.KEYCODE.NUMLOCK,
POLARIS.KEYCODE.SCROLLLOCK],oc=function(a){var b=a.data.getKey(),c=this.editor,d=c.editable().isComposing,e=c.getSelection(),e=(e=e&&e.getRanges()[0])&&e.checkEndOfBlock(),f=a.data.$.shiftKey,g=a.data.$.ctrlKey;a=a.data.$.altKey;POLARIS.log.plugin("[keyup] keystroke \x3d "+b+", isComposing \x3d "+d+", isEndOfBlock \x3d "+e);-1<nc.indexOf(b)||f||g||a||d||c.fire("contentChange",{type:"keyup["+b+"]",sync:!0})},pc=function(a){var b=a.editor,c=b.document;b.fire("lockSnapshot");O=a.data.editMode;if(0==
O){for(var d=c.find("[contenteditable]"),e=d.count(),f=0;f<e;f++){var g=d.getItem(f);g.removeAttribute("contenteditable");g.setAttribute("unselectable","on")}b.setReadOnly(!0);b.fire("unlockSnapshot")}else{b.setReadOnly(!1);var h=P(c);a.data.fastOpenMode&&h.hide();var k=b.checkDirty(),l=!1;if(1==O){l=!1;d=c.find("[contenteditable]");e=d.count();for(f=0;f<e;f++)g=d.getItem(f),"true"!=g.getAttribute("doc-data-protected")&&g.removeAttribute("contenteditable");d=c.find("[unselectable]");e=d.count();for(f=
0;f<e;f++)d.getItem(f).removeAttribute("unselectable")}else if(2==O)for(var l=!0,e=c.find("[doc-data-field]"),g=e.count(),k=b.checkDirty(),m=null,f=0;f<g;f++){var n=e.getItem(f);if("true"==n.getAttribute("doc-data-field-editable")){if(n.setAttribute("contentEditable",!0),n.is("td")){n.setAttribute("unselectable","on");var p=n.find("p"),q=p.count();if(1<n.getChildCount())for(d=0;d<q;d++){var r=p.getItem(d);0==r.getTextBrNodes().length&&r.remove()}p=n.find("p");q=p.count();for(d=0;d<q;d++)r=p.getItem(d),
r.is("p")&&(r.removeAttribute("contentEditable"),r.removeAttribute("unselectable"));if(n!=m){d=n.getAscendant("table");p=d.find("td");q=p.count();for(d=0;d<q;d++)r=p.getItem(d),r.setAttribute("unselectable","on");m=n}POLARIS.env.ie&&((d=n.findOne("[doc-data-role\x3dfield-editable-div]"))?d.setAttribute("contentEditable",!0):(d=c.createElement("div"),d.setAttribute("contentEditable",!0),d.setAttribute("doc-data-field-editable",!0),d.setAttribute("doc-data-role","field-editable-div"),n.moveChildren(d),
n.append(d)))}}else if(n.setAttribute("unselectable","on"),n.is("td")&&n!=m){d=n.getAscendant("table");p=d.find("td");q=p.count();for(d=0;d<q;d++)r=p.getItem(d),r.setAttribute("unselectable","on");m=n}}c=c.find("[doc-data-protected]");e=c.count();for(f=0;f<e;f++)if(d=c.getItem(f),"true"==d.getAttribute("doc-data-protected")&&("false"!=d.getAttribute("contentEditable")&&d.setAttribute("contentEditable",!1),d.is("td")&&POLARIS.env.ie))for(d.setAttribute("unselectable","on"),p=d.find("p"),q=p.count(),
d=0;d<q;d++)for(r=p.getItem(d),"false"!=r.getAttribute("contentEditable")&&r.setAttribute("contentEditable",!1),r.setAttribute("unselectable","on"),g=r.find("span"),g.count(),n=0;n<g.count();n++)r=g.getItem(n),"false"!=r.getAttribute("contentEditable")&&r.setAttribute("contentEditable",!1),r.setAttribute("unselectable","on");c=S(h,!0);d=c.count();for(f=0;f<d;f++)e=c.getItem(f).body,0==l&&e.setAttribute("contentEditable"),e.setAttribute("contentEditable",!l);a.data.fastOpenMode&&h.show();k||b.resetDirty();
b.fire("unlockSnapshot");0==a.data.fastOpenMode&&(a=b.editable().getHtml(),b.editable().setHtml(a))}Q(b,0)},qc=function(a){var b=a.data.dataValue;void 0!=b&&null!=b&&(a.data.dataValue=b.replace(/(<br[^>]+page-break-before[\s]*:[\s]*always[^>]*>(?:<\/br>)?)/g,'\x3cspan data-polaris-survive\x3d"true" style\x3d"page-break-before:always"\x3e\x3c/span\x3e'))},Xa=function(a){a.fire("lockSnapshot");if(E=!E){var b=a.getCommand("togglePageOutline");if(b){b.state=POLARIS.TRISTATE_ON;for(var c=0;c<b.uiItems.length;c++)b.uiItems[c].setState(POLARIS.TRISTATE_ON)}}else if(b=
a.getCommand("togglePageOutline"))for(b.state=POLARIS.TRISTATE_OFF,c=0;c<b.uiItems.length;c++)b.uiItems[c].setState(POLARIS.TRISTATE_OFF);ga(a);a.fire("pageResized");a.fire("unlockSnapshot")},rb=function(a){var b=a.document;P(b);V(a);a.fire("saveSnapshot");var c=b.getSelection().getStartElement();if(null!=c&&!c.getAscendant("table",!0)&&null!=c.getAscendant(ja)){var c=b.getSelection().getRanges()[0],d=c.endContainer,e=c.endOffset;D=b.createElement("span");D.setAttribute("data-polaris-bookmark-pagebreak",
"1");D.setHtml("\x26nbsp;");b=c.checkStartOfBlock();c.insertNode(D);b?c.moveToPosition(D,POLARIS.POSITION_BEFORE_START):(c.startContainer=d,c.startOffset=e);c.collapse(!0);b=null;(c=c.splitBlock(a.activeEnterMode==POLARIS.ENTER_DIV?"div":"p"))&&c.nextBlock&&(b=c.nextBlock);c&&!c.previousBlock&&b&&(d=b.clone(!0),d.findOne(w.bookmarkPageBreak).remove(),d.insertBefore(b),c.previousBlock=d);c&&c.previousBlock&&c.nextBlock&&(d=c.previousBlock.getUniqueId(),c.previousBlock.hasAttribute(p.split)&&(d=c.previousBlock.getAttribute(p.split)),
c.previousBlock.setAttribute(p.split,d),c.nextBlock.setAttribute(p.split,d));b&&(b&&b.setAttribute(p.role,r.pageBreak),workingPageIndex=V(a)-1,Q(a,workingPageIndex))}},sb=function(a,b){var c;if("footnote"==b)c=!0;else if("endnote"==b)c=!1;else return;var d=0,e=a.document,f=e.getSelection().getRanges()[0];if(void 0!=f&&null!=f){var g=new POLARIS.dom.range(e);g.selectNodeContents(e.getBody());g.setEnd(f.startContainer,f.startOffset);g=new POLARIS.dom.walker(g);g.evaluator=function(a){return a.type==
POLARIS.NODE_ELEMENT&&"span"==a.getName()&&a.getAttribute(p.role)==b?!0:!1};(g=g.previous())&&(d=parseInt(g.getText()));a.fire("saveSnapshot");e=e.createElement("span");e.setAttribute(p.role,b);e.setAttribute("id","#");f.insertNode(e);(f=e.getParent())&&f.appendBogus();f='\x3cdiv doc-data-role\x3d"'+b+'-item" \x3e\x3c/div\x3e';c?B.splice(d,0,f):G.splice(d,0,f);aa(a);ga(a);a.fire("showCommentTool",{command:b,newCommentNumber:d+1})}},fc=function(a){for(var b=a.document,c=b.getBody().find("div"),b=b.findOne(w.container),
b=POLARIS.tools.getScaleRatio(b),d=c.count(),e=0;e<d;e++){var f=c.getItem(e);if(POLARIS.plugins.div.isTextbox(f)&&""==f.getStyle("height")&&""!=f.getStyle("min-height")){var g=f.getClientRect().height,g=100*g/b,g=POLARIS.tools.convertPxToMm(g);f.setStyle("min-height",g+a.lang.common.unitMm)}}};POLARIS.plugins.add("pagination",{requires:"ajax",init:function(a){if(POLARIS.config.wordprocessor=a.config.wordprocessor){a.on("key",function(b){1==(b.data.domEvent.$.ctrlKey||b.data.domEvent.$.metaKey)&&13==
b.data.domEvent.$.keyCode&&rb(a)},this);a.on("scroll",function(b){L||(b=a.document,b=V(a)+" / "+Z(b)+" "+a.lang.pagination.pageLabel,(new POLARIS.plugins.notification(a,{message:b,type:"info",duration:2E3,width:140,valign:"bottom",align:"left"})).show(),L=!0,setTimeout(function(){L=!1},2E3))},this);var b=function(a,b){var c=POLARIS.TRISTATE_OFF;b.contains(function(a){if("footnote-item"==a.getAttribute(p.role)||"endnote-item"==a.getAttribute(p.role)||"polaris-page-header"==a.getAttribute(p.role)||
"polaris-page-footer"==a.getAttribute(p.role))return!0},1)&&(c=POLARIS.TRISTATE_DISABLED);this.setState(c)};a.ui.addButton&&a.ui.addButton("PageOutline",{label:a.lang.pagination.pageoutline,command:"pageoutline",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("PageOutlineBg",{label:a.lang.pagination.pageoutlinebg,command:"pageoutlinebg",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("PageNumber",{label:a.lang.pagination.pageNumber,command:"pagenumber",toolbar:"document,50"});a.ui.addButton&&
a.ui.addButton("PageBorderStyle",{label:a.lang.pagination.pageoutlinebg,command:"pageoutlinebg",toolbar:"document,50"});a.addCommand("pageoutlinebg",new POLARIS.dialogCommand("pageoutlinebg",{contextSensitive:1,refresh:b}));POLARIS.dialog.add("pageoutlinebg",this.path+"dialogs/pageborderstyle.js");a.addCommand("pagenumber",new POLARIS.dialogCommand("pagenumber",{contextSensitive:1,refresh:b}));POLARIS.dialog.add("pagenumber",this.path+"dialogs/pagenumber.js");a.ui.addButton&&a.ui.addButton("PageNumberHide",
{label:a.lang.pagination.pageNumberHide,command:"PageNumberHide",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("BreakPage",{label:a.lang.pagination.pageSplit,command:"breakPage",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("HeaderFooter",{label:a.lang.pagination.headerfooter,command:"headerfooter",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("TogglePageOutline",{label:a.lang.pagination.togglepageoutline,command:"togglePageOutline",toolbar:"document,50"});a.ui.addButton&&
a.ui.addButton("SendEmailBody",{label:a.lang.pagination.sendEmailBody,command:"sendEmailBody",toolbar:"document,50"});a.addCommand("generateHtml",{modes:{wysiwyg:1},readOnly:1,editorFocus:!1,exec:Fb});a.addCommand("generateText",{modes:{wysiwyg:1},readOnly:1,exec:gc});a.addCommand("pagination_selectText",{modes:{wysiwyg:1},readOnly:1,exec:hc});a.addCommand("pageoutline",new POLARIS.dialogCommand("pageoutline",{contextSensitive:1,refresh:b}));POLARIS.dialog.add("pageoutline",this.path+"dialogs/pageoutline.js");
a.addCommand("headerfooter",new POLARIS.dialogCommand("headerfooter",{contextSensitive:1,refresh:b}));POLARIS.dialog.add("headerfooter",this.path+"dialogs/headerfooter.js");a.addCommand("togglePageOutline",{modes:{wysiwyg:1},readOnly:1,exec:Xa,contextSensitive:1});a.getCommand("togglePageOutline").state=POLARIS.TRISTATE_ON;a.addCommand("breakPage",{modes:{wysiwyg:1},readOnly:1,exec:rb,contextSensitive:1,refresh:b});a.addCommand("selectall",{modes:{wysiwyg:1},readOnly:1,exec:ob});a.addCommand("zoomIn",
{modes:{wysiwyg:1},readOnly:1,canUndo:!1,exec:function(a,b){var c=P(a.document),d=b;isNaN(d)&&(d=5);var c=Math.round(parseFloat(POLARIS.tools.getScaleRatio(c))),e=c%d,c=0==e?c+d:c+(d-e);500<c&&(c=500);a.fire("zoom",{type:0,ratio:c,updateScrollbarVisibility:1})}});a.addCommand("zoomOut",{modes:{wysiwyg:1},readOnly:1,canUndo:!1,exec:function(a,b){var c=P(a.document),d=b;isNaN(d)&&(d=5);var c=Math.round(parseFloat(POLARIS.tools.getScaleRatio(c))),e=c%d,c=0==e?c-d:c-(d-e);10>c&&(c=10);a.fire("zoom",{type:0,
ratio:c,updateScrollbarVisibility:1})}});a.ui.addButton&&a.ui.addButton("FootNote",{label:a.lang.pagination.comment.footnote,command:"footnote",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("EndNote",{label:a.lang.pagination.comment.endnote,command:"endnote",toolbar:"document,50"});a.ui.addButton&&a.ui.addButton("FootEndNoteStyle",{label:a.lang.pagination.comment.footendnoteStyle,command:"footendnoteStyle",toolbar:"document,50"});a.addCommand("footendnoteStyle",new POLARIS.dialogCommand("footendnotestyle"));
POLARIS.dialog.add("footendnotestyle",this.path+"dialogs/footendnotestyle.js");a.ui.addButton&&a.ui.addButton("FootEndNoteSave",{label:a.lang.pagination.comment.footendnoteSave,command:"footendnoteSave",toolbar:"document,50"});var c=function(a,b){var c=a.document,d=c.find(t(p.role,"footnote")),c=c.find(t(p.role,"endnote"));0==d.count()&&0==c.count()?this.setState(POLARIS.TRISTATE_DISABLED):this.setState(POLARIS.TRISTATE_OFF)};a.addCommand("footendnoteSave",new POLARIS.dialogCommand("footendnotesave",
{startDisabled:!0,contextSensitive:1,refresh:c}));POLARIS.dialog.add("footendnotesave",this.path+"dialogs/footendnotesave.js");a.ui.addButton&&a.ui.addButton("FootEndNoteChange",{label:a.lang.pagination.comment.footendnoteChange,command:"footendnotechange",toolbar:"document,50"});a.addCommand("footendnotechange",new POLARIS.dialogCommand("footendnotechange",{startDisabled:!0,contextSensitive:1,refresh:c}));POLARIS.dialog.add("footendnotechange",this.path+"dialogs/footendnotechange.js");a.addCommand("allFootnoteToEndnote",
{exec:function(a){for(var b=a.document,c=b.find(t(p.role,"endnote")).count(),b=b.find(t(p.role,"footnote")),d=b.count(),e=0;e<d;e++){var f=b.getItem(e),g=POLARIS.dom.element.createFromHtml(B[parseInt(f.getText())-1]);if("footnote-item"==g.getAttribute(p.role)){var h=g.findOne(t(p.role,"footnote-item-number"));h.setAttribute(p.role,"endnote-item-number");h.setText(c+1+") ");g.setAttribute(p.role,"endnote-item")}G[c++]=g.getOuterHtml();f.setAttribute(p.role,"endnote");f.setHtml("\x3csup\x3e"+c+")\x3csup\x3e")}Q(a,
0)}});a.addCommand("allEndnoteToFootnote",{exec:function(a){for(var b=a.document,c=b.find(t(p.role,"footnote")).count(),b=b.find(t(p.role,"endnote")),d=b.count(),e=0;e<d;e++){var f=b.getItem(e),g=POLARIS.dom.element.createFromHtml(G[parseInt(f.getText())-1]);if("endnote-item"==g.getAttribute(p.role)){var h=g.findOne(t(p.role,"endnote-item-number"));h.setAttribute(p.role,"footnote-item-number");h.setText(c+1+") ");g.setAttribute(p.role,"footnote-item")}B[c++]=g.getOuterHtml();f.setAttribute(p.role,
"footnote");f.setHtml("\x3csup\x3e"+c+")\x3csup\x3e")}Q(a,0)}});a.addCommand("swapEndnoteForFootnote",{exec:function(a){var b=a.document,c=b.find(t(p.role,"footnote")),d=b.find(t(p.role,"endnote"));if(0!=c.count()&&0!=d.count()){for(var b=[],e=d.count(),f=0;f<e;f++){var g=d.getItem(f),h=parseInt(g.getText()),k=POLARIS.dom.element.createFromHtml(G[h-1]);if("endnote-item"==k.getAttribute(p.role)){var l=k.findOne(t(p.role,"endnote-item-number"));l.setAttribute(p.role,"footnote-item-number");k.setAttribute(p.role,
"footnote-item")}b[h-1]=k.getOuterHtml();g.setAttribute(p.role,"footnote");g.setHtml("\x3csup\x3e"+h+")\x3csup\x3e")}G=[];d=c.count();for(f=0;f<d;f++)e=c.getItem(f),h=parseInt(e.getText()),k=POLARIS.dom.element.createFromHtml(B[h-1]),"footnote-item"==k.getAttribute(p.role)&&(l=k.findOne(t(p.role,"footnote-item-number")),l.setAttribute(p.role,"endnote-item-number"),k.setAttribute(p.role,"endnote-item")),G[h-1]=k.getOuterHtml(),e.setAttribute(p.role,"endnote"),e.setHtml("\x3csup\x3e"+h+")\x3csup\x3e");
B=b;Q(a,0)}}});a.addCommand("saveFootendnoteAsODT",{exec:function(a,b){var c=POLARIS.tools.getRandomFileName(36),d="\x3c!DOCTYPE html\x3e\x3chtml\x3e\x3chead\x3e\x3c/head\x3e\x3cbody\x3e";if(b.option&1)for(var e=0,f=B.length;e<f;e++)var g=B[e],d=d+g;if(b.option&2)for(f=G.length,e=0;e<f;e++)g=G[e],d+=g;a.execCommand("requestSaveHTMLFragment",{id:"",fileName:c,html:d+"\x3c/body\x3e\x3c/html\x3e",callback:function(c){a.execCommand("requestConvertHTMLToDoc",{id:c.id,extension:"odt",callback:function(c){var d=
a.config.docConvertingUrl+"/file/download/"+c.convertId+"?type\x3d"+c.type;c.stamp&&(d+="\x26stamp\x3d"+c.stamp);c=document.createElement("a");c.href=d;c.download=d;c.display="hidden";document.body.appendChild(c);POLARIS.tools.clickLink(c);document.body.removeChild(c);b.callback&&b.callback()}})}})}});a.addCommand("sendEmailBody",{exec:function(a,b){for(var c=a.document,d=c.createElement("content"),c=P(c),c=S(c),e=c.count(),f=0;f<e;f++){var g=c.getItem(f).body;d.appendHtml(g.getHtml())}c=a.checkDirty();
kb(d,!0,!1);c||a.resetDirty();d="mailto:?body\x3d"+encodeURI(d.getText());c=0;for(e=B.length;c<e;c++)f=B[c],d+=f;e=G.length;for(c=0;c<e;c++)f=G[c],d+=f;c=document.createElement("a");c.href=d;c.display="hidden";document.body.appendChild(c);POLARIS.tools.clickLink(c);document.body.removeChild(c)}});a.addCommand("footnote",{modes:{wysiwyg:1},readOnly:1,exec:function(){sb(a,"footnote")},contextSensitive:1,refresh:b});a.addCommand("endnote",{modes:{wysiwyg:1},readOnly:1,exec:function(){sb(a,"endnote")},
contextSensitive:1,refresh:b});a.on("doubleclick",function(b){var c;c=a.getSelection();var d=c.getSelectedElement();d&&d.is("a")?c=d:(c=c.getRanges()[0])?(c.shrink(POLARIS.SHRINK_TEXT),c=a.elementPath(c.getCommonAncestor()).contains("a",1)):c=null;c=c||b.data.element;d=c.getAttribute(p.role);!c.is("a")||"footnote"!=d&&"footnote-item"!=d&&"endnote"!=d&&"endnote-item"!=d||delete b.data.dialog},null,null,900);a.setKeystroke([[118,"pageoutline"],[POLARIS.CTRL+65,"selectall"],[POLARIS.CTRL+13,"breakPage"],
[POLARIS.CTRL+74,"breakPage"]]);a.on("setPageNumber",function(b){if(b=b.data){u.pageNumberPosition=b.pageNumberPosition;var c=b.header.both,d=b.header.odd,e=b.header.even;d||e?(d&&u.pageHeader.setInnerHtml("odd",d),e&&u.pageHeader.setInnerHtml("even",e)):u.pageHeader.setInnerHtml("both",c);8>parseInt(u.pageHeader.height)&&(u.pageHeader.height="8mm");c=b.footer.both;d=b.footer.odd;b=b.footer.even;d||b?(d&&u.pageFooter.setInnerHtml("odd",d),b&&u.pageFooter.setInnerHtml("even",b)):u.pageFooter.setInnerHtml("both",
c);8>parseInt(u.pageFooter.height)&&(u.pageFooter.height="8mm");aa(a);ga(a)}});a.on("setHeaderFooter",function(b){if(b=b.data)"header"==b.type?(u.pageHeader.setInnerHtml(b.position,b.innerHtml),8>parseInt(u.pageHeader.height)&&(u.pageHeader.height="8mm")):"footer"==b.type&&(u.pageFooter.setInnerHtml(b.position,b.innerHtml),8>parseInt(u.pageFooter.height)&&(u.pageFooter.height="8mm")),aa(a),ga(a),b.showHeaderFooter&&a.fire("showHeaderFooterTool",{type:b.type})});a.on("beforeUndoImage",function(a){if(a.editor.getCommand("grid").state==
POLARIS.TRISTATE_ON){a=a.editor.document.find(t(p.role,r.pageGrid));for(var b=a.count(),c=0;c<b;c++){var d=a.getItem(c);d&&d.setStyle("display","none")}}});a.on("afterUndoImage",function(a){if(a.editor.getCommand("grid").state==POLARIS.TRISTATE_ON){a=a.editor.document.find(t(p.role,r.pageGrid));for(var b=a.count(),c=0;c<b;c++){var d=a.getItem(c);d&&d.removeStyle("display")}}});a.on("uiSpace",function(b){b.removeListener();var c=POLARIS.tools.getNextId(),d=POLARIS.tools.addFunction(function(){a.fire("hideHeaderFooterTool")}),
c=["\x3cstyle\x3e",".polaris_header_footer_tool{","position:absolute;","left:0;","top:-50000px;","border:1px solid #ff8484;","border-radius:3px;","box-shadow: 0 1px 10px rgba(0,0,0,0.3);","background: #ffa1a1;","transition:opacity .1s;-o-transition:opacity .1s;-moz-transition:opacity .1s;-webkit-transition:opacity .1s;","}",".polaris_header_footer_btn{","padding: 15px;","display: block;","}",".polaris_header_footer_label{","color: #de0000;","font-weight: bold;","}","\x3c/style\x3e",'\x3cdiv id\x3d"'+
a.ui.spaceId("polaris_header_footer_tool")+'" class\x3d"polaris_header_footer_tool polaris_top" aria-labelledby\x3d"',c,'" onmousedown\x3d"return false;"\x3e','\x3ca href\x3d"#" class\x3d"polaris_header_footer_btn" onclick\x3d"POLARIS.tools.callFunction('+d+');return false;"\x3e','\x3cspan class\x3d"polaris_header_footer_label"\x3e머리글/바닥글 닫기\x3c/span\x3e',"\x3c/a\x3e","\x3c/div\x3e"];b.data.html+=c.join("");a.on("showHeaderFooterTool",function(a){if(!H){var b=a.editor,c=b.document,d=a.data.type;a=
a.data.pageNumber?a.data.pageNumber:V(b);var e=P(c),e=S(e),f=e.count(),g,h,k;for(g=0;g<f;g++)h=e.getItem(g),h.body.setAttribute("contentEditable","false"),a==g+1&&("header"==d?(h.header.removeStyle("display"),h.header.setStyle("border","1px dotted #de0000"),h.header.setAttribute("contentEditable","true"),k=h.header):(h.footer.removeStyle("display"),h.footer.setStyle("border","1px dotted #de0000"),h.footer.setAttribute("contentEditable","true"),k=h.footer));e=c.find("[doc-data-field-editable\x3dtrue]");
f=e.count();for(g=0;g<f;g++)e.getItem(g).setAttribute("contentEditable","false");"header"==d?8>parseInt(h.header.getStyle("height"))&&(u.pageHeader.height="8mm"):8>parseInt(h.footer.getStyle("height"))&&(u.pageFooter.height="8mm");ga(b);h=POLARIS.document.getById(b.ui.spaceId("polaris_header_footer_tool"));g=POLARIS.document.getById(b.ui.spaceId("contents"));f=e=0;g&&g.$&&(e+=g.$.offsetTop,f+=g.$.offsetLeft);g=u["header"==d?"pageHeader":"pageFooter"].getPageNumberType(a);h.setStyle("left",f+30+"px");
h.setStyle("top",e+30+"px");h.setAttribute("data-header-footer-type",d);h.setAttribute("data-header-footer-position",g);h.setAttribute("data-header-footer-page-number",a);h.findOne(".polaris_header_footer_label").setText(b.lang.pagination.headerAndFooter[d]+"("+b.lang.pagination.headerAndFooter.display[g]+") "+b.lang.pagination.headerAndFooter.close);k&&(b.focus(),b=new POLARIS.dom.range(c),b.moveToElementEditEnd(k),b.select(),k.scrollIntoView());H=!0}});a.on("hideHeaderFooterTool",function(a){if(H){a=
a.editor;var b=a.document,c=P(b),c=S(c),d=POLARIS.document.getById(a.ui.spaceId("polaris_header_footer_tool")),e=d.getAttribute("data-header-footer-type"),f=d.getAttribute("data-header-footer-position"),g=parseInt(d.getAttribute("data-header-footer-page-number"));d.setStyle("left","0");d.setStyle("top","-50000px");d.removeAttribute("data-header-footer-type");d.removeAttribute("data-header-footer-position");d.removeAttribute("data-header-footer-page-number");var d=0==O||2==O?!1:!0,h=c.count(),k,l,
m;for(k=0;k<h;k++)l=c.getItem(k),l.body.setAttribute("contentEditable",d),"header"==e?(l.header.setAttribute("contentEditable","false"),l.header.removeStyle("border"),l.header.$.scrollTop="0px"):(l.footer.setAttribute("contentEditable","false"),l.footer.removeStyle("border")),g==k+1&&("header"==e?u.pageHeader.setInnerHtml(f,l.header.getHtml()):u.pageFooter.setInnerHtml(f,l.footer.getHtml()),m=l);c=b.find("[doc-data-field-editable\x3dtrue]");e=c.count();for(f=0;f<e;f++)c.getItem(f).setAttribute("contentEditable",
"true");H=!1;ga(a);Q(a,0);m&&(a.focus(),a=new POLARIS.dom.range(b),a.moveToElementEditStart(m.body),a.select())}});c=POLARIS.tools.getNextId();d=POLARIS.tools.addFunction(function(){a.fire("hideCommentTool")});c=["\x3cstyle\x3e",".polaris_comment_tool{","position:absolute;","left:0;","top:-50000px;","border:1px solid #ff8484;","border-radius:3px;","box-shadow: 0 1px 10px rgba(0,0,0,0.3);","background: #ffa1a1;","transition:opacity .1s;-o-transition:opacity .1s;-moz-transition:opacity .1s;-webkit-transition:opacity .1s;",
"}",".polaris_comment_btn{","padding: 15px;","display: block;","}",".polaris_comment_label{","color: #de0000;","font-weight: bold;","}","\x3c/style\x3e",'\x3cdiv id\x3d"'+a.ui.spaceId("polaris_comment_tool")+'" class\x3d"polaris_comment_tool polaris_top" aria-labelledby\x3d"',c,'" onmousedown\x3d"return false;"\x3e','\x3ca href\x3d"#" class\x3d"polaris_comment_btn" onclick\x3d"POLARIS.tools.callFunction('+d+');return false;"\x3e','\x3cspan class\x3d"polaris_comment_label"\x3e\x3c/span\x3e',"\x3c/a\x3e",
"\x3c/div\x3e"];b.data.html+=c.join("");a.on("showCommentTool",function(a){if(!J){J=!0;var b=a.editor,c=b.document,d=P(c),e=S(d),f=V(b),d=a.data.newCommentNumber,g=a.data.editComment;a=a.data.command;for(var h,k=e.count(),l=0;l<k;l++){var m=e.getItem(l);m.body.setAttribute("contentEditable","false");"footnote"==a?(m.footnote.removeStyle("display"),f==l+1&&(m.footnote.setStyle("border","1px dotted #de0000"),m.footnote.setAttribute("contentEditable","true"),h=m.footnote)):"endnote"==a&&e.count()==l+
1&&(POLARIS.env.ie&&m.body.setAttribute("contentEditable","true"),h=c.getById(r.pageEndnote),h.removeStyle("display"),h.setStyle("border","1px dotted #de0000"),h.setAttribute("contentEditable","true"))}l=POLARIS.document.getById(b.ui.spaceId("polaris_comment_tool"));l.setAttribute("data-comment-page-number",f);l.setAttribute("data-comment-new-number",d);l.setAttribute("data-comment-type",a);f=POLARIS.document.getById(b.ui.spaceId("contents"));k=e=0;f&&f.$&&(e+=f.$.offsetTop,k+=f.$.offsetLeft);l.setStyle("left",
k+30+"px");l.setStyle("top",e+30+"px");l.findOne(".polaris_comment_label").setText(b.lang.pagination.comment.close[a]);if(h){b.focus();var b=new POLARIS.dom.range(c),n,c=h.find(t(p.role,a+"-item-number"));a=c.count();for(l=0;l<a;l++)if(f=c.getItem(l),parseInt(f.getText())==d){n=f;break}n?(b.moveToElementEditEnd(n),g||b.fixBlock(!0,"p")):b.moveToElementEditEnd(h);b.select();h.scrollIntoView()}}});a.on("hideCommentTool",function(a){if(J){a=a.editor;var b=a.document,c=P(b),c=S(c),d=POLARIS.document.getById(a.ui.spaceId("polaris_comment_tool"));
d.setStyle("left","0");d.setStyle("top","-50000px");var e=d.getAttribute("data-comment-type");d.removeAttribute("data-comment-type");var f=parseInt(d.getAttribute("data-comment-new-number"));d.removeAttribute("data-comment-new-number");var g=parseInt(d.getAttribute("data-comment-page-number"));d.removeAttribute("data-comment-page-number");for(var d=0==O||2==O?!1:!0,h=c.count(),k=0;k<h;k++){var l=c.getItem(k);l.body.setAttribute("contentEditable",d);if("footnote"==e){if(l.footnote.setAttribute("contentEditable",
"false"),l.footnote.removeStyle("border"),g==k+1)for(var l=l.footnote.find(t(p.role,"footnote-item")),m=l.count(),n=0;n<m;n++){var q=l.getItem(n),u=parseInt(q.getText());0<u&&(B[u-1]=q.getOuterHtml())}}else if("endnote"==e&&c.count()==k+1)for(l=b.getById(r.pageEndnote),l.setAttribute("contentEditable","false"),l.removeStyle("border"),l=l.find(t(p.role,"endnote-item")),l.count(),n=0;n<l;n++)q=l.getItem(n),q.findOne('[doc-data-role\x3d"endnote-item-number"]')?(u=parseInt(q.getText()),0<u&&(G[u-1]=q.getOuterHtml())):
G[n]='\x3cdiv doc-data-role\x3d"endnote-item" id\x3d"endnote-item'+(n+1)+'"\x3e\x3cp\x3e\x3cspan contenteditable\x3d"false" doc-data-role\x3d"endnote-item-number"\x3e'+(n+1)+") \x3c/span\x3e\x3cbr\x3e\x3c/p\x3e\x3c/div\x3e"}J=!1;Q(a,0);if(b=b.findOne('span[id\x3d"'+e+f+'"]'))a.focus(),a=new POLARIS.dom.range(a.document),a.moveToElementEditEnd(b),a.select(),b.scrollIntoView()}});a.on("pausePagination",function(a){I=!0});a.on("resumePagination",function(a){I=!1});a.on("setTextContents",function(a){var b=
a.editor;a=a.data.text;var c=P(b.document),c=S(c),d=c.count(),e=null;a=POLARIS.tools.isEmptyValue(a)?"\x3cp\x3e\x3cspan\x3e\x26#8203;\x3c/span\x3e\x3c/p\x3e":"\x3cp\x3e\x3cspan\x3e"+a+"\x3c/span\x3e\x3c/p\x3e";for(var f=0;f<d;f+=1)e=c.getItem(f),0===f?e.body.setHtml(a):e.owner.remove();b.fire("contentChange",{type:"setTextContents",sync:!0})})},null,null,10)}},afterInit:function(a){a.config.wordprocessor&&(a.on("contentDom",function(){var b=a.document,c=a.editable();a.pagination=new v;W(a);c.on("keydown",
mc,a,null,9);c.on("keyup",oc);var d=function(){var b=P(a.document),c=a.pagination.getZoomType(),b=Math.round(parseFloat(POLARIS.tools.getScaleRatio(b)));a.fire("zoom",{type:c,ratio:b,updateScrollbarVisibility:1})};c.attachListener(POLARIS.document.getWindow(),"resize",d,a);b.getBody().$.onresize=d;a.docInfo&&a.docInfo.fileName&&a.fire("updateFilenameCode",a.docInfo.fileName);b=P(b);a.pagination.setScaleRatio(POLARIS.tools.getScaleRatio(b))}),a.on("mode",function(){}),a.on("dataReady",function(){}),
a.on("beforeCommandExec",function(b){if("headerfooter"==b.data.name||"pageoutline"==b.data.name||"footnote"==b.data.name||"endnote"==b.data.name||"footendnotechange"==b.data.name)a.fire("hideCommentTool"),a.fire("hideHeaderFooterTool")}),a.on("ribbonMenuShow",function(){a.fire("hideCommentTool");a.fire("hideHeaderFooterTool")}),a.on("beforeContentPreview",ba),a.on("contentPreview",R),a.on("beforeContentPrint",ba),a.on("afterContentPrint",R),a.on("contentChange",Ba),a.on("selectionCheck",ha),a.on("readOnly",
oa),a.on("zoom",da),a.on("selectAll",ob),a.on("paste",ic),a.on("afterPaste",jc),a.on("changeEditMode",pc),a.on("setData",qc),a.on("simpleuploads.finishedUpload",bc))},ID:r,DefaultPage:x,pageInfo:u,generateHtml:Fb,getCurrentPageNumber:V,getTotalPageCount:Z,getPageContentElement:function(a,b){var c=N(a,b);return null==c?null:c.content},updatePageStyle:function(a){ga(a);a.execCommand("onPageResized")},getPageElement:function(a,b){var c=N(a,b);return null==c?null:c.owner},getPage:N,setInitialCaret:function(a,
b){var c=P(a.document),d=N(c,1),c=null;if(null!=d){var e=d.owner.findOne(w.removablePubdocbody);e&&(c=e.getNext(ca));null==c&&(c=d.body);POLARIS.env.ie||c.focus();!1!==b&&(a.forceNextSelectionCheck(),a.selectionChange(1));d=a.getSelection();if(null==(d?d.getStartElement():null)||!1===b)d=a.getSelection(),e=new POLARIS.dom.range(c.getDocument()),e.moveToElementEditStart(c)||(e.selectNodeContents(c),e.collapse(!0)),d&&d.selectRanges([e]),e.scrollIntoView()}},isPageOutlineShown:function(){return E},
mergeSplitRows:Ha,isDocumentLoaded:function(){return y}});POLARIS.plugins.pagination={DefaultPage:x};v.prototype.setScaleRatio=function(a){this.ratio=a};v.prototype.getScaleRatio=function(){return this.ratio};v.prototype.setZoomType=function(a){this.zoomType=a};v.prototype.getZoomType=function(){return this.zoomType};v.prototype.getPageContainer=P;v.prototype.getPages=S;v.prototype.adjustCaret=function(a){var b=a.document,c=a.getSelection();a=c&&c.getRanges()[0];var c=c&&c.getStartElement(),d=!1;
if(void 0==a||null==a)a=new POLARIS.dom.range(b);null==c&&(d=!0);var e=c&&c.getAscendant(ja,!1);null==e&&(d=!0);var e=c&&c.type==POLARIS.NODE_ELEMENT&&c.getAttribute(p.role)==r.pageFootnote,f=c&&c.type==POLARIS.NODE_ELEMENT&&c.getAttribute(p.role)==r.pageEndnote;(e||f)&&d&&(d=!1);d&&(d=d=null,(d=(d=(e=c&&c.getAscendant(ja,!0))?e.getAscendant(K,!0):c&&c.getAscendant(K,!0))?new A(d):N(b,1))&&d&&d.body&&a.moveToLeafElementEditablePosition(d.body,!1,{table:1})&&a.select())}})();POLARIS.config.pagination_debug=
!1;(function(){POLARIS.plugins.add("paragraphmargins",{requires:"dialog",init:function(a){a.addCommand("paragraphmargins",new POLARIS.dialogCommand("paragraphmargins"));a.ui.addButton&&a.ui.addButton("ParagraphMargins",{label:a.lang.paragraphmargins.toolbar,command:"paragraphmargins",toolbar:"paragraphmargins"});POLARIS.dialog.add("paragraphmargins",this.path+"dialogs/paragraphmargins.js")}})})();(function(){var a='\x3ca id\x3d"{id}" class\x3d"polaris{buttonType}_button polaris_text_button_{state} {cls}"'+
(POLARIS.env.gecko&&!POLARIS.env.hc?"":" href\x3d\"javascript:void('{titleJs}')\"")+' title\x3d"{title}" tabindex\x3d"-1" hidefocus\x3d"true" role\x3d"button" draggable\x3d"false" aria-labelledby\x3d"{id}_label" aria-haspopup\x3d"{hasArrow}" aria-disabled\x3d"{ariaDisabled}"';POLARIS.env.gecko&&POLARIS.env.mac&&(a+=' onkeypress\x3d"return false;"');POLARIS.env.gecko&&(a+=' onblur\x3d"this.style.cssText \x3d this.style.cssText;"');var a=a+(' onkeydown\x3d"return POLARIS.tools.callFunction({keydownFn},event);" onfocus\x3d"return POLARIS.tools.callFunction({focusFn},event);" '+
(POLARIS.env.ie?'onclick\x3d"return false;" onmouseup':"onclick")+'\x3d"POLARIS.tools.callFunction({clickFn},this);return false;"\x3e'),a=a+"{label}{arrowHtml}\x3c/a\x3e",e=POLARIS.addTemplate("txtbuttonArrow",'\x3cspan class\x3d"polaris_button_arrow"\x3e'+(POLARIS.env.hc?"\x26#9660;":"")+"\x3c/span\x3e"),b=POLARIS.addTemplate("textbutton",a);POLARIS.plugins.add("textbutton",{beforeInit:function(a){a.ui.addHandler(POLARIS.UI_TEXT_BUTTON,POLARIS.ui.textbutton.handler)}});POLARIS.UI_TEXT_BUTTON="textbutton";
POLARIS.ui.textbutton=function(a){POLARIS.tools.extend(this,a,{title:a.label,click:a.click||function(b){b.execCommand(a.command)}});this._={}};POLARIS.ui.textbutton.handler={create:function(a){return new POLARIS.ui.textbutton(a)}};POLARIS.ui.textbutton.prototype={render:function(a,d,h){function g(){var b=a.mode;b&&(b=this.modes[b]?void 0!==t[b]?t[b]:POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED,b=a.readOnly&&!this.readOnly?POLARIS.TRISTATE_DISABLED:b,this.setState(b),this.refresh&&this.refresh())}
var k=POLARIS.env,f=this._.id=POLARIS.tools.getNextId(),l="",m=this.command,n;this._.editor=a;var q={id:f,button:this,editor:a,focus:function(){POLARIS.document.getById(f).focus()},execute:function(){this.button.click(a)},attach:function(a){this.button.attach(a)}},v=q.keydownFn=POLARIS.tools.addFunction(function(a){if(q.onkey)return a=new POLARIS.dom.event(a),!1!==q.onkey(q,a.getKeystroke())}),r=q.focusFn=POLARIS.tools.addFunction(function(a){var b;q.onfocus&&(b=!1!==q.onfocus(q,new POLARIS.dom.event(a)));
return b}),p=0;q.clickFn=n=POLARIS.tools.addFunction(function(){p&&(a.unlockSelection(1),p=0);q.execute();k.iOS&&a.focus()});if(this.modes){var t={};a.on("beforeModeUnload",function(){a.mode&&this._.state!=POLARIS.TRISTATE_DISABLED&&(t[a.mode]=this._.state)},this);a.on("activeFilterChange",g,this);a.on("mode",g,this);!this.readOnly&&a.on("readOnly",g,this)}else m&&(m=a.getCommand(m))&&(m.on("state",function(){this.setState(m.state)},this),l+=m.state==POLARIS.TRISTATE_ON?"on":m.state==POLARIS.TRISTATE_DISABLED?
"disabled":"off");if(this.directional)a.on("contentDirChanged",function(b){var d=POLARIS.document.getById(this._.id),e=d.getFirst();b=b.data;b!=a.lang.dir?d.addClass("polaris_"+b):d.removeClass("polaris_ltr").removeClass("polaris_rtl");e.setAttribute("style",POLARIS.skin.getIconStyle(A,"rtl"==b,this.icon,this.iconOffset))},this);m||(l+="off");var w=this.name||this.command,A=w;this.icon&&!/\./.test(this.icon)&&(A=this.icon,this.icon=null);h={id:f,name:w,iconName:A,buttonType:h,label:this.label,cls:this.className||
"",state:l,ariaDisabled:"disabled"==l?"true":"false",title:this.title,titleJs:k.gecko&&!k.hc?"":(this.title||"").replace("'",""),hasArrow:this.hasArrow?"true":"false",keydownFn:v,focusFn:r,clickFn:n,style:POLARIS.skin.getIconStyle(A,"rtl"==a.lang.dir,this.icon,this.iconOffset),arrowHtml:this.hasArrow?e.output():""};b.output(h,d);if(this.onRender)this.onRender();return q},setState:function(a){if(this._.state==a)return!1;this._.state=a;var b=POLARIS.document.getById(this._.id);return b?(b.setState(a,
"polaris_text_button"),a==POLARIS.TRISTATE_DISABLED?b.setAttribute("aria-disabled",!0):b.removeAttribute("aria-disabled"),this.hasArrow?(a=a==POLARIS.TRISTATE_ON?this._.editor.lang.textbutton.selectedLabel.replace(/%1/g,this.label):this.label,POLARIS.document.getById(this._.id+"_label").setText(a)):a==POLARIS.TRISTATE_ON?b.setAttribute("aria-pressed",!0):b.removeAttribute("aria-pressed"),!0):!1},getState:function(){return this._.state},toFeature:function(a){if(this._.feature)return this._.feature;
var b=this;this.allowedContent||this.requiredContent||!this.command||(b=a.getCommand(this.command)||b);return this._.feature=b}};POLARIS.ui.prototype.addTextButton=function(a,b){this.add(a,POLARIS.UI_TEXT_BUTTON,b)}})();(function(){function a(a){function b(d,e){if(e.length){d.items?d.items.push(a.ui.create("-")):d.items=[];for(var f,h,k;f=e.shift();)h="string"==typeof f?f:f.name,k=f.showLabel,g&&-1!=POLARIS.tools.indexOf(g,h)||(f=a.ui.create(h))&&a.addFeature(f)&&(k&&(f.showLabel=k),d.items.push(f))}}
var e=[],g=a.config.removeButtons,g=g&&g.split(","),k=a.config.ribbonbar;if(k)for(var f=0;f<k.length;f++){var l=[],m=k[f];if(m&&m.groups){for(var n=0;n<m.groups.length;n++){var q=m.groups[n],v={};POLARIS.tools.isArray(q)?(b(v,POLARIS.tools.clone(q)),v.type="_group",l.push(v)):q.tools&&(b(v,POLARIS.tools.clone(q.tools)),v.name=q.name,v.type="_group",l.push(v))}l.name=m.name;l.type="_tab";e.push(l)}}return e}var e=function(){this.tabs=[];this.tabButtons=[];this.currentTabContentId;this.focusCommandExecuted=
!1;this.menuItems=[]};e.prototype.focus=function(){};var b={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(a){a.ribbon&&(a.ribbon.focusCommandExecuted=!0,POLARIS.env.ie||POLARIS.env.air?setTimeout(function(){a.ribbon.focus()},100):a.ribbon.focus())}};POLARIS.plugins.add("ribbon",{requires:"button,textbutton",lang:"en,ko",init:function(c){var d=function(a,b){};c.on("uiReady",function(a){c.ribbon.tabButtons[0]&&(c.ribbon.tabButtons[0].setState(POLARIS.TRISTATE_ON),c.ribbon.currentTabContentId=
c.ribbon.tabButtons[0].tabContentId)});c.on("uiSpace",function(b){if(b.data.space==c.config.ribbonLocation){b.removeListener();c.ribbon=new e;var g=POLARIS.tools.getNextId(),k=!1!==c.config.ribbonStartupExpanded,g=["\x3cstyle\x3eul.polaris_ribbon_tab_host li.polaris_ribbon_tab a.polaris_text_button_on{"+(c.config.ribbonBorderColor?"border-right:1px solid "+c.config.ribbonBorderColor+";":"")+(c.config.ribbonBorderColor?"border-top:1px solid "+c.config.ribbonBorderColor+";":"")+(c.config.ribbonBorderColor?
"border-left:1px solid "+c.config.ribbonBorderColor+";":"")+(c.config.ribbonBackgroundColor?"border-bottom:1px solid "+c.config.ribbonBackgroundColor+";":"")+(c.config.ribbonTextColor?"color:"+c.config.ribbonTextColor+";":"")+(c.config.ribbonBackgroundColor?"background-color:"+c.config.ribbonBackgroundColor+";":"")+"}ul.polaris_ribbon_tab_host li.polaris_ribbon_button a.polaris_text_button_on{"+(c.config.ribbonButtonSelectedColor?"background-color:"+c.config.ribbonButtonSelectedColor+";":"")+"}ul.polaris_ribbon_tab_host li.polaris_ribbon_button a.polaris_text_button_off {"+
(c.config.ribbonTabhostBackgroundColor?"border-right:1px solid transparent;":"")+(c.config.ribbonTabhostBackgroundColor?"border-top:1px solid transparent;":"")+(c.config.ribbonTabhostBackgroundColor?"border-left:1px solid transparent;":"")+"}ul.polaris_ribbon_tab_host{"+(c.config.ribbonTabhostBackgroundColor?"background-color:"+c.config.ribbonTabhostBackgroundColor+";":"")+(c.config.ribbonTabhostBackgroundColor?"border-top: 1px solid "+c.config.ribbonTabhostBackgroundColor+";":"")+(c.config.ribbonTabhostBackgroundColor?
"border-left: 1px solid "+c.config.ribbonTabhostBackgroundColor+";":"")+(c.config.ribbonTabhostBackgroundColor?"border-right: 1px solid "+c.config.ribbonTabhostBackgroundColor+";":"")+(c.config.ribbonTextColor?"color:"+c.config.ribbonTextColor+";":"")+"}div.polaris_ribbon_tab_content{"+(c.config.ribbonBackgroundColor?"background-color:"+c.config.ribbonBackgroundColor+";":"")+(c.config.ribbonBorderColor?"border: 1px solid "+c.config.ribbonBorderColor+";":"")+(c.config.ribbonTextColor?"color:"+c.config.ribbonTextColor+
";":"")+"}span.polaris_ribbon_tab_group{"+(c.config.ribbonBorderColor?"border-right-color:"+c.config.ribbonBorderColor+";":"")+"}\x3c/style\x3e",'\x3cspan id\x3d"',g,'" class\x3d"polaris_voice_label"\x3e',c.lang.ribbon.ribbon,"\x3c/span\x3e",'\x3cspan id\x3d"'+c.ui.spaceId("ribbon")+'" class\x3d"polaris_ribbon" role\x3d"ribbon" aria-labelledby\x3d"',g,'" on/mousedown\x3d"return false;"',k&&c.config.showRibbon?"\x3e":' style\x3d"display:none"\x3e'],k=['\x3cul class\x3d"polaris_ribbon_tab_host" onselectstart\x3d"return false;" ondragstart\x3d"return false;"\x3e'],
f=['\x3cdiv class\x3d"polaris_ribbon_tab_content_area" onselectstart\x3d"return false;" ondragstart\x3d"return false;"\x3e'];c.addCommand("ribbonCollapse",{readOnly:1,exec:function(a,b){var c=a.ui.space("ribbon"),d=a.ui.space("contents"),e=parseInt(d.$.offsetHeight,10),f=c.getParent(),g=f.$.offsetHeight,h=b.show,k=b.fromClickEvt;h?c.show():c.hide();d.isVisible()||(e=POLARIS.tools.convertToPx(d.getComputedStyle("height")));d.setStyle("height",e-(f.$.offsetHeight-g)+"px");a.fire("resize");c={};c.isVlsible=
h?!0:!1;k&&a.fire("ribbonMenuVisible",c)},modes:{wysiwyg:1,source:1}});c.config.ribbonCanCollapse&&c.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&g.push('\x3cspan class\x3d"polaris_ribbon_main" unselectable\x3d"on" \x3e');var l=c.ribbon.tabs;k.push('\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"width: 100%;"\x3e');if(c.config.menubar){var m=c.config.menubar[0],n=m.name,q=c.ui.get(m.name);q||(n=c.lang.label[n]);var v="ribbon_file_button_"+m.name.toLowerCase(),n={label:n,modes:{wysiwyg:1,source:1},
toolbar:"ribbon_file_button",onMenu:function(a,b,d,e){if(a=c.menubar.menuItems[e])for(var f in a)if(b=c.getMenuItem(f))if(b=c.getCommand(b.command))a[f]=b.state;return c.menubar.menuItems[e]}};c.ui.add(v,POLARIS.UI_MENU_TEXT_BUTTON,n);var r=c.ui.create(v);if(r){k.push('\x3cli class\x3d"polaris_ribbon_button"\x3e');r.hasArrow=!1;r.render(c,k,"_ribbon_tab_host");k.push("\x3c/li\x3e");for(var p={},n=0;n<m.items.length;n++){var t=m.items[n];t&&((q=c.ui.get(t.name))?p["menubar_item_"+q.name]=POLARIS.TRISTATE_OFF:
"-"!==t.name&&(p["menubar_item_"+t.name]=t.items?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED))}c.menubar.menuItems[r._.id]=p}}m=a(c);for(r=0;r<m.length;r++)if(p=m[r]){for(var w=0,n=0;n<p.length;n++)if((t=p[n])&&t.items){if(!w){var v="ribbon_tab_host_button_"+p.name.toLowerCase(),A=p.name;(q=c.ui.get(p.name))||(A=c.lang.label[A]);c.ui.addTextButton(v,{label:A,toolbar:"ribbon_tab_host_button",click:function(){if(this instanceof POLARIS.ui.textbutton&&c.ribbon.tabButtons){for(var a=0;a<c.ribbon.tabButtons.length;a++){var b=
c.ribbon.tabButtons[a];b._.id==this._.id?b.setState(POLARIS.TRISTATE_ON):b.setState(POLARIS.TRISTATE_OFF)}c.ribbon.currentTabContentId&&(a=POLARIS.document.getById(c.ribbon.currentTabContentId))&&a.setStyle("display","none");(a=POLARIS.document.getById(this.tabContentId))&&a.setStyle("display","block");c.ribbon.currentTabContentId=this.tabContentId;c.fire("ribbonMenuShow")}}});if(q=c.ui.create(v))k.push('\x3cli class\x3d"polaris_ribbon_tab"\x3e'),w=q.render(c,k,"_ribbon_tab_host"),k.push("\x3c/li\x3e"),
v=POLARIS.tools.getNextId(),q.tabContentId=v,c.ribbon.tabButtons.push(q),w={id:v,items:[],tabHost:w},f.push('\x3cdiv id\x3d"',v,'" class\x3d"polaris_ribbon_tab_content"',p.name?' aria-labelledby\x3d"'+v+'_label"':"",' role\x3d"tab_content" unselectable\x3d"on" '+(0<r?'style\x3d"display:none"':"")+"\x3e"),l.push(w)}for(var x=0,A=q=0;A<t.items.length;A++){var C=function(a){a=a.render(c,f);G=x.items.push(a)-1;0<G&&(a.previous=x.items[G-1],a.previous.next=a);a.group=x;a.onkey=d;a.onfocus=function(){c.ribbon.focusCommandExecuted||
c.focus()}},u=t.items[A];if(u){var B,v=!1!==u.canGroup;"button"==u.type&&"bottom"===u.showLabel&&(v=!1);if(!x){B=POLARIS.tools.getNextId();x={id:B,items:[]};groupName=t.name;f.push('\x3cspan id\x3d"',B,'" class\x3d"polaris_ribbon_tab_group"',groupName?' aria-labelledby\x3d"'+B+'_label"':"",' role\x3d"group" unselectable\x3d"on"\x3e');f.push('\x3cspan class\x3d"polaris_ribbon_tab_group_tools" role\x3d"group" unselectable\x3d"on"\x3e');var G=w.items.push(x)-1;0<G&&(w.previous=w.items[G-1],w.previous.next=
w)}v?q||"button"!==u.type||(f.push('\x3cspan class\x3d"polaris_toolgroup" role\x3d"presentation" unselectable\x3d"on"\x3e'),q=1):q&&(f.push("\x3c/span\x3e"),q=0);C(u)}}q&&(f.push("\x3c/span\x3e"),q=0);x&&(f.push("\x3c/span\x3e"),t.name&&f.push('\x3cdiv id\x3d"'+B+'" class\x3d"polaris_ribbon_tab_group_name" unselectable\x3d"on"\x3e '+t.name+"\x3c/div\x3e"),f.push("\x3c/span\x3e"))}w&&f.push("\x3c/div\x3e")}B=(B=c.config.removeButtons)&&B.split(",");if((!B||-1==POLARIS.tools.indexOf(B,"label_help"))&&
c.config.menubar&&(m=c.config.menubar[7],n=m.name,(q=c.ui.get(m.name))||(n=c.lang.label[n]),v="ribbon_file_button_"+m.name.toLowerCase(),n={label:n,modes:{wysiwyg:1,source:1},toolbar:"ribbon_file_button",onMenu:function(a,b,d,e){if(a=c.menubar.menuItems[e])for(var f in a)if(b=c.getMenuItem(f))if(b=c.getCommand(b.command))a[f]=b.state;return c.menubar.menuItems[e]}},c.ui.add(v,POLARIS.UI_MENU_TEXT_BUTTON,n),r=c.ui.create(v))){k.push('\x3cli class\x3d"polaris_ribbon_button"\x3e');r.hasArrow=!1;r.render(c,
k,"_ribbon_tab_host");k.push("\x3c/li\x3e");p={};for(n=0;n<m.items.length;n++)if(t=m.items[n])(q=c.ui.get(t.name))?p["menubar_item_"+q.name]=POLARIS.TRISTATE_OFF:"-"!==t.name&&(p["menubar_item_"+t.name]=t.items?POLARIS.TRISTATE_OFF:POLARIS.TRISTATE_DISABLED);c.menubar.menuItems[r._.id]=p}(!B||-1==POLARIS.tools.indexOf(B,"menubar_setting"))&&c.ui.toolbarMode&&(c.ui.add("setting",POLARIS.UI_MENU_SETTING_BUTTON,{title:c.lang.ribbon.changeToolMode,toolbar:"menubar_setting",onMenu:function(){c.fire("ribbonMenuShow");
return{toolbarMode:1==c.ui.toolbarMode?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,ribbonMode:2==c.ui.toolbarMode?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF}}}),B=c.ui.create("setting"))&&(k.push("\x3c/td\x3e\x3ctd\x3e"),B.render(c,k),k.push("\x3c/td\x3e"));k.push("\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e");k.push("\x3c/ul\x3e");f.push("\x3c/div\x3e");c.config.ribbonCanCollapse&&f.push("\x3c/span\x3e");f.push("\x3c/span\x3e");b.data.html+=g.join("");b.data.html+=k.join("");b.data.html+=f.join("")}},
null,null,3);c.on("destroy",function(){if(this.ribbon)for(var a=this.ribbon.tabs,b=0;b<a.length;b++){var c=a[b];if(c&&(c.tabHost&&c.tabHost.clickFn&&POLARIS.tools.removeFunction(c.tabHost.clickFn),c.tabHost&&c.tabHost.keydownFn&&POLARIS.tools.removeFunction(c.tabHost.keydownFn),c.tabHost&&c.tabHost.focusFn&&POLARIS.tools.removeFunction(c.tabHost.focusFn),c.items))for(var d=0;d<c.items.length;d++){var e=c.items[d];if(e&&e.items)for(var m=0;m<e.items.length;m++){var n=e.items[m];n.clickFn&&POLARIS.tools.removeFunction(n.clickFn);
n.keydownFn&&POLARIS.tools.removeFunction(n.keydownFn);n.focusFn&&POLARIS.tools.removeFunction(n.focusFn)}}}});c.on("uiReady",function(){var a=c.ui.space("ribbon");a&&c.focusManager.add(a,1)});c.addCommand("ribbonFocus",b);c.setKeystroke(POLARIS.ALT+121,"ribbonFocus");c.ui.add("/",POLARIS.UI_RIBBON_TOOLS_BREAKE_LINE,{});c.ui.addHandler(POLARIS.UI_RIBBON_TOOLS_BREAKE_LINE,{create:function(){return{render:function(a,b){b.push('\x3cspan class\x3d"polaris_ribbon_tools_break"\x3e\x3c/span\x3e');return{}}}}})}})})();
POLARIS.UI_RIBBON_TOOLS_SEPARATOR="ribbon_tools_separator";POLARIS.UI_RIBBON_TOOLS_BREAKE_LINE="ribbon_tools_break_line";POLARIS.config.ribbonLocation="top";(function(){function a(a){a=a.editor;a.editable().attachListener(POLARIS.document.getWindow(),"resize",d,a)}function e(a){a=a.editor;b(a,!1);a.on("scroll",c,a);a.on("resize",d);a.on("zoom",h);void 0!=t&&(t.removeListener("mouseover",F),t.on("mouseover",F),t.removeListener("mouseout",E),t.on("mouseout",E),t.removeListener("mousedown",G),t.on("mousedown",
G));void 0!=w&&(w.removeListener("mouseover",L),w.on("mouseover",L),w.removeListener("mouseout",z),w.on("mouseout",z));void 0!=p&&(p.removeListener("mouseup",y),p.on("mouseup",y));void 0!=r&&(r.removeListener("mousedown",J),r.on("mousedown",J),r.removeListener("mouseup",I),r.on("mouseup",I));void 0!=a&&(a.document.removeListener("mouseup",y),a.document.on("mouseup",y),a.document.removeListener("mouseup",I),a.document.on("mouseup",I))}function b(a,b){if(a.config.showRuler){r=a.document.getById(n);
p=a.document.getById(n+"_face");a.document.getById(n+"_line");t=a.document.getById(n+"_cursor");w=a.document.getById(n+"_margin");var c=a.document.getById(q),d=a.plugins.pagination.getCurrentPageNumber(a);a.plugins.pagination.getPageElement(a.document,d);a.plugins.pagination.isPageOutlineShown();b&&(r&&r.remove(),c&&c.remove(),r=null);if(!r){r=POLARIS.dom.element.createFromHtml('\x3cdiv id\x3d"'+n+'" contenteditable\x3d"false" unselectable\x3d"on" style\x3d"z-index: 1; position: fixed; margin:0; padding: 0; top: 1px; background-color: #d6d8dd; border-bottom: 1px solid #aaaaad;display:none;"\x3e\x3cdiv id\x3d"'+
n+'_back" contenteditable\x3d"false" unselectable\x3d"on" style\x3d"position: relative; margin:0; padding: 0; height: 0.5cm; background-color: #e6e6e6; border-bottom: 1px solid #aaaaad; border-top: 1px solid gray; border-right: 1px solid #aaaaad; overflow: hidden;"\x3e\x3cdiv id\x3d"'+n+'_face" contenteditable\x3d"false" unselectable\x3d"on" style\x3d"position: relative; margin:0; padding: 0; height: 0.5cm; background-color: white;"\x3e\x3c/div\x3e\x3cdiv id\x3d"'+n+'_line" contenteditable\x3d"false" unselectable\x3d"on" style\x3d"position: relative; margin:0; padding: 0; height: 0.1cm; top: -0.1cm; background-color: #fcfcfc; border-top: 1px solid #aaaaad; border-bottom: 1px solid #aaaaad;"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');
a.document.getBody().getFirst().insertBeforeMe(r);v=a;c=a.document.getById(n);a.document.getById(n+"_back");a.document.getById(n+"_line");var d=a.plugins.pagination.pageInfo,e=a.plugins.pagination.isPageOutlineShown();p=a.document.getById(n+"_face");for(var f=parseInt(d.getWidth())-parseInt(d.marginLeft)-(e?0:parseInt(d.marginRight))+100,g=0;g<f;g+=10){var h=.1*g,z=.4,x=.1,y='\x3cdiv style\x3d"z-index: 1; position: absolute; font-size: 70%; width: 0.4cm; left: '+(h-.2)+'cm; height: 0.4ccm; text-align: center; color: #505050;" data-left\x3d"'+
h+'" data-type\x3d"label"\x3e\x3cspan style\x3d"vertical-align: middle;"\x3e'+g/10+"\x3c/span\x3e\x3c/div\x3e",y=POLARIS.dom.element.createFromHtml(y);y.appendTo(p);h='\x3cdiv style\x3d"z-index: 1; position: absolute; border-left: 1px solid #aaaaad; margin: 0; padding: 0; height: '+x+"cm; left: "+h+"cm; top: "+z+'cm;" data-left\x3d"'+h+'" data-type\x3d"bar"\x3e\x3c/div\x3e';h=POLARIS.dom.element.createFromHtml(h);h.appendTo(p)}t=POLARIS.dom.element.createFromHtml('\x3cdiv id\x3d"'+n+'_cursor" contenteditable\x3d"false" unselectable\x3d"on" data-left\x3d"-0.5" data-type\x3d"cursor" style\x3d"z-index: 10000000;position: absolute;width: 1cm;height: 0.5cm;left: -0.5cm;top: 0cm;overflow: hidden;cursor: pointer;"\x3e\x3cspan id\x3d"'+
n+'_cursor_top" style\x3d"background-image:url(\''+m+'images/ruler_controller_top_n.png\');position:absolute;top:0;margin:0 0 0 -4px;left:50%;cursor: pointer;width:9px;height:9px;" contenteditable\x3d"false" unselectable\x3d"on"\x3e\x3c/span\x3e\x3cspan id\x3d"'+n+'_cursor_bottom" contenteditable\x3d"false" unselectable\x3d"on" style\x3d"background-image:url(\''+m+"images/ruler_controller_bottom_n.png');position:absolute;bottom:0;margin:0 0 0 -4px;left:50%;cursor: pointer;width:9px;height:9px;\"\x3e\x3c/span\x3e\x3c/div\x3e");
t.appendTo(p);w=POLARIS.dom.element.createFromHtml('\x3cdiv id\x3d"'+n+'_margin" contenteditable\x3d"false" unselectable\x3d"on" data-left\x3d"0" data-type\x3d"margin" style\x3d"z-index: 10000000;position: absolute;width: 1cm;height: 0.5cm;margin-left: -0.5cm; left: -0.5cm;top: 0.54cm;cursor: pointer;"\x3e\x3cspan id\x3d"'+n+'_margin_img" style\x3d"position:absolute;top:0;margin:0 0 0 -4px;left:50%;cursor: pointer;background-image:url(\''+m+'images/ruler_controller_synchronize_bottom_n.png\');width:9px;height:5px;" contenteditable\x3d"false" unselectable\x3d"on"/\x3e\x3c/span\x3e\x3c/div\x3e');
w.appendTo(c);if(e)for(f=parseInt(d.marginLeft)+180,g=10;g<f;g+=10)h=-(.1*g),z=.4,x=.1,g!=f&&(y='\x3cdiv style\x3d"z-index: 1; position: absolute; font-size: 70%; width: 0.4cm; left: '+(h-.2)+'cm; height: 0.4cm; text-align: center; vertical-align: middle; color: #505050;" data-left\x3d"'+h+'" data-type\x3d"label"\x3e'+.1*g+"\x3c/div\x3e",y=POLARIS.dom.element.createFromHtml(y),y.appendTo(p)),h='\x3cdiv style\x3d"z-index: 1; position: absolute; border-left: 1px solid gray; margin: 0; padding: 0; height: '+
x+"cm; left: "+h+"cm; top: "+z+'cm;" data-left\x3d"'+h+'" data-type\x3d"bar"\x3e\x3c/div\x3e',h=POLARIS.dom.element.createFromHtml(h),h.appendTo(p)}u?(k(a,!0),a.document.getBody().setStyle("margin-top","20px")):(k(a,!1),a.document.getBody().setStyle("margin-top","10px"));l(a)}}function c(a){l(this)}function d(a){l(this)}function h(a){l(this)}function g(a){a=a.editor;var b=a.plugins.pagination.getCurrentPageNumber(a);a.plugins.pagination.getPageElement(a.document,b);(a=a.document.getById(q))&&a.getAttribute("polaris-page")}
function k(a,b){if(a.config.showRuler){u=b;if(void 0==b||null==b)this.state==POLARIS.TRISTATE_OFF?(this.state=POLARIS.TRISTATE_ON,u=!0):(this.state=POLARIS.TRISTATE_OFF,u=!1);var c=a.document.getById(n),d=a.document.getById(q);u?(c&&c.show(),d&&d.show()):(c&&c.hide(),d&&d.hide())}}function f(a){b(a.editor,!0)}function l(a){var b=a.document;b.getById("polaris-page-container");var c=b.getById(n),d=b.getById(n+"_back"),e=b.getById(n+"_face"),f=b.getById(n+"_line"),g=b.getById(q);b.getById(q+"_back");
b.getById(q+"_face");var h=g&&g.hasAttribute("polaris-page")?Number(g.getAttribute("polaris-page")):1,g=a.plugins.pagination.getPageElement(b,h),h=a.plugins.pagination.getPageContentElement(b,h);a.plugins.pagination.isPageOutlineShown();b.getById(n+"_cursor");horizonRulerMargin=b.getById(n+"_margin");a=0==a.ui.zoomType?a.ui.zoomRatio:100;if(c&&null!=g)for(c.setStyle("left",parseFloat(g.getClientRect().left)+"px"),d.setStyle("width",parseFloat(g.getClientRect().width)+"px"),e.setStyle("width",h.getClientRect().width+
"px"),e.setStyle("left",parseFloat(h.getClientRect().left)-parseFloat(g.getClientRect().left)+"px"),f.setStyle("width",parseFloat(g.getClientRect().width)+"px"),horizonRulerMargin.setStyle("left",parseFloat(h.getClientRect().left)-parseFloat(g.getClientRect().left)+"px"),c=0;c<d.getElementsByTag("div").count();c++)e=d.getElementsByTag("div").getItem(c).getAttribute("data-type"),"cursor"!=e&&"margin"!=e&&(e="label"==d.getElementsByTag("div").getItem(c).getAttribute("data-type")?parseFloat(d.getElementsByTag("div").getItem(c).getAttribute("data-left"))*
a/100-.2:parseFloat(d.getElementsByTag("div").getItem(c).getAttribute("data-left"))*a/100,d.getElementsByTag("div").getItem(c).setStyle("left",e+"cm"))}POLARIS.plugins.add("ruler",{requires:"pagination",init:function(b){b.config.wordprocessor&&b.config.showRuler&&(b.on("paginationReady",e),b.on("selectionChange",g),b.on("contentDom",a),b.on("pageResized",f),b.ui.addButton&&b.ui.addButton("Ruler",{label:b.lang.ruler.ruler,command:"showRuler",toolbar:"label_view,50"}),b.addCommand("showRuler",{exec:k,
modes:{wysiwyg:1}}),b.getCommand("showRuler").state=POLARIS.TRISTATE_ON,u=!0,m=POLARIS.getUrl(this.path))}});var m="",n="polaris-horizon-ruler",q="polaris-vertical-ruler",v,r,p,t,w,A,x=0,C=0,u=!1,B=function(a){var b=v,c=b.plugins.pagination.pageInfo,d=parseFloat(c.width.replace("mm","")),e=parseFloat(c.marginLeft.replace("mm","")),c=parseFloat(c.marginRight.replace("mm","")),f=a.data.$.clientX-x,f=parseFloat(t.getStyle("left").replace("cm",""))+f/37.79527559055,g=10*(f+.5);t.setStyle("left",f+"cm");
0>=e+g?y(a):e+g>=d-c?(t.setStyle("left",f-1+"cm"),y(a)):(b.document.getById(n+"_cursor_top").setStyle("background-image","url('"+m+"images/ruler_controller_top_p.png')"),b.document.getById(n+"_cursor_bottom").setStyle("background-image","url('"+m+"images/ruler_controller_bottom_p.png')"),x=a.data.$.clientX)},G=function(a){var b=v;x=a.data.$.clientX;b.document.on("mousemove",B)},y=function(a){if(0!=x){a=v;a.document.removeListener("mousemove",B);a.document.getById(n+"_cursor_top").setStyle("background-image",
"url('"+m+"images/ruler_controller_top_n.png')");a.document.getById(n+"_cursor_bottom").setStyle("background-image","url('"+m+"images/ruler_controller_bottom_n.png')");var b=a.plugins.pagination.pageInfo,c=parseFloat(b.marginLeft.replace("mm","")),d=10*(parseFloat(t.getStyle("left").replace("cm",""))+.5);b.marginLeft=(0<c+d?c+d:0)+"mm";a.plugins.pagination.updatePageStyle(a);t.setStyle("left","-0.5cm");rulerCursorCvt=x=0}},F=function(a){a=v;a.document.getById(n+"_cursor_top").setStyle("background-image",
"url('"+m+"images/ruler_controller_top_p.png')");a.document.getById(n+"_cursor_bottom").setStyle("background-image","url('"+m+"images/ruler_controller_bottom_p.png')")},E=function(a){a=v;a.document.getById(n+"_cursor_top").setStyle("background-image","url('"+m+"images/ruler_controller_top_n.png')");a.document.getById(n+"_cursor_bottom").setStyle("background-image","url('"+m+"images/ruler_controller_bottom_n.png')")},H=function(a){var b=v,c=b.plugins.pagination.pageInfo,d=parseFloat(c.width.replace("mm",
"")),e=parseFloat(c.marginLeft.replace("mm","")),c=parseFloat(c.marginRight.replace("mm","")),f=a.data.$.clientX-C,f=parseFloat(w.getStyle("left").replace("px",""))+f;b.document.getById(n+"_margin_img").setStyle("background-image","url('"+m+"images/ruler_controller_synchronize_bottom_p.png')");w.setStyle("left",f+"px");(f>=3.779527559055*(d-c)||f<=3.779527559055*e)&&I(a);C=a.data.$.clientX},J=function(a){var b=v;C=a.data.$.clientX;A=POLARIS.tools.getSelectedParagraph(b);b.document.removeListener("mousemove",
H);b.document.on("mousemove",H)},I=function(a){if(0!=C){a=v;a.document.removeListener("mousemove",H);a.document.getById(n+"_margin_img").setStyle("background-image","url('"+m+"images/ruler_controller_synchronize_bottom_n.png')");a=(parseFloat(w.getStyle("left").replace("px",""))-parseFloat(p.getStyle("left").replace("px","")))/3.779527559055;if(null!=A)for(var b=0;b<A.length;b++){var c=A[b];(c.type=POLARIS.NODE_ELEMENT&&c.is({ol:1,ul:1,dl:1}))||isNaN(a)||(0<a?c.setStyle("margin-left",a+"mm"):c.removeStyle("margin-left"))}C=
0}},L=function(a){v.document.getById(n+"_margin_img").setStyle("background-image","url('"+m+"images/ruler_controller_synchronize_bottom_p.png')")},z=function(a){v.document.getById(n+"_margin_img").setStyle("background-image","url('"+m+"images/ruler_controller_synchronize_bottom_n.png')")}})();(function(){var a=function(){this.title;this.format};POLARIS.plugins.add("saveas",{lang:"en,ko",init:function(e){e.docInfo=new a;e.ui.add("ExportPdf",POLARIS.UI_BUTTON,{label:e.lang.saveas.exportPdf.title,command:"exportPdf"});
POLARIS.dialog.add("exportPdf",this.path+"dialogs/exportpdf.js");e.addCommand("exportPdf",{exec:function(a,c){a.openDialog("exportPdf")}});POLARIS.dialog.add("saveAs",this.path+"dialogs/saveas.js");e.on("apis.saveDialog",function(a){e.openDialog("saveAs",function(c){c&&(c.presetFileName=a.data.name,c.presetFileFormat=a.data.format,c.callback=a.data.callback)})});e.ui.add("SaveAs",POLARIS.UI_BUTTON,{label:e.lang.saveas.title,command:"saveAs"});e.on("setFileInfo",function(a){e.docInfo.path=a.data.path;
e.docInfo.fileName=a.data.fileName;e.docInfo.format=a.data.format;e.docInfo.isNeedHTMLSaving=a.data.isNeedHTMLSaving;e.docInfo.callbackUserData=a.data.callbackUserData});e.addCommand("saveAs",{editorFocus:!1,readOnly:1,exec:function(a,c){a.docInfo.fileName?(a.showProgress(!0,"save"),a.fire("apis.onSave",{path:a.docInfo.path,fileName:a.docInfo.fileName,format:a.docInfo.format,isNeedHTMLSaving:a.docInfo.isNeedHTMLSaving,callback:c,executeBeforeCallback:function(){a.showProgress(!1,"save")},callbackUserData:a.docInfo.callbackUserData})):
a.openDialog("saveAs",function(c){c&&(c.callback=function(c){a.docInfo.fileName=c.name;a.docInfo.format=c.format;a.fire("apis.onSave",c);a.fire("setTitleBarLabel",c)})})}})}})})();(function(){function a(a){a=a.data;if(/\.bmp$/.test(a.name)){var b=a.image,c=document.createElement("canvas");c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(b,0,0);a.file=c.toDataURL("image/png");a.name=a.name.replace(/\.bmp$/,".png")}}function e(a){var b=a.editor,c=b.config.simpleuploads_maximumDimensions,
d=a.data.image;c.width&&d.width>c.width?(alert(b.lang.simpleuploads.imageTooWide),a.cancel()):c.height&&d.height>c.height&&(alert(b.lang.simpleuploads.imageTooTall),a.cancel())}function b(a){var b="span.SimpleUploadsTmpWrapper\x3espan { top: 50%; margin-top: -0.5em; width: 100%; text-align: center; color: #fff; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); font-size: 50px; font-family: Calibri,Arial,Sans-serif; pointer-events: none; position: absolute; display: inline-block;}";a.simpleuploads_hideImageProgress&&
(b="span.SimpleUploadsTmpWrapper { color:#333; background-color:#fff; padding:4px; border:1px solid #EEE;}");return".SimpleUploadsOverEditor { "+(a.simpleuploads_editorover||"box-shadow: 0 0 10px 1px #999999 inset !important;")+" }a.SimpleUploadsTmpWrapper { color:#333; background-color:#fff; padding:4px; border:1px solid #EEE;}.SimpleUploadsTmpWrapper { display: inline-block; position: relative; pointer-events: none;}"+b+".uploadRect {display: inline-block;height: 0.9em;vertical-align: middle;width: 20px;}.uploadRect span {background-color: #999;display: inline-block;height: 100%;vertical-align: top;}.SimpleUploadsTmpWrapper .uploadCancel { background-color: #333333;border-radius: 0.5em;color: #FFFFFF;cursor: pointer !important;display: inline-block;height: 1em;line-height: 0.8em;margin-left: 4px;padding-left: 0.18em;pointer-events: auto;position: relative; text-decoration:none; top: -2px;width: 0.7em;}.SimpleUploadsTmpWrapper span uploadCancel { width:1em; padding-left:0}"}
function c(a,b,c,e){if(y)alert("Please, wait to finish the current upload");else if(G=!b,B=a,"undefined"==typeof FormData){var f=document.getElementById("simpleUploadsTarget");f||(f=document.createElement("iframe"),f.style.display="none",f.id="simpleUploadsTarget",document.body.appendChild(f));F=c;E=e;H=b;c=a._.simpleuploadsFormUploadFn;e=a._.simpleuploadsFormInitFn;c||(a._.simpleuploadsFormUploadFn=c=POLARIS.tools.addFunction(h,a),a._.simpleuploadsFormInitFn=e=POLARIS.tools.addFunction(function(){window.setTimeout(function(){var b=
document.getElementById("simpleUploadsTarget").contentWindow.document.getElementById(a.config.simpleuploads_inputname||"upload");H?b.removeAttribute("accept"):b.accept=".txt,.rtf,.doc,.dot,.docx,.doctx,.ppt,.pot,.pps,.pptx,.potx,.ppsx,.xls,.xlt,.csv,.xlsx,.xltx,.hwp,.pdf,.odt";b.onchange=function(){var b={name:this.value,url:this.form.action,context:F,id:"IEUpload",requiresImage:H},c=b.name.match(/\\([^\\]*)$/);c&&(b.name=c[1]);if("boolean"!=typeof B.fire("simpleuploads.startUpload",b))if(b.requiresImage&&
!POLARIS.plugins.simpleuploads.isImageExtension(B,b.name))alert(B.lang.simpleuploads.nonImageExtension);else if(b.requiresImage||POLARIS.plugins.simpleuploads.isDocumentExtension(B,b.name))if(b.context.data&&b.context.data.dialog.definition.title==a.lang.flash.title&&0==POLARIS.plugins.simpleuploads.isFlashExtension(B,b.name))alert(a.lang.simpleuploads.nonFlashExtension);else{E&&E.start&&E.start(b);y=this.value;this.form.action=b.url;if(b.extraFields){var b=b.extraFields,c=this.ownerDocument,d;for(d in b)if(b.hasOwnProperty(d)){var e=
c.createElement("input");e.type="hidden";e.name=d;e.value=b[d];this.form.appendChild(e)}}this.form.submit()}else alert(B.lang.simpleuploads.nonDocumentExtension)};b.click()},100)},a),a.on("destroy",function(){POLARIS.tools.removeFunction(this._.simpleuploadsFormUploadFn);POLARIS.tools.removeFunction(this._.simpleuploadsFormInitFn)}));var g=a.config.simpleuploads_inputname||"upload";b='document.open(); document.write("'+("\x3cform method\x3d'post' enctype\x3d'multipart/form-data' action\x3d'"+d(a,
c,b)+"'\x3e\x3cinput type\x3d'file' name\x3d'"+g+"' id\x3d'"+g+"'\x3e\x3c/form\x3e")+'");document.close();window.parent.POLARIS.tools.callFunction('+e+");";f.src="javascript:void(function(){"+encodeURIComponent(b)+"}())";f.onreadystatechange=function(){"complete"==f.readyState&&window.setTimeout(function(){y&&(alert("The file upload has failed"),y=null)},100)};u=null}else{u||(u=document.createElement("input"),u.type="file",u.id="fileInput",u.style.overflow="hidden",u.style.width="1px",u.style.height=
"1px",u.style.opacity=.1,u.position="absolute",u.zIndex=1E3,document.body.appendChild(u),u.addEventListener("change",function(){var b=u.files.length;if(b){B.fire("saveSnapshot");for(var c=0;c<b;c++){var d=u.files[c],e=POLARIS.tools.extend({},u.simpleUploadData);if(1==u.isDocument&&!POLARIS.plugins.simpleuploads.isDocumentExtension(a,d.name)){alert(a.lang.simpleuploads.nonDocumentExtension);break}if(POLARIS.plugins.simpleuploads.isImageExtension(a,d.name)){var f=new Image;f.src=URL.createObjectURL(d);
f.onload=function(){var b=POLARIS.plugins.simpleuploads.adjustImageSize(a,this.width,this.height),c=POLARIS.dialog.getCurrent(),d=c._.name;"image"==d.substr(0,5)&&(c.getContentElement("info","txtWidth").setValue(b.width),c.getContentElement("info","txtHeight").setValue(b.height));1==a.config.useImageBase64Encoding&&("cellProperties"==d.substr(0,14)||"pageoutlinebg"==d.substr(0,13)?(J=this.width,I=this.height):I=J=void 0);void 0!=c.dontResetSize&&(c.dontResetSize=!0)}}y=d.name;e.file=d;e.name=d.name;
e.id=POLARIS.plugins.simpleuploads.getTimeStampId();e.forceLink=G;e.mode={type:"selectedFile",i:c,count:b};POLARIS.plugins.simpleuploads.insertSelectedFile(B,e)}}}));u.value="";b?(u.removeAttribute("accept"),u.isDocument=!1):(u.accept=".txt,.rtf,.doc,.dot,.docx,.doctx,.ppt,.pot,.pps,.pptx,.potx,.ppsx,.xls,.xlt,.csv,.xlsx,.xltx,.hwp,.pdf,.odt",u.isDocument=!0);u.simpleUploadData={context:c,callback:e,requiresImage:b};if(POLARIS.env.webkit){var k=a.focusManager;k&&k.lock&&(k.lock(),setTimeout(function(){k.unlock()},
500))}u.click()}}function d(a,b,c){c=c?a.config.filebrowserImageUploadUrl:a.config.filebrowserUploadUrl;if("base64"==c||0<c.indexOf("?"))return c;var d={};d.POLARISEditor=a.name;d.POLARISEditorFuncNum=b;d.langCode=a.langCode;var e;a=[];if(d){for(e in d)a.push(e+"\x3d"+encodeURIComponent(d[e]));e=c+(-1!=c.indexOf("?")?"\x26":"?")+a.join("\x26")}else e=c;return e}function h(a,b,c,d,e){"string"==typeof b&&b&&!a&&alert(b);var g=B;g.fire("simpleuploads.endUpload",{name:y,ok:!!a});if(E)E.upload(a,b,{context:F}),
E=y=null;else{if(a){var h;if(G){d=(d/1048576).toFixed(2)+"M";b=$component.getComponentById("insert-file");var k=y,k=k.substring(k.lastIndexOf("\\")+1);b.files.push({name:k,size:d,path:a,delPath:c,fileId:e});b.$update();b.setDelegate({showDocument:function(a){window.open(a.path)},deleteDocument:function(a){var b=new XMLHttpRequest;b.open("POST",a.delPath,!0);b.onload=function(){};b.onerror=function(a){};b.onreadystatechange=function(){};b.send(null)}});B.fire("simpleuploads.finishedUpload",{name:y,
element:h})}else h=new POLARIS.dom.element("img",g.document),h.on("load",function(a){a.removeListener();h.removeListener("error",f);h.setAttribute("width",h.$.width);h.setAttribute("height",h.$.height);g.fire("simpleuploads.finishedUpload",{name:y,element:h})}),h.on("error",f,null,h),h.setAttribute("src",a),h.data("polaris-saved-src",a),g.insertElement(h)}y=null}F=null}function g(a){return(a=a.data.$.dataTransfer)&&a.types?a.types.contains&&a.types.contains("Files")&&!a.types.contains("text/html")||
a.types.indexOf&&-1!=a.types.indexOf("Files")?!0:!1:!1}function k(a,b,c,d,e){if("span"==d.$.nodeName.toLowerCase()){var g;b.originalNode?(g=b.originalNode.cloneNode(!0),g.removeAttribute("width"),g.removeAttribute("height"),g.style.width="",g.style.height="",g=new POLARIS.dom.element(g)):g=new POLARIS.dom.element("img",c.document);g.data("polaris-saved-src",a);c.getCommand("showImageBorder").state==POLARIS.TRISTATE_OFF?g.addClass("polaris_img_border"):g.setAttribute("src",a);g.setAttribute("ondragstart",
"return false");b.size&&(a=b.size.width,e=b.size.height,a&&g.setStyle("width",a),e&&g.setStyle("height",e));g.on("load",function(a){a.removeListener();g.removeListener("error",f);l(g,c,d,b.name)});g.on("error",f,null,d);d.data("polaris-real-element-type","img");d.data("polaris-realelement",encodeURIComponent(g.getOuterHtml()));d.data("polaris-real-node-type",POLARIS.NODE_ELEMENT)}else{if(b.originalNode){var h=b.originalNode.cloneNode(!0);d.$.parentNode.replaceChild(h,d.$);d=new POLARIS.dom.element(h)}else d.removeAttribute("id"),
d.removeAttribute("class"),d.removeAttribute("contentEditable"),d.setHtml(d.getFirst().getHtml());d.data("polaris-saved-"+e,a);d.setAttribute(e,a);c.fire("simpleuploads.finishedUpload",{name:b.name,element:d})}}function f(a){a.removeListener();alert("Failed to load the image with the provided URL: '"+a.sender.data("polaris-saved-src")+"'");a.listenerData.remove()}function l(a,b,c,d){0===a.$.naturalWidth?window.setTimeout(function(){l(a,b,c,d)},50):(a.replace(c),a.getStyle("width")||a.getStyle("height")||
(a.setAttribute("width",a.$.width),a.setAttribute("height",a.$.height)),b.fire("simpleuploads.finishedUpload",{name:d,element:a}),b.fire("updateSnapshot"))}function m(a,b){var c=POLARIS.plugins.simpleuploads.isImageExtension(a,b.name),e="href",f=!1;!b.forceLink&&c&&(e="src",f=!0);b.callback&&b.callback.setup(b);var g=a.fire("apis.onBeforeUpload",{type:f?"image":"file",file:b.file});g&&(b.url=g.url,g.formData&&(b.extraFields=g.formData),g.headers&&(b.extraHeaders=g.headers));b.url||(b.url=d(a,2,f));
if(b.requiresImage&&!c)return b.context.data.dialog.definition.title==a.lang.flash.title?alert(a.lang.simpleuploads.nonFlashExtension):alert(a.lang.simpleuploads.nonImageExtension),y=null;if(c&&1==POLARIS.plugins.simpleuploads.isFlashExtension(a,b.name))return alert(a.lang.simpleuploads.nonImageExtension),y=null;if(b.context.data&&b.context.data.dialog.definition.title==a.lang.flash.title&&0==POLARIS.plugins.simpleuploads.isFlashExtension(a,b.name))return alert(a.lang.simpleuploads.nonFlashExtension),
y=null;if("boolean"==typeof a.fire("simpleuploads.startUpload",b))return y=null;if("base64"==b.url){if("string"==typeof b.file)setTimeout(function(){var c=b.file,d=a.document.getById(b.id);k(c,b,a,d,e)},100);else{var h=new FileReader;h.onload=function(){setTimeout(function(){var c=h.result,d=a.document.getById(b.id);d&&k(c,b,a,d,e);b.callback&&(1==a.config.useImageBase64Encoding&&(200<J||200<I)?alert(a.lang.simpleuploads.cannotInsertEncodedImage):b.callback.upload(c,"",b))},100)};h.readAsDataURL(b.file)}F=
y=null;return{}}var l=new XMLHttpRequest;if(c=l.upload)c.onprogress=function(c){q(a,b.id,c)};b.xhr=l;l.open("POST",b.url);l.onload=function(){setTimeout(function(){var c=b.id,d=a.document.getById(c),g,h,m=POLARIS.plugins.simpleuploads.isImageExtension(a,b.name);q(a,c,null);a.fire("updateSnapshot");c={xhr:l,data:b,element:d};if("boolean"!=typeof a.fire("simpleuploads.serverResponse",c)){a.fire("simpleuploads.endUpload",{name:b.name,ok:!!g,xhr:l,data:b});if(200==l.status)if("undefined"==typeof c.url){g=
a.fire("apis.onAfterUpload",{type:f?"image":"file",result:l.responseText,filename:y});if(!f)return;if("string"!=typeof g||0!=g.indexOf("http"))h="Error posting the file to "+b.url+"\r\nInvalid data returned (check console)",POLARIS.log.plugin(l.responseText)}else g=c.url,h="";else 413==l.status?alert(a.lang.simpleuploads.fileTooBig):(alert("Error posting the file to "+b.url+"\r\nResponse status: "+l.status),POLARIS.log.plugin(l));y=null;b.callback?(!g&&h&&alert(h),b.callback.upload(g,h,b)):(g?1==
m&&d&&"a"!=d.$.nodeName.toLowerCase()&&k(g,b,a,d,e):(b.originalNode?d.$.parentNode.replaceChild(b.originalNode,d.$):d.remove(),h&&alert(h)),a.fire("updateSnapshot"))}},500)};l.onerror=function(c){alert("Error posting the file to "+b.url);POLARIS.log.plugin(c);(c=a.document.getById(b.id))&&(b.originalNode?c.$.parentNode.replaceChild(b.originalNode,c.$):c.remove());a.fire("updateSnapshot")};l.onabort=function(c){b.callback?b.callback.upload(null):((c=a.document.getById(b.id))&&(b.originalNode?c.$.parentNode.replaceChild(b.originalNode,
c.$):c.remove()),a.fire("updateSnapshot"))};return l}function n(a,b){if(!b.callback){var c=POLARIS.plugins.simpleuploads.isImageExtension(a,b.name),d=!a.config.simpleuploads_hideImageProgress;0==c||c&&b.forceLink||(!b.forceLink&&c&&d?c=v(b.file,b.id,a):(c=c&&!b.forceLink?new POLARIS.dom.element("span",a.document):new POLARIS.dom.element("a",a.document),c.setAttribute("id",b.id),c.setAttribute("class","SimpleUploadsTmpWrapper"),c.setHtml("\x3cspan class\x3d'uploadName'\x3e"+b.name+"\x3c/span\x3e \x3cspan class\x3d'uploadRect'\x3e\x3cspan id\x3d'rect"+
b.id+"'\x3e\x3c/span\x3e\x3c/span\x3e \x3cspan id\x3d'text"+b.id+"' class\x3d'uploadText'\x3e \x3c/span\x3e\x3cspan class\x3d'uploadCancel'\x3ex\x3c/span\x3e")),c.setAttribute("contentEditable",!1),b.element=c)}c=m(a,b);if(!c)return b.result=b.result||"",!1;if(!c.send)return!0;b.callback&&b.callback.start&&b.callback.start(b);d=b.inputName||a.config.simpleuploads_inputname||"upload";if("string"==typeof b.file){var e="-----------------------------1966284435497298061834782736",f=b.name.match(/\.(\w+)$/)[1],
e=e+('\r\nContent-Disposition: form-data; name\x3d"'+d+'"; filename\x3d"'+b.name+'"'),e=e+("\r\nContent-type: image/"+f)+("\r\n\r\n"+window.atob(b.file.split(",")[1])),e=e+"\r\n-----------------------------1966284435497298061834782736";if(b.extraFields){var f=b.extraFields,g;for(g in f)e+='\r\nContent-Disposition: form-data; name\x3d"'+unescape(encodeURIComponent(g)).replace(/=/g,"\\\x3d")+'"',e+="\r\n\r\n"+unescape(encodeURIComponent(f[g])),e+="\r\n-----------------------------1966284435497298061834782736"}e+=
"--";c.setRequestHeader("Content-Type","multipart/form-data; boundary\x3d---------------------------1966284435497298061834782736");g=new ArrayBuffer(e.length);g=new Uint8Array(g,0);for(f=0;f<e.length;f++)g[f]=e.charCodeAt(f)&255}else{g=new FormData;g.append(d,b.file,b.name);if(b.extraFields)for(f in d=b.extraFields,d)d.hasOwnProperty(f)&&g.append(f,d[f]);if(b.extraHeaders)for(e in f=b.extraHeaders,f)f.hasOwnProperty(e)&&f[e]&&c.setRequestHeader(e,f[e])}c.send(g);return!0}function q(a,b,c){if(a.document&&
a.document.$){var d=(POLARIS.dialog.getCurrent()?POLARIS:a).document.$,e=d.getElementById("rect"+b);b=d.getElementById("text"+b);if(c){if(!c.lengthComputable)return;d=(100*c.loaded/c.total).toFixed(2)+"%";a=(100*c.loaded/c.total).toFixed()+"%"}else a=a.lang.simpleuploads.processing,d="100%";e&&(e.setAttribute("width",d),e.style.width=d,c||(e=e.parentNode)&&"uploadRect"==e.className&&e.parentNode.removeChild(e));b&&(b.firstChild.nodeValue=a,c||(c=b.nextSibling)&&"a"==c.nodeName.toLowerCase()&&c.parentNode.removeChild(c))}}
function v(a,b,c){var d=new POLARIS.dom.element("span",c.document),e=d.$,f,g=c.document.$;c=g.createElement("span");d.setAttribute("id",b);d.setAttribute("class","SimpleUploadsTmpWrapper");var h=g.createElement("span");h.setAttribute("id","text"+b);h.appendChild(g.createTextNode("0 %"));e.appendChild(c);c.appendChild(h);h=g.createElement("span");h.appendChild(g.createTextNode("x"));c.appendChild(h);if("string"!=typeof a){if(!L||!L.revokeObjectURL)return d;f=!0}c=g.createElementNS("http://www.w3.org/2000/svg",
"svg");c.setAttribute("id","svg"+b);h=g.createElement("img");f?(h.onload=function(a){this.onload&&(L.revokeObjectURL(this.src),this.onload=null);if(a=g.getElementById("svg"+b))a.setAttribute("width",this.width+"px"),a.setAttribute("height",this.height+"px");if(a=g.getElementById(b))a.style.width=this.width+"px"},h.src=L.createObjectURL(a)):(h.src=a,h.onload=function(a){this.onload=null;if(a=g.getElementById("svg"+b))a.setAttribute("width",this.width+"px"),a.setAttribute("height",this.height+"px")},
c.setAttribute("width",h.width+"px"),c.setAttribute("height",h.height+"px"));e.appendChild(c);e=g.createElementNS("http://www.w3.org/2000/svg","filter");e.setAttribute("id","SVGdesaturate");c.appendChild(e);h=g.createElementNS("http://www.w3.org/2000/svg","feColorMatrix");h.setAttribute("type","saturate");h.setAttribute("values","0");e.appendChild(h);e=g.createElementNS("http://www.w3.org/2000/svg","clipPath");e.setAttribute("id","SVGprogress"+b);c.appendChild(e);h=g.createElementNS("http://www.w3.org/2000/svg",
"rect");h.setAttribute("id","rect"+b);h.setAttribute("width","0");h.setAttribute("height","100%");e.appendChild(h);var k=g.createElementNS("http://www.w3.org/2000/svg","image");k.setAttribute("width","100%");k.setAttribute("height","100%");if(f){k.setAttributeNS("http://www.w3.org/1999/xlink","href",L.createObjectURL(a));var l=function(a){L.revokeObjectURL(k.getAttributeNS("http://www.w3.org/1999/xlink","href"));k.removeEventListener("load",l,!1)};k.addEventListener("load",l,!1)}else k.setAttributeNS("http://www.w3.org/1999/xlink",
"href",a);a=k.cloneNode(!0);k.setAttribute("filter","url(#SVGdesaturate)");k.style.opacity="0.5";c.appendChild(k);a.setAttribute("clip-path","url(#SVGprogress"+b+")");c.appendChild(a);return d}function r(a,b,d,e){if("file"!=e.type){var f="image"==b.substr(0,5)||"Image"==b.substr(2,7)||"flash"==b.substr(0,5)||"cellProperties"==b.substr(0,14)||"table"==b.substr(0,5)||"tableProperties"==b.substr(0,15)||e.requiresImage||"pageoutlinebg"==b,g=e.filebrowser.target.split(":"),h={setup:function(a){d.uploadUrl&&
f&&(a.requiresImage=!0)},start:function(a){var b=POLARIS.dialog.getCurrent();b.showThrobber();var c=b.throbber;if(a.xhr){c.throbberTitle.setHtml("\x3cspan class\x3d'uploadName'\x3e"+a.name+"\x3c/span\x3e \x3cspan class\x3d'uploadRect'\x3e\x3cspan id\x3d'rect"+a.id+"'\x3e\x3c/span\x3e\x3c/span\x3e \x3cspan id\x3d'text"+a.id+"' class\x3d'uploadText'\x3e \x3c/span\x3e\x3ca\x3ex\x3c/a\x3e");var d=c.throbberCover,e=a.xhr;d.timer&&(clearInterval(d.timer),d.timer=null);c.throbberParent.setStyle("display",
"none");c.throbberTitle.getLast().on("click",function(){e.abort()});b.on("hide",function(){1==e.readyState&&e.abort()})}c.center()},upload:function(b,c,e){var f=POLARIS.dialog.getCurrent();f.throbber&&f.throbber.hide();"function"==typeof c&&!1===c.call(e.context.sender)||d.onFileSelect&&!1===d.onFileSelect.call(e.context.sender,b,c)||!b||("string"!==typeof b&&0==JSON.parse(b.result).success?(alert("The file upload has failed"),f.hide()):"image"==f.getName().substr(0,5)?a.fire("imgPathChanged",b):
(f.getContentElement(g[0],g[1]).setValue(b),f.selectPage(g[0])))}};if("QuickUpload"==e.filebrowser.action)d.hasQuickUpload=!0,d.onFileSelect=null,a.config.simpleuploads_respectDialogUploads||(e.label=f?"flash"!=b.substr(0,5)?a.lang.simpleuploads.addImage:a.lang.simpleuploads.addFlash:a.lang.simpleuploads.addFile,e.onClick=function(b){c(a,f,b,h);return!1},d.getContents(e["for"][0]).get(e["for"][1]).hidden=!0);else{if(d.hasQuickUpload)return;e.filebrowser.onSelect&&(d.onFileSelect=e.filebrowser.onSelect)}a.plugins.fileDropHandler&&
("QuickUpload"==e.filebrowser.action&&(d.uploadUrl=e.filebrowser.url),d.onShow=POLARIS.tools.override(d.onShow||function(){},function(a){return function(){"function"==typeof a&&a.call(this);"QuickUpload"!=e.filebrowser.action&&d.hasQuickUpload||this.handleFileDrop||(this.handleFileDrop=!0,this.getParentEditor().plugins.fileDropHandler.addTarget(this.parts.contents,h))}}))}}function p(a,b,c,d){for(var e in d){var f=d[e];f&&("hbox"!=f.type&&"vbox"!=f.type&&"fieldset"!=f.type||p(a,b,c,f.children),f.filebrowser&&
f.filebrowser.url&&r(a,b,c,f))}}function t(a,b){var c=a.document.getById(b.id);if(c){var d=c.$.getElementsByTagName("a");if(!d||!d.length)if(d=c.$.getElementsByTagName("span"),!d||!d.length)return;for(c=0;c<d.length;c++){var e=d[c];"x"==e.innerHTML&&(e.className="uploadCancel",e.onclick=function(){b.xhr&&b.xhr.abort()})}}}function w(a){var b=a.listenerData.editor,c=a.listenerData.dialog,d,e;if(d=a.data&&a.data.$.clipboardData||b.config.forcePasteAsPlainText&&window.clipboardData)if(POLARIS.env.gecko&&
b.config.forcePasteAsPlainText&&0===d.types.length)b.on("beforePaste",function(a){a.removeListener();a.data.type="html"});else{var f=d.items,g=d.files;if((f&&f.length||g&&g.length)&&(!POLARIS.env.chrome||!c||c.parts.title.$.innerText!=b.lang.pastetext.title&&c.parts.title.$.innerText!=b.lang.pastefromword.title||1!=f.length||"file"!=f[0].kind)){if(f&&f.length&&f[0].kind)for(d=0;d<f.length;d++)if(e=f[d],"string"==e.kind&&("text/html"==e.type||"text/plain"==e.type))return;if(g&&g.length)for(d=0;d<g.length;d++){var h=
g[d];h&&0!=h.size&&(a.data.preventDefault(),POLARIS.env.ie||b.config.forcePasteAsPlainText?setTimeout(function(){A(h,a)},100):A(h,a))}else if(f&&f.length)for(d=0;d<f.length;d++)if(e=f[d],!e.kind||"file"==e.kind)if(h=e.getAsFile?e.getAsFile():null)a.data.preventDefault(),POLARIS.env.ie||b.config.forcePasteAsPlainText?setTimeout(function(){A(h,a)},100):A(h,a);c&&a.data.$.defaultPrevented&&c.hide()}}}function A(a,b){var c=b.listenerData.editor,d=b.listenerData.dialog,e=POLARIS.plugins.simpleuploads.getTimeStampId();
POLARIS.plugins.simpleuploads.insertPastedFile(c,{context:b.data.$,name:a.name||e+".png",file:a,forceLink:!1,id:e,mode:{type:"pastedFile",dialog:d}})}function x(a){var b=a.getFrameDocument(),c=b.getBody();!c||!c.$||"true"!=c.$.contentEditable&&"on"!=b.$.designMode?setTimeout(function(){x(a)},100):(c=POLARIS.dialog.getCurrent(),b.on("paste",w,null,{dialog:c,editor:c.getParentEditor()}))}var C={elements:{$:function(a){a=a.attributes;if("SimpleUploadsTmpWrapper"==(a&&a["class"]))return!1}}},u,B,G,y,
F,E,H,J,I,L=window.URL||window.webkitURL;POLARIS.plugins.add("simpleuploads",{lang:["en","ko"],onLoad:function(){POLARIS.addCss&&POLARIS.addCss(b(POLARIS.config));var a=POLARIS.document.getHead().append("style");a.setAttribute("type","text/css");var c=".SimpleUploadsOverContainer {"+(POLARIS.config.simpleuploads_containerover||"box-shadow: 0 0 10px 1px #99DD99 !important;")+"} .SimpleUploadsOverDialog {"+(POLARIS.config.simpleuploads_dialogover||"box-shadow: 0 0 10px 4px #999999 inset !important;")+
"} .SimpleUploadsOverCover {"+(POLARIS.config.simpleuploads_coverover||"box-shadow: 0 0 10px 4px #99DD99 !important;")+"} ",c=c+".polaris_throbber {margin: 0 auto; width: 100px;} .polaris_throbber div {float: left; width: 8px; height: 9px; margin-left: 2px; margin-right: 2px; font-size: 1px;} .polaris_throbber .polaris_throbber_1 {background-color: #737357;} .polaris_throbber .polaris_throbber_2 {background-color: #8f8f73;} .polaris_throbber .polaris_throbber_3 {background-color: #abab8f;} .polaris_throbber .polaris_throbber_4 {background-color: #c7c7ab;} .polaris_throbber .polaris_throbber_5 {background-color: #e3e3c7;} .uploadRect {display: inline-block;height: 11px;vertical-align: middle;width: 50px;} .uploadRect span {background-color: #999;display: inline-block;height: 100%;vertical-align: top;} .uploadName {display: inline-block;max-width: 180px;overflow: hidden;text-overflow: ellipsis;vertical-align: top;white-space: pre;} .uploadText {font-size:80%;} .polaris_throbberMain a {cursor: pointer; font-size: 14px; font-weight:bold; padding: 4px 5px;position: absolute;right:0; text-decoration:none; top: -2px;} .polaris_throbberMain {background-color: #FFF; border:1px solid #e5e5e5; padding:4px 14px 4px 4px; min-width:250px; position:absolute;}";
POLARIS.env.ie&&11>POLARIS.env.version?a.$.styleSheet.cssText=c:a.$.innerHTML=c},init:function(d){var f=d.config;"undefined"==typeof f.simpleuploads_imageExtensions&&(f.simpleuploads_imageExtensions="jpe?g|gif|png|bmp|swf");"undefined"==typeof f.simpleuploads_documentExtensions&&(f.simpleuploads_documentExtensions="txt|rtf|doc?x|dot?x|ppt?x|pot?x|pps?x|xls?x|xlt?x|csv|hwp|pdf|odt");"undefined"==typeof f.simpleuploads_flashExtensions&&(f.simpleuploads_flashExtensions="swf");d.addCss&&d.addCss(b(f));
f.filebrowserImageUploadUrl||(f.filebrowserImageUploadUrl=f.filebrowserUploadUrl);if(!f.filebrowserUploadUrl&&!f.filebrowserImageUploadUrl)POLARIS.log.plugin("The editor is missing the 'config.filebrowserUploadUrl' entry to know the URL that will handle uploaded files.\r\n");else if("base64"!=f.filebrowserImageUploadUrl||"undefined"!=typeof FormData){d.addFeature&&d.addFeature({allowedContent:"img[!src,width,height];a[!href];span[id](SimpleUploadsTmpWrapper);"});POLARIS.dialog.prototype.showThrobber=
function(){this.throbber||(this.throbber={update:function(){for(var a=this.throbberParent.$,b=a.childNodes,a=a.lastChild.className,c=b.length-1;0<c;c--)b[c].className=b[c-1].className;b[0].className=a},create:function(a){if(!this.throbberCover){var b=POLARIS.dom.element.createFromHtml('\x3cdiv style\x3d"background-color:rgba(255,255,255,0.95);width:100%;height:100%;top:0;left:0; position:absolute; visibility:none;z-index:100;"\x3e\x3c/div\x3e');a.parts.close.setStyle("z-index",101);POLARIS.env.ie&&
9>POLARIS.env.version&&(b.setStyle("zoom",1),b.setStyle("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr\x3d#EEFFFFFF,endColorstr\x3d#EEFFFFFF)"));b.appendTo(a.parts.dialog);this.throbberCover=b;var c=new POLARIS.dom.element("div");this.mainThrobber=c;var d=new POLARIS.dom.element("div");this.throbberParent=d;var e=new POLARIS.dom.element("div");this.throbberTitle=e;b.append(c).addClass("polaris_throbberMain");c.append(e).addClass("polaris_throbberTitle");c.append(d).addClass("polaris_throbber");
for(b=[1,2,3,4,5,4,3,2];0<b.length;)d.append(new POLARIS.dom.element("div")).addClass("polaris_throbber_"+b.shift());this.center();a.on("hide",this.hide,this)}},center:function(){var a=this.mainThrobber,b=this.throbberCover,c=(b.$.offsetHeight-a.$.offsetHeight)/2;a.setStyle("left",((b.$.offsetWidth-a.$.offsetWidth)/2).toFixed()+"px");a.setStyle("top",c.toFixed()+"px")},show:function(){this.create(POLARIS.dialog.getCurrent());this.throbberCover.setStyle("visibility","");this.timer=setInterval(POLARIS.tools.bind(this.update,
this),100)},hide:function(){this.timer&&(clearInterval(this.timer),this.timer=null);this.throbberCover&&this.throbberCover.setStyle("visibility","hidden")}});this.throbber.show()};d.on("simpleuploads.startUpload",function(a){var b=a.editor,c=b.config,d=a.data&&a.data.file;c.fileUploadMaxFileSize&&d&&d.size&&d.size>c.fileUploadMaxFileSize&&(alert(b.lang.simpleuploads.fileTooBig),a.cancel());d=a.data.name;c.simpleuploads_invalidExtensions&&(new RegExp(".(?:"+c.simpleuploads_invalidExtensions+")$","i")).test(d)&&
(alert(b.lang.simpleuploads.invalidExtension),a.cancel());c.simpleuploads_acceptedExtensions&&!(new RegExp(".(?:"+c.simpleuploads_acceptedExtensions+")$","i")).test(d)&&(alert(b.lang.simpleuploads.nonAcceptedExtension.replace("%0",c.simpleuploads_acceptedExtensions)),a.cancel())});d.on("simpleuploads.startUpload",function(a){var b=a.data,c=a.editor;if(!b.image&&!b.forceLink&&POLARIS.plugins.simpleuploads.isImageExtension(c,b.name)&&b.mode&&b.mode.type&&c.hasListeners("simpleuploads.localImageReady")){a.cancel();
if("base64paste"==b.mode.type){var d=POLARIS.plugins.simpleuploads.getTimeStampId();b.result="\x3cspan id\x3d'"+d+"' class\x3d'SimpleUploadsTmpWrapper' style\x3d'display:none'\x3e\x26nbsp;\x3c/span\x3e";b.mode.id=d}var e=new Image;e.onload=function(){var d=POLARIS.tools.extend({},b);d.image=e;"boolean"!=typeof c.fire("simpleuploads.localImageReady",d)&&POLARIS.plugins.simpleuploads.insertProcessedFile(a.editor,d)};e.src="string"==typeof b.file?b.file:L.createObjectURL(b.file)}});if(f.simpleuploads_convertBmp)d.on("simpleuploads.localImageReady",
a);if(f.simpleuploads_maximumDimensions)d.on("simpleuploads.localImageReady",e);d.on("simpleuploads.finishedUpload",function(a){if(d.widgets&&d.plugins.image2&&(a=a.data.element,"img"==a.getName())){var b=d.widgets.getByElement(a);b?(b.data.src=a.data("polaris-saved-src"),b.data.width=a.$.width,b.data.height=a.$.height):(d.widgets.initOn(a,"image2"),d.widgets.initOn(a,"image"))}});d.on("paste",function(a){var b=a.data;if(b=b.html||b.type&&"html"==b.type&&b.dataValue)POLARIS.env.webkit&&0<b.indexOf("webkit-fake-url")&&
(alert("Sorry, the images pasted with Safari aren't usable"),window.open("https://bugs.webkit.org/show_bug.cgi?id\x3d49141"),b=b.replace(/<img src="webkit-fake-url:.*?">/g,"")),b=b.replace(/<img(.*?) src="data:image\/.{3,4};base64,.*?"(.*?)>/g,function(b){if(!d.config.filebrowserImageUploadUrl)return"";var c=b.match(/"(data:image\/(.{3,4});base64,.*?)"/),e=c[1],c=c[2].toLowerCase(),f=POLARIS.plugins.simpleuploads.getTimeStampId();if(128>e.length)return b;"jpeg"==c&&(c="jpg");var g=b.match(/style="(.*?)"/g);
b=g?g[0].match(/(?:[\s;]{1}|^)width\s*:\s*([^;]*)/):null;var g=g?g[0].match(/(?:[\s;]{1}|^)height\s*:\s*([^;]*)/):null,h={context:"pastedimage",name:f+"."+c,id:f,forceLink:!1,file:e,mode:{type:"base64paste"},size:{width:b?b[1]:"",height:g?g[1]:""}};a.editor.showProgress(!0,"simpleUpload");a.editor.fire("pausePagination");if(!n(d,h))return h.result;var e=h.element,k=e.$.innerHTML;e.$.innerHTML="\x26nbsp;";d.on("afterPaste",function(b){b.removeListener();var c=d.document.$.getElementById(f);c&&(c.innerHTML=
k,t(d,h));b.editor.showProgress(!1,"simpleUpload");0==b.editor.showProgress(null,"simpleUpload",null,!0)&&(a.editor.fire("resumePagination"),a.editor.fire("change"),a.editor.fire("contentChange",{type:"paste"}))});return e.getOuterHtml()}),d.hasListeners("apis.onPasteHtml")&&(b=d.fire("apis.onPasteHtml",{html:b})),a.data.html?a.data.html=b:a.data.dataValue=b});var f=function(a){if("wysiwyg"==d.mode){var b=d.document;d.editable&&(b=d.editable());b.$.querySelector(".SimpleUploadsTmpWrapper")&&(a=a.name.substr(5).toLowerCase(),
"redo"==a&&d.getCommand(a).state==POLARIS.TRISTATE_DISABLED&&(a="undo"),d.execCommand(a))}},h=d.getCommand("undo");h&&h.on("afterUndo",f);(h=d.getCommand("redo"))&&d.getCommand("redo").on("afterRedo",f);d.on("afterUndo",f);d.on("afterRedo",f);d.addCommand("addFile",{exec:function(a){c(a,!1,this)}});d.ui.addButton("addFile",{label:d.lang.simpleuploads.addFile,command:"addFile",toolbar:"insert",allowedContent:"a[!href];span[id](SimpleUploadsTmpWrapper);",requiredContent:"a[href]"});d.addCommand("addImage",
{exec:function(a){c(a,!0,this)}});d.addCommand("clearFilePicker",{exec:function(a){u&&(u.parentNode&&u.parentNode.removeChild(u),u=null)}});d.ui.addButton("addImage",{label:d.lang.simpleuploads.addImage,command:"addImage",toolbar:"insert",allowedContent:"img[!src,width,height];span[id](SimpleUploadsTmpWrapper);",requiredContent:"img[src]"});if("undefined"!=typeof FormData){var k,l,m,p=-1,q,r,v,x=-1,y,C,B,A=function(){var a=POLARIS.dialog.getCurrent();a?a.parts.title.getParent().removeClass("SimpleUploadsOverCover"):
d.container.removeClass("SimpleUploadsOverContainer")};d.on("destroy",function(){POLARIS.removeListener("simpleuploads.droppedFile",A);POLARIS.document.removeListener("dragenter",F);POLARIS.document.removeListener("dragleave",G);E()});var E=function(){k&&k.removeListener&&(m.removeListener("paste",w),k.removeListener("dragenter",I),k.removeListener("dragleave",J),k.removeListener("dragover",pa),k.removeListener("drop",H),l=k=m=null)};POLARIS.on("simpleuploads.droppedFile",A);var F=function(a){if(-1==
x&&g(a)){if(a=POLARIS.dialog.getCurrent()){if(!a.handleFileDrop)return;a.parts.title.getParent().addClass("SimpleUploadsOverCover")}else d.readOnly||d.container.addClass("SimpleUploadsOverContainer");y=x=0;C=POLARIS.document.$.body.parentNode.clientWidth;B=POLARIS.document.$.body.parentNode.clientHeight}},G=function(a){-1!=x&&(a=a.data.$,a.clientX<=x||a.clientY<=y||a.clientX>=C||a.clientY>=B)&&(A(),x=-1)};POLARIS.document.on("dragenter",F);POLARIS.document.on("dragleave",G);var H=function(a){l.removeClass("SimpleUploadsOverEditor");
p=-1;POLARIS.fire("simpleuploads.droppedFile");x=-1;if(d.readOnly)return a.data.preventDefault(),!1;var b=a.data.$,c=b.dataTransfer;if(c&&c.files&&0<c.files.length){d.fire("saveSnapshot");a.data.preventDefault();a={ev:b,range:!1,count:c.files.length,rangeParent:b.rangeParent,rangeOffset:b.rangeOffset};if(!a.rangeParent&&!document.caretRangeFromPoint&&"img"!=b.target.nodeName.toLowerCase()){var e=d.document.$;if(e.body.createTextRange){e=e.body.createTextRange();try{e.moveToPoint(b.clientX,b.clientY),
a.range=e}catch(f){}}}for(e=0;e<c.files.length;e++){var g=c.files[e],h=POLARIS.tools.getNextId();POLARIS.plugins.simpleuploads.insertDroppedFile(d,{context:b,name:g.name,file:g,forceLink:b.shiftKey,id:h,mode:{type:"droppedFile",dropLocation:a}})}}},I=function(a){-1==p&&g(a)&&(d.readOnly||l.addClass("SimpleUploadsOverEditor"),a=l.$.getBoundingClientRect(),p=a.left,q=a.top,r=p+l.$.clientWidth,v=q+l.$.clientHeight)},J=function(a){-1!=p&&(a=a.data.$,a.clientX<=p||a.clientY<=q||a.clientX>=r||a.clientY>=
v)&&(l.removeClass("SimpleUploadsOverEditor"),p=-1)},pa=function(a){if(-1!=p){if(d.readOnly)return a.data.$.dataTransfer.dropEffect="none",a.data.preventDefault(),!1;a.data.$.dataTransfer.dropEffect="copy";POLARIS.env.gecko||a.data.preventDefault()}};d.on("contentDom",function(a){k=d.document;l=k.getBody().getParent();3==d.elementMode&&(l=k=d.editable());1==d.elementMode&&"divarea"in d.plugins&&(l=k=d.editable());m=d.editable?d.editable():k;if(POLARIS.env.ie&&11<=POLARIS.env.version&&d.config.forcePasteAsPlainText&&
d.editable().isInline())m.attachListener(m,"beforepaste",function(a){d.document.on("paste",function(a){a.removeListener();w(a)},null,{editor:d})});else m.on("paste",w,null,{editor:d},8)});d.on("contentDomUnload",E);d.plugins.fileDropHandler={addTarget:function(a,b){a.on("dragenter",function(b){-1==p&&g(b)&&(a.addClass("SimpleUploadsOverDialog"),b=a.$.getBoundingClientRect(),p=b.left,q=b.top,r=p+a.$.clientWidth,v=q+a.$.clientHeight)});a.on("dragleave",function(b){-1!=p&&(b=b.data.$,b.clientX<=p||b.clientY<=
q||b.clientX>=r||b.clientY>=v)&&(a.removeClass("SimpleUploadsOverDialog"),p=-1)});a.on("dragover",function(a){-1!=p&&(a.data.$.dataTransfer.dropEffect="copy",a.data.preventDefault())});a.on("drop",function(c){a.removeClass("SimpleUploadsOverDialog");p=-1;POLARIS.fire("simpleuploads.droppedFile");x=-1;var e=c.data.$,f=e.dataTransfer;if(f&&f.files&&0<f.files.length)for(c.data.preventDefault(),c=0;1>c;c++){var g=f.files[c];if(POLARIS.plugins.simpleuploads.isImageExtension(d,g.name)){var h=new Image;
h.src=URL.createObjectURL(g);h.onload=function(){var a=POLARIS.plugins.simpleuploads.adjustImageSize(d,this.width,this.height),b=POLARIS.dialog.getCurrent();b.getContentElement("info","txtWidth").setValue(a.width);b.getContentElement("info","txtHeight").setValue(a.height);void 0!=b.dontResetSize&&(b.dontResetSize=!0)}}g={context:e,name:g.name,file:g,id:POLARIS.tools.getNextId(),forceLink:!1,callback:b,mode:{type:"callback"}};POLARIS.plugins.simpleuploads.processFileWithCallback(d,g)}})}}}}},afterInit:function(a){(a=
(a=a.dataProcessor)&&a.htmlFilter)&&a.addRules(C,{applyToAll:!0})}});POLARIS.plugins.simpleuploads={getTimeStampId:function(){var a=0;return function(){a++;return"t"+(new Date).toISOString().replace(/\..*/,"").replace(/\D/g,"_")+a}}(),isImageExtension:function(a,b){return a.config.simpleuploads_imageExtensions?(new RegExp(".(?:"+a.config.simpleuploads_imageExtensions+")$","i")).test(b):!1},isDocumentExtension:function(a,b){return(new RegExp(".(?:"+a.config.simpleuploads_documentExtensions+")$","i")).test(b)},
isFlashExtension:function(a,b){return(new RegExp(".(?:"+a.config.simpleuploads_flashExtensions+")$","i")).test(b)},insertProcessedFile:function(a,b){b.element=null;b.id=this.getTimeStampId();var c=this;switch(b.mode.type){case "selectedFile":window.setTimeout(function(){c.insertSelectedFile(a,b)},50);break;case "pastedFile":this.insertPastedFile(a,b);break;case "callback":window.setTimeout(function(){c.processFileWithCallback(a,b)},50);break;case "droppedFile":this.insertDroppedFile(a,b);break;case "base64paste":this.insertBase64File(a,
b);break;default:alert("Error, no valid type",b.mode)}},insertSelectedFile:function(a,b){var c=b.mode,d=c.i,e=c.count;if(n(a,b)&&(c=b.element)){if(1==e){var f=a.getSelection(),e=f.getSelectedElement(),g;e&&"img"==e.getName()&&"span"==c.getName()&&(g=e.$);if("a"==c.getName()){var h=e,k=f.getRanges(),f=k&&k[0];!h&&k&&1==k.length&&(h=f.startContainer.$,h.nodeType==document.TEXT_NODE&&(h=h.parentNode));for(;h&&h.nodeType==document.ELEMENT_NODE&&"a"!=h.nodeName.toLowerCase();)h=h.parentNode;h&&h.nodeName&&
"a"==h.nodeName.toLowerCase()&&(g=h);g||!f||!e&&f.collapsed||(g=new POLARIS.style({element:"a",attributes:{href:"#"}}),g.type=POLARIS.STYLE_INLINE,g.applyToRange(f),h=f.startContainer.$,h.nodeType==document.TEXT_NODE&&(h=h.parentNode),g=h)}if(g){g.parentNode.replaceChild(c.$,g);b.originalNode=g;a.fire("saveSnapshot");return}}0<d&&"a"==c.getName()&&a.insertHtml("\x26nbsp;");a.insertElement(c);t(a,b)}},insertPastedFile:function(a,b){if(n(a,b)){var c=b.element;if(b.mode.dialog)a.fire("updateSnapshot"),
a.insertElement(c),a.fire("updateSnapshot");else{var d=function(){a.getSelection().getRanges().length?a.editable&&a.editable().$.querySelector("#polaris_pastebin")?window.setTimeout(d,0):(a.fire("updateSnapshot"),a.insertElement(c),a.fire("updateSnapshot"),t(a,b)):window.setTimeout(d,0)};window.setTimeout(d,0)}}},processFileWithCallback:function(a,b){n(a,b)},insertDroppedFile:function(a,b){if(n(a,b)){var c=b.element,d=b.mode.dropLocation,e=d.range,f=d.ev,g=d.count;e&&"a"==c.getName()&&(e.pasteHTML?
e.pasteHTML("\x26nbsp;"):e.insertNode(a.document.$.createTextNode(" ")));var h=f.target;if(!e){var k=a.document.$;if(d.rangeParent){var f=d.rangeParent,l=d.rangeOffset,e=k.createRange();e.setStart(f,l);e.collapse(!0)}else if(document.caretRangeFromPoint)e=k.caretRangeFromPoint(f.clientX,f.clientY);else if("img"==h.nodeName.toLowerCase())e=k.createRange(),e.selectNode(h);else if(document.body.createTextRange){l=k.body.createTextRange();try{l.moveToPoint(f.clientX,f.clientY),e=l}catch(m){e=k.createRange(),
e.setStartAfter(k.body.lastChild),e.collapse(!0)}}d.range=e}k=c.getName();d=!1;if(1==g&&("img"==h.nodeName.toLowerCase()&&"span"==k&&(h.parentNode.replaceChild(c.$,h),b.originalNode=h,d=!0),"a"==k)){e.startContainer?(g=e.startContainer,g.nodeType==document.TEXT_NODE?g=g.parentNode:e.startOffset<g.childNodes.length&&(g=g.childNodes[e.startOffset])):g=e.parentElement();g&&"img"!=h.nodeName.toLowerCase()||(g=h);for(h=g;h&&h.nodeType==document.ELEMENT_NODE&&"a"!=h.nodeName.toLowerCase();)h=h.parentNode;
h&&h.nodeName&&"a"==h.nodeName.toLowerCase()&&(h.parentNode.replaceChild(c.$,h),b.originalNode=h,d=!0);d||"img"!=g.nodeName.toLowerCase()||(h=g.ownerDocument.createElement("a"),h.href="#",g.parentNode.replaceChild(h,g),h.appendChild(g),h.parentNode.replaceChild(c.$,h),b.originalNode=h,d=!0)}d||(e?e.pasteHTML?e.pasteHTML(c.$.outerHTML):e.insertNode(c.$):a.insertElement(c));t(a,b);a.fire("saveSnapshot")}},insertBase64File:function(a,b){delete b.result;var c=a.document.getById(b.mode.id);n(a,b)?(a.getSelection().selectElement(c),
a.insertElement(b.element),t(a,b)):(c.remove(),b.result&&a.insertHTML(b.result))},adjustImageSize:function(a,b,c){a=a.config.defaultAdjustImageSize;var d={width:100,height:100};b>a&&c<a?(d.width=a,d.height=Math.round(c*a/b)):b<a&&c>a?(d.height=a,d.width=Math.round(b*a/c)):b>c?(d.width=a,d.height=Math.round(c*a/b)):(d.height=a,d.width=Math.round(b*a/c));return d}};POLARIS.skins&&(POLARIS.plugins.setLang=POLARIS.tools.override(POLARIS.plugins.setLang,function(a){return function(b,c,d){if("devtools"!=
b&&"object"!=typeof d[b]){var e={};e[b]=d;d=e}a.call(this,b,c,d)}}));POLARIS.on("dialogDefinition",function(a){if(a.editor.plugins.simpleuploads){var b=a.data.definition,c;for(c in b.contents){var d=b.contents[c];d&&p(a.editor,a.data.name,b,d.elements)}"paste"==a.data.name&&(b.onShow=POLARIS.tools.override(b.onShow,function(a){return function(){"function"==typeof a&&a.call(this);x(this.getContentElement("general","editing_area").getInputElement())}}))}},null,null,30)})();POLARIS.config.simpleuploads_hideImageProgress=
!0;(function(){var a;POLARIS.plugins.add("titlebar",{requires:"button",init:function(e){a=this.path;e.on("uiSpace",function(b){if("top"==b.data.space){b.removeListener();var c=POLARIS.tools.getNextId(),c=["\x3cstyle\x3e.polaris_title{"+(e.config.titlebarBackgroundColor?"background-color:"+e.config.titlebarBackgroundColor+";":"")+"}\x3c/style\x3e",'\x3cspan id\x3d"',c,'" class\x3d"polaris_voice_label"\x3e',e.lang.titlebar.titlebar,"\x3c/span\x3e",'\x3cspan id\x3d"'+e.ui.spaceId("titlebar")+'" class\x3d"polaris_toolbox" role\x3d"group" aria-labelledby\x3d"',
c,'" on/mousedown\x3d"return false;"\x3e'];e.on("setTitleBarLabel",function(a){a=a.data.name;var b=document.getElementById("polaris_title_label");b&&a&&(b.textContent=a)});e.addCommand("titlebarCollapse",{readOnly:1,exec:function(a,b){var c=document.getElementById("polaris_title");c&&(c=new POLARIS.dom.element(c),b?c.show():c.hide())},modes:{wysiwyg:1,source:1}});if(e.elementMode!=POLARIS.ELEMENT_MODE_INLINE){var d;d="Documents";document.getElementById("subject")&&document.getElementById("subject").value&&
(d=document.getElementById("subject").value);d="\x3ctd style\x3d'padding-left: 6px; vertical-align: middle; width:100%;'\x3e\x3cspan id\x3d'polaris_title_label' style\x3d'color:#fff;'\x3e"+d+"\x3c/span\x3e\x3c/td\x3e";c.push('\x3ctable id\x3dpolaris_title class\x3d"polaris_title" role\x3d"presentation" '+(e.config.showTitlebar?"":'style\x3d"display: none;"')+"\x3e\x3ctr\x3e\x3ctd class\x3dpolaris_title_left\x3e\x3cimg src\x3d"+POLARIS.getUrl(a+"images/title_bi.png")+"\x3e\x3c/td\x3e"+d+"\x3c/tr\x3e\x3c/table\x3e")}c.push("\x3c/span\x3e");
b.data.html+=c.join("")}},null,null,1)}})})();POLARIS.plugins.uicolor={requires:"dialog",init:function(a){POLARIS.env.ie6Compat||(a.addCommand("uicolor",new POLARIS.dialogCommand("uicolor")),a.ui.addButton&&a.ui.addButton("UIColor",{label:a.lang.uicolor.title,command:"uicolor",toolbar:"tools,1"}),POLARIS.dialog.add("uicolor",this.path+"dialogs/uicolor.js"),POLARIS.scriptLoader.load(POLARIS.getUrl("plugins/uicolor/yui/yui.js")),POLARIS.document.appendStyleSheet(POLARIS.getUrl("plugins/uicolor/yui/assets/yui.css")),
a.getUIColorFromDialog=function(e,b){var c=function(a){this.removeListener("ok",c);this.removeListener("cancel",c);a="ok"==a.name?this.getValueOf("picker","txtPickerColor"):null;e.call(b,a)},d=function(a){a.on("ok",c);a.on("cancel",c)};a.execCommand("uicolor");if(a._.storedDialogs&&a._.storedDialogs.uicolor)d(a._.storedDialogs.uicolor);else POLARIS.on("dialogDefinition",function(a){if("uicolor"==a.data.name){var b=a.data.definition;a.removeListener();b.onLoad=POLARIS.tools.override(b.onLoad,function(a){return function(){d(this);
b.onLoad=a;"function"==typeof a&&a.call(this)}})}})})}};POLARIS.plugins.add("uicolor",POLARIS.plugins.uicolor);(function(){function a(a){function c(c,d){if(d.length){c.items?c.items.push(a.ui.create("-")):c.items=[];for(var g;g=d.shift();)if(g="string"==typeof g?g:g.name,a.config.wordprocessor||"ZoomCombo"!=g)e&&-1!=POLARIS.tools.indexOf(e,g)||(g=a.ui.create(g))&&a.addFeature(g)&&c.items.push(g)}}function d(a){var b=[],d,e,g;for(d=0;d<a.length;++d)e=a[d],g={},"/"==e?b.push(e):POLARIS.tools.isArray(e)?
(c(g,POLARIS.tools.clone(e)),b.push(g)):e.items&&(c(g,POLARIS.tools.clone(e.items)),g.name=e.name,b.push(g));return b}var e=a.config.removeButtons,e=e&&e.split(","),g=a.config.quickaccesstoolbar;return a.quickAccessToolbar=g?d(g):[]}var e=function(){this.toolbars=[]};POLARIS.plugins.add("quickaccesstoolbar",{requires:"button",lang:"en,ko",init:function(b){b.on("uiSpace",function(c){if(c.data.space==b.config.QAToolbarLocation){c.removeListener();b.quickaccesstoolbox=new e;var d=POLARIS.tools.getNextId(),
h=!1!==b.config.qatoolbarStartupExpanded,g,k,f=['\x3cspan id\x3d"',d,'" class\x3d"polaris_voice_label"\x3e',b.lang.quickaccesstoolbar.qatoolbar,"\x3c/span\x3e",'\x3cdiv id\x3d"'+b.ui.spaceId("quickaccesstoolbox")+'" class\x3d"polaris_toolbox" role\x3d"group" onselectstart\x3d"return false;" ondragstart\x3d"return false;" aria-labelledby\x3d"',d,'" on/mousedown\x3d"return false;"',h&&b.config.showQuickAccessToolbar?"\x3e":' style\x3d"display:none"\x3e'];POLARIS.tools.addFunction(function(a){13===a.keyCode&&
b.fire("save")});b.addCommand("qatoolbarCollapse",{readOnly:1,exec:function(a,b){var c=a.ui.space("quickaccesstoolbox"),d=a.ui.space("contents"),e=c.getParent(),f=parseInt(d.$.offsetHeight,10),g=e.$.offsetHeight;b?c.show():c.hide();d.isVisible()||(f=POLARIS.tools.convertToPx(d.getComputedStyle("height")));d.setStyle("height",f-(e.$.offsetHeight-g)+"px");a.fire("resize")},modes:{wysiwyg:1,source:1}});b.addCommand("qatoolbarShowRow",{readOnly:1,exec:function(a,b){for(var c=a.ui.space("quickaccesstoolbox").getLast(),
d=a.ui.space("contents"),e=c.getParent(),f=parseInt(d.$.style.height,10),g=e.$.offsetHeight,h=[],k=0;k<c.$.childNodes.length;k++){var l=c.$.childNodes[k],m=l.getAttribute("role");m&&"toolbar"==m&&h.push(l)}for(k=0;k<h.length;k++)c=new POLARIS.dom.node(h[k]),l=c.getNext(),m=(new POLARIS.dom.node(document.getElementById(c.getId()+"_label"))).getText(),b&&b.toolbarName&&m==b.toolbarName&&(b.show?(c.show(),l.show()):(c.hide(),l.hide()));d.isVisible()||(f=POLARIS.tools.convertToPx(d.getComputedStyle("height")));
d.setStyle("height",f-(e.$.offsetHeight-g)+"px");a.fire("resize")},modes:{wysiwyg:1,source:1}});b.config.qatoolbarCanCollapse&&b.elementMode!=POLARIS.ELEMENT_MODE_INLINE&&f.push('\x3cspan class\x3d"polaris_toolbox_main" unselectable\x3d"on"\x3e');for(var d=b.quickaccesstoolbox.toolbars,h=a(b),l=0;l<h.length;l++){var m,n=0,q,v=h[l],r;if(v)if(g&&(f.push("\x3c/span\x3e"),k=g=0),"/"==v)f.push('\x3cspan class\x3d"polaris_toolbar_break"\x3e\x3c/span\x3e');else{r=v.items||v;for(var p=0;p<r.length;p++){var t=
r[p],w;if(t){var A=function(a){a=a.render(b,f);x=n.items.push(a)-1;0<x&&(a.previous=n.items[x-1],a.previous.next=a);a.toolbar=n};w=!1!==t.canGroup;if(!n){m=POLARIS.tools.getNextId();n={id:m,items:[]};q=v.name&&(b.lang.quickaccesstoolbar.toolbarGroups[v.name]||v.name);f.push('\x3cspan id\x3d"',m,'" class\x3d"polaris_toolbar"',q?' aria-labelledby\x3d"'+m+'_label"':"",' role\x3d"toolbar" unselectable\x3d"on"\x3e');q&&f.push('\x3cspan id\x3d"',m,'_label" class\x3d"polaris_voice_label" unselectable\x3d"on"\x3e',
q,"\x3c/span\x3e");f.push('\x3cspan class\x3d"polaris_toolbar_start"\x3e\x3c/span\x3e');var x=d.push(n)-1;0<x&&(n.previous=d[x-1],n.previous.next=n)}w?g||(f.push('\x3cspan class\x3d"polaris_toolgroup" role\x3d"presentation" unselectable\x3d"on"\x3e'),g=1):g&&(f.push("\x3c/span\x3e"),g=0);k&&(A(k),k=0);A(t)}}g&&(f.push("\x3c/span\x3e"),k=g=0);n&&f.push('\x3cspan class\x3d"polaris_toolbar_end"\x3e\x3c/span\x3e\x3c/span\x3e')}}b.config.qatoolbarCanCollapse&&f.push("\x3c/span\x3e");f.push("\x3c/div\x3e");
c.data.html+=f.join("")}},null,null,5);b.on("destroy",function(){if(this.quickaccesstoolbox){var a,b=0,e,g,k;for(a=this.quickaccesstoolbox.toolbars;b<a.length;b++)for(g=a[b].items,e=0;e<g.length;e++)k=g[e],k.clickFn&&POLARIS.tools.removeFunction(k.clickFn),k.keydownFn&&POLARIS.tools.removeFunction(k.keydownFn),k.focusFn&&POLARIS.tools.removeFunction(k.focusFn)}})}})})();POLARIS.config.QAToolbarLocation="top";(function(){var a=function(a){var b=a.getSelection();if(b){var c=b.getRanges();(selectionIsEmpty=
b.getType()==POLARIS.SELECTION_NONE||1==c.length&&c[0].collapsed)?(a.getCommand("changecase").setState(POLARIS.TRISTATE_DISABLED),a.getCommand("changecharwidth").setState(POLARIS.TRISTATE_DISABLED)):(a.getCommand("changecase").setState(POLARIS.TRISTATE_OFF),a.getCommand("changecharwidth").setState(POLARIS.TRISTATE_OFF))}};POLARIS.plugins.add("changecase",{requires:"dialog",lang:"en,ko",icons:"changecase,half",hidpi:!0,init:function(e){e.ui.addButton&&e.ui.addButton("ChangeCase",{label:e.lang.changecase.changeCase,
command:"changecase",toolbar:"edit,100"});e.addCommand("changecase",new POLARIS.dialogCommand("changecase",{startDisabled:!0}));POLARIS.dialog.add("changecase",this.path+"dialogs/changecase.js");e.ui.addButton&&e.ui.addButton("ChangeCharWidth",{label:e.lang.changecase.changeCharWidth,command:"changecharwidth",toolbar:"edit,100"});e.addCommand("changecharwidth",new POLARIS.dialogCommand("changecharwidth",{startDisabled:!0}));POLARIS.dialog.add("changecharwidth",this.path+"dialogs/changecharwidth.js");
e.on("selectionChange",function(b){a(b.editor)});e.on("mouseup",function(b){a(b.editor)});e.on("contentDom",function(b){var c=b.editor.editable();c.attachListener(c,"keyup",function(){a(b.editor)})})}})})();(function(){POLARIS.plugins.add("edit",{lang:"en,ko",icons:"edit",hidpi:!0,init:function(a){a.ui.addButton&&a.ui.addButton("Edit",{label:a.lang.edit.label,command:"edit",toolbar:"edit,100"});a.addCommand("edit",{startDisabled:!0,contextSensitive:1,refresh:function(a,b){var c=POLARIS.TRISTATE_DISABLED;
b.contains({td:1,th:1,img:1},1)&&(c=POLARIS.TRISTATE_OFF);this.setState(c)},exec:function(a){var b=a.document.getSelection();POLARIS.plugins.tabletools&&POLARIS.plugins.tabletools.existSelectedCell()?a.execCommand("tableProperties"):(b=b.getSelectedElement())&&b.is("img")&&!b.data("polaris-realelement")&&!b.isReadOnly()&&a.execCommand("image")}})}})})();(function(){POLARIS.plugins.add("zoom",{requires:"dialog",lang:"en,ko",icons:"zoom",hidpi:!0,init:function(a){a.ui.add&&a.ui.add("Zoom",POLARIS.UI_MENUBUTTON,
{title:a.lang.zoom.label,label:a.lang.zoom.label,command:"zoom",toolbar:"display,100",onMenu:function(){return{setzoom_fill_page:"fillPage"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_fill_width:"fillWidth"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_100:"100"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_125:"125"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_150:"150"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:
POLARIS.TRISTATE_OFF,setzoom_200:"200"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_300:"300"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_500:"500"==a.ui.zoomRatio?POLARIS.TRISTATE_CHECKED:POLARIS.TRISTATE_OFF,setzoom_user:POLARIS.TRISTATE_OFF}}});a.addCommand("zoom",new POLARIS.dialogCommand("zoom"));POLARIS.dialog.add("zoom",this.path+"dialogs/zoom.js");a.addMenuGroup("dropdownZoom");a.addMenuItems({setzoom_fill_page:{label:a.lang.zoom.fillPage,
group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:1});a.ui.zoomRatio="fillPage"}},setzoom_fill_width:{label:a.lang.zoom.fillWidth,group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:2});a.ui.zoomRatio="fillWidth"}},setzoom_100:{label:"100%",group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:0,ratio:100});a.ui.zoomRatio="100"}},setzoom_125:{label:"125%",group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:0,ratio:125});a.ui.zoomRatio="125"}},setzoom_150:{label:"150%",
group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:0,ratio:150});a.ui.zoomRatio="150"}},setzoom_200:{label:"200%",group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:0,ratio:200});a.ui.zoomRatio="200"}},setzoom_300:{label:"300%",group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:0,ratio:300});a.ui.zoomRatio="300"}},setzoom_500:{label:"500%",group:"dropdownZoom",onClick:function(){a.fire("zoom",{type:0,ratio:500});a.ui.zoomRatio="500"}},setzoom_user:{label:a.lang.zoom.userSetRatio,
group:"dropdownZoom",onClick:function(){a.execCommand("zoom")}}});a.ui.zoomType=0;a.ui.zoomRatio="100";a.ui.addRichCombo("ZoomCombo",{label:a.lang.zoom.label,title:a.lang.zoom.label,toolbar:"display,100",panel:{css:[POLARIS.skin.getPath("editor")].concat(a.config.contentsCss),multiSelect:!1,attributes:{"aria-label":a.lang.zoom.label}},init:function(){this.startGroup(a.lang.zoom.label);this.add("fillPage",a.lang.zoom.fillPage,a.lang.zoom.fillPage);this.add("fillWidth",a.lang.zoom.fillWidth,a.lang.zoom.fillWidth);
this.add("100","100%","100%");this.add("125","125%","125%");this.add("150","150%","150%");this.add("200","200%","200%");this.add("300","300%","300%");this.add("500","500%","500%");this.add("userRatio",a.lang.zoom.userSetRatio,a.lang.zoom.userSetRatio)},onClick:function(e){var b=0;if("fillPage"==e)b=1;else if("fillWidth"==e)b=2;else if("userRatio"==e){a.execCommand("zoom");return}a.fire("zoom",{type:b,ratio:parseInt(e),updateScrollbarVisibility:1})},onRender:function(){a.on("zoom",function(e){var b=
a.ui.zoomType=e.data.type;e=a.ui.zoomRatio=e.data.ratio;1==b?this.setValue("fillPage",a.lang.zoom.fillPage):2==b?this.setValue("fillWidth",a.lang.zoom.fillWidth):"100"==e||"125"==e||"150"==e||"200"==e||"300"==e||"500"==e?this.setValue(e,e+"%"):this.setValue("userRatio",e+"%")},this);a.on("selectionChange",function(e){e=a.ui.zoomType;var b=a.ui.zoomRatio;1==e?this.setValue("fillPage",a.lang.zoom.fillPage):2==e?this.setValue("fillWidth",a.lang.zoom.fillWidth):"100"==b||"125"==b||"150"==b||"200"==b||
"300"==b||"500"==b?this.setValue(b,b+"%"):this.setValue("userRatio",b+"%")},this)}});a.on("zoom",function(e){a.ui.zoomType=e.data.type;a.ui.zoomRatio=e.data.ratio},this);a.on("contentDom",function(e){e=e.editor.editable();e.attachListener(e,POLARIS.env.ie&&8<POLARIS.env.version||POLARIS.env.webkit?"mousewheel":POLARIS.env.gecko?"DOMMouseScroll":"onmousewheel",function(b){if(POLARIS.env.mac?b.data.$.metaKey:b.data.$.ctrlKey)switch(b.data.preventDefault(),"onmousewheel"==b.name||"mousewheel"==b.name?
b.data.$.wheelDelta:b.data.$.detail){case 120:case -1:a.execCommand("zoomIn",5);break;case 240:case -2:a.execCommand("zoomIn",10);break;case -120:case 1:a.execCommand("zoomOut",5);break;case -240:case 2:a.execCommand("zoomOut",10)}return!0},!1)});a.on("loadSnapshot",function(){a.fire("zoom",{type:a.ui.zoomType,ratio:a.ui.zoomRatio,updateScrollbarVisibility:1})},null,null,150)}})})();(function(){POLARIS.plugins.add("grid",{lang:"en,ko",icons:"grid,gridlineset",hidpi:!0,init:function(a){a.ui.addButton&&
a.ui.addButton("Grid",{label:a.lang.grid.grid,command:"grid",toolbar:"display,100"});a.ui.addButton&&a.ui.addButton("GridLineSet",{label:a.lang.grid.gridLineSet,command:"gridLineSet",toolbar:"display,100"});a.addCommand("grid",{modes:{wysiwyg:1},readOnly:1,exec:function(a){if(this.state==POLARIS.TRISTATE_OFF){this.state=POLARIS.TRISTATE_ON;for(var b=0;b<this.uiItems.length;b++)this.uiItems[b].setState(POLARIS.TRISTATE_ON)}else for(this.state=POLARIS.TRISTATE_OFF,b=0;b<this.uiItems.length;b++)this.uiItems[b].setState(POLARIS.TRISTATE_OFF);
a.plugins.pagination.pageInfo.grid.visible=!a.plugins.pagination.pageInfo.grid.visible;a.plugins.pagination.updatePageStyle(a)},canUndo:!1});a.addCommand("gridLineSet",new POLARIS.dialogCommand("gridLineSet"));POLARIS.dialog.add("gridLineSet",this.path+"dialogs/grid.js")}})})();(function(){POLARIS.plugins.rubytext={getRubyElement:function(a){var e=a.getSelection(),b=e.getSelectedElement();return b&&b.is("ruby")?b:(e=e.getRanges()[0])?(e.shrink(POLARIS.SHRINK_ELEMENT,!0),(b=a.elementPath(e.getCommonAncestor()).contains("ruby",
1))&&e.selectNodeContents(b),b):null}};POLARIS.plugins.add("rubytext",{lang:"en,ko",icons:"rubytext",hidpi:!0,init:function(a){a.ui.addButton&&a.ui.addButton("RubyText",{label:a.lang.rubytext.label,command:"rubytext",toolbar:"input,100"});POLARIS.dialog.add("rubytext",this.path+"dialogs/rubytext.js");a.addCommand("rubytext",new POLARIS.dialogCommand("rubytext",{allowedContent:"ruby",requiredContent:"ruby"}));a.on("doubleclick",function(e){var b=POLARIS.plugins.rubytext.getRubyElement(a)||e.data.element;
b.is("ruby")&&(e.data.dialog="rubytext",e.data.ruby=b)});a.on("doubleclick",function(e){e.data.dialog in{rubytext:1}&&e.data.ruby&&a.getSelection().selectElement(e.data.ruby)},null,null,910)}})})();(function(){POLARIS.plugins.add("paragraphline",{lang:"en,ko",icons:"paragraphline",hidpi:!0,init:function(a){a.ui.addButton&&a.ui.addButton("ParagraphLine",{label:a.lang.paragraphline.label,command:"paragraphLine",toolbar:"input,100"});a.addCommand("paragraphLine",{exec:function(a){a.pagination&&a.pagination.adjustCaret(a);
var b=a.getSelection().getStartElement();if(!b)return a.focus(),!1;b.getClientRect();var c=a.document.createElement("hr");c.setAttribute("contentEditable","false");c.setAttribute("size","5px");c.setAttribute("noshade");c.setAttribute("color","black");b.getAscendant("p")?a.insertElementWithBlockSplit(c):"td"==b.getName()?("\x3cbr\x3e"==b.getHtml()?b.setHtml(c.getOuterHtml()):b.setHtml(b.getHtml()+c.getOuterHtml()),c=a.document.createElement("p"),c.appendBogus(),b.append(c),b=new POLARIS.dom.range(a.document),
b.moveToPosition(c,POLARIS.POSITION_AFTER_START),a.focus(),b.select()):c.insertBefore(b);a.focus()}})}})})();(function(){POLARIS.plugins.add("movement",{requires:"dialog,link",lang:"en,ko",icons:"movement",hidpi:!0,init:function(a){a.ui.addButton&&a.ui.addButton("Movement",{label:a.lang.movement.label,command:"movement",toolbar:"edit,100"});a.addCommand("movement",new POLARIS.dialogCommand("movement"));POLARIS.dialog.add("movement",this.path+"dialogs/movement.js");a.setKeystroke([[POLARIS.ALT+71,
"movement"]])}})})();(function(){POLARIS.plugins.add("caption",{requires:"dialog",lang:"en,ko",init:function(a){var e=a.config.removeButtons;e&&e.indexOf&&0<=e.indexOf("Caption")||(a.ui.addButton&&a.ui.addButton("Caption",{label:a.lang.caption.label,command:"insertCaption",toolbar:"captions,100"}),a.addCommand("insertCaption",new POLARIS.dialogCommand("insertCaption",{contextSensitive:1,refresh:function(a,c){var d=POLARIS.TRISTATE_DISABLED;if(c.contains(["table","img"]))switch(this.name){case "insertcaption":d=
POLARIS.TRISTATE_OFF;a.plugins.caption.selectedElement=c.lastElement;break;default:d=POLARIS.TRISTATE_DISABLED,a.plugins.caption.selectedElement=void 0}this.setState(d)}})),POLARIS.dialog.add("insertCaption",this.path+"dialogs/caption.js"),a.contextMenu&&a.contextMenu.addListener(function(b,c,d){if(b&&c&&d){var e={};if(b.hasAscendant("table")){if(POLARIS.plugins.tabletools.existSelectedCell(c)&&d.contains({table:1,td:1,th:1},1).getAscendant(function(a){if(a.getAttribute&&("polaris-page-header"==a.getAttribute("doc-data-role")||
"polaris-page-footer"==a.getAttribute("doc-data-role"))&&"false"==a.getAttribute("contenteditable"))return!0}))return;for(e.caption_add=POLARIS.TRISTATE_OFF;(b=b.getParent())&&"table"!=b.getName(););b.findOne("caption")&&(e.caption_delete=POLARIS.TRISTATE_OFF);a.plugins.caption.selectedElement=d.lastElement}else"img"==b.getName()&&(e.caption_add=POLARIS.TRISTATE_OFF,(b=a.elementPath(b).contains("figure",1))&&b.findOne("figcaption")&&(e.caption_delete=POLARIS.TRISTATE_OFF),a.plugins.caption.selectedElement=
d.lastElement);return e}}),a.addCommand("removeCaption",{exec:function(a){var c=a.plugins.caption.selectedElement;if(c.hasAscendant("table")){for(;(c=c.getParent())&&"table"!=c.getName(););(c=c.findOne("caption"))&&c.remove();a.focus()}else if(c.hasAscendant("figure")){if(c=a.elementPath(c).contains("figure",1)){var d=c.findOne("figcaption");d&&d.remove()}d=new POLARIS.dom.range(a.document);d.moveToPosition(c,POLARIS.POSITION_AFTER_END);a.focus();d.select()}}}),a.addMenuGroup("captions"),a.addMenuItems({caption_add:{label:a.lang.caption.label,
group:"captions",command:"insertCaption",order:10},caption_delete:{label:a.lang.caption.remove,group:"captions",command:"removeCaption",order:20}}))}})})();(function(){var a="";POLARIS.plugins.add("blockcalculation",{requires:"dialog",lang:"en,ko",icon:"blockcalculation",hidpi:!0,init:function(e){POLARIS.dialog.add("blockcalculation",this.path+"dialogs/blockCalc.js");e.addCommand("blockcalculation",new POLARIS.dialogCommand("blockcalculation"));e.addCommand("blockcalcsum",{exec:function(b){a="sum";
b.execCommand("blockcalculation")}});e.ui.addButton("BlockCalcSum",{label:e.lang.blockcalculation.blockCalcSumLabel,command:"blockcalcsum"});e.addCommand("blockcalcavg",{exec:function(b){a="avg";b.execCommand("blockcalculation")}});e.ui.addButton("BlockCalcAvg",{label:e.lang.blockcalculation.bockCalcAvgLabel,command:"blockcalcavg"})},getOperation:function(){return a}})})();(function(){POLARIS.plugins.add("objectattribute",{lang:"en,ko",icons:"objectattribute",hidpi:!0,init:function(a){}})})();(function(){var a=
POLARIS.tools.cssLength,e=POLARIS.env.ie&&(POLARIS.env.ie7Compat||POLARIS.env.quirks),b=function(a){if(a.type==POLARIS.NODE_ELEMENT){if(a.is("img"))return"anchor"!=a.getAttribute("data-polaris-real-element-type");if(a.is("table"))return!0;if(a.is("div"))return POLARIS.plugins.div.isTextbox(a)}return!1},c={editor:null,document:null,editable:null,element:null,attached:!1,clicked:!1,lastPos:null,resizer:null,topLine:null,bottomLine:null,leftLine:null,rightLine:null,leftPx:null,topPx:null,widthPx:null,
heightPx:null,indicators:[],onMouseDown:function(a){this.clicked=a.sender;this.lastPos={x:a.data.$.clientX,y:a.data.$.clientY};this.element.setStyle("opacity","0.3");this.cancel(a);return!1},onMouseMove:function(a){if(null!=this.clicked){var b=this.clicked.getAttribute("class");this.resize(b,a);this.cancel(a);return!1}},onMouseUp:function(a){if(null!=this.clicked){var b={width:this.widthPx,height:this.heightPx,left:this.leftPx,top:this.topPx};this.widthPx=parseInt(this.topLine.getStyle("width"));
this.heightPx=parseInt(this.leftLine.getStyle("height"));this.leftPx=parseInt(this.resizer.getStyle("left"));this.topPx=parseInt(this.resizer.getStyle("top"));var c={width:this.widthPx,height:this.heightPx,left:this.leftPx,top:this.topPx};this.lastPos=this.clicked=null;this.cancel(a);if(b.width!=c.width||b.height!=c.height)this.onSizeChanged(b,c);this.element.removeStyle("opacity");return!1}},setSize:function(b,c,d,e){this.topLine.setStyles({width:a(d)});this.bottomLine.setStyles({top:a(e),width:a(d)});
this.leftLine.setStyles({height:a(e)});this.rightLine.setStyles({left:a(d),height:a(e)});this.resizer.setStyles({left:a(b),top:a(c)})},update:function(){if(null!=this.element){var a=this.element.getClientRect();if(null!=a){var b=this.element.getDocumentPosition();this.leftPx=parseInt(b.x)-1;this.topPx=parseInt(b.y);this.widthPx=parseInt(a.width)+1;this.heightPx=parseInt(a.height);this.setSize(this.leftPx,this.topPx,this.widthPx,this.heightPx)}}},attach:function(a,b){if(!(this.attached&&b.equals(this.element)&&
this.resizer)){this.detach(a);this.editor=a;this.editable=a.editable();this.attached=!0;this.document=a.document;this.element=b;this.resizer=POLARIS.dom.element.createFromHtml('\x3cdiv id\x3d"polarisSelector"\x3e\x3cdiv class\x3d"topLine polarisSelector"\x3e\x3cdiv class\x3d"topLeft" style\x3d"cursor: nw-resize;"\x3e\x3c/div\x3e\x3cdiv class\x3d"topRight" style\x3d"cursor: sw-resize;"\x3e\x3c/div\x3e\x3cdiv class\x3d"topMiddle" style\x3d"cursor: n-resize;"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"bottomLine polarisSelector"\x3e\x3cdiv class\x3d"bottomRight" style\x3d"cursor: se-resize;"\x3e\x3c/div\x3e\x3cdiv class\x3d"bottomLeft" style\x3d"cursor: ne-resize;"\x3e\x3c/div\x3e\x3cdiv class\x3d"bottomMiddle" style\x3d"cursor: n-resize;"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"leftLine polarisSelector"\x3e\x3cdiv class\x3d"leftMiddle" style\x3d"cursor: w-resize;"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"rightLine polarisSelector"\x3e\x3cdiv class\x3d"rightMiddle" style\x3d"cursor: w-resize;"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
this.document);this.topLine=this.resizer.findOne(".topLine");this.bottomLine=this.resizer.findOne(".bottomLine");this.leftLine=this.resizer.findOne(".leftLine");this.rightLine=this.resizer.findOne(".rightLine");this.indicators.push(this.resizer.findOne(".topLeft"));this.indicators.push(this.resizer.findOne(".topRight"));this.indicators.push(this.resizer.findOne(".bottomRight"));this.indicators.push(this.resizer.findOne(".bottomLeft"));this.indicators.push(this.resizer.findOne(".topMiddle"));this.indicators.push(this.resizer.findOne(".rightMiddle"));
this.indicators.push(this.resizer.findOne(".bottomMiddle"));this.indicators.push(this.resizer.findOne(".leftMiddle"));this.document.objResize=this;a.on("destroy",function(){this.resizer&&this.resizer.remove()});e?this.document.getBody().append(this.resizer):this.document.getDocumentElement().append(this.resizer);this.update();for(var c=0,d=this.indicators.length;c<d;c++)this.indicators[c].on("mousedown",this.onMouseDown,this);this.document.on("mousemove",this.onMouseMove,this);this.document.on("mouseup",
this.onMouseUp,this)}},detach:function(a){this.resizer&&this.resizer.remove();a=0;for(var b=this.indicators.length;a<b;a++)this.indicators[a].removeListener("mousedown",this.onMouseDown);this.document&&this.document.removeListener("mousemove",this.onMouseMove);this.document&&this.document.removeListener("mouseup",this.onMouseUp);this.rightLine=this.leftLine=this.bottomLine=this.topLine=this.resizer=this.document=null;this.indicators=[];this.element=null;this.attached=!1;this.lastPos=this.clicked=
null},resize:function(a,b){var c=b.data.$.clientX-this.lastPos.x,d=b.data.$.clientY-this.lastPos.y;if("topMiddle"==a||"bottomMiddle"==a)c=0;else if("rightMiddle"==a||"leftMiddle"==a)d=0;var e=0,f=0;if("topLeft"==a||"topMiddle"==a||"topRight"==a)f=d,d*=-1;if("topLeft"==a||"leftMiddle"==a||"bottomLeft"==a)e=c,c*=-1;var c=this.widthPx+c,d=this.heightPx+d,e=this.leftPx+e,f=this.topPx+f,g=this.leftPx+this.widthPx-20,h=this.topPx+this.heightPx-20;20>c&&(c=20);20>d&&(d=20);e>g&&(e=g);f>h&&(f=h);this.setSize(e,
f,c,d)},cancel:function(a){(a.data||a).preventDefault()},onSizeChanged:function(a,b){var c=this.element;this.editor.fire("objectresize",{element:c,prevRect:a,currRect:b});var d=this.editor;POLARIS.tools.setTimeout(function(){d.fire("change",{isObjectResize:!0});var a=!1;c&&c.is("table")&&(a=!0);d.fire("contentChange",{type:"objectresize",isRelayoutAll:a})},0);this.update()}},d=function(a){a=a.editor;var d=a.getSelection(),e=d.getStartElement(),e=e?e.getAscendant(b,!0):null;d&&d.getRanges();POLARIS.tools.isInEditableElement(a,
e)?c.attach(a,e):c.detach(a)},h=function(a){c.attached&&POLARIS.tools.setTimeout(function(){c.update()},0)},g=function(a){a=a.editor;c&&c.detach(a)},k=function(a){a=a.editor;a.fire("lockSnapshot");c.detach(a);a.fire("unlockSnapshot")},f=function(a){a=a.editor;a.fire("lockSnapshot");c.detach(a);a.fire("unlockSnapshot")};POLARIS.plugins.add("objectresize",{lang:"en,ko",icons:"objectresize",hidpi:!0,init:function(a){a.on("selectionChange",d);a.on("change",h);a.on("zoom",h);a.on("paginationReady",h);
a.on("tableresize",h);a.on("changeEditMode",k);a.on("beforeContentPreview",f);a.on("beforeContentPrint",f);a.on("afterContentPrint",d);a.on("showTableBorder",h);a.on("contentDomUnload",g)}});POLARIS.plugins.objectresize={isAttached:function(a){return c.attached},attach:function(a,b){c.attach(a,b)},detach:function(a){c.detach(a)}}})();POLARIS.plugins.add("documentinfo",{requires:"dialog",init:function(a){POLARIS.dialog.add("documentInfo",POLARIS.getUrl(this.path+"dialogs/documentinfo.js"));a.ui.add("DocumentInfo",
POLARIS.UI_BUTTON,{label:a.lang.documentinfo.documentInfo.title,command:"documentInfo"});a.addCommand("documentInfo",{readOnly:1,exec:function(a,b){a.openDialog("documentInfo")}})}});(function(){var a=0,e=0;POLARIS.plugins.add("spellingcheck",{init:function(b){var c=[POLARIS.getUrl(this.path+"words/filterDictionary.js")];POLARIS.loadTemplates(c,function(){});b.addCommand("SpellingCheck",{exec:function(b,c){a=c.checkStart;e=c.searchContentOnly;b.execCommand("spellingcheck")}});b.addCommand("spellingcheck",
new POLARIS.dialogCommand("spellingcheck"));POLARIS.dialog.add("spellingcheck",this.path+"dialogs/spellingcheck.js")},getCheckStart:function(){return a},getSearchContentOnly:function(){return e}})})();POLARIS.config.spellingcheck_highlight={element:"span",styles:{"background-color":"#004",color:"#fff"}};POLARIS.config.plugins="dialogui,dialog,a11yhelp,about,aes,autogrow,basicstyles,bidi,bgimage,blockquote,button,clickhere,clipboard,panelbutton,panel,floatpanel,colorbutton,colordialog,menu,contextmenu,div,enterkey,entities,externalmedia,fakeobjects,find,popup,filebrowser,flash,floatingspace,listblock,richcombo,font,format,forms,horizontalrule,iframe,image,imageresize,indent,indentblock,indentlist,inputmethod,justify,toolbar,notification,notificationaggregator,license,lineutils,link,list,liststyle,magicline,maximize,menubutton,newpage,pagebreak,pagelayout,pastefromword,pastetext,preview,print,pubdocbody,table,quicktable,removeformat,save,scayt,selectall,sharedspace,showblocks,showborders,smiley,sourcearea,specialchar,stylescombo,symbol,tab,tabletools,tableresize,templates,undo,wysiwygarea,xml,ajax,documentconvert,elementspath,floating-tools,htmlwriter,inserttime,menubar,pagination,paragraphmargins,textbutton,ribbon,ruler,saveas,simpleuploads,titlebar,uicolor,quickaccesstoolbar,changecase,edit,zoom,grid,rubytext,paragraphline,movement,caption,blockcalculation,objectattribute,objectresize,documentinfo,spellingcheck";
POLARIS.config.skin="polaris";(function(){var a=function(a,b){var c=POLARIS.getUrl("plugins/"+b);a=a.split(",");for(var d=0;d<a.length;d++)POLARIS.skin.icons[a[d]]={path:c,offset:-a[++d],bgsize:a[++d]}};POLARIS.env.hidpi?a("about,0,49px,restriction,57,49px,shortcutmanual,114,49px,tablemanual,171,49px,usermanual,228,49px,bold,285,49px,italic,342,49px,strike,399,49px,subscript,456,49px,superscript,513,49px,textstyle,570,49px,underline,627,49px,bgimage,684,49px,bidiltr,741,49px,bidirtl,798,49px,blockquote,855,49px,insertcaption,912,49px,changecase,969,49px,changecharwidth,1026,49px,ribbon_big_ico_changecase,1083,49px,ribbon_big_ico_changecharwidth,1140,49px,copy-rtl,1197,49px,copy,1254,49px,copyformat,1311,49px,cut-rtl,1368,49px,cut,1425,49px,delete,1482,49px,paste-rtl,1539,49px,paste,1596,49px,popover_ico_notification,1653,49px,ribbon_big_ico_clear,1710,49px,ribbon_big_ico_copy-rtl,1767,49px,ribbon_big_ico_copy,1824,49px,ribbon_big_ico_copyformat,1881,49px,ribbon_big_ico_cut-rtl,1938,49px,ribbon_big_ico_cut,1995,49px,ribbon_big_ico_delete,2052,49px,ribbon_big_ico_paste-rtl,2109,49px,ribbon_big_ico_paste,2166,49px,ribbon_big_ico_pasteoption,2223,49px,ribbon_ico_image,2280,49px,bgcolor,2337,49px,textcolor,2394,49px,backwarddiv,2451,49px,creatediv,2508,49px,editdiv,2565,49px,forwarddiv,2622,49px,ribbon_big_ico_textbox,2679,49px,textbox,2736,49px,edit,2793,49px,ribbon_big_ico_edit,2850,49px,InsertExternalDocumentUrl,2907,49px,InsertExternalVideoUrl,2964,49px,ribbon_big_ico_insertexternaldocumenturl,3021,49px,ribbon_big_ico_insertexternalvideourl,3078,49px,movie_incoding,6270,auto,find-rtl,3192,49px,find,3249,49px,replace,3306,49px,ribbon_big_ico_find-rtl,3363,49px,ribbon_big_ico_find,3420,49px,ribbon_big_ico_replace,3477,49px,flash,3534,49px,font,3591,49px,fontshape,3648,49px,fontsize,3705,49px,letter-spacing,3762,49px,lineheight,3819,49px,ribbon_big_ico_fontshape,3876,49px,ribbon_big_ico_paragraphcopy,3933,49px,ribbon_big_ico_paragraphstyle,3990,49px,ribbon_big_ico_style,4047,49px,button,4104,49px,checkbox,4161,49px,form,4218,49px,hiddenfield,4275,49px,imagebutton,4332,49px,radio,4389,49px,ribbon_big_ico_textfield-rtl,4446,49px,ribbon_big_ico_textfield,4503,49px,select-rtl,4560,49px,select,4617,49px,textarea-rtl,4674,49px,textarea,4731,49px,textfield-rtl,4788,49px,textfield,4845,49px,grid,4902,49px,gridlineset,4959,49px,ribbon_big_ico_grid,5016,49px,ribbon_big_ico_gridlineset,5073,49px,horizontalrule,5130,49px,iframe,5187,49px,image,5244,49px,ribbon_big_ico_image,5301,49px,ribbon_big_ico_showimageborder,5358,49px,showimageborder,5415,49px,indent-rtl,5472,49px,indent,5529,49px,outdent-rtl,5586,49px,outdent,5643,49px,ribbon_big_ico_indent,5700,49px,ribbon_big_ico_outdent,5757,49px,filenamecode,5814,49px,inserttime,5871,49px,inserttimecode,5928,49px,ribbon_big_ico_date,5985,49px,timeformat,6042,49px,justifyblock,6099,49px,justifycenter,6156,49px,justifyleft,6213,49px,justifyright,6270,49px,anchor-rtl,6327,49px,anchor,6384,49px,link,6441,49px,ribbon_big_ico_anchor,6498,49px,ribbon_big_ico_link,6555,49px,unlink,6612,49px,bulledtednone,6669,49px,bulledtednone_kr,6726,49px,bulletedlist-rtl,6783,49px,bulletedlist,6840,49px,circlebulletedlist,6897,49px,decimalnumberedlist,6954,49px,discbulletedlist,7011,49px,loweralphanumberedlist,7068,49px,lowerromannumberedlist,7125,49px,numberedlist-rtl,7182,49px,numberedlist,7239,49px,paragraphformat,7296,49px,paragraphinit,7353,49px,ribbon_big_ico_bulletedlist-rtl,7410,49px,ribbon_big_ico_bulletedlist,7467,49px,ribbon_big_ico_multilevel,7524,49px,ribbon_big_ico_numberedparagraph,7581,49px,ribbon_big_ico_paragraphformat,7638,49px,squarebulletedlist,7695,49px,upperalphanumberedlist,7752,49px,upperromannumberedlist,7809,49px,ribbon_big_ico_numberedlist-rtl,15732,auto,ribbon_big_ico_numberedlist,15846,auto,ribbon_big_ico_numberedparagraphformat,15960,auto,maximize,8037,49px,minimize,8094,49px,ribbon_big_ico_maximize,8151,49px,ribbon_big_ico_minimize,8208,49px,selected_check,8265,49px,movement,8322,49px,ribbon_big_ico_movement,8379,49px,newpage-rtl,8436,49px,newpage,8493,49px,objectattribute,8550,49px,pagebreak-rtl,8607,49px,pagebreak,8664,49px,pagelayout-rtl,8721,49px,pagelayout,8778,49px,footendnotestyle,17670,auto,breakpage,8892,49px,endnote,8949,49px,footendnotechange,9006,49px,footendnoteform,9063,49px,footendnotesave,9120,49px,footnote,9177,49px,headerfooter,9234,49px,pagenewnumber,9291,49px,pagenumber,9348,49px,pagenumberhide,9405,49px,pageoutline,9462,49px,pageoutlinebg,9519,49px,paragraphform,9576,49px,ribbon_big_ico_breakpage,9633,49px,ribbon_big_ico_endnote,9690,49px,ribbon_big_ico_footendnotechange,9747,49px,ribbon_big_ico_footendnotesave,9804,49px,ribbon_big_ico_footendnotestyle,9861,49px,ribbon_big_ico_footnote,9918,49px,ribbon_big_ico_headerfooter,9975,49px,ribbon_big_ico_headerpooter,10032,49px,ribbon_big_ico_pagenewnumber,10089,49px,ribbon_big_ico_pagenumber,10146,49px,ribbon_big_ico_pagenumberhide,10203,49px,ribbon_big_ico_pageoutline,10260,49px,ribbon_big_ico_pageoutlinebg,10317,49px,ribbon_big_ico_paragraphform,10374,49px,ribbon_big_ico_togglepageoutline,10431,49px,togglepageoutline,10488,49px,paragraphline,10545,49px,ribbon_big_ico_paragraphline,10602,49px,paragraphmargins,10659,49px,pastefromword-rtl,10716,49px,pastefromword,10773,49px,pastetext-rtl,10830,49px,pastetext,10887,49px,preview-rtl,10944,49px,preview,11001,49px,print,11058,49px,ribbon_big_ico_print,11115,49px,removeformat,11172,49px,setting,11229,49px,ribbon_big_ico_rubytext,11286,49px,rubytext,11343,49px,ruler_controller_bottom_n,22800,auto,ruler_controller_bottom_p,22914,auto,ruler_controller_synchronize_bottom_n,23028,auto,ruler_controller_synchronize_bottom_p,23142,auto,ruler_controller_top_n,23256,auto,ruler_controller_top_p,23370,auto,save,11742,49px,scayt,11799,49px,ribbon_big_ico_selectall,11856,49px,selectall,11913,49px,showblocks-rtl,11970,49px,showblocks,12027,49px,showborders,12084,49px,addfile,24282,auto,addimage,24396,auto,smiley,12255,49px,source-rtl,12312,49px,source,12369,49px,ribbon_big_ico_specialchar,12426,49px,specialchar,12483,49px,format,12540,49px,ribbon_big_ico_symbol,25194,auto,symbol,25308,auto,ribbon_big_ico_showtableborder,12711,49px,showtableborder,12768,49px,addcomma,12825,49px,applyassinglecell,12882,49px,applyforeachcell,12939,49px,blockcalcavg,12996,49px,blockcalcsum,13053,49px,cellblockaverage,13110,49px,cellblockdouble,13167,49px,cellblocksum,13224,49px,cellcontentclear,13281,49px,cellhorizontalsplit,13338,49px,cellmerge,13395,49px,cellmergecancel,13452,49px,cellproperties,13509,49px,cellsplit,13566,49px,cellverticalsplit,13623,49px,columnaverage,13680,49px,columndelete,13737,49px,columninsertafter,13794,49px,columninsertbefore,13851,49px,columnmultiply,13908,49px,columnsum,13965,49px,ribbon_big_ico_blockcalc,14022,49px,ribbon_big_ico_blockcalcavg,14079,49px,ribbon_big_ico_blockcalcsum,14136,49px,ribbon_big_ico_cellblockaverage,14193,49px,ribbon_big_ico_cellblockmultiply,14250,49px,ribbon_big_ico_cellblocksum,14307,49px,ribbon_big_ico_cellborder,14364,49px,ribbon_big_ico_cellcontentclear,14421,49px,ribbon_big_ico_celldelete,14478,49px,ribbon_big_ico_cellinsert,14535,49px,ribbon_big_ico_cellmerge,14592,49px,ribbon_big_ico_cellmergecancel,14649,49px,ribbon_big_ico_cellproperties,14706,49px,ribbon_big_ico_cellsplit,14763,49px,ribbon_big_ico_sameheight,14820,49px,ribbon_big_ico_samewidth,14877,49px,ribbon_big_ico_simplecalc,14934,49px,ribbon_big_ico_sort,14991,49px,ribbon_big_ico_table,15048,49px,ribbon_big_ico_tableproperties,15105,49px,ribbon_big_ico_tablestyle,15162,49px,ribbon_big_ico_thousandanize,15219,49px,rowaverage,15276,49px,rowdelete,15333,49px,rowinsertafter,15390,49px,rowinsertbefore,15447,49px,rowmultiply,15504,49px,rowsum,15561,49px,sameheight,15618,49px,samewidth,15675,49px,sort,15732,49px,tablecenter,15789,49px,tableindent,15846,49px,tableleft,15903,49px,tableoutdent,15960,49px,tableproperties,16017,49px,tableright,16074,49px,thousandanize,16131,49px,verticalalignbottom,16188,49px,verticalalignmiddle,16245,49px,verticalaligntop,16302,49px,table,32718,auto,templates-rtl,16416,49px,templates,16473,49px,uicolor,16530,49px,redo-rtl,16587,49px,redo,16644,49px,undo-rtl,16701,49px,undo,16758,49px,ribbon_big_ico_zoom,16815,49px,zoom,16872,49px,zoomcombo,16929,49px",
"icons_hidpi.png"):a("about,0,auto,restriction,57,auto,shortcutmanual,114,auto,tablemanual,171,auto,usermanual,228,auto,bold,285,auto,italic,342,auto,strike,399,auto,subscript,456,auto,superscript,513,auto,textstyle,570,auto,underline,627,auto,bgimage,684,auto,bidiltr,741,auto,bidirtl,798,auto,blockquote,855,auto,insertcaption,912,auto,changecase,969,auto,changecharwidth,1026,auto,ribbon_big_ico_changecase,1083,auto,ribbon_big_ico_changecharwidth,1140,auto,copy-rtl,1197,auto,copy,1254,auto,copyformat,1311,auto,cut-rtl,1368,auto,cut,1425,auto,delete,1482,auto,paste-rtl,1539,auto,paste,1596,auto,popover_ico_notification,1653,auto,ribbon_big_ico_clear,1710,auto,ribbon_big_ico_copy-rtl,1767,auto,ribbon_big_ico_copy,1824,auto,ribbon_big_ico_copyformat,1881,auto,ribbon_big_ico_cut-rtl,1938,auto,ribbon_big_ico_cut,1995,auto,ribbon_big_ico_delete,2052,auto,ribbon_big_ico_paste-rtl,2109,auto,ribbon_big_ico_paste,2166,auto,ribbon_big_ico_pasteoption,2223,auto,ribbon_ico_image,2280,auto,bgcolor,2337,auto,textcolor,2394,auto,backwarddiv,2451,auto,creatediv,2508,auto,editdiv,2565,auto,forwarddiv,2622,auto,ribbon_big_ico_textbox,2679,auto,textbox,2736,auto,edit,2793,auto,ribbon_big_ico_edit,2850,auto,InsertExternalDocumentUrl,2907,auto,InsertExternalVideoUrl,2964,auto,movie_incoding,3021,auto,find-rtl,3078,auto,find,3135,auto,replace,3192,auto,ribbon_big_ico_find-rtl,3249,auto,ribbon_big_ico_find,3306,auto,ribbon_big_ico_replace,3363,auto,flash,3420,auto,font,3477,auto,fontshape,3534,auto,fontsize,3591,auto,letter-spacing,3648,auto,lineheight,3705,auto,ribbon_big_ico_fontshape,3762,auto,ribbon_big_ico_paragraphcopy,3819,auto,ribbon_big_ico_paragraphstyle,3876,auto,ribbon_big_ico_style,3933,auto,button,3990,auto,checkbox,4047,auto,form,4104,auto,hiddenfield,4161,auto,imagebutton,4218,auto,radio,4275,auto,ribbon_big_ico_textfield-rtl,4332,auto,ribbon_big_ico_textfield,4389,auto,select-rtl,4446,auto,select,4503,auto,textarea-rtl,4560,auto,textarea,4617,auto,textfield-rtl,4674,auto,textfield,4731,auto,grid,4788,auto,gridlineset,4845,auto,ribbon_big_ico_grid,4902,auto,ribbon_big_ico_gridlineset,4959,auto,horizontalrule,5016,auto,iframe,5073,auto,image,5130,auto,ribbon_big_ico_image,5187,auto,ribbon_big_ico_showimageborder,5244,auto,showimageborder,5301,auto,indent-rtl,5358,auto,indent,5415,auto,outdent-rtl,5472,auto,outdent,5529,auto,ribbon_big_ico_indent,5586,auto,ribbon_big_ico_outdent,5643,auto,filenamecode,5700,auto,inserttime,5757,auto,inserttimecode,5814,auto,ribbon_big_ico_date,5871,auto,timeformat,5928,auto,justifyblock,5985,auto,justifycenter,6042,auto,justifyleft,6099,auto,justifyright,6156,auto,anchor-rtl,6213,auto,anchor,6270,auto,link,6327,auto,ribbon_big_ico_anchor,6384,auto,ribbon_big_ico_link,6441,auto,unlink,6498,auto,bulledtednone,6555,auto,bulledtednone_kr,6612,auto,bulletedlist-rtl,6669,auto,bulletedlist,6726,auto,circlebulletedlist,6783,auto,decimalnumberedlist,6840,auto,discbulletedlist,6897,auto,loweralphanumberedlist,6954,auto,lowerromannumberedlist,7011,auto,numberedlist-rtl,7068,auto,numberedlist,7125,auto,paragraphformat,7182,auto,paragraphinit,7239,auto,ribbon_big_ico_bulletedlist-rtl,7296,auto,ribbon_big_ico_bulletedlist,7353,auto,ribbon_big_ico_multilevel,7410,auto,ribbon_big_ico_numberedlist-rtl,7467,auto,ribbon_big_ico_numberedlist,7524,auto,ribbon_big_ico_numberedparagraph,7581,auto,ribbon_big_ico_numberedparagraphformat,7638,auto,squarebulletedlist,7695,auto,upperalphanumberedlist,7752,auto,upperromannumberedlist,7809,auto,maximize,7866,auto,minimize,7923,auto,ribbon_big_ico_maximize,7980,auto,ribbon_big_ico_minimize,8037,auto,selected_check,8094,auto,movement,8151,auto,ribbon_big_ico_movement,8208,auto,newpage-rtl,8265,auto,newpage,8322,auto,objectattribute,8379,auto,pagebreak-rtl,8436,auto,pagebreak,8493,auto,pagelayout-rtl,8550,auto,pagelayout,8607,auto,breakpage,8664,auto,endnote,8721,auto,footendnotechange,8778,auto,footendnotesave,8835,auto,footendnotestyle,8892,auto,footnote,8949,auto,headerfooter,9006,auto,pagenewnumber,9063,auto,pagenumber,9120,auto,pagenumberhide,9177,auto,pageoutline,9234,auto,pageoutlinebg,9291,auto,paragraphform,9348,auto,ribbon_big_ico_breakpage,9405,auto,ribbon_big_ico_endnote,9462,auto,ribbon_big_ico_footendnotechange,9519,auto,ribbon_big_ico_footendnotesave,9576,auto,ribbon_big_ico_footendnotestyle,9633,auto,ribbon_big_ico_footnote,9690,auto,ribbon_big_ico_headerfooter,9747,auto,ribbon_big_ico_headerpooter,9804,auto,ribbon_big_ico_pagenewnumber,9861,auto,ribbon_big_ico_pagenumber,9918,auto,ribbon_big_ico_pagenumberhide,9975,auto,ribbon_big_ico_pageoutline,10032,auto,ribbon_big_ico_pageoutlinebg,10089,auto,ribbon_big_ico_paragraphform,10146,auto,ribbon_big_ico_togglepageoutline,10203,auto,togglepageoutline,10260,auto,paragraphline,10317,auto,ribbon_big_ico_paragraphline,10374,auto,paragraphmargins,10431,auto,pastefromword-rtl,10488,auto,pastefromword,10545,auto,pastetext-rtl,10602,auto,pastetext,10659,auto,preview-rtl,10716,auto,preview,10773,auto,print,10830,auto,ribbon_big_ico_print,10887,auto,removeformat,10944,auto,setting,11001,auto,ribbon_big_ico_rubytext,11058,auto,rubytext,11115,auto,ruler_controller_bottom_n,11172,auto,ruler_controller_bottom_p,11229,auto,ruler_controller_synchronize_bottom_n,11286,auto,ruler_controller_synchronize_bottom_p,11343,auto,ruler_controller_top_n,11400,auto,ruler_controller_top_p,11457,auto,save,11514,auto,scayt,11571,auto,ribbon_big_ico_selectall,11628,auto,selectall,11685,auto,showblocks-rtl,11742,auto,showblocks,11799,auto,showborders,11856,auto,addfile,11913,auto,addimage,11970,auto,smiley,12027,auto,source-rtl,12084,auto,source,12141,auto,ribbon_big_ico_specialchar,12198,auto,specialchar,12255,auto,format,12312,auto,ribbon_big_ico_symbol,12369,auto,symbol,12426,auto,ribbon_big_ico_showtableborder,12483,auto,showtableborder,12540,auto,addcomma,12597,auto,applyassinglecell,12654,auto,applyforeachcell,12711,auto,blockcalcavg,12768,auto,blockcalcsum,12825,auto,cellblockaverage,12882,auto,cellblockdouble,12939,auto,cellblocksum,12996,auto,cellcontentclear,13053,auto,cellhorizontalsplit,13110,auto,cellmerge,13167,auto,cellmergecancel,13224,auto,cellproperties,13281,auto,cellsplit,13338,auto,cellverticalsplit,13395,auto,columnaverage,13452,auto,columndelete,13509,auto,columninsertafter,13566,auto,columninsertbefore,13623,auto,columnmultiply,13680,auto,columnsum,13737,auto,ribbon_big_ico_blockcalc,13794,auto,ribbon_big_ico_blockcalcavg,13851,auto,ribbon_big_ico_blockcalcsum,13908,auto,ribbon_big_ico_cellblockaverage,13965,auto,ribbon_big_ico_cellblockmultiply,14022,auto,ribbon_big_ico_cellblocksum,14079,auto,ribbon_big_ico_cellborder,14136,auto,ribbon_big_ico_celldelete,14193,auto,ribbon_big_ico_cellinsert,14250,auto,ribbon_big_ico_cellmerge,14307,auto,ribbon_big_ico_cellmergecancel,14364,auto,ribbon_big_ico_cellproperties,14421,auto,ribbon_big_ico_cellsplit,14478,auto,ribbon_big_ico_sameheight,14535,auto,ribbon_big_ico_samewidth,14592,auto,ribbon_big_ico_simplecalc,14649,auto,ribbon_big_ico_sort,14706,auto,ribbon_big_ico_table,14763,auto,ribbon_big_ico_tableproperties,14820,auto,ribbon_big_ico_tablestyle,14877,auto,ribbon_big_ico_thousandanize,14934,auto,rowaverage,14991,auto,rowdelete,15048,auto,rowinsertafter,15105,auto,rowinsertbefore,15162,auto,rowmultiply,15219,auto,rowsum,15276,auto,sameheight,15333,auto,samewidth,15390,auto,sort,15447,auto,table,15504,auto,tablecenter,15561,auto,tableindent,15618,auto,tableleft,15675,auto,tableoutdent,15732,auto,tableproperties,15789,auto,tableright,15846,auto,thousandanize,15903,auto,verticalalignbottom,15960,auto,verticalalignmiddle,16017,auto,verticalaligntop,16074,auto,templates-rtl,16131,auto,templates,16188,auto,uicolor,16245,auto,redo-rtl,16302,auto,redo,16359,auto,undo-rtl,16416,auto,undo,16473,auto,ribbon_big_ico_zoom,16530,auto,zoom,16587,auto,zoomcombo,16644,auto",
"icons.png")})()}})();