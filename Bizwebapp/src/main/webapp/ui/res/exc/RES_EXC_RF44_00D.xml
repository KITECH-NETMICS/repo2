<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="연구비입금관리상세">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            	<w2:dataList baseNode="list" repeatNode="map" id="dlt_recv" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="accnt_no" name="계정번호" dataType="text"></w2:column>
            			<w2:column id="depst_odr" name="입금순번" dataType="text"></w2:column>
            			<w2:column id="reschamt_clsf" name="연구비구분" dataType="text"></w2:column>
            			<w2:column id="reschamt_clsf_nm" name="연구비구분명" dataType="text"></w2:column>
            			<w2:column id="depst_schdl_amt" name="입금예정금액" dataType="text"></w2:column>
            			<w2:column id="depst_schdl_ymd" name="입금예정일자" dataType="text"></w2:column>
            			<w2:column id="ofic_depst_amt" name="실입금금액" dataType="text"></w2:column>
            			<w2:column id="ofic_depst_ymd" name="실입금일자" dataType="text"></w2:column>
            			<w2:column id="depst_loc" name="입금처" dataType="text"></w2:column>
            			<w2:column id="depst_loc_nm" name="입금처명" dataType="text"></w2:column>
            			<w2:column id="unusual_item" name="특이사항" dataType="text"></w2:column>
            			<w2:column id="uncollected_amt" name="미수총액" dataType="text"></w2:column>
            			<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" repeatNode="map" id="dlt_rectl" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="accnt_no" name="계정번호" dataType="text"></w2:column>
            			<w2:column id="depst_odr" name="차수" dataType="text"></w2:column>
            			<w2:column id="odr" name="순번" dataType="text"></w2:column>
            			<w2:column id="ofic_depst_amt" name="실입금금액" dataType="text"></w2:column>
            			<w2:column id="ofic_depst_ymd" name="실입금일" dataType="text"></w2:column>
            			<w2:column id="depst_clsf" name="입금구분" dataType="text"></w2:column>
            			<w2:column id="prmsnt_no" name="어음번호" dataType="text"></w2:column>
            			<w2:column id="depst_loc" name="입금처" dataType="text"></w2:column>
            			<w2:column id="depst_loc_nm" name="입금처명" dataType="text"></w2:column>
            			<w2:column id="demnd_bill_no" name="청구계산서번호" dataType="text"></w2:column>
            			<w2:column id="recv_bill_no" name="영수계산서번호" dataType="text"></w2:column>
            			<w2:column id="bankaccnt_no" name="계좌번호" dataType="text"></w2:column>
            			<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
            			<w2:column id="depst_state" name="입금상태" dataType="text"></w2:column>
            			<w2:column id="depst_req_no" name="입금의뢰번호" dataType="text"></w2:column>
            			<w2:column id="bank" name="은행" dataType="text"></w2:column>
            			<w2:column id="bank_nm" name="은행명" dataType="text"></w2:column>
            			<w2:column id="req_ymd" name="신청일자" dataType="text"></w2:column>
            			<w2:column id="req_psn" name="신청자" dataType="text"></w2:column>
            			<w2:column id="demnd_req_no" name="청구의뢰번호" dataType="text"></w2:column>
            			<w2:column id="req_no" name="결재신청번호" dataType="text"></w2:column>
            			<w2:column id="attach_file" name="첨부파일번호" dataType="text"></w2:column>
            			<w2:column id="depst_req_amt" name="입금의뢰금액" dataType="text"></w2:column>
            			<w2:column id="rmk" name="비고" dataType="text"></w2:column>
            			<w2:column id="demnd_liq" name="청구금액" dataType="text"></w2:column>
            			<w2:column id="issu_ymd" name="청구계산서발행일자" dataType="text"></w2:column>
            			<w2:column id="slip_no" name="청구결의확정번호" dataType="text"></w2:column>
            			<w2:column id="slip_odr" name="확정순번" dataType="text"></w2:column>
            			<w2:column id="accnt_ymd" name="확정일자" dataType="text"></w2:column>
            			<w2:column id="apr_state" name="입금의뢰결재상태" dataType="text"></w2:column>
            			<w2:column id="recv_liq" name="계산서영수금액" dataType="text"></w2:column>
            			<w2:column id="slip_ymd" name="결의일자" dataType="text"></w2:column>
            			<w2:column id="chk" name="선택" dataType="text"></w2:column>
            			<w2:column id="state_nm" name="전자발행여부" dataType="text"></w2:column>
            			<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
            			<w2:column id="old_data_yn" name="수기입력여부" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_search" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="accnt_no" name="계정번호"></w2:key>
            			<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
            			<w2:key id="depst_odr" name="예정차수" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_prj">
            		<w2:keyInfo>
            			<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
            			<w2:key id="prj_no" name="과제번호" dataType="text"></w2:key>
            			<w2:key id="accnt_no_nm" name="계정번호명" dataType="text"></w2:key>
            			<w2:key id="accnt_rspns" name="계정책임자" dataType="text"></w2:key>
            			<w2:key id="start_ymd" name="시작일자" dataType="text"></w2:key>
            			<w2:key id="cls_ymd" name="종료일자" dataType="text"></w2:key>
            			<w2:key id="accnt_state" name="계정상태" dataType="text"></w2:key>
            			<w2:key id="tax_cd" name="과세코드" dataType="text"></w2:key>
            			<w2:key id="itm_solve_base" name="비목해소기준" dataType="text"></w2:key>
            			<w2:key id="accnt_clsf" name="계정구분" dataType="text"></w2:key>
            			<w2:key id="card_use_ex" name="연구비구분" dataType="text"></w2:key>
            			<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
            			<w2:key id="accnt_rspns_nm" name="계정책임자성명" dataType="text"></w2:key>
            			<w2:key id="bsns_cd_bsns_nm" name="사업구분" dataType="text"></w2:key>
            			<w2:key id="tot_resch_cash_amt" name="총연구금액(현금)" dataType="text"></w2:key>
            			<w2:key id="tax_amt" name="총연구금액(부가세)" dataType="text"></w2:key>
            			<w2:key id="tot_resch_cash_tax_amt" name="입금연구비(부가세포함)" dataType="text"></w2:key>
            			<w2:key id="posi_nm" name="계정책임자직급" dataType="text"></w2:key>
            			<w2:key id="dept_nm" name="계정책임자소속" dataType="text"></w2:key>

            			<w2:key id="curr_resch_rspns_nm" name="연구책임자성명" dataType="text"></w2:key>
            			<w2:key id="curr_posi_nm" name="연구책임자직급" dataType="text"></w2:key>
            			<w2:key id="curr_dept_nm" name="연구책임자소속" dataType="text"></w2:key>
            			<w2:key id="vacct_no" name="가상계좌" dataType="text"></w2:key>
            			<w2:key id="prj_kind" name="과제참여유형" dataType="text"></w2:key>
            			<w2:key id="bsns_cd_inout" name="사업코드내외" dataType="text"></w2:key>
            			<w2:key id="bsns_req_no" name="사업신청번호" dataType="text"></w2:key>
            			<w2:key id="bsns_cd_ofic" name="사업부처" dataType="text"></w2:key>
            			<w2:key id="bankaccnt_type" name="연구비입금구분" dataType="text"></w2:key>
            			<w2:key id="vend_cd" name="업체코드" dataType="text"></w2:key>
            			<w2:key id="vend_nm" name="업체명" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            </w2:dataCollection>
            <w2:workflowCollection/>
            <!-- 조회 -->
			<xf:submission id="sbm_selectData" ref="data:json,dma_search" target='data:json,[{"id":"dma_prj","key":"prjVo"},{"id":"dlt_recv","key":"recvList"}]' 
        	    action="SvcRESEXCDEPR02.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 입금상세내역 조회 -->
			<xf:submission id="sbm_selectBgRectl" ref="data:json,dma_search" target='' 
        	    action="SvcRESEXCDEPR03.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 저장 -->
			<xf:submission id="sbm_saveData" ref='data:json,[{"action":"modified","id":"dlt_rectl","key":"rectlList"},{"action":"modified","id":"dlt_recv","key":"recvList"}]' 
				target='' 
        	    action="SvcRESEXCDEPM01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결재신청 -->
			<xf:submission id="sbm_saveApr" ref='data:json,[{"action":"modified", "id":"dlt_rectl","key":"rectlList"},{"id":"dma_prj","key":"prjVo"}]' 
				target='' 
        	    action="SvcRESEXCDEPM03.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        </xf:model>
         <script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
 	 * 화면 설명 : 연구비입금관리 상세
 	 * 변경 이력 : 2023-04-19	이영희	최초 작성
 	 * 서비스아이디 : RF44
 	 ****************************************************/  
 	scwin.data = {};
    /*
     * 페이지 열기
     */          
	scwin.onpageload = function() {			
		// 공통코드
		var codeOptions = [ { code : "RAK", compID : "sbx_accnt_state"}
		                  , { code : "RAR", compID : "sbx_accnt_clsf"} // 계정구분
		                  , { code : "RDD", compID : "grd_recv:reschamt_clsf"}  // 연구비구분
		                  , { code : "RDE", compID : "grd_rectl:depst_clsf"} // 입금구분
		                  , { code : "FAA", compID : "grd_rectl:bank"}
		                  , { code : "RDF", compID : "grd_rectl:depst_state"} // 입금상태
		                  , { code : "XAD", compID : "grd_rectl:apr_state"}
		                  , { code : "FAJ", compID : "sbx_card_use_ex"}
		               ];		
		com.setCmnCd(codeOptions, function(){
			var param = com.getParameter();
			if(param.param4 == "apr"){
				if(param.req_no.substring(0, 3) == "R11"){ // 업무대기함에서 넘어온 경우
					scwin.data.mainKey = param.req_no;
					
					com.pop.open(com.pop.TYPE.ACNNO, {bsns_req_no : param.req_no}, function(ret) {
						if(ret && ret.accnt_no != ""){
							dma_search.set("accnt_no", ret.accnt_no);							
							scwin.search();
						}
					});	
				}else{					
					dma_search.set("req_no", param.req_no);							
					scwin.search();
				}
			}else{
				scwin.data.mainKey = param.bsns_req_no;
				
				dma_search.set("accnt_no", param.accnt_no);
				scwin.search();
			}
		});		
	};
	
	scwin.onpageunload = function() {
		
	};	
	
	/*
     *  조회
     */
	scwin.search = function() {
		com.execute(sbm_selectData, {
			successCallback : function(e){
				dma_search.set("accnt_no", dma_prj.get("accnt_no"));
				
				if(scwin.data.mainKey == undefined){
					scwin.data.mainKey = dma_prj.get("bsns_req_no");	
				}
				
				spn_prd.setValue(com.formatDate(dma_prj.get("start_ymd"), "dash") + " ~ " + com.formatDate(dma_prj.get("cls_ymd"),"dash"));
				
				// 결재화면에서 넘어온 경우 입금상세내역을 뿌려주고 입금예정내역의 해당행에 포커스를 준다.
				if(e.responseJSON.elData.rectlList != undefined){
					dlt_rectl.setJSON(e.responseJSON.elData.rectlList);
					
					grd_recv.setFocusedCell(dlt_recv.getMatchedIndex("depst_odr", dlt_rectl.getCellData(0, "depst_odr"), true)[0], 0);
				}else{
					if(scwin.data.recvRow !== ""){
						grd_recv.setFocusedCell(scwin.data.recvRow, 0);
						scwin.searchRectl(scwin.data.recvRow);
					}else{
						grd_recv.setFocusedCell(0, 0);
						scwin.searchRectl(0);
					}
				}
			}
		});
	};	
	
	/*
     *  실입금액 재계산
     */
	scwin.getOficDepstAmt = function(row){
		// 입금내역의 실입금액이 입금예정내역의 실입금액과 다른 경우 
		if(grd_rectl.getFooterData("ofic_depst_amt_sum") != '0' && tbx_ofic_depst_amt.getValue() != grd_rectl.getFooterData("ofic_depst_amt_sum")){
			var oficDepstAmtSum = com.parseInt(grd_rectl.getFooterData("ofic_depst_amt_sum"));
			
			dlt_recv.setCellData(row, "ofic_depst_amt", oficDepstAmtSum);
			dlt_recv.setCellData(row, "uncollected_amt", com.parseInt(dlt_recv.getCellData(row, "depst_schdl_amt")) - oficDepstAmtSum);
			tbx_ofic_depst_amt.setValue(dlt_recv.getCellData(row, "ofic_depst_amt"));
		}
	};
	
	/*
     * 입금상세내역 조회
     */
	scwin.searchRectl = function(row){
		dma_search.set("depst_odr", dlt_recv.getCellData(row, "depst_odr"));
		
		com.execute(sbm_selectBgRectl, {
			successCallback : function(e){
				dlt_rectl.setJSON(e.responseJSON.resBgRectlVoList);	
				btn_save.setDisabled(false);
				
				if(dlt_rectl.getRowCount() > 0){
					grd_recv.getCellDisabled(row, "reschamt_clsf", true);
				}else{
					grd_recv.getCellDisabled(row, "reschamt_clsf", false);
					btn_print.setDisabled(true);
				}

				// 실입금액 계산
				scwin.getOficDepstAmt(row);
				
				for(var i=0; i<dlt_rectl.getRowCount(); i++){
					if(dlt_rectl.getCellData(i, "depst_req_no") != ""){
						if(dlt_rectl.getCellData(i, "demnd_req_no") == ""){
							grd_rectl.getCellDisabled(i, "demnd_req_no", true);
						}
						grd_rectl.getCellDisabled(i, "depst_clsf", true);
					}	
					
					if(dlt_rectl.getCellData(i, "req_no") != ""){
						btn_print.setDisabled(false);
					}
					
					if(dlt_rectl.getCellData(i, "apr_state") >= "XAD020"){
						grd_rectl.setCellDisabled(i, "chk", true);
					}else{
						grd_rectl.setCellDisabled(i, "chk", false);
					}
				}
			}
		});
	};
	
	/**
	 * 입금구분 구하기
	 */
	scwin.getDepstClsf = function(reschAmtClsf){
		switch(reschAmtClsf){
			case "RDD006" : depstClsf = "FBD012"; break; // 참여기관연구비
			case "RDD007" : depstClsf = "FBD016"; break; // 기업부설연구비
			default : depstClsf = "FBD011"; break; // 연구비 (재무 입금구분 기본값)
		}
		
		return depstClsf;
	};
	
	/**
	 * 청구의뢰 또는 입금의뢰 전 체크
	 */
	scwin.checkDemndRecv = function(row, clsf){
		if(tbx_depst_odr.getValue() == "" || tbx_depst_odr.getValue() == "0"){
			alert("입금예정내역의 차수를 선택하세요.");
			return;
		}
		
		var reschAmtClsf = dlt_recv.getCellData(scwin.data.recvRow, "reschamt_clsf");
		
		// RDD002 민간입금
		if(reschAmtClsf == "RDD002" && /FAJ004|FAJ005/.test(dma_prj.get("card_use_ex"))){
			alert("민간입금 RCMS/POINT 과제는 " + ((clsf == "DEMND")?"청구의뢰" : "입금의뢰") + "를 할 수 없습니다.");
			return false;
		}
		
		if(dlt_rectl.getCellData(row, "cud_type") == "C"){
			alert("연구비 입금내역이 신규(저장 전) 상태입니다. 먼저 저장하세요.");
			return false;
		}
		
		if(clsf == "DEMND"){
			if(dlt_rectl.getCellData(row, "depst_req_no") != "" && dlt_rectl.getCellData(row, "demnd_bill_no") == ""){
				alert("입금의뢰가 된건으로 청구의뢰를 할 수 없습니다.");
				return false;
			}
			
			if(dlt_rectl.getCellData(row, "recv_bill_no") != ""){
				alert("영수계산서가 존재하므로 청구의뢰를 할 수 없습니다.");
				return false;
			}
		}else{
			if(/RDE001|RDE002|RDE004/.test(dlt_rectl.getCellData(row, "depst_clsf"))){ // 입금구분 in (은행어음, 공증어음, 가계수표(어음))
				var prmsntNo = dlt_rectl.getCellData(row, "prmsnt_no").trim(); // 어음번호
				var oficDepstAmt = WebSquare.util.parseInt(dlt_rectl.getCellData(row, "ofic_depst_amt"), 0); // 실입금액
				var oficDepstYmd = dlt_rectl.getCellData(row, "ofic_depst_ymd"); // 입금일자
				if (prmsntNo == "" || oficDepstAmt == 0 || oficDepstYmd.trim() == "") {
					alert("입금구분이 어음인 경우에는 어음번호, 실입금액, 입금일자를 모두 입력, 저장한 후 입금의뢰할 수 있습니다.");
					return false;
				}
			}			
		}	
		
		return true;
	};
	
	/**
	 * 청구의뢰 팝업 오픈
	 */
	scwin.openDemndReq = function(row){			
		var data={
			req_no : dlt_rectl.getCellData(row, "demnd_req_no"),
			accnt_no : dma_prj.get("accnt_no"),
			depst_odr : dlt_rectl.getCellData(row, "depst_odr"),
			odr : dlt_rectl.getCellData(row, "odr"),
			depst_clsf : scwin.getDepstClsf(dlt_recv.getCellData(scwin.data.recvRow, "reschamt_clsf"))
		};
		
		var options = {
			id : "ResDemndReq",
			popupName : "연구비청구의뢰",
			width : 1080, height: 700
		};
		com.openPopup("/ui/res/exc/RES_EXC_RF42_01P.xml", options, data, function(ret) {
			// 팝업 콜백
			scwin.searchRectl(scwin.data.recvRow);
		});	
	};	
	
	/**
	 * 입금의뢰 팝업 오픈
	 */
	scwin.openDepstReq = function(row){
		if(dlt_rectl.getCellData(row, "unslip_no") != "" && dlt_rectl.getCellData(row, "unslip_no").substring(0,1) != "4"){
			alert("수기입력한 내역입니다. 입금의뢰내역이 존재하지 않습니다.");
			return;	
		}		
		
		if(dlt_rectl.getCellData(row, "demnd_req_no") != ""){
			if(dlt_rectl.getCellData(row, "accnt_ymd").trim() == ""){
				alert("연구비 청구의뢰결의가 확정되지 않았습니다.");
				return;	
			}
			
			var data={
				req_no : dlt_rectl.getCellData(row, "req_no"),
				depst_req_no : dlt_rectl.getCellData(row, "depst_req_no"),
				accnt_no : dma_prj.get("accnt_no"),
				depst_odr : dlt_rectl.getCellData(row, "depst_odr"),
				odr : dlt_rectl.getCellData(row, "odr"),
				demnd_req_no : dlt_rectl.getCellData(row, "demnd_req_no")
			};
			
			var options = {
				id : "ResRepayReq",
				popupName : "연구비반제신청",
				width : 1080, height: 750
			};
			com.openPopup("/ui/res/exc/RES_EXC_RF63_01P.xml", options, data, function(ret) {
				// 팝업 콜백
				scwin.search();
			});
		}else{
			var data={
				apr_req_no : dlt_rectl.getCellData(row, "req_no"),
				req_no : dlt_rectl.getCellData(row, "depst_req_no"),
				accnt_no : dma_prj.get("accnt_no"),
				depst_odr : dlt_rectl.getCellData(row, "depst_odr"),
				odr : dlt_rectl.getCellData(row, "odr"),
				biz_clsf : "R",
				vend_cd : dlt_rectl.getCellData(row, "depst_loc"),
				vend_abbr : dlt_rectl.getCellData(row, "depst_loc_nm"),
				depst_clsf : scwin.getDepstClsf(dlt_recv.getCellData(scwin.data.recvRow, "reschamt_clsf"))
			};
			
			com.pop.open(com.pop.TYPE.DEPST_REQ, data, function(ret){
				if(ret){
					// 팝업 콜백
					btn_save.setDisabled(true);
					scwin.search();
				}
			});
		}
	};
	// ------------------------------------ event 함수 ---------------------------------------------//
	/*
     *  목록버튼 클릭 이벤트
     */
	scwin.btn_pre_onclick = function(e) {
		com.moveList("RF43");
	};
	
	/*
     * 입금예정 그리드 클릭 이벤트
     */
	scwin.grd_recv_oncellclick = function(row,col,colId) {
		scwin.data.recvRow = row;
		
		if(colId == "depst_odr"){			
			if(dlt_recv.getCellData(row, "reschamt_clsf") == "RDD002" && /FAJ004|FAJ005/.test(dma_prj.get("card_use_ex"))){
				btn_apr.hide();
			}else{
				btn_apr.show("");
			}
			
			// 입금의뢰상세 조회
			dma_search.set("depst_odr", dlt_recv.getCellData(row,"depst_odr"));
			scwin.searchRectl(row);
		}
	};
	
	/*
     * 입금예정 그리드 textImage 클릭 이벤트
     */
	scwin.grd_recv_ontextimageclick = function(row,col) {
		if(grd_recv.getColumnID(col) == "depst_loc_nm"){
			com.pop.open(com.pop.TYPE.VEND, {ref_yn: "Y"}, function(ret) {
				dlt_recv.setCellData(row, "depst_loc", ret.vend_cd);
				dlt_recv.setCellData(row, "depst_loc_nm", ret.vend_abbr);				
			});
		}
	};
	
	/*
     * 입금예정 그리드 변경 이벤트
     */
	scwin.grd_recv_onviewchange = function(info) {
		var row = info.rowIndex;
		var col = info.colIndex;
		
		if(/depst_schdl_amt|ofic_depst_amt/.test(dlt_recv.getColumnID(col))){
			dlt_recv.setCellData(row, "uncollected_amt", Number(dlt_recv.getCellData(row, "depst_schdl_amt")) - Number(dlt_recv.getCellData(row, "ofic_depst_amt")));
		}
	};
	
	/*
     * 입금예정 그리드 플러스 버튼 클릭 이벤트
     */
	scwin.btn_recv_plus_onclick = function(e) {
		var row = com.addRow(grd_recv);
		dlt_recv.setCellData(row, "accnt_no", dma_prj.get("accnt_no"));
		dlt_recv.setCellData(row, "depst_odr", (row == 0)? 1 : com.parseInt(dlt_recv.getCellData(row-1, "depst_odr")) + 1);
		// 민간수탁이면서 (별도계좌 또는 통합계과) 또는 위탁기관일경우 연구의뢰기관(과제관리에서 입력 resinppaco)
		if(dma_prj.get("bsns_cd_inout") == "RHA003" && (dma_prj.get("bankaccnt_type") != "X" || dma_prj.get("prj_kind") == "RCA020")){
			dlt_recv.setCellData(row, "depst_loc", dma_prj.get("vend_cd"));
			dlt_recv.setCellData(row, "depst_loc_nm", dma_prj.get("vend_nm"));
		// 정부수탁이면서 위탁기관일 경우 주관기관
		}else if(dma_prj.get("bsns_cd_inout") == "RHA001" && dma_prj.get("prj_kind") == "RCA020"){
			dlt_recv.setCellData(row, "depst_loc", dma_prj.get("vend_cd"));
			dlt_recv.setCellData(row, "depst_loc_nm", dma_prj.get("vend_nm"));
		}else{
			dlt_recv.setCellData(row, "depst_loc", (row == 0)? "" : dlt_recv.getCellData(row-1, "depst_loc"));
			dlt_recv.setCellData(row, "depst_loc_nm", (row == 0)? "" : dlt_recv.getCellData(row-1, "depst_loc_nm"));
		}
		
		dlt_rectl.removeAll();
		dlt_rectl.reform();
	};
	
	/*
     * 입금예정 그리드 minus 버튼 클릭 이벤트
     */
	scwin.btn_recv_minus_onclick = function(e) {
		if(dlt_rectl.getRowCount() > 0){
			alert("입금상세내역을 먼저 삭제하세요.");
			return;	
		}
		
		var row = grd_recv.getFocusedRowIndex();
		if(row < 0){
			alert("삭제할 대상을 선택하세요.");
			return;
		}
		
		if(dlt_recv.getRowStatus(row) != "C"){
			dlt_recv.setCellData(row, "cud_type", "D");
		}
		dlt_recv.removeRow(row);
	};
	
	/*
     * 입금상세 그리드 플러스 버튼 클릭 이벤트
     */
	scwin.btn_rectl_plus_onclick = function(e) {
		var recvRow = scwin.data.recvRow;
		
		if(tbx_depst_odr.getValue() == "" || tbx_depst_odr.getValue() == "0"){
			alert("입금예정내역의 차수를 선택하세요.");
			return;
		}
		
		var rows = dlt_rectl.getRowCount();
		if(rows > 0 && dlt_rectl.getCellData(rows-1, "unslip_no") == "" && dlt_rectl.getCellData(rows-1, "depst_clsf") == "RDE003"){ // 현금일경우
			if(dlt_rectl.getCellData(rows-1, "demnd_req_no") == "" && dlt_rectl.getCellData(rows-1, "depst_req_no") == ""){
				alert("입금상세내역 중 청구의뢰 또는 입금의뢰하지 않은 행이 존재합니다.");	
				return;
			}
			
			if(dlt_rectl.getCellData(rows-1, "demnd_req_no") != ""){
				if(dlt_rectl.getCellData(rows-1, "depst_req_no") == ""){
					alert("입금상세내역 중 반제신청을 하지 않은 행이 존재합니다.");	
					return;
				}
			}else{
				if(dlt_rectl.getCellData(rows-1, "depst_req_no") == ""){
					alert("입금상세내역 중 입금의뢰를 하지 않은 행이 존재합니다.");	
					return;
				}
			}
		}
		
		var row = com.addRow(grd_rectl);
		dlt_rectl.setCellData(row, "cud_type", "C");
		dlt_rectl.setCellData(row, "accnt_no", dma_prj.get("accnt_no"));
		dlt_rectl.setCellData(row, "depst_odr", dlt_recv.getCellData(recvRow, "depst_odr"));
		dlt_rectl.setCellData(row, "depst_loc", dlt_recv.getCellData(recvRow, "depst_loc"));
		dlt_rectl.setCellData(row, "depst_loc_nm", dlt_recv.getCellData(recvRow, "depst_loc_nm"));
		dlt_rectl.setCellData(row, "req_psn", com.getLoginInfo("sn"));
	};
	
	/*
     * 입금상세 그리드 minus 버튼 클릭 이벤트
     */
	scwin.btn_rectl_minus_onclick = function(e) {
		var row = grd_rectl.getFocusedRowIndex();
		if(row < 0){
			alert("삭제할 대상을 선택(체크)하세요.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "depst_req_no").trim() != ""){
			alert("입금의뢰내역을 먼저 삭제하세요.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "demnd_req_no").trim() != ""){
			alert("청구의뢰내역을 먼저 삭제하세요.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "demnd_bill_no").trim() != ""){
			alert("청구계산서가 발행되어 삭제할 수 없습니다.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "apr_state") >= "XAD020"){
			alert("결재진행중이므로 삭제할 수 없습니다.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "RDF004") == "RDF004"){
			alert("입금상태가 [" + grd_rectl.getCellDisplayData(row, "depst_state") + "]입니다. 삭제할 수 없습니다.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "recv_bill_no").trim() != "" && dlt_rectl.getCellData(row, "recv_bill_no") != "발행"){
			alert("영수계산서가 발행되어 삭제할 수 없습니다.");
			return;
		}
		
		if(dlt_rectl.getRowStatus(row) != "C"){
			dlt_rectl.setCellData(row, "cud_type", "D");
		}
		dlt_rectl.removeRow(row);		
	};
	
	/*
     * 입금상세 그리드 클릭 이벤트
     */
	scwin.grd_rectl_oncellclick = function(row,col,colId) {
		if(colId == "attach_file"){
			var vMode = "edit";
			if(dlt_rectl.getCellData(row, "unslip_no") != "" && dlt_rectl.getCellData(row, "apr_state") >= "XAD020"){
				vMode = "view";
				if(dlt_rectl.getCellData(row, "attach_file") == ""){
					alert("결의번호가 있는 경우 파일을 첨부할 수 없습니다.");
					return;
				}
			}
			
			var data={
				attach_file_no : dlt_rectl.getCellData(row, "attach_file").trim(),
				file_key : "RF44",
				mode : vMode,
				ref_yn : "Y"
			};	
			
			com.pop.open(com.pop.TYPE.ATTACH, data, function(ret) {
				if(ret){
					dlt_rectl.setCellData(row, "attach_file", ret.attach_file_no);
				}
			});
		}else if(colId == "demnd_req_no"){
			// check
			if(!scwin.checkDemndRecv(row, "DEMND")) return;	
			scwin.openDemndReq(row);
		}else if(colId == "depst_req_no"){
			// check
			if(!scwin.checkDemndRecv(row, "RECV")) return;	
			scwin.openDepstReq(row);
			
		}else if(colId == "old_data_yn"){
			var columns = ["recv_bill_no", "ofic_depst_amt", "ofic_depst_ymd", "unslip_no"];
			if(dlt_rectl.getCellData(row, "old_data_yn") == "Y"){
				if(dlt_rectl.getCellData(row, "depst_req_no") != ""){
					alert("입금의뢰 데이터가 있을 경우 수기 입력할 수 없습니다.");
					dlt_rectl.setCellData(row, "old_data_yn", "N");
					return;			
				}
				
				columns.forEach(function(elt) {
					grd_rectl.setCellReadOnly(row, elt, false);
				});
			}else{
				columns.forEach(function(elt) {
					grd_rectl.setCellReadOnly(row, elt, true);
				});
			}
		}else if(colId == "unslip_no"){
			// 수기입력이고 결의번호 입력시 입금상태 '결의처리'로 변경
			if(dlt_rectl.getCellData(row, "old_data_yn") == "Y" && dlt_rectl.getCellData(row, "unslip_no") != ""){
				dlt_rectl.setCellData(row, "depst_state", "RDF004");
			}
		}
	};
	
	/*
     * 저장버튼 클릭 이벤트
     */
	scwin.btn_save_onclick = function(e) {
		scwin.getOficDepstAmt(scwin.data.recvRow);
		
		if(!com.validateData(dlt_recv,[
			{ id : "accnt_no", mandatory : true},
			{ id : "depst_odr", mandatory : true},
			{ id : "reschamt_clsf", mandatory : true},
			{ id : "depst_loc", mandatory : true},
		], false)) return;
		
		if(dlt_rectl.getRowCount() > 0){
			if(!com.validateData(dlt_rectl,[
				{ id : "depst_clsf", mandatory : true}
			], false)) return;
		}
		
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
			if(ret){
				com.execute(sbm_saveData, {
					successCallback : function(e){
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
							scwin.search();
						});
					}
				});
			}
		});	
	};	
	
	/*
     * 인쇄 버튼 클릭 이벤트
     */
	scwin.btn_print_onclick = function(e) {
		var row = grd_rectl.getFocusedRowIndex();
		if(row < 0){
			alert("인쇄할 연구비입금 상세내역을 선택하십시오.");
			return;
		}
		
		if(dlt_rectl.getCellData(row, "req_no").trim() == ""){
			alert("선택한 연구비입금 상세내역의 전자결재 신청번호가 존재하지 않습니다.");
			return;
		}
		
		var reschAmtClsf = dlt_recv.getCellData(scwin.data.recvRow, "reschamt_clsf");	
		var node = "req_no=" + dlt_rectl.getCellData(row, "req_no");
		var evidItemCd = "R029";
		// RDD002 민간입금
		if(reschAmtClsf == "RDD002" && /FAJ004|FAJ005/.test(dma_prj.get("card_use_ex"))){
			evidItemCd = "R030";
		}
		
		com.oz.openPopup({
			ozrCode : evidItemCd,      
			param: node
        });	
	};
	
	/*
     * 결재신청 버튼 클릭 이벤트
     */
	scwin.btn_apr_onclick = function(e) {
		var arr = grd_rectl.getCheckedIndex("chk");
		if(arr.length == 0){
			alert("결재신청할 입금상세내역을 선택하세요.");
			return;
		}
		
		if(scwin.data.mainKey == ""){
			alert("사업신청 통합프로세스 연구비입금업무 호출에 실패하였습니다. 다시 진행하시기 바랍니다.");
			return;
		}
		
		// RDD002 민간입금
		if(dlt_recv.getCellData(scwin.data.recvRow, "reschamt_clsf") == "RDD002" && /FAJ004|FAJ005/.test(dma_prj.get("card_use_ex"))){
			alert("민간입금 RCMS/POINT 과제는 결재신청을 할 수 없습니다.");
			return false;
		}
		
		if(com.parseInt(dlt_recv.getCellData(scwin.data.recvRow, "uncollected_amt")) < 0){
			alert("미수총액이 0보다 작습니다. 입금예정금액을 확인바랍니다.");
			return false;
		}
		
		if(ica_slip_ymd.getValue() == ""){
			alert("결의일자를 입력하세요.");
			return;
		}
		
		var rdeCnt003 = 0;
		var rdeCnt001 = 0;
		var oficDepstAmtSum = 0;
		var checkAmts=[];
		var checkAmtData = {};
		for(var i=0; i<arr.length; i++){			
			if(dlt_rectl.getCellData(arr[i], "cud_type") == "C"){
				alert("연구비 입금상세내역이 신규(저장 전)상태입니다. 먼저 연구비 입금내역을 저장하세요.");
				return;
			}
			
//			if(dlt_rectl.getCellData(arr[0], "demnd_bill_no") != dlt_rectl.getCellData(arr[i], "demnd_bill_no")){
//				alert("같은 청구계산서 건일 때만 묶어서 결재신청할 수 있습니다.");
//				return;
//			}
			
			if(dlt_rectl.getCellData(arr[i], "apr_state") >= "XAD020"){
				alert("선택된 [" + (Number(arr[i]) + 1) + "번째] 입금상세 내역은 이미 결재 진행중입니다.");
				return;
			}
			
			if(dlt_rectl.getCellData(arr[i], "depst_state") == "RDF004"){  // 입금상태 == 결의처리
				alert("선택된 [" + (Number(arr[i]) + 1) + "번째] 입금상세 내역은 입금상태가 [결의처리]이므로 결재신청을 할 수 없습니다.");
				return;
			}
			
			if(dlt_rectl.getCellData(arr[i], "depst_req_no").trim() == ""){
				alert("선택된 [" + (Number(arr[i]) + 1) + "번째] 입금상세 내역은 입금의뢰처리가 되지 않아서 결재신청을 할 수 없습니다.");
				return;
			}
			
			if(dlt_rectl.getCellData(arr[0], "req_no") != dlt_rectl.getCellData(arr[i], "req_no")){
				alert("선택된 입금내역에서 서로 다른 결재신청번호가 존재하여 결재 신청할 수 없습니다.");
				return;
			}
			
			switch (dlt_rectl.getCellData(arr[i], "depst_clsf")) {
				case "RDE001": // 은행어음
					rdeCnt001++;
					break;
				case "RDE003": // 현금
					rdeCnt003++;
					break;
			}				
			
			dlt_rectl.setCellData(arr[i], "req_psn", com.getLoginInfo("sn"));
			dlt_rectl.setCellData(arr[i], "req_ymd", com.getServerDateTime());	
			dlt_rectl.setCellData(arr[i], "slip_ymd", ica_slip_ymd.getValue());	
			
			// 청구금액과 신청금액 합계 일치여부 체크위해
			if(dlt_rectl.getCellData(arr[i], "demnd_bill_no") != ""){
				if(checkAmtData.demnd_req_no == undefined){
					checkAmtData.demnd_req_no = dlt_rectl.getCellData(arr[i], "demnd_req_no");
					checkAmtData.demnd_liq = dlt_rectl.getCellData(arr[i], "demnd_liq");
					oficDepstAmtSum = com.parseInt(dlt_rectl.getCellData(arr[i], "ofic_depst_amt"));
				}else{
					if(checkAmtData.demnd_req_no == dlt_rectl.getCellData(arr[i], "demnd_req_no")){
						oficDepstAmtSum += com.parseInt(dlt_rectl.getCellData(arr[i], "ofic_depst_amt"));
					}else{
						checkAmtData.oficDepstAmtSum = oficDepstAmtSum;
						checkAmts.push(checkAmtData);
						
						checkAmtData.demnd_req_no = dlt_rectl.getCellData(arr[i], "demnd_req_no");
						checkAmtData.demnd_liq = dlt_rectl.getCellData(arr[i], "demnd_liq");
						oficDepstAmtSum = com.parseInt(dlt_rectl.getCellData(arr[i], "ofic_depst_amt"));						
					}
				}
				
				if(i+1 == arr.length){
					checkAmtData.oficDepstAmtSum = oficDepstAmtSum;
					checkAmts.push(checkAmtData);	
				}
			}			
		}
		
		debugger;
		
		if(dma_prj.get("tax_cd") != "FTX001" || dma_prj.get("card_use_ex") != "FAJ005"){
			if(checkAmts.length > 0){
				for(var i=0; i<checkAmts.length; i++){				
					if(checkAmts[0].demnd_liq != checkAmts[0].oficDepstAmtSum){
						alert("청구계산서 금액과 신청대상 실입금액 합산이 일치하지 않습니다.");
						return;
					}
				}
			}
		}
		
		if(rdeCnt001 > 0 && rdeCnt003 > 0){
			alert("입금구분이 어음과 현금은 함께 결재신청할 수 없습니다.");	
			return;
		}	

		dma_prj.set("bsns_req_no", scwin.data.mainKey);		
		if(confirm("결재신청을 하시겠습니까")){
			com.execute(sbm_saveApr, {		
				successCallback : function(e){
					com.movePageMenu("A001", {"reqNo" : e.responseJSON.elData.req_no});			
				}
			});
		}
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="" class="pageWrap">
    		<xf:group class="searchSection  step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn " id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="ri" id="" style="">
    				<xf:group class="btnbox" id="">
    					<xf:trigger class="btn icon print" id="btn_print" style="" type="button" ev:onclick="scwin.btn_print_onclick" disabled="true">
    						<xf:label><![CDATA[인쇄]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="과제정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:210px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width: 160px" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width: 180px" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.accnt_no"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="과제기간" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:textbox class="" id="spn_prd" label="00" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정상태" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="true" disabledClass="w2selectbox_disabled" id="sbx_accnt_state" ref="data:dma_prj.accnt_state" style="width:150px;"
    						submenuSize="auto" title="계정상태">
    						<xf:choices></xf:choices>
    					</xf:select1>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="true" disabledClass="w2selectbox_disabled" id="sbx_accnt_clsf" ref="data:dma_prj.accnt_clsf" style="width:150px;"
    						submenuSize="auto" title="계정구분">
    						<xf:choices></xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="사업구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.bsns_cd_bsns_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="과제명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.accnt_no_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes></w2:attributes>
    					<w2:textbox id="" label="입금연구비(부가세포함)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td ri" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.tot_resch_cash_tax_amt"
    						dataType="number" displayFormat="#,###">
    					</w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="연구책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.curr_resch_rspns_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="직급" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.curr_posi_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.curr_posi_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.accnt_rspns_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="직급" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.posi_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.dept_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="가상계좌번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="" label="00" style="" tagname="span" ref="data:dma_prj.vacct_no"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="과세구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="true" disabledClass="w2selectbox_disabled" id="" ref="data:dma_prj.tax_cd" style="width:150px;" submenuSize="auto"
    						title="과세구분">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[과세]]></xf:label>
    								<xf:value><![CDATA[FTX001]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[비과세]]></xf:label>
    								<xf:value><![CDATA[FTX002]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="연구비구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="true" disabledClass="w2selectbox_disabled" id="sbx_card_use_ex" ref="data:dma_prj.card_use_ex" style="width:150px;"
    						submenuSize="auto" title="연구비구분">
    						<xf:choices></xf:choices>
    					</xf:select1>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="helparea" id="" style="">
    			<xf:group id="" style="" tagname="ul">
    				<xf:group id="" style="" tagname="li">
    					<w2:textbox class="red" id="" label="‘입금연구비’는 우리 원 계좌에 입금되는 연구비로, ‘과세과제’의 부가세 포함 및 ‘통합이지바로과제’의 위탁연구비가 제외된 연구비임"
    						style="" tagname="span">
    					</w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="margin-top:10px;">
    			<xf:group class="le" id="">
    				<w2:textbox class="tit_tbl" id="" label="입금예정내역" style="" tagname="h3"></w2:textbox>
    			</xf:group>
    			<xf:group class="ri" id="" style="">
    				<xf:group class="btnarea" id="" style="">
    					<w2:textbox class="red" id="spn_msg" label="" style="" tagname="span"></w2:textbox>
    					<xf:trigger class="bt_plus" id="btn_recv_plus" style="" type="button" ev:onclick="scwin.btn_recv_plus_onclick">
    						<xf:label><![CDATA[추가]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="bt_minus" id="btn_recv_minus" style="" type="button" ev:onclick="scwin.btn_recv_minus_onclick">
    						<xf:label><![CDATA[삭제]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_recv" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    			id="grd_recv" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    			rowNumHeaderValue="No." rowNumVisible="false" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    			scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
    			summaryAuto="true" visibleRowNum="5" editModeEvent="onclick" ev:oncellclick="scwin.grd_recv_oncellclick"
    			ev:onviewchange="scwin.grd_recv_onviewchange" ev:ontextimageclick="scwin.grd_recv_ontextimageclick">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;" value="차수" width="45"
    						fixColumnWidth="true">
    					</w2:column>
    					<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="연구비구분" width="100"></w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="입금예정액" width="110"></w2:column>
    					<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="입금예정일" width="100"></w2:column>
    					<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="실입금액" width="100"></w2:column>
    					<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="미수총액" width="100"></w2:column>
    					<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="입금처" width="200"></w2:column>
    					<w2:column displayMode="label" id="column34" inputType="text" style="height:28px;" value="특이사항" width="250"
    						colSpan="" rowSpan="">
    					</w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column class="" displayMode="label" id="depst_odr" inputType="link" readOnly="true" style="height:28px;"
    						width="45">
    					</w2:column>
    					<w2:column class="" displayMode="label" escape="false" id="reschamt_clsf" inputType="select" readOnly="false"
    						style="height:28px;" width="100" viewType="icon">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="depst_schdl_amt" inputType="text" readOnly="false"
    						style="height:28px;" width="110" dataType="number" displayFormat="#,###" class="ri">
    					</w2:column>
    					<w2:column displayMode="label" id="depst_schdl_ymd" inputType="calendar" readOnly="false" style="height:28px;"
    						width="100" viewType="icon">
    					</w2:column>
    					<w2:column displayMode="label" id="ofic_depst_amt" inputType="text" readOnly="true" style="height:28px;"
    						width="100" dataType="number" displayFormat="#,###" class="ri">
    					</w2:column>
    					<w2:column displayMode="label" id="uncollected_amt" inputType="text" readOnly="true" style="height:28px;"
    						width="100" dataType="number" displayFormat="#,###" class="ri">
    					</w2:column>
    					<w2:column displayMode="label" id="depst_loc_nm" inputType="textImage" readOnly="true" style="height:28px;"
    						width="200" class="le" imageSrc="/cm/images/sample/btn_tbsearch02.png">
    					</w2:column>
    					<w2:column displayMode="label" id="unusual_item" inputType="textarea" readOnly="false" style="" value="" width="250"
    						class="le">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    			<w2:footer style="" id="footer1">
    				<w2:row style="" id="row3">
    					<w2:column width="45" inputType="text" style="height:28px;" id="column43" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="text" style="height:28px;" id="column42" value="합계" displayMode="label"></w2:column>
    					<w2:column width="110" inputType="expression" style="height:28px;" id="column41" value="" displayMode="label"
    						dataType="number" displayFormat="#,###" class="ri" expression="sum('depst_schdl_amt')">
    					</w2:column>
    					<w2:column width="100" inputType="text" style="height:28px;" id="column40" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="expression" style="height:28px;" id="column39" value="" displayMode="label"
    						dataType="number" displayFormat="#,###" class="ri" expression="sum('ofic_depst_amt')">
    					</w2:column>
    					<w2:column width="100" inputType="expression" style="height:28px;" id="column38" value="" displayMode="label"
    						dataType="number" displayFormat="#,###" class="ri" expression="sum('uncollected_amt')">
    					</w2:column>
    					<w2:column width="200" inputType="text" style="height:28px;" id="column37" value="" displayMode="label"></w2:column>
    					<w2:column width="250" inputType="text" style="height:28px;" id="column36" value="" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:footer>
    		</w2:gridView>
    		<xf:group class="titleSection" id="" style="">
    			<xf:group class="le" id="">
    				<w2:textbox class="tit_tbl" id="" label="입금상세내역" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="차수" style="margin-right:5px;" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl blue" id="tbx_depst_odr" label="0" ref="data:dlt_recv.depst_odr" style="width: 10px"
    					tagname="h3">
    				</w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label=" /" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="입금예정액" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl blue ri" dataType="number" displayFormat="#,###" id="" label="0"
    					ref="data:dlt_recv.depst_schdl_amt" style="" tagname="h3">
    				</w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="원 / " style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="실입금액" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl blue ri" dataType="number" displayFormat="#,###" id="tbx_ofic_depst_amt" label="0"
    					ref="data:dlt_recv.ofic_depst_amt" style="" tagname="h3">
    				</w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="원 / " style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="입금처" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl blue le" id="tbx_depst_loc" label="0" ref="data:dlt_recv.depst_loc" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl" id="" label="-" style="" tagname="h3"></w2:textbox>
    				<w2:textbox class="tit_tbl blue le" id="textbox1" label="0" ref="data:dlt_recv.depst_loc_nm" style="margin-right:20px;"
    					tagname="h3">
    				</w2:textbox>
    			</xf:group>
    			<xf:group class="ri" id="" style="">
    				<xf:group class="btnarea" id="" style=""><w2:textbox tagname="h3" style="" id="tbx_slip_ymd" label="결의일자" class="tit_tbl blue"></w2:textbox><w2:inputCalendar footerDiv="false" rightAlign="false" focusOnDateSelect="false" style="margin-right:10px;" id="ica_slip_ymd" placeholder="시작일" class="inpcal" renderDiv="true" calendarValueType="yearMonthDate">
    					</w2:inputCalendar><xf:trigger class="btn  blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick">
    						<xf:label><![CDATA[결재신청]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="bt_plus" id="btn_rectl_plus" style="" type="button" ev:onclick="scwin.btn_rectl_plus_onclick">
    						<xf:label><![CDATA[추가]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="bt_minus" id="btn_rectl_minus" style="" type="button"
    						ev:onclick="scwin.btn_rectl_minus_onclick">
    						<xf:label><![CDATA[삭제]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:gridView class="grid" dataList="data:dlt_rectl" defaultCellHeight="28" evenRowBackgroundColor="#f7faff" id="grd_rectl"
    			noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    			rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    			scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 133px;"
    			summaryAuto="true" visibleRowNum="5" fixedColumn="7" ev:oncellclick="scwin.grd_rectl_oncellclick">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column width="40" inputType="text" style="height:28px;" id="column108" value="선택" displayMode="label" colSpan=""
    						rowSpan="2">
    					</w2:column>
    					<w2:column width="40" inputType="text" style="height:28px;" id="column112" value="수기&lt;br/&gt;입력" displayMode="label" colSpan=""
    						rowSpan="2">
    					</w2:column>
    					<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;" value="입금구분" width="70" colSpan=""
    						rowSpan="2">
    					</w2:column>
    					<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="입금처" width="120" colSpan=""
    						rowSpan="2">
    					</w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="계산서번호" width="140"
    						colSpan="2" rowSpan="">
    					</w2:column>
    					<w2:column displayMode="label" id="column29" inputType="text" style="height:48px;" value="실입금액" width="80"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column displayMode="label" id="column27" inputType="text" style="height:48px;" value="입금일자" width="80"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="의뢰일자" width="80"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column displayMode="label" id="column34" inputType="text" style="height:28px;" value="청구의뢰번호" width="100"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="100" inputType="text" style="height:56px;" id="column100" value="입금확인번호" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="130" inputType="text" style="height:56px;" id="column96" value="계좌번호" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:56px;" id="column92" value="입금상태" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:56px;" id="column88" value="전자발행여부" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:56px;" id="column84" value="결의일자" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:56px;" id="column80" value="결의번호" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:56px;" id="column76" value="미수확정번호" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="90" inputType="text" style="height:56px;" id="column72" value="결재신청번호" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:56px;" id="column68" value="결재상태" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="90" inputType="text" style="height:56px;" id="column64" value="첨부파일" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:56px;" id="column60" value="은행" displayMode="label" colSpan=""
    						rowSpan="2">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:56px;" id="column52" value="청구금액" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:56px;" id="column56" value="발행일자" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:56px;" id="column104" value="영수금액" displayMode="label"
    						colSpan="" rowSpan="2">
    					</w2:column>
    				</w2:row>
    				<w2:row style="" id="row4">
    					<w2:column width="90" inputType="text" style="height:28px;" id="column49" value="청구계산서" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:28px;" id="column48" value="영수계산서" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column width="40" inputType="checkbox" style="height:28px" id="chk" value="" displayMode="label"></w2:column>
    					<w2:column width="40" inputType="checkbox" style="height:28px" id="old_data_yn" value="" displayMode="label" falseValue="N" trueValue="Y" valueType="other"></w2:column>
    					<w2:column class="" displayMode="label" id="depst_clsf" inputType="select" readOnly="false" style="height:28px;"
    						width="70" viewType="icon">
    					</w2:column>
    					<w2:column class="le" displayMode="label" escape="false" id="depst_loc_nm" inputType="text" readOnly="true"
    						style="height:28px;" width="120">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="demnd_bill_no" inputType="text" readOnly="true"
    						style="height:28px;" width="90">
    					</w2:column>
    					<w2:column displayMode="label" id="recv_bill_no" inputType="text" readOnly="true" style="height:28px;" width="90"></w2:column>
    					<w2:column displayMode="label" id="ofic_depst_amt" inputType="text" readOnly="true" style="height:28px;" width="80"
    						dataType="number" displayFormat="#,###" class="ri">
    					</w2:column>
    					<w2:column displayMode="label" id="ofic_depst_ymd" inputType="calendar" readOnly="true" style="height:28px;"
    						width="80">
    					</w2:column>
    					<w2:column displayMode="label" id="req_ymd" inputType="text" readOnly="true" style="height:28px;" width="80"
    						dataType="date">
    					</w2:column>
    					<w2:column displayMode="label" id="demnd_req_no" inputType="button" readOnly="true" style="height:28px" value="청구의뢰"
    						width="100">
    					</w2:column>
    					<w2:column width="100" inputType="button" style="height:28px" id="depst_req_no" value="입금의뢰" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="130" inputType="text" style="height:28px" id="bankaccnt_no" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="70" inputType="select" style="height:28px" id="depst_state" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="state_nm" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="slip_ymd" value="" displayMode="label"
    						readOnly="true" dataType="date">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="unslip_no" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="slip_no" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="90" inputType="text" style="height:28px" id="req_no" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="70" inputType="select" style="height:28px" id="apr_state" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="90" inputType="button" style="height:28px" id="attach_file" value="첨부" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="70" inputType="select" style="height:28px" id="bank" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="demnd_liq" value="" displayMode="label"
    						readOnly="true" dataType="number" displayFormat="#,###" class="ri">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="issu_ymd" value="" displayMode="label"
    						readOnly="true" dataType="date">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="recv_liq" value="" displayMode="label"
    						dataType="number" displayFormat="#,###" class="ri" readOnly="true">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    			<w2:footer id="footer1" style="">
    				<w2:row id="row3" style="">
    					<w2:column width="230" inputType="text" style="height:28px;" id="column111" value="합 계" displayMode="label"
    						colSpan="3" rowSpan="">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column115" value="" displayMode="label"></w2:column>
    					<w2:column displayMode="label" id="column41" inputType="text" style="height:28px;" value="" width="90"></w2:column>
    					<w2:column displayMode="label" id="column40" inputType="text" style="height:28px;" value="" width="90"></w2:column>
    					<w2:column displayMode="label" id="ofic_depst_amt_sum" inputType="expression" style="height:28px;" value=""
    						width="80" class="ri" dataType="number" displayFormat="#,###" expression="sum('ofic_depst_amt')">
    					</w2:column>
    					<w2:column displayMode="label" id="column38" inputType="text" style="height:28px;" value="" width="80"></w2:column>
    					<w2:column displayMode="label" id="column37" inputType="text" style="height:28px;" value="" width="80"></w2:column>
    					<w2:column displayMode="label" id="column36" inputType="text" style="height:28px;" value="" width="100"></w2:column>
    					<w2:column width="100" inputType="text" style="height:28px" id="column103" value="" displayMode="label"></w2:column>
    					<w2:column width="130" inputType="text" style="height:28px" id="column99" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column95" value="" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="column91" value="" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="column87" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column83" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column79" value="" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:28px" id="column75" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column71" value="" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:28px" id="column67" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column63" value="" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="" style="height:28px" id="" value="" displayMode="label" class=""></w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="column59" value="" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="" style="height:28px" id="" value="" displayMode="label" class=""></w2:column>
    				</w2:row>
    			</w2:footer>
    		</w2:gridView>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
