<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="학생인건비흡수(취소)결의">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            	<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="unslip_no" name="unslip_no" dataType="text"></w2:key>						
						<w2:key id="absrp_yrmon" name="absrp_yrmon" dataType="text"></w2:key>
						<w2:key id="accnt_no" name="accnt_no" dataType="text"></w2:key>
						<w2:key id="bugt_yr" name="예산연도" dataType="text"></w2:key>
						<w2:key id="relat_no" name="연수책임자개인번호" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_slipH" style="">
    				<w2:keyInfo>
    					<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
    					<w2:key dataType="text" id="slip_typ_cd" name="결의유형"></w2:key>
    					<w2:key dataType="text" id="wrte_dept" name="작성부서"></w2:key>
    					<w2:key dataType="text" id="wrte_dept_new_ymd" name="작성부서신설일자"></w2:key>
    					<w2:key dataType="text" id="dept_nm" name="작성부서명"></w2:key>
    					<w2:key dataType="text" id="wrte_psn" name="작성자"></w2:key>
    					<w2:key dataType="text" id="empno" name="작성자개인번호"></w2:key>
    					<w2:key dataType="text" id="nm" name="작성자명"></w2:key>
    					<w2:key dataType="text" id="ext_no" name="작성자전화번호"></w2:key>
    					<w2:key dataType="text" id="slip_ymd" name="결의일자"></w2:key>
    					<w2:key dataType="text" id="rmk" name="적요"></w2:key>
    					<w2:key dataType="text" id="decsn_ex" name="확정여부"></w2:key>
    					<w2:key dataType="text" id="decsn_ex_nm" name="확정여부명"></w2:key>
    					<w2:key dataType="text" id="accnt_ymd" name="확정일자"></w2:key>
    					<w2:key dataType="text" id="slip_no" name="확정결의번호"></w2:key>   					    						    					
    				</w2:keyInfo>
    			</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_list" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="absrp_yrmon" name="흡수월" dataType="text"></w2:column>
						<w2:column id="accnt_no" name="계정번호" dataType="text"></w2:column>
						<w2:column id="accnt_cd" name="accnt_cd" dataType="text"></w2:column>
						<w2:column id="odr" name="odr" dataType="text"></w2:column>
						<w2:column id="rmk" name="신청사유(비고)" dataType="text"></w2:column>
						<w2:column id="accnt_rspns" name="accnt_rspns" dataType="text"></w2:column>
						<w2:column id="accnt_rspns_nm" name="accnt_rspns_nm" dataType="text"></w2:column>
						<w2:column id="accnt_empno" name="accnt_empno" dataType="text"></w2:column>						
						<w2:column id="bugt_ctrl_psn" name="예산통제자" dataType="text"></w2:column>
						<w2:column id="dept" name="dept" dataType="text"></w2:column>
						<w2:column id="accnt_no_nm" name="accnt_no_nm" dataType="text"></w2:column>
						<w2:column id="bugt_ctrl_psn" name="bugt_ctrl_psn" dataType="text"></w2:column>
						<w2:column id="accnt_prd" name="accnt_prd" dataType="text"></w2:column>
						<w2:column id="card_use_ex" name="card_use_ex" dataType="text"></w2:column>
						<w2:column id="fomat_unit" name="fomat_unit" dataType="text"></w2:column>
						<w2:column id="ori_plan_amt" name="ori_plan_amt" dataType="number"></w2:column>
						<w2:column id="plan_amt" name="plan_amt" dataType="number"></w2:column>
						<w2:column id="slip_typ" name="slip_typ" dataType="text"></w2:column>
						<w2:column id="attach_file_no" name="첨부파일" dataType="text"></w2:column>
						<w2:column id="regst_syspayno" name="등록자" dataType="text"></w2:column>
						<w2:column id="validAttachNo" name="validAttachNo" dataType="text"></w2:column>
						<w2:column id="belng_yrmon" name="belng_yrmon" dataType="text"></w2:column>
						<w2:column id="apr_state" name="결재상태" dataType="text"></w2:column>
						<w2:column id="start_ymd" name="과제시작일" dataType="text"></w2:column>
						<w2:column id="cls_ymd" name="과제종료일" dataType="text"></w2:column>
						<w2:column id="bf_absrp_yrmon" name="기흡수연월" dataType="text"></w2:column>
						<w2:column id="bf_odr" name="기흡수순번" dataType="text"></w2:column>			
						<w2:column id="bugt_yr" name="예산연도" dataType="text"></w2:column>												
						<w2:column id="accnt_cd_nm" name="회계코드명" dataType="text"></w2:column>																					
						<w2:column id="unslip_amt" name="unslip_amt" dataType="number"></w2:column>
						<w2:column id="cryfwd_bugt" name="cryfwd_bugt" dataType="number"></w2:column>
						<w2:column id="bugt_amt" name="bugt_amt" dataType="number"></w2:column>
						<w2:column id="enfrc_amt" name="enfrc_amt" dataType="number"></w2:column>						
						<w2:column id="aftr_accnt_rspns" name="aftr_accnt_rspns" dataType="text"></w2:column>																	
					</w2:columnInfo>
				</w2:dataList>						
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
            <!-- 결의내역조회 -->
    		<xf:submission id="sbm_selectData" ref="data:json,dma_search"
    			target='data:json,[{"id":"dma_slipH","key":"fspSlipHVo"},{"id":"dlt_list","key":"fsaAbsrpListVo"}]' action="SvcRESSTUSLIPR01.pwkjson"
    			method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
    			mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		 <!-- 기존 흡수내역조회 -->
    		<xf:submission id="sbm_selectSlipData" ref="data:json,dma_search"
    			target='' action="SvcRESSTUSLIPR03.pwkjson"
    			method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
    			mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		 <!-- 기존 흡수내역조회 -->
    		<xf:submission id="sbm_selectSlipAccntData" ref="data:json,dma_search"
    			target='' action="SvcRESSTUSLIPR04.pwkjson"
    			method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
    			mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		 <!-- 이관 대상 내역 조회 -->
    		<xf:submission id="sbm_selectTrnsSlipAccntData" ref="data:json,dma_search"
    			target='' action="SvcRESSTUSLIPR05.pwkjson"
    			method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
    			mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		 <!-- 결의 취소 -->
    		<xf:submission id="sbm_deleteData" ref='data:json,[{"id":"dma_slipH","key":"fspSlipHVo"},{"id":"dlt_list","key":"fsaAbsrpListVo"}]'
    			target='' action="SvcRESSTUSLIPM02.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		 <!-- 결의 생성 -->
    		<xf:submission id="sbm_SaveData" ref='data:json,[{"id":"dma_slipH","key":"fspSlipHVo"},{"id":"dlt_list","key":"fsaAbsrpListVo"}, {"id":"dlt_trnsList","key":"fsaAbsrpListVo"}]'
    			target='data:json,dma_search' action="SvcRESSTUSLIPM01.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 결재 신청 -->
    		<xf:submission id="sbm_SaveAprData" ref='data:json,[{"id":"dma_slipH","key":"fspSlipHVo"},{"id":"dlt_list","key":"fsaAbsrpListVo"}]'
    			target='' action="SvcRESSTUSLIPM03.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
        </xf:model>
         <script type="text/javascript" lazy="false"><![CDATA[
        
	scwin.data={
		typeCode : "R496",
		allowExtension : "jpg,pptx,tiff,jpeg,hwp,hwpx,bmp,gif,mht,pdf,doc,rtf,tif,ppt,html,docx,txt,png"
	};
		
	/*
	*  날짜 설정
	 */
	   
	var now = new Date();
	var defalutday = gcm.date.formatDateTime(now, "yyyyMMddHHmm"); // yyyyMMddHHmm
	var ymd = gcm.date.formatDateTime(now); // yyyyMMdd 
	var yearMm = ymd.substr(0, 6); // yyyyMM
	var Month = ymd.substr(4, 2); // yyyyMM
	var session = com.getLoginInfo();
	var aftrAccntRspns = "";
	
	scwin.onpageload = function() {
		com.file.init();
		// enter key event
		com.setEnterKeyEvent(grp_afrAccnt, scwin.btn_aftrAcctRspsn_onclick);
		com.setEnterKeyEvent(grp_bfrAccnt, scwin.btn_befrAcctRspsn_onclick);	
		
		var oneMonthAgo = new Date(now);
		oneMonthAgo.setMonth(now.getMonth()-1);
		var fromYmd = gcm.date.formatDateTime(oneMonthAgo); // yyyyMMdd
		
		var param = com.getParameter();
				
		if(param.param4 == "apr"){
			dma_search.set("unslip_no", param.req_no);		
		}else{
			dma_search.set("unslip_no", param.unslip_no);	
		}
		
		//debugger;	
		if(dma_search.get("unslip_no") != ""){
				scwin.search();
				radioSliptype.setDisabled(true);
				radioSliptype.setValue(param.slip_typ);
				
		} else {
				btn_cancel_slip.setDisabled(true); //결의생성 전 취소버튼 disabled
				com.file.create(upload_A.getID(), {fileKey : scwin.data.typeCode, mode: 'edit'});
				radioSliptype.setValue("A");
				idx_slip_ymd.setValue(ymd);
				idx_rmk.setValue(Month+"월 학생인건비 추가흡수");
				idx_nm.setValue(session.cn);
				idx_empno.setValue(session.empno);
				btn_apr.setDisabled(true);
				
				dma_slipH.set("wrte_dept", session.deptCode);
				dma_slipH.set("wrte_dept_new_ymd", session.deptNewYmd);
				dma_slipH.set("wrte_psn", session.sn);
				dma_slipH.set("empno", session.empno);
				dma_slipH.set("nm", session.cn);
				dma_slipH.set("rowStatus", "C");
		}
	};
	
	/*
     * 조회
     */
	scwin.search = function(){
		com.execute(sbm_selectData, {
			successCallback : function(e){
				//if(radioSliptype.getValue() == "T")	dlt_list.setJSON(dlt_list.getAllJSON());	
				
				// 결재상태에 따른 버튼 제어
				com.biz.disabledButtons(dma_slipH.get("apr_state"), dma_slipH.get("unslip_no"));
				if(dma_slipH.get("unslip_no") != ""){
					idx_slip_ymd.setDisabled(true);
					idx_rmk.setDisabled(true);		
					btn_apr.setDisabled(false);					
					radioSliptype.setValue(dlt_list.getCellData(0, "slip_typ"));
					idx_aftrAccntRspsn.setDisabled(true);
					idx_befrAccntRspsn.setDisabled(true);
					btn_aftrAcctRspsn.setDisabled(true);
					btn_befrAcctRspsn.setDisabled(true);
					
					if(radioSliptype.getValue() == "C"){
						idx_cnlAccntNo.setValue(dlt_list.getCellData(0, "accnt_no"));
						switch1.setSelectedID("case2");
					}else if(radioSliptype.getValue() == "T"){
						idx_befrAccntRspsn.setValue(dlt_list.getCellData(0, "accnt_empno"));
						idx_aftrAccntRspsn.setValue(dlt_list.getCellData(1, "accnt_empno"));
						idx_befrAccntRspsnNm.setValue(dlt_list.getCellData(0, "accnt_rspns_nm"));
						idx_aftrAccntRspsnNm.setValue(dlt_list.getCellData(1, "accnt_rspns_nm"));
						switch1.setSelectedID("case3");
					} 
					radioSliptype.setDisabled(true);
					for(var i=0; i<dlt_list.getRowCount(); i++){						
						grd_plusSlip.setCellDisabled(i, "absrp_yrmon", true);
						grd_plusSlip.setCellDisabled(i, "accnt_no", true);
						grd_plusSlip.setCellDisabled(i, "rmk", true);
						grd_plusSlip.setCellDisabled(i, "plan_amt", true);
						grd_plusSlip.setCellDisabled(i, "btn_accntno", true);
												
						grd_minusSlip.setCellDisabled(i, "absrp_yrmon", true);						
						grd_minusSlip.setCellDisabled(i, "rmk", true);
						grd_minusSlip.setCellDisabled(i, "plan_amt", true);
						grd_minusSlip.setCellDisabled(i, "btn_Cnlaccntno", true);
						
						grd_transSlip.setCellDisabled(i, "rmk", true);
						grd_transSlip.setCellDisabled(i, "unslip_amt", true)
																					
					}
					btn_slip_plus.setDisabled(true);
					btn_slip_minus.setDisabled(true);
					btn_create_slip.setDisabled(true);	
					
					btn_cancel_plus.setDisabled(true);
					btn_cancel_minus.setDisabled(true);
					
					idx_cnlAccntNo.setDisabled(true);
					btn_Cnlaccntno.setDisabled(true);
					if(dlt_list.getCellData(0, "apr_state") > "XAD020"){
						btn_cancel_slip.setDisabled(true);
						btn_apr.setDisabled(true);
					}else {
						if(dma_slipH.get("wrte_psn") != session.sn){
							btn_apr.setDisabled(true);
							btn_cancel_slip.setDisabled(true);
						}else{
							btn_cancel_slip.setDisabled(false);	
						}						
					}											
							
				}
				var attach_file_no = dlt_list.getCellData(0, "attach_file_no");				
				com.file.create(upload_A.getID(), {fileKey : com.isEmpty(attach_file_no) ? scwin.data.typeCode : attach_file_no, mode : 'view' });
			}
		});
	};
	
	
	scwin.onpageunload = function() {
		
	};
	
	/*
     * 라디오버튼 이벤트
     */	
	scwin.radioSliptype_onviewchange = function(info) {
		
		var case1 = document.getElementById('case1');
		var case2 = document.getElementById('case2');
		var case2 = document.getElementById('case3');
		switch1.setSelectedID("case1") // case ID Radio 의 value를 case id로 주면 아래와 같이 처리 가능
		// switch1.setSelectedID(this.getValue());
		dlt_list.removeAll();
		dlt_list.removeAll();
		
		idx_aftrAccntRspsn.setValue("");
		idx_aftrAccntRspsnNm.setValue("");
		idx_befrAccntRspsn.setValue("");
		idx_befrAccntRspsnNm.setValue("");
		
		if(this.getValue() == "A"){
			idx_rmk.setValue(Month+"월 학생인건비 추가흡수");		
			switch1.setSelectedID("case1")
			
		}else if(this.getValue() == "C"){
			idx_rmk.setValue(Month+"월 학생인건비 흡수취소");			
			switch1.setSelectedID("case2");
			
		}else{
			if(/1001252|1010001/.test(com.getLoginInfo("roleCode"))){ // 1001252 학생인건비담당, 1010001 시스템관리자
				idx_rmk.setValue("학생인건비 이관");			
				switch1.setSelectedID("case3");
			}else{
				alert("학생인건비 담당만 작성 가능합니다.");
				switch1.setSelectedID("case1");
				idx_rmk.setValue(Month+"월 학생인건비 추가흡수");		
				radioSliptype.setSelectedIndex(0);
				return;	
			}				
		}
	};
	
	/*
     * 목록버튼 클릭 이벤트.
     */
	scwin.btn_list_onclick = function(e) {		
		com.moveList("R495");
	};
	/*
     * 추가흡수 그리드 행추가
     */
	scwin.btn_slip_plus_onclick = function(e) {
		var row = com.addRow(grd_plusSlip);
		dlt_list.setCellData(row, "cud_type", "C");		
	};
	
	/*
     * 추가흡수 그리드 행삭제
     */
	scwin.btn_slip_minus_onclick = function(e) {
		var row = grd_plusSlip.getFocusedRowIndex();
		if(row < 0){
			alert("삭제할 대상을 선택(체크)하세요.");
			return;
		}				
		
		if(dlt_list.getRowStatus(row) != "C"){
			dlt_list.setCellData(row, "cud_type", "D");
		}
		dlt_list.removeRow(row);	
	};
	/*
     * 흡수취소 그리드 행추가
     */
	scwin.btn_cancel_plus_onclick = function(e) {
		
		if(idx_cnlAccntNo.getValue() == ""){
			alert("흡수취소 대상 계정 검색 후 행추가 가능합니다.");
			idx_cnlAccntNo.focus();
		}else{ 
			var row = com.addRow(grd_minusSlip);
			dlt_list.setCellData(row, "cud_type", "C");
			dlt_list.setCellData(row, "accnt_no", idx_cnlAccntNo.getValue());			
		}		
	};
	/*
     * 흡수취소 그리드 행삭제
     */
	scwin.btn_cancel_minus_onclick = function(e) {
		var row = grd_minusSlip.getFocusedRowIndex();
		if(row < 0){
			alert("삭제할 대상을 선택(체크)하세요.");
			return;
		}				
		
		if(dlt_list.getRowStatus(row) != "C"){
			dlt_list.setCellData(row, "cud_type", "D");
		}
		dlt_list.removeRow(row);	
	};
	
	/**
	 * 계정번호검색 버튼 클릭 이벤트
	 */
	scwin.btn_Cnlaccntno_onclick = function(e) {
		var data={
			accnt_no : idx_cnlAccntNo.getValue().toUpperCase(),
			ref_yn : (idx_cnlAccntNo.getValue() == "")? "Y" : "N"
		};
		
		com.pop.open(com.pop.TYPE.ACNNO, data, function(ret){
			idx_cnlAccntNo.setValue(ret.accnt_no);
			dlt_list.removeRow(row);
			var row = com.addRow(grd_minusSlip);
			dlt_list.setCellData(row, "cud_type", "C");
			dlt_list.setCellData(row, "accnt_no", ret.accnt_no);				
			dlt_list.setCellData(row, "accnt_no_nm", ret.accnt_no_nm);
			dlt_list.setCellData(row, "accnt_rspns_nm", ret.accnt_rspns_nm);
		});
	};

	
	/**
	 * 계정번호 변경 이벤트
	 */
	scwin.ibx_accnt_no_onchange = function(info) {
		if (this.getValue() == "") {
			idx_cnlAccntNo.setValue("");
		}
	};
	
	/*
     * 저장 전 체크
     */
	scwin.preSave = function(){
					
		if(dlt_list.getRowCount() == 0){
			alert("흡수/취소 정보 입력이 누락되었습니다.");
			return;		
		}
		
		if(idx_slip_ymd.getValue()==""){
			alert("결의일자 입력 누락되었습니다.");
			idx_slip_ymd.focus();
			return;	
		}
		if(idx_rmk.getValue()==""){
			alert("적요 입력 누락되었습니다.");
			idx_rmk.focus();
			return;	
		}
		
		if(radioSliptype.getValue() == "T"){
			if(idx_aftrAccntRspsn.getValue() == ""){
				alert("이관대상 연수책임자 입력 누락되었습니다.");
				idx_aftrAccntRspsn.focus();
				return;	
			}			
		}
		
		if(radioSliptype.getValue() != "T"){
			var validData=[
				{dataObj : dlt_list
				   , valInfoArr :[
					    { id : "absrp_yrmon", mandatory : true}
					   ,{ id : "accnt_no", mandatory : true } 
					   ,{ id : "plan_amt", mandatory : true } 
					   ,{ id : "rmk", mandatory : true }
					]
				  , isCheckModified : false
				},		
			];							
		}else {
		var validData=[
				{dataObj : dlt_list
				   , valInfoArr :[
					   { id : "rmk", mandatory : true }
					]
				  , isCheckModified : false
				},		
			];
			
		}
		if(!com.validateData(validData)) return false;	
		
		return true;
	}
	/*결의생성*/
	scwin.btn_create_slip_onclick = function(e) {		
		
		if(!scwin.preSave()) return;	
										
		dlt_list.setCellData(0, "regst_syspayno", session.sn);
		dlt_list.setCellData(0, "slip_typ", radioSliptype.getValue());		
		dlt_list.setCellData(0, "slip_ymd", idx_slip_ymd.getValue());
		dlt_list.setCellData(0, "aftr_accnt_rspns",  aftrAccntRspns);
				
		com.file.transport( function(attachObj){			
			if(attachObj.upload_A != undefined && attachObj.upload_A.trim().length == 13){
				dlt_list.setCellData(0, "attach_file_no", attachObj.upload_A);
				dlt_list.setCellData(0, "validAttachNo", attachObj.upload_A);			
			}
			com.execute(sbm_SaveData, {
				successCallback : function(e){
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){					
						scwin.search();
					});
				}
			});	
		});	
	};
	/*결의취소*/
	scwin.btn_cancel_slip_onclick = function(e) {
		com.execute(sbm_deleteData, {
			successCallback : function(e){
				com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){				
				//창닫기
				com.moveList("R495", {});				
				});
			}
		});
	};
	/**
	* 흡수취소 흡수월 입력후 조회
	*/
	scwin.grd_minusSlip_onviewchange = function(info) {					
		//debugger;
		if(dlt_list.getColumnID(info.colIndex) == "absrp_yrmon" && info.newValue != ""){			
		
			dma_search.set("unslip_no", "");
			dma_search.set("absrp_yrmon", info.newValue);
			dma_search.set("accnt_no", idx_cnlAccntNo.getValue());
			
			com.execute(sbm_selectSlipData, {
				successCallback : function(e){								
					dlt_list.removeRow(info.rowIndex);		
					dlt_list.setJSON(e.responseJSON.fsaAbsrpVoList, true);
					if(e.responseJSON.fsaAbsrpVoList.length == 0){
						alert("기 흡수금액이 없습니다.");
						return;
					}						
					if(dlt_list.getCellData(row, "belng_yrmon") != ""){
						alert(dlt_list.getCellData(row, "belng_yrmon") + "월 또는 그 이전에 지출생성이 되었으므로 흡수취소를 할 수 없습니다.");
						return;
					}				
				}
			});
		}
		if(grd_minusSlip.getColumnID(info.colIndex) == "plan_amt" && info.newValue != ""){
			if(info.newValue > dlt_list.getCellData(info.rowIndex, "ori_plan_amt")){
				alert("흡수 취소금액은 흡수금액보다 클 수 없습니다.");
				dlt_list.setCellData(info.rowIndex, "plan_amt", 0);
				return;
			}	
			if(info.newValue < 0){
				alert("흡수 취소금액은 마이너스 금액 입력이 불가능합니다.");
				dlt_list.setCellData(info.rowIndex, "plan_amt", 0);
				return;
			}
			
		}
	};	
	
	/* 
	* 추가흡수 그리드 row 추가
	*/
	scwin.grd_plusSlip_oncellclick = function(row,col,colId) {
		
		if(colId=="btn_accntno"){
			if(dlt_list.getCellData(row, "absrp_yrmon") == ""){
				alert("흡수월 선택 후 계정 선택 가능합니다.");
			}else{
				var data={
					accnt_no : "",
					ref_yn : "N"
					};
					com.pop.open(com.pop.TYPE.ACNNO, data, function(ret){						
						if(ret.bsns_cd_inout ==  "RHA003" || ret.bsns_cd_inout == "RHA004" || ret.student_cost_use != "Y"){
							alert("민간수탁, 자체연구사업 또는 비풀링제과제는 학생인건비를 흡수할 수 없습니다.");
							return;
						}						
						dlt_list.setCellData(row, "cud_type", "C");
						dlt_list.setCellData(row, "accnt_no", ret.accnt_no);				
						dlt_list.setCellData(row, "accnt_no_nm", ret.accnt_no_nm);
						dlt_list.setCellData(row, "accnt_rspns_nm", ret.accnt_rspns_nm);
						dlt_list.setCellData(row, "accnt_rspns", ret.accnt_rspns);
						dlt_list.setCellData(row, "accnt_empno", ret.accnt_rspns.substring(2,8));
						dlt_list.setCellData(row, "accnt_prd", ret.start_ymd+"~"+ret.cls_ymd);
						
						dma_search.set("unslip_no", "");
						dma_search.set("absrp_yrmon", dlt_list.getCellAllData(row, "absrp_yrmon"));
						dma_search.set("accnt_no", dlt_list.getCellAllData(row, "accnt_no"));
						
						com.execute(sbm_selectSlipAccntData, {
							successCallback : function(e){
								dlt_list.removeRow(row);						
								dlt_list.setJSON(e.responseJSON.fsaAbsrpVoList, true);	
								if(e.responseJSON.fsaAbsrpVoList.length == 0){
									alert("기존 흡수내역이 존재하지 않으므로 추가흡수할 수 없습니다.");
									return;
								}			
							}
						});
					});			
				}				
				
			}
		
	};
	
	/* 
	* 결재신청
	*/
	scwin.btn_apr_onclick =  function(e) {
		com.execute(sbm_SaveAprData, {
			successCallback : function(e){							
				com.movePageMenu("A001", { "reqNo" :  dma_slipH.get("unslip_no")});									
			}
		});										
	};
	
	
	/* 
	* 추가흡수 금액 검증
	*/
	
	scwin.grd_plusSlip_onviewchange = function(info) {		
					
		if(grd_plusSlip.getColumnID(info.colIndex) == "plan_amt" && info.newValue > 0){
						
			if(info.newValue > dlt_list.getCellData(info.rowIndex, "ori_plan_amt")){
				alert("흡수금액은 예산잔액을 초과할 수 없습니다.");
				dlt_list.setCellData(info.rowIndex, "plan_amt", 0);
				return;
			}	
			
		}
		if(grd_plusSlip.getColumnID(info.colIndex) == "plan_amt" && info.newValue < 0){
			alert("마이너스 금액은 입력할 수 없습니다.");	
			dlt_list.setCellData(info.rowIndex, "plan_amt", 0);
			return;
		}	
		if(grd_plusSlip.getColumnID(info.colIndex) == "absrp_yrmon" && (grd_plusSlip.getCellDisplayData(grd_plusSlip.getFocusedRowIndex(), "accnt_no")).trim() != "" ){
			
			dma_search.set("absrp_yrmon", info.newValue);
			dma_search.set("accnt_no", dlt_list.getCellAllData(info.rowIndex, "accnt_no"));
			dlt_list.setCellData(info.rowIndex, "cud_type", "C");
			
			com.execute(sbm_selectSlipAccntData, {
				successCallback : function(e){
					dlt_list.removeRow(info.rowIndex);						
					dlt_list.setJSON(e.responseJSON.fsaAbsrpVoList, true);
				//	debugger;	
					if(e.responseJSON.fsaAbsrpVoList.length == 0){
						alert("기존 흡수내역이 존재하지 않으므로 추가흡수할 수 없습니다.");
						return;
					}			
				}
			});
		}
	};
	
	
	/*
     *  이관대상 연수책임자 검색 버튼 클릭 이벤트
     */
	scwin.btn_aftrAcctRspsn_onclick = function(e) {
		scwin.selectHumBtn(idx_aftrAccntRspsn.getValue(), "after");
	};
	scwin.btn_befrAcctRspsn_onclick = function(e) {
		scwin.selectHumBtn(idx_befrAccntRspsn.getValue(), "before");		
	};
	
	
	/*
     *  직원검색 팝업 호출
     */
	scwin.selectHumBtn = function(empNo, str) {
		var workClsf = "HAG090";
		
		if(str == "after"){
			 workClsf = "HAG010";
		}
		
		var data = {
			empno : empNo,
			work_clsf : workClsf,
			ref_yn : (empNo == "")? "Y" : "N"
		};
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			if (ret) {
				if(str == "after"){
					idx_aftrAccntRspsn.setValue(ret.empno);
					idx_aftrAccntRspsnNm.setValue(ret.nm);		
					aftrAccntRspns = ret.syspayno;						
				}else{
					idx_befrAccntRspsn.setValue(ret.empno);
					idx_befrAccntRspsnNm.setValue(ret.nm);
					var slipYmd = idx_slip_ymd.getValue();
					dma_search.set("accnt_rspns", ret.syspayno);
					dma_search.set("bugt_yr", slipYmd.substr(0, 4));
					dma_search.set("relat_no", ret.empno);	
					com.execute(sbm_selectTrnsSlipAccntData, {
						successCallback : function(e){					
							dlt_list.setJSON(e.responseJSON.resStuCostTrnsVoList, false);	
							if(dlt_list.getRowCount() == 0){
								alert("기존 학생인건비 예산내역이 존재하지 않습니다.");
								return;
							}else{
								dlt_list.setCellData(0, "cud_type", "C");	
								dlt_list.setCellData(1, "cud_type", "C");
								dlt_list.setCellData(0, "bfr_accnt_rspns", ret.syspayno);								
							}
										
						}
					});					
				}				
			}
		});
	};
		
	
	/**
	 * 계정책임자 변경 이벤트
	 */
	scwin.idx_aftrAccntRspsn_onviewchange = function(info) {
		if(idx_aftrAccntRspsn.getValue() == ""){
			idx_aftrAccntRspsnNm.setValue("");			
			dlt_list.setCellData(0, "aftr_accnt_rspns", "");
		}
	};	
	scwin.idx_befrAccntRspsn_onviewchange = function(info) {
		if(idx_befrAccntRspsn.getValue() == ""){
			idx_befrAccntRspsnNm.setValue("");			
			dma_search.set("relat_no", "");
		}else{
					
		}
	};
	
	
	scwin.grd_transSlip_onviewchange = function(info) {		
					
		if(grd_transSlip.getColumnID(info.colIndex) == "unslip_amt" && info.newValue > 0){
			
			var totalSum = dlt_list.getCellData(info.rowIndex, "cryfwd_bugt")+dlt_list.getCellData(info.rowIndex, "bugt_amt")-dlt_list.getCellData(info.rowIndex, "enfrc_amt");							
			if(info.newValue > totalSum ){
				alert("결의금액은 예산잔액을 초과할 수 없습니다.");
				dlt_list.setCellData(info.rowIndex, "unslip_amt", 0);
				return;
			}				
		}	
		if(grd_transSlip.getColumnID(info.colIndex) == "unslip_amt" && info.newValue < 0){
			
			alert("결의금액은 마이너스 입력이 불가능합니다.");
			dlt_list.setCellData(info.rowIndex, "unslip_amt", 0);
			return;
		}
	};]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group class="pageWrap" id="" style="">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="">
    				<xf:trigger class="btn " id="btn_list" style="" type="button" ev:onclick="scwin.btn_list_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox" id="">
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group tagname="table" style="width:100%;" id="" class="w2tb tbl">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group tagname="col" style="width:170px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:170px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:170px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:170px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>7</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup" cols="" id="radioSliptype" ref="" renderType="radiogroup" rows=""
    						selectedIndex="-1" style=""  ev:onviewchange="scwin.radioSliptype_onviewchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[추가흡수]]></xf:label>
    								<xf:value><![CDATA[A]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[흡수취소]]></xf:label>
    								<xf:value><![CDATA[C]]></xf:value>
    							</xf:item>  
    							<xf:item>
    								<xf:label><![CDATA[이관]]></xf:label>
    								<xf:value><![CDATA[T]]></xf:value>
    							</xf:item>    							
    						</xf:choices>
    					</xf:select1>
    				</xf:group></xf:group><xf:group tagname="tr" style="">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal full" focusOnDateSelect="false" footerDiv="false"
    						id="idx_slip_ymd" renderDiv="true" rightAlign="false" style="max-width: 200px;" ref="data:dma_slipH.slip_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의번호"  style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" readonly="true" disabled="true" id="" style="" title="" ref="data:dma_slipH.unslip_no"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성자" style="" readonly="true" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:group class="flex" id="" style="">
    						<xf:input adjustMaxLength="false" class="inp full" readonly="true" disabled="true" id="idx_empno" style="max-width: 200px;" ref="data:dma_slipH.empno"></xf:input>
    						<xf:input adjustMaxLength="false" class="inp full" readonly="true" disabled="true" id="idx_nm" style="max-width: 200px;" ref="data:dma_slipH.nm"></xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false"  readonly="true" disabled="true" class="inp full" id="" style="" title="" ref="data:dma_slipH.dept_nm"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="idx_rmk" style="" title="" ref="data:dma_slipH.rmk"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">확정유무<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes><w2:textbox id="" readonly="true" style="" tagname="span"></w2:textbox></xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title=""  readonly="true" disabled="true" ref="data:dma_slipH.decsn_ex_nm"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id=""  label="확정결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title=""  readonly="true" disabled="true" ref="data:dma_slipH.slip_no"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="첨부화일" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>7</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="" id="upload_A" style="height:150px;"></xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="helparea" id="" style="">
    			<xf:group id="" style="" tagname="ol">
    				<xf:group id="" tagname="li">
    					<w2:textbox class="red" id="" label="학생인건비 흡수취소 : 결재 완료후, 반드시 실행예산을 감액하시기 바랍니다(감액하지 않을 경우 재흡수됨)." style=""
    						tagname="span">
    					</w2:textbox>
    				</xf:group>
    				<xf:group id="" style="" tagname="li">
    					<w2:textbox class="red" id="" label="결의생성 후 수정할 수 없습니다. 수정이 필요할 경우 삭제 후 다시 작성해주시기 바랍니다." style="" tagname="span">
    					</w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:switch style="position: relative;display: block;height: 310px;overflow-y: auto;" id="switch1">
    			<xf:case style="position: absolute;top: 0;left: 0 !important;width: 100% !important;" id="case1">    		    		
    				<xf:group class="titleSection" id="" style="">
		    			<xf:group class="le" id="">
		    				<w2:textbox class="tit_tbl" id="" label="추가흡수내역" style="" tagname="h3"></w2:textbox>
		    			</xf:group>
		    			<xf:group class="ri" id="">
		    				<xf:group class="btnarea" id="" style="">
		    					<xf:trigger class="bt_plus" id="btn_slip_plus" style="" type="button" ev:onclick="scwin.btn_slip_plus_onclick">
		    						<xf:label><![CDATA[추가]]></xf:label>
		    					</xf:trigger>
		    					<xf:trigger class="bt_minus" id="btn_slip_minus" style="" type="button" ev:onclick="scwin.btn_slip_minus_onclick">
		    						<xf:label><![CDATA[삭제]]></xf:label>
		    					</xf:trigger>
		    				</xf:group>
		    			</xf:group>
		    		</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_plusSlip" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" visibleRowNum="20" summaryAuto="true"
    					sortable="true" ev:oncellclick="scwin.grd_plusSlip_oncellclick" ev:onviewchange="scwin.grd_plusSlip_onviewchange">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column41" inputType="text" style="height:28px;" value="흡수월" width="100"
    								colSpan="1" rowSpan="">
    							</w2:column>
    							<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="계정번호" width="100"
    								colSpan="2" rowSpan="">
    							</w2:column>
    							<w2:column displayMode="label" id="column43" inputType="text" style="height:28px" value="회계코드"
    								width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="column45" inputType="text" style="height:28px;" value="계정책임자" width="170"
    								colSpan="2" rowSpan="">
    							</w2:column>
    							<w2:column displayMode="label" id="column47" inputType="text" style="height:28px" value="연구기간"
    								width="150">
    							</w2:column>
    							<w2:column displayMode="label" id="column49" inputType="text" style="height:28px" value="예실잔액"
    								width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="column51" inputType="text" style="height:28px" value="흡수요청액"
    								width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="column55" inputType="text" style="height:28px" value="신청사유"
    								width="200">
    							</w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" id="absrp_yrmon" inputType="calendar" calendarValueType="yearMonth"  style="height:28px" value="" width="40" viewType="icon"></w2:column>
    							
    							<w2:column displayMode="label" id="accnt_no" inputType="text" readOnly="true" style="height:28px;"
    								width="70" dataType="text" >
    							</w2:column>
    							<w2:column width="30" inputType="button" style="height:28px" id="btn_accntno" value="조회" displayMode="label"
    								class="btn_sch">
    							</w2:column>
    							<w2:column displayMode="label" id="accnt_cd" inputType="text" style="height:28px" disabled="true" value=""
    								width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="accnt_empno" inputType="text" style="height:28px" disabled="true"
    								value="" width="100" readOnly="true">
    							</w2:column>
    							<w2:column displayMode="label" id="accnt_rspns_nm" inputType="text" style="height:28px" disabled="true"
    								value="" width="70" readOnly="true">
    							</w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" id="accnt_prd" disabled="true" value=""
    								displayMode="label" readOnly="true">
    							</w2:column>
    							<w2:column displayMode="label" id="ori_plan_amt" inputType="text" disabled="true" style="height:28px"
    								value="" width="150" dataType="number" displayFormat="#,###" class="ri" readOnly="true">
    							</w2:column>
    							<w2:column displayMode="label" id="plan_amt" inputType="text" class="ri" style="height:28px" value="" width="100" dataType="number" displayFormat="#,###"></w2:column>
    							<w2:column displayMode="label" id="rmk" inputType="text" style="height:28px" value="" width="200" class="le"></w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    			<xf:case style="position: absolute;top: 25px;left: 0 !important;width: 100% !important;" id="case2">
    				<xf:group tagname="table" style="width:100%;" id="" class="w2tb tbl">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group tagname="col" style="width:170px;"></xf:group>
    						<xf:group tagname="col" style=""></xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="흡수취소 계정번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<xf:group class="flex" id="" style="">
    								<xf:input adjustMaxLength="false" class="inp full" id="idx_cnlAccntNo" style="max-width: 200px;"></xf:input>
    								<xf:trigger class="btn glass" id="btn_Cnlaccntno" style="" type="button" ev:onclick="scwin.btn_Cnlaccntno_onclick">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="흡수취소내역" style="" tagname="h3"></w2:textbox>
    					</xf:group>
    					<xf:group class="ri" id="">
    						<xf:group class="btnarea" id="" style="">
    							<xf:trigger class="bt_plus" id="btn_cancel_plus" style="" type="button" ev:onclick="scwin.btn_cancel_plus_onclick">
    								<xf:label><![CDATA[추가]]></xf:label>
    							</xf:trigger>
    							<xf:trigger class="bt_minus" id="btn_cancel_minus" style="" type="button" ev:onclick="scwin.btn_cancel_minus_onclick">
    								<xf:label><![CDATA[삭제]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_minusSlip" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb"
    					rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태"
    					rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd"
    					selectedRowColor="#fbf2cd" style="height: 85px;" visibleRowNum="20" summaryAuto="true"     					sortable="true"  ev:onviewchange="scwin.grd_minusSlip_onviewchange">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column41" inputType="text" style="height:28px" value="흡수월" width="85"></w2:column>
    							<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="계정번호" width="79"></w2:column>
    							<w2:column displayMode="label" id="column43" inputType="text" style="height:28px" value="계정책임자" width="84"></w2:column>
    							<w2:column displayMode="label" id="column45" inputType="text" style="height:28px" value="연구기간" width="110"></w2:column>
    							<w2:column displayMode="label" id="column47" inputType="text" style="height:28px" value="과제명" width="200"></w2:column>
    							<w2:column displayMode="label" id="column49" inputType="text" style="height:28px" value="흡수금액" width="100"></w2:column>
    							<w2:column displayMode="label" id="column61" inputType="text" style="height:28px" value="흡수취소금액" width="100"></w2:column>
    							<w2:column displayMode="label" id="column65" inputType="text" style="height:28px" value="신청사유" width="171"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" id="absrp_yrmon" inputType="calendar" calendarValueType="yearMonth" style="height:28px" value="" width="85" viewType="icon"></w2:column>
    							<w2:column displayMode="label" id="accnt_no" inputType="text" readOnly="true" style="height:28px;" width="79" disabled="true"></w2:column>
    							<w2:column displayMode="label" id="accnt_rspns_nm" inputType="text" style="height:28px" value="" width="84" disabled="true" readOnly="true"></w2:column>
    							<w2:column displayMode="label" id="accnt_prd" inputType="text" style="height:28px" value="" width="110" disabled="true" readOnly="true"></w2:column>
    							<w2:column displayMode="label" id="accnt_no_nm" inputType="text" style="height:28px" value="" width="200" disabled="true" readOnly="true"></w2:column>
    							<w2:column displayMode="label" id="ori_plan_amt" inputType="text" dataType="number" displayFormat="#,###" style="height:28px" value="" class="ri" width="100" disabled="true" readOnly="true"></w2:column>
    							<w2:column displayMode="label" id="plan_amt" inputType="text" dataType="number" displayFormat="#,###" style="height:28px" value="" class="ri" width="100"></w2:column>
    							<w2:column displayMode="label" id="rmk" inputType="text" style="height:28px" value="" width="171"  class="le"></w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    			<xf:case style="position: absolute;top: 25px;left: 0 !important;width: 100% !important;" id="case3">
    				<xf:group tagname="table" style="width:100%;" id="" class="w2tb tbl">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group tagname="col" style="width:221px;"></xf:group>
    						<xf:group tagname="col" style=""></xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="이관대상 연수책임자(예산증액)" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<xf:group class="flex" id="grp_afrAccnt" style="">
    								<xf:input adjustMaxLength="false" class="inp full" id="idx_aftrAccntRspsn" style="max-width: 100px;"
    									ev:onviewchange="scwin.idx_aftrAccntRspsn_onviewchange">
    								</xf:input>
    								<xf:trigger class="btn glass" id="btn_aftrAcctRspsn" style="" type="button"
    									ev:onclick="scwin.btn_aftrAcctRspsn_onclick">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    								<xf:input adjustMaxLength="false" class="inp" id="idx_aftrAccntRspsnNm" disabled="true" title="사용자 정보"></xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="이관신청 연수책임자(예산감액)" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<xf:group class="flex" id="grp_bfrAccnt" style="">
    								<xf:input adjustMaxLength="false" class="inp full" id="idx_befrAccntRspsn" style="max-width: 100px;"
    									ev:onviewchange="scwin.idx_befrAccntRspsn_onviewchange">
    								</xf:input>
    								<xf:trigger class="btn glass" id="btn_befrAcctRspsn" style="" type="button"
    									ev:onclick="scwin.btn_befrAcctRspsn_onclick">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    								<xf:input adjustMaxLength="false" class="inp" id="idx_befrAccntRspsnNm" disabled="true" style="width: 100px;"
    									title="사용자 정보">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="이관내역" style="" tagname="h3"></w2:textbox>
    						<w2:textbox class="red" id="" label="(이관대상 금액(집행잔액)이 0원이상인 내역만 조회 됩니다. 결의가능금액 : A+B-C 이내)" style="" tagname="span"></w2:textbox>
    					</xf:group>    					
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_transSlip" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" visibleRowNum="20" summaryAuto="true"
    					sortable="true" ev:onviewchange="scwin.grd_transSlip_onviewchange">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">

    							<w2:column width="70" inputType="text" style="" id="column3" value="예산연도" displayMode="label"></w2:column>
    							<w2:column width="87" inputType="text" style="" id="column1" value="계정번호" displayMode="label"></w2:column>
    							<w2:column width="87" inputType="text" style="" id="column5" value="회계코드" displayMode="label"></w2:column>
    							<w2:column width="125" inputType="text" style="" id="column7" value="회계코드명" displayMode="label"></w2:column>
    							<w2:column width="70" inputType="text" style="" id="column9" value="계정책임자" displayMode="label"></w2:column>
    							<w2:column width="70" inputType="text" style="" id="column11" value="이월금액(A)" displayMode="label"></w2:column>
    							<w2:column width="70" inputType="text" style="" id="column13" value="예산금액(B)" displayMode="label"></w2:column>
    							<w2:column width="70" inputType="text" style="" id="column15" value="집행금액(C)" displayMode="label"></w2:column>
    							<w2:column width="102" inputType="text" style="" id="column17" value="결의금액" displayMode="label"></w2:column>
    							<w2:column width="180" inputType="text" style="" id="column19" value="비고" displayMode="label"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column width="70" inputType="text" style="height:0px" id="bugt_yr" value="" displayMode="label"
    								disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="87" inputType="text" style="height:0px" id="accnt_no" value="" displayMode="label"
    								disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="87" inputType="text" style="height:0px" id="accnt_cd" value="" displayMode="label"
    								disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="125" inputType="text" style="height:0px" id="accnt_cd_nm" value="" displayMode="label"
    								disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:0px" id="accnt_rspns_nm" value="" displayMode="label"
    								disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:0px" id="cryfwd_bugt" class="ri" value=""
    								dataType="number" displayFormat="#,###" displayMode="label" disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:0px" id="bugt_amt" class="ri" value=""
    								dataType="number" displayFormat="#,###" displayMode="label" disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:0px" id="enfrc_amt" class="ri" value=""
    								dataType="number" displayFormat="#,###" displayMode="label" disabled="true" readOnly="true">
    							</w2:column>
    							<w2:column width="102" inputType="text" style="height:0px" id="unslip_amt" class="ri" value=""
    								dataType="number" displayFormat="#,###" displayMode="label" disabled="false">
    							</w2:column>
    							<w2:column width="180" inputType="text" style="height:0px" id="rmk" value="" displayMode="label"
    								disabled="false" class="le">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" id="btn_create_slip" style="" type="button" ev:onclick="scwin.btn_create_slip_onclick">
    					<xf:label><![CDATA[결의생성]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn pro" id="btn_cancel_slip" style="" type="button" ev:onclick="scwin.btn_cancel_slip_onclick">
    					<xf:label><![CDATA[결의취소]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
