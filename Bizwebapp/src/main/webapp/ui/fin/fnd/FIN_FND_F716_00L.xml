<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="출금결의생성">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            	<w2:dataList baseNode="list" id="dlt_grd" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="chk" name="선택"></w2:column>
            			<w2:column id="slip_no" name="확정번호" dataType="text"></w2:column>
            			<w2:column id="pay_unslip_no" name="지급결의번호" dataType="text"></w2:column>
            			<w2:column id="slip_chk" name="출금결의여부" dataType="text"></w2:column>
            			<w2:column id="apr_state" name="결재상태코드" dataType="text"></w2:column>
            			<w2:column id="unslip_odr" name="결의순번" dataType="text"></w2:column>
            			<w2:column id="apr_state_nm" name="결재상태" dataType="text"></w2:column>
            			<w2:column id="send_odr" name="출금순번" dataType="text"></w2:column>
            			<w2:column id="rmk" name="송금내역적요" dataType="text"></w2:column>
            			<w2:column id="slip_ymd" name="결의일자" dataType="text"></w2:column>
            			<w2:column id="accnt_ymd" name="확정일자" dataType="text"></w2:column>
            			<w2:column id="send_req_amt" name="송금금액" dataType="text"></w2:column>
            			<w2:column id="pay_clsf" name="지급구분" dataType="text"></w2:column>
            			<w2:column id="vend_nm" name="거래처" dataType="text"></w2:column>
            			<w2:column id="bankaccnt_no" name="계좌번호" dataType="text"></w2:column>
            			<w2:column id="bank" name="은행" dataType="text"></w2:column>
            			<w2:column id="depstr_nm" name="예금주명" dataType="text"></w2:column>
            			<w2:column id="accnt_cd" name="회계코드" dataType="text"></w2:column>
            			<w2:column id="accnt_no" name="계정번호" dataType="text"></w2:column>
            			<w2:column id="accnt_rspns" name="계정책임자" dataType="text"></w2:column>
            			<w2:column id="rmk_1" name="비고1" dataType="text"></w2:column>
            			<w2:column id="rmk_2" name="비고2" dataType="text"></w2:column>
            			<w2:column id="rmk_3" name="비고3" dataType="text"></w2:column>
            			<w2:column id="decsn_ex" name="확정여부" dataType="text"></w2:column>
            			<w2:column id="slip_typ_cd" name="결의유형" dataType="text"></w2:column>
            			<w2:column id="fomat_unit" name="편성단위" dataType="text"></w2:column>
            			<w2:column id="syspayno" name="시스템개인번호" dataType="text"></w2:column>
            			<w2:column id="nm_payno" name="성명(개인번호)" dataType="text"></w2:column>
            			<w2:column id="pay_decsn_ex" name="출금결의확정여부" dataType="text"></w2:column>
            			<w2:column id="bank_send" name="은행(송금내역)" dataType="text"></w2:column>
            			<w2:column id="bankaccnt_no_send" name="계좌번호(송금내역)" dataType="text"></w2:column>
            			<w2:column id="depstr_nm_send" name="예금주(송금내역)" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_search" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="from_ymd" name="시작일자"></w2:key>
            			<w2:key dataType="text" id="to_ymd" name="종료일자"></w2:key>
            			<w2:key dataType="text" id="vend_cd" name="거래처코드"></w2:key>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="slip_no" name="확정결의번호"></w2:key>
            			<w2:key dataType="text" id="pay_unslip_no" name="지급결의번호"></w2:key>
            			<w2:key dataType="text" id="slip_chk" name="결의여부"></w2:key>
            			<w2:key dataType="text" id="apr_state" name="결재상태"></w2:key>
            			<w2:key id="syspayno" name="개인번호" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_crtSlip" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="slip_typ_cd" name="결의유형"></w2:key>
            			<w2:key dataType="text" id="slip_ymd" name="결의일자"></w2:key>
            			<w2:key dataType="text" id="rmk" name="헤더적요"></w2:key>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_slip" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="slip_no" name="확정번호"></w2:column>
            			<w2:column dataType="text" id="pay_unslip_no" name="지급결의번호"></w2:column>
            			<w2:column dataType="text" id="apr_state" name="결재상태코드"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="send_odr" name="출금순번"></w2:column>
            			<w2:column dataType="text" id="rmk" name="송금내역적요"></w2:column>
            			<w2:column dataType="text" id="slip_ymd" name="결의일자"></w2:column>
            			<w2:column dataType="text" id="accnt_ymd" name="확정일자"></w2:column>
            			<w2:column dataType="text" id="send_req_amt" name="송금금액"></w2:column>
            			<w2:column dataType="text" id="pay_clsf" name="지급구분"></w2:column>
            			<w2:column dataType="text" id="vend_nm" name="거래처"></w2:column>
            			<w2:column dataType="text" id="bankaccnt_no" name="계좌번호"></w2:column>
            			<w2:column dataType="text" id="bank" name="은행"></w2:column>
            			<w2:column dataType="text" id="depstr_nm" name="예금주명"></w2:column>
            			<w2:column dataType="text" id="accnt_cd" name="회계코드"></w2:column>
            			<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
            			<w2:column dataType="text" id="accnt_rspns" name="계정책임자"></w2:column>
            			<w2:column dataType="text" id="rmk_1" name="비고1"></w2:column>
            			<w2:column dataType="text" id="rmk_2" name="비고2"></w2:column>
            			<w2:column dataType="text" id="rmk_3" name="비고3"></w2:column>
            			<w2:column dataType="text" id="decsn_ex" name="확정여부"></w2:column>
            			<w2:column dataType="text" id="slip_typ_cd" name="결의유형"></w2:column>
            			<w2:column dataType="text" id="fomat_unit" name="편성단위"></w2:column>
            			<w2:column id="syspayno" name="시스템개인번호" dataType="text"></w2:column>
            			<w2:column dataType="text" id="pay_decsn_ex" name="출금결의확정여부"></w2:column>
            			<w2:column id="bank_send" name="은행(송금또는 출금계좌)" dataType="text"></w2:column>
            			<w2:column id="bankaccnt_no_send" name="계좌번호(송금또는 출금계좌)" dataType="text"></w2:column>
            			<w2:column id="depstr_nm_send" name="예금주(송금또는 출금계좌)" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection/>
            <!-- 조회 -->
			<xf:submission id="sbm_selectData" ref="data:json,dma_search" target='' 
        	    action="SvcFINFNDSLPR01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 계좌체크 -->
			<xf:submission id="sbm_checkData" ref='data:json,{"id":"dlt_slip","key":"slipList"}' target='' 
        	    action="SvcFINFNDSLPU01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결의취소 -->
			<xf:submission id="sbm_deleteData" ref='data:json,dma_search' target='' 
        	    action="SvcFINFNDSLPD01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결의취소 -->
			<xf:submission id="sbm_saveData" ref='data:json,[{"id":"dma_crtSlip","key":"slipHVo"},{"id":"dlt_slip","key":"slipList"}]' target='data:json,dma_search' 
        	    action="SvcFINFNDSLPM01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        </xf:model>
         <script type="text/javascript" lazy="false"><![CDATA[
    /****************************************************
 	 * 화면 설명 : 출금결의생성
 	 * 변경 이력 : 2023-09-14	이영희	최초 작성
 	 * serviceId : F716
 	 ****************************************************/  
 	/**
	* 페이지 로드
	*/
	scwin.onpageload = function() {
		// 초기 셋팅
		var today = com.getServerDateTime();
		ica_from.setValue(com.addDate(today.substring(0, 6) + "01", -30));
		ica_to.setValue(today);
		
		ica_slip_ymd.setValue(today); // 결의일자
		
		// 기간 역전 체크
		com.checkPeriod(ica_from, ica_to);
		
		// enter key event
		com.setEnterKeyEvent(grp_emp, scwin.btn_emp_onclick);	
		
		// 데이터 유효성 체크
		com.setValidGroup(grp_search, [
			  {id:"from_ymd", mandatory :true}
			, {id:"to_ymd", mandatory :true}
		]);	
		
		// 공통코드
		var codeOptions = [{ code : "XAD", compID :"sbx_apr_state" },
		                   { code : "FAA", compID :"sbx_bank,grd_list:bank"},
		                   { code : "FAX", compID :"grd_list:pay_clsf" }
					];		
		com.setCmnCd(codeOptions, function() {
			ibx_bankaccnt_no.setValue("144-039869-01-018");
			sbx_bank.setValue("FAA003");			
		});
		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/**
	* 목록 조회
	*/
	scwin.search = function(){			
		com.execute(sbm_selectData, {
			//isImplExcel : false,
			successCallback : function(e){
				dlt_grd.setJSON(e.responseJSON.finRcptPaySlipVoList);
				tbx_cnt.setValue(dlt_grd.getTotalRow());
				
				for(var i=0; i<dlt_grd.getRowCount(); i++){
					if(dlt_grd.getCellData(i, "pay_decsn_ex") == "Y"){
						grd_list.setCellDisabled(i, "chk", true);
					}
				}				
			}
		});
	};
	
	/**
	* 결의생성
	*/
	scwin.save = function(){
		dlt_slip.setJSON(grd_list.getCheckedJSON("chk"));
			
		dlt_slip.setCellData(0, "bank_send", sbx_bank.getValue());
		dlt_slip.setCellData(0, "bankaccnt_no_send", ibx_bankaccnt_no.getValue());
			
		dma_crtSlip.set("slip_typ_cd", "430");
		dma_crtSlip.set("slip_ymd", ica_slip_ymd.getValue());
		dma_crtSlip.set("rmk", dlt_slip.getCellData(0, "rmk_1") + " 출납결의");
		
		com.execute(sbm_saveData, {
			successCallback : function(e){
				com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
					// 미지급으로 조회하여 다시 결의생성할 경우가 많으므로 주석(2017.05.25)
					// dma_search.set("slip_chk", "Y");
					
					scwin.search();
				});
			}
		});		
	};	
	
	/**
	* 결의취소
	*/
	scwin.deleteSlip = function(){
		com.execute(sbm_deleteData,{
			successCallback : function(e){
				com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){					
					scwin.search();
				});
			}
		});
	};
	
	//----------------------------------------------------event --------------------------------------------//
	/**
	* 조회버튼 클릭
	*/
	scwin.btn_search_onclick = function(e) {
		if(com.validateGroup(grp_search)){	
			scwin.search();
		}
	};	
	
	/**
	 * 엑셀 다운로드 버튼 클릭 이벤트
	 */
	scwin.btn_excel_onclick = function(e) {
		if(dlt_grd.getRowCount() > 0){
			var option = {
				    fileName : "출금결의생성내역.xls"
				  , useDataFormat : true
//				  , hiddenVisible : true
			};
			com.downloadGridExcel(grd_list, option);
		}
	};
	
	/**
	 * 송금 개인번호 검색 버튼 클릭 이벤트
	 */
	scwin.btn_emp_onclick = function(e) {
		var data = {
			empno : ibx_emp_nm.getValue(),
			ref_yn : (ibx_emp_nm.getValue() =="")? "Y" : "N"
		};
		
		com.pop.open(com.pop.TYPE.HUM, data, function(ret){	
			ibx_emp_nm.setValue(ret.nm);
			dma_search.set("syspayno", ret.syspayno);			
		});
	};	
	
	/**
	 *  송금 개인번호 변경 이벤트
	 */
	scwin.ibx_emp_nm_onviewchange = function(info) {
		if(this.getValue() == ""){
			dma_search.set("syspayno", "");
		}
	};	
	
	/**
	 * 그리드 셀클릭 이벤트
	 */
	scwin.grd_list_oncellclick = function(row,col,colId) {
		if(colId == "btn_evid"){ // 전자증빙 뷰어 호출
			if(dlt_grd.getCellData(row, "pay_unslip_no").trim() == ""){
				alert("결의생성이 되지 않았습니다.");
				return;	
			}
			
			com.biz.openEvidWindow(dlt_grd.getCellData(row, "unslip_no"));
		}
	};
	
	/**
	 * 결의생성 버튼 클릭 이벤트
	 */
	scwin.btn_save_onclick = function(e) {
		var chkArr = grd_list.getCheckedIndex("chk");
		if(chkArr.length == 0){
			alert("결의서를 생성할 자료를 선택하십시오");
   			return;
		}
		
		if(ica_slip_ymd.getValue() == ""){
			alert("결의일자를 입력하십시오");
			ica_slip_ymd.focus();
			return;
		}
		
		if(ibx_bankaccnt_no.getValue() == ""){
			alert("계좌번호를 입력하십시오");
			return;
		}
		
		var reqNos = "";
		var psnCnt = 0;
		var accntYmd = dlt_grd.getCellData(chkArr[0], "accnt_ymd");
		var checkYmdFlag = true;
		for(var i=0; i<chkArr.length; i++){
			if(dlt_grd.getCellData(chkArr[i], "accnt_ymd") != accntYmd){
				checkYmdFlag = false;				
			}
			
			if(dlt_grd.getCellData(chkArr[i], "pay_unslip_no").trim() != ""){
				alert((chkArr[i]+1) + "번째 행의 자료는 이미 결의생성이 된 자료이므로 추가생성을 할 수가 없습니다. 취소후 생성하십시오.");
				return;
			}	
			
			if(/FAX010|FAX020/.test(dlt_grd.getCellData(chkArr[i], "pay_clsf"))){ // 개인, 거래처 지급인 경우에만
				if(dlt_grd.getCellData(chkArr[i], "bankaccnt_no") == "" || dlt_grd.getCellData(chkArr[i], "bank").trim() == "" || dlt_grd.getCellData(chkArr[i], "depstr_nm") == ""){
					alert((chkArr[i] + 1) + "번째 계좌정보가 충분하지 않습니다!");
					return;
				}
			}
		}
		
		if(!checkYmdFlag){
			com.confirm("출금결의 대상 중 서로 다른 확정일자가 존재합니다. 결의 진행하시겠습니까?", function(ret){
				if(ret){
					scwin.save();
				}
			});
		}else{
			com.confirm("결의서를 생성하시겠습니까 ?", function(ret){
				if(ret){
					scwin.save();
				}
			});
		}
	};
	
	/**
	 * 결의취소 버튼 클릭 이벤트
	 */
	scwin.btn_del_onclick = function(e) {
		var chkArr = grd_list.getCheckedIndex("chk");
		if(chkArr.length == 0){
			alert("결의서 취소시킬 자료를 선택하십시오");
   			return;
		}

		for(var i=0; i<chkArr.length; i++){			
			if(dlt_grd.getCellData(chkArr[i], "pay_unslip_no").trim() == ""){
				alert((chkArr[i]+1) + "번째 행의 자료는 결의생성이 안된 자료이므로 취소를 할 수가 없습니다. 생성후 취소하십시오.");
				return;
			}
			
			if(dlt_grd.getCellData(chkArr[i], "pay_decsn_ex") == "Y"){
				alert((chkArr[i]+1) + "번째 행의 자료는 확정결의 된 자료이므로 취소할 수가 없습니다.");
				return;
			}
		}
		
		if(confirm("결의서를 취소하시겠습니까 ?")){
			dma_search.set("pay_unslip_no", dlt_grd.getCellData(chkArr[0],"pay_unslip_no"));			
			scwin.deleteSlip();
		}
	};	

	/**
	 * 계좌체크 클릭 이벤트
	 */
	scwin.btn_check_accnt_onclick = function(e) {
		var rows = grd_list.getCheckedIndex("chk");
		if(rows.length == 0){
			alert("계좌체크할 데이터를 선택하세요.");
			return;	
		}
		
		dlt_slip.removeAll();
		var chkFlag = false;
		var totalAmt = 0;
		for(var i=0; i<rows.length; i++){
			if(/FAX010/.test(dlt_grd.getCellData(rows[i], "pay_clsf"))){ // FAX010 개인지급
				dlt_slip.setRowJSON(i, dlt_grd.getRowJSON(rows[i]));
				chkFlag = true;
			}
			
			totalAmt += com.parseInt(dlt_grd.getCellData(rows[i], "send_req_amt"));
		}
		
		if(chkFlag){ // 개인지급이 있을 경우 계좌체크
			com.execute(sbm_checkData, {
				successCallback : function(e){
					dlt_slip.setJSON(e.responseJSON.finRcptPaySlipVoList);
					
					var noBankMsg = "";
					totalAmt = 0;
					var idx=0;
					for(var i=0; i<rows.length; i++){
						if(/FAX010/.test(dlt_grd.getCellData(rows[i], "pay_clsf"))){ 
							dlt_grd.setCellData(rows[i], "bank", dlt_slip.getCellData(idx, "bank_send"));
							dlt_grd.setCellData(rows[i], "bankaccnt_no", dlt_slip.getCellData(idx, "bankaccnt_no_send"));
							dlt_grd.setCellData(rows[i], "depstr_nm", dlt_slip.getCellData(idx, "depstr_nm_send"));
							dlt_grd.setCellData(rows[i], "pay_clsf", dlt_slip.getCellData(idx, "pay_clsf"));
							
							if(dlt_slip.getCellData(idx, "bankaccnt_no") == ""){
								if(dlt_grd.getCellData(rows[i], "syspayno").trim() == ""){
									noBankMsg += "\n" + dlt_grd.getCellData(rows[i], "unslip_no") + "/" +
											 + dlt_grd.getCellData(rows[i], "nm_payno") + " " + 
											 + dlt_grd.getCellData(rows[i], "vend_nm") + "/미입력";
								}
							}
							idx++;
						}
						
						totalAmt += com.parseInt(dlt_grd.getCellData(rows[i], "send_req_amt"));
					}
					
					spn_totl_amt.setValue(" 계좌체크 완료금액 : " + com.formatNumber(totalAmt) + "원");
					alert(" 계좌체크 완료금액 : " + com.formatNumber(totalAmt) + "원" + noBankMsg);
				}
			});
		}else{
			spn_totl_amt.setValue(" 계좌체크 완료금액 : " + com.formatNumber(totalAmt) + "원");
			alert(" 계좌체크 완료금액 : " + com.formatNumber(totalAmt) + "원");
		}
	};
]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group class="pageWrap" id="" style="">
    		<xf:group class="searchSection" id="grp_search" style="">
    			<xf:group class="schbox" id="" style="">
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:240px;" tagname="col"></xf:group>
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:180px;" tagname="col"></xf:group>
    						<xf:group style="width:70px;" tagname="col"></xf:group>
    						<xf:group style="width:180px;" tagname="col"></xf:group>
    						<xf:group style="width:80px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="발생일자" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:group class="inpcalWrap" id="" style="">
    								<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false"
    									footerDiv="false" id="ica_from" placeholder="시작일" renderDiv="true" rightAlign="false" style=""
    									ref="data:dma_search.from_ymd">
    								</w2:inputCalendar>
    								<w2:textbox class="dash" id="" label="~" style="" tagname="span"></w2:textbox>
    								<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false"
    									footerDiv="false" id="ica_to" placeholder="종료일" renderDiv="true" rightAlign="false" style="" ref="data:dma_search.to_ymd">
    								</w2:inputCalendar>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="확정번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp" id="" style="width: 120px;" ref="data:dma_search.slip_no"></xf:input>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>2</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:select1 appearance="full" class="radioGroup" cols="" id="" ref="data:dma_search.slip_chk"
    								renderType="radiogroup" rows="" selectedIndex="2" style="">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[미지급]]></xf:label>
    										<xf:value><![CDATA[N]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[지급]]></xf:label>
    										<xf:value><![CDATA[Y]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[전체]]></xf:label>
    										<xf:value><![CDATA[]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:colspan>1</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<w2:textbox id="" label="결재상태" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="sbx_apr_state" style="width:120px;" submenuSize="auto"
    								ref="data:dma_search.apr_state" chooseOptionLabel="-전체-">
    								<xf:choices></xf:choices>
    							</xf:select1>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="거래처" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:group class="inpSch" id="" style="width: 100px;">
    								<xf:input adjustMaxLength="false" class="inp" id="" style="" title="거래처코드"
    									ref='data:dma_search.vend_cd'>
    								</xf:input>
    								<xf:trigger class="btn" id="" style="" title="주관자 검색" type="button">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    							<xf:input adjustMaxLength="false" class="inp" id="" style="width: 120px;" title="거래처 정보" disabled="true"></xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="개인번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:group class="inpSch" id="grp_emp" style="width: 120px;">
    								<xf:input adjustMaxLength="false" class="inp" id="ibx_emp_nm" style="" title="사용자명"
    									ev:onviewchange="scwin.ibx_emp_nm_onviewchange">
    								</xf:input>
    								<xf:trigger class="btn" id="btn_emp" style="" title="직원 검색" type="button"
    									ev:onclick="scwin.btn_emp_onclick">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes></w2:attributes>
    							<w2:textbox id="" label="결의번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp" id="" style="width: 120px;" ref="data:dma_search.unslip_no"></xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes></w2:attributes>
    							<w2:textbox id="" label="지급결의번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp" id="" style="width: 120px;"
    								ref="data:dma_search.pay_unslip_no">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group class="schbtn" id="">
    				<xf:trigger class="btn search" id="btn_search" style="" type="button" ev:onclick="scwin.btn_search_onclick">
    					<xf:label><![CDATA[조회]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="linebox bgblue mt2" id="" style="padding-top:2px; padding-bottom:2px;">
    			<xf:group class="schbox" id="" style="">
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:200px;" tagname="col"></xf:group>
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:200px;" tagname="col"></xf:group>
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							<w2:textbox class="blue" id="" label="출금계좌" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:group class="inpSch" id="" style="width: 180px;">
    								<xf:input adjustMaxLength="false" class="inp" id="ibx_bankaccnt_no" style="" title="계좌번호"></xf:input>
    								<xf:trigger class="btn" id="" style="" title="직원 검색" type="button">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							<w2:textbox class="blue" id="" label="은행" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:select1 allOption="true" appearance="minimal" chooseOption="" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="sbx_bank" ref="" style="width:150px;" submenuSize="auto">
    								<xf:choices></xf:choices>
    							</xf:select1>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes></w2:attributes>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							<w2:textbox class="blue" id="" label="결의일자" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false"
    								footerDiv="false" id="ica_slip_ymd" renderDiv="true" rightAlign="false" style="width: 120px;">
    							</w2:inputCalendar>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td" style="">
    							<w2:attributes></w2:attributes>
    							<xf:group class="btnarea" id="" style="float:right;"></xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="margin-top:0px;">
    			<xf:group class="le" id="">
    				<xf:group class="result" id="">
    					<w2:span id="" label="*조회결과 " style=""></w2:span>
    					<w2:span class="numtotal" id="tbx_cnt" label="0" style=""></w2:span>
    					<w2:span id="" label="건" style=""></w2:span>
    					<w2:span class="helptxt red full" id="spn_totl_amt" label=""
    						style="width:272 ;margin-left:20px;">
    					</w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn" id="btn_check_accnt" style="" type="button" ev:onclick="scwin.btn_check_accnt_onclick">
    					<xf:label><![CDATA[계좌체크]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[결의생성]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick">
    					<xf:label><![CDATA[결의취소]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn icon down" id="btn_excel" style="" type="button" ev:onclick="scwin.btn_excel_onclick">
    					<xf:label><![CDATA[엑셀다운로드]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_grd" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    			id="grd_list" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    			rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    			scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 120px;"
    			visibleRowNum="20" readOnly="true" ev:oncellclick="scwin.grd_list_oncellclick" tooltipDisplay="true" sortable="true">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column width="100" inputType="text" style="height:28px" id="column47" value="결의번호" displayMode="label"></w2:column>
    					<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="column1" inputType="checkbox"
    						readOnly="false" style="height:28px;" value="선택" width="40" sortable="false">
    					</w2:column>
    					<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="확정" width="70"></w2:column>
    					<w2:column colSpan="1" displayMode="label" id="column7" inputType="text" rowSpan="" style="height:28px;"
    						value="지급결의번호" width="100">
    					</w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" sortable="true" style="height:28px;" value="확정번호"
    						width="80">
    					</w2:column>
    					<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="확정일자" width="100"></w2:column>
    					<w2:column displayMode="label" id="column21" inputType="text" style="height:28px" value="결재상태" width="100"></w2:column>
    					<w2:column displayMode="label" id="column23" inputType="text" style="height:28px" value="금액" width="100"></w2:column>
    					<w2:column displayMode="label" id="column25" inputType="text" style="height:28px" value="지급구분" width="100"></w2:column>
    					<w2:column displayMode="label" id="column27" inputType="text" style="height:28px" value="거래처" width="160"></w2:column>
    					<w2:column colSpan="1" displayMode="label" id="column39" inputType="text" rowSpan="" style="height:28px;"
    						value="개인번호" width="100">
    					</w2:column>
    					<w2:column displayMode="label" id="column37" inputType="text" style="height:28px" value="계좌번호" width="150"></w2:column>
    					<w2:column displayMode="label" id="column35" inputType="text" style="height:28px" value="은행명" width="100"></w2:column>
    					<w2:column displayMode="label" id="column33" inputType="text" style="height:28px" value="예금주명" width="120"></w2:column>
    					<w2:column displayMode="label" id="column29" inputType="text" style="height:28px" value="적요" width="200"></w2:column>
    					<w2:column displayMode="label" id="column31" inputType="text" style="height:28px" value="증빙" width="70"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column width="100" inputType="text" style="height:28px" id="unslip_no" value="" displayMode="label"></w2:column>
    					<w2:column checkboxLabel="선택" displayMode="label" id="chk" inputType="checkbox" readOnly="false"
    						style="height:28px;" width="50">
    					</w2:column>
    					<w2:column displayMode="label" id="decsn_ex" inputType="text" readOnly="true" style="height:28px;" width="70"></w2:column>
    					<w2:column displayMode="label" id="pay_unslip_no" inputType="text" readOnly="true" style="height:28px;" value=""
    						width="100">
    					</w2:column>
    					<w2:column displayMode="label" id="slip_no" inputType="text" readOnly="true" style="height:28px;" width="80"></w2:column>
    					<w2:column displayMode="label" id="accnt_ymd" inputType="text" readOnly="true" style="height:28px;" width="100" dataType="date" displayFormat="yyyy-MM-dd"></w2:column>
    					<w2:column displayMode="label" id="apr_state_nm" inputType="text" style="height:28px" value="" width="100"></w2:column>
    					<w2:column displayMode="label" id="send_req_amt" inputType="text" style="height:28px" value="" width="100"
    						class="" dataType="number" displayFormat="#,###" textAlign="right">
    					</w2:column>
    					<w2:column displayMode="label" id="pay_clsf" inputType="select" style="height:28px" value="" width="100"></w2:column>
    					<w2:column displayMode="label" id="vend_nm" inputType="text" style="height:28px" value="" width="160"
    						textAlign="left">
    					</w2:column>
    					<w2:column displayMode="label" id="nm_payno" inputType="text" style="height:28px" value="" width="100"></w2:column>
    					<w2:column displayMode="label" id="bankaccnt_no" inputType="text" style="height:28px" value="" width="150"></w2:column>
    					<w2:column displayMode="label" id="bank" inputType="select" style="height:28px" value="" width="100"></w2:column>
    					<w2:column displayMode="label" id="depstr_nm" inputType="text" style="height:28px" value="" width="120"></w2:column>
    					<w2:column displayMode="label" id="rmk" inputType="text" style="height:28px" value="" width="200"
    						textAlign="left">
    					</w2:column>
    					<w2:column displayMode="label" id="btn_evid" inputType="button" style="height:28px" value="증빙" width="70"></w2:column>
    				</w2:row>
    			</w2:gBody>
    			<w2:footer style="" id="footer1">
    				<w2:row style="" id="row4">
    					<w2:column width="310" inputType="text" style="height:20px;" id="column79" value="합 계" displayMode="label" colSpan="4"
    						rowSpan="">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:20px" id="column75" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="text" style="height:20px" id="column74" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="text" style="height:20px" id="column73" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="expression" style="height:20px" id="column72" value="" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" expression="sum('send_req_amt')"></w2:column>
    					<w2:column width="100" inputType="text" style="height:20px" id="column71" value="" displayMode="label"></w2:column>
    					<w2:column width="160" inputType="text" style="height:20px" id="column70" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="text" style="height:20px" id="column69" value="" displayMode="label"></w2:column>
    					<w2:column width="150" inputType="text" style="height:20px" id="column68" value="" displayMode="label"></w2:column>
    					<w2:column width="100" inputType="text" style="height:20px" id="column67" value="" displayMode="label"></w2:column>
    					<w2:column width="120" inputType="text" style="height:20px" id="column66" value="" displayMode="label"></w2:column>
    					<w2:column width="200" inputType="text" style="height:20px" id="column65" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column64" value="" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:footer>
    		</w2:gridView>
    		<!-- <xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style="">
    			<xf:input adjustMaxLength="false" class="inp" id="" style="width:200px;" title=""></xf:input>
    			</xf:group>
    			<xf:group class="ri" id=""></xf:group>
    			</xf:group> -->
    	</xf:group>
    </body>
</html>
