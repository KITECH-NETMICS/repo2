<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="카드경비결의" meta_programId="FIN_SPM_F202_00d" meta_date="2022.04.08">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
        	<xf:instance>
        		<data xmlns="" />
        	</xf:instance>
        	<w2:dataCollection baseNode="map">

        		<w2:dataMap baseNode="map" id="dma_slipH">
        			<w2:keyInfo>
        				<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
        				<w2:key id="slip_typ_cd" name="결의유형" dataType="text"></w2:key>
        				<w2:key id="wrte_dept" name="작성부서" dataType="text"></w2:key>
        				<w2:key id="wrte_dept_new_ymd" name="작성부서신설일자" dataType="text"></w2:key>
        				<w2:key id="dept_nm" name="작성부서명" dataType="text"></w2:key>
        				<w2:key id="wrte_psn" name="작성자" dataType="text"></w2:key>
        				<w2:key id="empno" name="작성자개인번호" dataType="text"></w2:key>
        				<w2:key id="nm" name="작성자명" dataType="text"></w2:key>
        				<w2:key id="ext_no" name="작성자전화번호" dataType="text"></w2:key>
        				<w2:key id="slip_ymd" name="결의일자" dataType="text"></w2:key>
        				<w2:key id="rmk" name="적요" dataType="text"></w2:key>
        				<w2:key id="decsn_ex" name="확정여부" dataType="text"></w2:key>
        				<w2:key id="decsn_ex_nm" name="확정여부명" dataType="text"></w2:key>
        				<w2:key id="accnt_ymd" name="확정일자" dataType="text"></w2:key>
        				<w2:key id="slip_no" name="확정결의번호" dataType="text"></w2:key>
        				<w2:key id="cud_type" name="CUD타입" dataType="text"></w2:key>
        				<w2:key id="apr_state" name="결재상태" dataType="text"></w2:key>
        				<w2:key id="approval" name="결재여부" dataType="text"></w2:key>
        				<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_search">
        			<w2:keyInfo>
        				<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
        				<w2:key id="unslip_odr" name="결의순번" dataType="text"></w2:key>
        				<w2:key id="card_no" name="카드번호" dataType="text"></w2:key>
        				<w2:key id="accnt_cd" name="회계코드" dataType="text"></w2:key>
        				<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
        				<w2:key id="use_ymd" name="승인일자" dataType="text"></w2:key>
        				<w2:key id="apprvl_no" name="승인번호" dataType="text"></w2:key>
        				<w2:key id="card_no_tmp" name="카드번호" dataType="text"></w2:key>
        				<w2:key id="evid_yn" name="이지바로증빙여부" dataType="text"></w2:key>
        				<w2:key id="slip_typ_cd" name="결의유형" dataType="text"></w2:key>
        				<w2:key id="inqr_clsf" name="조회구분" dataType="text"></w2:key>
        				<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_cardList" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="card_no" name="카드번호2" dataType="text"></w2:column>
        				<w2:column id="cardno" name="카드번호" dataType="text"></w2:column>
        				<w2:column id="card_knd" name="카드종류" dataType="text"></w2:column>
        				<w2:column id="card_clsf" name="카드구분" dataType="text"></w2:column>
        				<w2:column id="use_ymd" name="승인일시" dataType="text"></w2:column>
        				<w2:column id="apprvl_no" name="승인번호" dataType="text"></w2:column>
        				<w2:column id="joinsto_nm" name="가맹점" dataType="text"></w2:column>
        				<w2:column id="supply_amt" name="공급가액" dataType="number"></w2:column>
        				<w2:column id="tax_amt" name="과세금액" dataType="number"></w2:column>
        				<w2:column id="use_amt" name="사용금액" dataType="number"></w2:column>
        				<w2:column id="un_amt" name="미처리금액" dataType="number"></w2:column>
        				<w2:column id="shop_addr1" name="주소1" dataType="text"></w2:column>
        				<w2:column id="shop_addr2" name="주소2" dataType="text"></w2:column>
        				<w2:column id="rmk" name="비고" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_slipD" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
        				<w2:column id="unslip_odr" name="결의순번" dataType="text"></w2:column>
        				<w2:column id="fomat_unit" name="편성단위" dataType="text"></w2:column>
        				<w2:column id="journ_cd" name="분개코드" dataType="text"></w2:column>
        				<w2:column id="journ_odr" name="분개순번" dataType="text"></w2:column>
        				<w2:column id="base_debit_cr" name="차대구분" dataType="text"></w2:column>
        				<w2:column id="accnt_no" name="계정번호" dataType="text"></w2:column>
        				<w2:column id="accnt_no_nm" name="계정명" dataType="text"></w2:column>
        				<w2:column id="accnt_rspns" name="계정책임자" dataType="text"></w2:column>
        				<w2:column id="start_ymd" name="계정시작일자" dataType="text"></w2:column>
        				<w2:column id="cls_ymd" name="계정종료일자" dataType="text"></w2:column>
        				<w2:column id="itm_solve_base" name="비목해소기준" dataType="text"></w2:column>
        				<w2:column id="accnt_cd" name="회계코드" dataType="text"></w2:column>
        				<w2:column id="accnt_cd_nm" name="회계코드명" dataType="text"></w2:column>
        				<w2:column id="expns_cd" name="비용코드" dataType="text"></w2:column>
        				<w2:column id="expns_cd_nm" name="비용코드명" dataType="text"></w2:column>
        				<w2:column id="tax_cd" name="과세구분" dataType="text"></w2:column>
        				<w2:column id="mngmt_clsf" name="관리구분" dataType="text"></w2:column>
        				<w2:column id="unslip_amt" name="결의금액" dataType="number"></w2:column>
        				<w2:column id="total_amt" name="총액" dataType="number"></w2:column>
        				<w2:column id="tax_amt" name="세액" dataType="number"></w2:column>
        				<w2:column id="ctrl_no" name="통제번호" dataType="text"></w2:column>
        				<w2:column id="evid_cd" name="증빙코드" dataType="text"></w2:column>
        				<w2:column id="ramt_mngmt_1" name="잔액관리항목1" dataType="text"></w2:column>
        				<w2:column id="ramt_mngmt_2" name="잔액관리항목2" dataType="text"></w2:column>
        				<w2:column id="rmk_1" name="적요" dataType="text"></w2:column>
        				<w2:column id="rmk_2" name="거래처" dataType="text"></w2:column>
        				<w2:column id="attach_file_no" name="첨부파일번호" dataType="text"></w2:column>
        				<w2:column id="pay_clsf" name="지급구분" dataType="text"></w2:column>
        				<w2:column id="occr_slip_no" name="발생결의번호" dataType="text"></w2:column>
        				<w2:column id="occr_slip_odr" name="발생결의순번" dataType="text"></w2:column>
        				<w2:column id="bf_occr_slip_no" name="이전발생결의번호" dataType="text"></w2:column>
        				<w2:column id="bf_occr_slip_odr" name="이전발생결의순번" dataType="text"></w2:column>
        				<w2:column id="accnt_no_clsf" name="계정번호구분" dataType="text"></w2:column>
        				<w2:column id="card_no" name="카드번호" dataType="text"></w2:column>
        				<w2:column id="card_clsf" name="카드종류" dataType="text"></w2:column>
        				<w2:column id="card_knd" name="카드구분" dataType="text"></w2:column>
        				<w2:column id="use_ymd" name="사용일자" dataType="text"></w2:column>
        				<w2:column id="apprvl_no" name="승인번호" dataType="text"></w2:column>
        				<w2:column id="bf_total_amt" name="이전결의총액" dataType="number"></w2:column>
        				<w2:column id="bf_unslip_amt" name="이전결의금액" dataType="number"></w2:column>
        				<w2:column id="cud_type" name="CUD유형" dataType="text"></w2:column>
        				<w2:column id="evid_yn" name="이지바로 증빙구분" dataType="text"></w2:column>
        				<w2:column id="service_id" name="이지바로 증빙 serviceId" dataType="text"></w2:column>
        				<w2:column id="req_no" name="신청번호" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_mngmt" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
        				<w2:column id="unslip_odr" name="결의순번" dataType="text"></w2:column>
        				<w2:column id="mngmt_item_cd" name="관리항목코드" dataType="text"></w2:column>
        				<w2:column id="mngmt_item_nm" name="관리항목이름" dataType="text"></w2:column>
        				<w2:column id="mngmt_detls_cd" name="관리상세코드" dataType="text"></w2:column>
        				<w2:column id="mngmt_detls_nm" name="관리상세명" dataType="text"></w2:column>
        				<w2:column id="essen_ex" name="필수여부" dataType="text"></w2:column>
        				<w2:column id="data_form" name="데이터형식" dataType="text"></w2:column>
        				<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
        				<w2:column id="btn_view" name="세부팝업" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataMap baseNode="map" id="dma_searchCode" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="code_clsf" name="코드구분"></w2:key>
        				<w2:key dataType="text" id="syspayno" name="개인번호"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" id="dlt_code" repeatNode="map" saveRemovedData="true" style="">
        			<w2:columnInfo>
        				<w2:column dataType="text" id="code" name="코드"></w2:column>
        				<w2:column dataType="text" id="code_nm" name="코드명"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataMap baseNode="map" id="dma_slipD">
        			<w2:keyInfo>
        				<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
        				<w2:key id="unslip_odr" name="결의순번" dataType="text"></w2:key>
        				<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
        				<w2:key id="journ_cd" name="분개코드" dataType="text"></w2:key>
        				<w2:key id="journ_odr" name="분개순번" dataType="text"></w2:key>
        				<w2:key id="base_debit_cr" name="차대구분" dataType="text"></w2:key>
        				<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
        				<w2:key id="accnt_no_nm" name="계정명" dataType="text"></w2:key>
        				<w2:key id="accnt_rspns" name="계정책임자" dataType="text"></w2:key>
        				<w2:key id="start_ymd" name="계정시작일자" dataType="text"></w2:key>
        				<w2:key id="cls_ymd" name="계정종료일자" dataType="text"></w2:key>
        				<w2:key id="itm_solve_base" name="비목해소기준" dataType="text"></w2:key>
        				<w2:key id="accnt_cd" name="회계코드" dataType="text"></w2:key>
        				<w2:key id="accnt_cd_nm" name="회계코드명" dataType="text"></w2:key>
        				<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
        				<w2:key id="expns_cd_nm" name="비용코드명" dataType="text"></w2:key>
        				<w2:key id="tax_cd" name="과세구분" dataType="text"></w2:key>
        				<w2:key id="mngmt_clsf" name="관리구분" dataType="text"></w2:key>
        				<w2:key id="unslip_amt" name="결의금액" dataType="number"></w2:key>
        				<w2:key id="total_amt" name="총액" dataType="number"></w2:key>
        				<w2:key id="tax_amt" name="세액" dataType="number"></w2:key>
        				<w2:key id="ctrl_no" name="통제번호" dataType="text"></w2:key>
        				<w2:key id="evid_cd" name="증빙코드" dataType="text"></w2:key>
        				<w2:key id="ramt_mngmt_1" name="잔액관리항목1" dataType="text"></w2:key>
        				<w2:key id="ramt_mngmt_2" name="잔액관리항목2" dataType="text"></w2:key>
        				<w2:key id="rmk_1" name="비고1" dataType="text"></w2:key>
        				<w2:key id="rmk_2" name="비고2" dataType="text"></w2:key>
        				<w2:key id="attach_file_no" name="첨부파일번호" dataType="text"></w2:key>
        				<w2:key id="pay_clsf" name="지급구분" dataType="text"></w2:key>
        				<w2:key id="occr_slip_no" name="발생결의번호" dataType="text"></w2:key>
        				<w2:key id="occr_slip_odr" name="발생결의순번" dataType="text"></w2:key>
        				<w2:key id="bf_occr_slip_no" name="이전발생결의번호" dataType="text"></w2:key>
        				<w2:key id="bf_occr_slip_odr" name="이전발생결의순번" dataType="text"></w2:key>
        				<w2:key id="part_all_clsf" name="부분전체구분" dataType="text"></w2:key>
        				<w2:key id="accnt_no_clsf" name="계정번호구분" dataType="text"></w2:key>
        				<w2:key id="card_no" name="카드번호" dataType="text"></w2:key>
        				<w2:key id="card_clsf" name="카드종류" dataType="text"></w2:key>
        				<w2:key id="card_knd" name="카드구분" dataType="text"></w2:key>
        				<w2:key id="use_ymd" name="사용일자" dataType="text"></w2:key>
        				<w2:key id="apprvl_no" name="승인번호" dataType="text"></w2:key>
        				<w2:key id="bf_total_amt" name="이전결의총액" dataType="number"></w2:key>
        				<w2:key id="bf_unslip_amt" name="이전결의금액" dataType="number"></w2:key>
        				<w2:key id="cud_type" name="CUD유형" dataType="text"></w2:key>
        				<w2:key id="evid_yn" name="이지바로 증빙구분" dataType="text"></w2:key>
        				<w2:key id="service_id" name="이지바로 증빙 serviceId" dataType="text"></w2:key>
        				<w2:key id="validAttachNo" name="유효첨부파일번호" dataType="text"></w2:key>
        				<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_sendReq" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="unslip_no" name="가결의번호" dataType="text"></w2:column>
        				<w2:column id="unslip_odr" name="가결의순번" dataType="text"></w2:column>
        				<w2:column id="send_odr" name="송금순번" dataType="text"></w2:column>
        				<w2:column id="pay_clsf" name="지급구분" dataType="text"></w2:column>
        				<w2:column id="send_req_amt" name="송금의뢰금액" dataType="text"></w2:column>
        				<w2:column id="send_amt" name="송금금액" dataType="text"></w2:column>
        				<w2:column id="vend_cd" name="거래처코드" dataType="text"></w2:column>
        				<w2:column id="vend_nm" name="거래처명" dataType="text"></w2:column>
        				<w2:column id="syspayno" name="시스템개인번호" dataType="text"></w2:column>
        				<w2:column id="bankaccnt_no" name="계좌번호" dataType="text"></w2:column>
        				<w2:column id="bank" name="은행" dataType="text"></w2:column>
        				<w2:column id="depstr_nm" name="예금주명" dataType="text"></w2:column>
        				<w2:column id="card_no" name="카드번호" dataType="text"></w2:column>
        				<w2:column id="use_ymd" name="사용일자" dataType="text"></w2:column>
        				<w2:column id="apprvl_no" name="승인번호" dataType="text"></w2:column>
        				<w2:column id="bsns_psn_regst_no" name="사업자등록번호" dataType="text"></w2:column>
        				<w2:column id="joinsto_nm" name="가맹점명" dataType="text"></w2:column>
        				<w2:column id="rmk" name="비고" dataType="text"></w2:column>
        				<w2:column id="conf_accnt_cd" name="결의회계코드" dataType="text"></w2:column>
        				<w2:column id="cud_type" name="CUD타입" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataMap baseNode="map" id="dma_card">
        			<w2:keyInfo>
        				<w2:key id="card_no" name="카드번호" dataType="text"></w2:key>
        				<w2:key id="card_knd" name="카드종류" dataType="text"></w2:key>
        				<w2:key id="card_clsf" name="카드구분" dataType="text"></w2:key>
        				<w2:key id="apprvl_no" name="승인번호" dataType="text"></w2:key>
        				<w2:key id="use_ymd" name="승인일자" dataType="text"></w2:key>
        				<w2:key id="joinsto_nm" name="가맹점명" dataType="text"></w2:key>
        				<w2:key id="shop_addr1" name="가맹점주소1" dataType="text"></w2:key>
        				<w2:key id="shop_addr2" name="가맹점주소2" dataType="text"></w2:key>
        				<w2:key id="supply_amt" name="공급가액" dataType="number"></w2:key>
        				<w2:key id="tax_amt" name="과세금액" dataType="number"></w2:key>
        				<w2:key id="use_amt" name="사용금액" dataType="number"></w2:key>
        				<w2:key id="un_amt" name="미처리금액" dataType="number"></w2:key>
        				<w2:key id="rmk" name="비고" dataType="text"></w2:key>
        				<w2:key id="card_no_tmp" name="카드번호2" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_cardsum">
        			<w2:keyInfo>
        				<w2:key id="tot_expns_amt" name="비용합계" dataType="text"></w2:key>
        				<w2:key id="tot_depst_amt" name="입금합계" dataType="text"></w2:key>
        				<w2:key id="tot_evid_amt" name="카드승인합계" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_cnt">
        			<w2:keyInfo>
        				<w2:key id="cnt" name="개수" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" id="dlt_check" repeatNode="map" saveRemovedData="true" style="">
        			<w2:columnInfo>
        				<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
        				<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
        				<w2:column dataType="text" id="serviceId" name="서비스id"></w2:column>
        				<w2:column dataType="text" id="chk_yn" name="체크YN"></w2:column>
        				<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
        				<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
        				<w2:column dataType="text" id="expns_cd_nm" name="비용코드명"></w2:column>
        				<w2:column dataType="text" id="chk_cnt" name="체크개수"></w2:column>
        				<w2:column dataType="text" id="rtn_msg" name="리턴메시지"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        	</w2:dataCollection>
        	<w2:workflowCollection></w2:workflowCollection>
        	<!-- 결의내역 조회 -->
        	<xf:submission id="sbm_selectSlip" ref="data:json,dma_search"
        		target='data:json,[{"id":"dma_slipH","key":"slipHVo"},{"id":"dlt_slipD","key":"slipDList"},{"id":"dma_cardsum","key":"evidSumVo"}]'
        		action="SvcFINSPMEXPR03.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 카드사용내역 조회 -->
        	<xf:submission id="sbm_selectCardInfoList" ref="data:json,dma_search"
        		target='data:json,{"id":"dlt_cardList","key":"cardInfoList"}' action="SvcFINSPMEXPR02.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 저장 -->
        	<xf:submission id="sbm_saveSlip"
        		ref='data:json,[{"id":"dma_slipH", "key":"slipHVo"},{"id":"dma_slipD", "key":"slipDVo"},{"action":"modified","id":"dlt_sendReq", "key":"sendList"},{"action":"modified","id":"dlt_mngmt", "key":"mngmtList"}]'
        		target='data:json,dma_search' action="SvcFINSPMEXPM01.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 카드목록 조회 -->
        	<xf:submission id="sbm_selectCodeList" ref="data:json,dma_searchCode" target='data:json,{"id":"dlt_code","key":"codeNmList"}'
        		action="SvcFINCOMCODR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 회계코드별 관리항목 조회 -->
        	<xf:submission id="sbm_selectMngmtItem" ref="data:json,dma_search" target='data:json,{"id":"dlt_mngmt","key":"mngmtVo"}'
        		action="SvcFINSPMEXPR04.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 관리항목 및 카드사용내역 조회 -->
        	<xf:submission id="sbm_selectSlipMngmt" ref="data:json,dma_search" target='data:json,[{"id":"dlt_mngmt", "key":"mngmtList"},{"id":"dma_card", "key":"cardVo"}]' action="SvcFINSPMEXPR05.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결의내역 삭제 -->
        	<xf:submission id="sbm_deleteSlip" ref="data:json,dma_slipD" target='' action="SvcFINSPMEXPD01.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<xf:submission id="sbm_selectItmEvidDetlsCnt" ref="data:json,dma_search" target='data:json,dma_cnt' action="SvcFINSPMEXPR06.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결재신청전 체크 -->
        	<xf:submission id="sbm_selectPreAprCheck" ref="data:json,dma_search" target='data:json,{"id":"dlt_check","key":"checkList"}' 
        	    action="SvcFINSPMEXPR15.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 회의록 정보 조회 -->
        	<xf:submission id="sbm_meetData" ref="data:json,dma_search" target='' 
        	    action="SvcFINSPMEXPR16.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        </xf:model>
        <script src="/cm/js/biz/fin.js" cache="false" />
        <script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 경비결의 생성
	 * 변경 이력 : 2022-04-08	이영희	최초 작성
	 * serviceId : F202
	 ****************************************************/
	// 전자증빙
	scwin.evidParam = {
		doc_id : "117"
	};

	scwin.data = {
		today : com.getServerDateTime(),
		typeCode : "F202",
		meet_accnt_no : "",
		meetFlag : false,
		allowExtension : "PDF,ppt,pptx,pptm,pps,ppsx,xls,xlsx,xlsm,doc,docx,docm,rif,txt,hwp,url,mht,mhtml,htm,html,jpg,jpeg,tif,tiff,gif,png,bmp"
	};
	
	scwin.meet = {};

	scwin.onpageload = function() {
		// 첨부파일 컴포넌트 초기화
		com.file.init();
		
		// parameter
		var param = com.getParameter();
		dma_search.setJSON(param);
		
		// 화면 권한 체크
		var session = com.getLoginInfo();
		com.biz.checkRole({serviceId : "F202", roleCodes : session.roleCode}, function(e){
			if(e.isRoleYn){
				inputEmpNo.setDisabled(false);
				btn_emp.setDisabled(false);
			}else{
				inputEmpNo.setDisabled(true);
				btn_emp.setDisabled(true);
			}
		});
			

		// 신규 등록에 사용하는 dataMap 빈값으로 초기화
		com.initDataMap(dma_slipD);
		// 변경사항 체크
		//scwin.checkList = [dma_slipD];

		// enter key event
		com.setEnterKeyEvent(grp_card, scwin.btnCardSrc_onclick);
		com.setEnterKeyEvent(grp_accnt_no, scwin.btn_accntNo_onclick);
		com.setEnterKeyEvent(grp_expns_cd, scwin.btn_expns_onclick);
		com.setEnterKeyEvent(grp_wrte_psn, scwin.btn_emp_onclick);
		
		btn_evidInfo.hide();
		textboxEvidMsg.hide();
		dma_search.set("slip_typ_cd", "117");		

		// 이전화면에서 파라미터 받음
		if(param.param4 == "apr" || param.req_no != undefined){
			dma_search.set("unslip_no", param.req_no);
		}
		
		if (dma_search.get("unslip_no") != "") {
			scwin.evidParam.req_no = dma_search.get("unslip_no");

			//조회실행
			scwin.search();
		} else {	
			// 첨부파일
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});	
			// 카드목록 조회
			dma_searchCode.set("code_clsf", "card_info");
			// test
			//dma_searchCode.set("syspayno", "19916141");
			dma_searchCode.set("syspayno", session.sn);
			com.execute(sbm_selectCodeList);
		
			com.initDataMap(dma_slipH);

			dma_slipH.set("slip_typ_cd", "117");
			dma_slipH.set("cud_type", "C");

			dma_slipH.set("wrte_psn", session.sn);
			dma_slipH.set("nm", session.cn);
			dma_slipH.set("empno", session.empno);			
			dma_slipH.set("wrte_dept", session.deptCode);
			dma_slipH.set("wrte_dept_new_ymd", session.deptNewYmd);
			dma_slipH.set("dept_nm", session.deptName);
			dma_slipH.set("slip_ymd", scwin.data.today);
			
			// 회의록에서 넘어온 경우
			//param.meet_req_no = "F25202208CB7";
			if(param.meet_req_no != undefined && param.meet_req_no != ""){
				if(param.alert_flag == "Y"){
					com.alert("message.xom.ui.fin.065") // 출장일 회의비에 대한 증빙서류(식대 제외 확인)로 회의 참석자 전원의 출장 신청서 및 정산서 첨부해 주세요
				}
				
				scwin.data.meetFlag = true;
				dma_search.set("req_no", param.meet_req_no);
				dma_search.set("apprvl_no", param.evid_apprno); // 같은 카드로 여러건 사용한 이력이 있을 수 있기에 승인번호로 단건조회
				
				// 회의록 정보 조회
				com.execute(sbm_meetData, {
					successCallback :function(e) {
						var ret = e.responseJSON.elData;

						scwin.meet.req_no = ret.req_no;
						scwin.meet.accnt_no = ret.accnt_no;
						scwin.meet.expns_cd = ret.expns_cd;
						scwin.meet.total_amt = ret.total_amt;
						scwin.meet.rmk_1 = ret.rmk_1;
						scwin.meet.apprvl_no = ret.apprvl_no;
						
						dma_search.set("card_no", ret.card_no.replace(/(\d{4})(\d{4})(\d{4})(\d{4})/, '$1-$2-$3-$4'));
						// 카드 사용내역 조회
						scwin.getCardInfo();
					}
				});
			}
		}
	};

	scwin.onpageunload = function() {
	};

	/**
	 * 결의서  조회
	 */
	scwin.search = function() {
		com.execute(sbm_selectSlip, {
			successCallback : function(e) {
				tbx_cnt.setValue(dlt_slipD.getRowCount());
				
				btn_print.setDisabled(false);
				btn_evid_view.setDisabled(false);
				
				if (dma_slipH.get("decsn_ex") == "Y") {
					btn_save.setDisabled(true);
					btn_del.setDisabled(true);
					btn_apr.setDisabled(true);
				}else{
					// 버튼 제어
					com.biz.disabledButtons(dma_slipH.get("apr_state"), dma_slipH.get("unslip_no"));	
				}
				
				grd_slipd.setFocusedCell(0,0);
				scwin.setSlipD(0);
				scwin.btnCardSrc_onclick();
			}
		});
	};

	/**
	 * 관리항목 조회
	 */
	scwin.setMngmt = function(accntCd) {
		dma_search.set("accnt_cd", accntCd);

		com.execute(sbm_selectMngmtItem, {
			successCallback : function(e) {
				scwin.setGrdMngmt(); // 관리항목 버튼 제어
			}
		});
	}

	/**
	 * 관리항목 그리드 셋팅
	 */
	scwin.setGrdMngmt = function(clsf) {
		for (var i = 0; i < dlt_mngmt.getRowCount(); i++) {
			if(clsf == undefined){
				dlt_mngmt.setCellData(i, "cud_type", "C");
			}
			// 2022.11.10. 관리항목 직접 입력가능하게 변경(구본준 요청)
//			if (/popup|dropdown/.test(dlt_mngmt.getCellData(i, "data_form"))) {
//				grd_mngmt.setCellDisabled(i, 2, true);
//			} else {
//				grd_mngmt.setCellDisabled(i, 2, false);
//			}
			
			if(clsf != "U"){
				if(rad_accnt_clsf.getValue() == "4"){
					switch(dlt_mngmt.getCellData(i, "mngmt_item_cd")){
						case "4001" : dlt_mngmt.setCellData(i,"mngmt_detls_cd", scwin.data.accnt_ymd); break; // 발생일자
						case "8005" : 
						case "1200" : dlt_mngmt.setCellData(i,"mngmt_detls_cd", scwin.data.mngmt_item_1); break; // 관련계정
						case "1003" : dlt_mngmt.setCellData(i,"mngmt_detls_nm", dma_slipD.get("rmk_2")); break; // 거래처코드
						case "1005" : dlt_mngmt.setCellData(i,"mngmt_detls_cd", dma_slipD.get("ramt_mngmt_2")); break; // 계좌번호
						case "2060" : 
							dlt_mngmt.setCellData(i,"mngmt_detls_nm", scwin.data.mngmt_item_1); 
							break; // 관련내용					
					}
				}else{
					switch(dlt_mngmt.getCellData(i, "mngmt_item_cd")){
						case "3001" : dlt_mngmt.setCellData(i,"mngmt_detls_cd", dma_slipD.get("rmk_2")); break; // 거래처명
						default : break;					
					}
				}
			}
		}
	}

	/**
	 * 전자증빙에서 req_no 입력 후 호출
	 */
	scwin.setMngmtDetls = function(mngmtItemCd, reqNo) {
		for (var i = 0; i < dlt_mngmt.getRowCount(); i++) {
			if (dlt_mngmt.getCellData(i, "mngmt_item_cd") == mngmtItemCd) {
				dlt_mngmt.setCellData(i, "mngmt_detls_cd", reqNo);
			}
		}
	}

	

	/**
	 * 과세계정여부에 따라서 결의금액 셋팅
	 */
	scwin.setUnslipAmt = function(taxCd) {
		var taxAmt = Number(dma_card.get("tax_amt")); // 카드사용액 세액
		var suplyValue = Number(dma_card.get("supply_amt"));
		var totalAmt = Number(inputTotalAmt.getValue());
		if (taxCd == "FTX001") {
			if (taxAmt > 0) {
				// 과세금액 + 공급가액이 총액(미처리금액)과 다를 경우
				if (taxAmt + suplyValue != inputTotalAmt.getValue()) {
					inputUnslipAmt.setValue(Math.floor(totalAmt * 10 / 11));
					inputTaxAmt.setValue(totalAmt - Number(inputUnslipAmt.getValue()));
				} else { // 증빙총액을 다시 입력했을 때 카드사 데이터 그대로 입력
					inputUnslipAmt.setValue(suplyValue);
					inputTaxAmt.setValue(taxAmt);
				}
			} else { // 카드사용내역 과세금액이 0 일 경우
				inputUnslipAmt.setValue(totalAmt);
				inputTaxAmt.setValue(0);
			}
		} else { // 비과세일 경우
			inputUnslipAmt.setValue(totalAmt);
			inputTaxAmt.setValue(0);
		}
	};

	/**
	 * 예산잔액 조회
	 */
	scwin.getBugtRamtAmt = function() {
		if(rad_accnt_clsf.getValue() == "4") return;
		
		var data = {
			bugt_yr : dma_slipH.get("slip_ymd").substring(0, 4),
			accnt_no : dma_slipD.get("accnt_no"),
			accnt_cd : dma_slipD.get("accnt_cd"),
			relat_no : dma_slipD.get("accnt_rspns").substring(2, 8)
		}

		var reqAmt = Number(dma_slipD.get("unslip_amt")) - Number(dma_slipD.get("bf_unslip_amt"));
		com.biz.checkBugtRamt(data, function(retObj){			
			if(retObj.bugt_amt == 0){
				if(retObj.bugt_ctrl_way == undefined || retObj.bugt_ctrl_way != "FAF021" ){ // FAF021 내역통제
					com.alert("message.xom.ui.fin.022"); // 예실에 미편성 된 데이터 입니다.\n 예실 편성 후 다시 시도해 주세요.
				}
			}else{
				var ramtAmt = Number(retObj.bugt_amt) - Number(retObj.cause_amt) - Number(retObj.enfrc_amt) - reqAmt;
				inputBugtRamtAmt.setValue(ramtAmt);
			}
							
		});		
	}
	
	/**
	 * 결의서 관리항목 조회
	 */
	scwin.searchSlipMngmt = function(){
		if(dma_search.get("card_no") == ""){
			dma_search.set("card_no", dma_slipD.get("ramt_mngmt_2"));	
			dma_card.set("card_no_tmp", ("****-****-" + dma_slipD.get("ramt_mngmt_2").substring(10, 19)));
		}
		dma_search.set("unslip_odr", dma_slipD.get("unslip_odr"));	
		
		com.execute(sbm_selectSlipMngmt, {
			successCallback : function(e) {
				dma_card.set("card_no", dma_slipD.get("card_no"));
				dma_card.set("card_clsf", dma_slipD.get("card_clsf"));
				dma_card.set("card_knd", dma_slipD.get("card_knd"));
				dma_card.set("card_no_tmp", dma_search.get("card_no_tmp"));	
				
				scwin.setGrdMngmt("U");
			}
		});
	};
	
	/**
	 * 그리드 디테일 setting
	 */
	scwin.setSlipD = function(row){
		// button 제어 
		btn_accntNo.hide();
		btn_expns.hide();
		ibx_accnt_no.setDisabled(true);
		ibx_expns_cd.setDisabled(true);
		// 카드내역 그리드의 포커스를 없앤다.
		grd_card.removeFocusedCell();
		
		dma_slipD.setJSON(dlt_slipD.getRowJSON(row));
		// 이지바로 증빙여부
		scwin.data.evid_chk = dma_slipD.get("evid_yn");
		
		var accntNo = dma_slipD.get("accnt_no");
		if(biz.fin.CONST.CON_ACCNT_REG.test(accntNo.substring(0, 3))){
			rad_accnt_clsf.setValue('3');
		}else if(accntNo == "FF030001"){
			rad_accnt_clsf.setValue('4');
		}else{
			rad_accnt_clsf.setValue('1');
		}
		
		if(dma_slipD.get("expns_cd") == "235"){
			btn_confrHis.show(); // 학술대회이력	
		}else{
			btn_confrHis.hide();
		}
		
		// 카드번호
		var cardNo = "****-****-" + dma_slipD.get("card_no").trim().substring(10, 19);
		inputCardNoSrc.setValue(cardNo);		
		dma_search.set("card_no", dma_slipD.get("card_no"));
		
		// 첨부파일
		if(dma_slipD.get("attach_file_no") != ""){
			com.file.create(upload_A.getID(), {fileKey: dma_slipD.get("attach_file_no"), mode: 'edit', allowExtension : scwin.data.allowExtension});	
		}else{
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});
		}
		
		// 전자증빙 조회
		scwin.evidParam.req_no = dma_slipD.get("unslip_no");
		scwin.evidParam.unslip_odr = dma_slipD.get("unslip_odr");
		scwin.evidParam.expns_cd = dma_slipD.get("expns_cd");
		wfm_evid.getWindow(0).scwin.evid_select(scwin.evidParam);		
		
		// 관리항목 및 카드내역 조회
		dma_search.set("unslip_odr", dma_slipD.get("unslip_odr"));
		dma_search.set("accnt_cd", dma_slipD.get("accnt_cd"));
		dma_search.set("card_no", dma_slipD.get("card_no"));
		dma_search.set("use_ymd", dma_slipD.get("use_ymd"));
		dma_search.set("apprvl_no", dma_slipD.get("apprvl_no"));
		
		// 관리항목, 카드내역, 이지바로
		scwin.searchSlipMngmt();
		
		// 2017.10.24. 이지바로과제일 경우 회의록 참조하여 fspitmeviddetls저장, 비용코드 410, 411일 때
		if(dma_slipD.get("evid_yn") == "Y"){
			dma_search.set("expns_cd", dma_slipD.get("expns_cd"));
			btn_evidInfo.show("");

			com.execute(sbm_selectItmEvidDetlsCnt, {
				successCallback : function(e){
					if(dma_cnt.get("cnt") == 0){
						btn_evidInfo.trigger("click");
					}
				}
			});
		}else{
			btn_evidInfo.hide();
			textboxEvidMsg.hide();
		}		
	}
	
	/**
	 * 카드 승인 일자 포맷
	 */
	scwin.formatDate = function(str){
		if(str == "") return "";
		var useYmd = str.replace(/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/, "$1-$2-$3 $4:$5:$6");
		
		return com.formatDateTime(new Date(useYmd), "yyyy-MM-dd HH:mm:ss");
	};

	//------------------------------------------------------------------------------------------------------------------  event

	/**
	 * 카드 정보 조회 버튼 클릭 이벤트
	 */
	scwin.btnCardSrc_onclick = function(e) {
		var cardNo = inputCardNoSrc.getValue();		
		if (cardNo == "") {
			com.alert(com.getMsg("message.xom.co.com.0001", "카드번호"));
			return;
		}
		// 차변 하나라도 입력 시 카드내역 조회되지 않는 이슈로 인하여 초기화
		dma_search.set("apprvl_no", "");
		dma_search.set("use_ymd", "");
		
		if (cardNo.length == 9) {
			dma_search.set("card_no", cardNo);
		}else if(cardNo.length == 8) {
			dma_search.set("card_no", cardNo.replace(/(\d{4})(\d{4})/,'$1-$2'));
		}else{
			dma_search.set("card_no", cardNo.substring(10,19));
		}
		
		scwin.getCardInfo();		
	};
	
	/**
	 * 카드정보조회
	 */
	scwin.getCardInfo = function(){
		com.execute(sbm_selectCardInfoList, {
			successCallback : function(e) {
				if(dlt_cardList.getRowCount() > 0){
					var cardNo = "****-****-" + dlt_cardList.getCellData(0, "card_no").substring(10, 19);
					inputCardNoSrc.setValue(cardNo);

					spa_cardCnt.setValue(dlt_cardList.getRowCount());
					
					// 회의록에서 넘어온 경우
					if(scwin.data.meetFlag){
						var row = dlt_cardList.getMatchedIndex("apprvl_no", scwin.meet.apprvl_no, true)[0];
						grd_card.setFocusedCell(row, 0);
					}
				}
			}
		});
	}

	/**
	 * 카드정보 그리드 row index change event
	 */
	scwin.grd_card_onrowindexchange = function(row, oldRow) {
		// 01. 결의서 디테일, 카드내역, 전자증빙 dataset 초기화
		dma_slipD.setEmptyValue();
		dma_card.setEmptyValue();
		dlt_mngmt.removeAll();
		
		// 첨부파일
		com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});
		
		if(rad_accnt_clsf.getValue() == "4"){
			ibx_rmk_1.hide();
			sbx_rmk_1.show();	
			sbx_rmk_1.setValue("");
		}else{
			ibx_rmk_1.show();
			sbx_rmk_1.hide();	
		}

		scwin.evidParam={};		
		scwin.evidParam.doc_id ="117";
		wfm_evid.getWindow(0).dlt_attach.removeAll();
		
		// 02. 신규입력시 버튼 제어
		btn_accntNo.show("");
		btn_expns.show("");
		ibx_accnt_no.setDisabled(false);
		ibx_expns_cd.setDisabled(false);
		
	    //03. 카드정보 dataset
		dma_card.setJSON(dlt_cardList.getRowJSON(row));
		if(dma_card.get("card_no").trim() != ""){
			dma_card.set("card_no_tmp", ("****-****-" + dma_card.get("card_no").substring(10, 19)));
		}
		
		// 회의록 자료인지 체크
		scwin.data.meetFlag = (scwin.meet.apprvl_no != undefined && scwin.meet.apprvl_no == dma_card.get("apprvl_no"));
		
		// 04. 결의서 디테일
		dma_slipD.set("cud_type", "C");
		// 예산잔액 초기화
		inputBugtRamtAmt.setValue(0);

		// 결의서 디테일 셋팅
		if (dma_card.get("tax_amt") == 0) {
			dma_slipD.set("unslip_amt", dma_card.get("un_amt"));
			dma_slipD.set("tax_amt", dma_card.get("tax_amt"));

		} else {
			dma_slipD.set("unslip_amt", dma_card.get("supply_amt"));
			dma_slipD.set("tax_amt", dma_card.get("tax_amt"));
		}

		dma_slipD.set("total_amt", dma_card.get("un_amt"));
		dma_slipD.set("bf_total_amt", 0);
		dma_slipD.set("bf_unslip_amt", 0);

		// 카드정보
		dma_slipD.set("card_knd", dma_card.get("card_knd"));
		dma_slipD.set("card_clsf", dma_card.get("card_clsf"));
		dma_slipD.set("card_no", dma_card.get("card_no"));
		dma_slipD.set("use_ymd", dma_card.get("use_ymd"));
		dma_slipD.set("apprvl_no", dma_card.get("apprvl_no"));
		dma_slipD.set("rmk_1", dma_card.get("rmk"));
		dma_slipD.set("rmk_2", dma_card.get("joinsto_nm"));		
		dma_slipD.set("base_debit_cr", "1");
		dma_slipD.set("evid_cd", "FAH500");
		dma_slipD.set("pay_clsf", "FAX900");
	
		if(scwin.data.meetFlag){
			dma_slipD.set("accnt_no", scwin.meet.accnt_no);
			// 수탁계정일 경우 수탁으로 셋팅
			if(biz.fin.CONST.CON_ACCNT_REG.test(scwin.meet.accnt_no.substring(0, 3))){
				rad_accnt_clsf.setValue("3");
			}
			dma_slipD.set("rmk_1", scwin.meet.rmk_1);
			btn_accntNo.trigger("click");
		}
	};

	/**
	 * 담당자 카드목록
	 */
	scwin.sbx_cardList_onviewchange = function(info) {
		dma_search.set("card_no_tmp", sbx_cardList.getText().substring(0, 19));
		dma_search.set("card_no", sbx_cardList.getValue());
		btnCardSrc.trigger("click");
	};

	/**
	 * 계정번호 검색팝업
	 */
	scwin.btn_accntNo_onclick = function(e) {
		if (inputCardNo.getValue() == "") {
			com.alert(com.getMsg("message.xom.ui.fin.002" ,"카드승인내역")); /*먼저 카드승인내역을 선택하세요.*/
			return;
		}

		var data = {
			accnt_no : ibx_accnt_no.getValue()
		};		
	
		if (rad_accnt_clsf.getValue() == '4') { // 입금인경우
			biz.fin.pop.open(biz.fin.pop.TYPE.ON_LINE, {slip_typ_cd : "117"}, function(retObj) {
				if (!scwin.check(retObj, 0)) return;
				
				// 팝업 콜백
				dma_slipD.set("accnt_no", retObj.accnt_no);
				dma_slipD.set("accnt_no_nm", retObj.accnt_no_nm);
				dma_slipD.set("accnt_rspns", retObj.accnt_rspns);
				dma_slipD.set("fomat_unit", retObj.fomat_unit);
				dma_slipD.set("tax_cd", retObj.tax_cd);
				dma_slipD.set("accnt_cd", retObj.accnt_cd);
				dma_slipD.set("accnt_cd_nm", retObj.accnt_cd_nm);
				dma_slipD.set("total_amt", retObj.unadjst_amt);
				dma_slipD.set("unslip_amt", retObj.unadjst_amt);
				dma_slipD.set("tax_amt", 0);
				dma_slipD.set("occr_slip_no", retObj.slip_no);
				dma_slipD.set("occr_slip_odr", retObj.slip_odr);
				dma_slipD.set("expns_cd", "999");
				dma_slipD.set("expns_cd_nm", "기타");
				dma_slipD.set("rmk_2", retObj.rmk_2);
				dma_slipD.set("ramt_mngmt_2", retObj.mngmt_item_2);
				
				scwin.data.accnt_ymd = retObj.accnt_ymd;
				scwin.data.mngmt_item_1 = retObj.mngmt_item_1;				
				
				// 관리항목 셋팅
				scwin.setMngmt(retObj.accnt_cd);
			});	
		} else {
			// TODO TEST 
			//data.accnt_no = "PIZ21850";
			
			// parameter setting
			data.cls_yr = ica_slip_ymd.getValue().substring(0, 4);
			data.clsf = (rad_accnt_clsf.getValue() == '1') ? "gen" : "con";
			data.ref_yn = (ibx_accnt_no.getValue() == '')?"Y":"N";

			com.pop.open(com.pop.TYPE.ACNNO, data, function(retObj) {
				if (retObj) {
					if (!scwin.check(retObj, 0))
						return;

					if (retObj.tax_cd == "FTX001") {
						grp_taxMsg.show();
					} else {
						grp_taxMsg.hide();
					}
					
					dma_slipD.set("accnt_no", retObj.accnt_no);
					dma_slipD.set("accnt_no_nm", retObj.accnt_no_nm);
					dma_slipD.set("accnt_rspns", retObj.accnt_rspns);
					dma_slipD.set("fomat_unit", retObj.fomat_unit);
					dma_slipD.set("start_ymd", retObj.start_ymd);
					dma_slipD.set("cls_ymd", retObj.cls_ymd);
					dma_slipD.set("itm_solve_base", retObj.itm_solve_base);

					dma_slipD.set("expns_cd", "");
					dma_slipD.set("expns_cd_nm", "");
					dma_slipD.set("accnt_cd", "");
					dma_slipD.set("accnt_cd_nm", "");
					dma_slipD.set("tax_cd", retObj.tax_cd);
					dma_slipD.set("accnt_no_clsf", retObj.card_use_ex);
					dma_slipD.set("evid_yn", retObj.evid_yn);

					scwin.data.evid_chk = retObj.evid_chk; // 증빙여부
					scwin.data.exclsv_agncy = retObj.bsns_cd_exclsv_agncy;
					dma_slipD.set("mngmt_clsf", retObj.mngmt_clsf);

					// 결의금액 셋팅
					scwin.setUnslipAmt(retObj.tax_cd);
					
					if(scwin.data.meetFlag){
						dma_slipD.set("expns_cd", scwin.meet.expns_cd);
						// 비용코드 및 회계코드 조회
						btn_expns.trigger("click");
					}
				}
			});
		}
	};

	/**
	 * 계정번호 blur event
	 */
	scwin.ibx_accnt_no_onblur = function(e) {
		var arr = ["accnt_rspns", "accnt_no_nm", "accnt_rspns", "fomat_unit"];
		arr.forEach(function(el, index) {
			dma_slipD.set(el, "");
		});
	};
	
	/**
	 * 필수입력값 체크
	 */
	scwin.validateData = function(){
		// 송금내역 셋팅
		var sendData = {
			pay_clsf : "FAX900",
			send_odr : 1,
			send_req_amt : dma_slipD.get("total_amt"),
			send_amt : dma_slipD.get("total_amt"),
			rmk : dma_slipD.get("rmk_1"),
			card_no : dma_slipD.get("card_no"),
			apprvl_no : dma_slipD.get("apprvl_no"),
			use_ymd : dma_slipD.get("use_ymd"),
			joinsto_nm : inputJoinstoNm.getValue(),
			cud_type : dma_slipD.get("cud_type"),
			unslip_no : dma_slipD.get("unslip_no"),
			unslip_odr : dma_slipD.get("unslip_odr")
		};
		
		dlt_sendReq.removeAll();
		dlt_sendReq.reform();
		dlt_sendReq.insertRow(0);
		dlt_sendReq.setRowJSON(0, sendData, true);	
		
		// 필수입력값 체크
		var validData = [
			{dataObj : dma_slipH, valInfoArr :[
				 { id : "slip_ymd", mandatory : true}
				,{ id : "slip_typ_cd", mandatory : true } 
				,{ id : "wrte_psn", mandatory : true } 
				,{ id : "wrte_dept", mandatory : true } 
				,{ id : "rmk", mandatory : true }
				], isCheckModified : false
			},
			{dataObj : dma_slipD, valInfoArr :[
				 { id : "journ_cd", mandatory : true}
				,{ id : "base_debit_cr", mandatory : true } 
				,{ id : "accnt_no", mandatory : true, allowChar : "A-Z0-9" } 
				,{ id : "accnt_rspns", mandatory : true } 
				,{ id : "accnt_cd", mandatory : true } 
				,{ id : "expns_cd", mandatory : true } 
				,{ id : "total_amt", mandatory : true, allowChar : "0-9"} 
				,{ id : "unslip_amt", mandatory : true, allowChar : "0-9" } 
				,{ id : "tax_amt", mandatory : true, allowChar : "0-9" } 
				,{ id : "evid_cd", mandatory : true } 
				,{ id : "rmk_1", mandatory : true } 
				,{ id : "rmk_2", mandatory : true } 
				,{ id : "card_no", mandatory : true } 
				,{ id : "card_clsf", mandatory : true } 
				,{ id : "card_knd", mandatory : true } 
				,{ id : "use_ymd", mandatory : true } 
				,{ id : "apprvl_no", mandatory : true } 
				], isCheckModified : false
			},
			{dataObj : dlt_sendReq, valInfoArr :[
				 { id : "send_odr", mandatory : true}
				,{ id : "pay_clsf", mandatory : true } 
				,{ id : "send_req_amt", mandatory : true } 
				,{ id : "card_no", mandatory : true } 
				,{ id : "use_ymd", mandatory : true } 
				,{ id : "apprvl_no", mandatory : true } 
				,{ id : "joinsto_nm", mandatory : true} 
				], isCheckModified : false
			}
		];
		
		if(dma_slipD.get("cud_type") == "C"){	
			if (rad_accnt_clsf.getValue() == "3") {
				dma_slipD.set("journ_cd", "Fn0064");
			} else {
				dma_slipD.set("journ_cd", "Fn0014");
			}
			
			// 잔액관리항목 셋팅
			if(rad_accnt_clsf.getValue() != "4"){
				if (dma_slipD.get("card_clsf") == "FAI001") {
					dma_slipD.set("ramt_mngmt_1", "BC");
				} else {
					if (dma_slipD.get("card_knd") == "FAJ002") {
						dma_slipD.set("ramt_mngmt_1", "BC");
					}else if (/FAJ003|FAJ006|FAJ007/.test(dma_slipD.get("card_knd"))) {
						dma_slipD.set("ramt_mngmt_1", "신한");
					}else if (/FAJ008|FAJ009/.test(dma_slipD.get("card_knd"))) {
						dma_slipD.set("ramt_mngmt_1", "보탬e");
					}
				}
				dma_slipD.set("ramt_mngmt_2", dma_slipD.get("card_no"));
			}
		}
		
		return com.validateData(validData);
	};

	/**
	 * 저장버튼 클릭
	 */
	scwin.btn_save_onclick = function(e) {		
		dma_slipH.set("approval", "false");
		scwin.data.aprYn = "N";
		
		// 저장 전 체크	
		if (!scwin.validateData()) return;
		if (!scwin.checkPreSave()) return;
		
		if(scwin.data.taxYn.length > 0){
			com.confirm(com.getMsg("message.xom.ui.fin.020", (scwin.data.taxYn.join(","))), function(ret){ // {0}번째 행은 과세계정이므로 부가세 입력이 필수 입니다. 부가세가 0원이 맞습니까?
				if(ret){
					scwin.callSave();
				}
			});
		}else{
			scwin.callSave();
		}		
	};
	
	scwin.callSave = function(){
		// 예산잔액 체크
		if(Number(inputBugtRamtAmt.getValue()) < 0){
			com.confirm("message.xom.ui.fin.033"/*예실잔액이 부족합니다. 저장 하시겠습니까?*/, function(ret){
				if(ret) scwin.save();
			});
		}else{
			com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
				if(ret) scwin.save();
			});
		}
	};
	
	/**
	 * 저장
	 */
	scwin.save = function(){
		dma_slipD.set("unslip_no", ibx_unslip_no.getValue());
		
		com.file.transport( function(attachObj){
			if(attachObj.upload_A != undefined && attachObj.upload_A.trim().length == 13){
				dma_slipD.set("attach_file_no", attachObj.upload_A);
				dma_slipD.set("validAttachNo", attachObj.upload_A);
			}	
			
			com.execute(sbm_saveSlip, {
				successCallback : function(e) { // 성공 콜백
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){						
						// 2023.03.08. 저장없이 결재신청 클릭하는 경우가 있어서 증빙 저장 후 결재화면으로 넘어가도록 수정
						scwin.evidParam.req_no = dma_search.get("unslip_no");
						scwin.evidParam.unslip_odr = dma_search.get("unslip_odr");
						// 자동증빙 저장
						wfm_evid.getWindow(0).scwin.updateEvid(scwin.evidParam);
						
						if(scwin.data.aprYn == "Y"){
							com.movePageMenu("A001", { "reqNo" : dma_slipH.get("unslip_no")});
						}else{			
							// 회의록 parameter 초기화
							scwin.data.meetFlag = false;
							scwin.meet ={};	
									
							// 카드정보 재조회
							scwin.getCardInfo();
							
							// 조회
							scwin.search();
						}
					});
				}
			});
		});
	};

	/**
	 * 비용코드 검색팝업
	 */
	scwin.btn_expns_onclick = function(e) {
		if (ibx_accnt_no.getValue() == "") {
			com.alert(com.getMsg("message.xom.co.com.0001", "계정번호"));
			return;
		}

		var data = {
			accnt_no : ibx_accnt_no.getValue(),
			expns_cd : ibx_expns_cd.getValue()
		};

		// TODO TEST
		//data.expns_cd = "271";
		com.pop.open(com.pop.TYPE.EXPNS, data, async function(retObj) {
			if (retObj) {
				// 비용코드 체크(소액물품, 이지바로과제, 증빙여부 )
				const isExcept = await scwin.check(retObj, 1);
				if (!isExcept){
					ibx_expns_cd.setValue("");
					return;
				}

				dma_slipD.set("expns_cd", retObj.expns_cd);
				dma_slipD.set("expns_cd_nm", retObj.expns_cd_nm);
				dma_slipD.set("accnt_cd", retObj.accnt_cd);
				dma_slipD.set("accnt_cd_nm", retObj.accnt_cd_abbr);

				// TODO 전자증빙
				scwin.evidParam.expns_cd = retObj.expns_cd;
				wfm_evid.getWindow(0).scwin.evid_select(scwin.evidParam);

				// 관리항목 셋팅
				scwin.setMngmt(retObj.accnt_cd);
			}
		});
	};

	/**
	 * 관리항목 grd_mngmt_ontextimageclick event
	 */
	scwin.grd_mngmt_ontextimageclick = function(row, col) {
		if (grd_mngmt.getColumnID(col) == "mngmt_detls_cd") {
			var mngmtItemCd = dlt_mngmt.getCellData(row, "mngmt_item_cd");
			var data = {
				mngmt_detls_cd : dlt_mngmt.getCellData(row, "mngmt_detls_cd")
			};
			
			if(mngmtItemCd == "2050"){
				data.expns_cd = dma_slipD.get("expns_cd");
			}			
			
			biz.fin.setMngmtDetls(mngmtItemCd, data, function(cd, nm){
				if(/1001|1300/.test(mngmtItemCd)){
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", cd.substring(2,8));
				}else{
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", cd);
				}
				dlt_mngmt.setCellData(row, "mngmt_detls_nm", nm);	
			});
		}
	};

	/**
	 * 총액 수정 이벤트
	 */
	scwin.inputTotalAmt_onviewchange = function(info) {
		if (inputTotalAmt.getValue() == 0) {
			inputUnslipAmt.setValue(0);
			inputTaxAmt.setValue(0);
			return;
		}
		scwin.setUnslipAmt(dma_slipD.get("tax_cd"));

		// 예산잔액 조회
		scwin.getBugtRamtAmt();
	};

	/**
	 * 비고 변경 이벤트
	 */
	scwin.ibx_rmk_1_onchange = function(info) {
		if (dma_slipH.get("rmk") == "") {
			dma_slipH.set("rmk", this.getValue());
		}
	};	
	
	/**
	 * 목록 버튼 클릭 이벤트
	 */
	scwin.btn_pre_onclick = function(e) {
		//scwin.checkList = null;
		com.moveList("F220");	
	};

	/**
	 * 그리드 디테일 클릭 이벤트
	 */	
	scwin.grd_slipd_oncellclick = function(row,col,colId) {
		scwin.setSlipD(row);
	};
	
	/**
	 * 삭제버튼 클릭 이벤트
	 */	
	scwin.btn_del_onclick = function(e) {
		if(dma_slipD.get("unslip_no") == ""){
			alert("삭제할 행을 선택하세요");
			return;				
		}
		
		if(dlt_slipD.getRowCount() == 1){
			dma_slipD.set("part_all_clsf", "F"); // 전체삭제
		}else{
			dma_slipD.set("part_all_clsf", "");
		}
		
		com.confirm("message.xom.wq.022"/*삭제하시겠습니까?*/, function(ret){
			if(ret){
				dma_slipD.set("cud_type", "D");
				com.file.deleteAll( function(){
					com.execute(sbm_deleteSlip, {
						successCallback : function(e) {
							if(dlt_slipD.getRowCount() == 1){	
								//scwin.checkList = null;								
								if(com.getParameter("param4") == "apr"){
									com.movePageMenu("A010");
								}else{
									com.moveList("F220",{});
								}
							}else{
								scwin.search();	
							}
						}
					});
				});
			} else {
				dma_slipD.set("cud_type", "U");
			}
		});
	};
	
	/**
	 * 계정구분 변경이벤트
	 */
	scwin.rad_accnt_clsf_onviewchange = function(info) {
		if(dma_slipD.get("cud_type") == "C"){
			if(this.getValue() == "4"){ // 입금일 경우
				ibx_accnt_no.setDisabled(true);				
				ibx_expns_cd.setDisabled(true);	
				btn_expns.setDisabled(true);
				
				ibx_rmk_1.hide();
				sbx_rmk_1.show();	
						
			}else{
				ibx_accnt_no.setDisabled(false);				
				ibx_expns_cd.setDisabled(false);
				btn_expns.setDisabled(false);
				
				ibx_rmk_1.show("");
				sbx_rmk_1.hide();					
			}
			
			if(dma_slipD.get("accnt_no") != ""){
				dma_slipD.set("accnt_no", "");
				dma_slipD.set("accnt_no_nm", "");
				dma_slipD.set("expns_cd", "");
				dma_slipD.set("expns_cd_nm", "");
				dma_slipD.set("accnt_cd", "");
				dma_slipD.set("accnt_cd_nm", "");
			}
			
			// 첨부파일
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});
			btn_confrHis.hide();
		}
	};
	
	/**
	 * 작성자 검색 팝업
	 */
	scwin.btn_emp_onclick = function(e) {
		var data = { empno : inputEmpNo.getValue(), work_clsf : "HAG010"};
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			dma_slipH.set("empno", ret.empno);
			dma_slipH.set("nm", ret.nm);
			dma_slipH.set("wrte_psn", ret.syspayno);
			dma_slipH.set("wrte_dept", ret.dept_cd);
			dma_slipH.set("dept_nm", ret.dept_nm);
			dma_slipH.set("wrte_dept_new_ymd", ret.dept_new_ymd);
		});
	};	

	// -------------------------- check --------------------------------------------------------------------------------------------------check
	/**
	 * 카드결의 체크
	 */
	scwin.check = async function(paramObj, idx) {
		var retVal = true;
		switch (idx) {
			case 0 : // 계정번호 검색 후 체크
				retVal = scwin.checkPostAccntNo(paramObj);
				break;
			case 1 : //비용코드 검색 후 체크
				retVal = await scwin.checkPostExpnsCd(paramObj);
				break;
		}

		return retVal;
	};

	/**
	 * 계정번호 검색 후 체크
	 */
	scwin.checkPostAccntNo = function(paramObj) {
		// 계정종료일자 체크
		if (paramObj.accnt_no.substring(0,2) != "FF") {
			if(dma_slipH.get("slip_ymd") > paramObj.cls_ymd){
				com.alert("message.alert.fin.com.0007");
				return false;
			}
			
			if(dma_slipH.get("slip_ymd") < paramObj.start_ymd){
				com.alert("message.alert.fin.com.0009");
				return false;
			}
			
			if(!/RAK041|RAK061/.test(paramObj.accnt_state)){ // RAK041 집행가능, RAK061 미입금집행승인
				com.alert(com.getMsg("message.alert.fin.com.0008", paramObj.accnt_no, "결의생성"));
				return false;
			}
		}

		if (/IB1701|IG1701/.test(paramObj.itm_solve_base) || paramObj.card_use_ex == "FAJ006") {
			if (dma_card.get("card_knd") != "FAJ006" && dma_card.get("card_clsf") != "FAI003") {
				com.alert("message.xom.ui.fin.003"); /* 국고보조금 사업은 신한연구비카드만 작성 가능합니다.\n- 사업평가관리실-*/
				return false;
			}
		}

		if (paramObj.accnt_no.substring(0, 4) == "FF21") {
			com.alert("message.xom.ui.fin.004"); /*연구시설장비통합관리비는 카드결의에서 사용할 수 없습니다. \n 자세한 문의는 구매자산실로 해주시기 바랍니다.*/
			return false;
		}

		return true;
	};

	/**
	 * 비용코드 검색 후 체크
	 */
	scwin.checkPostExpnsCd = async function(paramObj) {
		// 2023.06.02 경비결의 시 BG계정이면서 142 비용코드 사용할 경우 자산검수 필수 작성 제외(XC22023014CD)
		const excpetAwaitChk = await com.isExceptAwait("XEK060", "F202", ibx_accnt_no.getValue().substring(0,2));
		if(!excpetAwaitChk) {
			if (biz.fin.CONST.EXPNS_CHK_SML.indexOf(paramObj.expns_cd) >= 0) {
				com.alert("message.xom.ui.fin.005"); //[2019년 2월 25일 부터 소액물품 검사검수 메뉴를 이용해서 결의 진행하셔야 합니다. \n재무관리>결의서>소액물품검사검수> 자세한 문의는 구매자산실로 해주시기 바랍니다.]
				return false;
			}
		}

		if (scwin.data.evid_chk == "Y" && biz.fin.CONST.EXPNS_CHK_SML_EVID.indexOf(paramObj.expns_cd) >= 0) {
			com.alert("message.xom.ui.fin.006"); //소액물품검수관리를 통한 결의서 작성 바랍니다. \n재무관리>결의서>소액물품검수관리
			return false;
		}

		// 2019.01.09 이지바로 계정인 경우 해당 비용코드는 카드경비 처리 불가
		if (scwin.data.exclsv_agncy == "RHB040" && biz.fin.CONST.EXPNS_CHK_EZBR.indexOf(paramObj.expns_cd) >= 0) {
			com.alert("message.xom.ui.fin.007"); //이지바로 과제는 소액물품검사검수를 이용하여 소액물품 결의로 진행해주시기 바랍니다.
			return false;
		}

		if (dma_slipD.get("mngmt_clsf") == "R") { // 연구계정
			if (/351|352|359/.test(paramObj.expns_cd)) { // //국내교육훈련비, 국외교육훈련비, 기타교육훈련비
				com.alert("message.xom.ui.fin.008"); //연구과제 관련 교육훈련비는 처리 가능하나, 자기개발교육(개인역량개발)은 BH계정(총무보안실에 문의)으로 진행하여 주시기 바랍니다.
			}
		}

		return true;
	};

	scwin.checkPreSave = function() {
		// 증빙 날짜 체크
		if (!scwin.slip_date_check())
			return false;
		
		if(dlt_sendReq.getRowCount() == 0){
			alert("송금내역이 생성되지 않았습니다. 다시 한번 저장버튼을 눌러주세요.");
			return false;	
		}
		// 2019.02.25 이지바로과제로 비용코드 271, 272 사용시 필수여부에 상관없이 신청번호 체크
		var clsf = ""
		if (scwin.data.exclsv_agncy == "RHB040" && dma_slipD.get("accnt_no_clsf") == "FAJ003" && /271|272/.test(dma_slipD.get("expns_cd"))) {
			clsf = "ezbr";
		}
		// 통합이지바로 회의록 필수 체크
		if (dma_slipD.get("accnt_no_clsf") == "FAJ007" && /410|411/.test(dma_slipD.get("expns_cd"))) {
			clsf = "cmb_ezbr";
		}
		if (!wfm_evid.getWindow().scwin.evid_preSave(clsf))
			return false;

		// 2018.05.31 결의계정과 회의록계정 일치 여부 체크
		if(dma_slipD.get("expns_cd") == "410"){
			var evidData = wfm_evid.getWindow(0).dlt_attach.getMatchedJSON("evid_item_cd", "F014", true);	
					
			if(evidData != undefined && evidData[0].key_val != "" && scwin.data.meet_accnt_no != ""){
				if(dma_slipD.get("accnt_no") != scwin.data.meet_accnt_no){
					com.alert(com.getMsg("message.xom.ui.fin.014", scwin.data.meet_accnt_no, dma_slipD.get("accnt_no")));
					return false;
				}
			}
		}

		// 2014.12.16 부가세로직 추가에 따른 검증추가
		if (dma_slipD.get("total_amt") != Number(dma_slipD.get("unslip_amt")) + Number(dma_slipD.get("tax_amt"))) {
			com.alert(com.getMsg("message.xom.ui.fin.015", "결의금액")); // 결의금액과 세액의 합이 총액과 일치하지 않습니다.
			return false;
		}

		if (dma_slipD.get("tax_cd") == "FTX001") {
			if (dma_card.get("tax_amt") > 0 && dma_slipD.get("tax_amt") == 0) {
				com.alert("message.xom.ui.fin.016"); // 과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
				return false;
			}

			if (dma_card.get("tax_amt") == 0 && dma_slipD.get("tax_amt") > 0) {
				com.alert("message.xom.ui.fin.029"); // 해당증빙은 세액이 0입니다. 총액을 다시 입력하여 세액을 확인하세요.
				return false;
			}
		} else {
			if (dma_slipD.get("tax_amt") > 0) {
				com.alert("message.xom.ui.fin.017"); // 비과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
				return false;
			}
		}

		
		// 과세/비과세 혼용, RCMS 체크		
		var totalAmtSum = 0;
		var unslipAmtSum = 0;
		var taxAmtSum = 0;
		var taxfreeCnt = 0;
		scwin.data.taxYn =[];
		
		for (var i = 0; i < dlt_slipD.getRowCount(); i++) {
			if(dma_slipD.get("accnt_no").substring(0,2) != "FF" && dlt_slipD.getCellData(i, "accnt_no").substring(0,2) != "FF"){
				if (dma_slipD.get("card_no") == dlt_slipD.getCellData(i, "card_no") 
						&& dma_slipD.get("apprvl_no") == dlt_slipD.getCellData(i, "apprvl_no")) {
					if (dlt_slipD.getCellData(i, "tax_cd") != dma_slipD.get("tax_cd")) {
						com.alert("message.xom.ui.fin.018"); // 하나의 카드승인 건을 과세계정과 비과세계정으로 혼합하여 저장할 수 없습니다.
						return false;
					}
					
					if (/FAJ004|FAJ005/.test(dma_slipD.get("accnt_no_clsf")) && dlt_slipD.getCellData(i, "accnt_no") != dma_slipD.get("accnt_no")) {
						com.alert("message.xom.ui.fin.019"); // RCMS/POINT과제인 경우 1개의 증빙에 대하여 계정번호를 변경하여 결의할 수 없습니다.
						return false;
					}
					
					// 금액 체크
					totalAmtSum = totalAmtSum + Number(dlt_slipD.getCellData(i, "total_amt"));
					unslipAmtSum = totalAmtSum + Number(dlt_slipD.getCellData(i, "unslip_amt"));
					taxAmtSum = totalAmtSum + Number(dlt_slipD.getCellData(i, "tax_amt"));
					if(dlt_slipD.getCellData(i, "tax_cd") == "FTX002") taxfreeCnt++;
				}
			}
			
			//2021.01.13 저장전 과세계정인 경우 부가세 입력 필수 알림메시지 상신자가 확인하면 그대로 진행 
			if(dlt_slipD.getCellData(i, "tax_cd") == "FTX001" && dlt_slipD.getCellData(i, "tax_amt") == 0){
				scwin.data.taxYn.push(i+1);
			}
		}		

		// 금액 재 조정
		if (dma_card.get("use_amt") == totalAmtSum + Number(dma_slipD.get("total_amt"))) {
			if(dma_card.get("supply_amt") != unslipAmtSum + Number(dma_slipD.get("unslip_amt")) || dma_card.get("tax_amt") != taxAmtSum + Number(dma_slipD.get("tax_amt"))){
				if(dma_slipD.get("tax_cd") == "FTX001" && taxfreeCnt == 0){
					dma_slipD.set("tax_amt", Number(dma_card.get("tax_amt")) - taxAmtSum);
					dma_slipD.set("unslip_amt", Number(dma_slipD.get("total_amt")) - Number(dma_slipD.get("tax_amt")));
				}
			}
		}

		if(dma_card.get("un_amt") < (Number(dma_slipD.get("total_amt")) - Number(dma_slipD.get("bf_total_amt")))){
			com.alert("message.xom.ui.fin.021"); // 총액은 미처리 금액을 초과할 수 없습니다.
			return false;
		}
		
		// 관리항목 체크
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			if(dlt_mngmt.getCellData(i,"essen_ex") == "Y"){
				if(dlt_mngmt.getCellData(i,"mngmt_detls_cd") == "" && dlt_mngmt.getCellData(i,"mngmt_detls_nm") == ""){
					com.alert(com.getMsg("message.xom.co.com.0001", (i+1)+"행의 관리항목"));
					return false;
				}
			}
		}	

		return true;
	};

	/**
	 * 증빙 날짜 체크
	 */
	scwin.slip_date_check = function() {
		var slipYmd = dma_slipH.get("slip_ymd");

		if (rad_accnt_clsf.getValue() == "4") {// 입금일 때
			// TODO 입금일자(발생일자)와 결의일자 비교체크 20150616
			if (slipYmd < scwin.data.accnt_ymd) {
				com.alert(com.getMsg("message.xom.ui.fin.010", "입금일자", "결의일자")); //입금일자는 결의일자이전이어야 합니다.
				return false;
			}
		} else {
			var useYmd = dma_slipD.get("use_ymd").replace(/\-/g, "");
			if (useYmd == "") {
				com.alert("message.xom.ui.fin.008"); //카드승인일자가 없습니다.
				return false;
			}

			if (useYmd.substring(0, 8) > dma_slipH.get("slip_ymd")) {
				com.alert(com.getMsg("message.xom.ui.fin.010", "카드승인일자", " 결의일자")); //카드승인일자는 결의일자이전이어야 합니다.
				return false;
			}

			// 재정운영실 김지혜 사무원 요청 (2020.04.17)
			var slipYm = slipYmd.substring(0, 6);
			if (useYmd.substring(0, 6) != slipYm) {
				com.alert(com.getMsg("message.xom.ui.fin.011", useYmd.substring(0, 6), slipYm)); //카드승인 월 [{0}]과 결의일자 월 [{1}]이 상이합니다.\n일반결의를 이용하여 진행 부탁드립니다.
				return false;
			}

			// 카드 사용월이 다른 경우 같이 결의서 작성할 수 없도록 조치
			if(dlt_slipD.getRowCount() > 0) {
				for (var i = 0; i < dlt_slipD.getRowCount(); i++) {
					var useYmdMain = dlt_slipD.getCellData(i, "use_ymd").replace(/\-/g, "").substring(0, 6);	// 현재 저장할 카드승인일자
					var useYmdSub = useYmd.substring(0, 6);	// 이미 저장된 카드승인일자
					
					if (useYmdMain != useYmdSub) {
						com.alert(com.getMsg("message.xom.ui.fin.067", useYmdMain, useYmdSub)); // 먼저 저장된 카드승인 월[{0}]과 현재 입력된 카드승인 월[{1}]이 상이합니다.\n 카드승인 월은 모두 동일해야합니다.
						return false;
					}
				}
			}
		}

		return true;
	};	
	
	/**
	 * 학술대회이력 클릭
	 */
	scwin.btn_confrHis_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		
		// 학술대회이력
		var data = {
			req_no : ibx_unslip_no.getValue(),
			ezbr_yn : "N",
			ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.CONFPOOL, data, function(ret) {			
		});
	};
	
	
	scwin.sbx_rmk_1_onviewchange = function(info) {
		if(sbx_rmk_1.getValue() == '4'){
			ibx_rmk_1.show("");
			sbx_rmk_1.hide();
		}else{
			ibx_rmk_1.hide();
			sbx_rmk_1.show();
			dma_slipD.set("rmk_1", sbx_rmk_1.getText());
		}
	};

	/**
	 * 과제정보 버튼 클릭 이벤트
	 */
	scwin.btn_prjInfo_onclick = function(e) {
		if(dma_slipD.get("mngmt_clsf") != "R"){
			com.alert("message.xom.ui.fin.034");
			return;
		}
		
		var data = {accnt_no : dma_slipD.get("accnt_no")
		            , ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.PRJNO, data, function(ret){			
		});
	};
	
	/**
	 * 비용코드 변경 이벤트
	 */	
	scwin.ibx_expns_cd_onviewchange = function(info) {
		dma_slipD.set("expns_cd_nm", "");
		dma_slipD.set("accnt_cd", "");
		dma_slipD.set("accnt_cd_nm", "");
	};
	
	/**
	 * 증빙정보 버튼 클릭 이벤트
	 */
	scwin.btn_evidInfo_onclick = function(e) {
		var data = {
			unslip_no : dma_slipD.get("unslip_no"),
			unslip_odr : dma_slipD.get("unslip_odr"),
			expns_cd : dma_slipD.get("expns_cd"),
			service_id : dma_slipD.get("service_id")
		};
		
		scwin.openEvidPop(data);
	};
	
	/**
	 * 이지바로 증빙 팝업 호출
	 */
	scwin.openEvidPop = function(data){
		switch(data.service_id){
			case "F236" : // 교육(학회/세미나)증빙정보	
				type = biz.fin.pop.TYPE.EDU;
				break;
			case "F237" : // 회의증빙정보
				type = biz.fin.pop.TYPE.MEET_EVID;
				break;
			case "F238" : // 특근자정보
				type = biz.fin.pop.TYPE.OVERTIME;
				break;
			case "F239" : // 전문가활용정보
				type = biz.fin.pop.TYPE.PRO_PRUSE;
				break;
		}
		
		biz.fin.pop.open(type, data, function(retObj) {
		});
	};
	
	/**
	 * 결재신청
	 */
	scwin.menuApproval = function(){
		if(Number(dma_cardsum.get("tot_evid_amt")) != Number(dma_cardsum.get("tot_expns_amt")) + Number(dma_cardsum.get("tot_depst_amt"))){
			com.alert("message.xom.ui.fin.059");
			return;
		}
		
		if (!scwin.validateData()) return;
		if (!scwin.checkPreSave()) return;

		if(scwin.data.taxYn.length > 0){
			com.confirm(com.getMsg("message.xom.ui.fin.020", (scwin.data.taxYn.join(","))), function(ret){ // {0}번째 행은 과세계정이므로 부가세 입력이 필수 입니다. 부가세가 0원이 맞습니까?
				if(ret){
					scwin.callApproval();
				}
			});
		}else{
			scwin.callApproval();
		}
		
	};
	
	scwin.callApproval = function(){
		dma_slipH.set("approval", "true");
		scwin.data.aprYn = "Y";
		
		// 저장 후 결재신청(java에서 분리)		
		scwin.save();
	};
	
	/**
	 * 이지바로 증빙 체크
	 */
	scwin.checkEvidApproval = function(){
		dma_search.set("inqr_clsf", "evid_check");
		
		com.execute(sbm_selectPreAprCheck, {
			successCallback : function(e){
				var evidMsg = "";
				var evidCheck = true;
				var data = {};
				for(var i=0; i<dlt_check.getRowCount(); i++){
					if(dlt_check.getCellData(i, "chk_yn") == "N"){
						evidMsg += "["+ dlt_check.getCellData(i, "accnt_no") +
									"] ["+ dlt_check.getCellData(i, "expns_cd") +"(" + dlt_check.getCellData(i, "expns_cd_nm") + ")] \n";
						
						if(evidCheck){
							data.unslip_no = dlt_check.getCellData(i, "unslip_no");
							data.unslip_odr = dlt_check.getCellData(i, "unslip_odr");
							data.expns_cd = dlt_check.getCellData(i, "expns_cd");
							data.service_id = dlt_check.getCellData(i, "service_id");
						}
						evidCheck = false;
					}
				}
				
				if(evidCheck){
					// scwin.checkTotalAmt(); // AS IS에서 카드결의에서 호출하는 부분이 없음(2022.07.28.)
					scwin.menuApproval();			
				}else{
					com.alert(com.getMsg("message.xom.ui.fin.052", evidMsg)); //  ~은 증빙내역을 입력해야 합니다.
					scwin.openEvidPop(data);
				}
			}
		});
	}
	
	/**
	 * 금액 증빙 체크
	 */
	scwin.checkTotalAmt = function(){
		dma_search.set("inqr_clsf", "amt_check");
		
		com.execute(sbm_selectPreAprCheck, {
			successCallback : function(e){
				var evidMsg = "";
				var evidCheck = true;
				var data = {};
				for(var i=0; i<dlt_check.getRowCount(); i++){
					if(dlt_check.getCellData(i, "chk_cnt") == 0){
						scwin.menuApproval();
					}else{
						com.alert(com.getMsg("message.xom.ui.fin.053", dlt_check.getCellData(i, "rtn_msg")));
					}
				}
			}
		});
	};
	
	/**
	 * 결재신청전 체크
	 */
	scwin.checkPreApprv = function(){		
		var evidYnCheck = false;

		for (var i = 0; i < dlt_slipD.getRowCount(); i++) {			
			if (dlt_slipD.getCellData(i, "evid_yn") == "Y") {
				evidYnCheck = true;
				break;
			}
		}
		if(evidYnCheck == true){
			scwin.checkEvidApproval();
		}else{
			// scwin.checkTotalAmt(); // AS IS에서 카드결의에서 호출하는 부분이 없음(2022.07.28.)
			scwin.menuApproval();
		}
	};
	
	/**
	 * 결재신청 버튼 클릭 이벤트
	 */
	scwin.btn_apr_onclick = function(e) {
		// 결재신청전 체크
		scwin.checkPreApprv();
	};	
	
	/**
	 * 예실 버튼 클릭 이벤트
	 */
	scwin.btn_bugt_onclick = function(e) {
		var accntNo = dma_slipD.get("accnt_no");
		var startYr = dma_slipD.get("start_ymd").substring(0,4);
		var clsYr = dma_slipD.get("cls_ymd").substring(0,4);
		// TODO 레포트 출력
		if(!/PD|PL|PQ/.test(accntNo.substring(0,2))){
			var node = "accnt_no=" + accntNo + "&itm_solve_base=" + dma_slipD.get("itm_solve_base") + "&res_type=0";
			//OZFlashOpen("/fin/fin/leg/FinAccntInfo01Sel.ozr", "FinAccntInfo01Sel", "Y", node);
			com.oz.openPopup({
				ozrCode: "F006",
				param: node    
	        });
		}else{
			var node = "accnt_fr_ymd=" + startYr + "&accnt_to_ymd=" + clsYr + "&accnt_no=" + accntNo;
			//OZFlashOpen("/fin/bud/frc/BudTrustDetlsSel.ozr", "BudTrustDetlsSel", "Y", node);
			com.oz.openPopup({
				ozrCode: "F007",    
				param: node
	        });
		}		
	};
	
	/**
	 * 미리보기 버튼 클릭 이벤트
	 */
	scwin.btn_evid_view_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		com.biz.openEvidWindow(ibx_unslip_no.getValue());
	};
	
	/**
	 * 인쇄 버튼 클릭 이벤트
	 */
	scwin.btn_print_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		
		var node = "unslip_no=" + ibx_unslip_no.getValue();
		//OZFlashOpen("/fin/fin/spm/FinSlipRegst.ozr", "FinSlipRegst", "Y", node);
		com.oz.openPopup({
			ozrCode : "F001",      
			param: node
        });
	};

	/**
	 * 카드번호 버튼 클릭 이벤트
	 */
	scwin.btn_card_onclick = function(e) {
		biz.fin.pop.open(biz.fin.pop.TYPE.CARD, {}, function(retObj) {
			inputCardNoSrc.setValue("****-****-" + retObj.card_no.substring(10,19));			
			btnCardSrc.trigger("click");
		});
	};
	
	/**
	 * 계정번호 keyup 이벤트
	 */
	scwin.ibx_accnt_no_onkeyup = function(e) {
		ibx_accnt_no.setValue(this.getValue().toUpperCase());
	};

	/**
	 * 국세청바로가기 버튼 클릭 이벤트
	 */
	scwin.btn_homeTax_onclick = function(e) {
		window.open('https://teht.hometax.go.kr/websquare/websquare.html?w2xPath=/ui/ab/a/a/UTEABAAA13.xml', '_blank',
					'height=620px, width=1080px, top=100px, left=100px, menubar=yes, resizable=yes, scrollbars=yes, toolbar=yes, status=yes');
	};
	
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="" class="pageWrap">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn" id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    				<w2:span class="note red ml10" id="" label="[수정안내] 과세 &gt; 비과세 혹은 비과세 &gt; 과세로 수정 시, 삭제 후 입력하세요." style=""></w2:span>
    			</xf:group>
    			<xf:group class="btnbox ri" id="" style="">
    				<xf:trigger class="btn" id="btn_evid_view" style="" type="button" ev:onclick="scwin.btn_evid_view_onclick">
    					<xf:label><![CDATA[미리보기]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" ev:onclick="scwin.btn_print_onclick">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick" disabled="true">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="grp_slipH" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="과제정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id="ica_slip_ymd"
    						placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="결의일자" ref="data:dma_slipH.slip_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_unslip_no" style="" title="결의번호" ref="data:dma_slipH.unslip_no" readOnly="true"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="">
    						<xf:group class="inpSch" id="grp_wrte_psn" style="width: 120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="inputEmpNo" style="" title="작성자"
    								ref="data:dma_slipH.empno">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_emp" style="" type="button" title="작성자 조회" ev:onclick="scwin.btn_emp_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="작성자 상세"
    							ref="data:dma_slipH.nm" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="작성부서" ref="data:dma_slipH.dept_nm" readOnly="true"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="적요" ref="data:dma_slipH.rmk"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정유무" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="확정유무" ref="data:dma_slipH.decsn_ex_nm" readOnly="true"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="확정결의번호" ref="data:dma_slipH.slip_no" readOnly="true"></xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="카드번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" id="grp_card">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp" id="inputCardNoSrc" style="" title="카드번호"
    						ref="data:dma_search.card_no_tmp">
    					</xf:input>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-선택-" class="sel"
    						direction="auto" disabled="false" disabledClass="w2selectbox_disabled" ev:onviewchange="scwin.sbx_cardList_onviewchange"
    						id="sbx_cardList" ref="" style="width: 200px" submenuSize="auto">
    						<xf:choices>
    							<xf:itemset nodeset="data:dlt_code">
    								<xf:label ref="code_nm"></xf:label>
    								<xf:value ref="code"></xf:value>
    							</xf:itemset>
    						</xf:choices>
    					</xf:select1>
    					<xf:trigger class="btn" id="btn_card" style="" type="button" ev:onclick="scwin.btn_card_onclick">
    						<xf:label><![CDATA[카드번호검색]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn" id="btnCardSrc" style="" type="button" ev:onclick="scwin.btnCardSrc_onclick">
    						<xf:label><![CDATA[조회]]></xf:label>
    					</xf:trigger>
    					<w2:span class="helptxt red" id="" label="※ 뒤 (XXXX-XXXX)을 입력하고 &lt;엔터키&gt;를 치세요" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="lybox mt16" id="" style="">
    			<xf:group class="ly_column col_4" id="">
    				<xf:group class="le" id="" style="">
    					<xf:group class="result" id="">
    						<w2:span id="" label="총" style=""></w2:span>
    						<w2:span class="numtotal red" id="spa_cardCnt" label="0" style=""></w2:span>
    						<w2:span id="" label="건" style=""></w2:span>
    					</xf:group>
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_cardList" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_card" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5"
    					ev:onrowindexchange="scwin.grd_card_onrowindexchange" dataDragSelect="false">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="사용일자" width="120"></w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="가맹점" width="70"></w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="승인번호"
    								width="60">
    							</w2:column>
    							<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="사용금액"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="공급가액"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="세액" width="50"></w2:column>
    							<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="미처리금액"
    								width="70">
    							</w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="use_ymd" inputType="calendar" readOnly="true"
    								style="height:28px;" width="120" calendarValueType="yearMonthDateTimeSec">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="joinsto_nm" inputType="text" readOnly="true"
    								style="height:28px;" width="70" textAlign="left">
    							</w2:column>
    							<w2:column displayMode="label" id="apprvl_no" inputType="text" readOnly="true" style="height:28px;"
    								width="60">
    							</w2:column>
    							<w2:column displayMode="label" id="use_amt" inputType="text" readOnly="true" style="height:28px;" width="70"
    								dataType="number" displayFormat="#,###" textAlign="right">
    							</w2:column>
    							<w2:column displayMode="label" id="supply_amt" inputType="text" readOnly="true" style="height:28px;"
    								width="70" dataType="number" displayFormat="#,###" textAlign="right">
    							</w2:column>
    							<w2:column displayMode="label" id="tax_amt" inputType="text" readOnly="true" style="height:28px;" width="50"
    								dataType="number" displayFormat="#,###" textAlign="right">
    							</w2:column>
    							<w2:column displayMode="label" id="un_amt" inputType="text" readOnly="true" style="height:28px" value=""
    								width="70" dataType="number" displayFormat="#,###" textAlign="right">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="승인내역" style="" tagname="h3"></w2:textbox>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="카드번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="inputCardNo" style="" title="카드번호" readOnly="true"
    								ref="data:dma_card.card_no_tmp">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="승인일자" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:input adjustMaxLength="false" class="inp full" id="ibx_use_ymd" readOnly="true"
    								ref="data:dma_card.use_ymd" style="" title="승인일자" displayFormatter="scwin.formatDate">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="승인번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" ref="data:dma_card.apprvl_no" style="" title="승인번호"
    								readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="가맹점" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="inputJoinstoNm" ref="data:dma_card.joinsto_nm"
    								style="" title="가맹점" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    								<w2:colspan>1</w2:colspan>
    								<w2:rowspan>2</w2:rowspan>
    							</w2:attributes>
    							<w2:textbox id="" label="가맹점 주소" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" ref="data:dma_card.shop_addr1" style=""
    								title="가맹점 주소" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" ref="data:dma_card.shop_addr2" style=""
    								title="가맹점 주소 상세" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="승인금액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" dataType="number" displayFormat="#,###" id=""
    								ref="data:dma_card.use_amt" style="text-align:right;" title="승인금액" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="미처리금액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" dataType="number" displayFormat="#,###" id=""
    								ref="data:dma_card.un_amt" style="" title="미처리금액" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="비용 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="비용 합계"
    								ref="data:dma_cardsum.tot_expns_amt" dataType="number" displayFormat="#,###" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="입금 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="입금 합계"
    								ref="data:dma_cardsum.tot_depst_amt" dataType="number" displayFormat="#,###" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="카드 승인 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="카드 승인 합계"
    								ref="data:dma_cardsum.tot_evid_amt" dataType="number" displayFormat="#,###" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group id="grp_taxMsg" class="mt20" style="visibilty:hidden;">
    					<xf:trigger style="" id="btn_homeTax" type="button" class="btn" ev:onclick="scwin.btn_homeTax_onclick">
    						<xf:label><![CDATA[사업자등록상태조회(국세청 홈택스 바로가기)]]></xf:label>
    					</xf:trigger>
    					<xf:group class="helparea" id="" style="">
    						<xf:group id="" style="" tagname="ul">
    							<xf:group id="" style="" tagname="li">
    								<w2:textbox class="" id=""
    									label="부가가치세 일반과세자임에도 공급가액과 세액이 분리되어 있지않은 경우 법인카드 담당자에게 세액분리 요청바랍니다.&lt;br/&gt;(단, 사업자등록상태가 간이과세자 또는 부가세 면세사업자일 경우 세액공제불가)"
    									style="" tagname="span" escape="false">
    								</w2:textbox>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group class="ly_column col_6" id="" style="">
    				<xf:group class="le" id="" style="">
    					<xf:group class="result" id="">
    						<w2:span id="" label="총" style=""></w2:span>
    						<w2:span class="numtotal red" id="tbx_cnt" label="0" style=""></w2:span>
    						<w2:span id="" label="건" style=""></w2:span>
    					</xf:group>
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_slipD" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_slipd" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5"
    					ev:oncellclick="scwin.grd_slipd_oncellclick">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="계정번호" width="70"></w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="과세구분" width="70"></w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="비용코드"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="비용코드명"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="통제번호"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="총금액" width="70"></w2:column>
    							<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="결의금액" width="70">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="column36" value="세액" displayMode="label"></w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" id="column34" value="적요" displayMode="label"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="accnt_no" inputType="text" readOnly="true"
    								style="height:28px;" width="70">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="tax_cd" inputType="select" readOnly="true"
    								style="height:28px;" width="70" allOption="" chooseOption="" ref="">
    								<w2:choices>
    									<w2:item>
    										<w2:label><![CDATA[과세]]></w2:label>
    										<w2:value><![CDATA[FTX001]]></w2:value>
    									</w2:item>
    									<w2:item>
    										<w2:label><![CDATA[비과세]]></w2:label>
    										<w2:value><![CDATA[FTX002]]></w2:value>
    									</w2:item>
    								</w2:choices>
    							</w2:column>
    							<w2:column displayMode="label" id="expns_cd" inputType="text" readOnly="true" style="height:28px;"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="expns_cd_nm" inputType="text" readOnly="true" style="height:28px;"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="ctrl_no" inputType="text" readOnly="true" style="height:28px;"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="total_amt" inputType="text" readOnly="true" style="height:28px;"
    								width="70" textAlign="right" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="unslip_amt" inputType="text" readOnly="true" style="height:28px" value=""
    								width="70" textAlign="right" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="tax_amt" value="" displayMode="label"
    								readOnly="true" textAlign="right" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" id="rmk_1" value="" displayMode="label"
    								readOnly="true">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<xf:select1 appearance="full" class="radioGroup" cols="" id="rad_accnt_clsf" ref="" renderType="radiogroup"
    							rows="" selectedIndex="0" style="" ev:onviewchange="scwin.rad_accnt_clsf_onviewchange">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[일반]]></xf:label>
    									<xf:value><![CDATA[1]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[수탁]]></xf:label>
    									<xf:value><![CDATA[3]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[입금]]></xf:label>
    									<xf:value><![CDATA[4]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    					</xf:group>
    					<xf:group class="ri" id="grp_evid" style=";visibility:;">
    						<w2:span class="note red" id="textboxEvidMsg" label="* 증빙정보를 입력하여 주십시오." style=""></w2:span>
    						<xf:group class="btnarea" id="">
    							<xf:trigger class="btn" id="btn_evidInfo" style="" type="button" ev:onclick="scwin.btn_evidInfo_onclick">
    								<xf:label><![CDATA[증빙정보]]></xf:label>
    							</xf:trigger>
    							<xf:trigger class="btn" ev:onclick="scwin.btn_confrHis_onclick" id="btn_confrHis" style="" type="button">
    								<xf:label><![CDATA[학술대회이력]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="계정번호" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:group class="flex" id="">
    								<xf:group class="inpSch" id="grp_accnt_no" style="width: 120px;">
    									<xf:input adjustMaxLength="false" class="inp req" id="ibx_accnt_no" ref="data:dma_slipD.accnt_no"
    										style="text-transform:uppercase;" title="계정번호" ev:onblur="scwin.ibx_accnt_no_onblur" ev:onkeyup="scwin.ibx_accnt_no_onkeyup">
    									</xf:input>
    									<xf:trigger class="btn" id="btn_accntNo" style="" title="계정번호 조회" type="button"
    										ev:onclick="scwin.btn_accntNo_onclick">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    								<xf:input adjustMaxLength="false" class="inp full" id="ibx_accnt_no_nm" ref="data:dma_slipD.accnt_no_nm"
    									style="width: 150px;" title="계정번호 상세" readOnly="true">
    								</xf:input>
    								<xf:trigger class="btn" id="btn_prjInfo" style="" type="button"
    									ev:onclick="scwin.btn_prjInfo_onclick">
    									<xf:label><![CDATA[과제정보]]></xf:label>
    								</xf:trigger>
    								<xf:trigger class="btn" id="btn_bugt" style="" type="button" ev:onclick="scwin.btn_bugt_onclick">
    									<xf:label><![CDATA[예실]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="비용코드" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:group class="flex" id="">
    								<xf:group class="inpSch" id="grp_expns_cd" style="width: 120px;">
    									<xf:input adjustMaxLength="false" class="inp req" id="ibx_expns_cd" ref="data:dma_slipD.expns_cd"
    										style="" title="비용코드" ev:onviewchange="scwin.ibx_expns_cd_onviewchange">
    									</xf:input>
    									<xf:trigger class="btn" id="btn_expns" style="" title="비용코드 조회" type="button"
    										ev:onclick="scwin.btn_expns_onclick">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    								<xf:input adjustMaxLength="false" class="inp full" id="ibx_expns_nm" ref="data:dma_slipD.expns_cd_nm"
    									style="" title="비용코드 상세" readOnly="true">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="회계코드" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:group class="flex" id="">
    								<xf:input adjustMaxLength="false" class="inp" id="inputAccntCd" ref="data:dma_slipD.accnt_cd"
    									style="width: 120px;" title="회계코드 1" readOnly="true">
    								</xf:input>
    								<xf:input adjustMaxLength="false" class="inp full" id="inputAccntCdNm" ref="data:dma_slipD.accnt_cd_nm"
    									style="" title="회계코드 2" readOnly="true">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="총액" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req ri" dataType="number" displayFormat="#,###"
    								id="inputTotalAmt" ref="data:dma_slipD.total_amt" style="text-align:right;" title="총액"
    								ev:onviewchange="scwin.inputTotalAmt_onviewchange">
    							</xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="거래처" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req" id="" ref="data:dma_slipD.rmk_2" style=""
    								title="거래처">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="결의금액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" dataType="number" displayFormat="#,###"
    								id="inputUnslipAmt" ref="data:dma_slipD.unslip_amt" style="text-align:right;" title="결의금액" readOnly="true">
    							</xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="세액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" dataType="number" displayFormat="#,###"
    								id="inputTaxAmt" ref="data:dma_slipD.tax_amt" style="text-align:right;" title="세액" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req" id="ibx_rmk_1" ref="data:dma_slipD.rmk_1" style=""
    								title="적요" ev:onchange="scwin.ibx_rmk_1_onchange">
    							</xf:input>
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-선택-" class="sel ml0"
    								direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_rmk_1" ref="" style="width: 300px; display:none;"
    								submenuSize="auto" ev:onviewchange="scwin.sbx_rmk_1_onviewchange">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[법인카드 오류 사용으로 개인입금]]></xf:label>
    										<xf:value><![CDATA[1]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[항공권 취소수수료 개인입금]]></xf:label>
    										<xf:value><![CDATA[2]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[철도 취소수수료 개인입금]]></xf:label>
    										<xf:value><![CDATA[3]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[기타(직접입력)]]></xf:label>
    										<xf:value><![CDATA[4]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="통제번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" ref="data:dma_slipD.ctrl_no" style="" title="통제번호"
    								readOnly="true">
    							</xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="예산잔액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="inputBugtRamtAmt" style="" title="예산잔액"
    								readOnly="true" dataType="number" displayFormat="#,###">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="첨부파일" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:group style="height:125px;">
    								<xf:group id="upload_A" style="height:100%;" class="full"></xf:group>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<w2:wframe id="wfm_evid" src="/ui/com/pop/COM_F001_00P.xml" style=""></w2:wframe>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="관리내역" style="" tagname="h3"></w2:textbox>
    					</xf:group>
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_mngmt" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_mngmt" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5"
    					ev:ontextimageclick="scwin.grd_mngmt_ontextimageclick">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="관리항목" width="70"></w2:column>
    							<w2:column colSpan="" displayMode="label" id="column21" inputType="text" rowSpan="" style="height:28px;"
    								value="세부적요" width="110">
    							</w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="세부적요명"
    								width="300">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="column22" value="필수여부" displayMode="label"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="mngmt_item_nm" inputType="text" readOnly="true"
    								style="height:28px;" width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="mngmt_detls_cd" inputType="textImage" readOnly="false"
    								style="height:28px" width="110" imageSrc="/cm/images/sample/btn_tbsearch02.png">
    							</w2:column>
    							<w2:column displayMode="label" id="mngmt_detls_nm" inputType="text" readOnly="true" style="height:28px;"
    								width="300" class="le">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="essen_ex" value="" displayMode="label" readOnly="true"></w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:group>
    		</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
