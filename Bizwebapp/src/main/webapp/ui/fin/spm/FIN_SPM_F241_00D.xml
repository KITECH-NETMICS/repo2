<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="회의록 작성" meta_vertical_guides="" meta_horizontal_guides="">
    	<w2:type>DEFAULT</w2:type>
    	<w2:buildDate />
    	<xf:model>
    		<xf:instance>
    			<data xmlns="" />
    		</xf:instance>
    		<w2:dataCollection baseNode="map">
    			<w2:dataMap baseNode="map" id="dma_search" style="">
    				<w2:keyInfo>
    					<w2:key dataType="text" id="meet_req_no" name="신청번호"></w2:key>
    					<w2:key id="inqr_clsf" name="조회구분" dataType="text"></w2:key>
    					<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
    					<w2:key id="syspayno" name="참석자개인번호" dataType="text"></w2:key>
    					<w2:key id="meet_start_time" name="회의시작시간" dataType="text"></w2:key>
    					<w2:key id="meet_cls_time" name="회의종료시간" dataType="text"></w2:key>
    					<w2:key id="meet_start_ymd" name="회의시작일자" dataType="text"></w2:key>
    					<w2:key id="attend_nm" name="참석자이름" dataType="text"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataList baseNode="list" repeatNode="map" id="dlt_evid" saveRemovedData="true">
    				<w2:columnInfo>
    					<w2:column id="chk" name="선택" dataType="text"></w2:column>
    					<w2:column id="meet_req_no" name="회의록번호" dataType="text"></w2:column>
    					<w2:column id="evid_clsf" name="증빙구분" dataType="text"></w2:column>
    					<w2:column id="expns_clsf" name="비용코드" dataType="text"></w2:column>
    					<w2:column id="evid_no" name="증빙번호" dataType="text"></w2:column>
    					<w2:column id="evid_apprno" name="승인번호" dataType="text"></w2:column>
    					<w2:column id="evid_date" name="승인일자" dataType="text"></w2:column>
    					<w2:column id="evid_shop" name="거래처명" dataType="text"></w2:column>
    					<w2:column id="evid_amt" name="금액" dataType="number"></w2:column>
    					<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
    					<w2:column id="unslip_odr" name="결의순번" dataType="text"></w2:column>
    					<w2:column id="apr_state" name="결재상태" dataType="text"></w2:column>
    					<w2:column id="card_knd" name="카드종류" dataType="text"></w2:column>
    					<w2:column id="card_clsf" name="카드구분" dataType="text"></w2:column>
    					<w2:column id="expns_cd" name="비용코드" dataType="text"></w2:column>
    					<w2:column id="expns_cd_nm" name="비용코드명" dataType="text"></w2:column>
    					<w2:column id="accnt_cd" name="회계코드" dataType="text"></w2:column>
    					<w2:column id="cardno" name="카드번호" dataType="text"></w2:column>
    					<w2:column id="card_no" name="카드번호" dataType="text"></w2:column>
    					<w2:column id="issu_seqno" name="계산서번호" dataType="text"></w2:column>
    					<w2:column id="casg_receipts" name="현금영수증" dataType="text"></w2:column>
    					<w2:column id="expns_clsf_nm" name="비용코드명" dataType="text"></w2:column>
    					<w2:column id="chrg_amt" name="공급가액" dataType="text"></w2:column>
    					<w2:column id="tax_amt" name="세액" dataType="text"></w2:column>
    					<w2:column id="evid_cd" name="증빙코드" dataType="text"></w2:column>
    					<w2:column id="syspayno" name="지급(개인번호)" dataType="text"></w2:column>
    					<w2:column id="empno" name="지급(개인번호)" dataType="text"></w2:column>
    					<w2:column id="bankaccnt_no" name="입금계좌번호" dataType="text"></w2:column>
    					<w2:column id="bank" name="은행" dataType="text"></w2:column>
    					<w2:column id="depstr_nm" name="예금주" dataType="text"></w2:column>
    				</w2:columnInfo>
    				<w2:data use="true">
    				</w2:data>
    			</w2:dataList>
    			<w2:dataList baseNode="list" id="dlt_attend" repeatNode="map" saveRemovedData="true" style="">
    				<w2:columnInfo>
    					<w2:column id="chk" name="선택" dataType="text"></w2:column>
    					<w2:column dataType="text" id="meet_req_no" name="회의신청번호"></w2:column>
    					<w2:column dataType="text" id="seq" name="순번"></w2:column>
    					<w2:column dataType="text" id="user_clsf" name="사용자구분"></w2:column>
    					<w2:column dataType="text" id="syspayno" name="시스템개인번호"></w2:column>
    					<w2:column dataType="text" id="nm" name="참석자명"></w2:column>
    					<w2:column dataType="text" id="dept_nm" name="부서명"></w2:column>
    					<w2:column dataType="text" id="posi_nm" name="직급명"></w2:column>
    					<w2:column dataType="text" id="mobile_no" name="휴대폰번호"></w2:column>
    					<w2:column dataType="text" id="rmk" name="비고"></w2:column>
    					<w2:column dataType="text" id="cnt" name="타회의참석횟수"></w2:column>
    					<w2:column dataType="text" id="ctr_req_no" name="출장신청번호"></w2:column>
    					<w2:column id="meet_start_ymd" name="회의시작일자" dataType="text"></w2:column>
    					<w2:column id="meet_cls_ymd" name="회의종료일자" dataType="text"></w2:column>
    					<w2:column id="meet_start_time" name="회의시작시간" dataType="text"></w2:column>
    					<w2:column id="meet_cls_time" name="회의종료시간" dataType="text"></w2:column>
    					<w2:column id="reg_nm" name="작성자성명" dataType="text"></w2:column>
    					<w2:column id="adjst_req_no" name="국내출장신청번호" dataType="text"></w2:column>
    					<w2:column id="meal_cnt" name="식사여부" dataType="text"></w2:column>
    				</w2:columnInfo>
    				<w2:data use="true">
    					<w2:row>
    						<meal_cnt><![CDATA[0]]></meal_cnt>
    					</w2:row>
    				</w2:data>
    			</w2:dataList>
    			<w2:dataMap baseNode="map" id="dma_detl">
    				<w2:keyInfo>
    					<w2:key id="meet_req_no" name="회의신청번호" dataType="text"></w2:key>
    					<w2:key id="meet_seq" name="회의순번" dataType="text"></w2:key>
    					<w2:key id="req_ymd" name="요청일자" dataType="text"></w2:key>
    					<w2:key id="meet_start_ymd" name="회의시작일" dataType="text"></w2:key>
    					<w2:key id="meet_cls_ymd" name="회의종료일" dataType="text"></w2:key>
    					<w2:key id="req_syspayno" name="신청자시스템번호" dataType="text"></w2:key>
    					<w2:key id="req_nm" name="작성자명" dataType="text"></w2:key>
    					<w2:key id="dept_nm" name="부서명" dataType="text"></w2:key>
    					<w2:key id="meet_start_time" name="회의시작시간" dataType="text"></w2:key>
    					<w2:key id="meet_cls_time" name="회의종료시간" dataType="text"></w2:key>
    					<w2:key id="meet_subject" name="회의제목" dataType="text"></w2:key>
    					<w2:key id="meet_place" name="회의장소" dataType="text"></w2:key>
    					<w2:key id="meet_contents" name="회의내용" dataType="text"></w2:key>
    					<w2:key id="rmk" name="비고" dataType="text"></w2:key>
    					<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
    					<w2:key id="accnt_no_nm" name="계정명" dataType="text"></w2:key>
    					<w2:key id="tax_cd" name="과세구분" dataType="text"></w2:key>
    					<w2:key id="accnt_rspns_nm" name="계정책임자명" dataType="text"></w2:key>
    					<w2:key id="attach_file_no" name="첨부파일" dataType="text"></w2:key>
    					<w2:key id="conf_clsf" name="결의구분" dataType="text"></w2:key>
    					<w2:key id="slip_syspayno" name="결의자시스템개인번호" dataType="text"></w2:key>
    					<w2:key id="slip_nm" name="결의자명" dataType="text"></w2:key>
    					<w2:key id="slip_empno" name="결의자개인번호" dataType="text"></w2:key>
    					<w2:key id="start_ymd" name="계정시작일자" dataType="text"></w2:key>
    					<w2:key id="cls_ymd" name="계정종료일자" dataType="text"></w2:key>
    					<w2:key id="itm_solve_base" name="비목해소기준" dataType="text"></w2:key>
    					<w2:key id="syspayno" name="사용자시스템번호" dataType="text"></w2:key>
    					<w2:key id="dept_cd" name="부서코드" dataType="text"></w2:key>
    					<w2:key id="dept_new_ymd" name="부서신설일자" dataType="text"></w2:key>
    					<w2:key id="bsns_cd_inout" name="내외구분" dataType="text"></w2:key>
    					<w2:key id="accnt_clsf" name="계정구분" dataType="text"></w2:key>
    					<w2:key id="mngmt_clsf" name="관리구분" dataType="text"></w2:key>
    					<w2:key id="accnt_rspns" name="계정책임자시스템번호" dataType="text"></w2:key>
    					<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
    					<w2:key id="meal_cnt" name="식대횟수" dataType="text"></w2:key>
    					<w2:key id="refrsh_cnt" name="다과횟수" dataType="text"></w2:key>
    					<w2:key id="progrs_status" name="진행상태" dataType="text"></w2:key>
    					<w2:key id="cud_type" name="cud타입" dataType="text"></w2:key>
    					<w2:key id="validAttachNo" name="첨부파일" dataType="text"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataList baseNode="list" repeatNode="map" id="dlt_meetTrip" saveRemovedData="true">
    				<w2:columnInfo>
    					<w2:column id="trip_cls" name="출장구분" dataType="text"></w2:column>
    					<w2:column id="syspayno" name="사용자시스템번호" dataType="text"></w2:column>
    					<w2:column id="date_cls" name="날짜구분" dataType="text"></w2:column>
    				</w2:columnInfo>
    			</w2:dataList>
    			<w2:dataList baseNode="list" repeatNode="map" id="dlt_workTime" saveRemovedData="true">
    				<w2:columnInfo>
    					<w2:column id="cnt" name="순번" dataType="text"></w2:column>
    					<w2:column id="work_detls" name="근무상세" dataType="text"></w2:column>
    					<w2:column id="holiday_clsf" name="휴일구분" dataType="text"></w2:column>
    					<w2:column id="ctr_req_no" name="출장신청번호" dataType="text"></w2:column>
    					<w2:column id="adjst_req_no" name="국내출장정산번호" dataType="text"></w2:column>
    				</w2:columnInfo>
    			</w2:dataList>
    			<w2:dataList baseNode="list" repeatNode="map" id="dlt_outMeetPrsn" saveRemovedData="true">
    				<w2:columnInfo>
    					<w2:column id="nm" name="참석자명" dataType="text"></w2:column>
    					<w2:column id="dept_nm" name="부서명" dataType="text"></w2:column>
    					<w2:column id="meet_req_no" name="회의번호" dataType="text"></w2:column>
    					<w2:column id="meet_start_ymd" name="회의일자시작일" dataType="text"></w2:column>
    					<w2:column id="meet_cls_ymd" name="회의일자종료일" dataType="text"></w2:column>
    					<w2:column id="meet_start_time" name="회의시작시간" dataType="text"></w2:column>
    					<w2:column id="meet_cls_time" name="회의종료시간" dataType="text"></w2:column>
    					<w2:column id="reg_nm" name="등록자명" dataType="text"></w2:column>
    				</w2:columnInfo>
    			</w2:dataList>
    			<w2:dataMap baseNode="map" id="dma_slipH">
    				<w2:keyInfo>
    					<w2:key id="slip_ymd" name="결의일자" dataType="text"></w2:key>
    					<w2:key id="slip_typ_cd" name="결의유형" dataType="text"></w2:key>
    					<w2:key id="rmk" name="적요" dataType="text"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataList baseNode="list" id="dlt_slip" repeatNode="map" saveRemovedData="true" style="">
    				<w2:columnInfo>
    					<w2:column id="meet_req_no" name="회의록번호" dataType="text"></w2:column>
    					<w2:column dataType="text" id="evid_clsf" name="증빙구분"></w2:column>
    					<w2:column dataType="text" id="expns_clsf" name="비용코드"></w2:column>
    					<w2:column dataType="text" id="evid_apprno" name="승인번호"></w2:column>
    					<w2:column dataType="text" id="evid_date" name="승인일자"></w2:column>
    					<w2:column dataType="text" id="evid_shop" name="거래처명"></w2:column>
    					<w2:column dataType="number" id="evid_amt" name="금액"></w2:column>
    					<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
    					<w2:column dataType="text" id="card_knd" name="카드종류"></w2:column>
    					<w2:column dataType="text" id="card_clsf" name="카드구분"></w2:column>
    					<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
    					<w2:column dataType="text" id="accnt_cd" name="회계코드"></w2:column>
    					<w2:column dataType="text" id="cardno" name="카드번호"></w2:column>
    					<w2:column dataType="text" id="card_no" name="카드번호"></w2:column>
    					<w2:column dataType="text" id="issu_seqno" name="계산서번호"></w2:column>
    					<w2:column dataType="text" id="chrg_amt" name="공급가액"></w2:column>
    					<w2:column dataType="text" id="tax_amt" name="세액"></w2:column>
    					<w2:column dataType="text" id="evid_cd" name="증빙코드"></w2:column>
    					<w2:column dataType="text" id="syspayno" name="지급(개인번호)"></w2:column>
    					<w2:column dataType="text" id="empno" name="지급(개인번호)"></w2:column>
    					<w2:column dataType="text" id="bankaccnt_no" name="입금계좌번호"></w2:column>
    					<w2:column dataType="text" id="bank" name="은행"></w2:column>
    					<w2:column dataType="text" id="depstr_nm" name="예금주"></w2:column>
    				</w2:columnInfo>
    				<w2:data use="true">
    					<w2:row></w2:row>
    				</w2:data>
    			</w2:dataList>
    		</w2:dataCollection>
    		<w2:workflowCollection></w2:workflowCollection>
    		<!-- 회의록 내용 상세 조회 -->
    		<xf:submission id="sbm_selectData" ref="data:json,dma_search"
    			target='data:json,[{"id":"dlt_attend","key":"attendList"},{"id":"dma_detl","key":"detlVo"},{"id":"dlt_evid","key":"evidList"}]'
    			action="SvcFINSPMETCR02.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
    			customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>    		
    		<!--회의록 작성시 참석자 출장 구분 조회-->
    		<xf:submission id="sbm_selectTripList" ref='data:json,dma_search'
    			target='' action="SvcFINSPMETCR03.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!--회의참석자 근태정보 조회-->
    		<xf:submission id="sbm_selectCwsWorkTime" ref='data:json,dma_search'
    			target='' action="SvcFINSPMETCR04.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!--외부인 회의 참석 조회-->
    		<xf:submission id="sbm_selectOutMeetPrsn" ref='data:json,dma_search'
    			target='' action="SvcFINSPMETCR05.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 저장 -->
    		<xf:submission id="sbm_saveMeet"
    			ref='data:json,[{"id":"dma_detl","key":"detlVo"},{"id":"dlt_evid","key":"evidList"},{"id":"dlt_attend","key":"attendList"}]'
    			target='data:json,dma_search' action="SvcFINSPMETCM01.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 삭제 -->
    		<xf:submission id="sbm_deleteMeet" ref='data:json,dma_detl' target=""
    			action="SvcFINSPMETCD01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
    			customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 결의생성 -->
    		<xf:submission id="sbm_saveSlipData"
    			ref='data:json,[{"id":"dma_detl","key":"detlVo"},{"id":"dma_slipH","key":"slipHVo"},{"id":"dlt_slip","key":"evidList"}]'
    			target='data:json,dma_search' action="SvcFINSPMETCM02.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!--회의참석자 과제 참여여부 조회-->
    		<xf:submission id="sbm_selectPrjPartYn" ref='data:json,dma_search'
    			target='' action="SvcFINSPMETCR07.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!--회의참석자 근태 재조회 -->
    		<xf:submission id="sbm_selectAttendWorkTime" ref='data:json,dma_search'
    			target='' action="SvcFINSPMETCR09.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!--반려 -->
    		<xf:submission id="sbm_updateData" ref='data:json,dma_search'
    			target='' action="SvcFINSPMETCR09.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    	</xf:model>
    	<script src="/cm/js/biz/ccs.js" cache="false" />
    	<script src="/cm/js/biz/fin.js" cache="false" />
    	<script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 회의록관리
	 * 변경 이력 : 2022-07-08	윤태영	최초 작성
	 *          2023-10-23. 이영희	수정
	 * serviceId : F241
	 ****************************************************/	
	scwin.data = {
		today : com.getServerDateTime(),
		typeCode : "F241",
		copyChk : false, //회의록 copy (신규작성시에만 버튼 클릭하여 이전 회의록작성 내용 불러오기)
		orgStartYmd : "",
		tripFlag : "N" // 국내출장중인 참석자존재여부
	};
	
	/**
	* 페이지 로드
	*/ 
	scwin.onpageload = function() {
		com.file.init();	
		
		btn_retn.hide(); // 반려	
		
		// enterkey event
		com.setEnterKeyEvent(grp_slip_manager, scwin.btn_slip_charger_onclick);
		com.setEnterKeyEvent(grp_accnt_no, scwin.btn_accntNo_onclick);
		
		//공통코드 세팅
		var codeOptions = [{ code : "FDV", compID : "grd_evid:expns_clsf"}
						 , { code : "FAJ", compID : "grd_evid:card_knd"}
						 , { code : "XAD", compID : "grd_evid:apr_state"}
						 , { code : "FAA", compID : "grd_evid:bank"}
						 ];		
		
		com.setCmnCd(codeOptions, function() {
			//파리미터가 있는경우 세팅
			dma_search.set("meet_req_no",com.getParameter("meet_req_no"));
			
			if(dma_search.get("meet_req_no") != "" ){
				//상세 조회
				scwin.search();
			}else{
				var today = com.getServerDateTime("yyyyMMdd");
				
				// 신규작성인 경우 기본 데이터 세팅
				dma_detl.set("req_syspayno",com.getLoginInfo("sn")); // 신청번호
				dma_detl.set("req_nm",com.getLoginInfo("cn")); // 작성자
				dma_detl.set("dept_nm",com.getLoginInfo("deptName")); // 소속
				dma_detl.set("dept_cd",com.getLoginInfo("deptCode")); // 부서코드
				dma_detl.set("dept_new_ymd",com.getLoginInfo("deptNewYmd")); // 신설일자
				dma_detl.set("req_ymd", today);//작성일자
				dma_detl.set("meal_cnt", 0);
				dma_detl.set("refrsh_cnt", 0);
				
				dma_detl.set("cud_type", "C");//신청번호
				
				//회의일시 세팅
				dma_detl.set("meet_start_ymd", today);
				
				// 첨부파일
				com.file.create(upload_A.getID(), {fileKey: "F241", mode: 'edit'});
			}
		});
		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/**
	* 조회
	*/
	scwin.search = function() {
		com.execute(sbm_selectData, {
			successCallback : function(e) {
				//회의록 복사로 조회하는 경우 회의번호 세팅 안함
				if(scwin.data.copyChk){
					dma_detl.set("meet_req_no", "");
					dma_detl.set("conf_clsf", "N");
					dma_detl.set("attach_file_no", "");
					
					dma_detl.set("meet_start_ymd", "");
					dma_detl.set("meet_start_time", "");
					dma_detl.set("meet_cls_time", "");
					dma_detl.set("cud_type", "C");
					
					btn_meetCopy.show("");
					
					dlt_evid.removeAll();
				}else{
					btn_meetCopy.hide();
					
					//작성일자 변경 이벤트 처리
					scwin.data.orgStartYmd = dma_detl.get("meet_start_ymd");			
					
					//회의시작시간, 종료시간 세팅
					sbx_meet_start_hour.setValue(dma_detl.get("meet_start_time").substr(0,2));
					sbx_meet_start_min.setValue(dma_detl.get("meet_start_time").substr(2,4));
					//회의 종료시간
					sbx_meet_cls_hour.setValue(dma_detl.get("meet_cls_time").substr(0,2));
					sbx_meet_cls_min.setValue(dma_detl.get("meet_cls_time").substr(2,4));
				}
				
				// 첨부파일 세팅
				var attachFileNo = dma_detl.get("attach_file_no");
				if(attachFileNo != ""){
					com.file.create(upload_A.getID(), {fileKey: attachFileNo, mode: 'edit'});
				}else{
					com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit'});
				}
				
				var editFlag = true;//결재시 비활성화 하도록 변수 추가
				if(dma_detl.get("progrs_status") == "FGA002"){ // 결의요청
					if(dma_detl.get("slip_syspayno") != com.getLoginInfo("sn")){
						editFlag = false;
					}else{
						btn_retn.show("");	
					}
				}else if(dma_detl.get("progrs_status") == "FGA001"){ 
					if(dma_detl.get("slip_syspayno") == com.getLoginInfo("sn") || dma_detl.get("req_syspayno") == com.getLoginInfo("sn")){
						if(dma_detl.get("req_syspayno") == dma_detl.get("slip_syspayno")){
							btn_req_slip.hide();
						}else{
							btn_slip.hide();
						}
					}else{
						// 1010102 시스템관리자M, 1010001 시스템관리자A, 1002138 재무시스템 관리자
						if(!/1010102|1010001|1002138/.test(com.getLoginInfo("roleCode"))) {
							btn_req_slip.hide();
							btn_slip.hide();
						}
					}
				}
				
				if(/BG|DM/.test(dma_detl.get("accnt_no").substring(0,2))){
					grd_evid.setColumnDisabled("expns_cd", false);
				}else{
					grd_evid.setColumnDisabled("expns_cd", true);
				}
						
				for(var i = 0 ; i < dlt_evid.getRowCount() ; i++){
					if (dlt_evid.getCellData(i, "unslip_no") != "") {
						btn_del.hide();//삭제버튼 보이지 않게
						editFlag = false;
					}else{
						// 결의이동버튼 활성화
						btn_slip.setDisabled(false);
						btn_req_slip.setDisabled(false);
						
						if(dlt_evid.getCellData(i, "accnt_cd") == ""){ // 3.0 완전오픈 전까지 임시 사용
							scwin.getExpnsInfo(i, dlt_evid.getCellData(i, "expns_cd"));	
						}	
					}
				}
				
				//결의생성 또는 결재중일 경우 데이터 수정못하도록 
				scwin.groupDisable_set(!editFlag);
				btn_searchWork.setDisabled(false);
				
				//조회후 회의참석자 그리드 세팅
				scwin.grd_attend_disable();
			}
		});
	}

	/**
	* 회의참석자 그리드 활성화 셋팅
	*/
	scwin.grd_attend_disable = function(row) {
		var first = 0;
		var last = dlt_attend.getRowCount();
		if(row != undefined){
			first = row;
			last = row+1;
		}

		for(var i= first ; i < last ; i++) {
			if(dlt_attend.getCellData(i, "user_clsf") == "1"){
				grd_attend.setCellReadOnly(i, "dept_nm", true );
				grd_attend.setCellReadOnly(i, "posi_nm", true );
				grd_attend.setCellReadOnly(i, "mobile_no", true );
			}else{
				grd_attend.setCellReadOnly(i, "dept_nm", false );
				grd_attend.setCellReadOnly(i, "posi_nm", false );
				grd_attend.setCellReadOnly(i, "mobile_no", false );
			}
		}
	}

	/**
	* 회의참석자 그리드 초기화
	*/
	scwin.grd_attend_clear = function(row) {
		dlt_attend.setCellData( row, "nm", "" );
		dlt_attend.setCellData( row, "dept_nm", "" );
		dlt_attend.setCellData( row, "posi_nm", "" );
		dlt_attend.setCellData( row, "mobile_no", "" );
		dlt_attend.setCellData( row, "rmk", "" );
		dlt_attend.setCellData( row, "syspayno", "" );
		dlt_attend.setCellData( row, "ctr_req_no", "" );
		dlt_attend.setCellData( row, "adjst_req_no", "" );
		dlt_attend.setCellData( row, "cnt", "");
	}
	
	/**
	* 결의번호가 존재하고 결의상태가 XAD020 이상인 경우 버튼 사용X, 키인 컴포넌트 readonly 처리 작업
	*/
	scwin.groupDisable_set = function(param){		
		grp_detls.setDisabled(param);//회의정보그룹
		ibx_meet_req_no.setDisabled(true);
		
		grp_slip_manager.setDisabled(param);
		grp_accnt_no.setDisabled(param);
		
		grp_btn_evid.setDisabled(param);//지출증빙 버튼
		grp_attend.setDisabled(param);//회의참석자 
		
		btn_del.setDisabled(param);//삭제버튼
		btn_save.setDisabled(param);//저장버튼

		grd_attend.setReadOnly("grid", param);
		
	}	
	
	/**
	 * 회계코드 조회
	 */
	scwin.getAccntCd = function(row, accntNo, expnsCd){
		var data = {
			accnt_no : accntNo,
			expns_cd : expnsCd
		};

		com.pop.open(com.pop.TYPE.EXPNS, data,  function(retObj) {
			if (retObj) {
				dlt_evid.setCellData(row, "expns_cd", retObj.expns_cd);
				dlt_evid.setCellData(row, "expns_cd_nm", retObj.expns_cd_nm);
				dlt_evid.setCellData(row, "accnt_cd", retObj.accnt_cd);
			}
		});
	};
	
	/**
	 * 비용코드 셋팅
	 */
	scwin.setExpnsCd = function(row){
		var first = 0;
		var last = dlt_evid.getRowCount();
		
		if(row != undefined){
			first = row;
			last = row + 1;
		}
		
		for(var i=first; i<last; i++){
			if(dlt_evid.getCellData(i, "expns_clsf") == "") continue;
			
			var cdRow = dlt_cmnCd_FDV.getMatchedIndex("comCd", dlt_evid.getCellData(i, "expns_clsf"), true)[0];
			if(/FAK011|FAK003/.test(dma_detl.get("accnt_clsf"))){
				dlt_evid.setCellData(i, "expns_cd", dlt_cmnCd_FDV.getCellData(cdRow, "mngmtItem2"));
			}else{
				dlt_evid.setCellData(i, "expns_cd", dlt_cmnCd_FDV.getCellData(cdRow, "mngmtItem1"));
			}
			
			scwin.getAccntCd(i, ibx_accnt_no.getValue(), dlt_evid.getCellData(i, "expns_cd"));
		}	
	};
	
	/**
	* 지출증빙 체크
	*/
	scwin.checkPayEvid = function(){
		//승인일시와 회의시작일 비교용 변수
		var compareYmd = true;
		var evidAmtTot = 0;
		
		for(var i = 0 ; i < dlt_evid.getRowCount() ; i++){
			//지출증빙정보(카드) 승인시간 체크 알림 메세지 출력 후 저장이 가능하도록
			if(dlt_evid.getCellData(i, "evid_clsf") == "1") {
				if(dlt_evid.getCellData(i, "evid_apprno") == ""){
					com.alert("message.xom.co.com.0009", "카드승인번호");
					return false;	
				}
				
				if(dlt_evid.getCellData(i, "evid_date") == ""){
					com.alert("message.xom.co.com.0009", "카드승인일자");
					return false;	
				}	
				
				var evidDate = dlt_evid.getCellData(i, "evid_date").trim();
				var meetStartDate = dma_detl.get("meet_start_ymd") + sbx_meet_start_hour.getValue() + sbx_meet_start_min.getValue() + "00";
				
				if(parseInt(evidDate) < parseInt(meetStartDate)) {
					compareYmd = false;
				}					
			}else{
				if(dlt_evid.getCellData(i, "evid_date") < dma_detl.get("meet_start_ymd")){
					compareYmd = false;
				}
			}
			
			if(com.file.action.getTotalFileCount(upload_A.getID()) < 1){
				//비용구분이 다과비인 경우 첨부파일 필수첨부			
				if(dlt_evid.getCellData(i, "expns_clsf") == "FDV002"){
					com.alert((i + 1) + "행 지출증빙정보 다과비에 대한 상세내역 영수증 첨부하여 주세요.");
					return false;
				}
				// 해외카드사용인 경우
				if(dlt_evid.getCellData(i, "evid_clsf") == "1" && dlt_evid.getCellData(i, "casg_receipts") == "F"){
					com.alert((i + 1) + "행 해외 카드 사용인 경우 현지사용영수증을 첨부하여 주세요.");
					return false;
				}
			}
			
			//2022 06 27 다과비/식대 금액 합계가 10만원 이하여도 회의내용 필수 입력(XC22022012D7)
			if(/FDV001|FDV002/.test(dlt_evid.getCellData(i, "expns_clsf"))){
				evidAmtTot = parseInt(evidAmtTot) + parseInt(dlt_evid.getCellData(i, "evid_amt"));
			}
		}
		
		if(!compareYmd){
			if(!confirm("증빙 승인일시가 회의시작일시보다 빠릅니다. 계속 진행하시겠습니까?")){
				return false;
			}
		}
		
		//요청번호 XC220220105F,3만원 초과시 저장되지 않도록 변경 ((식대+다과비) / (인원수 *식대개수) =< 30,000 )
		var checkCnt = com.parseInt((dma_detl.get("meal_cnt") > '0') ? dma_detl.get("meal_cnt") : dma_detl.get("refrsh_cnt"));
		if(checkCnt == 0) checkCnt =1;
		
		if(evidAmtTot/(dlt_attend.getRowCount() * checkCnt) > 30000) {
			com.alert("<font style='color:red;font-weight:bold;'>1인당 식대 사용한도(30,000원)을 초과하였습니다. </font>");
			return false;
		}
		
		return true;
	};
	
	/**
	* 회의 참석자 체크
	*/
	scwin.checkAttendPsn = function(flag){
		if(dma_detl.get("accnt_no") != "" && !/FAK041|FAK042|FAK061/.test(dma_detl.get("accnt_clsf"))){
			//XC220220105F 문의, 계정(정부수탁 "RHA001" ,민간수탁 "RHA003" 인 경우)에 따른 참석자 필수 여부 추가 
			if(/RHA001|RHA003/.test(dma_detl.get("bsns_cd_inout"))){
				var flag = false;
				for( var i = 0; i < dlt_attend.getRowCount() ; i++ ){
					if(dlt_attend.getCellData( i , "user_clsf" ) == "2"){
						var userSn = dlt_attend.getCellData( i , "syspayno" );
						if(dlt_attend.getCellData( i , "nm") != ""){
							flag = true;
						}
					}
				}
				if(!flag){
					com.alert("민간수탁사업, 정부수탁사업 은 외부인 회의참석자를 1명이상 필수입력하셔야 합니다.");
					return false;
				}
			}
		}

		for( var i = 0 ; i < dlt_attend.getRowCount() ; i++ ){			
			if( parseInt(dlt_attend.getCellData(i, "cnt")) > 0){
				if(!confirm(dlt_attend.getCellData(i, "nm") + "님은 같은 날짜에 참석한 회의가 존재합니다.계속 진행하시겠습니까?")){
					return false;
				}
			}
			
			if(/국내출장/.test(dlt_attend.getCellData(i, "rmk"))){
				scwin.data.tripFlag = "Y";
				if(dlt_attend.getCellData(i, "adjst_req_no") == "" && flag == "SLIP"){ // 결의생성시 정산번호 체크
					alert("출장정산번호를 입력하세요");
					return false;
				}
				debugger;
				var rmk = dlt_attend.getCellData(i, "rmk");
				if(rmk.indexOf("카드") >= 0){
					var cardMeal = rmk.substring(rmk.indexOf("카드")+2).replace("식", "").trim();		
					
					if(com.parseInt(cardMeal) < com.parseInt(dlt_attend.getCellData(i, "meal_cnt"))){
						alert("출장 카드식은 식사여부횟수이상이어야 합니다.");
						return false;
					}
				}
			}
		}
		
		return true;
	};	

	/**
	* 저장전 필수 체크
	*/ 
	scwin.preSave = function(flag) {
		if(sbx_meet_start_hour.getValue() == "" || sbx_meet_start_min.getValue() == ""){
			com.alert("message.xom.co.com.0009", "회의시작시간");
			return false;
		}
		if(sbx_meet_cls_hour.getValue() == "" || sbx_meet_cls_min.getValue() == ""){
			com.alert("message.xom.co.com.0009", "회의종료시간");
			return false;	
		}
		
		dma_detl.set("meet_start_time", sbx_meet_start_hour.getValue() + sbx_meet_start_min.getValue());
		dma_detl.set("meet_cls_time", sbx_meet_cls_hour.getValue() + sbx_meet_cls_min.getValue());
		
		var validData = [
			{dataObj : dma_detl
			   , valInfoArr :[
				    { id : "req_nm", mandatory : true}
				   ,{ id : "dept_nm", mandatory : true } 
				   ,{ id : "req_ymd", mandatory : true } 
				   ,{ id : "meet_place", mandatory : true } 
				   ,{ id : "meet_subject", mandatory : true }
				   ,{ id : "meet_contents", mandatory : true }
				   ,{ id : "meet_start_ymd", mandatory : true }
				   ,{ id : "meal_cnt", mandatory : true }
				   ,{ id : "refrsh_cnt", mandatory : true }
				]
			  , isCheckModified : false
			}
		];
		
		if(dlt_evid.getRowCount() > 0){
			validData[0].valInfoArr.push({ id : "accnt_no", mandatory : true });
			validData[0].valInfoArr.push({ id : "slip_nm", mandatory : true });
			
			validData.push({dataObj : dlt_evid, valInfoArr :[
					    { id : "evid_clsf", mandatory : true}
					   ,{ id : "expns_clsf", mandatory : true }
					   ,{ id : "evid_no", mandatory : true}
					   ,{ id : "expns_cd", mandatory : true}
					   ,{ id : "accnt_cd", mandatory : true}
				    ] , isCheckModified : false
			});
			
			if(ica_meet_start_ymd.getValue() < dma_detl.get("start_ymd") || ica_meet_start_ymd.getValue() > dma_detl.get("cls_ymd")){
				com.alert("회의시작 일시가 과제기간내가 아닙니다.");
				return false; 
			}
		}
		
		if(dlt_attend.getRowCount() == 0){
			com.alert("회의참석자는 필수입력사항입니다.");
			return false;
		}
		validData.push({dataObj : dlt_attend, valInfoArr :[
					{ id : "nm", mandatory : true}
				   ,{ id : "dept_nm", mandatory : true }
				   ,{ id : "posi_nm", mandatory : true }
				   ,{ id : "meal_cnt", mandatory : true }
				] , isCheckModified : false
		});
		
		
		if(!com.validateData(validData)) return false;
		
		//회의 시/분 체크
		if(dma_detl.get("meet_start_time") > dma_detl.get("meet_cls_time")){
			com.alert("회의시작시간은 회의종료시간 보다 클 수 없습니다.");
			return false;
		}

		// 지출증빙 체크 
		if(dlt_evid.getRowCount() > 0){
			if(!scwin.checkPayEvid()) return false;
		}
		
		// 회의참석자 체크 
		if(!scwin.checkAttendPsn(flag)) return false;
				
		return true;
	}
	
	/**
	* 회의록계정과 출장계정비교 팝업 호출
	*/
	scwin.openAccntCompPop = function(clsf){
		if(scwin.data.tripFlag == "Y" && dma_detl.get("accnt_no") != ""){
			var reqNos =[];
			for(var i=0; i<dlt_attend.getRowCount(); i++){
				if(dlt_attend.getCellData(i, "ctr_req_no") != ""){
					reqNos.push(dlt_attend.getCellData(i, "ctr_req_no"));
				}
			}
			var data ={
				req_no_list : reqNos.join(","),
				accnt_no : dma_detl.get("accnt_no")
			};
			
			var options ={
				width: 800,
				height: 400,
				id: "F24101Pop",
				popupName: "회의록계정과 출장계정비교"
			};
			com.openPopup( "/ui/fin/pop/FIN_POP_F241_01P.xml", options, data, function(ret){
				if(ret){
					if(clsf == "SAVE"){
						scwin.save();
					}else{
						scwin.saveMeetSlip();	
					}
				}
			});
		}else{
			if(clsf == "SAVE"){
				scwin.save();
			}else{
				scwin.saveMeetSlip();	
			}
		}
	};
	
	/**
	* 저장
	*/
	scwin.save = function(){
		com.file.transport( function(attachObj){
			dma_detl.set("attach_file_no", attachObj.upload_A);
			dma_detl.set("validAttachNo", attachObj.upload_A);
			
			com.execute(sbm_saveMeet, {
				successCallback : function(e) {
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
						scwin.data.copyChk = false;
						
						scwin.search();
					});
				}
			});
		});
	};
	
	/**
	* 참석자 추가시 체크
	*/ 
	scwin.checkAttendPsnDup = function(row, sysPayNo){
		if(dlt_attend.getMatchedIndex("syspayno", sysPayNo, true).length > 0){
			com.alert("중복된 참석자가 존재 합니다.");
			return false;
		}		
		return true;
	};
	
	/**
	* 카드정보 조회
	*/ 
	scwin.getCardInfo = function(row, data){
		biz.fin.pop.open(biz.fin.pop.TYPE.CARD_USE, data, function(ret){
			if(ret){						
				//동일한 증빙내용이 있는지 확인
				for(var i = 0 ; i < dlt_evid.getRowCount() ; i++){
					if(dlt_evid.getCellData(i, "evid_apprno") == ret.apprvl_no && dlt_evid.getCellData(i, "card_no") == ret.card_no){
						com.alert("중복된 카드 증빙정보가 존재 합니다.");
						return;
					}
				}

				var card_arr = ret.card_no.split("-");
				var card_no_2 = "****-****-"+card_arr[2]+"-"+card_arr[3];
				
				if(ret.un_amt != ret.use_amt){
					alert("해당 카드처리내역의 사용금액과 미처리 금액이 일치하지 않습니다.");
					return;	
				}
				
				dlt_evid.setCellData(row, "evid_no", card_no_2);//카드번호
				dlt_evid.setCellData(row, "evid_apprno", ret.apprvl_no);//승인번호
				dlt_evid.setCellData(row, "evid_date", ret.use_ymd);//승인일자
				dlt_evid.setCellData(row, "evid_shop", ret.joinsto_nm);//거래처명
				dlt_evid.setCellData(row, "evid_amt", ret.use_amt);//사용금액
				dlt_evid.setCellData(row, "chrg_amt", ret.supply_amt);// 공급가액
				dlt_evid.setCellData(row, "tax_amt", ret.tax_amt);//사용금액
				dlt_evid.setCellData(row, "cardno", ret.cardno);//카드번호
				dlt_evid.setCellData(row, "card_no", ret.card_no);//카드번호
				dlt_evid.setCellData(row, "card_clsf", ret.card_clsf);//카드구분
				dlt_evid.setCellData(row, "card_knd", ret.card_knd);//카드종류
				dlt_evid.setCellData(row, "casg_receipts", ret.dofogu); // 국내외구분
				
				ica_meet_start_ymd.setValue(ret.use_ymd.substring(0,8));
			}	
		});
	};
	
	/**
	* 계산서 정보 조회
	*/ 
	scwin.getBillInfo = function(row, data){
		biz.fin.pop.open(biz.fin.pop.TYPE.BILL, data, function(ret){
			if(ret){
				//todo : 동일건 다시 선택시 오류 수정
				//동일한 증빙내용이 있는지 확인
				for(var i = 0 ; i < dlt_evid.getRowCount() ; i++){
					if(dlt_evid.getCellData(i, "evid_no") == ret.issu_seqno){
						com.alert("중복된 카드 증빙정보가 존재 합니다.");
						return;
					}
				}
				dlt_evid.setCellData(row, "evid_no", ret.issu_seqno);//카드번호
				dlt_evid.setCellData(row, "evid_apprno", "");//승인번호
				dlt_evid.setCellData(row, "evid_date", ret.regs_date);//승인일자
				dlt_evid.setCellData(row, "evid_shop", ret.vend_nm);//거래처명
				dlt_evid.setCellData(row, "evid_amt", ret.totl_amt);//사용금액
				dlt_evid.setCellData(row, "card_no", "");//카드번호
				dlt_evid.setCellData(row, "card_clsf", "");//카드구분
				dlt_evid.setCellData(row, "card_knd", "");//카드종류
				dlt_evid.setCellData(row, "issu_seqno", ret.issu_seqno);// 계산서번호
				dlt_evid.setCellData(row, "chrg_amt", ret.chrg_amt);// 공급가액
				dlt_evid.setCellData(row, "tax_amt", ret.tax_amt);// 세액
				
				ica_meet_start_ymd.setValue(ret.regs_date);
			}	
		});
	};
	
	/**
     * 근태정보 조회
     */
	scwin.getWorkInfo = function(row){
		// 근태정보 조회				
		com.execute(sbm_selectCwsWorkTime, {
			successCallback : function(e) {
				debugger;
				if(e.responseJSON.fspMeetWorkTimeVoList != undefined){
					dlt_workTime.setJSON(e.responseJSON.fspMeetWorkTimeVoList);
					//근태정보조회 후 콜백
					scwin.checkWorkInfo(row);
				}
			}
		});
	};
	
	/**
     * 근태정보 조회 후 참여자정보 셋팅
     */
	scwin.checkWorkInfo = function(row){
		for(var i = 0 ; i < dlt_workTime.getRowCount() ; i++){
			var workDetls = dlt_workTime.getCellData(i, "work_detls");
			var holidayClsf = dlt_workTime.getCellData(i, "holiday_clsf");
			var cnt = dlt_workTime.getCellData(i, "cnt");

			if(holidayClsf != "" && holidayClsf != "CWM002"){
				com.alert("휴가사용 직원은 참석자에 포함할 수 없습니다.");
				//선택 데이터리스트 초기화
				dlt_attend.setRowData(row,[],true);
				break;
			}
			
			if(workDetls != ""){
				dlt_attend.setCellData(row, "rmk", workDetls);//비고
				dlt_attend.setCellData(row, "cnt", cnt);//타회의참석
				if(/국내출장/.test(workDetls)){
					dlt_attend.setCellData(row, "ctr_req_no", dlt_workTime.getCellData(i, "ctr_req_no"));
					dlt_attend.setCellData(row, "adjst_req_no", dlt_workTime.getCellData(i, "adjst_req_no"));
				}
				break;
			}
		}
	};
		
	/**
     * 사용자 데이터 초기화
     */
	scwin.clearEmpInfo = function(clsf){
		if(clsf == "Slip_Charger"){
			dma_detl.set("slip_syspayno", "");
			dma_detl.set("slip_empno", "");
			dma_detl.set("slip_nm", "");
		}
	};
	
	/**
	 * 비용코드 검색팝업
	 */
	scwin.getExpnsInfo = function(row, expnsCd) {
		if (ibx_accnt_no.getValue() == "") {
			com.alert(com.getMsg("message.xom.co.com.0001", "계정번호"));
			return;
		}

		var data = {
			accnt_no : ibx_accnt_no.getValue(),
			expns_cd : expnsCd,
			ref_yn : (expnsCd == "")? "Y" : "N"
		}; 

		com.pop.open(com.pop.TYPE.EXPNS, data, function(retObj) {
			if (retObj) {
				if(!/373|374/.test(retObj.expns_cd)){
					alert("비용코드는 [373,374] 중에서 선택해야합니다.");
					return;
				}
				dlt_evid.setCellData(row, "expns_cd", retObj.expns_cd);
				dlt_evid.setCellData(row, "expns_cd_nm", retObj.expns_cd_nm);
				dlt_evid.setCellData(row, "accnt_cd", retObj.accnt_cd);
			}
		});
	};
	
	/**
	* 결의생성이동
	*/
	scwin.saveMeetSlip = function(){
		var clsf = scwin.data.slip_knd;

		dlt_slip.setJSON(grd_evid.getCheckedJSON("chk"));
		
		com.confirm("결의생성을 하시겠습니까?", function(ret){
			if(ret){				
				com.file.transport( function(attachObj){
					dma_detl.set("attach_file_no", attachObj.upload_A);
					dma_detl.set("validAttachNo", attachObj.upload_A);
					
					com.execute(sbm_saveSlipData, {
						successCallback : function(e){
							if(e.responseJSON.unslip_no != undefined && e.responseJSON.unslip_no != ""){
								if(clsf == "BILL"){
									com.moveList("F201", {unslip_no: e.responseJSON.unslip_no});
								}else{
									com.moveList("F202", {unslip_no: e.responseJSON.unslip_no}); // 카드결의
								}
							}else{
								alert("결의생성에 실패하였습니다. 시스템담당자에게 문의바랍니다.");	
							}
						}
					});	
				});
			}
		});		
	};
	
	/**
	* 결의생성전 체크
	*/
	scwin.preSlip = function(){
		var chks = grd_evid.getCheckedIndex("chk");

		if(chks.length < 1){
			com.alert("결의생성할 지출증빙정보를 선택하세요.");
			return false;
		}
		var clsf = (dlt_evid.getCellData(chks[0], "evid_clsf") == "1")? "CARD" : "BILL";
		scwin.data.slip_knd = clsf;
		
		dma_slipH.set("slip_ymd", ica_req_ymd.getValue());
		dma_slipH.set("slip_typ_cd", (clsf == "CARD")? "117" : "113");
		dma_slipH.set("rmk", "회의비 (" + grd_evid.getCellDisplayData(chks[0], "expns_clsf") + "/" + dma_detl.get("meet_start_ymd").substring(4, 6)+ "." + dma_detl.get("meet_start_ymd").substring(6, 8) + ")");		
		
		var checkCnt = 0;
		for(var i = 0 ; i < chks.length ; i++){
			if(dlt_evid.getCellData(chks[i], "expns_clsf") == ""){
				com.alert("비용구분은 필수입력 사항입니다.");
				return false;
			}
			
			if(dlt_evid.getCellData(chks[i], "unslip_no") != ""){
				com.alert("[" + (chks[i]+1) + "]행은 이미 결의가 생성되었습니다.");
				return false;
			}
			
			if(clsf == "BILL" && dlt_evid.getCellData(chks[i], "evid_clsf") == '1'){
				checkCnt++;	
			}
			
			if(clsf == "CARD" && dlt_evid.getCellData(chks[i], "evid_clsf") != '1'){
				checkCnt++;	
			}
			
			if(dlt_evid.getCellData(chks[i], "evid_clsf") != '1'){
				if(dlt_evid.getCellData(chks[i], "issu_seqno") == ""){
					com.alert("관련 계산서번호 또는 현금영수증번호가 누락되었습니다.");
					return false;
				}
				
				if(dlt_evid.getCellData(chks[i], "syspayno") == ""){
					com.alert("지급(개인번호가)가 누락되었습니다.");
					return false;
				}
				
				if(dlt_evid.getCellData(chks[i], "bankaccnt_no") == ""){
					com.alert("입금계좌번호가 누락되었습니다.");
					return false;
				}
				
				if(dlt_evid.getCellData(chks[i], "bank") == ""){
					com.alert("입금은행이 누락되었습니다.");
					return false;
				}
				
				if(dlt_evid.getCellData(chks[i], "depstr_nm") == ""){
					com.alert("예금주가 누락되었습니다.");
					return false;
				}
			}else{
				if(dlt_evid.getCellData(chks[i], "cardno") == ""){
					com.alert("관련 카드번호가 누락되었습니다.");
					return false;
				}
				
				if(dlt_evid.getCellData(chks[i], "evid_apprno") == ""){
					com.alert("관련 승인번호가 누락되었습니다.");
					return false;
				}
				
				if(dlt_evid.getCellData(chks[i], "evid_date") == ""){
					com.alert("관련 승인일자 또는 승인시간이 누락되었습니다.");
					return false;
				}
			}			
		}
		
		if(checkCnt > 0){
			com.alert("증빙구분은 카드와 [계산서 또는 현금영수증]을 동시에 선택할 수 없습니다.");
			return false;	
		}

		return true;
	};
	
	/**
	 * 카드 승인 일자 포맷
	 */
	scwin.formatDate = function(str){
		if(str == "") return "";
		var useYmd = str.replace(/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/, "$1-$2-$3 $4:$5:$6");
		
		return com.formatDateTime(new Date(useYmd), "yyyy-MM-dd HH:mm:ss");
	};
	
	//---------------------------------------------------------------------------- event ----------------------------------//	
	/**
	* 지출증빙정보 그리드 변경 이벤트
	*/ 
	scwin.grd_evid_onviewchange = function(info) {
		var colId = grd_evid.getColumnID(info.colIndex);
		var row = info.rowIndex;
		
		if(colId == "evid_clsf"){//증빙구분	
			if(ibx_accnt_no.getValue() == ""){
				alert("계정번호를 선택하세요.");
				return;	
			}
					
			//증빙구분외 데이터 초기화
			dlt_evid.setRowJSON(row, [{"evid_clsf" : dlt_evid.getCellData(row, "evid_clsf")}], true);			
		}else if(colId == "expns_clsf"){
			if(ibx_accnt_no.getValue() == ""){
				alert("계정번호를 선택하세요.");
				return;	
			}
			
			if(info.newValue != ""){
				scwin.setExpnsCd(row);
				
				if(dlt_evid.getCellData(row, "expns_clsf") == "FDV001"){
					spi_meal_cnt.setValue(1);
				}else if(dlt_evid.getCellData(row, "expns_clsf") == "FDV002"){
					spi_refrsh_cnt.setValue(dlt_evid.getMatchedIndex("expns_clsf", "FDV002", true).length);
				}
			}
		}else if(colId == "chk"){
			if(dlt_evid.getCellData(row, "chk") == "Y"){
				for(var i=0; i<dlt_evid.getRowCount(); i++){
					if(i != row){
						if((dlt_evid.getCellData(row, "evid_clsf") == "1" && dlt_evid.getCellData(i, "evid_clsf") == "1") 
							|| (dlt_evid.getCellData(row, "evid_clsf") != "1" && dlt_evid.getCellData(i, "evid_clsf") != "1") ){							
							dlt_evid.setCellData(i, "chk", "Y");
						}else{
							dlt_evid.setCellData(i, "chk", "N");
						}
					}	
				}
			}
		}else if(colId == "expns_cd"){
			// 비용코드 조회
			scwin.getExpnsInfo(row, dlt_evid.getCellData(row, "expns_cd"));
		}
	};
	
	/**
	* 지출증빙정보 그리드 click 이벤트
	*/ 
	scwin.grd_evid_oncellclick = function(row,col,colId) {
		var unslipNo = dlt_evid.getCellData(row, "unslip_no");
		if(unslipNo == "") return;
		
		if(colId == "unslip_no"){			
			if(unslipNo.substring(0, 3) == "113"){
				com.moveList("F201", {unslip_no: unslipNo}); // 경비결의(일반)
			}else{
				com.moveList("F202", {unslip_no: unslipNo}); // 카드결의
			}
		}else if(colId == "btn_evid"){
			com.biz.openEvidWindow(unslipNo);
		}
	};
	
	/**
	* 지출증빙정보 그리드 textimage click 이벤트
	*/ 
	scwin.grd_evid_ontextimageclick = function(row,col) {
		var colId = grd_evid.getColumnID(col);
		
		if(colId == "evid_no"){// 카드/계산서번호/현금영수증 버튼
			if(dlt_evid.getCellData(row, "evid_clsf") == ""){
				com.alert("증빙구분을 선택하세요.");
				return;
			}
			//카드내역조회
			var data={
				relat_no : com.getLoginInfo("sn"),
				biz_clsf : "meet"
			};
			
			if(dlt_evid.getCellData(row, "evid_clsf") == "1"){ // 카드
				scwin.getCardInfo(row, data);
				
			}else if(/2|3/.test(dlt_evid.getCellData(row, "evid_clsf"))){
				if(scwin.data.vend_nm != undefined && scwin.data.vend_nm != ""){
					data.vend_nm = scwin.data.vend_nm;
				}
				
				scwin.getBillInfo(row, data);
			}
		}else if(colId == "expns_cd") {
			// 비용코드 조회
			scwin.getExpnsInfo(row, dlt_evid.getCellData(row, "expns_cd"));
		}else if(colId == "empno") {
			if(dlt_evid.getCellData(row, "evid_clsf") != "1"){
				com.pop.open(com.pop.TYPE.BNKAC, {clsf:"apart", ref_yn:"Y"}, function(ret) {
					dlt_evid.setCellData(row, "syspayno", ret.syspayno);
					dlt_evid.setCellData(row, "empno", ret.empno);
					dlt_evid.setCellData(row, "bankaccnt_no", ret.bankaccnt_no);
					dlt_evid.setCellData(row, "depstr_nm", ret.depstr_nm);
					dlt_evid.setCellData(row, "bank", ret.bank);
				});
			}			
		}
	};
	
	
	/**
	* 계정번호 검색 버튼 클릭 이벤트
	*/ 
	scwin.btn_accntNo_onclick = function(e) {
		var data={
			accnt_no : ibx_accnt_no.getValue(),
			cls_ymd : com.getServerDateTime(),
			ref_yn : (ibx_accnt_no.getValue() == "")? "Y" : "N"
		};
		com.pop.open(com.pop.TYPE.ACNNO, data, function(ret) {
			if(ret){
				dma_detl.set("accnt_no", ret.accnt_no);
				dma_detl.set("accnt_no_nm", ret.accnt_no_nm);
				dma_detl.set("accnt_rspns_nm", ret.accnt_rspns_nm);
				dma_detl.set("start_ymd", ret.start_ymd);
				dma_detl.set("cls_ymd", ret.cls_ymd);
				dma_detl.set("bsns_cd_inout", ret.bsns_cd_inout);
				dma_detl.set("accnt_clsf", ret.accnt_grp);
				dma_detl.set("mngmt_clsf", ret.mngmt_clsf);
				dma_detl.set("tax_cd", ret.tax_cd);
				dma_detl.set("itm_solve_base", ret.itm_solve_base);
				
				if(/BG|DM/.test(ret.accnt_no.substring(0,2))){
					grd_evid.setColumnDisabled("expns_cd", false);
				}else{
					grd_evid.setColumnDisabled("expns_cd", true);
				}
				
				if(dlt_evid.getRowCount() == 0){
					com.addRow(grd_evid);
				}else{
					// 비용코드 다시 셋팅
					scwin.setExpnsCd();
				}				
				
				if(ret.dept_res_psn != undefined && ret.dept_res_psn != ""){
					com.pop.open(com.pop.TYPE.HUM, {empno : ret.dept_res_psn.substring(2, 8)}, function(retObj){
						dma_detl.set("slip_syspayno", retObj.syspayno);
						dma_detl.set("slip_empno", retObj.empno);
						dma_detl.set("slip_nm", retObj.nm);
					});
				}else{
					// 결의생성담당자
					dma_detl.set("slip_syspayno", com.getLoginInfo("sn"));
					dma_detl.set("slip_empno", com.getLoginInfo("empno"));
					dma_detl.set("slip_nm", com.getLoginInfo("cn"));
				}
			}
		});
	};
	
	/**
	* 참석자 그리드 변경 이벤트
	*/
	scwin.grd_attend_onviewchange = function(info) {
		var row = info.rowIndex;
		var col = info.colIndex;
		var colId = grd_attend.getColumnID(col);
		
		if(colId == "user_clsf") {
			scwin.grd_attend_clear(row);
						
			scwin.grd_attend_disable(row);
			
		} else if(colId == "nm") {
			if(dlt_attend.getCellData(row, "user_clsf") == ""){
				com.alert("내/외부인 구분을 선택해주세요.", function(){
					dlt_attend.setCellData(row, "nm", "");
				});	
				
				return;
			}
			
			if(sbx_meet_start_hour.getValue() == "" || sbx_meet_start_min.getValue() == "" || sbx_meet_cls_hour.getValue() == "" || sbx_meet_cls_min.getValue() == "") {
				com.alert("회의시간을 입력해주세요.", function(){
					dlt_attend.setCellData(row, "nm", "");					
				});
				return;
			}
			
			dlt_attend.setCellData(row, "meal_cnt", spi_meal_cnt.getValue());
			
			if(dlt_attend.getCellData(row, "user_clsf") == "1"){
				if(info.newValue != "") {		
					scwin.getEmpInfo("Attend", row);
				}else{
					scwin.grd_attend_clear(row);
				}
			}else if(dlt_attend.getCellData(row, "user_clsf") == "2"){				
				dma_search.set("attend_nm",dlt_attend.getCellData(row, "nm"));
				dma_search.set("meet_start_time", sbx_meet_start_hour.getValue()+sbx_meet_start_min.getValue());
				dma_search.set("meet_cls_time", sbx_meet_cls_hour.getValue()+sbx_meet_cls_min.getValue());
				
				//회의 참석 조회
				com.execute(sbm_selectOutMeetPrsn, {
					successCallback : function(e) {
						dlt_outMeetPrsn.setJSON(e.responseJSON.fspMeetAttendVoList);
						
						if(dlt_outMeetPrsn.getRowCount() > 0){
							//"등록"이면 작성한 상태 유지, "취소"인 경우 입력 데이터 삭제
							//회의록 조회 팝업과 동일 팝업 사용, 데이터는 조회하지 않고 해당 조회내용 결과만 파라미터로 보내준다
							var data = {
								dataResult : dlt_outMeetPrsn.getAllJSON(),
								user_clsf : "2",
								ref_yn : "Y"
							} 
							com.pop.open(com.pop.TYPE.MEET, data, function(ret){
								if(!ret){
									dlt_attend.setRowData(row,[],true);
								}
							});
						}
						
					}
				});
			}
		}
	};

	/**
	* 참석자 그리드 클릭 이벤트
	*/
	scwin.grd_attend_oncellclick = function(row,col,colId) {
		if(colId == "cnt") {
			if(dlt_attend.getCellData(row, "user_clsf") == "1"){
				//내부인이고 타회의참석횟수를 클릭한 경우
				var data = {
					syspayno : dlt_attend.getCellData(row,"syspayno"),
					empno : dlt_attend.getCellData(row,"syspayno").substr(2,8),
					nm : dlt_attend.getCellData(row,"nm"),
					from_ymd : dma_detl.get("meet_start_ymd"),
					to_ymd : dma_detl.get("meet_start_ymd"),
					user_clsf : "1",
					ref_yn : "Y"
				} 
				com.pop.open(com.pop.TYPE.MEET, data, function(ret){
					if(ret){
						
					}
				});
				
			}
		}else if(colId == "meal_cnt_plus") {
			var mealCnt = com.parseInt(dlt_attend.getCellData(row, "meal_cnt"));
			if(mealCnt < com.parseInt(spi_meal_cnt.getValue())){
				dlt_attend.setCellData(row, "meal_cnt", (mealCnt+1));
			}
			
		}else if(colId == "meal_cnt_minus") {
			var mealCnt = com.parseInt(dlt_attend.getCellData(row, "meal_cnt"));
			if(mealCnt > 0){
				dlt_attend.setCellData(row, "meal_cnt", (mealCnt - 1));
			}
		}
	};
	
	/**
	* 참석자 그리드 textImage click event
	*/
	scwin.grd_attend_ontextimageclick = function(row,col) {
		if(dlt_attend.getCellData(row, "user_clsf") == "2") return;
		
		if("nm" == grd_attend.getColumnID(col)){
			scwin.getEmpInfo("Attend", row);
						
		}else if(grd_attend.getColumnID(col) == "adjst_req_no"){
			//내부인이고 출장신청번호를 클릭한 경우
			if(dlt_attend.getCellData(row, "rmk").indexOf("국내출장") > -1 ){
				//비고에 출장이라는 문구가 있다면
				var data = {
					biztrip_psn_syspayno : dlt_attend.getCellData(row,"syspayno"),
					biztrip_psn_empno : dlt_attend.getCellData(row,"syspayno").substr(2,8),
					biztrip_psn_nm : dlt_attend.getCellData(row,"nm"),
					flag : "DomAd",
					from_ymd : dma_detl.get("meet_start_ymd"),
					to_ymd : dma_detl.get("meet_start_ymd"),
					ref_yn : "Y"
				} 
				//출장정산번호 조회 팝업 
				com.pop.open(com.pop.TYPE.DOMTRIP_AD, data, function(ret){
					if(ret){
						dlt_attend.setCellData(row, "ctr_req_no", ret.biztrip_req_no);
						dlt_attend.setCellData(row, "adjst_req_no", ret.req_no);
					}
				});
			}else{
				com.alert("비고에 출장일 경우에만 가능 합니다.");
			}
		}
	};
	
	/**
	* 증빙그리드 + 버튼 이벤트
	*/
	scwin.btn_plus_onclick = function(e) {
		var row = com.addRow(grd_evid);
	};
	
	/**
	* 증빙그리드 - 버튼 이벤트
	*/
	scwin.btn_minus_onclick = function(e) {
		var chkArr = grd_evid.getCheckedIndex("chk");
		
		if(chkArr.length == 0){
			com.alert("삭제할 행을 선택하세요.");
			return;
		}
		
		dlt_evid.removeRows(chkArr);

		//row 삭제로 인한 버튼 비활성화 처리
		if(dlt_evid.getRowCount() != 0){
			var slipChk = false;
			
			for(var i = 0 ; i < dlt_evid.getRowCount() ; i++){
				if(dlt_evid.getCellData(i, "unslip_no") == ""){
					SlipExpnsChk = true;
				}
			}
			
			if(slipChk == true){
				btn_slip.setDisabled( false );
			}else{
				btn_slip.setDisabled( true );
			}
			
		}else{
			btn_slip.setDisabled(true);
		}
	};
	
	/**
	* 회의참석자 그리드 추가버튼 클릭 이벤트
	*/
	scwin.btn_attent_plus_onclick = function(e) {
		if(dma_detl.get("meet_start_ymd") == ""){
			com.alert("회의일자을 입력해주세요.");
			return;
		}
		if(sbx_meet_start_hour.getValue() == "" || sbx_meet_start_min.getValue() == "" || sbx_meet_cls_hour.getValue() == "" || sbx_meet_cls_min.getValue() == "") {
			com.alert("회의시간을 입력해주세요.");
			return;
		}
		
		var row = com.addRow(grd_attend);
	};
	
	/**
	* 회의참석자 그리드 삭제버튼 클릭 이벤트
	*/
	scwin.btn_attend_minus_onclick = function(e) {
		var rows = grd_attend.getCheckedIndex("chk");
		
		if(rows.length == 0){
			com.alert("삭제할 행을 선택하세요.");
			return;
		}

		dlt_attend.removeRows(rows);
	};
	
	/**
	* 저장 버튼 클릭 이벤트
	*/
	scwin.btn_save_onclick = function(e) {		
		//저장전 validate 체크
		if(!scwin.preSave("SAVE")) return;
		
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
			if(ret){
				// 과제참여여부 체크(연구과제이고 내부인이 존재할때)
				if(dma_detl.get("mngmt_clsf") == "R" && dlt_attend.getMatchedIndex("user_clsf", "1", true).length > 0){
					var sysPayNos =[];
					for(var i=0; i<dlt_attend.getRowCount(); i++){
						if(dlt_attend.getCellData(i, "user_clsf") == "1"){
							sysPayNos.push(dlt_attend.getCellData(i, "syspayno"));
						}
					}
					dma_search.set("accnt_no", dma_detl.get("accnt_no"));
					dma_search.set("syspayno", sysPayNos.join(","));
					
					com.execute(sbm_selectPrjPartYn, {
						successCallback : function(e){
							if(e.responseJSON.cnt == '0'){
								alert("해당 과제의 참여연구원이 존재하지 않습니다.");
								return;
							}
							
							scwin.openAccntCompPop("SAVE");
						}
					});
				}else{
					scwin.openAccntCompPop("SAVE");
				}
			}
		});
	};
	
	/**
	* 삭제 버튼 클릭 이벤트
	*/
	scwin.btn_del_onclick = function(e) {
		//삭제 전 체크(저장 전에는 삭제 버튼 disable 처리는 되어 있음)
		if(dma_detl.get("meet_req_no") == ""){
			com.alert("회의번호가 없어 삭제 할 수 없습니다.");
			return false;
		}
		
		//결의가 생성되면 삭제 못하게 처리(결의가 진행되면 삭제/수정 못하도록 버튼 disable 처리되어있음)
		//결의번호가 생기면 해당 회의록 삭제 불가
		for(var i = 0 ; i < dlt_evid.getRowCount() ; i++){
			if(dlt_evid.getCellData(i, "unslip_no").trim() != ""){
				com.alert("해당 회의번호로 결의가 되어있어 삭제 할 수 없습니다.");
				return false;
			}
		}
		
		com.confirm("message.xom.wq.022"/*삭제 하시겠습니까?*/, function(ret) {
			if (ret) {
				com.file.deleteAll( function(){
					com.execute(sbm_deleteMeet, {
						successCallback : function(e) { // 성공 콜백
							com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
								com.moveList("F240",{});
							});
						}
					});
				});
			}
		});
	};
	
	/**
	* 목록 버튼 클릭 이벤트
	*/
	scwin.btn_pre_onclick = function(e) {
		com.moveList("F240");
	};	
	
	/**
	* 회의시작일자 변경 이벤트
	*/
	scwin.ica_meet_start_ymd_onviewchange = function(info) {
		var start_ymd = this.getValue();		

		var grid_flag = false;
		if(dma_detl.getModifiedData() != "" && dlt_attend.getUpdatedIndex().length > 0){
			grid_flag = true;
		}
		
		if(scwin.data.orgStartYmd != start_ymd && grid_flag ){
			if(!confirm("날짜를 변경하시면 회의참석자가 모두 삭제됩니다. 그래도 날짜를 변경하시겠습니까?")){
				dma_detl.set("meet_start_ymd", scwin.data.orgStartYmd);
			}else{
				dlt_attend.removeAll();
				dlt_attend.insertRow();
				
				scwin.data.orgStartYmd = start_ymd;
			}
		}
	};
	
	scwin.btn_print_onclick = function(e) {
		var node = "meet_req_no=" + dma_detl.get("meet_req_no");
		
		if(dma_detl.get("meet_req_no") != ""){
			com.oz.openPopup({
				ozrCode : "F014",
				param: node
			});
		}else{
			com.alert("저장을 해야 출력 할 수 있습니다.");
			return;
		}
	};
	
	/**
	* 결의생성 버튼 클릭 이벤트
	*/
	scwin.btn_slip_onclick = function(e) {
		//저장전 validate 체크
		if(!scwin.preSave("SLIP")) return;
		
		// 결의생성 전 체크
		if(!scwin.preSlip()) return;
		
		// 과제참여여부 체크(연구과제이고 내부인이 존재할때)
		if(dma_detl.get("mngmt_clsf") == "R" && dlt_attend.getMatchedIndex("user_clsf", "1", true).length > 0){
			dma_search.set("accnt_no", dma_detl.get("accnt_no"));
			
			com.execute(sbm_selectPrjPartYn, {
				successCallback : function(e){
					if(e.responseJSON.cnt == 0){
						alert("해당 과제의 참여연구원이 존재하지 않습니다.");
						return;
					}
					
					scwin.openAccntCompPop("SLIP");
				}
			});
		}else{
			scwin.openAccntCompPop("SLIP");
		}
	};	
	
	/**
	* 회의록 복사 버튼 클릭 이벤트
	*/
	scwin.btn_copy_onclick = function(e) {
		var data = {
			type : "evid",
			user_clsf : "1",
			ref_yn : "Y"
		};
		com.pop.open( com.pop.TYPE.MEET, data, function(ret){
			if(ret){
				dma_search.set("meet_req_no",  ret.meet_req_no);
				scwin.data.copyChk = true;
				
				//팝업에서 조회한 신청번호로 복사용 데이터 조회 
				scwin.search();
			}
		});
	};
	
	/**
	* 양식다운로드 클릭 이벤트
	*/
	scwin.btn_meet_attach_onclick = function(e) {
		var save = "meet_attendee";
		var real = encodeURIComponent("회의참석자.xlsx");	
	
		var url = "/SvcAttachDown.do?fileName=web_folder/bizdoc/fin/fin/"+save+"&realName="+real+"&bizKind=OLD";
		
		window.open(url, '_blank').focus();
	};
	
	/**
	* 엑셀업로드 클릭 이벤트
	*/
	scwin.btn_excel_upload_onclick = function(e) {
		dlt_attend.removeRow(0);

		var options = {
			type : "1",
			startRowIndex : "1"
		};
		com.uploadGridExcel(grd_attend, options);
	};
	
	/*
     * 결의담당자 검색 버튼 클릭 이벤트
     */
	scwin.btn_slip_charger_onclick = function(e) {
		scwin.getEmpInfo("Slip_Charger");
	};
	
	/*
     * 결의생성담당자 변경 이벤트
     */
	scwin.ibx_slip_empno_onchange = function(info) {
		if(this.getValue() == ""){
			scwin.clearEmpInfo("Slip_Charger");
		}else{
			if(dma_detl.get("slip_syspayno") == dma_detl.get("req_syspayno")){
				btn_slip.show("");
				btn_req_slip.hide();
			}else{
				btn_slip.hide();	
				btn_req_slip.show("");
			}
		}
	};
	
	/*
     * 사용자 검색
     */
	scwin.getEmpInfo = function(clsf, row){
		var data={work_clsf : "HAG010"};
		if(clsf == "Slip_Charger"){
			data.empno = ibx_slip_empno.getValue();
		}else if(clsf == "Attend"){
			data.empno = dlt_attend.getCellData(row, "nm");	
		}
		
		data.ref_yn = (data.empno == "")? "Y" : "N";
		
		com.pop.open(com.pop.TYPE.HUM, data, function(ret){
			if(clsf == "Slip_Charger"){
				dma_detl.set("slip_syspayno", ret.syspayno);
				dma_detl.set("slip_empno", ret.empno);
				dma_detl.set("slip_nm", ret.nm);
			}else if(clsf == "Attend"){
				if(scwin.checkAttendPsnDup(row, ret.syspayno)){
					dlt_attend.setCellData(row, "nm", ret.nm);
					dlt_attend.setCellData(row, "syspayno", ret.syspayno);
					dlt_attend.setCellData(row, "mobile_no", ret.mobile);
					dlt_attend.setCellData(row, "posi_nm", ret.posi_nm);
					dlt_attend.setCellData(row, "dept_nm", ret.dept_nm);
					dlt_attend.setCellData(row, "ctr_req_no", "");
					dlt_attend.setCellData(row, "adjst_req_no", "");
					
					//재택근무 근태정보  및 근태 정보 조회
					scwin.getHomeWorkInfo(row);
				}
			}
		});
	};
	
	/**
     * 재택근무 및 근태정보 조회
     */
	scwin.getHomeWorkInfo = function(row){
		dma_search.set("syspayno", dlt_attend.getCellData(row, "syspayno"));
		
		dma_search.set("meet_start_ymd",ica_meet_start_ymd.getValue());
		dma_search.set("meet_start_hour",sbx_meet_start_hour.getValue());
		dma_search.set("meet_cls_hour",sbx_meet_cls_hour.getValue());
		dma_search.set("meet_start_time",sbx_meet_start_hour.getValue() + sbx_meet_start_min.getValue());
		dma_search.set("meet_cls_time",sbx_meet_cls_hour.getValue() + sbx_meet_cls_min.getValue());
		
		com.execute(sbm_selectTripList, {
			successCallback : function(e){
				dlt_meetTrip.setJSON(e.responseJSON.fspMeetWorkTimeVoList);
				
				if(dlt_meetTrip.getRowCount() > 0){
					if(dlt_meetTrip.getCellData(0, "date_cls") == "재택근무" && dlt_meetTrip.getCellData(0, "trip_cls") != "근거리출장"){
						com.alert("재택근무 중 근거리출장 시간 외에는 회의에 참석할 수 없습니다.");
						dlt_attend.setRowData(row, [], true);
						return;
					}
					
					scwin.getWorkInfo(row);
				}else{
					// 학생연구원 같이 근태미대상 인원들의 출장 및 휴가를 조회하기 위한 쿼리
					dma_search.set("inqr_clsf", "STUDENT");
										
					com.execute(sbm_selectCwsHumInfo, {
						successCallback : function(e){
							//근태정보조회 후 콜백
							scwin.checkWorkInfo();	
						}
					});
				}
			}
		});
	};
	
	/**
	 * 증빙버튼 클릭 이벤트
	 */
	scwin.btn_evid_onclick = function(e) {		
		biz.fin.pop.open(biz.fin.pop.TYPE.EVID_BILL, {clsf : "MEET"}, function(ret) {
			if(ret){
				scwin.data.vend_nm = ret.vend_nm;
			}
		});
	};
	
	/**
	 * 근태재조회 버튼 클릭 이벤트
	 */
	scwin.btn_searchWork_onclick = function(e) {
		dma_search.set("meet_start_ymd",ica_meet_start_ymd.getValue());
		dma_search.set("meet_start_hour",sbx_meet_start_hour.getValue());
		dma_search.set("meet_cls_hour",sbx_meet_cls_hour.getValue());
		dma_search.set("meet_start_time",sbx_meet_start_hour.getValue() + sbx_meet_start_min.getValue());
		dma_search.set("meet_cls_time",sbx_meet_cls_hour.getValue() + sbx_meet_cls_min.getValue());
		
		com.execute(sbm_selectAttendWorkTime, {
			successCallback : function(e){
				dlt_attend.setJSON(e.responseJSON.fspMeetAttendVoList);	
				
				scwin.grd_attend_disable();
			}
		});
	};
	
	/**
	 * 전자증빙버튼 클릭 이벤트
	 */
	scwin.btn_elecBill_onclick = function(e){		
		var data = {pur_con_user_id : com.getLoginInfo("sn")
				  , pur_con_org_code : com.getLoginInfo("deptCode")
				  , ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.TAXBILL, data, function(retObj) {
		});
	};
	
	/**
	 * 예실 버튼 클릭 이벤트
	 */
	scwin.btn_bugt_onclick = function(e) {
		var accntNo = dma_detl.get("accnt_no");
		var startYr = dma_detl.get("start_ymd").substring(0,4);
		var clsYr = dma_detl.get("cls_ymd").substring(0,4);
		
		// TODO 레포트 출력
		if(!/PD|PL|PQ/.test(accntNo.substring(0,2))){
			var node = "accnt_no=" + accntNo + "&itm_solve_base=" + dma_detl.get("itm_solve_base") + "&res_type=0";
			//OZFlashOpen("/fin/fin/leg/FinAccntInfo01Sel.ozr", "FinAccntInfo01Sel", "Y", node);
			com.oz.openPopup({
				ozrCode: "F006",
				param: node    
	        });
		}else{
			var node = "accnt_fr_ymd=" + startYr + "&accnt_to_ymd=" + clsYr + "&accnt_no=" + accntNo;
			//OZFlashOpen("/fin/bud/frc/BudTrustDetlsSel.ozr", "BudTrustDetlsSel", "Y", node);
			com.oz.openPopup({
				ozrCode: "F007",    
				param: node
	        });
		}		
	};
	
	/**
	 * 반려 버튼 클릭 이벤트
	 */
	scwin.btn_retn_onclick = function(e) {
		com.confirm("반려하시겠습니까?", function(ret){
			com.execute(sbm_updateData, {
				successCallback : function(e) { // 성공 콜백
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
						scwin.search();
					});
				}
			});
		});
	};
	
	/**
	 * 식대횟수 변경 이벤트
	 */
	scwin.spi_meal_cnt_onviewchange = function(info) {
		var cnt = dlt_evid.getMatchedIndex("expns_clsf", "FDV001", true).length;
		var value = com.parseInt(info.newValue);
		if(value > cnt || value < ((cnt == 0)?0 : 1)){
			alert("식대횟수는 " + ((cnt == 0)?0 : 1) + "이상 " + cnt + "이하이어야 합니다.");
			spi_meal_cnt.setValue((com.parseInt(info.oldValue) > cnt)?cnt :com.parseInt(info.oldValue));
		}
	};
	
	/**
	 * 다과횟수 변경 이벤트
	 */
	scwin.spi_refrsh_cnt_onviewchange = function(info) {
		var cnt = dlt_evid.getMatchedIndex("expns_clsf", "FDV002", true).length;
		var value = com.parseInt(info.newValue);

		if(value > cnt || value < ((cnt == 0)?0 : 1)){
			alert("다과비횟수는 " + ((cnt == 0)?0 : 1) + "이상" + cnt + "이하이어야 합니다.");
			spi_refrsh_cnt.setValue((com.parseInt(info.oldValue) > cnt)?cnt :com.parseInt(info.oldValue));
		}
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="grp_page" class="pageWrap">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn" id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox" id="">
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" ev:onclick="scwin.btn_print_onclick">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn" id="btn_retn" style="" type="button" ev:onclick="scwin.btn_retn_onclick">
    					<xf:label><![CDATA[반려]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn" id="btn_slip" style="" type="button" disabled="true" ev:onclick="scwin.btn_slip_onclick">
    					<xf:label><![CDATA[결의생성]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn" id="btn_req_slip" style="" type="button" disabled="true">
    					<xf:label><![CDATA[결의요청]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn" id="btn_meetCopy" style="" type="button" ev:onclick="scwin.btn_copy_onclick">
    					<xf:label><![CDATA[회의록복사]]></xf:label>
    				</xf:trigger>


    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="grp_head" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="근거리출장서 작성자 소속 신청번호"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="" label="" style="" tagname="span" ref="data:dma_detl.req_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="" label="" style="" tagname="span" ref="data:dma_detl.dept_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th" style="">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" style="">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false"
    						id="ica_req_ymd" ref="data:dma_detl.req_ymd" renderDiv="true" rightAlign="false" style="width:150px;" title="작성일자">
    					</w2:inputCalendar>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="계정번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:group style="width:120px;" id="grp_accnt_no" class="inpSch">
    							<xf:input ref="data:dma_detl.accnt_no" adjustMaxLength="false" style="" id="ibx_accnt_no" title="계정번호"
    								class="inp">
    							</xf:input>
    							<xf:trigger ev:onclick="scwin.btn_accntNo_onclick" style="" id="btn_accntNo" title="계정 조회" type="button"
    								class="btn">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input ref="data:dma_detl.accnt_no_nm" adjustMaxLength="false" disabled="true" style="width:140px;"
    							id="ibx_accnt_nm" title="계정명" class="inp">
    						</xf:input>
    						<xf:trigger class="btn" ev:onclick="scwin.btn_bugt_onclick" id="btn_bugt" style="" type="button">
    							<xf:label><![CDATA[예실]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full " disabled="true" id="ibx_accnt_no_nm"
    						ref="data:dma_detl.accnt_rspns_nm" style="width:120px;" title="계정책임자">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="결의생성 담당" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:group class="inpSch" id="grp_slip_manager" style="width: 100px;">
    						<xf:input adjustMaxLength="false" class="inp" ev:onchange="scwin.ibx_slip_empno_onchange"
    							ev:onviewchange="" id="ibx_slip_empno" ref="data:dma_detl.slip_empno" style="" title="결의담당자">
    						</xf:input>
    						<xf:trigger class="btn" ev:onclick="scwin.btn_slip_charger_onclick" id="btn_slip_charger"
    							style="" title="결의담당자 검색" type="button">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    					<xf:input adjustMaxLength="false" class="inp" disabled="true" id="slip_nm" ref="data:dma_detl.slip_nm"
    						style="width:100px;" title="결의담당자 상세">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group id="grp_evid"><xf:group style="" id="" class="titleSection">
    			<w2:textbox tagname="h3" style="" id="" label="지출증빙정보" class="tit_tbl"></w2:textbox>
    			<xf:group style="" id="grp_btn_evid" class="btnarea">
    				<w2:span style="margin-right:10px;" id="tbxEvidMsg" label="* 계산서 또는 현금영수증일 경우 개인지급만 가능합니다. 거래처 지급일 경우 경비결의화면에서 수정해주시기 바랍니다." class="note red">
    				</w2:span>
    				<xf:trigger ev:onclick="scwin.btn_evid_onclick" style="" id="btn_evid" type="button" class="btn">
    					<xf:label><![CDATA[증빙]]></xf:label>
    				</xf:trigger>
    				<xf:trigger ev:onclick="scwin.btn_elecBill_onclick" style="" id="btn_elecBill" type="button" class="btn">
    					<xf:label><![CDATA[전자증빙]]></xf:label>
    				</xf:trigger>
    				<xf:trigger ev:onclick="scwin.btn_plus_onclick" style="" id="btn_plus" type="button" class="bt_plus">
    					<xf:label><![CDATA[추가]]></xf:label>
    				</xf:trigger>
    				<xf:trigger ev:onclick="scwin.btn_minus_onclick" style="" id="btn_minus" type="button" class="bt_minus">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group><w2:gridView ev:ontextimageclick="scwin.grd_evid_ontextimageclick" rowNumVisible="true" rowStatusWidth="50" rowNumHeaderValue="No." scrollByColumn="false" defaultCellHeight="28" rowNumBackgroundColor="#fff" selectedCellColor="#fbf2cd" rowNumWidth="40" evenRowBackgroundColor="#f7faff" autoFit="allColumn" id="grd_evid" class="grid" ev:oncellclick="scwin.grd_evid_oncellclick" scrollByColumnAdaptive="false" editModeEvent="onclick" selectedRowColor="#fbf2cd" summaryAuto="true" readOnly="true" rowStatusHeaderValue="상태" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowStatusVisible="false" dataList="data:dlt_evid" ev:onviewchange="scwin.grd_evid_onviewchange" style="height:106px;" visibleRowNum="5" rowMouseOverColor="#e7f0fb" tooltipDisplay="true">
    			<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
    			<w2:header style="" id="header1">
    				<w2:row style="" id="row1">
    					<w2:column width="40" inputType="text" style="height:28px;" id="column7" value="선택" displayMode="label" fixColumnWidth="true">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column8" value="증빙구분" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column10" value="비용구분" displayMode="label"></w2:column>
    					<w2:column rowSpan="" colSpan="2" width="200" inputType="text" style="height:28px;" id="column69" value="비용코드" displayMode="label">
    					</w2:column>
    					<w2:column rowSpan="" colSpan="" width="150" inputType="text" style="height:28px;" id="column12" value="카드/계산서번호/현금영수증" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column57" value="카드종류" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column16" value="승인번호" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:28px" id="column18" value="승인일시" displayMode="label"></w2:column>
    					<w2:column width="150" inputType="text" style="height:28px" id="column22" value="거래처명" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="column24" value="금액" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column82" value="지급(개인번호)" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column85" value="입금계좌" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column88" value="예금주" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column91" value="은행" displayMode="label"></w2:column>
    					<w2:column rowSpan="" colSpan="2" width="123" inputType="text" style="height:28px;" id="column26" value="결의번호" displayMode="label">
    					</w2:column>
    					<w2:column width="80" inputType="text" style="height:28px" id="column28" value="결재상태" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody style="" id="gBody1">
    				<w2:row style="" id="row2">
    					<w2:column width="40" inputType="checkbox" style="height:28px;" readOnly="false" id="chk" displayMode="label" fixColumnWidth="true">
    					</w2:column>
    					<w2:column chooseOptionLabel="-선택-" ref="" chooseOption="true" width="70" viewType="icon" inputType="select" style="height:28px" readOnly="false" id="evid_clsf" allOption="" value="" displayMode="label">
    						<w2:choices>
    							<w2:item>
    								<w2:label><![CDATA[카드]]></w2:label>
    								<w2:value><![CDATA[1]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[계산서]]></w2:label>
    								<w2:value><![CDATA[2]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[현금영수증]]></w2:label>
    								<w2:value><![CDATA[3]]></w2:value>
    							</w2:item>
    						</w2:choices>
    					</w2:column>
    					<w2:column chooseOptionLabel="-선택-" ref="" chooseOption="true" width="70" viewType="icon" inputType="select" style="height:28px" readOnly="false" id="expns_clsf" allOption="" value="" displayMode="label">
    						<w2:choices></w2:choices>
    					</w2:column>
    					<w2:column width="70" inputType="textImage" style="height:28px" imageSrc="/cm/images/sample/btn_tbsearch02.png" id="expns_cd" value="" displayMode="label" maxLength="3" disabled="true" readOnly="false">
    					</w2:column>
    					<w2:column width="130" inputType="text" style="height:28px" readOnly="true" id="expns_cd_nm" value="" class="le" displayMode="label">
    					</w2:column>
    					<w2:column width="150" inputType="textImage" style="height:28px" readOnly="true" imageSrc="/cm/images/sample/btn_tbsearch02.png" id="evid_no" value="" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="select" style="height:28px" readOnly="true" id="card_knd" value="" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" readOnly="true" id="evid_apprno" value="" displayMode="label" dataType="text">
    					</w2:column>
    					<w2:column dataType="date" width="90" inputType="text" style="height:28px" readOnly="true" id="evid_date" value="" displayMode="label" displayFormatter="scwin.formatDate">
    					</w2:column>
    					<w2:column width="150" inputType="text" style="height:28px" readOnly="true" id="evid_shop" value="" class="le" displayMode="label">
    					</w2:column>
    					<w2:column dataType="number" width="80" displayFormat="#,###" inputType="text" style="height:28px" readOnly="true" id="evid_amt" value="" class="ri" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="textImage" style="height:28px" imageSrc="/cm/images/sample/btn_tbsearch02.png" id="empno" value="" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="bankaccnt_no" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="depstr_nm" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="select" style="height:28px" id="bank" value="" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="link" style="height:28px" readOnly="true" id="unslip_no" value="" displayMode="label">
    					</w2:column>
    					<w2:column width="33" inputType="image" style="height:28px" imageSrc="/cm/images/sample/btn_tbsearch02.png" id="btn_evid" value="" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="select" style="height:28px" readOnly="true" id="apr_state" value="" displayMode="label">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    			<w2:footer style="" id="footer1">
    				<w2:row style="" id="row3">
    					<w2:column rowSpan="" colSpan="4" width="250" inputType="text" style="height:20px;" id="column53" value="합계" displayMode="label">
    					</w2:column>
    					<w2:column width="40" inputType="text" style="height:20px" id="column49" value="" displayMode="label"></w2:column>
    					<w2:column width="150" inputType="text" style="height:20px" id="column59" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column47" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column46" value="" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:20px" id="column45" value="" displayMode="label"></w2:column>
    					<w2:column width="150" inputType="text" style="height:20px" id="column43" value="" displayMode="label"></w2:column>
    					<w2:column expression="sum('evid_amt')" dataType="number" width="80" displayFormat="#,###" inputType="expression" style="height:20px" id="column42" value="" class="ri" displayMode="label">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column84" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column87" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column90" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="text" style="height:20px" id="column93" value="" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:20px" id="column41" value="" displayMode="label"></w2:column>
    					<w2:column width="33" inputType="text" style="height:20px" id="column96" value="" displayMode="label"></w2:column>
    					<w2:column width="80" inputType="text" style="height:20px" id="column40" value="" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:footer>
    		</w2:gridView></xf:group><xf:group id="grp_detls" class="lybox col">
    			<xf:group style="" id="" class="titleSection">
    					<w2:textbox tagname="h3" style="" id="" label="회의정보" class="tit_tbl"></w2:textbox>
    				</xf:group>
    			<xf:group class="w2tb tbl" id="" style="" tagname="table">
    				<w2:attributes>
    					<w2:summary></w2:summary>
    				</w2:attributes>
    				<xf:group tagname="caption" text="회의정보"></xf:group>
    				<xf:group tagname="colgroup">
    					<xf:group style="width:120px;" tagname="col"></xf:group>
    					<xf:group style="width:180px;" tagname="col"></xf:group>
    					<xf:group style="width:120px;" tagname="col"></xf:group>
    					<xf:group style="width:450px;" tagname="col"></xf:group>
    					<xf:group style="width:140px;" tagname="col"></xf:group>
    					<xf:group style="" tagname="col"></xf:group>
    				</xf:group>
    				<xf:group tagname="tr">
    					<xf:group class="w2tb_th" tagname="th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:textbox id="" label="회의번호" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" tagname="td" id="">
    						<w2:attributes></w2:attributes>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_meet_req_no" style="width:120px;" title="회의번호"
    							ref="data:dma_detl.meet_req_no" disabled="true">
    						</xf:input>
    					</xf:group>
    					<xf:group class="w2tb_th" tagname="th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						<w2:textbox id="" label="회의일시" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" tagname="td">
    						<w2:attributes></w2:attributes>
    						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false"
    							id="ica_meet_start_ymd" renderDiv="true" rightAlign="false" style="" title="회의 시작일" ref="data:dma_detl.meet_start_ymd"
    							ev:onviewchange="scwin.ica_meet_start_ymd_onviewchange">
    						</w2:inputCalendar>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="" disabled="false"
    							id="sbx_meet_start_hour" style="width:50px;margin-left: 10px;" submenuSize="auto" chooseOptionLabel="-" visibleRowNum="10"
    							ref="">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[07]]></xf:label>
    									<xf:value><![CDATA[07]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[08]]></xf:label>
    									<xf:value><![CDATA[08]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[09]]></xf:label>
    									<xf:value><![CDATA[09]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[10]]></xf:label>
    									<xf:value><![CDATA[10]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[11]]></xf:label>
    									<xf:value><![CDATA[11]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[12]]></xf:label>
    									<xf:value><![CDATA[12]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[13]]></xf:label>
    									<xf:value><![CDATA[13]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[14]]></xf:label>
    									<xf:value><![CDATA[14]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[15]]></xf:label>
    									<xf:value><![CDATA[15]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[16]]></xf:label>
    									<xf:value><![CDATA[16]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[17]]></xf:label>
    									<xf:value><![CDATA[17]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[18]]></xf:label>
    									<xf:value><![CDATA[18]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[19]]></xf:label>
    									<xf:value><![CDATA[19]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[20]]></xf:label>
    									<xf:value><![CDATA[20]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[21]]></xf:label>
    									<xf:value><![CDATA[21]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    						<w2:textbox class="txt" id="" label="시" style="" tagname="span"></w2:textbox>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="" class="" disabled="false" id="sbx_meet_start_min"
    							style="width:50px;" submenuSize="auto" chooseOptionLabel="-" visibleRowNum="10" ref="">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[00]]></xf:label>
    									<xf:value><![CDATA[00]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[10]]></xf:label>
    									<xf:value><![CDATA[10]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[20]]></xf:label>
    									<xf:value><![CDATA[20]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[30]]></xf:label>
    									<xf:value><![CDATA[30]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[40]]></xf:label>
    									<xf:value><![CDATA[40]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[50]]></xf:label>
    									<xf:value><![CDATA[50]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    						<w2:textbox class="txt" id="" label="분" style="" tagname="span"></w2:textbox>
    						<w2:textbox class="dash" id="" label="~" style="margin-left: 10px;" tagname="span"></w2:textbox>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="" disabled="false"
    							id="sbx_meet_cls_hour" style="width:50px;margin-left: 10px;" submenuSize="auto" chooseOptionLabel="-" visibleRowNum="10">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[07]]></xf:label>
    									<xf:value><![CDATA[07]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[08]]></xf:label>
    									<xf:value><![CDATA[08]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[09]]></xf:label>
    									<xf:value><![CDATA[09]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[10]]></xf:label>
    									<xf:value><![CDATA[10]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[11]]></xf:label>
    									<xf:value><![CDATA[11]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[12]]></xf:label>
    									<xf:value><![CDATA[12]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[13]]></xf:label>
    									<xf:value><![CDATA[13]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[14]]></xf:label>
    									<xf:value><![CDATA[14]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[15]]></xf:label>
    									<xf:value><![CDATA[15]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[16]]></xf:label>
    									<xf:value><![CDATA[16]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[17]]></xf:label>
    									<xf:value><![CDATA[17]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[18]]></xf:label>
    									<xf:value><![CDATA[18]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[19]]></xf:label>
    									<xf:value><![CDATA[19]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[20]]></xf:label>
    									<xf:value><![CDATA[20]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[21]]></xf:label>
    									<xf:value><![CDATA[21]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    						<w2:textbox class="txt" id="" label="시" style="" tagname="span"></w2:textbox>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="" class="" disabled="false" id="sbx_meet_cls_min"
    							ref="data:dma_detl.meet_cls_min" style="width:50px;" submenuSize="auto" chooseOptionLabel="-" visibleRowNum="10">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[00]]></xf:label>
    									<xf:value><![CDATA[00]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[10]]></xf:label>
    									<xf:value><![CDATA[10]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[20]]></xf:label>
    									<xf:value><![CDATA[20]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[30]]></xf:label>
    									<xf:value><![CDATA[30]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[40]]></xf:label>
    									<xf:value><![CDATA[40]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[50]]></xf:label>
    									<xf:value><![CDATA[50]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    						<w2:textbox class="txt" id="" label="분" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_th" tagname="th" style="">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						<w2:textbox id="" label="식대및다과횟수" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" tagname="td" style="">
    						<w2:attributes></w2:attributes>
    						<w2:textbox class="txt" id="" label="식대" style="" tagname="span"></w2:textbox>
    						<w2:spinner buttonSize="30" id="spi_meal_cnt"
    							inputReadOnly="false" min="0" ref="data:dma_detl.meal_cnt" skin="type1" style="position: relative;width: 60px;height: 22px;" ev:onviewchange="scwin.spi_meal_cnt_onviewchange">
    						</w2:spinner>
    						<w2:textbox class="txt" id="" label="다과" style="" tagname="span"></w2:textbox>
    						<w2:spinner buttonSize="30" id="spi_refrsh_cnt"
    							inputReadOnly="false" min="0" ref="data:dma_detl.refrsh_cnt" skin="type1" style="position: relative;width: 60px;height: 22px;" ev:onviewchange="scwin.spi_refrsh_cnt_onviewchange">
    						</w2:spinner>
    					</xf:group>
    				</xf:group>
    				<xf:group style="" tagname="tr">
    					<xf:group class="w2tb_th" style="" tagname="th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						<w2:textbox id="" label="회의장소" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" style="" tagname="td">
    						<w2:attributes>
    							<w2:colspan>5</w2:colspan>
    							<w2:rowspan>1</w2:rowspan>
    						</w2:attributes>
    						<xf:input adjustMaxLength="false" class="inp full " id="" style="" title="회의장소"
    							ref="data:dma_detl.meet_place" maxByteLength="200">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group style="" tagname="tr">
    					<xf:group class="w2tb_th" style="" tagname="th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						<w2:textbox id="" label="회의제목" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" style="" tagname="td">
    						<w2:attributes>
    							<w2:colspan>5</w2:colspan>
    							<w2:rowspan>1</w2:rowspan>
    						</w2:attributes>
    						<xf:input adjustMaxLength="false" class="inp full " id="" style="" title="회의제목"
    							ref="data:dma_detl.meet_subject" maxByteLength="200">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group style="" tagname="tr">
    					<xf:group class="w2tb_th" style="" tagname="th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						<w2:textbox id="" label="회의내용" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" style="" tagname="td">
    						<w2:attributes>
    							<w2:colspan>5</w2:colspan>
    							<w2:rowspan>1</w2:rowspan>
    						</w2:attributes>
    						<xf:textarea id="" style="height: 250px;" ref="data:dma_detl.meet_contents" maxByteLength="4000" class=""
    							title="회의내용">
    						</xf:textarea>
    					</xf:group>
    				</xf:group><!--    	여기서부터 결의생성담당자 기능추가 보완필요			--><!--    	여기까지 결의생성담당자 기능추가 보완필요			-->
    				<xf:group tagname="tr">
    					<xf:group tagname="th" class="w2tb_th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:textbox tagname="span" style="" id="" label="첨부파일"></w2:textbox>
    					</xf:group>
    					<xf:group tagname="td" class="w2tb_td">
    						<w2:attributes>
    							<w2:colspan>5</w2:colspan>
    							<w2:rowspan>1</w2:rowspan>
    						</w2:attributes>
    						<xf:group style="height:125px;">
    							<xf:group class="" id="upload_A" style="height:100%;"></xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>



    			</xf:group>
    		</xf:group>
    		<xf:group id="grp_attend">
    			<xf:group style="" id="" class="titleSection">
    				<xf:group id="" class="le"><w2:textbox tagname="h3" style="" id="" label="회의참석자" class="tit_tbl"></w2:textbox><w2:span style="" id="" label="※ 엑셀업로드시 내외구분은 내부인은 1, 외부인은 2로 입력하세요." class="note red ml10"></w2:span></xf:group><xf:group id="" class="re">
    					<xf:group style="" id="" class="btnarea">
    						<xf:trigger class="btn" id="btn_searchWork" style="" type="button" ev:onclick="scwin.btn_searchWork_onclick">
    							<xf:label><![CDATA[근태재조회]]></xf:label>
    						</xf:trigger>
    						<xf:trigger class="btn" id="btn_meet_attach" style="" type="button"
    							ev:onclick="scwin.btn_meet_attach_onclick">
    							<xf:label><![CDATA[양식 다운로드]]></xf:label>
    						</xf:trigger>
    						<xf:trigger class="btn icon upload" id="btn_excel_upload" style="" type="button"
    							ev:onclick="scwin.btn_excel_upload_onclick">
    							<xf:label><![CDATA[엑셀업로드]]></xf:label>
    						</xf:trigger>
    						<xf:trigger style="" id="btn_attent_plus" type="button" class="bt_plus"
    							ev:onclick="scwin.btn_attent_plus_onclick">
    							<xf:label><![CDATA[추가]]></xf:label>
    						</xf:trigger>
    						<xf:trigger style="" id="btn_attend_minus" type="button" class="bt_minus"
    							ev:onclick="scwin.btn_attend_minus_onclick">
    							<xf:label><![CDATA[삭제]]></xf:label>
    						</xf:trigger>
    					</xf:group>
					</xf:group>    				
    			</xf:group>
    			<w2:gridView scrollByColumnAdaptive="false" rowNumVisible="true" rowStatusWidth="50" selectedRowColor="#fbf2cd"
    				summaryAuto="true" rowNumHeaderValue="No." scrollByColumn="false" defaultCellHeight="28" rowStatusHeaderValue="상태"
    				noResultMessage="조회 결과가 없습니다." rowNumBackgroundColor="#fff" noResultMessageClass="noResult" rowStatusVisible="false"
    				selectedCellColor="#fbf2cd" rowNumWidth="40" dataList="data:dlt_attend" evenRowBackgroundColor="#f7faff" style="height: 85px;"
    				autoFit="allColumn" id="grd_attend" visibleRowNum="5" class="grid" rowMouseOverColor="#e7f0fb"
    				ev:oncellclick="scwin.grd_attend_oncellclick" editModeEvent="onclick" ev:ontextimageclick="scwin.grd_attend_ontextimageclick"
    				ev:onviewchange="scwin.grd_attend_onviewchange">
    				<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
    				<w2:header style="" id="header1">
    					<w2:row style="" id="row1">
    						<w2:column width="40" inputType="text" style="height:28px;" id="column7" value="선택" displayMode="label"
    							fixColumnWidth="true">
    						</w2:column>
    						<w2:column width="60" inputType="text" style="height:28px" id="column8" value="내외구분" displayMode="label"></w2:column>
    						<w2:column width="70" inputType="text" style="height:28px;" id="column10" value="참석자" displayMode="label"
    							colSpan="" rowSpan="">
    						</w2:column>
    						<w2:column width="110" inputType="text" style="height:28px" id="column12" value="시스템개인번호" displayMode="label"
    							hidden="true">
    						</w2:column>
    						<w2:column width="130" inputType="text" style="height:28px" id="column14" value="소속" displayMode="label"></w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="column16" value="직급" displayMode="label"></w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="column18" value="연락처" displayMode="label"></w2:column>
    						<w2:column width="170" inputType="text" style="height:28px" id="column20" value="비고" displayMode="label"></w2:column>
    						<w2:column width="110" inputType="text" style="height:28px;" id="column30" value="식사여부" displayMode="label"
    							colSpan="3" rowSpan="">
    						</w2:column>
    						<w2:column width="80" inputType="text" style="height:28px" id="column22" value="타회의참석횟수" displayMode="label"></w2:column>
    						<w2:column width="100" inputType="text" style="height:28px" id="column24" value="출장정산번호" displayMode="label"></w2:column>
    					</w2:row>
    				</w2:header>
    				<w2:gBody style="" id="gBody1">
    					<w2:row style="" id="row2">
    						<w2:column width="40" inputType="checkbox" style="height:28px;" id="chk" displayMode="label"></w2:column>
    						<w2:column width="60" inputType="select" style="height:28px" id="user_clsf" value="" displayMode="label"
    							allOption="" chooseOption="true" chooseOptionLabel="-선택-" ref="">
    							<w2:choices>
    								<w2:item>
    									<w2:label><![CDATA[내부인]]></w2:label>
    									<w2:value><![CDATA[1]]></w2:value>
    								</w2:item>
    								<w2:item>
    									<w2:label><![CDATA[외부인]]></w2:label>
    									<w2:value><![CDATA[2]]></w2:value>
    								</w2:item>
    							</w2:choices>
    						</w2:column>
    						<w2:column width="70" inputType="textImage" style="height:28px" id="nm" value="" displayMode="label"
    							imageSrc="/cm/images/sample/btn_tbsearch02.png">
    						</w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="syspayno" value="" displayMode="label"></w2:column>
    						<w2:column width="130" inputType="text" style="height:28px" id="dept_nm" value="" displayMode="label"
    							class="le">
    						</w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="posi_nm" value="" displayMode="label"></w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="mobile_no" value="" displayMode="label"></w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="rmk" value="" displayMode="label" class="le"></w2:column>
    						<w2:column width="50" inputType="text" style="height:28px" id="meal_cnt" value="" displayMode="label" readOnly="true"></w2:column>
    						<w2:column width="30" inputType="button" style="height:28px" id="meal_cnt_plus" value="+" displayMode="label"></w2:column>
    						<w2:column width="30" inputType="button" style="height:28px" id="meal_cnt_minus" value="-" displayMode="label"></w2:column>
    						<w2:column width="70" inputType="link" style="height:28px" id="cnt" value="" displayMode="label"></w2:column>
    						<w2:column width="100" inputType="textImage" style="height:28px" id="adjst_req_no" value="" displayMode="label"
    							imageSrc="/cm/images/sample/btn_tbsearch02.png" readOnly="true">
    						</w2:column>
    					</w2:row>
    				</w2:gBody>
    			</w2:gridView>
    		</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick" disabled="true">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
