<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="경비일반결의" meta_programId="FIN_SPM_F201_00D" meta_date="2022.04.21">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            	<w2:dataMap baseNode="map" id="dma_slipH" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="slip_typ_cd" name="결의유형"></w2:key>
            			<w2:key dataType="text" id="wrte_dept" name="작성부서"></w2:key>
            			<w2:key dataType="text" id="wrte_dept_new_ymd" name="작성부서신설일자"></w2:key>
            			<w2:key dataType="text" id="dept_nm" name="작성부서명"></w2:key>
            			<w2:key dataType="text" id="wrte_psn" name="작성자"></w2:key>
            			<w2:key dataType="text" id="empno" name="작성자개인번호"></w2:key>
            			<w2:key dataType="text" id="nm" name="작성자명"></w2:key>
            			<w2:key id="ext_no" name="작성자전화번호" dataType="text"></w2:key>
            			<w2:key dataType="text" id="slip_ymd" name="결의일자"></w2:key>
            			<w2:key dataType="text" id="rmk" name="적요"></w2:key>
            			<w2:key dataType="text" id="decsn_ex" name="확정여부"></w2:key>
            			<w2:key dataType="text" id="decsn_ex_nm" name="확정여부명"></w2:key>
            			<w2:key dataType="text" id="accnt_ymd" name="확정일자"></w2:key>
            			<w2:key dataType="text" id="slip_no" name="확정결의번호"></w2:key>
            			<w2:key dataType="text" id="cud_type" name="CUD타입"></w2:key>
            			<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
            			<w2:key id="approval" name="결재여부" dataType="text"></w2:key>
            			<w2:key id="apr_state" name="결재상태" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_search" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="unslip_odr" name="결의순번"></w2:key>
            			<w2:key dataType="text" id="accnt_cd" name="회계코드"></w2:key>
            			<w2:key dataType="text" id="expns_cd" name="비용코드"></w2:key>
            			<w2:key id="vend_nm" name="거래처명" dataType="text"></w2:key>
            			<w2:key id="relat_no" name="계산서등록자" dataType="text"></w2:key>
            			<w2:key id='slip_typ_cd' name="결의유형" dataType="text"></w2:key>
            			<w2:key id="code_clsf" name="등록자조회종류" dataType="text"></w2:key>
            			<w2:key id="issu_seqno" name="계산서번호" dataType="text"></w2:key>
            			<w2:key id="base_debit_cr" name="차대구분" dataType="text"></w2:key>
            			<w2:key id="inqr_clsf" name="조회구분" dataType="text"></w2:key>
            			<w2:key id="from_ymd" name="등록일자시작일" dataType="text"></w2:key>
            			<w2:key id="to_ymd" name="등록일자종료일" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_slipD" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="fomat_unit" name="편성단위"></w2:column>
            			<w2:column dataType="text" id="journ_cd" name="분개코드"></w2:column>
            			<w2:column dataType="text" id="journ_odr" name="분개순번"></w2:column>
            			<w2:column dataType="text" id="base_debit_cr" name="차대구분"></w2:column>
            			<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
            			<w2:column dataType="text" id="accnt_no_nm" name="계정명"></w2:column>
            			<w2:column dataType="text" id="accnt_rspns" name="계정책임자"></w2:column>
            			<w2:column dataType="text" id="accnt_cd" name="회계코드"></w2:column>
            			<w2:column dataType="text" id="accnt_cd_nm" name="회계코드명"></w2:column>
            			<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
            			<w2:column dataType="text" id="expns_cd_nm" name="비용코드명"></w2:column>
            			<w2:column dataType="text" id="tax_cd" name="과세구분"></w2:column>
            			<w2:column id="mngmt_clsf" name="관리구분" dataType="text"></w2:column>
            			<w2:column dataType="number" id="unslip_amt" name="결의금액"></w2:column>
            			<w2:column dataType="number" id="total_amt" name="총액"></w2:column>
            			<w2:column dataType="number" id="tax_amt" name="세액"></w2:column>
            			<w2:column dataType="text" id="ctrl_no" name="통제번호"></w2:column>
            			<w2:column dataType="text" id="evid_cd" name="증빙코드"></w2:column>
            			<w2:column dataType="text" id="ramt_mngmt_1" name="잔액관리항목1"></w2:column>
            			<w2:column dataType="text" id="ramt_mngmt_2" name="잔액관리항목2"></w2:column>
            			<w2:column dataType="text" id="rmk_1" name="적요"></w2:column>
            			<w2:column dataType="text" id="rmk_2" name="거래처"></w2:column>
            			<w2:column dataType="text" id="attach_file_no" name="첨부파일번호"></w2:column>
            			<w2:column dataType="text" id="pay_clsf" name="지급구분"></w2:column>
            			<w2:column dataType="text" id="occr_slip_no" name="발생결의번호"></w2:column>
            			<w2:column dataType="text" id="occr_slip_odr" name="발생결의순번"></w2:column>
            			<w2:column dataType="text" id="bf_occr_slip_no" name="이전발생결의번호"></w2:column>
            			<w2:column dataType="text" id="bf_occr_slip_odr" name="이전발생결의순번"></w2:column>
            			<w2:column dataType="text" id="accnt_no_clsf" name="계정번호구분"></w2:column>
            			<w2:column dataType="number" id="bf_total_amt" name="이전결의총액"></w2:column>
            			<w2:column dataType="number" id="bf_unslip_amt" name="이전결의금액"></w2:column>
            			<w2:column dataType="text" id="cud_type" name="CUD유형"></w2:column>
            			<w2:column dataType="text" id="evid_yn" name="이지바로 증빙구분"></w2:column>
            			<w2:column dataType="text" id="service_id" name="이지바로 증빙 serviceId"></w2:column>
            			<w2:column id="bill_no" name="계산서번호" dataType="text"></w2:column>
            			<w2:column id="issu_ymd" name="계산서발행일자" dataType="text"></w2:column>
            			<w2:column id="start_ymd" name="시작일자" dataType="text"></w2:column>
            			<w2:column id="cls_ymd" name="종료일자" dataType="text"></w2:column>
            			<w2:column id="itm_solve_base" name="비목해소기준" dataType="text"></w2:column>
            			<w2:column id="itm_clsf" name="비목구분" dataType="text"></w2:column>
            			<w2:column id="unslip_amt_max" name="결의금액맥스값" dataType="text"></w2:column>
            			<w2:column id="req_no" name="신청번호" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="dlt_mngmt" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="mngmt_item_cd" name="관리항목코드"></w2:column>
            			<w2:column dataType="text" id="mngmt_item_nm" name="관리항목이름"></w2:column>
            			<w2:column dataType="text" id="mngmt_detls_cd" name="관리상세코드"></w2:column>
            			<w2:column dataType="text" id="mngmt_detls_nm" name="관리상세명"></w2:column>
            			<w2:column dataType="text" id="essen_ex" name="필수여부"></w2:column>
            			<w2:column dataType="text" id="data_form" name="데이터형식"></w2:column>
            			<w2:column dataType="text" id="cud_type" name="cud타입"></w2:column>
            			<w2:column dataType="text" id="img_detls" name="세부팝업"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_slipD" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="unslip_odr" name="결의순번"></w2:key>
            			<w2:key dataType="text" id="fomat_unit" name="편성단위"></w2:key>
            			<w2:key dataType="text" id="journ_cd" name="분개코드"></w2:key>
            			<w2:key dataType="text" id="journ_odr" name="분개순번"></w2:key>
            			<w2:key dataType="text" id="base_debit_cr" name="차대구분"></w2:key>
            			<w2:key dataType="text" id="accnt_no" name="계정번호"></w2:key>
            			<w2:key dataType="text" id="accnt_no_nm" name="계정명"></w2:key>
            			<w2:key dataType="text" id="accnt_rspns" name="계정책임자"></w2:key>
            			<w2:key dataType="text" id="accnt_cd" name="회계코드"></w2:key>
            			<w2:key dataType="text" id="accnt_cd_nm" name="회계코드명"></w2:key>
            			<w2:key dataType="text" id="expns_cd" name="비용코드"></w2:key>
            			<w2:key dataType="text" id="expns_cd_nm" name="비용코드명"></w2:key>
            			<w2:key dataType="text" id="tax_cd" name="과세구분"></w2:key>
            			<w2:key id="mngmt_clsf" name="관리구분" dataType="text"></w2:key>
            			<w2:key dataType="number" id="unslip_amt" name="결의금액"></w2:key>
            			<w2:key dataType="number" id="total_amt" name="총액"></w2:key>
            			<w2:key dataType="number" id="tax_amt" name="세액"></w2:key>
            			<w2:key dataType="text" id="ctrl_no" name="통제번호"></w2:key>
            			<w2:key dataType="text" id="evid_cd" name="증빙코드"></w2:key>
            			<w2:key dataType="text" id="ramt_mngmt_1" name="잔액관리항목1"></w2:key>
            			<w2:key dataType="text" id="ramt_mngmt_2" name="잔액관리항목2"></w2:key>
            			<w2:key dataType="text" id="rmk_1" name="적요"></w2:key>
            			<w2:key dataType="text" id="rmk_2" name="거래처"></w2:key>
            			<w2:key dataType="text" id="attach_file_no" name="첨부파일번호"></w2:key>
            			<w2:key dataType="text" id="pay_clsf" name="지급구분"></w2:key>
            			<w2:key dataType="text" id="occr_slip_no" name="발생결의번호"></w2:key>
            			<w2:key dataType="text" id="occr_slip_odr" name="발생결의순번"></w2:key>
            			<w2:key dataType="text" id="bf_occr_slip_no" name="이전발생결의번호"></w2:key>
            			<w2:key dataType="text" id="bf_occr_slip_odr" name="이전발생결의순번"></w2:key>
            			<w2:key dataType="text" id="part_all_clsf" name="부분전체구분"></w2:key>
            			<w2:key dataType="text" id="accnt_no_clsf" name="계정번호구분"></w2:key>
            			<w2:key dataType="number" id="bf_total_amt" name="이전결의총액"></w2:key>
            			<w2:key dataType="number" id="bf_unslip_amt" name="이전결의금액"></w2:key>
            			<w2:key dataType="text" id="cud_type" name="CUD유형"></w2:key>
            			<w2:key dataType="text" id="evid_yn" name="이지바로 증빙구분"></w2:key>
            			<w2:key dataType="text" id="service_id" name="이지바로 증빙 serviceId"></w2:key>
            			<w2:key dataType="text" id="validAttachNo" name="유효첨부파일번호"></w2:key>
            			<w2:key id="bill_no" name="계산서번호" dataType="text"></w2:key>
            			<w2:key id="start_ymd" name="시작일자" dataType="text"></w2:key>
            			<w2:key id="cls_ymd" name="종료일자" dataType="text"></w2:key>
            			<w2:key id="itm_solve_base" name="비목해소기준" dataType="text"></w2:key>
            			<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" repeatNode="map" id="dlt_sendreq" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
            			<w2:column id="unslip_odr" name="결의순번" dataType="text"></w2:column>
            			<w2:column id="send_odr" name="송금순번" dataType="text"></w2:column>
            			<w2:column id="pay_clsf" name="지급구분" dataType="text"></w2:column>
            			<w2:column id="send_req_amt" name="송금의뢰금액" dataType="text"></w2:column>
            			<w2:column id="vend_cd" name="거래처코드" dataType="text"></w2:column>
            			<w2:column id="vend_nm" name="거래처명" dataType="text"></w2:column>
            			<w2:column id="syspayno" name="시스템개인번호" dataType="text"></w2:column>
            			<w2:column id="emp_vend" name="개인(거래처)" dataType="text"></w2:column>
            			<w2:column id="bankaccnt_no" name="계좌번호" dataType="text"></w2:column>
            			<w2:column id="bank" name="은행" dataType="text"></w2:column>
            			<w2:column id="depstr_nm" name="예금주명" dataType="text"></w2:column>
            			<w2:column id="bsns_psn_regst_no" name="사업자등록번호" dataType="text"></w2:column>
            			<w2:column id="use_ymd" name="발생일자" dataType="text"></w2:column>
            			<w2:column id="rmk" name="비고" dataType="text"></w2:column>
            			<w2:column id="cud_type" name="CUD타입" dataType="text"></w2:column>
            			<w2:column id="is_account" name="계좌검증" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="dlt_code" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="code" name="코드"></w2:column>
            			<w2:column dataType="text" id="code_nm" name="코드명"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_billsum" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="tot_expns_amt" name="비용합계"></w2:key>
            			<w2:key dataType="text" id="tot_dedct_amt" name="공제합계"></w2:key>
            			<w2:key dataType="text" id="tot_send_amt" name="송금합계"></w2:key>
            			<w2:key id="tot_evid_amt" name="거래증빙합계" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_bill">
            		<w2:keyInfo>
            			<w2:key id="issu_seqno" name="계산서번호" dataType="text"></w2:key>
            			<w2:key id="bsns_psn_regst_no" name="사업자번호" dataType="text"></w2:key>
            			<w2:key id="regs_date" name="발행일자" dataType="text"></w2:key>
            			<w2:key id="vend_nm" name="가맹점" dataType="text"></w2:key>
            			<w2:key id="totl_amt" name="총액" dataType="number"></w2:key>
            			<w2:key id="chrg_amt" name="공급가액" dataType="number"></w2:key>
            			<w2:key id="tax_amt" name="과세금액" dataType="number"></w2:key>
            			<w2:key id="un_amt" name="미처리금액" dataType="number"></w2:key>
            			<w2:key id="bankaccnt_no" name="계좌번호" dataType="text"></w2:key>
            			<w2:key id="evid_cd" name="증빙코드" dataType="text"></w2:key>
            			<w2:key id="depstr_nm" name="예금주" dataType="text"></w2:key>
            			<w2:key id="bank" name="은행" dataType="text"></w2:key>
            			<w2:key id="vend_cd" name="거래처코드" dataType="text"></w2:key>
            			<w2:key id="note3" name="노트3" dataType="text"></w2:key>

            			<w2:key id="detail_yn" name="계산서디테일등록여부" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_bill" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="issu_seqno" name="계산서번호"></w2:column>
            			<w2:column dataType="text" id="tran_stop_yn" name="거래중지여부"></w2:column>
            			<w2:column dataType="text" id="bsns_psn_regst_no" name="사업자번호"></w2:column>
            			<w2:column dataType="text" id="regs_date" name="작성일자"></w2:column>
            			<w2:column dataType="text" id="vend_nm" name="가맹점"></w2:column>
            			<w2:column id="totl_amt" name="총액" dataType="number"></w2:column>
            			<w2:column dataType="number" id="chrg_amt" name="공급가액"></w2:column>
            			<w2:column dataType="number" id="tax_amt" name="과세금액"></w2:column>
            			<w2:column dataType="number" id="un_amt" name="미처리금액"></w2:column>
            			<w2:column dataType="text" id="bankaccnt_no" name="계좌번호"></w2:column>
            			<w2:column dataType="text" id="evid_cd" name="증빙코드"></w2:column>
            			<w2:column dataType="text" id="depstr_nm" name="예금주"></w2:column>
            			<w2:column dataType="text" id="bank" name="은행"></w2:column>
            			<w2:column id="vend_cd" name="거래처코드" dataType="text"></w2:column>
            			<w2:column id="note3" name="노트3" dataType="text"></w2:column>
            			<w2:column id="detail_yn" name="계산서디테일등록여" dataType="text"></w2:column>
            			<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_cnt" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="cnt" name="개수"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" repeatNode="map" id="dlt_check" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="unslip_no" name="결의번호" dataType="text"></w2:column>
            			<w2:column id="unslip_odr" name="결의순번" dataType="text"></w2:column>
            			<w2:column id="serviceId" name="서비스id" dataType="text"></w2:column>
            			<w2:column id="chk_yn" name="체크YN" dataType="text"></w2:column>
            			<w2:column id="accnt_no" name="계정번호" dataType="text"></w2:column>
            			<w2:column id="expns_cd" name="비용코드" dataType="text"></w2:column>
            			<w2:column id="expns_cd_nm" name="비용코드명" dataType="text"></w2:column>
            			<w2:column id="chk_cnt" name="체크개수" dataType="text"></w2:column>
            			<w2:column id="rtn_msg" name="리턴메시지" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" repeatNode="map" id="dlt_account" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="bank_cd" name="은행코드" dataType="text"></w2:column>
            			<w2:column id="bankaccnt_no" name="계좌번호" dataType="text"></w2:column>
            			<w2:column id="syspayno" name="시스템개인번호" dataType="text"></w2:column>
            			<w2:column id="service_id" name="서비스아이디" dataType="text"></w2:column>
            			<w2:column id="iche_amt" name="이체금액" dataType="text"></w2:column>
            			<w2:column id="acnm_no" name="생년월일 혹은 사업자번호" dataType="text"></w2:column>
            			<w2:column id="depstr_nm" name="예금주" dataType="text"></w2:column>
            			<w2:column id="res_data" name="예금주" dataType="text"></w2:column>
            			<w2:column id="success" name="성공여부" dataType="text"></w2:column>
            			<w2:column id="is_account" name="검증여부" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
            <!-- 결의내역 조회 -->
        	<xf:submission id="sbm_selectSlip" ref="data:json,dma_search"
        		target='data:json,[{"id":"dma_slipH","key":"slipHVo"},{"id":"dlt_slipD","key":"slipDList"},{"id":"dma_billsum","key":"evidSumVo"}]'
        		action="SvcFINSPMEXPR09.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 계산서사용내역 조회 -->
        	<xf:submission id="sbm_selectBillInfoList" ref="data:json,dma_search"
        		target='' action="SvcFINSPMEXPR08.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 저장 -->
        	<xf:submission id="sbm_saveSlip"
        		ref='data:json,[{"id":"dma_slipH", "key":"slipHVo"},{"id":"dma_slipD", "key":"slipDVo"},{"action":"modified","id":"dlt_sendreq", "key":"sendList"},{"action":"modified","id":"dlt_mngmt", "key":"mngmtList"}]'
        		target='data:json,dma_search' action="SvcFINSPMEXPM01.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>        	
        	<!-- 회계코드별 관리항목 조회 -->
        	<xf:submission id="sbm_selectMngmtItem" ref="data:json,dma_search" target='data:json,{"id":"dlt_mngmt","key":"mngmtVo"}'
        		action="SvcFINSPMEXPR04.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 관리항목 및 계산서정보,송금내역 -->
        	<xf:submission id="sbm_selectSlipMngmt" ref="data:json,dma_search" target='data:json,[{"id":"dlt_mngmt", "key":"mngmtList"},{"id":"dma_bill", "key":"billVo"},{"id":"dlt_sendreq", "key":"sendList"}]' action="SvcFINSPMEXPR07.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결의서 삭제 -->
        	<xf:submission id="sbm_deleteSlip" ref="data:json,dma_slipD" target='' action="SvcFINSPMEXPD01.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 이지바로 과제 증빙개수 조회 -->
        	<xf:submission id="sbm_selectItmEvidDetlsCnt" ref="data:json,dma_search" target='data:json,dma_cnt' action="SvcFINSPMEXPR06.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 계산서 등록자 조회 -->
        	<xf:submission id="sbm_selectCodeList" ref="data:json,dma_search" target='data:json,{"id":"dlt_code","key":"codeNmList"}' 
        	    action="SvcFINCOMCODR01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결재신청전 체크 -->
        	<xf:submission id="sbm_selectPreAprCheck" ref="data:json,dma_search" target='data:json,{"id":"dlt_check","key":"checkList"}' 
        	    action="SvcFINSPMEXPR15.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	
        </xf:model>
        <script src="/cm/js/biz/fin.js" cache="false" />
        <script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 경비결의(일반) 생성
	 * 변경 이력 : 2022-04-27	이영희	최초 작성
	 * serviceId : F201
	 ****************************************************/
	// 전자증빙
	scwin.evidParam = {
		doc_id : "113"
	};

	scwin.data = {
		today : com.getServerDateTime(),
		typeCode : "F201",
		odr : [],
		allowExtension : "PDF,ppt,pptx,pptm,pps,ppsx,xls,xlsx,xlsm,doc,docx,docm,rif,txt,hwp,url,mht,mhtml,htm,html,jpg,jpeg,tif,tiff,gif,png,bmp"
	};

	scwin.onpageload = function() {
		// 첨부파일 컴포넌트 초기화
		com.file.init();
		
		// parameter setting
		var param = com.getParameter();
		dma_search.setJSON(param);
		
		var session = com.getLoginInfo();
		
		//화면 권한 체크
		com.biz.checkRole({serviceId : "F201", roleCodes : session.roleCode}, function(e){
			if(e.isRoleYn){
				inputEmpNo.setDisabled(false);
				btn_emp.setDisabled(false);
			}else{
				inputEmpNo.setDisabled(true);
				btn_emp.setDisabled(true);
			}
		});

		// 신규 등록에 사용하는 dataMap 빈값으로 초기화
		com.initDataMap(dma_slipD);
		// 변경사항 체크
		//scwin.checkList = [dma_slipD];

		// enter key event
		com.setEnterKeyEvent(grp_accnt_no, scwin.btn_accntNo_onclick);
		com.setEnterKeyEvent(grp_expns_cd, scwin.btn_expns_onclick);
		com.setEnterKeyEvent(grp_wrte_psn, scwin.btn_emp_onclick);
		com.setEnterKeyEvent(grp_bill, scwin.btn_billSrc_onclick);
		
		dma_search.set("slip_typ_cd", "113");
		
		// 증빙정보 버튼 숨기기(이지바로 과제일 경우에만 보임)
		btn_evidInfo.hide();
		tbxEvidMsg.hide();
		btn_confrHis.hide();		
		
		// 공통코드
		var codeOptions = [ { code : "FAX", compID :"grd_sendreq:pay_clsf", filter:"mngmtItem3=='P'"  }
		                   ,{ code : "FAA", compID :"grd_sendreq:bank"}
		                ];
		com.setCmnCd(codeOptions, function() {
		});

		//날짜설정관련 
		var now = new Date();
		var year = now.getFullYear();
		var month = now.getMonth();
		var firstDate = new Date(year, month - 2, 1);
		var lastDate = scwin.data.today;
		
		//등록일자 최근 3개월 디폴트 조회를 위한 세팅
		dma_search.set("from_ymd", scwin.getDateStr(firstDate));
		dma_search.set("to_ymd", lastDate);
		
		// 등록자
		dma_search.set("code_clsf", "emp_info");
		com.execute(sbm_selectCodeList, {
			successCallback : function(e){
				acb_relat.setValue(session.sn);
			}
		});

		// 이전화면에서 파라미터 받음
		if(param.param4 == "apr"){
			dma_search.set("unslip_no", param.req_no);
		}
		
		if (dma_search.get("unslip_no") != "") {
			scwin.evidParam.req_no = dma_search.get("unslip_no");

			//조회실행
			scwin.search();
		} else {		
			com.initDataMap(dma_slipH);
			// 첨부파일
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});	

			dma_slipH.set("slip_typ_cd", "113");
			dma_slipH.set("cud_type", "C");
			
			dma_slipH.set("wrte_psn", session.sn);
			dma_slipH.set("nm", session.cn);
			dma_slipH.set("empno", session.empno);
			dma_slipH.set("wrte_dept", session.deptCode);
			dma_slipH.set("wrte_dept_new_ymd", session.deptNewYmd);
			dma_slipH.set("dept_nm", session.deptName);
			
			dma_slipH.set("slip_ymd", scwin.data.today);	
			
			// 회의록에서 호출(계산서 번호 넘겨줌)
			if(param.issu_seqno != undefined && param.issu_seqno != ""){
				scwin.data.meetYn = true;
				btn_billSrc.trigger("click");
			}		
		}
	};

	scwin.onpageunload = function() {
	};
	
	//날짜구하기
	scwin.getDateStr = function(date) {
	    var sYear = date.getFullYear();
	    var sMonth = date.getMonth() + 1;
	    var sDate = date.getDate();
	
	    sMonth = sMonth > 9 ? sMonth : "0" + sMonth;
	    sDate  = sDate > 9 ? sDate : "0" + sDate;
	    return String(sYear) + String(sMonth) + String(sDate);
	}
	
	
	/**
	 * 결의서  조회
	 */
	scwin.search = function() {
		com.execute(sbm_selectSlip, {
			successCallback : function(e) {
				tbx_cnt.setValue(dlt_slipD.getRowCount());
				
				btn_print.setDisabled(false);
				btn_evid_view.setDisabled(false);
				
				if (dma_slipH.get("decsn_ex") == "Y") {
					btn_save.setDisabled(true);
					btn_del.setDisabled(true);
					btn_apr.setDisabled(true);
					rad_accnt_clsf.setDisabled(true);
				}else{
					//TODO
					com.biz.disabledButtons(dma_slipH.get("apr_state"), dma_slipH.get("unslip_no"));
				}
				grd_slipd.setFocusedCell(0,0);
				scwin.setSlipD(0);
			}
		});
	};

	/**
	 * 관리항목 조회
	 */
	scwin.setMngmt = function(accntCd) {
		dma_search.set("accnt_cd", accntCd);
		if(rad_accnt_clsf.getValue() == '4'){
			dma_search.set("base_debit_cr", '2');	
		}else{
			dma_search.set("base_debit_cr", '1');
		}

		com.execute(sbm_selectMngmtItem, {
			successCallback : function(e) {
				if(rad_accnt_clsf.getValue() != '4'){
					var rows = dlt_mngmt.getRowCount();
					dlt_mngmt.insertRow(rows);
					dlt_mngmt.setCellData(rows, "mngmt_item_cd", "4043");
					dlt_mngmt.setCellData(rows, "mngmt_item_nm", "납기일자");				
				}				
				
				scwin.setGrdMngmt(); // 관리항목 버튼 제어
			}
		});
	}

	/**
	 * 공통코드 팝업 오픈
	 */
	scwin.openCommCdPop = function(cdClsf) {
		com.openCmnCdPop(cdClsf, {
			srchWord : cdClsf,
			selectCallback : function(retObj) {
				dlt_mngmt.setCellData(grd_mngmt.getFocusedRowIndex(), "mngmt_detls_cd", retObj.values); // value 셋팅
				dlt_mngmt.setCellData(grd_mngmt.getFocusedRowIndex(), "mngmt_detls_nm", retObj.labels); // label 셋팅
			}
		});
	};

	/**
	 * 관리항목 그리드 셋팅
	 */
	scwin.setGrdMngmt = function(clsf) {
		var accntNo = dma_slipD.get("accnt_no");
		
		for (var i = 0; i < dlt_mngmt.getRowCount(); i++) {
			if(clsf == undefined){
				dlt_mngmt.setCellData(i, "cud_type", "C");
			}
			// 2022.11.10. 관리항목 직접 입력가능하게 변경(구본준 요청)
			if (/popup|dropdown/.test(dlt_mngmt.getCellData(i, "data_form"))) {
				//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
				grd_mngmt.setCellReadOnly(i, "img_detls", false);
			} else {
				//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
				grd_mngmt.setCellReadOnly(i, "img_detls", true);
			}
			
			if(clsf != "U"){
				switch(dlt_mngmt.getCellData(i, "mngmt_item_cd")){
					case "3001"	:
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("rmk_2"));
						break;
					case "1001"	:
						if(/^FF21/.test(accntNo) && accntNo != "FF210001"){
							dlt_mngmt.setCellData(i, "mngmt_detls_cd", accntNo.substring(2,8));
							grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
							grd_mngmt.setCellReadOnly(i, "img_detls", true);
						}else{
							grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
						}
						break;
					default : break;
				}
			}
		}
	}

	/**
	 * 전자증빙에서 req_no 입력 후 호출
	 */
	scwin.setMngmtDetls = function(mngmtItemCd, reqNo) {
		for (var i = 0; i < dlt_mngmt.getRowCount(); i++) {
			if (dlt_mngmt.getCellData(i, "mngmt_item_cd") == mngmtItemCd) {
				dlt_mngmt.setCellData(i, "mngmt_detls_cd", reqNo);
			}
		}
	}	

	/**
	 * 과세계정여부에 따라서 결의금액 셋팅
	 */
	scwin.setUnslipAmt = function(taxCd) {
		var taxAmt = Number(dma_bill.get("tax_amt")); 
		var suplyValue = Number(dma_bill.get("chrg_amt"));
		var totalAmt = Number(inputTotalAmt.getValue());		
		
		if (taxCd == "FTX001") {
			if (taxAmt > 0) {
				// 과세금액 + 공급가액이 총액(미처리금액)과 다를 경우
				if (taxAmt + suplyValue != inputTotalAmt.getValue()) {
					inputUnslipAmt.setValue(Math.floor(totalAmt * 10 / 11));
					inputTaxAmt.setValue(totalAmt - Number(inputUnslipAmt.getValue()));
				} else { 
					inputUnslipAmt.setValue(suplyValue);
					inputTaxAmt.setValue(taxAmt);
				}
			} else { 
				inputUnslipAmt.setValue(totalAmt);
				inputTaxAmt.setValue(0);
			}
		} else { // 비과세일 경우
			inputUnslipAmt.setValue(totalAmt);
			inputTaxAmt.setValue(0);
		}
	};

	/**
	 * 예산잔액 조회
	 */
	scwin.getBugtRamtAmt = function() {
		if(rad_accnt_clsf.getValue() == '4') return;
		
		var relatNo = "";
		if(/^FF21/.test(dma_slipD.get("accnt_no")) && dma_slipD.get("accnt_no") != "FF210001"){
			relatNo = dma_slipD.get("accnt_no").substring(2,8);
		}else{
			relatNo = dma_slipD.get("accnt_rspns").substring(2,8);
		}
		
		var data = {
			bugt_yr : dma_slipH.get("slip_ymd").substring(0, 4),
			accnt_no : dma_slipD.get("accnt_no"),
			accnt_cd : dma_slipD.get("accnt_cd"),
			relat_no : relatNo
		}

		var reqAmt = Number(dma_slipD.get("unslip_amt")) - Number(dma_slipD.get("bf_unslip_amt"));
		com.biz.checkBugtRamt(data, function(retObj){
			if(retObj.bugt_amt == 0){
				if(retObj.bugt_ctrl_way == undefined || retObj.bugt_ctrl_way != "FAF021" ){ // FAF021 내역통제
					com.alert("message.xom.ui.fin.022");
					inputBugtRamtAmt.setValue(0)
				}
			}else{
				var ramtAmt = Number(retObj.bugt_amt) - Number(retObj.cause_amt) - Number(retObj.enfrc_amt) - reqAmt;
				inputBugtRamtAmt.setValue(ramtAmt);
			}			
		});	
	}
	
	/**
	 * 결의서 관리항목, 송금내역, 계산서 조회
	 */
	scwin.searchSlipMngmt = function(){
		dma_search.set("accnt_cd", dma_slipD.get("accnt_cd"));
		dma_search.set("base_debit_cr", dma_slipD.get("base_debit_cr"));
		com.execute(sbm_selectSlipMngmt, {
			successCallback : function(e) {		
				scwin.setGrdMngmt("U");	
				
				for(var i=0; i<dlt_sendreq.getRowCount(); i++){
					scwin.setGrdSendreq(i, dlt_sendreq.getCellData(i, "pay_clsf"));
				}	
			}
		});
	};
	
	/**
	 * 그리드 디테일 setting
	 */
	scwin.setSlipD = function(row){
		// button 제어 
		btn_accntNo.hide();
		btn_expns.hide();
		inputAccntNo.setDisabled(true);
		inputExpnsCd.setDisabled(true);		
		
		dma_slipD.setJSON(dlt_slipD.getRowJSON(row));		
		
		var accntNo = dma_slipD.get("accnt_no");
		var expnsCd = dma_slipD.get("expns_cd");
		
		if(dma_slipD.get("base_debit_cr") == '2'){
			rad_accnt_clsf.setValue('4'); // 공제
			grp_dedct.show("");
			grp_gen.hide()
		}else{
			if(biz.fin.CONST.CON_ACCNT_REG.test(accntNo.substring(0, 3))){
				rad_accnt_clsf.setValue('3'); // 수탁
			}else{
				rad_accnt_clsf.setValue('1');
			}
			grp_dedct.hide();
			grp_gen.show("")
		}
		
		// 첨부파일
		if(dma_slipD.get("attach_file_no") != ""){
			com.file.create(upload_A.getID(), {fileKey: dma_slipD.get("attach_file_no"), mode: 'edit', allowExtension : scwin.data.allowExtension});	
		}else{
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});	
		}		
		
		if(expnsCd == "235"){
			btn_confrHis.show("");	
		}else{
			btn_confrHis.hide();
		}
		
		// 관리항목 및 계산서내역 조회
		dma_search.set("unslip_odr", dma_slipD.get("unslip_odr"));
		dma_search.set("issu_seqno", dma_slipD.get("bill_no"));
		// 관리항목, 계산서사용내역, 이지바로
		scwin.searchSlipMngmt();
		
		if(rad_accnt_clsf.getValue() != '4'){
			// 전자증빙 조회
			scwin.evidParam.expns_cd = expnsCd;
			scwin.evidParam.unslip_odr = dma_slipD.get("unslip_odr");
			scwin.evidParam.req_no = dma_slipD.get("unslip_no");
			
			if(/322|262|431/.test(expnsCd) && accntNo.substring(0, 4) == "FF21"){				
				if(accntNo == "FF210001"){
					scwin.evidParam.expns_cd = "FF1";
				}else{
					scwin.evidParam.expns_cd = "FF2";
				}
			}
					
			wfm_evid.getWindow().scwin.evid_select(scwin.evidParam);	
			
			// 2017.10.24. 이지바로과제일 경우 회의록 참조하여 fspitmeviddetls저장, 비용코드 410, 411일 때
			if(dma_slipD.get("evid_yn") == "Y"){
				dma_search.set("expns_cd", expnsCd);
				btn_evidInfo.show("");

				com.execute(sbm_selectItmEvidDetlsCnt, {
					successCallback : function(e){
						if(dma_cnt.get("cnt") == 0){
							btn_evidInfo.trigger("click");
						}
					}
				});
			}else{
				btn_evidInfo.hide();
				tbxEvidMsg.hide();
			}
		}
	}

	//------------------------------------------------------------------------------------------------------------------  event

	/**
	 * 계산서 정보 조회 버튼 클릭 이벤트
	 */
	scwin.btn_billSrc_onclick = function(e) {
		dlt_bill.removeAll();
		dlt_bill.reform();

		if(!scwin.data.meetYn){
			if (dma_search.get("relat_no") == "" && dma_search.get("vend_nm") == "") {
				com.alert(com.getMsg("message.xom.ui.fin.026", "등록자, 거래처"));
				return;
			}

			if((dma_search.get("from_ymd") == "" && dma_search.get("to_ymd") != "") 
				||(dma_search.get("from_ymd") != "" && dma_search.get("to_ymd") == "")) {
				com.alert("등록일자를 조건으로 검색하시려면\n시작일과 종료일을 모두 입력해주세요.");
				return;
			}
			
			dma_search.set("issu_seqno", "");	
		}else{
			if(dma_search.get("issu_seqno") == ""){
				com.alert(com.getMsg("message.xom.co.com.0007", "계산서번호"));
				return;
			}
		}
		
		// 01. 결의서 디테일, 관리항목, 송금내역, 전자증빙 dataset 초기화
		scwin.reformData();		
		
		com.execute(sbm_selectBillInfoList, {
			successCallback : function(e) {
				dlt_bill.setJSON(e.responseJSON.elData.billList);
				if(dlt_bill.getRowCount() == 1){
					grd_bill.setFocusedCell(0,0);
				}
			}
		});
	};
	
	/**
	 * 결의서 디테일, 관리항목, 송금내역, 전자증빙 dataset 초기화
	 */
	scwin.reformData = function(){
		dma_slipD.setEmptyValue();
		dma_bill.setEmptyValue();
		dlt_mngmt.removeAll();
		dlt_sendreq.removeAll();
		dlt_sendreq.reform();			
		
		com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});
		
		scwin.evidParam={};		
		scwin.evidParam.doc_id ="113";
		wfm_evid.getWindow().dlt_attach.removeAll();
	};

	/**
	 * 계산서정보 그리드 row index change event
	 */
	scwin.changeGrdBill = function(row) {
		if(dlt_bill.getCellData(row,"tran_stop_yn") == "N"){
			com.alert("message.xom.ui.fin.023");
			return;	
		}
		// 01. 결의서 디테일, 관리항목, 송금내역, 전자증빙 dataset 초기화
		scwin.reformData();
		
		// 02. 신규입력시 버튼 제어
		btn_accntNo.show("");
		btn_expns.show("");
		inputAccntNo.setDisabled(false);
		inputExpnsCd.setDisabled(false);
		
	    //03. 계산서정보 dataset
		dma_bill.setJSON(dlt_bill.getRowJSON(row));

		var evidCd = dma_bill.get("evid_cd");
		if(/FAH011|FAH031|FAH612/.test(evidCd)){
			tbx_evid_title.setValue("계산서 번호");
		}else if(evidCd == "FAH411"){
			tbx_evid_title.setValue("영수증 번호");
		}else if(evidCd == "FAH611"){
			tbx_evid_title.setValue("지로 번호");
			
			// 송금내역 셋팅
			var idx = dlt_sendreq.insertRow();
			dlt_sendreq.setCellData(idx, "depstr_nm", dma_bill.get("depstr_nm"));
			dlt_sendreq.setCellData(idx, "pay_clsf", "FAX100");
			dlt_sendreq.setCellData(idx, "send_req_amt", dma_bill.get("un_amt"));
			dlt_sendreq.setCellData(idx, "vend_nm", dma_bill.get("vend_nm"));
			dlt_sendreq.setCellData(idx, "vend_cd", dma_bill.get("vend_cd"));
			
			if(idx > 0){
				dlt_sendreq.setCellData(idx, "send_odr", parseInt(dlt_sendreq.getCellData(0, "send_odr"))+ 1);
			}else{
				dlt_sendreq.setCellData(idx, "send_odr", 1);
			}
			
		}else if(evidCd == "FAH999"){
			tbx_evid_title.setValue("문서번호");
		}
		
		inputSumAmt.setValue(dma_bill.get("chrg_amt") + dma_bill.get("tax_amt"));
		
		// 04. 결의서 디테일
		dma_slipD.set("cud_type", "C");
		// 예산잔액 초기화
		inputBugtRamtAmt.setValue(0);

		// 결의서 디테일 셋팅
		dma_slipD.set("total_amt", dma_bill.get("un_amt"));
		dma_slipD.set("bf_total_amt", 0);
		dma_slipD.set("bf_unslip_amt", 0);			
		dma_slipD.set("evid_cd", evidCd);
		dma_slipD.set("bill_no", dma_bill.get("issu_seqno"));
		dma_slipD.set("bsns_psn_regst_no", dma_bill.get("bsns_psn_regst_no"));		
		dma_slipD.set("rmk_2", dma_bill.get("vend_nm"));		
		dma_slipD.set("base_debit_cr", "1");		
		
		// 결의금액 셋팅
		var taxCd = "FTX002";
		if(dma_bill.get("tax_amt") > 0){
			taxCd = "FTX001";
		}
		scwin.setUnslipAmt(taxCd);		
	};
	
	/**
	 * 계산서정보 그리드 셀클릭 이벤트
	 */
	scwin.grd_bill_oncellclick = function(row,col,colId) {
		if(colId == "btn_view"){
			var data={};
			
			if(dlt_bill.getCellData(row, "issu_seqno").length == 24){
				data.issu_id = dlt_bill.getCellData(row, "issu_seqno");
				data.mode = "view";		
				data.ref_yn="Y";
				com.pop.open(com.pop.TYPE.TAXBILL, data, function(retObj) {
				});
			}else{
				data.issu_seqno = dlt_bill.getCellData(row, "issu_seqno");
				data.unslip_no = dlt_bill.getCellData(row, "unslip_no").trim();
				
				biz.fin.pop.open(biz.fin.pop.TYPE.EVID_BILL, data, function(ret) {
					dma_search.set("vend_nm", ret.vend_nm);
					dma_search.set("issu_seqno", ret.issu_seqno);					
					
					if(dma_search.get("issu_seqno") != ""){
						dma_search.set("relat_no", "");
					}
					btn_billSrc.trigger("click");
				});
			}
		}else if(colId == "issu_seqno"){
			scwin.changeGrdBill(row);
		}
	};

	/**
	 * 계정번호 검색팝업
	 */
	scwin.btn_accntNo_onclick = function(e) {
		if (dma_slipD.get("bill_no") == "") {
			com.alert(com.getMsg("message.xom.ui.fin.002" ,"거래증빙내역")); /*먼저 거래증빙내역을 선택하세요.*/
			return;
		}	
		
		scwin.getAccntNo();	
	};
	
	/**
	 * 계정번호 조회
	 */
	scwin.getAccntNo = function(){
		var data = {
			accnt_no : inputAccntNo.getValue()
		};
			
		// parameter setting
		data.cls_yr = dma_slipH.get("slip_ymd").substring(0, 4);
		data.clsf = (rad_accnt_clsf.getValue() == '3') ? "con" : "gen";
		data.ref_yn = (inputAccntNo.getValue() == '')?"Y":"N";
		
		com.pop.open(com.pop.TYPE.ACNNO, data, function(retObj) {
			if (retObj) {
				if (!scwin.check(retObj, 0))
					return;

				dma_slipD.set("accnt_no", retObj.accnt_no);
				dma_slipD.set("accnt_no_nm", retObj.accnt_no_nm);
				dma_slipD.set("accnt_rspns", retObj.accnt_rspns);
				dma_slipD.set("fomat_unit", retObj.fomat_unit);
				dma_slipD.set("itm_solve_base", retObj.itm_solve_base);

				dma_slipD.set("expns_cd", "");
				dma_slipD.set("expns_cd_nm", "");
				dma_slipD.set("accnt_cd", "");
				dma_slipD.set("accnt_cd_nm", "");
				dma_slipD.set("tax_cd", retObj.tax_cd);
				dma_slipD.set("accnt_no_clsf", retObj.card_use_ex);
				scwin.data.evid_chk = retObj.evid_chk; // 증빙여부
				scwin.data.exclsv_agncy = retObj.bsns_cd_exclsv_agncy;
				dma_slipD.set("mngmt_clsf", retObj.mngmt_clsf);
				dma_slipD.set("evid_yn", retObj.evid_yn);

				// 결의금액 셋팅
				scwin.setUnslipAmt(retObj.tax_cd);
			}
		});	
	}

	/**
	 * 계정번호 blur event
	 */
	scwin.inputAccntNo_onblur = function(e) {
		var arr = ["accnt_rspns", "accnt_no_nm", "accnt_rspns", "fomat_unit"];
		arr.forEach(function(el, index) {
			dma_slipD.set(el, "");
		});
	};

	/**
	 * 저장
	 */
	scwin.btn_save_onclick = function(e) {	
		scwin.data.aprYn = "N";
		dma_slipH.set("approval", "false");
				
		// 저장 전 체크	
		if (!scwin.validateData()) return;
		if (!scwin.checkPreSave()) return;
		
		// 예산잔액 체크
		if(inputBugtRamtAmt.getValue() < 0){
			com.confirm("message.xom.ui.fin.033"/*예실잔액이 부족합니다. 저장 하시겠습니까?*/, function(ret){
				if(ret) scwin.save();
			});
		}else{
			com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
				if(ret) scwin.save();
			});
		}					
	};
	
	/**
	 * 필수입력값 체크
	 */
	scwin.validateData = function(){
		// 필수입력값 체크
		var validData = [
			{dataObj : dma_slipH, valInfoArr :[
				 { id : "slip_ymd", mandatory : true}
				,{ id : "slip_typ_cd", mandatory : true } 
				,{ id : "wrte_psn", mandatory : true } 
				,{ id : "wrte_dept", mandatory : true } 
				,{ id : "rmk", mandatory : true }
				], isCheckModified : false
			},
			{dataObj : dma_slipD, valInfoArr :[
				 { id : "journ_cd", mandatory : true}
				,{ id : "base_debit_cr", mandatory : true } 
				,{ id : "accnt_no", mandatory : true, allowChar : "A-Z0-9" } 
				,{ id : "accnt_rspns", mandatory : true } 
				,{ id : "accnt_cd", mandatory : true } 
				,{ id : "expns_cd", mandatory : true } 
				,{ id : "total_amt", mandatory : true, allowChar : "0-9"} 
				,{ id : "unslip_amt", mandatory : true, allowChar : "0-9" } 
				,{ id : "tax_amt", mandatory : true, allowChar : "0-9" } 
				,{ id : "rmk_1", mandatory : true } 
				,{ id : "rmk_2", mandatory : true } 
				,{ id : "bill_no", mandatory : true }  
				], isCheckModified : false
			}
		];
		
		if(rad_accnt_clsf.getValue() == '4'){ // 공제일 경우 결의금액과 과세금액 셋팅
			dma_slipD.set("unslip_amt", dma_slipD.get("total_amt"));	
			dma_slipD.set("tax_amt", 0);	
		}else{
			if(dlt_sendreq.getRowCount() == 0){
				com.alert(com.getMsg("message.xom.co.com.0001", "송금내역"));	
				return false;
			}
			
			validData.push({dataObj : dlt_sendreq, valInfoArr :[
				 { id : "send_odr", mandatory : true}
				,{ id : "pay_clsf", mandatory : true } 
				,{ id : "send_req_amt", mandatory : true } 
				], isCheckModified : false
			});
		}		
		
		if(dma_slipD.get("cud_type") == "C"){	
			if (rad_accnt_clsf.getValue() == "4") {
				dma_slipD.set("journ_cd", "Fn9920");
				dma_slipD.set("base_debit_cr", "2");
			}else if (rad_accnt_clsf.getValue() == "3") {
				dma_slipD.set("journ_cd", "Fn0063");
			} else {
				dma_slipD.set("journ_cd", "Fn0013");
			}
		}
		
		return com.validateData(validData);
	};
	
	/**
	 * 저장실행
	 */
	scwin.save = function(){
		dma_slipD.set("unslip_no", ibx_unslip_no.getValue());	
		
		com.file.transport( function(attachObj){
			if(attachObj.upload_A != undefined && attachObj.upload_A.trim().length == 13){
				dma_slipD.set("attach_file_no", attachObj.upload_A);
				dma_slipD.set("validAttachNo", attachObj.upload_A);
			}
			
			com.execute(sbm_saveSlip, {
				successCallback : function(e) { // 성공 콜백
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){	
						// 2023.03.08. 저장없이 결재신청 클릭하는 경우가 있어서 증빙 저장 후 결재화면으로 넘어가도록 수정					
						scwin.evidParam.req_no = dma_search.get("unslip_no");
						scwin.evidParam.unslip_odr = dma_search.get("unslip_odr");
						// 자동증빙 저장
						wfm_evid.getWindow(0).scwin.updateEvid(scwin.evidParam);
						
						if(scwin.data.aprYn == "Y"){ // 결재신청 후
							com.movePageMenu("A001", { "reqNo" :  dma_slipH.get("unslip_no")});
						}else{
							// 회의록 parameter 초기화
							scwin.data.meetYn = false;
								
							// 계산서 내역 재조회
							btn_billSrc.trigger("click");
								
							// 조회
							scwin.search();
						}						
					});					
				}
			}); // end com.execute
		}); // end com.file.transport
	};
	
	/**
	 * 비용코드 검색팝업
	 */
	scwin.btn_expns_onclick = function(e) {
		if (inputAccntNo.getValue() == "") {
			com.alert(com.getMsg("message.xom.co.com.0001", "계정번호"));
			return;
		}

		var data = {
			accnt_no : inputAccntNo.getValue(),
			expns_cd : inputExpnsCd.getValue()
		};

		// TODO TEST
		//data.expns_cd = "271";
		com.pop.open(com.pop.TYPE.EXPNS, data, async function(retObj) {
			if (retObj) {
				// 비용코드 체크(소액물품, 이지바로과제, 증빙여부 )
				const isExcept = await scwin.check(retObj, 1);
				if (!isExcept) return;

				dma_slipD.set("expns_cd", retObj.expns_cd);
				dma_slipD.set("expns_cd_nm", retObj.expns_cd_nm);
				dma_slipD.set("accnt_cd", retObj.accnt_cd);
				dma_slipD.set("accnt_cd_nm", retObj.accnt_cd_abbr);
				
				if(rad_accnt_clsf.getValue() != '4'){
					// TODO 전자증빙
					scwin.evidParam.expns_cd = retObj.expns_cd;
					if(/322|262|431/.test(retObj.expns_cd) && inputAccntNo.getValue().substring(0, 4) == "FF21"){
						if(inputAccntNo.getValue() == "FF210001"){
							scwin.evidParam.expns_cd = "FF1";
						}else{
							scwin.evidParam.expns_cd = "FF2";
						}
					}
					
					wfm_evid.getWindow(0).scwin.evid_select(scwin.evidParam);
				}

				// 관리항목 셋팅
				scwin.setMngmt(retObj.accnt_cd);	
				
				// 예산잔액 조회
				if(dma_slipD.get("accnt_no") != "FF210001"){
					scwin.getBugtRamtAmt();	
				}		
			}
		});
	};

	/**
	 * 관리항목 grd_mngmt_oncellclick event
	 */
	scwin.grd_mngmt_oncellclick = function(row,col,colId) {
		if (grd_mngmt.getColumnID(col) == "img_detls") {
			var mngmtItemCd = dlt_mngmt.getCellData(row, "mngmt_item_cd");
			var data = {
				mngmt_detls_cd : dlt_mngmt.getCellData(row, "mngmt_detls_cd")
			};
			
			if(mngmtItemCd == "2050"){
				data.expns_cd = dma_slipD.get("expns_cd");
			}			
			
			biz.fin.setMngmtDetls(mngmtItemCd, data, function(cd, nm){
				if(/1001|1300/.test(mngmtItemCd)){
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", cd.substring(2,8));
				}else{
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", cd);
				}
				
				dlt_mngmt.setCellData(row, "mngmt_detls_nm", nm);		
				
				if(/1001|1300/.test(mngmtItemCd)){
					if(dma_slipD.get("accnt_no") == "FF210001"){
						dma_slipD.set("accnt_rspns", cd);
						
						// 예산잔액 체크
						scwin.getBugtRamtAmt();
					}
				}		
			});
		}
	};
	
	/**
	 * 관리항목 데이터변경 event
	 */
	scwin.grd_mngmt_onviewchange = function(info) {
		var col = info.colIndex;
		var row = info.rowIndex;
		if(col == grd_mngmt.getColumnIndex("mngmt_detls_cd")){
			if(dlt_mngmt.getCellData(row, "mngmt_item_cd") == "4043" && dlt_mngmt.getCellData(row, "mngmt_detls_cd") != ""){
				if(isNaN(dlt_mngmt.getCellData(row, "mngmt_detls_cd"))){
					com.alert("message.xom.ui.fin.032");
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", "");
				}
			}
		}
	};

	/**
	 * 총액 수정 이벤트
	 */
	scwin.inputTotalAmt_onviewchange = function(info) {
		if (inputTotalAmt.getValue() == 0) {
			inputUnslipAmt.setValue(0);
			inputTaxAmt.setValue(0);
			return;
		}
		scwin.setUnslipAmt(dma_slipD.get("tax_cd"));

		// 예산잔액 조회
		scwin.getBugtRamtAmt();
	};

	/**
	 * 비고 변경 이벤트
	 */
	scwin.ibx_rmk_1_onchange = function(info) {
		if (dma_slipH.get("rmk") == "") {
			dma_slipH.set("rmk", this.getValue());
		}
	};	
	
	/**
	 * 목록 버튼 클릭 이벤트
	 */
	scwin.btn_pre_onclick = function(e) {
		com.moveList("F220");
	};	
	
	/**
	 * 삭제버튼 클릭 이벤트
	 */	
	scwin.btn_del_onclick = function(e) {
		if(dma_slipD.get("unslip_no") == ""){
			alert("삭제할 행을 선택하세요");
			return;				
		}
		
		if(dlt_slipD.getRowCount() == 1){
			dma_slipD.set("part_all_clsf", "F"); // 전체삭제
		}else{
			dma_slipD.set("part_all_clsf", "");
		}
		
		com.confirm("message.xom.wq.022"/*삭제하시겠습니까?*/, function(ret){
			if(ret){
				dma_slipD.set("cud_type", "D");
				com.file.deleteAll( function(){
					com.execute(sbm_deleteSlip, {
						successCallback : function(e) {
							if(dlt_slipD.getRowCount() == 1){
								//scwin.checkList = null;	
								if(com.getParameter("param4") == "apr"){
									com.movePageMenu("A010");
								}else{
									com.moveList("F220",{});	
								}	
							}else{
								// 계산서 내역 재조회
								btn_billSrc.trigger("click");
								
								scwin.search();	
							}
						}
					});
				});
			} else {
				dma_slipD.set("cud_type", "U");
			}
		});
	};
	
	/**
	 * 계정구분 변경이벤트
	 */
	scwin.rad_accnt_clsf_onviewchange = function(info) {
		scwin.reformData();		
		
		if(this.getValue() == "4"){ // 공제일 경우
			grp_gen.hide(); // 공제이외
			grp_dedct.show("");	
			btn_expns2.show("");
			
			dma_slipD.set("cud_type", "C");
			dma_slipD.set("total_amt", 0);
			dma_slipD.set("rmk_1", "");
			dma_slipD.set("rmk_2", "");
			dma_slipD.set("base_debit_cr", "2");
			
			dma_slipD.set("accnt_no", "FF030001");
			scwin.getAccntNo();	
		}else{
			grp_gen.show(); // 공제이외
			grp_dedct.hide();	
			
			inputAccntNo.setDisabled(false);				
			inputExpnsCd.setDisabled(false);
			btn_accntNo.show("");
			btn_expns.show("");
			
			dma_slipD.set("base_debit_cr", "1");					
		}	
		
		// 첨부파일
		btn_confrHis.hide();
	};
	
	/**
	 * 작성자 검색 팝업
	 */
	scwin.btn_emp_onclick = function(e) {
		var data = { empno : inputEmpNo.getValue(), work_clsf : "HAG010"};
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			dma_slipH.set("empno", ret.empno);
			dma_slipH.set("nm", ret.nm);
			dma_slipH.set("wrte_psn", ret.syspayno);
			dma_slipH.set("wrte_dept", ret.dept_cd);
			dma_slipH.set("dept_nm", ret.dept_nm);
			dma_slipH.set("wrte_dept_new_ymd", ret.dept_new_ymd);
		});
	};

	// -------------------------- check --------------------------------------------------------------------------------------------------check
	/**
	 * 경비결의(일반) 체크
	 */
	scwin.check = async function(paramObj, idx) {
		var retVal = true;
		switch (idx) {
			case 0 : // 계정번호 검색 후 체크
				retVal = scwin.checkPostAccntNo(paramObj);
				break;
			case 1 : //비용코드 검색 후 체크
				retVal = await scwin.checkPostExpnsCd(paramObj);
				break;
		}

		return retVal;
	};

	/**
	 * 계정번호 검색 후 체크
	 */
	scwin.checkPostAccntNo = function(paramObj) {
		// 계정종료일자 및 계정상태 체크
		if (paramObj.accnt_no.substring(0,2) != "FF") {
			if(dma_slipH.get("slip_ymd") > paramObj.cls_ymd){
				com.alert("message.alert.fin.com.0007");
				return false;
			}
			
			if(!/RAK041|RAK061/.test(paramObj.accnt_state)){ // RAK041 집행가능, RAK061 미입금집행승인
				com.alert(com.getMsg("message.alert.fin.com.0008", paramObj.accnt_no, "결의생성"));
				return false;
			}
			
			//이민기 수정/연구재단 과제도 걸증빙 이용 가능하도록.. 주석처리
//			if(paramObj.evid_chk == "Y" && dma_bill.get("detail_yn") != "Y"){
//				com.alert("message.xom.ui.fin.031");
//				return false;
//			}
		}			

		return true;
	};

	/**
	 * 비용코드 검색 후 체크
	 */
	scwin.checkPostExpnsCd = async function(paramObj) {
		if(/121|122|127/.test(paramObj.expns_cd)){
			com.alert("message.xom.ui.fin.036"); // 내부인건비 비용코드는 선택할 수 없습니다.
			return false;
		}
		
		// 2023.06.02 경비결의 시 BG계정이면서 142 비용코드 사용할 경우 자산검수 필수 작성 제외(XC22023014CD)
		const excpetAwaitChk = await com.isExceptAwait("XEK060", "F201", inputAccntNo.getValue().substring(0,2));
		if(!excpetAwaitChk) {
			if (biz.fin.CONST.EXPNS_CHK_SML.indexOf(paramObj.expns_cd) >= 0) {
				com.alert("message.xom.ui.fin.005"); //[2019년 2월 25일 부터 소액물품 검사검수 메뉴를 이용해서 결의 진행하셔야 합니다. \n재무관리>결의서>소액물품검사검수> 자세한 문의는 구매자산실로 해주시기 바랍니다.]
				return false;
			}
		}

		if (scwin.data.evid_chk == "Y" && biz.fin.CONST.EXPNS_CHK_SML_EVID.indexOf(paramObj.expns_cd) >= 0) {
			com.alert("message.xom.ui.fin.006"); //소액물품검수관리를 통한 결의서 작성 바랍니다. \n재무관리>결의서>소액물품검수관리
			return false;
		}		

		if (dma_slipD.get("mngmt_clsf") == "R") { // 연구계정
			if (/351|352|359/.test(paramObj.expns_cd)) { // //국내교육훈련비, 국외교육훈련비, 기타교육훈련비
				com.alert("message.xom.ui.fin.008"); //연구과제 관련 교육훈련비는 처리 가능하나, 자기개발교육(개인역량개발)은 BH계정(총무보안실에 문의)으로 진행하여 주시기 바랍니다.
			}
		}
		
		// 2021.10.20. 연구장비 통합계정일 경우 비용코드는 322, 262, 431 중 택일
		if(/^FF21/.test(inputAccntNo.getValue())){
			if(paramObj.expns_cd == "999"){
				com.alert("message.xom.ui.fin.037");
				return false;
			}
		}

		return true;
	};

	scwin.checkPreSave = function() {
		// 2019.02.25 이지바로과제로 비용코드 271, 272 사용시 필수여부에 상관없이 신청번호 체크	
		if(rad_accnt_clsf.getValue() != "4"){
			// 증빙 날짜 체크
			if (!scwin.slip_date_check()) return false;
			
			var clsf = ""
			if (scwin.data.exclsv_agncy == "RHB040" && dma_slipD.get("accnt_no_clsf") == "FAJ003" && /271|272/.test(dma_slipD.get("expns_cd"))) {
				clsf = "ezbr";
			}
			// 통합이지바로 회의록 필수 체크
			if (dma_slipD.get("accnt_no_clsf") == "FAJ007" && /410|411/.test(dma_slipD.get("expns_cd"))) {
				clsf = "cmb_ezbr";
			}
			if (!wfm_evid.getWindow().scwin.evid_preSave(clsf))
				return false;			
	
			// 2014.12.16 부가세로직 추가에 따른 검증추가
			if (dma_slipD.get("total_amt") != Number(dma_slipD.get("unslip_amt")) + Number(dma_slipD.get("tax_amt"))) {
				com.alert(com.getMsg("message.xom.ui.fin.015", "결의금액")); // 결의금액과 세액의 합이 총액과 일치하지 않습니다.
				return false;
			}
	
			if (dma_slipD.get("tax_cd") == "FTX001") {
				if (dma_bill.get("tax_amt") > 0 && dma_slipD.get("tax_amt") == 0) {
					com.alert("message.xom.ui.fin.016"); // 과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
					return false;
				}
	
				if (dma_bill.get("tax_amt") == 0 && dma_slipD.get("tax_amt") > 0) {
					com.alert("message.xom.ui.fin.029"); // 과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
					return false;
				}
				
			} else {
				if (dma_slipD.get("tax_amt") > 0) {
					com.alert("message.xom.ui.fin.017"); // 비과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
					return false;
				}
			}			
	
			// 과세/비과세 혼용
			var totalAmtSum = 0;
			var unslipAmtSum = 0;
			var taxAmtSum = 0;
			var taxfreeCnt = 0;
			scwin.data.taxYn =[];
			for (var i = 0; i < dlt_slipD.getRowCount(); i++) {
				if(dma_slipD.get("accnt_no").substring(0,2) != "FF" && dlt_slipD.getCellData(i, "accnt_no").substring(0,2) != "FF"){
					if (dma_slipD.get("bill_no") == dlt_slipD.getCellData(i, "bill_no")) {
						if (dlt_slipD.getCellData(i, "tax_cd") != dma_slipD.get("tax_cd")) {
							com.alert("message.xom.ui.fin.018"); // 하나의 증빙을 과세계정과 비과세계정으로 혼합하여 저장할 수 없습니다.
							return false;
						}					
					}
				}
	
				//2021.01.13 저장전 과세계정인 경우 부가세 입력 필수 알림메시지 상신자가 확인하면 그대로 진행 
				if(dlt_slipD.getCellData(i, "tax_cd") == "FTX001" && dlt_slipD.getCellData(i, "tax_amt") == 0){
					scwin.data.taxYn.push(i+1);
				}
				
				if (dma_slipD.get("bill_no") == dlt_slipD.getCellData(i, "bill_no")) {						
					// 금액 체크
					totalAmtSum = totalAmtSum + Number(dlt_slipD.getCellData(i, "total_amt"));
					unslipAmtSum = totalAmtSum + Number(dlt_slipD.getCellData(i, "unslip_amt"));
					taxAmtSum = totalAmtSum + Number(dlt_slipD.getCellData(i, "tax_amt"));
					if(dlt_slipD.getCellData(i, "tax_cd") == "FTX002") taxfreeCnt++;
				}
			}
			
			// 금액 재 조정
			if (inputSumAmt.getValue() == totalAmtSum + Number(dma_slipD.get("total_amt"))) {
				if(dma_bill.get("chrg_amt") != unslipAmtSum + Number(dma_slipD.get("unslip_amt")) || dma_bill.get("tax_amt") != taxAmtSum + Number(dma_slipD.get("tax_amt"))){
					if(dma_slipD.get("tax_cd") == "FTX001" && taxfreeCnt == 0){
						dma_slipD.set("tax_amt", Number(dma_bill.get("tax_amt")) - taxAmtSum);
						dma_slipD.set("unslip_amt", Number(dma_slipD.get("total_amt")) - Number(dma_slipD.get("tax_amt")));
					}
				}
			}
			
			// 송금내역 체크			
			var reqAmtSum = 0;
			var payClsf = "";
			for(var i=0; i<dlt_sendreq.getRowCount(); i++){
				payClsf = dlt_sendreq.getCellData(i,"pay_clsf")
				if(payClsf == "FAX010" && dlt_sendreq.getCellData(i,"syspayno") == ""){
					com.alert(com.getMsg("message.xom.co.com.0001", "송금내역의 개인번호"));	
					grd_sendreq.setFocusedCell(i, "emp_vend");
					return false;
				}else if(payClsf == "FAX020"){
					if(dlt_sendreq.getCellData(i,"vend_nm") == ""){
						com.alert(com.getMsg("message.xom.co.com.0001", "송금내역의 거래처"));	
						grd_sendreq.setFocusedCell(i, "emp_vend");
						return false;
					}
					
					if(dlt_sendreq.getCellData(i,"bank") == "" || dlt_sendreq.getCellData(i,"depstr_nm") == "" || dlt_sendreq.getCellData(i,"bankaccnt_no") == ""){
						com.alert(com.getMsg("message.xom.co.com.0001", "계좌정보"));	
						grd_sendreq.setFocusedCell(i, "bank");
						return false;
					}
				}else if(payClsf == "FAX100" && dlt_sendreq.getCellData(i,"depstr_nm") == ""){ // 지로지급
						com.alert(com.getMsg("message.xom.co.com.0001", "예금주"));	
						grd_sendreq.setFocusedCell(i, "depstr_nm");
						return false;
				}else if(payClsf == "FAX090"){ // 기타(송금)지급
					if(dlt_sendreq.getCellData(i,"bank") == "" || dlt_sendreq.getCellData(i,"depstr_nm") == "" || dlt_sendreq.getCellData(i,"bankaccnt_no") == ""){
						com.alert(com.getMsg("message.xom.co.com.0001", "계좌정보"));	
						grd_sendreq.setFocusedCell(i, "bank");
						return false;
					}	
				}
				
				reqAmtSum = reqAmtSum + Number(dlt_sendreq.getCellData(i, "send_req_amt"));
				
				// 계좌검증
				if(/FAX100|FAX090/.test(dlt_sendreq.getCellData(i, "pay_clsf"))){ // FAX100 지로지급, FAX090 기타(송금)지급	
					continue;	
				}
				
				if(location.host == "nbiz.kitech.re.kr"){
					if(dlt_sendreq.getCellData(i, "is_account") != '1' && dlt_sendreq.getCellData(i, "bankaccnt_no").trim() != ""){
						if(dlt_sendreq.getCellData(i, "pay_clsf") == "FAX010"){
							if(!confirm("유효하지 않은 송금내역(계좌정보)가 있습니다. 이대로 진행하시겠습니까?")){
								return false;	
							}
						}else if(dlt_sendreq.getCellData(i, "pay_clsf") == "FAX020"){
							com.alert("message.xom.ui.fin.027"); // 유효하지 않은 송금내역(계좌정보)가 있습니다.\n계좌정보 확인 후 결재신청 바랍니다.
							return false;	
						}
					}
				}
			}			
			
			if(dma_slipD.get("total_amt") < reqAmtSum){
				com.alert("message.xom.ui.fin.025"); // 송금금액이 신청금액을 초과 하였습니다.
				return false;
			}			
		} // 입금이 아닌 경우 체크
		
		// 관리항목 체크
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			if(dlt_mngmt.getCellData(i,"essen_ex") == "Y"){
				if(dlt_mngmt.getCellData(i,"mngmt_detls_cd") == "" && dlt_mngmt.getCellData(i,"mngmt_detls_nm") == ""){
					com.alert(com.getMsg("message.xom.co.com.0001", (i+1)+"행의 관리항목"));
					return false;
				}
			}
		}

		return true;
	};

	/**
	 * 증빙 날짜 체크
	 */
	scwin.slip_date_check = function() {
		var slipYmd = dma_slipH.get("slip_ymd");
		var issuYmd = dma_bill.get("regs_date");
		
		var evidYmdChk = true;
		if (rad_accnt_clsf.getValue() == "4") {// 공제
			// TODO 입금일자(발생일자)와 결의일자 비교체크 20150616
			if (slipYmd < scwin.data.accnt_ymd) {
				com.alert(com.getMsg("message.xom.ui.fin.010", "입금일자", "결의일자")); //입금일자는 결의일자이전이어야 합니다.
				evidYmdChk = false;
			}
		} else {
			// 계산서 날짜 > 결의일자  or 계산서발행월이 결의월가 같지 않으면 오류
			if ((issuYmd > slipYmd) || (issuYmd.substring(0, 6) != slipYmd.substring(0, 6))) {
				evidYmdChk = false;
			}
			
			// 그리드 모든 행의 계산서 발행월이 같아야함
			for(var i=0; i<dlt_slipD.getRowCount(); i++){
				if(dlt_slipD.getCellData(i, "issu_ymd").trim() != "" && dlt_slipD.getCellData(i, "issu_ymd").substring(0,6) != issuYmd.substring(0, 6)){
					evidYmdChk = false;
				}
			}
			
			// 증빙날짜 오류
			if(!evidYmdChk){
				biz.fin.pop.open(biz.fin.pop.TYPE.EVID_YMD_CHK, {}, function(retObj) {
				});	
			}			
		}
		
		return evidYmdChk;	
	};	
	
	/**
	 * 학술대회이력 클릭
	 */
	scwin.btn_confrHis_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		
		// 학술대회이력
		var data = {
			req_no : ibx_unslip_no.getValue(),
			ezbr_yn : "N",
			ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.CONFPOOL, data, function(ret) {			
		});
	};
	
	/**
	 * 송금내역 [+]버튼 클릭 이벤트
	 */
	scwin.btn_add_onclick = function(e) {
		if(dma_slipD.get("total_amt") == ""){
			com.alert("message.xom.ui.fin.024");
			return;
		}	
		
		var reqAmtSum = 0;
		for(var i=0; i<dlt_sendreq.getRowCount(); i++){
			reqAmtSum += Number(dlt_sendreq.getCellData(i, "send_req_amt"));
		}
		
		var totalAmt = Number(dma_slipD.get("total_amt"));
		if(reqAmtSum > totalAmt){
			com.alert("message.xom.ui.fin.025"); // 송금금액이 신청금액을 초과 하였습니다.
			return;
		}
		
		var idx = com.addRow(grd_sendreq);
		var sendOdr = 1;
		if(idx > 0){
			sendOdr = parseInt(dlt_sendreq.getCellData(idx-1, "send_odr")) + 1;
		}
		
		dlt_sendreq.setCellData(idx, "send_odr", sendOdr);
		dlt_sendreq.setCellData(idx, "send_req_amt", totalAmt - reqAmtSum);
		dlt_sendreq.setCellData(idx, "rmk", dma_slipD.get("rmk_1"));
		if(dma_slipD.get("evid_cd") == "FAH611"){ // 지로
			dlt_sendreq.setCellData(idx, "pay_clsf", "FAX100");
		}else{
			dlt_sendreq.setCellData(idx, "pay_clsf", "FAX010"); // 개인지급
		}
		dlt_sendreq.setCellData(idx, "use_ymd", dma_bill.get("regs_date"));
		dlt_sendreq.setCellData(idx, "cud_type", "C");
		
		grd_sendreq.setFocusedCell(idx, "pay_clsf");
	};
	
	/**
	 * 송금내역 [-]버튼 클릭 이벤트
	 */
	scwin.btn_sendDel_onclick = function(e) {
		var row = grd_sendreq.getFocusedRowIndex();
		if(row < 0){
			com.alert(com.getMsg("message.xom.ui.fin.002", "삭제할 행"));
			return;
		}
		
		dlt_sendreq.setCellData(row, "cud_type", "D");
		dlt_sendreq.removeRow(row);
	};
	
	/**
	 * 송금내역 이미지 클릭 이벤트
	 */
	scwin.grd_sendreq_oncellclick = function(row,col,colId) {
		if(col == grd_sendreq.getColumnIndex("btn_emp_vend")){
			var payClsf = dlt_sendreq.getCellData(row, "pay_clsf");
			if(payClsf == ""){
				com.alert(com.getMsg("message.xom.co.com.0001", "지급구분"));
				return;
			}
			
			if(payClsf == "FAX010"){ // 개인
				com.pop.open(com.pop.TYPE.BNKAC, {clsf:"apart", ref_yn:"Y"}, function(ret) {
					dlt_sendreq.setCellData(row, "syspayno", ret.syspayno);
					dlt_sendreq.setCellData(row, "emp_vend", ret.empno);
					dlt_sendreq.setCellData(row, "bankaccnt_no", ret.bankaccnt_no);
					dlt_sendreq.setCellData(row, "depstr_nm", ret.depstr_nm);
					dlt_sendreq.setCellData(row, "bank", ret.bank);
					dlt_sendreq.setCellData(row, "is_account", "0");
					
					// TODO 계좌검증
					if(location.host == "nbiz.kitech.re.kr"){
						scwin.verifyAccount(row);
					}
				});
			}else if(payClsf == "FAX020"){ // 거래처 지급
				var data = {
					use_flag : "Y",
					ref_yn : "Y"
				};
				var bsnsNo = dma_bill.get("bsns_psn_regst_no").trim();
				if(bsnsNo != ""){					
					if(bsnsNo.length == 10){
						bsnsNo = bsnsNo.replace(/(\d{3})(\d{2})(\d{5})/, '$1-$2-$3');
					}
					data.bsns_psn_regst_no = bsnsNo;
				}
				
				com.pop.open(com.pop.TYPE.VEND, data, function(ret){
					dlt_sendreq.setCellData(row, "vend_cd", ret.vend_cd);
					dlt_sendreq.setCellData(row, "vend_nm", ret.vend_abbr);
					dlt_sendreq.setCellData(row, "emp_vend", ret.vend_abbr);
					dlt_sendreq.setCellData(row, "bankaccnt_no", ret.bankaccnt_no);
					dlt_sendreq.setCellData(row, "depstr_nm", ret.depstr);
					dlt_sendreq.setCellData(row, "bank", ret.tran_bank);
					dlt_sendreq.setCellData(row, "is_account", "0");
					
					// TODO
					if(location.host == "nbiz.kitech.re.kr"){
						scwin.verifyAccount(row);
					}
				});
			}else if(/FAX090|FAX100/.test(payClsf)){ // FAX090 기타(송금)지급, FAX100 지로
				com.alert("message.xom.ui.fin.028"); // 지급구분이 기타 또는 지로일 경우 수기입력만 가능합니다.
			}
		}
	};
	
	/**
	 * 계좌검증
	 */
	scwin.verifyAccount = function(row){
		var is_account = dlt_sendreq.getCellData(row, "is_account");
		var syspayno = dlt_sendreq.getCellData(row, "syspayno");
		
		if(is_account != "1" && dlt_sendreq.getCellData(row, "bank") != ""
					&& dlt_sendreq.getCellData(row, "bankaccnt_no") != ""
					&& dlt_sendreq.getCellData(row, "depstr_nm") != ""){	
						
			var data = {
				bank_cd : dlt_sendreq.getCellData(row, "bank"),
				bankaccnt_no : dlt_sendreq.getCellData(row, "bankaccnt_no").replace(/[^0-9]/g,''),
				syspayno : (syspayno != "")? syspayno : scwin.data.sn,
				depstr_nm : dlt_sendreq.getCellData(row, "depstr_nm"),
				iche_amt : 1,
			}	
			
			if(dlt_sendreq.getCellData(row,"pay_clsf") == "FAX020"){
				data.acnm_no = dlt_sendreq.getCellData(row, "bsns_psn_regst_no");  // 생년월일 or 사업자번호	
			}
			
			com.biz.verifyAccount(data, function(retObj){
				var valCnt = scwin.checkAccnt(retObj.res_data, retObj.depstr_nm);
				if(valCnt >= 0){
					dlt_sendreq.setCellData(row, "is_account", "1");
				}else{
					// [입력정보 : {0}] [검증결과 : {1}]
					dlt_sendreq.setCellData(row, "is_account", "2");
					com.alert(com.getMsg("message.xom.ui.fin.062", "[입력정보 :" + retObj.depstr_nm + "][검증결과 : " + retObj.res_data + "]"));	
				}
			});			
		}
	};
	
	/**
	 * 계좌검증결과 셋팅
	 */	 
	scwin.setAccVerfRslt = function(is_account, row){
		if(is_account == "1"){
			dlt_sendreq.setCellData(row, "is_account", "1");
		}else{
			if(dlt_sendreq.getCellData(row, "pay_clsf") == "FAX010"){ // 개인지급
				com.confirm("message.xom.ui.fin.061", function(ret){
					if(ret){
						dlt_sendreq.setCellData(row, "is_account", "1");
					}
				});
			}else{
				dlt_sendreq.setCellData(row, "is_account", "2");
			}
		}		
	};
	
	/**
	 * 송금내역 데이터변경 이벤트
	 */
	scwin.grd_sendreq_onviewchange = function(info) {
		var row = info.rowIndex;
		var codId = grd_sendreq.getColumnID(info.colIndex);
		var payClsf = dlt_sendreq.getCellData(row, "pay_clsf");
		
		if(codId == "pay_clsf"){
			dlt_sendreq.setCellData(row, "vend_cd", "");
			dlt_sendreq.setCellData(row, "vend_nm", "");
			dlt_sendreq.setCellData(row, "emp_vend", "");
			dlt_sendreq.setCellData(row, "bankaccnt_no", "");
			dlt_sendreq.setCellData(row, "depstr_nm", "");
			dlt_sendreq.setCellData(row, "bank", "");
			dlt_sendreq.setCellData(row, "syspayno", "");
			
			scwin.setGrdSendreq(row, payClsf);
			
		}else if(codId == "bankaccnt_no"){
			var chkValue = dlt_sendreq.getCellData(row, "bankaccnt_no").trim().replace(/-/gi,'');
			if(payClsf == "FAX090" && isNaN(chkValue)){
				com.alert("message.xom.ui.fin.035"); // 계좌번호는 숫자와 -만 입력할 수 있습니다.
				dlt_sendreq.setCellData(row, "bankaccnt_no", "");
				dlt_sendreq.setCellData(row, "is_account", "0");
				scwin.setAccntInfo('0');
			}
			
			scwin.resetIsAcount(row);
		}else if(colId == "bank" || colId == "depstr_nm"){
			scwin.resetIsAcount(row);
		}
	};
	
	/**
	 * 계좌검증 초기화
	 */
	scwin.resetIsAcount = function(row){
		dlt_sendreq.setCellData(row, "is_account", "0");
	};
	
	/**
	 * 송금내역 그리드 셋팅
	 */
	scwin.setGrdSendreq = function(row, payClsf){
		if(/FAX010|FAX020/.test(payClsf)){
			grd_sendreq.setCellReadOnly(row, "bankaccnt_no", true);
			grd_sendreq.setCellReadOnly(row, "depstr_nm", true);
			grd_sendreq.setCellReadOnly(row, "bank", true);
			grd_sendreq.setCellReadOnly(row, "emp_vend", true);
			grd_sendreq.setCellReadOnly(row, "btn_emp_vend", false);
		}else{
			grd_sendreq.setCellReadOnly(row, "depstr_nm", false);
			grd_sendreq.setCellReadOnly(row, "bank", false);
			grd_sendreq.setCellReadOnly(row, "btn_emp_vend", true);
			
			if (payClsf == "FAX100") { // 지로지급
				grd_sendreq.setCellReadOnly(row, "bankaccnt_no", true);
				grd_sendreq.setCellReadOnly(row, "emp_vend", true);
			} else {
				grd_sendreq.setCellReadOnly(row, "bankaccnt_no", false);
				grd_sendreq.setCellReadOnly(row, "emp_vend", false);
			}
		}
	};
	
	/**
	 * 2017.10.31 계좌번호 숫자여부 체크
	 */
	scwin.setAccntInfo = function(is_account){
		switch(is_account){
			case '0': grd_sendreq.setCellStyle( row , "is_account","color","black"); break;
			case '1': grd_sendreq.setCellStyle( row , "is_account","color","blue"); break;
			case '2': grd_sendreq.setCellStyle( row , "is_account","color","red"); break;		
		}		
	};
	
	/**
	 * 증빙버튼 클릭 이벤트
	 */
	scwin.btn_evid_onclick = function(e) {
		// 초기화
		scwin.reformData();
		
		biz.fin.pop.open(biz.fin.pop.TYPE.EVID_BILL, {}, function(ret) {
			if(ret){
				dma_search.set("vend_nm", ret.vend_nm);
				//dma_search.set("issu_seqno", ret.issu_seqno);
	
				btn_billSrc.trigger("click");
			}
		});
	};
	
	/**
	 * 전자증빙버튼 클릭 이벤트
	 */
	scwin.btn_elecBill_onclick = function(e){
		scwin.reformData();
		
		var data = {pur_con_user_id : com.getLoginInfo("sn")
				  , pur_con_org_code : com.getLoginInfo("deptCode")
				  , ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.TAXBILL, data, function(retObj) {
		});
	};

	/**
	 * 적요 변경 이벤트
	 */
	scwin.ibx_rmk_1_onviewchange = function(info) {
		if (dma_slipH.get("rmk") == "") {
			dma_slipH.set("rmk", this.getValue());
		}
	};
	
	/**
	 * 등록자 변경 이벤트
	 */
	scwin.acb_relat_onviewchange = function(info) {
		if(acb_relat.getValue() != ""){
			btn_billSrc.trigger("click");
		}
	};

	/**
	 * 결의서디테일 그리드 클릭 이벤트
	 */	
	scwin.grd_slipd_oncellclick = function(row,col,colId) {
		scwin.setSlipD(row);
	};

	/**
	 * 과제정보 팝업 호출
	 */	
	scwin.btn_prjInfo_onclick = function(e) {
		if(dma_slipD.get("mngmt_clsf") != "R"){
			com.alert("message.xom.ui.fin.034");
			return;
		}
		
		var data = {accnt_no : dma_slipD.get("accnt_no")
		            , ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.PRJNO, data, function(ret){			
		});
	};
	
	/**
	 * 비용코드 변경 이벤트
	 */	
	scwin.inputExpnsCd_onviewchange = function(info) {
		dma_slipD.set("expns_cd_nm", "");
		dma_slipD.set("accnt_cd", "");
		dma_slipD.set("accnt_cd_nm", "");
	};
	
	/**
	 * 증빙정보 버튼 클릭 이벤트
	 */
	scwin.btn_evidInfo_onclick = function(e) {
		var data = {
			unslip_no : dma_slipD.get("unslip_no"),
			unslip_odr : dma_slipD.get("unslip_odr"),
			expns_cd : dma_slipD.get("expns_cd"),
			service_id : dma_slipD.get("service_id")
		};
		
		scwin.openEvidPop(data);
	};

	/**
	 * 이지바로 증빙 팝업 호출
	 */
	scwin.openEvidPop = function(data){
		switch(data.service_id){
			case "F236" : // 교육(학회/세미나)증빙정보	
				type = biz.fin.pop.TYPE.EDU;
				break;
			case "F237" : // 회의증빙정보
				type = biz.fin.pop.TYPE.MEET_EVID;
				break;
			case "F238" : // 특근자정보
				type = biz.fin.pop.TYPE.OVERTIME;
				break;
			case "F239" : // 전문가활용정보
				type = biz.fin.pop.TYPE.PRO_PRUSE;
				break;
		}
		
		biz.fin.pop.open(type, data, function(retObj) {
		});
	};
	
	/**
	 * 이지바로 증빙 체크
	 */
	scwin.checkEvidApproval = function(){
		dma_search.set("inqr_clsf", "evid_check");
		
		com.execute(sbm_selectPreAprCheck, {
			successCallback : function(e){
				var evidMsg = "";
				var evidCheck = true;
				var data = {};
				for(var i=0; i<dlt_check.getRowCount(); i++){
					if(dlt_check.getCellData(i, "chk_yn") == "N"){
						evidMsg += "["+ dlt_check.getCellData(i, "accnt_no") +
									"] ["+ dlt_check.getCellData(i, "expns_cd") +"(" + dlt_check.getCellData(i, "expns_cd_nm") + ")] \n";
						
						if(evidCheck){
							data.unslip_no = dlt_check.getCellData(i, "unslip_no");
							data.unslip_odr = dlt_check.getCellData(i, "unslip_odr");
							data.expns_cd = dlt_check.getCellData(i, "expns_cd");
							data.service_id = dlt_check.getCellData(i, "service_id");
						}
						evidCheck = false;
					}
				}
				
				if(evidCheck){
					scwin.checkTotalAmt();					
				}else{
					com.alert(com.getMsg("message.xom.ui.fin.052", evidMsg)); //  ~은 증빙내역을 입력해야 합니다.
					scwin.openEvidPop(data);
				}
			}
		});
	}
	
	/**
	 * 금액 증빙 체크
	 */
	scwin.checkTotalAmt = function(){
		if(Number(dma_billsum.get("tot_expns_amt")) != Number(dma_billsum.get("tot_dedct_amt")) + Number(dma_billsum.get("tot_send_amt"))){
			com.alert("message.xom.ui.fin.051"); // 비용합계액은 (공제합계액 + 송금합계액)과 일치 하여야 합니다.
			return;
		}

		if(dma_billsum.get("tot_expns_amt") != dma_billsum.get("tot_evid_amt")){
			com.alert("message.xom.ui.fin.056"); // 거래증빙합계액은 비용합계액과 일치 하여야 합니다.
			return;
		}
		
		dma_search.set("inqr_clsf", "amt_check");
		
		com.execute(sbm_selectPreAprCheck, {
			successCallback : function(e){
				var evidMsg = "";
				var evidCheck = true;
				var data = {};
				for(var i=0; i<dlt_check.getRowCount(); i++){
					if(dlt_check.getCellData(i, "chk_cnt") == '0'){
						scwin.menuApproval();
					}else{
						com.alert(com.getMsg("message.xom.ui.fin.053", dlt_check.getCellData(i, "rtn_msg")));
					}
				}
			}
		});
	};
	
	/**
	 * 결재신청
	 */
	scwin.menuApproval = function(){
		if (!scwin.validateData()) return;
		if (!scwin.checkPreSave()) return;
		
		// 저장 후 결재신청(java에서 분리)
		if(scwin.data.taxYn.length > 0){
			com.confirm(com.getMsg("message.xom.ui.fin.020", (scwin.data.taxYn.join(","))), function(ret){ // {0}번째 행은 과세계정이므로 부가세 입력이 필수 입니다. 부가세가 0원이 맞습니까?
				if(ret){
					scwin.callApproval();
				}
			});
		}else{
			scwin.callApproval();
		}
	};
	
	scwin.callApproval = function(){
		dma_slipH.set("approval", "true");
		scwin.data.aprYn = "Y";
		
		// 저장 후 결재신청(java에서 분리)		
		scwin.save();
	};
	
	/**
	 * 결재신청전 체크
	 */
	scwin.checkPreApprv = function(){
		var evidYnCheck = false;

		for (var i = 0; i < dlt_slipD.getRowCount(); i++) {
			if (dlt_slipD.getCellData(i, "evid_yn") == "Y") {
				evidYnCheck = true;
				break;
			}
		}
		if(evidYnCheck == true){
			scwin.checkEvidApproval();
		}else{
			scwin.checkTotalAmt();
		}
	};
	
	/**
	 * 결재신청버튼 클릭 이벤트
	 */
	scwin.btn_apr_onclick = function(e) {					
		
		// 결재신청전 체크
		scwin.checkPreApprv();
	};
	
	/**
	 * 예실 버튼 클릭 이벤트
	 */
	scwin.btn_bugt_onclick = function(e) {
		var accntNo = dma_slipD.get("accnt_no");
		var startYr = dma_slipD.get("start_ymd").substring(0,4);
		var clsYr = dma_slipD.get("cls_ymd").substring(0,4);
		
		// TODO 레포트 출력
		if(!/PD|PL|PQ/.test(accntNo.substring(0,2))){
			var node = "accnt_no=" + accntNo + "&itm_solve_base=" + dma_slipD.get("itm_solve_base") + "&res_type=0";
			//OZFlashOpen("/fin/fin/leg/FinAccntInfo01Sel.ozr", "FinAccntInfo01Sel", "Y", node);
			com.oz.openPopup({
				ozrCode: "F006",
				param: node    
	        });
		}else{
			var node = "accnt_fr_ymd=" + startYr + "&accnt_to_ymd=" + clsYr + "&accnt_no=" + accntNo;
			//OZFlashOpen("/fin/bud/frc/BudTrustDetlsSel.ozr", "BudTrustDetlsSel", "Y", node);
			com.oz.openPopup({
				ozrCode: "F007",    
				param: node
	        });
		}		
	};
	
	/**
	 * 미리보기 버튼 클릭 이벤트
	 */
	scwin.btn_evid_view_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		com.biz.openEvidWindow(ibx_unslip_no.getValue());
	};
	
	/**
	 * 인쇄 버튼 클릭 이벤트
	 */
	scwin.btn_print_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		
		var node = "unslip_no=" + ibx_unslip_no.getValue();
		//OZFlashOpen("/fin/fin/spm/FinSlipRegst.ozr", "FinSlipRegst", "Y", node);
		com.oz.openPopup({
			ozrCode : "F001",      
			param: node
        });
	};
	
	/**
	 * 계좌검증 버튼 클릭 이벤트
	 */
	scwin.btn_accVerf_onclick = function(e) {
		dlt_account.removeAll();
		dlt_account.reform();
		var idx = 0;
		var odrArr = [];
		
		for(var i=0; i<dlt_sendreq.getRowCount(); i++){
			if(	dlt_sendreq.getCellData(i, "is_account") != "1" 
				&& dlt_sendreq.getCellData(i, "bank") != ""
				&& dlt_sendreq.getCellData(i, "bankaccnt_no") != ""
				&& dlt_sendreq.getCellData(i, "depstr_nm") != ""){
					
				var data = {
					bank_cd : dlt_sendreq.getCellData(i, "bank"),
					bankaccnt_no : dlt_sendreq.getCellData(i, "bankaccnt_no").replace(/[^0-9]/g,''),
					syspayno : dlt_sendreq.getCellData(i, "syspayno"),		
					depstr_nm : dlt_sendreq.getCellData(i, "depstr_nm").trim(),	
					iche_amt : (dlt_sendreq.getCellData(i, "pay_clsf") == "FAX090")?dlt_sendreq.getCellData(i, "send_req_amt") :1,
				}	
				
				if(dlt_sendreq.getCellData(i, "pay_clsf") == "FAX020"){
					data.acnm_no = dlt_sendreq.getCellData(i, "bsns_psn_regst_no");
				}
				
				dlt_account.setRowJSON(idx, data);
				idx++;
				odrArr.push(i);
			}
		}	
		
		if(dlt_account.getRowCount() > 0){	
			com.biz.verifyAccountMulti(function(e){
				var msg = "";
				var errCnt = 0;
				for(var i=0; i<dlt_account.getRowCount(); i++){
					var valCnt = scwin.checkAccnt(dlt_account.getCellData(i, "res_data"), dlt_account.getCellData(i, "depstr_nm"));
					if(valCnt >= 0){
						dlt_sendreq.setCellData(odrArr[i], "is_account", "1");
					}else{
						dlt_sendreq.setCellData(odrArr[i], "is_account", "2");
						msg = "입력정보 : " + dlt_account.getCellData(i,"depstr_nm") + ", 검증결과 :" + dlt_account.getCellData(i,"res_data") + "\n";
						errCnt++;
					}
				}
				
				if(errCnt > 0){
					alert(msg);
				}
			});
		}
	};
	
	/**
	 * 검증 처리
	 */
	scwin.checkAccnt = function(resData, depstrNm){
		resData = resData.replace("(주)",'').replace("(유)",'').replace("(사)",'').replace("(재)",'');
		resData = resData.replace(/[&\/\\#,+()$~%.'":*?<>{}\s]/g,'');
					
		depstrNm = depstrNm.replace("(주)",'').replace("(유)",'').replace("(사)",'').replace("(재)",'');
		depstrNm = depstrNm.replace(/[&\/\\#,+()$~%.'":*?<>{}\s]/g,'');
		
		return depstrNm.indexOf(resData.trim());
	};
	
	/**
	 * 다건 계좌검증 후 처리
	 */
	scwin.postAccVerf = function(){
		var errMsg = "";
		for(var i=0; i<dlt_account.getRowCount(); i++){
			scwin.setAccVerfRslt(dlt_account.getCellData(i, "is_account"), scwin.data.odr[i]);
				
			if(dlt_sendreq.getCellData(row, "is_account") == "2"){
				errMsg += "[입력정보 :" + dlt_account.getCellData(i, "depstr_nm") + "][검증결과 : " + dlt_account.getCellData(i, "res_data") + "]\n";
			}
		}
		
		com.alert(com.getMsg("message.xom.ui.fin.062", errMsg));
	};
	
	scwin.inputAccntNo_onkeyup = function(e) {
		inputAccntNo.setValue(this.getValue().toUpperCase());
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="" class="pageWrap">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn" id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    				<w2:span class="note red ml10" id="" label="[수정안내] 과세 &gt; 비과세 혹은 비과세 &gt; 과세로 수정 시, 삭제 후 입력하세요." style=""></w2:span>
    			</xf:group>
    			<xf:group id="" class="ri">
    				<xf:group id="" class="btnbox">
    					<xf:trigger style="" id="btn_evid_view" type="button" class="btn" ev:onclick="scwin.btn_evid_view_onclick">
    						<xf:label><![CDATA[미리보기]]></xf:label>
    					</xf:trigger>
    					<xf:trigger style="" id="btn_print" type="button" class="btn icon print" ev:onclick="scwin.btn_print_onclick">
    						<xf:label><![CDATA[인쇄]]></xf:label>
    					</xf:trigger>
    					<xf:trigger style="" id="btn_apr" type="button" class="btn blue" ev:onclick="scwin.btn_apr_onclick">
    						<xf:label><![CDATA[결재신청]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group></xf:group>
    		<xf:group class="w2tb tbl " id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="과제정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id=""
    						placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="결의일자" ref="data:dma_slipH.slip_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_unslip_no" style="" title="결의번호" ref="data:dma_slipH.unslip_no" readOnly="true"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="">
    						<xf:group class="inpSch" id="grp_wrte_psn" style="width: 120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="inputEmpNo" style="" title="작성자" ref="data:dma_slipH.empno"></xf:input>
    							<xf:trigger class="btn" id="btn_emp" style="" type="button" title="작성자 조회" ev:onclick="scwin.btn_emp_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="작성자 상세" ref="data:dma_slipH.nm" readOnly="true"></xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="작성부서" ref="data:dma_slipH.dept_nm" readOnly="true"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="적요" ref="data:dma_slipH.rmk"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정유무" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="확정유무" ref="data:dma_slipH.decsn_ex_nm" readOnly="true"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="확정결의번호" ref="data:dma_slipH.slip_no" readOnly="true"></xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="width:213px;" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr" id="grp_bill">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="등록자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:autoComplete allOption="" chooseOption="true" chooseOptionLabel="-선택-" class="" displayMode="" id="acb_relat"
    						ref="data:dma_search.relat_no" search="" style="" submenuSize="auto" textAlign="left" tooltipDisplay="" useKeywordHighlight=""
    						visibleColumn="" visibleColumnFalseValue="" editModeEvent="onclick" ev:onviewchange="scwin.acb_relat_onviewchange">
    						<w2:choices>
    							<w2:itemset nodeset="data:dlt_code">
    								<w2:label ref="code_nm"></w2:label>
    								<w2:value ref="code"></w2:value>
    							</w2:itemset>
    						</w2:choices>
    					</w2:autoComplete>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="등록일자" style="" tagname="span"></w2:textbox>
					</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id=""
    						placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="등록일자" ref="data:dma_search.from_ymd">
    					</w2:inputCalendar>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id=""
    						placeholder="종료일" ref="data:dma_search.to_ymd" renderDiv="true" rightAlign="false" style="" title="등록일자">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th" style="">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="거래처" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" style="">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp" id="" style="" title="거래처" ref="data:dma_search.vend_nm"></xf:input>
    					<xf:trigger class="btn" id="btn_billSrc" style="" type="button" ev:onclick="scwin.btn_billSrc_onclick">
    						<xf:label><![CDATA[조회]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn" id="btn_evid" style="" type="button" ev:onclick="scwin.btn_evid_onclick">
    						<xf:label><![CDATA[증빙]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn" id="btn_elecBill" style="" type="button" ev:onclick="scwin.btn_elecBill_onclick">
    						<xf:label><![CDATA[전자증빙]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="lybox mt16" id="" style="">
    			<xf:group class="ly_column col_4" id="">
    				<w2:gridView class="grid" dataList="data:dlt_bill" defaultCellHeight="28" evenRowBackgroundColor="#f7faff" id="grd_bill"
    					noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    					rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false"
    					rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd"
    					style="height: 85px;" summaryAuto="true" visibleRowNum="5" ev:oncellclick="scwin.grd_bill_oncellclick" autoFit="none">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="(세금)계산서번호"
    								width="110">
    							</w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="거래처" width="140"></w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="총액" width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="공급가액"
    								width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="세액" width="100">
    							</w2:column>
    							<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="잔액" width="100"></w2:column>
    							<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="발행일자" width="90">
    							</w2:column>
    							<w2:column width="42" inputType="text" style="height:28px" id="column33" value="보기" displayMode="label"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="issu_seqno" inputType="link" readOnly="true"
    								style="height:28px;" width="110">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="vend_nm" inputType="text" readOnly="true"
    								style="height:28px;" width="140" class="le">
    							</w2:column>
    							<w2:column displayMode="label" id="totl_amt" inputType="text" readOnly="true" style="height:28px;"
    								width="100" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="chrg_amt" inputType="text" readOnly="true" style="height:28px;"
    								width="100" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="tax_amt" inputType="text" readOnly="true" style="height:28px;"
    								width="100" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="un_amt" inputType="text" readOnly="true" style="height:28px;" width="100"
    								class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="regs_date" inputType="text" readOnly="true" style="height:28px"
    								width="90" dataType="date" displayFormat="yyyy-MM-dd">
    							</w2:column>
    							<w2:column width="42" inputType="image" style="height:28px" id="btn_view" displayMode="label"
    								imageSrc="/cm/images/sample/btn_tbsearch02.png">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="거래증빙 내역" style="" tagname="h3"></w2:textbox>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="tbx_evid_title" label="(세금)계산서 번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="ibx_note3" style="" title="(세금)계산서 번호" readOnly="true" ref="data:dma_bill.note3"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="거래처" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="거래처" readOnly="true" ref="data:dma_bill.vend_nm"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="사업자번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="사업자번호" readOnly="true" ref="data:dma_bill.bsns_psn_regst_no"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="발행일" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="발행일" readOnly="true" ref="data:dma_bill.regs_date" dataType="date" displayFormat="yyyy-MM-dd"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="공급가액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="공급가액" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_bill.chrg_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="세액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="세액" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_bill.tax_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="합계금액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="inputSumAmt" style="" title="합계금액" readOnly="true" dataType="number" displayFormat="#,###"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="미처리금액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="미처리금액" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_bill.un_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="비용 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="비용 합계" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_billsum.tot_expns_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="공제 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="공제 합계" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_billsum.tot_dedct_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="송금 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="송금 합계" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_billsum.tot_send_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="거래증빙 합계" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="거래증빙 합계" readOnly="true" dataType="number" displayFormat="#,###" ref="data:dma_billsum.tot_evid_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group class="ly_column col_6" id="" style="">
    				<xf:group class="le" id="" style="">
    					<xf:group class="result" id="">
    						<w2:span id="" label="총" style=""></w2:span>
    						<w2:span class="numtotal red" id="tbx_cnt" label="0" style=""></w2:span>
    						<w2:span id="" label="건" style=""></w2:span>
    					</xf:group>
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_slipD" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_slipd" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5"
    					ev:oncellclick="scwin.grd_slipd_oncellclick">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="계정번호" width="70"></w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="과세구분" width="70"></w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="회계코드"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="비용코드"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="통제번호"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="총액" width="70"></w2:column>
    							<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="결의금액" width="70">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="column36" value="세액" displayMode="label"></w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" id="column34" value="적요" displayMode="label"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="accnt_no" inputType="text" readOnly="true"
    								style="height:28px;" width="70">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="tax_cd" inputType="select" readOnly="true"
    								style="height:28px;" width="70" allOption="" chooseOption="" ref="">
    								<w2:choices>
    									<w2:item>
    										<w2:label><![CDATA[과세]]></w2:label>
    										<w2:value><![CDATA[FTX001]]></w2:value>
    									</w2:item>
    									<w2:item>
    										<w2:label><![CDATA[비과세]]></w2:label>
    										<w2:value><![CDATA[FTX002]]></w2:value>
    									</w2:item>
    								</w2:choices>
    							</w2:column>
    							<w2:column displayMode="label" id="accnt_cd" inputType="text" readOnly="true" style="height:28px;"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="expns_cd" inputType="text" readOnly="true" style="height:28px;"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="ctrl_no" inputType="text" readOnly="true" style="height:28px;"
    								width="70">
    							</w2:column>
    							<w2:column displayMode="label" id="total_amt" inputType="text" readOnly="true" style="height:28px;"
    								width="70" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="unslip_amt" inputType="text" readOnly="true" style="height:28px" value=""
    								width="70" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="tax_amt" value="" displayMode="label"
    								readOnly="true" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" id="rmk_1" value="" displayMode="label"
    								readOnly="true" class="le">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<xf:select1 appearance="full" class="radioGroup" cols="" id="rad_accnt_clsf" ref="" renderType="radiogroup"
    							rows="" selectedIndex="0" style="" ev:onviewchange="scwin.rad_accnt_clsf_onviewchange">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[일반]]></xf:label>
    									<xf:value><![CDATA[1]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[수탁]]></xf:label>
    									<xf:value><![CDATA[3]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[공제]]></xf:label>
    									<xf:value><![CDATA[4]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    					</xf:group>
    					<xf:group class="ri" id="" style="">
    						<w2:span class="note red" id="tbxEvidMsg" label="* 증빙정보를 입력하여 주십시오." style=""></w2:span>
    						<xf:group class="btnarea" id="">
    							<xf:trigger class="btn" id="btn_evidInfo" style="" type="button" ev:onclick="scwin.btn_evidInfo_onclick">
    								<xf:label><![CDATA[증빙정보]]></xf:label>
    							</xf:trigger>
    							<xf:trigger class="btn" ev:onclick="scwin.btn_confrHis_onclick" id="btn_confrHis" style="" type="button">
    								<xf:label><![CDATA[학술대회이력]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group id="grp_gen">
    					<xf:group tagname="table" style="" id="" class="w2tb tbl">
    						<w2:attributes>
    							<w2:summary></w2:summary>
    						</w2:attributes>
    						<xf:group tagname="caption" text=" 상세정보"></xf:group>
    						<xf:group tagname="colgroup">
    							<xf:group tagname="col" style="width:140px;"></xf:group>
    							<xf:group tagname="col" style=""></xf:group>
    							<xf:group tagname="col" style="width:140px;"></xf:group>
    							<xf:group tagname="col" style=""></xf:group>
    						</xf:group>
    						<xf:group tagname="tr">
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="계정번호"></w2:textbox>
    								<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes>
    									<w2:colspan>3</w2:colspan>
    									<w2:rowspan>1</w2:rowspan>
    								</w2:attributes>
    								<xf:group id="" class="flex">
    									<xf:group style="width: 120px;" id="grp_accnt_no" class="inpSch">
    										<xf:input ref="data:dma_slipD.accnt_no" ev:onblur="scwin.inputAccntNo_onblur" adjustMaxLength="false" style="" id="inputAccntNo" title="계정번호" class="inp req" ev:onkeyup="scwin.inputAccntNo_onkeyup">
    										</xf:input>
    										<xf:trigger ev:onclick="scwin.btn_accntNo_onclick" style="" id="btn_accntNo" title="계정번호 조회"
    											type="button" class="btn">
    											<xf:label><![CDATA[검색]]></xf:label>
    										</xf:trigger>
    									</xf:group>
    									<xf:input ref="data:dma_slipD.accnt_no_nm" adjustMaxLength="false" style="width: 150px;"
    										readOnly="true" id="" title="계정번호 상세" class="inp">
    									</xf:input>
    									<xf:trigger ev:onclick="scwin.btn_prjInfo_onclick" style="" id="btn_prjInfo" type="button"
    										class="btn">
    										<xf:label><![CDATA[과제정보]]></xf:label>
    									</xf:trigger>
    									<xf:trigger style="" id="btn_bugt" type="button" class="btn" ev:onclick="scwin.btn_bugt_onclick">
    										<xf:label><![CDATA[예실]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="tr" style="">
    							<xf:group tagname="th" style="" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="비용코드"></w2:textbox>
    								<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							</xf:group>
    							<xf:group tagname="td" style="" class="w2tb_td">
    								<xf:group id="" class="flex">
    									<xf:group style="width: 120px;" id="grp_expns_cd" class="inpSch">
    										<xf:input ref="data:dma_slipD.expns_cd" adjustMaxLength="false" style="" id="inputExpnsCd"
    											title="비용코드" class="inp req" ev:onviewchange="scwin.inputExpnsCd_onviewchange">
    										</xf:input>
    										<xf:trigger ev:onclick="scwin.btn_expns_onclick" style="" id="btn_expns" title="비용코드 조회"
    											type="button" class="btn">
    											<xf:label><![CDATA[검색]]></xf:label>
    										</xf:trigger>
    									</xf:group>
    									<xf:input ref="data:dma_slipD.expns_cd_nm" adjustMaxLength="false" style=""
    										readOnly="true" id="" title="비용코드 상세" class="inp full">
    									</xf:input>
    								</xf:group>
    							</xf:group>
    							<xf:group tagname="th" style="" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="회계코드"></w2:textbox>
    							</xf:group>
    							<xf:group tagname="td" style="" class="w2tb_td">
    								<xf:group id="" class="flex">
    									<xf:input ref="data:dma_slipD.accnt_cd" adjustMaxLength="false" style="width:120px;" readOnly="true"
    										id="" title="회계코드 1" class="inp">
    									</xf:input>
    									<xf:input ref="data:dma_slipD.accnt_cd_nm" adjustMaxLength="false" style="" readOnly="true" id=""
    										title="회계코드 2" class="inp full">
    									</xf:input>
    								</xf:group>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="tr">
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="거래처"></w2:textbox>
    								<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes></w2:attributes>
    								<xf:input ref="data:dma_slipD.rmk_2" adjustMaxLength="false" style="" id="" title="거래처"
    									class="inp full req">
    								</xf:input>
    							</xf:group>
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="tbx_total_amt" label="총액"></w2:textbox>
    								<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes></w2:attributes>
    								<xf:input ref="data:dma_slipD.total_amt" dataType="number" displayFormat="#,###" adjustMaxLength="false"
    									style="" id="inputTotalAmt" title="거래처" class="inp full ri req" ev:onviewchange="scwin.inputTotalAmt_onviewchange">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="tr" style="" id="grp_amt">
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="결의금액"></w2:textbox>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes></w2:attributes>
    								<xf:input ref="data:dma_slipD.unslip_amt" dataType="number" displayFormat="#,###"
    									adjustMaxLength="false" style="" readOnly="true" id="inputUnslipAmt" title="결의금액" class="inp full ri">
    								</xf:input>
    							</xf:group>
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="세액"></w2:textbox>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes></w2:attributes>
    								<xf:input ref="data:dma_slipD.tax_amt" dataType="number" displayFormat="#,###" adjustMaxLength="false"
    									style="" readOnly="true" id="inputTaxAmt" title="세액" class="inp full ri">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="tr" style="">
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="적요"></w2:textbox>
    								<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes>
    									<w2:colspan>3</w2:colspan>
    									<w2:rowspan>1</w2:rowspan>
    								</w2:attributes>
    								<xf:input ref="data:dma_slipD.rmk_1" ev:onviewchange="scwin.ibx_rmk_1_onviewchange"
    									adjustMaxLength="false" style="" id="ibx_rmk_1" title="적요" class="inp full req">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="tr" style="" id="grp_ctrl">
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="통제번호"></w2:textbox>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes></w2:attributes>
    								<xf:input ref="data:dma_slipD.ctrl_no" adjustMaxLength="false" style="" readOnly="true" id=""
    									title="통제번호" class="inp full">
    								</xf:input>
    							</xf:group>
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="예산잔액"></w2:textbox>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes></w2:attributes>
    								<xf:input dataType="number" displayFormat="#,###" adjustMaxLength="false" style="" readOnly="true"
    									id="inputBugtRamtAmt" title="예산잔액" class="inp full ri">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="tr" style="">
    							<xf:group tagname="th" class="w2tb_th">
    								<w2:attributes>
    									<w2:scope>row</w2:scope>
    								</w2:attributes>
    								<w2:textbox tagname="span" style="" id="" label="증빙파일"></w2:textbox>
    							</xf:group>
    							<xf:group tagname="td" class="w2tb_td">
    								<w2:attributes>
    									<w2:colspan>3</w2:colspan>
    									<w2:rowspan>1</w2:rowspan>
    								</w2:attributes>
    								<xf:group style="height:125px;">
    									<xf:group style="height:100%;" id="upload_A" class="full"></xf:group>
    								</xf:group>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<w2:wframe src="/ui/com/pop/COM_F001_00P.xml" style="" id="wfm_evid"></w2:wframe>
    					<xf:group style="" id="grp_sendreq_title" class="titleSection">
    						<xf:group id="" class="le">
    							<w2:textbox tagname="h3" style="" id="" label="송금내역" class="tit_tbl"></w2:textbox>
    						</xf:group>
    						<xf:group id="" class="ri">
    							<xf:group style="" id="" class="btnarea">
    								<xf:trigger style="" id="btn_accVerf" type="button" class="btn" ev:onclick="scwin.btn_accVerf_onclick">
    									<xf:label><![CDATA[계좌검증]]></xf:label>
    								</xf:trigger>
    								<xf:trigger ev:onclick="scwin.btn_add_onclick" style="" id="btn_add" type="button" class="bt_plus">
    									<xf:label><![CDATA[추가]]></xf:label>
    								</xf:trigger>
    								<xf:trigger ev:onclick="scwin.btn_sendDel_onclick" style="" id="btn_sendDel" type="button"
    									class="bt_minus">
    									<xf:label><![CDATA[삭제]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<w2:gridView rowNumVisible="true" rowStatusWidth="50" rowNumHeaderValue="No." scrollByColumn="false"
    						defaultCellHeight="28" rowNumBackgroundColor="#fff" selectedCellColor="#fbf2cd" rowNumWidth="60" evenRowBackgroundColor="#f7faff"
    						autoFit="allColumn" id="grd_sendreq" class="grid" scrollByColumnAdaptive="false" editModeEvent="onclick"
    						selectedRowColor="#fbf2cd" summaryAuto="true" readOnly="true" rowStatusHeaderValue="상태" noResultMessage="조회 결과가 없습니다."
    						noResultMessageClass="noResult" rowStatusVisible="false" dataList="data:dlt_sendreq"
    						ev:onviewchange="scwin.grd_sendreq_onviewchange" style="height: 85px;" visibleRowNum="5" rowMouseOverColor="#e7f0fb"
    						ev:oncellclick="scwin.grd_sendreq_oncellclick">
    						<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
    						<w2:header style="" id="header1">
    							<w2:row style="" id="row1">
    								<w2:column width="70" inputType="text" style="height:28px;" id="column5" value="구분"
    									displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="text" style="height:28px;" id="column3" value="금액"
    									displayMode="label">
    								</w2:column>
    								<w2:column width="130" inputType="text" style="height:28px;" id="column20" value="개인(거래처)"
    									displayMode="label" colSpan="2" rowSpan="">
    								</w2:column>
    								<w2:column width="100" inputType="text" style="height:28px" id="column27" value="입금계좌"
    									displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="text" style="height:28px" id="column25" value="예금주"
    									displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="text" style="height:28px" id="column23" value="은행"
    									displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="text" style="height:28px" id="column21" value="검증결과	"
    									displayMode="label">
    								</w2:column>
    							</w2:row>
    						</w2:header>
    						<w2:gBody style="" id="gBody1">
    							<w2:row style="" id="row2">
    								<w2:column width="70" inputType="select" readOnly="false" style="height:28px;" id="pay_clsf"
    									escape="false" displayMode="label" viewType="icon">
    								</w2:column>
    								<w2:column dataType="number" width="70" displayFormat="#,###" inputType="text" readOnly="false"
    									style="height:28px;" id="send_req_amt" escape="false" class="ri" displayMode="label">
    								</w2:column>
    								<w2:column width="100" inputType="text" style="height:28px;" readOnly="true" id="emp_vend"
    									displayMode="label">
    								</w2:column>
    								<w2:column width="30" inputType="image" style="height:28px" id="btn_emp_vend" value=""
    									displayMode="label" imageSrc="/cm/images/sample/btn_tbsearch02.png">
    								</w2:column>
    								<w2:column width="100" inputType="text" style="height:28px" id="bankaccnt_no" allowChar="0-9-" value=""
    									displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="text" style="height:28px" id="depstr_nm" value=""
    									displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="select" style="height:28px" id="bank" value="" displayMode="label">
    								</w2:column>
    								<w2:column width="70" inputType="select" style="height:28px" id="is_account" value=""
    									displayMode="label" allOption="" chooseOption="" ref="">
    									<w2:choices>
    										<w2:item>
    											<w2:label><![CDATA[미검증]]></w2:label>
    											<w2:value><![CDATA[0]]></w2:value>
    										</w2:item>
    										<w2:item>
    											<w2:label><![CDATA[검증]]></w2:label>
    											<w2:value><![CDATA[1]]></w2:value>
    										</w2:item>
    										<w2:item>
    											<w2:label><![CDATA[검증오류]]></w2:label>
    											<w2:value><![CDATA[2]]></w2:value>
    										</w2:item>
    									</w2:choices>
    								</w2:column>
    							</w2:row>
    						</w2:gBody>
    					</w2:gridView>
    				</xf:group>
    				<xf:group class="w2tb tbl" id="grp_dedct" style="display:none;" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption" text=" 상세정보"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    						<xf:group style="width:140px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="계정번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:group class="flex" id="">
    								<xf:input adjustMaxLength="false" class="inp" id="" style="width: 150px;" title="계정번호 " readOnly="true"
    									ref="data:dma_slipD.accnt_no">
    								</xf:input>
    								<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="계정번호 상세" readOnly="true"
    									ref="data:dma_slipD.accnt_no_nm">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="비용코드" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:group class="flex" id="">
    								<xf:group class="inpSch" id="" style="width: 120px;">
    									<xf:input adjustMaxLength="false" class="inp" id="" style="" title="비용코드"
    										ref="data:dma_slipD.expns_cd">
    									</xf:input>
    									<xf:trigger class="btn" id="btn_expns2" style="" title="비용코드 조회" type="button"
    										ev:onclick="scwin.btn_expns_onclick">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    								<xf:input adjustMaxLength="false" class="inp" id="" style="width: 150px;" title="비용코드 상세"
    									readOnly="true" ref="data:dma_slipD.expns_cd_nm">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="회계코드" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:group class="flex" id="">
    								<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="회계코드 1" readOnly="true"
    									ref="data:dma_slipD.accnt_cd">
    								</xf:input>
    								<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="회계코드 2" readOnly="true"
    									ref="data:dma_slipD.accnt_cd_nm">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="거래처" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="거래처" ref="data:dma_slipD.rmk_2"></xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="금액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="거래처"
    								ref="data:dma_slipD.total_amt" dataType="number" displayFormat="#,###">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="ibx_dedct_rmk_1" style="" title="적요"
    								ref="data:dma_slipD.rmk_1" ev:onviewchange="scwin.ibx_rmk_1_onviewchange">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="관련내역" style="" tagname="h3"></w2:textbox>
    					</xf:group>
    					<xf:group class="ri" id=""></xf:group>
    				</xf:group>
    				<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_mngmt" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_mngmt" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    					rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60"
    					rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    					selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5"
    					ev:onviewchange="scwin.grd_mngmt_onviewchange" editModeEvent="onclick" ev:oncellclick="scwin.grd_mngmt_oncellclick">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="관리항목" width="87"></w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="세부적요" width="168"
    								colSpan="2" rowSpan="">
    							</w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="세부적요명"
    								width="300">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="column21" value="필수여부" displayMode="label"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="mngmt_item_nm" inputType="text" readOnly="true"
    								style="height:28px;" width="87">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="mngmt_detls_cd" inputType="text" style="height:28px;"
    								width="137" imageSrc="/cm/images/sample/btn_tbsearch02.png" class="le" typeGetter="getType">
    							</w2:column>
    							<w2:column width="31" inputType="image" style="height:28px" id="img_detls" value="" displayMode="label"
    								imageSrc="/cm/images/sample/btn_tbsearch02.png">
    							</w2:column>
    							<w2:column displayMode="label" id="mngmt_detls_nm" inputType="text" style="height:28px;" width="300"
    								class="le">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="essen_ex" value="" displayMode="label" readOnly="true"></w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:group>
    		</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
