<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="일반결의서" meta_programId="FIN_SPM_F203_00D" meta_programDesc="일반결의, 재무결의를 작성한다. 그 외의 결의서에 대한 결재신청을 할 수 있다." meta_author="이영희" meta_date="2022.05.11.">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            	<w2:dataMap baseNode="map" id="dma_slipH" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="slip_typ_cd" name="결의유형"></w2:key>
            			<w2:key dataType="text" id="wrte_dept" name="작성부서"></w2:key>
            			<w2:key dataType="text" id="wrte_dept_new_ymd" name="작성부서신설일자"></w2:key>
            			<w2:key dataType="text" id="dept_nm" name="작성부서명"></w2:key>
            			<w2:key dataType="text" id="wrte_psn" name="작성자"></w2:key>
            			<w2:key dataType="text" id="empno" name="작성자개인번호"></w2:key>
            			<w2:key dataType="text" id="nm" name="작성자명"></w2:key>
            			<w2:key id="ext_no" name="전화번호" dataType="text"></w2:key>
            			<w2:key dataType="text" id="slip_ymd" name="결의일자"></w2:key>
            			<w2:key dataType="text" id="rmk" name="적요"></w2:key>
            			<w2:key dataType="text" id="decsn_ex" name="확정여부"></w2:key>
            			<w2:key dataType="text" id="decsn_ex_nm" name="확정여부명"></w2:key>
            			<w2:key dataType="text" id="accnt_ymd" name="확정일자"></w2:key>
            			<w2:key dataType="text" id="slip_no" name="확정결의번호"></w2:key>
            			<w2:key dataType="text" id="cud_type" name="CUD타입"></w2:key>
            			<w2:key id="apr_state" name="결재상태" dataType="text"></w2:key>
            			<w2:key id="aset_reg" name="자산등록" dataType="text"></w2:key>
            			<w2:key id="aset_manager" name="자산관리자" dataType="text"></w2:key>
            			<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
            			<w2:key id="approval" name="결재여부" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_search" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="unslip_odr" name="결의순번"></w2:key>
            			<w2:key dataType="text" id="accnt_cd" name="회계코드"></w2:key>
            			<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
            			<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
            			<w2:key dataType="text" id="issu_seqno" name="계산서번호"></w2:key>
            			<w2:key dataType="text" id="base_debit_cr" name="차대구분"></w2:key>
            			<w2:key id="code_clsf" name="코드구분(분개유형)" dataType="text"></w2:key>
            			<w2:key id="slip_typ_cd" name="결의유형" dataType="text"></w2:key>
            			<w2:key id="journ_cd" name="분개유형" dataType="text"></w2:key>
            			<w2:key id="card_no" name="카드번호" dataType="text"></w2:key>
            			<w2:key id="card_knd" name="카드종류" dataType="text"></w2:key>
            			<w2:key id="card_clsf" name="카드구분" dataType="text"></w2:key>
            			<w2:key id="use_ymd" name="사용일시" dataType="text"></w2:key>
            			<w2:key id="apprvl_no" name="승인번호" dataType="text"></w2:key>
            			<w2:key id="inqr_clsf" name="조회구분" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_slipDr" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="fomat_unit" name="편성단위"></w2:column>
            			<w2:column dataType="text" id="journ_cd" name="분개코드"></w2:column>
            			<w2:column dataType="text" id="journ_odr" name="분개순번"></w2:column>
            			<w2:column dataType="text" id="base_debit_cr" name="차대구분"></w2:column>
            			<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
            			<w2:column dataType="text" id="accnt_no_nm" name="계정명"></w2:column>
            			<w2:column dataType="text" id="accnt_rspns" name="계정책임자"></w2:column>
            			<w2:column dataType="text" id="accnt_cd" name="회계코드"></w2:column>
            			<w2:column dataType="text" id="accnt_cd_nm" name="회계코드명"></w2:column>
            			<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
            			<w2:column dataType="text" id="expns_cd_nm" name="비용코드명"></w2:column>
            			<w2:column dataType="text" id="tax_cd" name="과세구분"></w2:column>
            			<w2:column dataType="text" id="mngmt_clsf" name="관리구분"></w2:column>
            			<w2:column dataType="number" id="unslip_amt" name="결의금액"></w2:column>
            			<w2:column dataType="number" id="total_amt" name="총액"></w2:column>
            			<w2:column dataType="number" id="tax_amt" name="세액"></w2:column>
            			<w2:column dataType="text" id="ctrl_no" name="통제번호"></w2:column>
            			<w2:column dataType="text" id="evid_cd" name="증빙코드"></w2:column>
            			<w2:column dataType="text" id="ramt_mngmt_1" name="잔액관리항목1"></w2:column>
            			<w2:column dataType="text" id="ramt_mngmt_2" name="잔액관리항목2"></w2:column>
            			<w2:column dataType="text" id="rmk_1" name="적요"></w2:column>
            			<w2:column dataType="text" id="rmk_2" name="거래처"></w2:column>
            			<w2:column dataType="text" id="rmk_3" name="비고3"></w2:column>
            			<w2:column id="part_all_clsf" name="부분전체구분" dataType="text"></w2:column>
            			<w2:column dataType="text" id="attach_file_no" name="첨부파일번호"></w2:column>
            			<w2:column dataType="text" id="pay_clsf" name="지급구분"></w2:column>
            			<w2:column id="req_no" name="신청번호" dataType="text"></w2:column>
            			<w2:column dataType="text" id="occr_slip_no" name="발생결의번호"></w2:column>
            			<w2:column dataType="text" id="occr_slip_odr" name="발생결의순번"></w2:column>
            			<w2:column dataType="text" id="bf_occr_slip_no" name="이전발생결의번호"></w2:column>
            			<w2:column dataType="text" id="bf_occr_slip_odr" name="이전발생결의순번"></w2:column>
            			<w2:column dataType="text" id="accnt_no_clsf" name="계정번호구분"></w2:column>
            			<w2:column dataType="number" id="bf_total_amt" name="이전결의총액"></w2:column>
            			<w2:column dataType="number" id="bf_unslip_amt" name="이전결의금액"></w2:column>
            			<w2:column dataType="text" id="cud_type" name="CUD유형"></w2:column>
            			<w2:column dataType="text" id="evid_yn" name="이지바로 증빙구분"></w2:column>
            			<w2:column dataType="text" id="service_id" name="이지바로 증빙 serviceId"></w2:column>
            			<w2:column dataType="text" id="bill_no" name="계산서번호"></w2:column>
            			<w2:column dataType="text" id="issu_ymd" name="계산서발행일자"></w2:column>
            			<w2:column id="itm_solve_base" name="비목해소기준" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="dlt_mngmt" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="mngmt_item_cd" name="관리항목코드"></w2:column>
            			<w2:column dataType="text" id="mngmt_item_nm" name="관리항목이름"></w2:column>
            			<w2:column dataType="text" id="mngmt_detls_cd" name="관리상세코드"></w2:column>
            			<w2:column dataType="text" id="mngmt_detls_nm" name="관리상세명"></w2:column>
            			<w2:column dataType="text" id="essen_ex" name="필수여부"></w2:column>
            			<w2:column dataType="text" id="data_form" name="데이터형식"></w2:column>
            			<w2:column dataType="text" id="cud_type" name="cud타입"></w2:column>
            			<w2:column dataType="text" id="img_detls" name="세부팝업"></w2:column>
            			<w2:column id="updt_possbl_yn" name="수정가능여부" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_slipD" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="unslip_odr" name="결의순번"></w2:key>
            			<w2:key dataType="text" id="fomat_unit" name="편성단위"></w2:key>
            			<w2:key dataType="text" id="journ_cd" name="분개코드"></w2:key>
            			<w2:key dataType="text" id="journ_odr" name="분개순번"></w2:key>
            			<w2:key dataType="text" id="base_debit_cr" name="차대구분"></w2:key>
            			<w2:key dataType="text" id="accnt_no" name="계정번호"></w2:key>
            			<w2:key dataType="text" id="accnt_no_nm" name="계정명"></w2:key>
            			<w2:key dataType="text" id="accnt_rspns" name="계정책임자"></w2:key>
            			<w2:key dataType="text" id="accnt_cd" name="회계코드"></w2:key>
            			<w2:key dataType="text" id="accnt_cd_nm" name="회계코드명"></w2:key>
            			<w2:key dataType="text" id="expns_cd" name="비용코드"></w2:key>
            			<w2:key dataType="text" id="expns_cd_nm" name="비용코드명"></w2:key>
            			<w2:key dataType="text" id="tax_cd" name="과세구분"></w2:key>
            			<w2:key dataType="text" id="mngmt_clsf" name="관리구분"></w2:key>
            			<w2:key dataType="number" id="unslip_amt" name="결의금액"></w2:key>
            			<w2:key dataType="number" id="total_amt" name="총액"></w2:key>
            			<w2:key dataType="number" id="tax_amt" name="세액"></w2:key>
            			<w2:key dataType="text" id="ctrl_no" name="통제번호"></w2:key>
            			<w2:key dataType="text" id="evid_cd" name="증빙코드"></w2:key>
            			<w2:key dataType="text" id="ramt_mngmt_1" name="잔액관리항목1"></w2:key>
            			<w2:key dataType="text" id="ramt_mngmt_2" name="잔액관리항목2"></w2:key>
            			<w2:key dataType="text" id="rmk_1" name="적요"></w2:key>
            			<w2:key dataType="text" id="rmk_2" name="거래처"></w2:key>
            			<w2:key id="rmk_3" name="비고3" dataType="text"></w2:key>
            			<w2:key dataType="text" id="attach_file_no" name="첨부파일번호"></w2:key>
            			<w2:key dataType="text" id="pay_clsf" name="지급구분"></w2:key>
            			<w2:key dataType="text" id="occr_slip_no" name="발생결의번호"></w2:key>
            			<w2:key dataType="text" id="occr_slip_odr" name="발생결의순번"></w2:key>
            			<w2:key dataType="text" id="bf_occr_slip_no" name="이전발생결의번호"></w2:key>
            			<w2:key dataType="text" id="bf_occr_slip_odr" name="이전발생결의순번"></w2:key>
            			<w2:key dataType="text" id="part_all_clsf" name="부분전체구분"></w2:key>
            			<w2:key dataType="text" id="accnt_no_clsf" name="계정번호구분"></w2:key>
            			<w2:key dataType="number" id="bf_total_amt" name="이전결의총액"></w2:key>
            			<w2:key dataType="number" id="bf_unslip_amt" name="이전결의금액"></w2:key>
            			<w2:key dataType="text" id="cud_type" name="CUD유형"></w2:key>
            			<w2:key dataType="text" id="evid_yn" name="이지바로 증빙구분"></w2:key>
            			<w2:key dataType="text" id="service_id" name="이지바로 증빙 serviceId"></w2:key>
            			<w2:key dataType="text" id="validAttachNo" name="유효첨부파일번호"></w2:key>
            			<w2:key dataType="text" id="bill_no" name="계산서번호"></w2:key>
            			<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
            			<w2:key id="req_seq" name="신청순번" dataType="text"></w2:key>
            			<w2:key id="card_no" name="카드번호" dataType="text"></w2:key>
            			<w2:key id="card_clsf" name="카드종류" dataType="text"></w2:key>
            			<w2:key id="card_knd" name="카드구분" dataType="text"></w2:key>
            			<w2:key id="use_ymd" name="사용일자" dataType="text"></w2:key>
            			<w2:key id="apprvl_no" name="승인번호" dataType="text"></w2:key>
            			<w2:key id="itm_solve_base" name="비목해소기준" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_sendreq" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="send_odr" name="송금순번"></w2:column>
            			<w2:column dataType="text" id="pay_clsf" name="지급구분"></w2:column>
            			<w2:column dataType="text" id="send_req_amt" name="송금의뢰금액"></w2:column>
            			<w2:column dataType="text" id="vend_cd" name="거래처코드"></w2:column>
            			<w2:column dataType="text" id="vend_nm" name="거래처명"></w2:column>
            			<w2:column dataType="text" id="syspayno" name="시스템개인번호"></w2:column>
            			<w2:column dataType="text" id="emp_vend" name="개인(거래처)"></w2:column>
            			<w2:column dataType="text" id="bankaccnt_no" name="계좌번호"></w2:column>
            			<w2:column dataType="text" id="bank" name="은행"></w2:column>
            			<w2:column dataType="text" id="depstr_nm" name="예금주명"></w2:column>
            			<w2:column dataType="text" id="bsns_psn_regst_no" name="사업자등록번호"></w2:column>
            			<w2:column dataType="text" id="rmk" name="비고"></w2:column>
            			<w2:column dataType="text" id="cud_type" name="CUD타입"></w2:column>
            			<w2:column dataType="text" id="is_account" name="계좌검증"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="dlt_journ_dr" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="code" name="코드"></w2:column>
            			<w2:column dataType="text" id="code_nm" name="코드명"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_bill" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="issu_seqno" name="계산서번호"></w2:key>
            			<w2:key dataType="text" id="bsns_psn_regst_no" name="사업자번호"></w2:key>
            			<w2:key dataType="text" id="regs_date" name="발행일자"></w2:key>
            			<w2:key dataType="text" id="vend_nm" name="가맹점"></w2:key>
            			<w2:key dataType="number" id="totl_amt" name="총액"></w2:key>
            			<w2:key dataType="number" id="chrg_amt" name="공급가액"></w2:key>
            			<w2:key dataType="number" id="tax_amt" name="과세금액"></w2:key>
            			<w2:key dataType="number" id="un_amt" name="미처리금액"></w2:key>
            			<w2:key dataType="text" id="bankaccnt_no" name="계좌번호"></w2:key>
            			<w2:key dataType="text" id="evid_cd" name="증빙코드"></w2:key>
            			<w2:key dataType="text" id="depstr_nm" name="예금주"></w2:key>
            			<w2:key dataType="text" id="bank" name="은행"></w2:key>
            			<w2:key dataType="text" id="vend_cd" name="거래처코드"></w2:key>
            			<w2:key dataType="text" id="note3" name="노트3"></w2:key>
            			<w2:key dataType="text" id="detail_yn" name="계산서디테일등록여부"></w2:key>
            			<w2:key id="public_amt_yn" name="공공요금여부" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_journ_cr" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="code" name="코드"></w2:column>
            			<w2:column dataType="text" id="code_nm" name="코드명"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="dlt_slipCr" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="fomat_unit" name="편성단위"></w2:column>
            			<w2:column dataType="text" id="journ_cd" name="분개코드"></w2:column>
            			<w2:column dataType="text" id="journ_odr" name="분개순번"></w2:column>
            			<w2:column dataType="text" id="base_debit_cr" name="차대구분"></w2:column>
            			<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
            			<w2:column dataType="text" id="accnt_no_nm" name="계정명"></w2:column>
            			<w2:column dataType="text" id="accnt_rspns" name="계정책임자"></w2:column>
            			<w2:column dataType="text" id="accnt_cd" name="회계코드"></w2:column>
            			<w2:column dataType="text" id="accnt_cd_nm" name="회계코드명"></w2:column>
            			<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
            			<w2:column dataType="text" id="expns_cd_nm" name="비용코드명"></w2:column>
            			<w2:column dataType="text" id="tax_cd" name="과세구분"></w2:column>
            			<w2:column dataType="text" id="mngmt_clsf" name="관리구분"></w2:column>
            			<w2:column dataType="number" id="unslip_amt" name="결의금액"></w2:column>
            			<w2:column dataType="number" id="total_amt" name="총액"></w2:column>
            			<w2:column dataType="number" id="tax_amt" name="세액"></w2:column>
            			<w2:column dataType="text" id="ctrl_no" name="통제번호"></w2:column>
            			<w2:column dataType="text" id="evid_cd" name="증빙코드"></w2:column>
            			<w2:column dataType="text" id="ramt_mngmt_1" name="잔액관리항목1"></w2:column>
            			<w2:column dataType="text" id="ramt_mngmt_2" name="잔액관리항목2"></w2:column>
            			<w2:column dataType="text" id="rmk_1" name="적요"></w2:column>
            			<w2:column dataType="text" id="rmk_2" name="거래처"></w2:column>
            			<w2:column dataType="text" id="attach_file_no" name="첨부파일번호"></w2:column>
            			<w2:column dataType="text" id="pay_clsf" name="지급구분"></w2:column>
            			<w2:column dataType="text" id="occr_slip_no" name="발생결의번호"></w2:column>
            			<w2:column dataType="text" id="occr_slip_odr" name="발생결의순번"></w2:column>
            			<w2:column dataType="text" id="bf_occr_slip_no" name="이전발생결의번호"></w2:column>
            			<w2:column dataType="text" id="bf_occr_slip_odr" name="이전발생결의순번"></w2:column>
            			<w2:column dataType="text" id="accnt_no_clsf" name="계정번호구분"></w2:column>
            			<w2:column dataType="number" id="bf_total_amt" name="이전결의총액"></w2:column>
            			<w2:column dataType="number" id="bf_unslip_amt" name="이전결의금액"></w2:column>
            			<w2:column dataType="text" id="cud_type" name="CUD유형"></w2:column>
            			<w2:column dataType="text" id="evid_yn" name="이지바로 증빙구분"></w2:column>
            			<w2:column dataType="text" id="service_id" name="이지바로 증빙 serviceId"></w2:column>
            			<w2:column dataType="text" id="bill_no" name="계산서번호"></w2:column>
            			<w2:column dataType="text" id="issu_ymd" name="계산서발행일자"></w2:column>
            			<w2:column id="card_no" name="카드번호" dataType="text"></w2:column>
            			<w2:column id="card_clsf" name="카드종류" dataType="text"></w2:column>
            			<w2:column id="card_knd" name="카드구분" dataType="text"></w2:column>
            			<w2:column id="use_ymd" name="사용일자" dataType="text"></w2:column>
            			<w2:column id="apprvl_no" name="승인번호" dataType="text"></w2:column>
            			<w2:column id="itm_solve_base" name="비목해소기준" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_searchMng" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
            			<w2:key dataType="text" id="unslip_odr" name="결의순번"></w2:key>
            			<w2:key id="accnt_cd" name="회계코드" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_return" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="accnt_cd" name="회계코드"></w2:key>
            			<w2:key dataType="text" id="accnt_cd_abbr" name="회계코드명"></w2:key>
            			<w2:key dataType="text" id="fin_bsns_clsf" name="재무사업구분"></w2:key>
            			<w2:key dataType="text" id="caseby_adjst_ex" name="건별정산유무"></w2:key>
            			<w2:key dataType="text" id="bond_degt_clsf" name="채권채무구분"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_card" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="card_no" name="카드번호"></w2:key>
            			<w2:key dataType="text" id="card_knd" name="카드종류"></w2:key>
            			<w2:key dataType="text" id="card_clsf" name="카드구분"></w2:key>
            			<w2:key dataType="text" id="apprvl_no" name="승인번호"></w2:key>
            			<w2:key dataType="text" id="use_ymd" name="승인일자"></w2:key>
            			<w2:key dataType="text" id="joinsto_nm" name="가맹점명"></w2:key>
            			<w2:key dataType="text" id="shop_addr1" name="가맹점주소1"></w2:key>
            			<w2:key dataType="text" id="shop_addr2" name="가맹점주소2"></w2:key>
            			<w2:key dataType="number" id="supply_amt" name="공급가액"></w2:key>
            			<w2:key dataType="number" id="tax_amt" name="과세금액"></w2:key>
            			<w2:key dataType="number" id="use_amt" name="사용금액"></w2:key>
            			<w2:key dataType="number" id="un_amt" name="미처리금액"></w2:key>
            			<w2:key dataType="text" id="rmk" name="비고"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_cnt" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="cnt" name="개수"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataList baseNode="list" id="dlt_check" repeatNode="map" saveRemovedData="true" style="">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="unslip_no" name="결의번호"></w2:column>
            			<w2:column dataType="text" id="unslip_odr" name="결의순번"></w2:column>
            			<w2:column dataType="text" id="serviceId" name="서비스id"></w2:column>
            			<w2:column dataType="text" id="chk_yn" name="체크YN"></w2:column>
            			<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
            			<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
            			<w2:column dataType="text" id="expns_cd_nm" name="비용코드명"></w2:column>
            			<w2:column dataType="text" id="chk_cnt" name="체크개수"></w2:column>
            			<w2:column dataType="text" id="rtn_msg" name="리턴메시지"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
            <!-- 결의내역 조회 -->
        	<xf:submission id="sbm_selectSlip" ref="data:json,dma_search"
        		target='data:json,[{"id":"dma_slipH","key":"hVo"},{"id":"dlt_slipDr","key":"drList"},{"id":"dlt_slipCr","key":"crList"}]'
        		action="SvcFINSPMEXPR10.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	
        	<!-- 저장 -->
        	<xf:submission id="sbm_saveSlip"
        		ref='data:json,[{"id":"dma_slipH", "key":"slipHVo"},{"action":"modified","id":"dma_slipD", "key":"slipDVo"},{"action":"modified","id":"dlt_sendreq", "key":"sendList"},{"action":"modified","id":"dlt_mngmt", "key":"mngmtList"}]'
        		target='data:json,dma_search' action="SvcFINSPMEXPM01.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 회계코드별 관리항목 조회 -->
        	<xf:submission id="sbm_selectMngmtItem" ref="data:json,dma_search" target='data:json,{"id":"dlt_mngmt","key":"mngmtVo"}'
        		action="SvcFINSPMEXPR04.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 관리항목 및 계산서정보,송금내역 -->
        	<xf:submission id="sbm_selectSlipMngmts" ref="data:json,dma_search" target='data:json,[{"id":"dlt_mngmt", "key":"mngmtList"},{"id":"dma_bill", "key":"billVo"},{"id":"dlt_sendreq", "key":"sendList"},{"id":"dma_card", "key":"cardVo"}]' 
        	    action="SvcFINSPMEXPR13.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결의서 삭제 -->
        	<xf:submission id="sbm_deleteSlip" ref="data:json,dma_slipD" target='' action="SvcFINSPMEXPD01.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 이지바로과제증빙건수조회 -->
        	<xf:submission id="sbm_selectItmEvidDetlsCnt" ref="data:json,dma_search" target='data:json,dma_cnt' action="SvcFINSPMEXPR06.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 분개유형 차변 -->
        	<xf:submission id="sbm_selectJournListDr" ref="data:json,dma_search" target='data:json,{"id":"dlt_journ_dr","key":"codeNmList"}' 
        	    action="SvcFINCOMCODR01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 분개유형 대변 -->
        	<xf:submission id="sbm_selectJournListCr" ref="data:json,dma_search" target='data:json,{"id":"dlt_journ_cr","key":"codeNmList"}' 
        	    action="SvcFINCOMCODR01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 결의내역 대체처리 관리항목내역 -->
        	<xf:submission id="sbm_selectSlipMngmt" ref="data:json,dma_searchMng" target='data:json,{"id":"dlt_mngmt","key":"mngmtList"}' 
        	    action="SvcFINSPMEXPR11.pwkjson" method="post" mediatype="application/json" 
        	    encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" 
        	    ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 수입처리 회계코드조회 -->
        	<xf:submission id="sbm_selectAccntCdBy" ref="data:json,dma_search" target='data:json,dma_return' action="SvcFINSPMEXPR12.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 계산서 내역 조회 -->
        	<xf:submission id="sbm_selectBillInfo" ref="data:json,dma_search"
        		target='' action="SvcFINSPMEXPR08.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	
        	<!-- 결재신청전 체크 -->
        	<xf:submission id="sbm_selectPreAprCheck" ref="data:json,dma_search" target='data:json,{"id":"dlt_check","key":"checkList"}' 
        	    action="SvcFINSPMEXPR15.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        </xf:model>
         <script src="/cm/js/biz/fin.js" cache="false" />
         <script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 일반결의 생성
	 * 변경 이력 : 2022-05-11	이영희	최초 작성
	 * serviceId : 일반결의(F203), 재무결의(F204)
	 ****************************************************/
	// 전자증빙
	scwin.evidParam = {
		doc_id : "110"
	};

	scwin.data = {
		today : com.getServerDateTime(),
		slip_ymd : "",
		typeCode : "",
		mngmt :{},
		allowExtension : "PDF,ppt,pptx,pptm,pps,ppsx,xls,xlsx,xlsm,doc,docx,docm,rif,txt,hwp,url,mht,mhtml,htm,html,jpg,jpeg,tif,tiff,gif,png,bmp"
	};

	scwin.onpageload = function() {
		// 첨부파일 컴포넌트 초기화
		com.file.init();	
		
		// 화면에서 넘어온 변수 셋팅
		var param = com.getParameter();
		if(param.param4 == "apr"){
			dma_search.set("unslip_no", param.req_no);
			scwin.data.serviceId = param.serviceId;
		}else{
			dma_search.set("unslip_no", param.unslip_no);
			scwin.data.serviceId = param.menuObj.serviceID;
		}
		
		if(!com.isEmpty(dma_search.get("unslip_no"))){
			dma_search.set("slip_typ_cd", dma_search.get("unslip_no").substring(0,3));
		}else{
			dma_search.set("slip_typ_cd", param.slip_typ_cd);
			if(param.param4 == "apr" || scwin.data.serviceId == "F203"){
				dma_search.set("slip_typ_cd", "110");
			}
		}
		
		// session data
		var session = com.getLoginInfo();
		scwin.data.sn = session.sn;
		scwin.data.deptCode = session.deptCode;

		// 화면 권한 체크
		com.biz.checkRole({serviceId : "F203", roleCodes : session.roleCode}, function(e){
			if(e.isRoleYn){
				ibx_empno.setDisabled(false);
				btn_emp.setDisabled(false);
			}else{
				ibx_empno.setDisabled(true);
				btn_emp.setDisabled(true);
			}
		});
		
		// 신규 등록에 사용하는 dataMap 빈값으로 초기화
		com.initDataMap(dma_slipD);
		
		// 변경사항 체크
		//scwin.checkList = [dma_slipD];

		// enter key event
		//com.setEnterKeyEvent(grp_accnt_no, scwin.btn_accntNo_onclick);
		com.setEnterKeyEvent(grp_expns_cd, scwin.btn_expns_onclick);
		com.setEnterKeyEvent(grp_wrte_psn, scwin.btn_emp_onclick);		
		
		// 분개유형별 폼 셋팅
		scwin.settingForm("");
		
		// 첨부파일
		if(!scwin.data.typeCode){
			scwin.data.typeCode = scwin.data.serviceId;
		}
		
		// 공통코드
		// 재무결의일때만 지급구분에 [현금]보임
		var codeOptions = [{ code : "FAA", compID :"grd_sendreq:bank" },
						   { code : "FAX", compID :"grd_sendreq:pay_clsf" }
					];		
		com.setCmnCd(codeOptions, function() {
			if(scwin.data.serviceId == "F204"){
				//dataFax.filter = "mngmt_item_5 == 'Y'";
				var row = dlt_cmnCd_FAX.getMatchedIndex("pay_clsf", "FAX900", true)[0];
				dlt_cmnCd_FAX.removeRow(row);
				dlt_cmnCd_FAX.reform();
			}
		});
		
		// 분개유형 차변
		dma_search.set("code_clsf", "journ_cd");
		dma_search.set("base_debit_cr", "1");
		com.execute(sbm_selectJournListDr, {
			successCallback : function(e){
				// 이전화면에서 파라미터 받음
				if (dma_search.get("unslip_no") != "") {
					scwin.evidParam.req_no = dma_search.get("unslip_no");
		
					//조회실행
					scwin.search();
				} else {		
					com.initDataMap(dma_slipH);
					// 첨부파일
					com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});
		
					dma_slipH.set("slip_typ_cd", dma_search.get("slip_typ_cd"));
					dma_slipH.set("cud_type", "C");
					dma_slipH.set("wrte_psn", session.sn);
					dma_slipH.set("nm", session.cn);
					dma_slipH.set("empno", session.empno);
					dma_slipH.set("wrte_dept", session.deptCode);
					dma_slipH.set("wrte_dept_new_ymd", session.deptNewYmd);
					dma_slipH.set("dept_nm", session.deptName);
					dma_slipH.set("slip_ymd", scwin.data.today);			
				}
			}
		});
		
		// 분개유형 대변
		dma_search.set("base_debit_cr", "2");
		com.execute(sbm_selectJournListCr, {
			successCallback : function(e){				
			}
		});
	};

	scwin.onpageunload = function() {
	};
	
	/**
	 * 결의서  조회
	 */
	scwin.search = function(flag) {		
		com.execute(sbm_selectSlip, {
			successCallback : function(e) {
				tbx_cnt.setValue(dlt_slipDr.getRowCount());
				spn_cnt.setValue(dlt_slipCr.getRowCount());
				
				btn_print.setDisabled(false);
				btn_evid_view.setDisabled(false);
				
				// 차변 합계
				var totalAmtSum = 0;
				for(var i=0; i<dlt_slipDr.getRowCount(); i++){
					totalAmtSum += Number(dlt_slipDr.getCellData(i, "total_amt"));
				}
				ibx_total_amt_sum_dr.setValue(totalAmtSum);
				
				// 대변 합계
				totalAmtSum = 0;
				for(var i=0; i<dlt_slipCr.getRowCount(); i++){
					totalAmtSum += Number(dlt_slipCr.getCellData(i, "total_amt"));
				}
				ibx_total_amt_sum_cr.setValue(totalAmtSum);		
				
				// 일반결의가 아닐 경우 결의일자 변경 불가
				scwin.data.slip_ymd = dma_slipH.get("slip_ymd"); // 일반결의일 경우에도 다른월로 수정못하게 체크하기 위해서 필요
				if(dma_slipH.get("unslip_no").substring(0,3) != "110"){
					ica_slip_ymd.setDisabled(true);
				}		
				
				var aprState = dma_slipH.get("apr_state");
				scwin.data.apr_state = aprState;
				
				if (dma_slipH.get("decsn_ex") == "Y") {
					btn_save.setDisabled(true);
					btn_del.setDisabled(true);
					btn_apr.setDisabled(true);
					sbx_journ_cd_dr.setDisabled(true);
					sbx_journ_cd_cr.setDisabled(true);
					
					grp_wrte_msg.hide();
				}else{
					if (aprState == "") {
						grp_wrte_msg.show("");
						tbx_msg.setValue("결재 상태가 존재하지 않습니다. 담당자에게 문의해 주세요.");	
					}else if(/XAD005|XAD010|XAD013|XAD015/.test(aprState)){
						grp_wrte_msg.show("");
						if(/XAD005|XAD010/.test(aprState)){
							tbx_msg.setValue("결재가 상신 전 단계입니다./수정과 삭제가 가능합니다.");	
						}else if (aprState == "XAD013"){
							tbx_msg.setValue("결재가 회수처리 되었습니다./재신청이 가능합니다.");	
						}else if (aprState == "XAD015"){
							tbx_msg.setValue("결재가 반려처리 되었습니다./재신청이 가능합니다.");	
						}
					}else{
						grp_wrte_msg.hide();
						if (aprState == "XAD100") {
							tbx_msg.setValue("결재가 완료되었습니다.");				
						}else{
							tbx_msg.setValue("결제가 진행중입니다./수정과 삭제가 불가능합니다.");	
						}
					}
					
					// 버튼 제어
					// TODO
					if(dma_slipH.get("slip_typ_cd") != "150"){
						com.biz.disabledButtons(aprState, dma_slipH.get("unslip_no"));
					}else{
						btn_del.setDisabled(false);	
					}
				}				

				if(dlt_slipDr.getRowCount() > 0){
					grd_slipdr.setFocusedCell(0,0);
					dma_slipD.setJSON(dlt_slipDr.getRowJSON(0));
				}else{
					grd_slipcr.setFocusedCell(0,0);
					dma_slipD.setJSON(dlt_slipCr.getRowJSON(0));
				}
				scwin.setSlipD();
			}
		});
	};
	
	/**
	 * 관리항목 조회
	 */
	scwin.setMngmt = function(accntCd) {
		dma_search.set("accnt_cd", accntCd);
		dma_search.set("base_debit_cr", dma_slipD.get("base_debit_cr"));

		com.execute(sbm_selectMngmtItem, {
			successCallback : function(e) {
				if(dma_slipD.get("base_debit_cr") == '1' && dma_slipD.get("bill_no") != ""){
					var rows = dlt_mngmt.getRowCount();
					dlt_mngmt.insertRow(rows);
					dlt_mngmt.setCellData(rows, "mngmt_item_cd", "4043");
					dlt_mngmt.setCellData(rows, "mngmt_item_nm", "납기일자");
					dlt_mngmt.setCellData(rows, "mngmt_detls_cd", dma_bill.get("regs_date"));					
				}				
				
				scwin.setGrdMngmt(); // 관리항목 버튼 제어
				
				// 예금입금처리(차변), 예금출금처리(대변)
				if(/Fn0230|Fn0220/.test(dma_slipD.get("journ_cd"))){
					scwin.setDepst();
				}else if(/Fn0100|Fn0105/.test(dma_slipD.get("journ_cd"))){ // Fn0100 채무반제처리, Fn0105 On-Line입금(가수반제)
					scwin.setCreateDebt(dma_slipD.get("journ_cd"));
					
				}else if(/Fn0090/.test(dma_slipD.get("journ_cd"))){ // 채권반제처리(대변)
					scwin.setRamtAdjstBond();	
				}else if(/Fn0196|Fn0197|Fn0190/.test(dma_slipD.get("journ_cd"))){ // Fn0196 어음부도처리, Fn0197 어음유동성대체처리, Fn0190 어음회수처리
					scwin.setPrmsntList();	
					
				}else if(/Fn0120/.test(dma_slipD.get("journ_cd"))){ // Fn0120 통제내역결의처리
					scwin.setCtrlMngmtList();						
				}
			}
		});
	};
	
	/**
	 * 예금입금처리, 예금출금처리 관리항목 셋팅
	 */
	scwin.setDepst = function(){
		var data = scwin.data.mngmt;	
			
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			grd_mngmt.setCellDisabled(i, "img_detls", true);
			//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
			
			switch(dlt_mngmt.getCellData(i,"mngmt_item_cd")){
				case "1004" :
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.bank);
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.bank_nm);
					break;
				case "1005" : // 계좌번호
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.bankaccnt_no);
					break;
				case "4002" : // 만기일자
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.expir_ymd);
					break;
				case "4006" : // 계약일자
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.contrct_ymd);
					break;
				case "8004" : // 이자율
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.intrst_rt);
					break;
				default :
					//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
					break;
			}
		}
	};
	
	
	/**
	 * On-Line입금(가수반제), 채무반제 관리항목 셋팅
	 */
	scwin.setCreateDebt = function(journCd){
		var data = scwin.data.mngmt;
		
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			grd_mngmt.setCellDisabled(i, "img_detls", true);
			//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
			
			switch(dlt_mngmt.getCellData(i,"mngmt_item_cd")){
				case "4001" :
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.accnt_ymd);
					break;	
					
				case "1200" : // 관련계정	
				case "8005" : // 관련계정	
					if(/Fn0100/.test(journCd)){
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_1);
					}else if(/Fn0105/.test(journCd)){
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("accnt_no"));
					}
					
					break;		
					
				case "1003" : // 거래처코드
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("rmk_2"));
					break;
				case "1005" : // 계좌번호
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_2);
					if(data.mngmt_item_2 == ""){
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_nm_2);
					}
					break;
						
				case "2060" : // 관련내용	
					if(/Fn0100/.test(journCd)){
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_1);
					}else if(/Fn0105/.test(journCd)){
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("rmk_2"));
					}
					break;				
				
				case "2080" : // 관련통제번호
					if(/Fn0100/.test(journCd)){
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_2);
					}					
					break;
				default :
					//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
					break;
			}
		}
	};
	
	/**
	 * 채권반제처리(대변) 관리항목 셋팅
	 */
	scwin.setRamtAdjstBond = function(){
		var data = scwin.data.mngmt;
		
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			grd_mngmt.setCellDisabled(i, "img_detls", true);
			
			switch(dlt_mngmt.getCellData(i,"mngmt_item_cd")){
				case "1001" : // 개인번호
				case "1003" : // 거래처코드
				case "2051" : // 구매요청번호
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_1);
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.mngmt_item_nm_1);					
					break;
				
				case "1200" : // 관련계정	
					if(scwin.data.mngmt_item_2 == ""){ 
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_1);
						dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.mngmt_item_nm_1);
					}else{
						dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.mngmt_item_2);
						dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.mngmt_item_nm_2);
					}
					break;	
									
				case "3001" : // 거래처명
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("rmk_2"));
					break;
				case "4001" :
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.accnt_ymd);
					break;	
				default :
					//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
					break;
			}
//			
//			if(dlt_mngmt.getCellData(i,"mngmt_detls_cd") != ""){
//				grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
//			}
		}
	};
	
	/**
	 * 어음부도, 유동성, 회수 처리 관리항목 셋팅
	 */
	scwin.setPrmsntList = function(){
		var data = scwin.data.mngmt;
		
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			grd_mngmt.setCellDisabled(i, "img_detls", true);
			
			switch(dlt_mngmt.getCellData(i,"mngmt_item_cd")){				
				case "1003" : // 거래처코드
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.vend_cd);
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.vend_abbr);		
				case "1006" : // 어음번호
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.prmsnt_no);
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.prmsnt_no);					
					break;
				
				case "1120" : // 어음입금의뢰번호
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.depst_req_no);
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.depst_req_no);
					break;	
									
				case "3010" : // 지급은행명
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.pay_bank_nm);
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", data.pay_bank_nm);
					break;
				case "4002" : // 만기일자
				case "4031" : // 정산예정일자
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.expir_ymd);
					break;	
				case "4020" : // 발행일자
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", data.issu_ymd);
					break;	
				default :
					break;
			}
		}
	};
	
	/**
	 * 통제내역결의처리 관리항목 셋팅
	 */
	scwin.setCtrlMngmtList = function(){		
		for(var i=0; i<dlt_mngmt.getRowCount(); i++){
			grd_mngmt.setCellDisabled(i, "img_detls", true);
			
			switch(dlt_mngmt.getCellData(i,"mngmt_item_cd")){
				case "2050" : // 출장신청번호
				case "2051" : // 구매요청번호
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("req_no"));
					dlt_mngmt.setCellData(i, "mngmt_detls_nm", "");					
					break;
									
				case "3001" : // 거래처명
					dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("rmk_2"));
					break;
				default :
					grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
					break;
			}
		}
	};
	
	/**
	 * 공통코드 팝업 오픈
	 */
	scwin.openCommCdPop = function(cdClsf) {
		com.openCmnCdPop(cdClsf, {
			srchWord : cdClsf,
			selectCallback : function(retObj) {
				dlt_mngmt.setCellData(grd_mngmt.getFocusedRowIndex(), "mngmt_detls_cd", retObj.values); // value 셋팅
				dlt_mngmt.setCellData(grd_mngmt.getFocusedRowIndex(), "mngmt_detls_nm", retObj.labels); // label 셋팅
			}
		});
	};

	/**
	 * 관리항목 그리드 셋팅
	 */
	scwin.setGrdMngmt = function(clsf) {
		var accntNo = dma_slipD.get("accnt_no");
		
		for (var i = 0; i < dlt_mngmt.getRowCount(); i++) {
			if(clsf == undefined){
				dlt_mngmt.setCellData(i, "cud_type", "C");
			}
			
			// 2022.11.10. 관리항목 직접 입력가능하게 변경(구본준 요청)
			if (/popup|dropdown/.test(dlt_mngmt.getCellData(i, "data_form"))) {
				//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
				grd_mngmt.setCellDisabled(i, "img_detls", false);
			} else {
				//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
				grd_mngmt.setCellDisabled(i, "img_detls", true);
			}
			
			if(clsf == "U"){
				if(dlt_mngmt.getCellData(i, "mngmt_detls_cd").trim() != "" || dlt_mngmt.getCellData(i, "mngmt_detls_nm") != ""){
					//grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
					if(!/Fn0130|Fn0140/.test(dma_slipD.get("journ_cd"))){
						grd_mngmt.setCellDisabled(i, "img_detls", true);
					}
				}
			}else{
				switch(dlt_mngmt.getCellData(i, "mngmt_item_cd")){
					case "3001"	:
						if(/Fn0011|Fn0065/.test(dma_slipD.get("journ_cd"))){
							dlt_mngmt.setCellData(i, "mngmt_detls_cd", dma_slipD.get("rmk_2"));
						}
						break;
					case "1001"	:
						if(/^FF21/.test(accntNo) && accntNo != "FF210001"){
							dlt_mngmt.setCellData(i, "mngmt_detls_cd", accntNo.substring(2,8));
							grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", true);
							grd_mngmt.setCellDisabled(i, "img_detls", true);
						}else{
							grd_mngmt.setCellReadOnly(i, "mngmt_detls_cd", false);
						}
						break;				
					default : break;
				}
			}
		}
	}	
	

	/**
	 * 전자증빙에서 req_no 입력 후 호출
	 */
	scwin.setMngmtDetls = function(mngmtItemCd, reqNo) {
		for (var i = 0; i < dlt_mngmt.getRowCount(); i++) {
			if (dlt_mngmt.getCellData(i, "mngmt_item_cd") == mngmtItemCd) {
				dlt_mngmt.setCellData(i, "mngmt_detls_cd", reqNo);
			}
		}
	}	

	/**
	 * 과세계정여부에 따라서 결의금액 셋팅
	 */
	scwin.setUnslipAmt = function(taxCd) {
		var taxAmt = Number(dma_bill.get("tax_amt")); 
		var suplyValue = Number(dma_bill.get("chrg_amt"));
		var totalAmt = Number(dma_slipD.get("total_amt"));
		var unslipAmt = 0;

		if (taxAmt > 0){
			if (taxCd == "FTX001") {
				// 과세금액 + 공급가액이 총액(미처리금액)과 다를 경우
				if (taxAmt + suplyValue != inputTotalAmt.getValue()) {
					unslipAmt = Math.floor(totalAmt * 10 / 11);
					
					dma_slipD.set("unslip_amt", unslipAmt);
					dma_slipD.set("tax_amt", totalAmt - unslipAmt);
				} else { 
					dma_slipD.set("unslip_amt", suplyValue);
					dma_slipD.set("tax_amt", taxAmt);
				}
			}else { // 비과세일 경우
				inputUnslipAmt.setValue(totalAmt);
				dma_slipD.set("tax_amt", 0);
			}
		}else{ // 증빙의 세액이 없는 경우 
			dma_slipD.set("unslip_amt", totalAmt);
			dma_slipD.set("tax_amt", 0);
		}
	};

	/**
	 * 예산잔액 조회
	 */
	scwin.getBugtRamtAmt = function() {
		if(!/Fn0011|Fn0065/.test(dma_slipD.get("journ_cd"))) return;
		
		var relatNo = relatNo = dma_slipD.get("accnt_rspns").substring(2,8);		
		var data = {
			bugt_yr : dma_slipH.get("slip_ymd").substring(0, 4),
			accnt_no : dma_slipD.get("accnt_no"),
			accnt_cd : dma_slipD.get("accnt_cd"),
			relat_no : relatNo
		}

		var reqAmt = Number(dma_slipD.get("unslip_amt")) - Number(dma_slipD.get("bf_unslip_amt"));
		com.biz.checkBugtRamt(data, function(retObj){			
			if(retObj.bugt_amt == 0){
				if(retObj.bugt_ctrl_way == undefined || retObj.bugt_ctrl_way != "FAF021" ){ // FAF021 내역통제
					com.alert("message.xom.ui.fin.022");
				}
			}else{
				var ramtAmt = Number(retObj.bugt_amt) - Number(retObj.cause_amt) - Number(retObj.enfrc_amt) - reqAmt;
				inputBugtRamtAmt.setValue(ramtAmt);
			}
								
		});	
	}
	
	/**
	 * 결의서 관리항목, 송금내역, 계산서 조회
	 */
	scwin.searchSlipMngmt = function(){
		debugger;
		// 초기화
		dma_bill.setEmptyValue();
		dma_card.setEmptyValue();
		
		dlt_sendreq.removeAll();
		dlt_sendreq.reform();
		
		dlt_mngmt.removeAll();
		dlt_mngmt.reform();
		
		// 조회조건 셋팅
		dma_search.set("accnt_cd", dma_slipD.get("accnt_cd"));
		dma_search.set("journ_cd", dma_slipD.get("journ_cd"));
		// 비용코드 99A일 경우 매출계산서 번호가 bill_no에 있어서
		if(dma_slipD.get("bill_no").substring(0, 3) != "F10"){
			dma_search.set("issu_seqno", dma_slipD.get("bill_no"));
		}
		// 카드결의
		if(dma_slipD.get("journ_cd") == "Fn0300"){
			dma_search.set("card_no", dma_slipD.get("card_no"));
			dma_search.set("use_ymd", dma_slipD.get("use_ymd"));
			dma_search.set("apprvl_no", dma_slipD.get("apprvl_no"));
		}
		
		com.execute(sbm_selectSlipMngmts, {
			successCallback : function(e) {
				debugger;
				scwin.setGrdMngmt("U");	
				
				if(dlt_sendreq.getRowCount() > 0){
					for(var i=0; i<dlt_sendreq.getRowCount(); i++){
						scwin.setGrdSendreq(i, dlt_sendreq.getCellData(i, "pay_clsf"));
					}
				}	
				
				if(dma_slipD.get("journ_cd") == "Fn0300"){
					dma_card.set("card_no", dma_slipD.get("card_no"));
				}
			}
		});
	};
	
	/**
	 * 그리드 디테일 setting
	 */
	scwin.setSlipD = function(){
		debugger;
		if(dma_slipD.get("base_debit_cr") == '1'){
			sbx_journ_cd_dr.setValue(dma_slipD.get("journ_cd"));	
			sbx_journ_cd_dr.setStyle("color", "#FF0000");
			
			sbx_journ_cd_cr.setValue("");	
			sbx_journ_cd_cr.setStyle("color", "#000000");	
		}else{
			sbx_journ_cd_cr.setValue(dma_slipD.get("journ_cd"));	
			sbx_journ_cd_cr.setStyle("color", "#FF0000");	
			
			sbx_journ_cd_dr.setValue("");	
			sbx_journ_cd_dr.setStyle("color", "#000000");
		}
		
		if(/Fn0120|Fn0126/.test(dma_slipD.get("journ_cd"))){
			if(dma_slipD.get("occr_slip_odr") != "" && dma_slipD.get("occr_slip_odr") != "0"){
				dma_slipD.set("req_seq", dma_slipD.get("occr_slip_odr"));
			}
		}
		
		// button 제어 
		btn_accntNo.setDisabled(true);
		btn_expns.setDisabled(true);
		btn_accnt_cd.setDisabled(true);
		ibx_accnt_no.setReadOnly(true);
		ibx_expns_cd.setReadOnly(true);	
		
		if(/FF/.test(dma_slipD.get("accnt_no"))){
			btn_bugt.setDisabled(true);
		}else{
			btn_bugt.setDisabled(false);
		}
		
		// 첨부파일
		var attachFileNo = dma_slipD.get("attach_file_no");
		if(attachFileNo == ""){
			attachFileNo = scwin.data.typeCode;
		}		
		com.file.create(upload_A.getID(), {fileKey: attachFileNo, mode: 'edit', allowExtension : scwin.data.allowExtension});			
		
		if(dma_slipD.get("expns_cd") == "235"){
			btn_confrHis.show("");	
		}else{
			btn_confrHis.hide();
		} 
		
		// 관리항목 및 계산서내역 조회
		dma_search.set("unslip_odr", dma_slipD.get("unslip_odr"));
		dma_search.set("issu_seqno", dma_slipD.get("bill_no"));
		
		// 관리항목, 계산서사용내역, 이지바로
		scwin.searchSlipMngmt();
		
		switch(dma_slipD.get("unslip_no").substring(0, 3)){
			case "110" :
			case "150" :
				scwin.evidParam.expns_cd = dma_slipD.get("expns_cd");
				scwin.evidParam.unslip_odr = dma_slipD.get("unslip_odr");
				var accntNo = dma_slipD.get("accnt_no");
				if(/322|262|431/.test(dma_slipD.get("expns_cd")) && accntNo.substring(0, 4) == "FF21"){
					if(accntNo == "FF210001"){
						scwin.evidParam.expns_cd = "FF1";
					}else{
						scwin.evidParam.expns_cd = "FF2";
					}
				}
				break;
			case "130" : scwin.evidParam.doc_id = "130"; break;				
			default : scwin.evidParam.doc_id = ""; break;
		}
		
		// 전자증빙 조회
		if(/Fn0011|Fn0065|Fn0120|Fn0126/.test(dma_slipD.get("journ_cd"))){
			scwin.evidParam.req_no = dma_slipD.get("unslip_no");
			wfm_evid.getWindow().scwin.evid_select(scwin.evidParam);
		}
		
		// 2017.10.24. 이지바로과제일 경우 회의록 참조하여 fspitmeviddetls저장, 비용코드 410, 411일 때
		if(dma_slipD.get("evid_yn") == "Y"){
			dma_search.set("expns_cd", dma_slipD.get("expns_cd"));
			btn_evidInfo.show("");

			com.execute(sbm_selectItmEvidDetlsCnt, {
				successCallback : function(e){
					if(dma_cnt.get("cnt") == 0){
						btn_evidInfo.trigger("click");
					}
				}
			});
		}else{
			btn_evidInfo.hide();
		}
		
		// 분개유형별 폼 셋팅
		scwin.settingForm(dma_slipD.get("journ_cd"));
	}

	//------------------------------------------------------------------------------------------------------------------  event

	/**
	 * 계산서 정보 조회 버튼 클릭 이벤트
	 */
	scwin.btn_billSrc_onclick = function(e) {
		// 01. 결의서 디테일, 관리항목, 송금내역, 전자증빙 dataset 초기화
		scwin.reformData(2);
		
		var data = {unslip_no:dma_search.get("unslip_no"),
					relat_no : scwin.data.sn 
		        };
		biz.fin.pop.open(biz.fin.pop.TYPE.BILL, data, function(ret) {
			dma_bill.setJSON(ret);
			
			dma_slipD.set("total_amt", dma_bill.get("un_amt"));
			dma_slipD.set("bf_total_amt", 0);
			dma_slipD.set("bf_unslip_amt", 0);			
			dma_slipD.set("evid_cd", dma_bill.get("evid_cd"));
			dma_slipD.set("bill_no", dma_bill.get("issu_seqno"));
			dma_slipD.set("bsns_psn_regst_no", dma_bill.get("bsns_psn_regst_no"));		
			dma_slipD.set("rmk_2", dma_bill.get("vend_nm"));	
		
			scwin.setUnslipAmt((ret.tax_amt > 0)? "FTX001":"FTX002");
		});
	};
	
	/**
	 * 결의서 디테일, 관리항목, 송금내역, 전자증빙 dataset 초기화
	 */
	scwin.reformData = function(clsf){
		if(clsf == undefined){
			dma_slipD.setEmptyValue();
			// 첨부파일 초기화
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});
		}else{
			// 분개유형등은 그대로, 계정번호, 회계코드, 비용코드, 결의금액만 초기화(계산서 조회버튼 클릭시)
			dma_slipD.set("accnt_no", "");
			dma_slipD.set("accnt_no_nm", "");
			dma_slipD.set("accnt_cd", "");
			dma_slipD.set("accnt_cd_nm", "");
			if(dma_slipD.get("journ_cd") != "Fn0100"){ // 채무반제인경우 비용코드 초기화 안되도록 수정
				dma_slipD.set("expns_cd", "");
				dma_slipD.set("expns_cd_nm", "");
			}
			dma_slipD.set("rmk_2", "");
			dma_slipD.set("total_amt", "");
			dma_slipD.set("unslip_amt", "");
			dma_slipD.set("tax_amt", "");
		}
				
		dma_bill.setEmptyValue();
		dlt_mngmt.removeAll();
		dlt_sendreq.removeAll();
		dlt_sendreq.reform();
		
		scwin.evidParam={};		
		scwin.evidParam.doc_id ="110";
		wfm_evid.getWindow().dlt_attach.removeAll();		
	};


	/**
	 * 계정번호 검색팝업
	 */
	scwin.btn_accntNo_onclick = function(e) {
		if(dma_slipD.get("journ_cd") == ""){
			if(!scwin.reSetJournCd()) return;
		}
		
		var journCd = dma_slipD.get("journ_cd");
		if(/Fn0011|Fn0065/.test(journCd)){
			if (dma_slipD.get("bill_no") == "") {
				com.alert(com.getMsg("message.xom.ui.fin.002" ,"거래증빙내역")); /*먼저 거래증빙내역을 선택하세요.*/
				return;
			}
		}
		
		if(journCd == "Fn0115"){ // 결의내역대체처리(대변)
			scwin.getAccntNoCtrl();
		}else{
			scwin.getAccntNo(dma_slipD.get("journ_cd"));	
		}
	};
	
	/**
	 * 계정번호 조회
	 */
	scwin.getAccntNo = function(journCd){		
		var data = {
			accnt_no : ibx_accnt_no.getValue(),
			ref_yn : "Y"
		};
			
		// parameter setting
		if(journCd == "Fn0011"){
			data.clsf = "gen";
			data.cls_yr = dma_slipH.get("slip_ymd").substring(0, 4);
		}else if(journCd == "Fn0065"){
			data.clsf = "con";
			data.cls_yr = dma_slipH.get("slip_ymd").substring(0, 4);
		}else{
			data.clsf = "fin";
		}
		
		com.pop.open(com.pop.TYPE.ACNNO, data, function(retObj) {
			if (retObj) {
				retObj.clsf = data.clsf;
				if (!scwin.check(retObj, 0))
					return;

				dma_slipD.set("accnt_no", retObj.accnt_no);
				dma_slipD.set("accnt_no_nm", retObj.accnt_no_nm);
				dma_slipD.set("accnt_rspns", retObj.accnt_rspns);
				dma_slipD.set("fomat_unit", retObj.fomat_unit);
				dma_slipD.set("tax_cd", retObj.tax_cd);
				dma_slipD.set("accnt_no_clsf", retObj.card_use_ex);
				dma_slipD.set("mngmt_clsf", retObj.mngmt_clsf);
				scwin.data.evid_chk = retObj.evid_chk; // 증빙여부
				scwin.data.exclsv_agncy = retObj.bsns_cd_exclsv_agncy;	
				
				// 비용코드, 회계코드 초기화(수입처리일 경우에는 분개유형 선택시 선택한 비용코드 그대로 사용)
				if(!dma_slipD.get("journ_cd") == "Fn0160"){
					dma_slipD.set("expns_cd", "");
					dma_slipD.set("expns_cd_nm", "");
				}
				
				dma_slipD.set("accnt_cd", "");
				dma_slipD.set("accnt_cd_nm", "");

				// 결의금액 셋팅
				if(dma_slipD.get("total_amt") != ""){
					scwin.setUnslipAmt(retObj.tax_cd);
				}
				
				// 수입처리(대변)일 경우 계정번호로 회계코드 검색
				if(dma_slipD.get("journ_cd") == "Fn0160" && retObj.accnt_no != "FF030001"){
					dma_search.set("accnt_no", retObj.accnt_no);
					
					com.execute(sbm_selectAccntCdBy, {
						successCallback : function(e) { // 성공 콜백
							// 회계코드 조회 후 체크
							if(!scwin.check(dma_return.getJSON(), 2)) return;
							
							dma_slipD.set("accnt_cd", dma_return.get("accnt_cd"));
							dma_slipD.set("accnt_cd_nm", dma_return.get("accnt_cd_abbr"));
							
							// 관리항목 조회
							scwin.setMngmt(dma_return.get("accnt_cd"));
						}
					});
				}
			}
		});	
	}
	
	/**
	 * 회계코드검색 후 체크
	 */
	scwin.checkPostAccntCd = function(paramObj){
		// 재무처리(차변), 재무처리(대변)에서는 건별정산유무가 Y인 회계코드는 사용할 수 없음(2013.05.09 추가)
		if(paramObj.caseby_adjst_ex == "Y"){
			if(/Fn0130|Fn0140/.test(dma_slipD.get("journ_cd"))){
				com.alert(com.getMsg("message.alert.fin.com.0011", paramObj.accnt_cd));
				return false;
			
			// 채권발생처리, 채권반제처리인 경우에는 채권채무구분이 1 이어야 함
			}else if(/Fn0070|Fn0090/.test(dma_slipD.get("journ_cd"))){
				if(paramObj.bond_debt_clsf == '2'){
					com.alert(com.getMsg("message.alert.fin.com.0012", paramObj.accnt_cd));
					return false;
				}
			// On-Line입금가수반제, 채무발생처리 경우에는 채권채무구분이 2 이어야 함
			}else if(/Fn0105|journCd/.test(dma_slipD.get("journ_cd"))){
				if(paramObj.bond_debt_clsf == '1'){
					com.alert(com.getMsg("message.alert.fin.com.0013", paramObj.accnt_cd));
					return false;
				}
			}
		}else if(paramObj.caseby_adjst_ex == "N"){
			// 채권발생처리, 채무발생처리, On-Line입금가수반제, 채권반제처리에서는 건별정산유무가 N인 회계코드는 사용할 수 없음(2013.05.09 추가)
			if(/Fn0070|Fn0080|Fn0105|Fn0090/.test(dma_slipD.get("journ_cd"))){
				com.alert(com.getMsg("message.alert.fin.com.0014", paramObj.accnt_cd));
				return false;
			}
		}
		
		// 2019.07.01 - 내부인건비I만 사용 못하도록 변경 이상훈 선임행정원 요청
		// 20220204 - 내부인건비I 가능하도록 임시조치(재정운영실 구본준 요청)
		// 일반결의(자동결의서는 내부인건비 회계코드 체크 해제)
		if(scwin.data.serviceId == "F203" && /Fn9910|Fn9920/.test(dma_slipD.get("journ_cd")) && scwin.data.sn != "20190044"){
			if(/51105010|51120010|51125010|51145010|51135010|51130010|51140010/.test(paramObj.accnt_cd)){
				com.alert("message.xom.ui.fin.041"); // 일반결의에서는 '내부인건비I' 회계코드를 사용 하실 수 없습니다.
				return false;
			}
		}
		
		if(/Fn0105/.test(dma_slipD.get("journ_cd"))){
			if(ica_slip_ymd.getValue() < scwin.data.mngmt.accnt_ymd){
				com.alert(com.getMsg("message.xom.ui.fin.010", "입금일자", "결의일자")); //입금일자는 결의일자이전이어야 합니다.
				return false;
			}
		}	
		return true;
	};

	/**
	 * 계정번호 blur event
	 */
	scwin.inputAccntNo_onblur = function(e) {
		var arr = ["accnt_rspns", "accnt_no_nm", "accnt_rspns", "fomat_unit"];
		arr.forEach(function(el, index) {
			dma_slipD.set(el, "");
		});
	};
	
	/**
	 * 결의내역 대체처리 검색 팝업
	 */
	scwin.getAccntNoCtrl = function(){
		var data ={
			accnt_no : ibx_accnt_no.getValue()	
		};
		
		// 관리항목 조회			
		biz.fin.pop.open(biz.fin.pop.TYPE.TRANS_SLIP, data, function(ret) {
			if (!scwin.check(ret, 0)) return;
			
			dma_slipD.set("occr_slip_no", ret.slip_no);
			dma_slipD.set("occr_slip_odr", ret.slip_odr);			
			dma_slipD.set("accnt_no", ret.accnt_no);
			dma_slipD.set("accnt_no_nm", ret.accnt_no_nm);
			dma_slipD.set("accnt_rspns", ret.accnt_rspns);
			dma_slipD.set("fomat_unit", ret.fomat_unit);
			dma_slipD.set("tax_cd", ret.tax_cd);
			dma_slipD.set("accnt_cd", ret.accnt_cd);
			dma_slipD.set("accnt_cd_nm", ret.accnt_cd_nm);
			dma_slipD.set("expns_cd", ret.expns_cd);
			dma_slipD.set("expns_cd_nm", ret.expns_cd_nm);
			dma_slipD.set("total_amt", ret.total_amt);
			dma_slipD.set("unslip_amt", ret.unslip_amt);
			dma_slipD.set("tax_amt", ret.tax_amt);
			dma_slipD.set("rmk_1", ret.rmk_1);
			
			scwin.data.mngmt = {};
			scwin.data.mngmt.ramt_amt = ret.total_amt;	
			
			// 관리항목 조회
			dma_searchMng.set("unslip_no", ret.unslip_no);
			dma_searchMng.set("unslip_odr", ret.unslip_odr);
			dma_searchMng.set("accnt_cd", ret.accnt_cd);
			
			com.execute(sbm_selectSlipMngmt, {								
				successCallback : function(e) {	
					// 결의내역 대체처리시 기존의 관리내역 불러옴
					scwin.setGrdMngmt("U");
				}
			});			
		});
	};
	
	/**
	 * 필수입력값 체크
	 */
	scwin.validateData = function(){
		// 필수입력값 체크
		var validData = [
			{dataObj : dma_slipH
			   , valInfoArr :[
				    { id : "slip_ymd", mandatory : true}
				   ,{ id : "slip_typ_cd", mandatory : true } 
				   ,{ id : "wrte_psn", mandatory : true } 
				   ,{ id : "wrte_dept", mandatory : true } 
				   ,{ id : "rmk", mandatory : true }
				]
			  , isCheckModified : false
			},
			{dataObj : dma_slipD
			  , valInfoArr :[
				    { id : "journ_cd", mandatory : true}
				   ,{ id : "base_debit_cr", mandatory : true } 
				   ,{ id : "accnt_no", mandatory : true, allowChar : "A-Z0-9" } 
				   ,{ id : "accnt_rspns", mandatory : true } 
				   ,{ id : "accnt_cd", mandatory : true } 
				   ,{ id : "expns_cd", mandatory : true } 
				   ,{ id : "total_amt", mandatory : true, allowChar : "0-9"} 
				   ,{ id : "unslip_amt", mandatory : true, allowChar : "0-9" } 
				   ,{ id : "tax_amt", mandatory : true, allowChar : "0-9" } 
				   ,{ id : "rmk_1", mandatory : true } 
				   ,{ id : "rmk_2", mandatory : true } 
			    ]
			   , isCheckModified : false
			}
		];
		
		if(/Fn0126|Fn0500/.test(dma_slipD.get("journ_cd"))){ // 통제내역지급결의, 지급처리
			if(dlt_sendreq.getRowCount() == 0){
				com.alert(com.getMsg("message.xom.co.com.0001", "송금내역"));	
				return false;
			}
			
			validData.push({dataObj : dlt_sendreq, valInfoArr :[
				 { id : "send_odr", mandatory : true}
				,{ id : "pay_clsf", mandatory : true } 
				,{ id : "send_req_amt", mandatory : true } 
				], isCheckModified : false
			});
		}	
		
		return com.validateData(validData);			
	};

	/**
	 * 저장
	 */
	scwin.btn_save_onclick = function(e) {			
		dma_slipH.set("approval", "false");	
		scwin.data.aprYn = "N";
		
		if(/Fn9910|Fn9920/.test(dma_slipD.get("journ_cd"))){
			scwin.save();
		}else{			
			// 저장 전 체크	
			if (!scwin.validateData()) return;
			if (!scwin.checkPreSave()) return;
			
			// 예산잔액 체크
			if(inputBugtRamtAmt.getValue() < 0){
				com.confirm("message.xom.ui.fin.033"/*예실잔액이 부족합니다. 저장 하시겠습니까?*/, function(ret){
					if(ret) scwin.save();
				});
			}else{
				com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
					if(ret) scwin.save();
				});
			}
		}			
	};
	
	/**
	 * 저장실행
	 */
	scwin.save = function(){
		dma_slipD.set("unslip_no", ibx_unslip_no.getValue());
		
		com.file.transport( function(attachObj){
			debugger;
			if(attachObj.upload_A != undefined && attachObj.upload_A.trim().length == 13){
				dma_slipD.set("attach_file_no", attachObj.upload_A);
				dma_slipD.set("validAttachNo", attachObj.upload_A);
			}
			
			com.execute(sbm_saveSlip, {
				successCallback : function(e) { // 성공 콜백		
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
						// 2023.03.08. 저장없이 결재신청 클릭하는 경우가 있어서 증빙 저장 후 결재화면으로 넘어가도록 수정
						scwin.evidParam.req_no = dma_search.get("unslip_no");
						scwin.evidParam.unslip_odr = dma_search.get("unslip_odr");
						// 자동증빙 저장
						wfm_evid.getWindow(0).scwin.updateEvid(scwin.evidParam);
						
						if(scwin.data.aprYn == "Y"){ // 결재신청 후
							com.movePageMenu("A001", { "reqNo" :  dma_slipH.get("unslip_no")});
						}else{
							// 조회
							scwin.search();
						}
					});	
				}
			});
		});
	};
	
	/**
	 * 비용코드 검색팝업
	 */
	scwin.btn_expns_onclick = function(e) {
		if(dma_slipD.get("journ_cd") == ""){
			if(!scwin.reSetJournCd()) return;
		}
		
		var journCd = dma_slipD.get("journ_cd");
		var data = {expns_cd : ibx_expns_cd.getValue()};
		if(ibx_expns_cd.getValue() == ""){
			data.ref_yn ="Y";
		}
		
		/*
			Fn0130  재무처리(차변)
			Fn0230 예금입금처리(차변)
			Fn0070 채권발생처리(차변)
			Fn0140 재무처리(대변)
			Fn0500 지급처리(대변)
			Fn0300 카드결의처리(승인)
		*/
		if(/Fn0130|Fn0230|Fn0070|Fn0140|Fn0500|Fn0300/.test(journCd)){			
			biz.fin.pop.open(biz.fin.pop.TYPE.EXPNS, data, function(ret) {
				if(!scwin.check(ret, 1)) return;
				
				dma_slipD.set("expns_cd", ret.expns_cd);
				dma_slipD.set("expns_cd_nm", ret.expns_cd_nm);
			});
		/* Fn0065 수탁지원비처리(차변)
		   Fn0055 이월연구비(차변)
		   Fn0011 일반경비발생(차변)
		*/
		}else if(/Fn0065|Fn0055|Fn0011/.test(journCd)){
			if(dma_slipD.get("bill_no") == ""){
				com.alert(com.getMsg("message.xom.ui.fin.002" ,"증빙조회 버튼을 클릭하여 증빙내역")); /*증빙 조회 버튼을 클릭하여 증빙내역을 선택하세요.*/
				return;
			}else if(dma_slipD.get("accnt_no") == ""){
				com.alert(com.getMsg("message.xom.co.com.0001", "계정번호"));
				return;
			}
			
			data.accnt_no = ibx_accnt_no.getValue();
			com.pop.open(com.pop.TYPE.EXPNS, data, function(retObj) {
				if (retObj) {
					// 비용코드 체크(소액물품, 이지바로과제, 증빙여부 )
					if (!scwin.check(retObj, 1))
						return;
	
					dma_slipD.set("expns_cd", retObj.expns_cd);
					dma_slipD.set("expns_cd_nm", retObj.expns_cd_nm);
					dma_slipD.set("accnt_cd", retObj.accnt_cd);
					dma_slipD.set("accnt_cd_nm", retObj.accnt_cd_abbr);											
	
					// 관리항목 셋팅
					scwin.setMngmt(retObj.accnt_cd);	
					
					// 예산잔액 조회
					if(dma_slipD.get("accnt_no") != "FF210001"){
						scwin.getBugtRamtAmt();	
					}		
				}
			});
		}
		
		// 전자증빙 항목 조회
		if(dma_slipD.get("expns_cd") != ""){
			scwin.evidParam.expns_cd = dma_slipD.get("expns_cd");
			
			if(/322|262|431/.test(dma_slipD.get("expns_cd")) && ibx_accnt_no.getValue().substring(0, 4) == "FF21"){
				if(ibx_accnt_no.getValue() == "FF210001"){
					scwin.evidParam.expns_cd = "FF1";
				}else{
					scwin.evidParam.expns_cd = "FF2";
				}
			}
		
			wfm_evid.getWindow(0).scwin.evid_select(scwin.evidParam);
		}
	};

	/**
	 * 관리항목 grd_mngmt_oncellclick event
	 */
	scwin.grd_mngmt_oncellclick = function(row,col,colId) {
		if (grd_mngmt.getColumnID(col) == "img_detls") {
			var mngmtItemCd = dlt_mngmt.getCellData(row, "mngmt_item_cd");
			var data = {
				mngmt_detls_cd : dlt_mngmt.getCellData(row, "mngmt_detls_cd")
			};
			
			if(mngmtItemCd == "2050"){
				data.expns_cd = dma_slipD.get("expns_cd");
			}			
			
			biz.fin.setMngmtDetls(mngmtItemCd, data, function(cd, nm){
				if(/1001|1300/.test(mngmtItemCd)){
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", cd.substring(2,8));
				}else{
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", cd);
					if(mngmtItemCd == "2091"){
						dma_slipD.set("bill_no", cd);
					}
				}
				
				dlt_mngmt.setCellData(row, "mngmt_detls_nm", nm);		
				
				if(/1001|1300/.test(mngmtItemCd)){
					if(dma_slipD.get("accnt_no") == "FF210001"){
						dma_slipD.set("accnt_rspns", cd);
						
						// 예산잔액 체크
						scwin.getBugtRamtAmt();
					}
				}		
			});
		}
	};
	
	/**
	 * 관리항목 데이터변경 event
	 */
	scwin.grd_mngmt_onviewchange = function(info) {
		var col = info.colIndex;
		var row = info.rowIndex;
		if(col == grd_mngmt.getColumnIndex("mngmt_detls_cd")){
			if(dlt_mngmt.getCellData(row, "mngmt_item_cd") == "4043" && dlt_mngmt.getCellData(row, "mngmt_detls_cd") != ""){
				if(isNaN(dlt_mngmt.getCellData(row, "mngmt_detls_cd"))){
					com.alert("message.xom.ui.fin.032");
					dlt_mngmt.setCellData(row, "mngmt_detls_cd", "");
				}
			}
		}
	};

	/**
	 * 총액 수정 이벤트
	 */
	scwin.inputTotalAmt_onviewchange = function(info) {	
		if (inputTotalAmt.getValue() == 0) {
			inputUnslipAmt.setValue(0);
			inputTaxAmt.setValue(0);
			return;
		}	
		
		if(dma_slipD.get("total_amt") != ""){
			scwin.setUnslipAmt(dma_slipD.get("tax_cd"));
		}	

		// 예산잔액 조회
		scwin.getBugtRamtAmt();
	};

	/**
	 * 비고 변경 이벤트
	 */
	scwin.ibx_rmk_1_onchange = function(info) {
		if (dma_slipH.get("rmk") == "") {
			dma_slipH.set("rmk", this.getValue());
		}
	};	
	
	/**
	 * 목록 버튼 클릭 이벤트
	 */
	scwin.btn_pre_onclick = function(e) {
		//scwin.checkList = null;
		if(scwin.data.serviceId == "F204"){
			com.moveList("F209");
		}else{
			com.moveList("F233");	
		}
	};	
	
	/**
	 * 삭제버튼 클릭 이벤트
	 */	
	scwin.btn_del_onclick = function(e) {
		if(dma_slipD.get("unslip_no") == ""){
			alert("삭제할 행을 선택하세요");
			return;				
		}
		
		var unslipNoSub = dma_slipH.get("unslip_no").substring(0,3);
		if(!/110|150|155/.test(unslipNoSub)){
			if(unslipNoSub == "154"){
				com.alert(com.getMsg("message.xom.ui.fin.049", "154", "재무관리>결의서>기타(사업)소득신청"));
				return;
			}else if(unslipNoSub == "235"){
				com.alert(com.getMsg("message.xom.ui.fin.049", "235", "구매관리>지급신청>지급신청(월할)"));
				return;
			}else if(unslipNoSub == "125"){
				com.alert(com.getMsg("message.xom.ui.fin.049", "125", "총무보안>출장관리>근거리출장결의생성"));
				return;
			}
			
			if(/Fn9910|Fn9920/.test(dma_slipD.get("journ_cd"))){
				com.alert("message.xom.ui.fin.050");
				return;
			}
		}	
		
		if(dlt_slipDr.getRowCount() + dlt_slipCr.getRowCount() == 1){
			dma_slipD.set("part_all_clsf", "F"); // 전체삭제
		}else if(dlt_slipDr.getRowCount() == 1 && dlt_slipCr.getRowCount() == 1 && dlt_slipDr.getCellData(0, "journ_cd") == "Fn0126"){ // 통제내역 지급결의(RCMS/POINT) 일 경우 대변 자동삭제이므로
			dma_slipD.set("part_all_clsf", "F"); // 전체삭제
		}else{
			dma_slipD.set("part_all_clsf", ""); // 해당 결의순번만 삭제
		}		
		
		var partAllClsf = dma_slipD.get("part_all_clsf");
		
		com.confirm("message.xom.wq.022"/*삭제하시겠습니까?*/, function(ret){
			if(ret){
				dma_slipD.set("cud_type", "D");
				com.file.deleteAll( function(){
					com.execute(sbm_deleteSlip, {
						successCallback : function(e) {
							if(partAllClsf == "F"){		
								//scwin.checkList = null;		
								if(com.getParameter("param4") == "apr"){
									com.movePageMenu("A010");
								}else{
									if(scwin.data.serviceId == "F204"){
										com.moveList("F209", {});
									}else{
										com.moveList("F233", {});	
									}
								}	
							}else{
								scwin.search();	
							}
						}
					});
				});
			} else {
				dma_slipD.set("cud_type", "U");
			}
		});
	};	
	
	/**
	 * 작성자 검색 팝업
	 */
	scwin.btn_emp_onclick = function(e) {
		var data = { empno : ibx_empno.getValue(), work_clsf : "HAG010"};
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			dma_slipH.set("empno", ret.empno);
			dma_slipH.set("nm", ret.nm);
			dma_slipH.set("wrte_psn", ret.syspayno);
			dma_slipH.set("wrte_dept", ret.dept_cd);
			dma_slipH.set("dept_nm", ret.dept_nm);
			dma_slipH.set("wrte_dept_new_ymd", ret.dept_new_ymd);
		});
	};

	// -------------------------- check --------------------------------------------------------------------------------------------------check
	/**
	 * 경비결의(일반) 체크
	 */
	scwin.check = function(paramObj, idx) {
		var retVal = true;
		switch (idx) {
			case 0 : // 계정번호 검색 후 체크
				retVal = scwin.checkPostAccntNo(paramObj);
				break;
			case 1 : // 비용코드 검색 후 체크
				retVal = scwin.checkPostExpnsCd(paramObj);
				break;
			case 2 : // 회계코드 검색 후 체크
				retVal = scwin.checkPostAccntCd(paramObj);
				break;
		}

		return retVal;
	};

	/**
	 * 계정번호 검색 후 체크
	 */
	scwin.checkPostAccntNo = function(paramObj) {
		// 계정종료일자 및 계정상태 체크
		if (paramObj.accnt_no.substring(0,2) != "FF") {
			if(dma_slipH.get("slip_ymd") < paramObj.start_ymd){
				com.alert("message.alert.fin.com.0009");
				return false;
			}			
			
			if(!/RAK041|RAK061/.test(paramObj.accnt_state)){ // RAK041 집행가능, RAK061 미입금집행승인
				com.alert(com.getMsg("message.alert.fin.com.0008", paramObj.accnt_no, "결의생성"));
				return false;
			}
			
			if(dma_slipD.get("journ_cd") != "Fn0115" && paramObj.evid_chk == "Y" && dma_bill.get("issu_seqno") != "" && dma_bill.get("detail_yn") != "Y"){
				//com.alert("message.xom.ui.fin.031"); /* 연구재단 과제는 거래증빙으로 결의진행이 불가능합니다.\n결의서>소액물품검수관리 메뉴를 이용해서 상세 품목정보 생성 후 결의 진행 하시기 바랍니다.*/
				// 2022.11.01. 이민기선임 요청으로 일단 confirm창으로 변경(XC2202202920 김민지)
				if(!confirm("연구재단 과제는 거래증빙으로 결의진행이 불가능합니다.\n결의서>소액물품검수관리 메뉴를 이용해서 상세 품목정보 생성 후 결의 진행 하시기 바랍니다. \n 계속진행하시겠습니까?")){
					return false;
				}
			}
			var accntNo = dma_slipD.get("accnt_no");
			if(dma_slipD.get("journ_cd") == "Fn0011"){
				if(biz.fin.CONST.CON_ACCNT_REG.test(accntNo.substring(0, 3))){
					com.alert("message.xom.ui.fin.039"); // [차변]분개유형이 일반경비발생 일 경우, PA, PD, PG, PH, PX, PL, PQ 계정은 입력할 수 없습니다.(수탁지원비로 작성하시기 바랍니다.)
					return false;
				}
			}
		}		

		return true;
	};

	/**
	 * 비용코드 검색 후 체크
	 */
	scwin.checkPostExpnsCd = function(paramObj) {
		// 2019.01.25 내부인건비 비용코드 입력불가 조치(재정운영실 이상훈)
		// 2022.02.04 내부인건비 비용코드 입력가능 임시 조치(재정운영실 구본준)
		if(/121|122|127/.test(paramObj.expns_cd)){
			com.alert("message.xom.ui.fin.036"); // 내부인건비 비용코드는 선택할 수 없습니다.
			return false;
		}		
		
		if(dma_slipD.get("journ_cd") == "Fn0011" && scwin.data.evid_chk == "Y"){
			if(dma_bill.get("issu_seqno") != "" && dma_bill.get("detail_yn") != "Y" && !/292|410|411/.test(paramObj.expns_cd)){
				//com.alert("message.xom.ui.fin.031"); // 연구재단 과제는 거래증빙으로 결의진행이 불가능합니다.\n결의서>소액물품검수관리 메뉴를 이용해서 상세 품목정보 생성 후 결의 진행 하시기 바랍니다.
				// 2022.11.01. 이민기선임 요청으로 일단 confirm창으로 변경(XC2202202920 김민지)
				if(!confirm("연구재단 과제는 거래증빙으로 결의진행이 불가능합니다.\n결의서>소액물품검수관리 메뉴를 이용해서 상세 품목정보 생성 후 결의 진행 하시기 바랍니다. \n 계속진행하시겠습니까?")){
					return false;
				}
			}
		}

		if (dma_slipD.get("mngmt_clsf") == "R") { // 연구계정
			if (/351|352|359/.test(paramObj.expns_cd)) { // //국내교육훈련비, 국외교육훈련비, 기타교육훈련비
				com.alert("message.xom.ui.fin.008"); //연구과제 관련 교육훈련비는 처리 가능하나, 자기개발교육(개인역량개발)은 BH계정(총무보안실에 문의)으로 진행하여 주시기 바랍니다.
			}
		}
		
		var unslipNo = dma_search.get("unslip_no");
		if (scwin.data.evid_chk == "Y" && biz.fin.CONST.EXPNS_CHK_SML_EVID.indexOf(paramObj.expns_cd) >= 0) {
			// 2019.04.30 결의내역대체처리 분개일때는 검증 제외(이민기 선임 행정원 요청)
			if(dma_search.get("slip_typ_cd") == "110" && dma_slipD.get("journ_cd") != "Fn0115"){
				com.alert("message.xom.ui.fin.006"); //소액물품검수관리를 통한 결의서 작성 바랍니다. \n재무관리>결의서>소액물품검수관리
				return false;
			}
		}
		
		// 2021.10.20. 연구장비 통합계정일 경우 비용코드는 322, 262, 431 중 택일
		if(/^FF21/.test(ibx_accnt_no.getValue())){
			if(paramObj.expns_cd == "999"){
				com.alert("message.xom.ui.fin.037");
				return false;
			}
		}

		return true;
	};

	scwin.checkPreSave = function() {
		// 증빙 날짜 체크		
		if (!scwin.slip_date_check()) return false;
		
		
		var slipYmd = scwin.data.slip_ymd; 
		if(slipYmd != "" && slipYmd.substring(0,6) != ica_slip_ymd.getValue().substring(0, 6)){
			 com.alert("message.xom.ui.fin.042"); //결의일자는 같은 월 안에서만 변경가능합니다. 결의 월을 변경하실 경우 삭제 후 재작성 해주시기 바랍니다.
			 return false;
		}
			
		var clsf = ""
		// 2019.02.25 이지바로과제로 비용코드 271, 272 사용시 필수여부에 상관없이 신청번호 체크	
		if (scwin.data.exclsv_agncy == "RHB040" && dma_slipD.get("accnt_no_clsf") == "FAJ003" && /271|272/.test(dma_slipD.get("expns_cd"))) {
			clsf = "ezbr";
		}
		// 통합이지바로 회의록 필수 체크
		// 2020.07.01 최은희 사무원 요청으로  410,411 비용코드 일때는 통합이지바로 계정이어도 거래증빙으로 등록할 수 있게 변경(XC2202001235)
//		if (dma_slipD.get("accnt_no_clsf") == "FAJ007" && /410|411/.test(dma_slipD.get("expns_cd"))) {
//			clsf = "cmb_ezbr";
//		}
		if (!wfm_evid.getWindow().scwin.evid_preSave(clsf))
			return false;		

		// 2014.12.16 부가세로직 추가에 따른 검증추가
		if (dma_slipD.get("total_amt") != Number(dma_slipD.get("unslip_amt")) + Number(dma_slipD.get("tax_amt"))) {
			com.alert(com.getMsg("message.xom.ui.fin.015", "결의금액")); // 결의금액과 세액의 합이 총액과 일치하지 않습니다.
			return false;
		}

		if (dma_slipD.get("tax_cd") == "FTX001") {
			if (dma_bill.get("tax_amt") > 0) {
				if(dma_slipD.get("tax_amt") == 0){
					com.alert("message.xom.ui.fin.016"); // 과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
					return false;
				}
			}else{
				if(!/Fn0160|Fn0300|Fn0115/.test(dma_slipD.get("journ_cd"))){ // 대변 수입처리, 카드결의처리, 결의내역대체처리는 증빙없음
					if(dma_slipD.get("tax_amt") != 0){
						com.alert("message.xom.ui.fin.029"); // 해당증빙은 세액이 0입니다. 총액을 다시 입력하여 주십시오. 
						return false;
					}
				}
			}			
		} else {			
			if (dma_slipD.get("tax_amt") > 0) {					
				com.alert("message.xom.ui.fin.017"); // 비과세계정입니다. 총액을 다시 입력하여 세액을 확인하세요.
				return false;
			}
		}
	
		// 과세/비과세 혼용
		// 20150122 공공요금증빙인 경우 과세 및 비과세 계정혼합가능으로 변경
		// 2017-08-23, Added James, 130결의(해외출장) 제외 처리.
		// 2017.12.22 kbo 110결의(일반결의) 제외 처리
		var checkFlag = true;
		var unslipNo = ibx_unslip_no.getValue();
		if(unslipNo != "" && /110|130/.test(unslipNo.substring(0, 3))){
			checkFlag = false;
		}		
		if(dma_slipD.get("accnt_no").substring(0, 4) == "FF03" || dma_bill.get("public_amt_yn") == "Y"){
			checkFlag = false;
		}		
		
		var totalAmtSum = 0;
		var unslipAmtSum = 0;
		var taxAmtSum = 0;
		var taxfreeCnt = 0;
		var totRows = 0;
		
		var ds;
		if(dma_slipD.get("base_debit_cr") == '1'){
			ds = dlt_slipDr;
		}else{
			ds = dlt_slipCr;
		}
		
		for (var i = 0; i < ds.getRowCount(); i++) {
			if(ds.getCellData(i, "accnt_no").substring(0, 4) == "FF03"){
				checkFlag = false;
			}
			
			if (dma_slipD.get("bill_no") == ds.getCellData(i, "bill_no")) {
				if(checkFlag){
					if (ds.getCellData(i, "tax_cd") != dma_slipD.get("tax_cd")) {
						com.alert("message.xom.ui.fin.018"); // 하나의 증빙을 과세계정과 비과세계정으로 혼합하여 저장할 수 없습니다.
						return false;
					}
				}
				
				totalAmtSum = totalAmtSum + Number(ds.getCellData(i, "total_amt"));
				unslipAmtSum = totalAmtSum + Number(ds.getCellData(i, "unslip_amt"));
				taxAmtSum = totalAmtSum + Number(ds.getCellData(i, "tax_amt"));
				if(ds.getCellData(i, "tax_cd") == "FTX002") taxfreeCnt++;			
			}	
		}
		
		
		// 금액 재 조정			
		if (dma_bill.get("totl_amt") == totalAmtSum + Number(dma_slipD.get("total_amt"))) {
			if(dma_bill.get("chrg_amt") != unslipAmtSum + Number(dma_slipD.get("unslip_amt")) || dma_bill.get("tax_amt") != taxAmtSum + Number(dma_slipD.get("tax_amt"))){
				if(dma_slipD.get("tax_cd") == "FTX001" && taxfreeCnt == 0){
					dma_slipD.set("tax_amt", Number(dma_bill.get("tax_amt")) - taxAmtSum);
					dma_slipD.set("unslip_amt", Number(dma_slipD.get("total_amt")) - Number(dma_slipD.get("tax_amt")));
				}
			}
		}
		
		// 입력금액 체크
		if(dma_slipD.get("cud_type") == "C"){
			if(/Fn0011|Fn0065|Fn0055/.test(dma_slipD.get("journ_cd"))){
				if(Number(dma_slipD.get("total_amt")) > Number(dma_bill.get("un_amt"))){
					com.alert("message.xom.ui.fin.021");
					return false;
				}
			}else if(/Fn0115/.test(dma_slipD.get("journ_cd"))){ //결의내역 대체처리
				if(Number(dma_slipD.get("total_amt")) > Number(scwin.data.mngmt.ramt_amt)){
					com.alert("message.xom.ui.fin.045");
					return false;
				}
			}else if(/Fn0100|Fn0105|Fn0090/.test(dma_slipD.get("journ_cd"))){ // // 채무반제처리(차변), On-Line입금(가수반제)(차변), 채권반제처리(대변)
				if(Number(dma_slipD.get("total_amt")) > Number(scwin.data.mngmt.unadjst_amt)){
					com.alert("message.xom.ui.fin.046");
					return false;
				}
			}
		}
			
		// 송금내역 체크	
		if(/Fn0126|Fn0500/.test(dma_slipD.get("journ_cd"))){ // 통제내역지급결의, 지급처리
			var reqAmtSum = 0;
			var payClsf = "";
			
			for(var i=0; i<dlt_sendreq.getRowCount(); i++){
				payClsf = dlt_sendreq.getCellData(i,"pay_clsf")
				if(payClsf == "FAX010" && dlt_sendreq.getCellData(i,"syspayno") == ""){
					com.alert(com.getMsg("message.xom.co.com.0001", "송금내역의 개인번호"));	
					grd_sendreq.setFocusedCell(i, "emp_vend");
					return false;
					
				}else if(payClsf == "FAX020"){
					if(dlt_sendreq.getCellData(i,"vend_nm") == "" 
						||dlt_sendreq.getCellData(i,"bank") == "" || dlt_sendreq.getCellData(i,"depstr_nm") == "" || dlt_sendreq.getCellData(i,"bankaccnt_no") == ""){
						com.alert(com.getMsg("message.xom.ui.fin.043", (i+1)));	
						grd_sendreq.setFocusedCell(i, "emp_vend");
						return false;
					}		
								
				}else if(/FAX100|FAX110/.test(payClsf) && dlt_sendreq.getCellData(i,"depstr_nm") == ""){
					com.alert(com.getMsg("message.xom.co.com.0001", "예금주"));	
					grd_sendreq.setFocusedCell(i, "depstr_nm");
					return false;
					
				}else if(payClsf == "FAX090"){ // 기타(송금)지급
					if(dlt_sendreq.getCellData(i,"bank") == "" || dlt_sendreq.getCellData(i,"depstr_nm") == "" || dlt_sendreq.getCellData(i,"bankaccnt_no") == ""){
						com.alert(com.getMsg("message.xom.co.com.0001", "계좌정보"));	
						grd_sendreq.setFocusedCell(i, "bank");
						return false;
					}	
				}
				
				reqAmtSum = reqAmtSum + Number(dlt_sendreq.getCellData(i, "send_req_amt"));
				
				// TODO 계좌검증
//				if(/FAX100|FAX090/.test(dlt_sendreq.getCellData(i, "pay_clsf"))){ // FAX100 지로지급, FAX090 기타(송금)지급	
//					continue;	
//				}
//				if(dlt_sendreq.getCellData(i, "is_account") != '1' && dlt_sendreq.getCellData(i, "bankaccnt_no").trim() != ""){
//					if(dlt_sendreq.getCellData(i, "pay_clsf") == "FAX010"){
//						if(!confirm("유효하지 않은 송금내역(계좌정보)가 있습니다. 이대로 진행하시겠습니까?")){
//							return false;	
//						}
//					}else if(dlt_sendreq.getCellData(i, "pay_clsf") == "FAX020"){
//						com.alert("message.xom.ui.fin.027"); // 유효하지 않은 송금내역(계좌정보)가 있습니다.\n계좌정보 확인 후 결재신청 바랍니다.
//						return false;	
//					}
//				}	
			}	
			
			if(dma_slipD.get("total_amt") != reqAmtSum){
				com.alert("message.xom.ui.fin.025"); // 송금내역의 총금액이 가결의 총액과 일치하지 않습니다.\n송금내역의 총금액을 확인해 주세요.
				return false;
			}			
		}		
		
		// 관리항목 체크
		// 2010-03-28김기탁 팀장님 요청 지급처리일 경우 관련내역 감추고 데이터 저장 안함.
		// 20150715 일반경비발생은 관련내역 저장되도록 변경
		/* 
			Fn0500 지급 처리
			Fn0300 카드결의처리
			Fn0126 통제내역 지급결의(RCMS/POINT)
			Fn0065 수탁지원비
			Fn0055 이월연구비
		*/
		if(!/Fn0065|Fn0126|Fn0500|Fn0300|Fn0055/.test(dma_slipD.get("journ_cd"))){
			for(var i=0; i<dlt_mngmt.getRowCount(); i++){
				if(dlt_mngmt.getCellData(i,"essen_ex") == "Y"){
					if(dlt_mngmt.getCellData(i,"mngmt_detls_cd") == "" && dlt_mngmt.getCellData(i,"mngmt_detls_nm") == ""){
						com.alert(com.getMsg("message.xom.co.com.0001", (i+1)+"행의 관리항목"));
						return false;
					}
				}
				
				if(dma_slipD.get("expns_cd") == "99A" && dlt_mngmt.getCellData(i,"mngmt_item_cd") == "2091"){
					if(dlt_mngmt.getCellData(i,"mngmt_detls_cd") == ""){
						com.alert(com.getMsg("message.xom.co.com.0001", "매출계산서번호"));
						return false;
					}
				}
			}
		}

		return true;
	};

	/**
	 * 증빙 날짜 체크
	 */
	scwin.slip_date_check = function() {
		var evidYmdChk = true;
		
		if(scwin.data.serviceId == "F203" && /Fn0011|Fn0065|Fn0120/.test(dma_slipD.get("journ_cd"))){
			var slipYmd = dma_slipH.get("slip_ymd");
			var issuYmd = dma_bill.get("regs_date");
			
			// 계산서 날짜 > 결의일자  or 계산서발행월이 결의월가 같지 않으면 오류
			if ((issuYmd > slipYmd) || (issuYmd.substring(0, 6) != slipYmd.substring(0, 6))) {
				evidYmdChk = false;
			}
			
			// 그리드 모든 행의 계산서 발행월이 같아야함
			for(var i=0; i<dlt_slipDr.getRowCount(); i++){
				if(dlt_slipDr.getCellData(i, "issu_ymd").trim() != "" && dlt_slipDr.getCellData(i, "issu_ymd").substring(0,6) != issuYmd.substring(0, 6)){
					evidYmdChk = false;
				}
			}
			
			// 증빙날짜 오류
			if(!evidYmdChk){
				biz.fin.pop.open(biz.fin.pop.TYPE.EVID_YMD_CHK, {}, function(retObj) {
				});	
			}
		}
		
		// 온라인 가수반제 - 입금일자(발생일자)와 결의일자 비교체크 (2017.07.12 427결의 추가)
		if(/Fn0105/.test(dma_slipD.get("journ_cd"))){
			if(ica_slip_ymd.getValue() < scwin.data.mngmt.accnt_ymd){
				com.alert(com.getMsg("message.xom.ui.fin.010", "입금일자", "결의일자")); //입금일자는 결의일자이전이어야 합니다.
				evidYmdChk = false;
			}
		}		
				
		return evidYmdChk;	
	};	
	
	/**
	 * 학술대회이력 클릭
	 */
	scwin.btn_confrHis_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		
		// 학술대회이력
		var data = {
			req_no : ibx_unslip_no.getValue(),
			ezbr_yn : "N",
			ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.CONFPOOL, data, function(ret) {			
		});
	};
	
	
	/**
	 * 송금내역 [+]버튼 클릭 이벤트
	 */
	scwin.btn_add_onclick = function(e) {
		if(dma_slipD.get("total_amt") == ""){
			com.alert("message.xom.ui.fin.024");
			return;
		}	
		
		var reqAmtSum = 0;
		for(var i=0; i<dlt_sendreq.getRowCount(); i++){
			reqAmtSum += Number(dlt_sendreq.getCellData(i, "send_req_amt"));
		}
		
		var totalAmt = Number(dma_slipD.get("total_amt"));
		if(reqAmtSum > totalAmt){
			com.alert("message.xom.ui.fin.025"); // 송금금액이 신청금액을 초과 하였습니다.
			return;
		}
		
		var idx = com.addRow(grd_sendreq);
		var sendOdr = 1;
		if(idx > 0){
			sendOdr = parseInt(dlt_sendreq.getCellData(idx-1, "send_odr")) + 1;
		}
		
		dlt_sendreq.setCellData(idx, "send_odr", sendOdr);
		dlt_sendreq.setCellData(idx, "send_req_amt", totalAmt - reqAmtSum);
		dlt_sendreq.setCellData(idx, "rmk", dma_slipD.get("rmk_1"));
		if(dma_slipD.get("evid_cd") == "FAH611"){ // 지로
			dlt_sendreq.setCellData(idx, "pay_clsf", "FAX100");
		}else{
			dlt_sendreq.setCellData(idx, "pay_clsf", "FAX010"); // 개인지급
		}
		dlt_sendreq.setCellData(idx, "cud_type", "C");
		
		grd_sendreq.setFocusedCell(idx, "pay_clsf");
	};
	
	/**
	 * 송금내역 [-]버튼 클릭 이벤트
	 */
	scwin.btn_sendDel_onclick = function(e) {
		var row = grd_sendreq.getFocusedRowIndex();
		if(row < 0){
			com.alert(com.getMsg("message.xom.ui.fin.002", "삭제할 행"));
			return;
		}
		
		dlt_sendreq.setCellData(row, "cud_type", "D");
		dlt_sendreq.removeRow(row);
	};
	
	/**
	 * 송금내역 이미지 클릭 이벤트
	 */
	scwin.grd_sendreq_oncellclick = function(row,col,colId) {
		if(col == grd_sendreq.getColumnIndex("btn_emp_vend")){
			var payClsf = dlt_sendreq.getCellData(row, "pay_clsf");
			if(payClsf == ""){
				com.alert(com.getMsg("message.xom.co.com.0001", "지급구분"));
				return;
			}
			
			if(payClsf == "FAX010"){ // 개인
				var data ={
					clsf : "apart",
					ref_yn : "Y"
				};
				com.pop.open(com.pop.TYPE.BNKAC, data, function(ret) {
					dlt_sendreq.setCellData(row, "syspayno", ret.syspayno);
					dlt_sendreq.setCellData(row, "emp_vend", ret.empno);
					dlt_sendreq.setCellData(row, "bankaccnt_no", ret.bankaccnt_no);
					dlt_sendreq.setCellData(row, "depstr_nm", ret.depstr_nm);
					dlt_sendreq.setCellData(row, "bank", ret.bank);
					
					// TODO 계좌검증
					//scwin.verifyAccount(row);
				});
			}else if(payClsf == "FAX020"){ // 거래처(3), 기타, 지로
				var data = {};
				var bsnsNo = dma_bill.get("bsns_psn_regst_no").trim();
				if(bsnsNo == ""){
					data.ref_yn = "Y";	
				}else{
					if(bsnsNo.length == 10){
						bsnsNo = bsnsNo.replace(/(\d{3})(\d{2})(\d{5})/, '$1-$2-$3');
					}
					data.bsns_psn_regst_no = bsnsNo;
				}
				
				com.pop.open(com.pop.TYPE.VEND, data, function(ret){
					dlt_sendreq.setCellData(row, "vend_cd", ret.vend_cd);
					dlt_sendreq.setCellData(row, "vend_nm", ret.vend_abbr);
					dlt_sendreq.setCellData(row, "emp_vend", ret.vend_abbr);
					dlt_sendreq.setCellData(row, "bankaccnt_no", ret.bankaccnt_no);
					dlt_sendreq.setCellData(row, "depstr_nm", ret.depstr);
					dlt_sendreq.setCellData(row, "bank", ret.tran_bank);
					
					// TODO 계좌검증
					//scwin.verifyAccount(row);
				});
			}else if(/FAX090|FAX100/.test(payClsf)){ // FAX090 기타(송금)지급, FAX100 지로
				com.alert("message.xom.ui.fin.028");
			}
		}
	};
	
	/**
	 * 송금내역 데이터변경 이벤트
	 */
	scwin.grd_sendreq_onviewchange = function(info) {
		var col = info.colIndex;
		var row = info.rowIndex;
		var payClsf = dlt_sendreq.getCellData(row, "pay_clsf");
		
		if(col == grd_sendreq.getColumnIndex("pay_clsf")){
			dlt_sendreq.setCellData(row, "vend_cd", "");
			dlt_sendreq.setCellData(row, "vend_nm", "");
			dlt_sendreq.setCellData(row, "emp_vend", "");
			dlt_sendreq.setCellData(row, "bankaccnt_no", "");
			dlt_sendreq.setCellData(row, "depstr_nm", "");
			dlt_sendreq.setCellData(row, "bank", "");
			dlt_sendreq.setCellData(row, "syspayno", "");
			
			scwin.setGrdSendreq(row, payClsf);
			
		}else if(col == grd_sendreq.getColumnIndex("bankaccnt_no")){
			var chkValue = dlt_sendreq.getCellData(row, "bankaccnt_no").trim().replace(/-/gi,'');
			if(payClsf == "FAX090" && isNaN(chkValue)){
				com.alert("message.xom.ui.fin.035");
				dlt_sendreq.setCellData(row, "bankaccnt_no", "");
				dlt_sendreq.setCellData(row, "is_account", "0");
				scwin.setAccntInfo('0', row);
			}
		}
	};
	
	/**
	 * 송금내역 그리드 셋팅
	 */
	scwin.setGrdSendreq = function(row, payClsf){
		if(/FAX010|FAX020/.test(payClsf)){
			grd_sendreq.setCellReadOnly(row, "bankaccnt_no", true);
			grd_sendreq.setCellReadOnly(row, "depstr_nm", true);
			grd_sendreq.setCellReadOnly(row, "bank", true);
			grd_sendreq.setCellReadOnly(row, "emp_vend", true);
			grd_sendreq.setCellReadOnly(row, "btn_emp_vend", false);
		}else{
			grd_sendreq.setCellReadOnly(row, "depstr_nm", false);
			grd_sendreq.setCellReadOnly(row, "bank", false);
			grd_sendreq.setCellReadOnly(row, "btn_emp_vend", true);
			
			if (payClsf == "FAX100") { // 지로지급
				grd_sendreq.setCellReadOnly(row, "bankaccnt_no", true);
				grd_sendreq.setCellReadOnly(row, "emp_vend", true);
			} else {
				grd_sendreq.setCellReadOnly(row, "bankaccnt_no", false);
				grd_sendreq.setCellReadOnly(row, "emp_vend", false);
			}
		}
	};
	
	/**
	 * 2017.10.31 계좌번호 숫자여부 체크
	 */
	scwin.setAccntInfo = function(is_account, row){
		switch(is_account){
			case '0': grd_sendreq.setCellStyle( row , "is_account","color","black"); break;
			case '1': grd_sendreq.setCellStyle( row , "is_account","color","blue"); break;
			case '2': grd_sendreq.setCellStyle( row , "is_account","color","red"); break;		
		}		
	};
	
	/**
	 * 증빙버튼 클릭 이벤트
	 */
	scwin.btn_evid_onclick = function(e) {
		// 초기화
		scwin.reformData(2);
		
		var data= {
			journ_cd : dma_slipD.get("journ_cd"),
			slip_typ_cd : "110"		
		};
		
		biz.fin.pop.open(biz.fin.pop.TYPE.EVID_BILL, data, function(ret) {
			if(ret){
				dma_search.set("issu_seqno", ret.issu_seqno);			
				
				com.execute(sbm_selectBillInfo, {
					successCallback : function(e) {
						dma_bill.setJSON(e.responseJSON.elData.billList[0]);
						
						dma_slipD.set("total_amt", dma_bill.get("un_amt"));
						dma_slipD.set("bf_total_amt", 0);
						dma_slipD.set("bf_unslip_amt", 0);			
						dma_slipD.set("evid_cd", dma_bill.get("evid_cd"));
						dma_slipD.set("bill_no", dma_bill.get("issu_seqno"));
						dma_slipD.set("bsns_psn_regst_no", dma_bill.get("bsns_psn_regst_no"));		
						dma_slipD.set("rmk_2", dma_bill.get("vend_nm"));	
					
						scwin.setUnslipAmt((dma_bill.get("tax_amt") > 0)? "FTX001":"FTX002");
					}
				});
			}
		});
	};
	
	/**
	 * 전자증빙버튼 클릭 이벤트
	 */
	scwin.btn_elecBill_onclick = function(e){
		scwin.reformData();
		
		var data = {pur_con_user_id : scwin.data.sn
				  , pur_con_org_code : scwin.data.deptCode
				  , ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.TAXBILL, data, function(retObj) {
		});
	};
	
	/**
	 * 등록자 변경 이벤트
	 */
	scwin.acb_relat_onviewchange = function(info) {
		btn_billSrc.trigger("click");
	};

	/**
	 * 결의서디테일 차변 그리드 클릭 이벤트
	 */	
	scwin.grd_slipdr_oncellclick = function(row,col,colId) {		
		dma_slipD.setJSON(dlt_slipDr.getRowJSON(row));
		scwin.setSlipD();
	};
	
	/**
	 * 결의서디테일 대변 그리드 클릭 이벤트
	 */
	scwin.grd_slipcr_oncellclick = function(row,col,colId) {
		dma_slipD.setJSON(dlt_slipCr.getRowJSON(row));
		scwin.setSlipD();
	};

	/**
	 * 과제정보 팝업 호출
	 */	
	scwin.btn_prjInfo_onclick = function(e) {
		if(dma_slipD.get("mngmt_clsf") != "R"){
			com.alert("message.xom.ui.fin.034");
			return;
		}
		
		var data = {accnt_no : dma_slipD.get("accnt_no")
		            , ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.PRJNO, data, function(ret){			
		});
	};
	
	/**
	 * 비용코드 변경 이벤트
	 */	
	scwin.inputExpnsCd_onviewchange = function(info) {
		dma_slipD.set("expns_cd_nm", "");
		dma_slipD.set("accnt_cd", "");
		dma_slipD.set("accnt_cd_nm", "");
	};
	
	/**
	 * 결재신청 버튼 클릭 이벤트
	 */
	scwin.btn_apr_onclick = function(e) {
		var unslipNo = ibx_unslip_no.getValue();
		if(unslipNo == "" || dma_slipH.get("decsn_ex") == "Y") return;
		
		if(dma_slipD.get("unslip_no") == "") {
			alert("결의 상세내역이 존재하지 않습니다.\n좌측 차/대변 중 하나의 상세화면 활성화 후 결재신청 바랍니다.");
			return;
		}
		// 110결의외에는 바로 결재신청
		if(dma_slipH.get("slip_typ_cd") != "110"){
			scwin.menuApproval();
		}else{
			// 저장 전 체크	
			if (!scwin.validateData()) return;
			if (!scwin.checkPreSave()) return;
		
			// 결재신청전 체크		
			var evidYnCheck = false;
			for (var i = 0; i < dlt_slipDr.getRowCount(); i++) {			
				if (dlt_slipDr.getCellData(i, "evid_yn") == "Y") {
					evidYnCheck = true;
					break;
				}
			}
			if(evidYnCheck == true){
				scwin.checkEvidApproval();
			}else{
				if(dma_slipH.get("slip_typ_cd") == "110"){
					scwin.checkTotalAmt();
				}else{
					scwin.menuApproval();
				}
			}
		}
	};
	
		/**
	 * 이지바로 증빙 체크
	 */
	scwin.checkEvidApproval = function(){
		dma_search.set("inqr_clsf", "evid_check");
		
		com.execute(sbm_selectPreAprCheck, {
			successCallback : function(e){
				var evidMsg = "";
				var evidCheck = true;
				var data = {};
				for(var i=0; i<dlt_check.getRowCount(); i++){
					if(dlt_check.getCellData(i, "chk_yn") == "N"){
						evidMsg += "["+ dlt_check.getCellData(i, "accnt_no") +
									"] ["+ dlt_check.getCellData(i, "expns_cd") +"(" + dlt_check.getCellData(i, "expns_cd_nm") + ")] \n";
						
						if(evidCheck){
							data.unslip_no = dlt_check.getCellData(i, "unslip_no");
							data.unslip_odr = dlt_check.getCellData(i, "unslip_odr");
							data.expns_cd = dlt_check.getCellData(i, "expns_cd");
							data.service_id = dlt_check.getCellData(i, "service_id");
						}
						evidCheck = false;
					}
				}
				
				if(evidCheck){
					if(dma_slipH.get("slip_typ_cd") == "110"){
						scwin.checkTotalAmt();
					}else{
						scwin.menuApproval();
					}				
				}else{
					com.alert(com.getMsg("message.xom.ui.fin.052", evidMsg)); //  ~은 증빙내역을 입력해야 합니다.
					scwin.openEvidPop(data);
				}
			}
		});
	}
	
	/**
	 * 금액 증빙 체크
	 */
	scwin.checkTotalAmt = function(){
		if(ibx_total_amt_sum_dr.getValue() != ibx_total_amt_sum_cr.getValue()){
			com.alert("message.xom.ui.fin.054"); // 차 / 대변 금액이 일치하지 않습니다.
			return;
		}	
		
		dma_search.set("inqr_clsf", "amt_check");
		
		com.execute(sbm_selectPreAprCheck, {
			successCallback : function(e){
				var evidMsg = "";
				var evidCheck = true;
				var data = {};
				for(var i=0; i<dlt_check.getRowCount(); i++){
					if(dlt_check.getCellData(i, "chk_cnt") == 0){
						scwin.menuApproval();
					}else{
						com.alert(com.getMsg("message.xom.ui.fin.053", dlt_check.getCellData(i, "rtn_msg")));
					}
				}
			}
		});
	};
	
	
	/**
	 * 결재신청(저장 후 결재)
	 */
	scwin.menuApproval = function(){
		
		dma_slipH.set("approval", "true");	
		scwin.data.aprYn = "Y";
		
		scwin.save();
	};
	
	
	/**
	 * 차변 분개유형 변경 이벤트 이벤트
	 */
	scwin.sbx_journ_cd_dr_onviewchange = function(info) {
		if(this.getValue() == ""){
			sbx_journ_cd_dr.setStyle("color", "#000000");
		}else{
			sbx_journ_cd_dr.setStyle("color", "#FF0000");
		}
		sbx_journ_cd_cr.setStyle("color", "#000000");
		sbx_journ_cd_cr.setValue("");
		
		scwin.reformData();
		
		// 분개유형별 폼 data setting
		scwin.setFormData(this.getValue(), '1');
		
		// 분개유형별 폼 변경 
		scwin.settingForm(this.getValue());
	};
	
	/**
	 * 대변 분개유형 변경 이벤트 이벤트
	 */
	scwin.sbx_journ_cd_cr_onviewchange = function(info) {
		if(this.getValue() == ""){
			sbx_journ_cd_cr.setStyle("color", "#000000");
		}else{
			sbx_journ_cd_cr.setStyle("color", "#FF0000");
		}
		sbx_journ_cd_dr.setStyle("color", "#000000");
		sbx_journ_cd_dr.setValue("");
		
		scwin.reformData();
		
		// 분개유형별 폼 data setting
		scwin.setFormData(this.getValue(), '2');
		
		// 분개유형별 폼 변경 
		scwin.settingForm(this.getValue());
		
		// 결의금액 셋팅
		var drAmt = Number(ibx_total_amt_sum_dr.getValue());
		var crAmt = Number(ibx_total_amt_sum_cr.getValue());
		dma_slipD.set("total_amt", drAmt-crAmt);
		dma_slipD.set("unslip_amt", drAmt-crAmt);
		dma_slipD.set("tax_amt", 0);
	};
	
	/**
	 *분개유형별 폼 data setting(신규입력시)
	 */
	scwin.setFormData = function(journCd, baseDebitCr){
		// 삭제할 때 결의번호가 있을 경우에만 삭제가능해야 해서 아래부분 주석(분개유형변경 후 바로 삭제버튼 클릭했을 경우 막기위하여)
		//dma_slipD.set("unslip_no", ibx_unslip_no.getValue());
		dma_slipD.set("base_debit_cr", baseDebitCr);
		dma_slipD.set("journ_cd", journCd);
		dma_slipD.set("cud_type", "C");		
		
		// 계정번호 셋팅
		// 재무처리(차변),재무처리(대변),예금출금처리,예금입금처리,채권발생처리,채무발생처리,지급처리, 카드결의처리
		if(/Fn0130|Fn0140|Fn0220|Fn0230|Fn0070|Fn0080|Fn0500|Fn0300/.test(journCd)){
			dma_slipD.set("accnt_no", "FF030001");
			dma_slipD.set("accnt_no_nm", "재무회계");
			com.pop.open(com.pop.TYPE.ACNNO, {accnt_no : "FF030001"}, function(retObj) {
				dma_slipD.set("accnt_rspns", retObj.accnt_rspns);
				dma_slipD.set("fomat_unit", retObj.fomat_unit);
				dma_slipD.set("tax_cd", retObj.tax_cd);
			});
			
		}else{
			dma_slipD.set("accnt_no", "");
			dma_slipD.set("accnt_no_nm", "");
		}
		
		// 비용코드 셋팅
		// 채권발생처리,채무발생처리, 채권반제처리, 채무반제처리, 재무처리(차변),재무처리(대변),수입처리,예금출금처리,예금입금처리,카드결의처리,지급처리
		if(/Fn0070|Fn0080|Fn0090|Fn0100|Fn0105|Fn0130|Fn0140|Fn0160|Fn0220|Fn0230|Fn0300|Fn0500/.test(journCd)){
			dma_slipD.set("expns_cd", "999");
			dma_slipD.set("expns_cd_nm", "기타");
		}else{
			dma_slipD.set("expns_cd", "");
			dma_slipD.set("expns_cd_nm", "");
		}
		
		// 회계코드 셋팅
		if(/Fn0500/.test(journCd)){ // 지급처리
			dma_slipD.set("accnt_cd", "21009010");
			dma_slipD.set("accnt_cd_nm", "미지급(당좌)");
		}else{
			dma_slipD.set("accnt_cd", "");
			dma_slipD.set("accnt_cd_nm", "");
		}
		
		// 부분전체구분
		if(/Fn0126|Fn0120/.test(journCd)){
			dma_slipD.set("part_all_clsf", "P");
		}else{
			dma_slipD.set("part_all_clsf", "");
		}
		
		// 증빙코드
		if(/Fn0300/.test(journCd)){ // 카드결의처리(승인)(대변)
			dma_slipD.set("evid_cd", "FAH500");
		}else{
			dma_slipD.set("evid_cd", "FAH999");
		}
	}
	
	/**
	 *분개유형별 폼 변경 
	 */
	scwin.settingForm = function(journCd){
		/*
		Fn0011 일반경비발생
		Fn0065 수탁지원비
		Fn0070 채권발생처리
		Fn0080 채무발생처리
		Fn0090 채권반제처리
		Fn0100 채무반제처리
		Fn0105 On-Line입금(가수반제)
		Fn0115 결의내역대체처리
		Fn0120 통제내역 결의처리
		Fn0126 통제내역 지급결의(RCMS/POINT)		
		Fn0130 재무처리(차변)
		Fn0140 재무처리(대변)	
		Fn0160 수입처리
		Fn0220 예금출금처리
		Fn0230 예금입금처리
		Fn0300 카드결의처리
		Fn0500 지급처리
		Fn9910 자동결의처리(차변)
		*/
		
		if(journCd == ""){
			grp_card.hide();
			grp_bill.hide(); // 거래증빙내역
			grp_ctrl.hide(); // 통제번호 등
			grp_sendreq.hide(); // 송금내역
			grp_bill_btn.hide(); // 거래증빙
			spn_bill.hide();
			grp_part_all_clsf.hide(); // 완료구분
			
			// 증빙정보 버튼 숨기기(이지바로 과제일 경우에만 보임)
			btn_evidInfo.hide();			
			// 학술대회이력
			btn_confrHis.hide();	
			// 송금내역 메세지
			spn_send_msg.hide();		
			return;
		}
		
		// 카드내역
		if(journCd == "Fn0300"){
			grp_card.show("");
		}else{
			grp_card.hide();
		}
		
		// 거래증빙 내역
		if(/Fn0011|Fn0065/.test(journCd)){
			grp_bill.show(""); 		
			grp_ctrl.show("");	
		}else{
			grp_bill.hide(); // 거래증빙내역
			grp_ctrl.hide();
		}
		
		// 거래증빙 버튼
		if(/Fn0011|Fn0065|Fn0100|Fn0126|Fn0120|Fn0070/.test(journCd)){
			grp_bill_btn.show("");
			spn_bill.show("");
		}else{
			grp_bill_btn.hide(); 
			spn_bill.hide();
		}
		
		// 관련내역
		if(/Fn0065|Fn0126|Fn0500|Fn0300/.test(journCd)){
			grp_mngmt.hide();	
		}else{			
			grp_mngmt.show("");	
		}
		
		// 송금내역
		if(/Fn0126|Fn0500/.test(journCd)){
			grp_sendreq.show("");					
		}else{
			grp_sendreq.hide();
		}
		
		// 송금내역 메세지
		if(/Fn0500/.test(journCd)){
			spn_send_msg.show("");
		}else{
			spn_send_msg.hide();
		}
		
		// 부분 전체 구분
		if(/Fn0126|Fn0120/.test(journCd)){
			grp_part_all_clsf.show("");
		}else{
			grp_part_all_clsf.hide();
		}
			
		// 신규작성일 때
		if(dma_slipD.get("cud_type") == "C"){
			// 계정번호 검색 버튼
			if(/Fn0130|Fn0070|Fn0011|Fn0065|Fn0140|Fn0115|Fn0160/.test(journCd)){
				btn_accntNo.setDisabled(false);
				ibx_accnt_no.setReadOnly(false);
			}else{
				btn_accntNo.setDisabled(true);
				ibx_accnt_no.setReadOnly(true);
			}
			
			// 비용코드 검색 버튼 
			if(/Fn0130|Fn0011|Fn0065|Fn0070|Fn0140|Fn0230/.test(journCd)){
				btn_expns.setDisabled(false);
				ibx_expns_cd.setReadOnly(false);
			}else{
				btn_expns.setDisabled(true);
				ibx_expns_cd.setReadOnly(true);
			}
			
			// 회계코드 검색 버튼 
			// 일반경비발생, 수탁지원비, 지급처리,결의내역대체처리
			if(/Fn0011|Fn0065|Fn0500|Fn0115/.test(journCd)){			
				btn_accnt_cd.setDisabled(true);
			}else{
				btn_accnt_cd.setDisabled(false);
			}
			
			// 회계코드  
			// 재무처리(대변),재무처리(차변),채무발생처리,채권발생처리
			if(/Fn0140|Fn0130|Fn0080|Fn0070/.test(journCd)){	
				ibx_accnt_cd.setReadOnly(false);
			}else{
				ibx_accnt_cd.setReadOnly(true);
			}
			
			// 학술대회이력 및 증빙정보
			btn_confrHis.hide();
			btn_evidInfo.hide();
			
			// 첨부파일
			com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension});			
		}				
	};		
	
	/**
	 * 분개유형을 선택했는데도 불구하고 dma_slipD에 셋팅도지 않느 경우가 있어서 수행
	 */
	scwin.reSetJournCd = function(){
		if(sbx_journ_cd_dr.getValue() == "" && sbx_journ_cd_cr.getValue() == ""){
			com.alert(com.getMsg("message.xom.co.com.0003", "분개유형"));
			return false;
		}else{
			if(sbx_journ_cd_dr.getValue() != ""){
				 dma_slipD.set("journ_cd", sbx_journ_cd_dr.getValue());
			}
			
			if(sbx_journ_cd_cr.getValue() != ""){
				 dma_slipD.set("journ_cd", sbx_journ_cd_cr.getValue());
			}
			
			return true;
		}	
	};
	
	/**
	 * 회계코드 조회 버튼 클릭 이벤트
	 */
	scwin.btn_accnt_cd_onclick = function(e) {
		if(dma_slipD.get("journ_cd") == ""){
			if(!scwin.reSetJournCd()) return;
		}
		
		var journCd = dma_slipD.get("journ_cd");
		if(/Fn0120|Fn0126/.test(journCd)){
			if (dma_slipD.get("bill_no") == "") {
				com.alert(com.getMsg("message.xom.ui.fin.002" ,"거래증빙내역")); /*먼저 거래증빙내역을 선택하세요.*/
				return;
			}
		}
		
		if(dma_search.get("unslip_no") != ""){
			if(dma_search.get("unslip_no").substring(0,3) == "458" && journCd == "Fn0105" && dma_slipD.get("accnt_cd") == ""){
				for(var i=0; i<dlt_slipDr.getRowCount(); i++){
					if(dlt_slipDr.getCellData(i, "journ_cd") == "Fn0105" && dlt_slipDr.getCellData(i, "accnt_cd") == "21017911"){
						com.alert("message.xom.ui.fin.040"); //기술지원카드정산은 온라인가수 1건만 등록 가능합니다. 대변금액과 차이가 있는 경우 카드 취소금액 확인바랍니다.
						return;
					}
				}
			}
		}
		
		/*
		  Fn0070 채권발생처리(차변)
		  Fn0080 채무발생처리(대변)
		  Fn0130 재무처리(차변)
		  Fn0140 재무처리(대변)
		  Fn0500 지급처리(대변)
		  Fn0160 수입처리(대변)
		  Fn0196 어음부도처리(대변)
		  Fn0197 어음유동성대체처리(대변)
		  Fn0190 어음회수처리(대변)
		*/
		if(/Fn0130|Fn0070|Fn0140|Fn0080|Fn0160/.test(journCd)){
			scwin.getAccntCd(journCd);
		}else if(/Fn0230|Fn0220/.test(journCd)){ // Fn0230 예금입금처리(차변), Fn0220 예금출금처리(대변)
			scwin.getBankAccntNo();
		}else if(/Fn0120|Fn0126/.test(journCd)){// Fn0120 통제내역결의처리, Fn0126 통제내역 지급결의(RCMS/POINT)
			scwin.getCtrlAccntCd(journCd);
		}else if(/Fn0100|Fn0105|Fn0090/.test(journCd)){ // 채무반제처리, On-Line가수반제(차변),채권반제처리(대변)
			scwin.getDebtAccntCd(journCd);
		}else if(/Fn0300/.test(journCd)){ // 카드결의처리(승인)(대변)
			scwin.getCardAccntCd();
		}else if(/Fn0196|Fn0197|Fn0190/.test(journCd)){ // 어음부도처리(대변), 어음유동성대체처리(대변),어음회수처리(대변)
			scwin.getPrmsntAccntCd();
		}
	};
	
	/**
	 * 회계코드 조회
	 */
	scwin.getAccntCd = function(journCd){
		var data={ref_yn : "Y"};
		
		if(journCd == "Fn0070"){
			data.caseby_adjst_ex = "Y";
			data.bond_debt_clsf = "1";	
		}else if(journCd == "Fn0080"){
			data.caseby_adjst_ex = "Y";
			data.bond_debt_clsf = "2";	
		}else if(/Fn0130|Fn0140/.test(journCd)){
			data.caseby_adjst_ex = "N";
		}
		
		com.pop.open(com.pop.TYPE.ACNCD, data, function(ret) {
			if(!scwin.check(ret, 2)) return;
			
			dma_slipD.set("accnt_cd", ret.accnt_cd);
			dma_slipD.set("accnt_cd_nm", ret.accnt_cd_abbr);
			
			// 관리항목 셋팅
			scwin.setMngmt(ret.accnt_cd);
		});
	};
	
	/**
	 * 예금입금/출금처리 회계코드 조회
	 */
	scwin.getBankAccntNo = function(){
		var data ={
			  ref_yn : "Y"
			, clsf : "depst"
		};
		
		com.pop.open( com.pop.TYPE.BNKAC, data, function(ret){
			if(!scwin.check(ret, 2)) return;
			
			dma_slipD.set("accnt_cd", ret.accnt_cd);
			dma_slipD.set("accnt_cd_nm", ret.accnt_cd_abbr);
			
			scwin.data.mngmt = {};
			 
			scwin.data.mngmt = {
				  bank : ret.bank
				, bankaccnt_no : ret.bankaccnt_no
				, contrct_ymd : ret.contrct_ymd
				, expir_ymd : ret.expir_ymd
				, intrst_rt : ret.intrst_rt
				, bank_nm : ret.bank_nm
			};
			
			// 관리항목 셋팅
			scwin.setMngmt(ret.accnt_cd);
		});	
	};
	
	/**
	 * 통제내역 결의처리, 통제내역 지급결의(RCMS/POINT) 계정번호,회계코드,비용코드 조회
	 */
	scwin.getCtrlAccntCd = function(journCd){
		biz.fin.pop.open( biz.fin.pop.TYPE.CTRL, {journ_cd : journCd}, function(ret){
			// 통제내역 결의처리에서는 계정번호와 회계코드 체크 필요없음(2022.10.26.)
			//if(!scwin.check(ret, 0)) return; // 계정번호 검색 후 체크
			//if(!scwin.check(ret, 2)) return; // 회계코드 검색 후 체크
			
			var keys = ["accnt_no","accnt_no_nm", "accnt_rspns", "fomat_unit", "tax_cd", "mngmt_clsf", "accnt_cd","accnt_cd_nm", "expns_cd", "expns_cd_nm", "ctrl_no", "rmk", "req_no", "req_seq"];
			keys.forEach(function(item, idx){
				if(item == "rmk"){
					dma_slipD.set("rmk_1", ret[item]);	
				}else{
					dma_slipD.set(item, ret[item]);	
				}
			});	
			
			// 금액 재조정
			scwin.setUnslipAmt(dma_slipD.get("tax_cd"));				
			
			// 관리항목 조회
			if(ret.unslip_no.trim() != ""){
				dma_searchMng.set("unslip_no", ret.unslip_no);
				dma_searchMng.set("unslip_odr", ret.unslip_odr);
				dma_searchMng.set("accnt_cd", ret.accnt_cd);
				com.execute(sbm_selectSlipMngmt, {				
					successCallback : function(e) {		
						scwin.setGrdMngmt("U");						
					}
				});
			}else{
				if(journCd == "Fn0120"){
					scwin.setMngmt(ret.accnt_cd);
				}
			}
		});	
	};
	
	/**
	 * 채무반제, 비용코드, 계정번호 조회
	 */
	scwin.getDebtAccntCd = function(journCd){
		var type = "";
		var data ={};		

		if(journCd == "Fn0090"){
			type = biz.fin.pop.TYPE.BOND;
		}else{
			type = biz.fin.pop.TYPE.ON_LINE;
			data.journ_cd = journCd;
		}
		biz.fin.pop.open(type, data, function(retObj) {
			if(!scwin.check(retObj, 0)) return; // 계정번호 검색 후 체크
			if(!scwin.check(retObj, 2)) return; // 회계코드 검색 후 체크
			debugger;
			// 팝업 콜백
			dma_slipD.set("accnt_no", retObj.accnt_no);
			dma_slipD.set("accnt_no_nm", retObj.accnt_no_nm);
			dma_slipD.set("accnt_rspns", retObj.accnt_rspns);
			dma_slipD.set("fomat_unit", retObj.fomat_unit);
			dma_slipD.set("tax_cd", retObj.tax_cd);
			dma_slipD.set("accnt_cd", retObj.accnt_cd);
			dma_slipD.set("accnt_cd_nm", retObj.accnt_cd_nm);
			
			// 채무반제처리 인경우 계산서 데이터가 없는 경우에만 금액 셋팅(계산서 데이터를 우선으로 함)
			if(dma_bill.get("issu_seqno") == ""){
				dma_slipD.set("total_amt", retObj.unadjst_amt);
				dma_slipD.set("unslip_amt", retObj.unadjst_amt);
				dma_slipD.set("tax_amt", 0);
			}
			dma_slipD.set("occr_slip_no", retObj.slip_no);
			dma_slipD.set("occr_slip_odr", retObj.slip_odr);
			dma_slipD.set("rmk_2", retObj.rmk_2);
			if(journCd == "Fn0090"){
				dma_slipD.set("rmk_1", retObj.rmk_1);
			}
			
			scwin.data.mngmt = {};
			scwin.data.mngmt.accnt_ymd = retObj.accnt_ymd;
			scwin.data.mngmt.mngmt_item_1 = retObj.mngmt_item_1;	
			scwin.data.mngmt.mngmt_item_2 = retObj.mngmt_item_2;	
			scwin.data.mngmt.mngmt_item_nm_1 = retObj.mngmt_item_nm_1;	
			scwin.data.mngmt.mngmt_item_nm_2 = retObj.mngmt_item_nm_2;	
			scwin.data.mngmt.unadjst_amt = retObj.unadjst_amt;			
			
			// 관리항목 셋팅
			scwin.setMngmt(retObj.accnt_cd);
		});	
	};	
	
	/**
	 * 카드결의 처리 회계코드 조회
	 */
	scwin.getCardAccntCd = function(){
		biz.fin.pop.open(biz.fin.pop.TYPE.CARD_USE, {}, function(retObj) {
			if(!scwin.check(retObj, 2)) return; // 회계코드 검색 후 체크
			
			// 카드정보
			dma_card.setJSON(retObj);
			
			// 팝업 콜백
			dma_slipD.set("accnt_cd", retObj.conf_accnt_cd);
			dma_slipD.set("accnt_cd_nm", retObj.accnt_cd_nm);
			dma_slipD.set("total_amt", retObj.un_amt);
			dma_slipD.set("unslip_amt", retObj.un_amt);
			dma_slipD.set("tax_amt", 0);
			dma_slipD.set("occr_slip_no", retObj.slip_no);
			dma_slipD.set("occr_slip_odr", retObj.slip_odr);
			dma_slipD.set("rmk_2", retObj.joinsto_nm);
			
			dma_slipD.set("card_no", retObj.card_no);
			dma_slipD.set("card_clsf", retObj.card_clsf);
			dma_slipD.set("card_knd", retObj.card_knd);
			dma_slipD.set("use_ymd", retObj.use_ymd);	
			dma_slipD.set("apprvl_no", retObj.apprvl_no);	
			
			// 잔액관리항목 셋팅
			if (dma_slipD.get("card_clsf") == "FAI001") {
				dma_slipD.set("ramt_mngmt_1", "BC");
			} else {
				if (dma_slipD.get("card_knd") == "FAJ002") {
					dma_slipD.set("ramt_mngmt_1", "BC");
				} else if (/FAJ003|FAJ006|FAJ007/.test(dma_slipD.get("card_knd"))) {
					dma_slipD.set("ramt_mngmt_1", "신한");
				}
			}
			dma_slipD.set("ramt_mngmt_2", dma_slipD.get("card_no"));
		});	
	};
	
	/**
	 *  어음부도처리(대변), 어음유동성대체처리(대변),어음회수처리(대변)
	 */
	scwin.getPrmsntAccntCd = function(){
		biz.fin.pop.open(biz.fin.pop.TYPE.PRMSNT, {}, function(retObj) {
			dma_slipD.set("accnt_cd", retObj.contpat_accnt_cd);
			dma_slipD.set("total_amt", retObj.amt);
			dma_slipD.set("unslip_amt", retObj.amt);
			dma_slipD.set("tax_amt", 0);
			dma_slipD.set("rmk_1", retObj.accnt_no);
			
			// 관리항목 셋팅
			scwin.data.mngmt = {};
			scwin.data.mngmt.vend_cd = retObj.vend_cd;
			scwin.data.mngmt.vend_abbr = retObj.vend_abbr;	
			scwin.data.mngmt.prmsnt_no = retObj.prmsnt_no;	
			scwin.data.mngmt.depst_req_no = retObj.depst_req_no;	
			scwin.data.mngmt.pay_bank_nm = retObj.pay_bank_nm;	
			scwin.data.mngmt.expir_ymd = retObj.expir_ymd;
			scwin.data.mngmt.issu_ymd = retObj.issu_ymd;		
			
			// 관리항목 조회
			scwin.setMngmt(retObj.contpat_accnt_cd);
		});		
	}
	
	/**
	 * 결의일자 변경 이벤트
	 */
	scwin.ica_slip_ymd_onviewchange = function(info) {
		var slipYmd = scwin.data.slip_ymd; 
		if(slipYmd != "" && slipYmd.substring(0,6) != ica_slip_ymd.getValue().substring(0, 6)){
			 com.alert("message.xom.ui.fin.042"); //결의일자는 같은 월 안에서만 변경가능합니다. 결의 월을 변경하실 경우 삭제 후 재작성 해주시기 바랍니다.
			 ica_slip_ymd.setValue(dma_slipH.get("slip_ymd"));
		}
	};

	/**
	 * 계산서번호 조회
	 */
	scwin.btn_bill_onclick = function(e) {
		if(dma_slipD.get("bill_no").trim() == ""){
			com.alert(com.getMsg("message.xom.ui.fin.002" ,"거래증빙내역")); /*먼저 거래증빙내역을 선택하세요.*/
			return;
		}
		
		biz.fin.pop.open(biz.fin.pop.TYPE.BILL, {issu_seqno:dma_slipD.get("bill_no")}, function(ret) {
		});
	};
	
	/**
	 * 증빙정보 버튼 클릭 이벤트
	 */
	scwin.btn_evidInfo_onclick = function(e) {
		var data = {
			unslip_no : dma_slipD.get("unslip_no"),
			unslip_odr : dma_slipD.get("unslip_odr"),
			expns_cd : dma_slipD.get("expns_cd"),
			service_id : dma_slipD.get("service_id")
		};
		
		scwin.openEvidPop(data);
	};
	
	/**
	 * 이지바로 증빙 팝업 호출
	 */
	scwin.openEvidPop = function(data){
		switch(data.service_id){
			case "F236" : // 교육(학회/세미나)증빙정보	
				type = biz.fin.pop.TYPE.EDU;
				break;
			case "F237" : // 회의증빙정보
				type = biz.fin.pop.TYPE.MEET_EVID;
				break;
			case "F238" : // 특근자정보
				type = biz.fin.pop.TYPE.OVERTIME;
				break;
			case "F239" : // 전문가활용정보
				type = biz.fin.pop.TYPE.PRO_PRUSE;
				break;
		}
		
		biz.fin.pop.open(type, data, function(retObj) {
		});
	};
	
	/**
	 * 예실 버튼 클릭 이벤트
	 */
	scwin.btn_bugt_onclick = function(e) {
		if(ibx_accnt_no.getValue() == ""){
			com.alert(com.getMsg("message.xom.co.com.0001", "계정번호"));
			return;
		}
		var node = "accnt_no=" + ibx_accnt_no.getValue() + "&itm_solve_base=" + dma_slipD.get("itm_solve_base") + "&res_type=0";
		// TODO OZ REPORT
		//OZFlashOpen("/fin/fin/leg/FinAccntInfo01Sel.ozr", "FinAccntInfo01Sel", "Y", node);
		com.oz.openPopup({
			ozrCode: "F006",
			param: node    
        });
	};
	
	/**
	 * 미리보기 버튼 클릭 이벤트
	 */
	scwin.btn_evid_view_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		com.biz.openEvidWindow(ibx_unslip_no.getValue());
	};
	
	/**
	 * 인쇄 버튼 클릭 이벤트
	 */
	scwin.btn_print_onclick = function(e) {
		if(ibx_unslip_no.getValue() == "") return;
		
		var node = "unslip_no=" + ibx_unslip_no.getValue();
		if(dma_slipD.get("req_no") != ""){
			//OZFlashOpen("/fin/fin/spm/FinSlipRegst.ozr", "FinSlipRegst", "Y", param);
			com.oz.openPopup({
				ozrCode : "F001",      
				param: node
	        });
		}else{
			//OZFlashOpen("/fin/fin/spm/FinSlipRegst1.ozr", "FinSlipRegst", "Y", param);
			com.oz.openPopup({
				ozrCode : "F050",      
				param: node
	        });
		}
	};
	
	/**
	 * 계정번호 변경 이벤트(팝업에서는 수탁지원비에서는 PX계정이 조회되지 않는데 그냥 입력했을 경우에는 적용이 될 수 있도록 예외처리 2022.10.19. As Is에서도 동일)
	 */
	scwin.ibx_accnt_no_onkeyup = function(e) {
		if(e.keyCode == 13){
			if(dma_slipD.get("journ_cd") == "Fn0115"){ // 결의내역대체처리(대변)
	            scwin.getAccntNoCtrl();
	        }else{
	            scwin.getAccntNo("");    
	        }
		}
	};
	
	/**
	 * 계좌검증
	 */
	scwin.verifyAccount = function(row){
		var is_account = dlt_sendreq.getCellData(row, "is_account");
		var syspayno = dlt_sendreq.getCellData(row, "syspayno");
		
		if(is_account != "1" && dlt_sendreq.getCellData(row, "bank") != ""
					&& dlt_sendreq.getCellData(row, "bankaccnt_no") != ""
					&& dlt_sendreq.getCellData(row, "depstr_nm") != ""){	
						
			var data = {
				bank_cd : dlt_sendreq.getCellData(row, "bank"),
				bankaccnt_no : dlt_sendreq.getCellData(row, "bankaccnt_no").replace(/[^0-9]/g,''),
				syspayno : (syspayno != "")? syspayno : scwin.data.sn,
				depstr_nm : dlt_sendreq.getCellData(row, "depstr_nm"),
				iche_amt : dlt_sendreq.getCellData(row, "send_req_amt"),
			}	
			
			if(dlt_sendreq.getCellData(row,"pay_clsf") == "FAX020"){
				data.acnm_no = dlt_sendreq.getCellData(row, "bsns_psn_regst_no");  // 생년월일 or 사업자번호	
			}
			
			com.biz.verifyAccount(data, function(retObj){
				var valCnt = scwin.checkAccnt(retObj.res_data, retObj.depstr_nm);
				if(valCnt >= 0){
					dlt_sendreq.setCellData(row, "is_account", "1");
				}else{
					// [입력정보 : {0}] [검증결과 : {1}]
					dlt_sendreq.setCellData(row, "is_account", "2");
					com.alert(com.getMsg("message.xom.ui.fin.062", "[입력정보 :" + retObj.depstr_nm + "][검증결과 : " + retObj.res_data + "]"));	
				}
			});			
		}
	};
	
	/**
	 * 검증 처리
	 */
	scwin.checkAccnt = function(resData, depstrNm){
		resData = resData.replace("(주)",'').replace("(유)",'').replace("(사)",'').replace("(재)",'');
		resData = resData.replace(/[&\/\\#,+()$~%.'":*?<>{}\s]/g,'');
					
		depstrNm = depstrNm.replace("(주)",'').replace("(유)",'').replace("(사)",'').replace("(재)",'');
		depstrNm = depstrNm.replace(/[&\/\\#,+()$~%.'":*?<>{}\s]/g,'');
		
		return depstrNm.indexOf(resData.trim());
	};

	/**
	 * 거래처 변경 이벤트
	 */
	scwin.ibx_rmk_2_onviewchange = function(info) {
		if(info.newValue != ""){
			for(var i=0; i<dlt_mngmt.getRowCount(); i++){
				if(dlt_mngmt.getCellData(i, "mngmt_item_cd") == "3001"){
					if(dlt_mngmt.getCellData(i, "mngmt_detls_nm") == ""){
						dlt_mngmt.setCellData(i, "mngmt_detls_nm", info.newValue);
					}
				}
			}	
		}
	};
	
	/**
	 * 초기화 버튼 클릭 이벤트
	 */
	scwin.btn_reset_onclick = function(e) {
		if(dma_slipD.get("base_debit_cr")== "1") {
			sbx_journ_cd_dr.setValue("");
			sbx_journ_cd_dr.setStyle("color", "#000000");
		} else {
			sbx_journ_cd_cr.setValue("");
			sbx_journ_cd_cr.setStyle("color", "#000000");
		}
		scwin.reformData();
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="" class="pageWrap">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn" id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox ri" id="">
    				<xf:trigger class="btn" id="btn_evid_view" style="" type="button" ev:onclick="scwin.btn_evid_view_onclick" disabled="true">
    					<xf:label><![CDATA[미리보기]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" ev:onclick="scwin.btn_print_onclick" disabled="true">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick" disabled="true">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="과제정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id="ica_slip_ymd"
    						placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="결의일자" ref="data:dma_slipH.slip_ymd" ev:onviewchange="scwin.ica_slip_ymd_onviewchange">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_unslip_no" style="" title="결의번호" ref="data:dma_slipH.unslip_no" readOnly="true"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="">
    						<xf:group class="inpSch" id="grp_wrte_psn" style="width: 120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_empno" style="" title="작성자" ref="data:dma_slipH.empno"></xf:input>
    							<xf:trigger class="btn" id="btn_emp" style="" title="작성자 조회" type="button" ev:onclick="scwin.btn_emp_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="작성자 상세" ref="data:dma_slipH.nm" readOnly="true"></xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="작성부서" ref="data:dma_slipH.dept_nm" readOnly="true"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full req" id="" style="" title="적요" ref="data:dma_slipH.rmk"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정유무" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="확정유무" ref="data:dma_slipH.decsn_ex_nm" readOnly="true"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="확정결의번호" ref="data:dma_slipH.slip_no" readOnly="true"></xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group id="" class="lybox ">
    			<xf:group class="ly_column col_4" id="" style="">
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="차변합계" style="" tagname="h3"></w2:textbox>
    						<xf:input adjustMaxLength="false" class="inp ri" id="ibx_total_amt_sum_dr" style="" title="차변합계"
    							dataType="number" displayFormat="#,###">
    						</xf:input>
    					</xf:group>
    					<xf:group class="ri" id="" style="">
    						<xf:group class="result" id="">
    							<w2:span id="" label="총" style="" class=""></w2:span>
    							<w2:span class="numtotal" id="tbx_cnt" label="0" style=""></w2:span>
    							<w2:span id="" label="건" style=""></w2:span>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<w2:gridView class="grid" dataList="data:dlt_slipDr" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_slipdr" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb"
    					rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태"
    					rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd"
    					selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5" ev:oncellclick="scwin.grd_slipdr_oncellclick">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="계정번호" width="80">
    							</w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="과세구분" width="70"></w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="회계코드"
    								width="80">
    							</w2:column>
    							<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="회계코드명"
    								width="105">
    							</w2:column>
    							<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="총액" width="80">
    							</w2:column>
    							<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="금액" width="80"></w2:column>
    							<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="세액" width="80">
    							</w2:column>
    							<w2:column displayMode="label" id="column36" inputType="text" style="height:28px" value="적요" width="150"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="accnt_no" inputType="text" readOnly="true"
    								style="height:28px;" width="80">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="tax_cd" inputType="select" readOnly="true"
    								style="height:28px;" width="70" allOption="" chooseOption="" ref="">
    								<w2:choices>
    									<w2:item>
    										<w2:label><![CDATA[과세]]></w2:label>
    										<w2:value><![CDATA[FTX001]]></w2:value>
    									</w2:item>
    									<w2:item>
    										<w2:label><![CDATA[비과세]]></w2:label>
    										<w2:value><![CDATA[FTX002]]></w2:value>
    									</w2:item>
    								</w2:choices>
    							</w2:column>
    							<w2:column displayMode="label" id="accnt_cd" inputType="text" readOnly="true" style="height:28px;" width="80" value=""></w2:column>
    							<w2:column displayMode="label" id="accnt_cd_nm" inputType="text" readOnly="true" style="height:28px;" width="105" value="" class="le"></w2:column>
    							<w2:column displayMode="label" id="total_amt" inputType="text" readOnly="true" style="height:28px;" width="80" value="" dataType="number" displayFormat="#,###" class="ri"></w2:column>
    							<w2:column displayMode="label" id="unslip_amt" inputType="text" readOnly="true" style="height:28px;" width="80" value="" dataType="number" displayFormat="#,###" class="ri"></w2:column>
    							<w2:column displayMode="label" id="tax_amt" inputType="text" readOnly="true" style="height:28px" value=""
    								width="80" dataType="number" displayFormat="#,###" class="ri">
    							</w2:column>
    							<w2:column displayMode="label" id="rmk_1" inputType="text" readOnly="true" style="height:28px" value=""
    								width="150">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<w2:textbox class="tit_tbl" id="" label="대변합계" style="" tagname="h3"></w2:textbox>
    						<xf:input adjustMaxLength="false" class="inp ri" id="ibx_total_amt_sum_cr" style="" title="차변합계"
    							dataType="number" displayFormat="#,###">
    						</xf:input>
    					</xf:group>
    					<xf:group class="ri" id="" style="">
    						<xf:group class="result" id="">
    							<w2:span id="" label="총" style=""></w2:span>
    							<w2:span class="numtotal" id="spn_cnt" label="0" style=""></w2:span>
    							<w2:span id="" label="건" style=""></w2:span>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<w2:gridView class="grid" dataList="data:dlt_slipCr" defaultCellHeight="28"
    					evenRowBackgroundColor="#f7faff" id="grd_slipcr" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb"
    					rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태"
    					rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd"
    					selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5" ev:oncellclick="scwin.grd_slipcr_oncellclick">
    					<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    					<w2:header id="header1" style="">
    						<w2:row id="row1" style="">
    							<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="계정번호" width="80"></w2:column>
    							<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="과세구분" width="70"></w2:column>
    							<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="회계코드"
    								width="80">
    							</w2:column>
    							<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="회계코드명"
    								width="105">
    							</w2:column>
    							<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="총액" width="80"></w2:column>
    							<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="금액" width="80"></w2:column>
    							<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="세액" width="80"></w2:column>
    							<w2:column displayMode="label" id="column36" inputType="text" style="height:28px" value="적요" width="150"></w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody id="gBody1" style="">
    						<w2:row id="row2" style="">
    							<w2:column displayMode="label" escape="false" id="accnt_no" inputType="text" readOnly="true"
    								style="height:28px;" width="80" value="">
    							</w2:column>
    							<w2:column displayMode="label" escape="false" id="tax_cd" inputType="select" readOnly="true"
    								style="height:28px;" width="70" allOption="" chooseOption="" ref="">
    								<w2:choices>
    									<w2:item>
    										<w2:label><![CDATA[과세]]></w2:label>
    										<w2:value><![CDATA[FTX001]]></w2:value>
    									</w2:item>
    									<w2:item>
    										<w2:label><![CDATA[비과세]]></w2:label>
    										<w2:value><![CDATA[FTX002]]></w2:value>
    									</w2:item>
    								</w2:choices>
    							</w2:column>
    							<w2:column displayMode="label" id="accnt_cd" inputType="text" readOnly="true" style="height:28px;" width="80"></w2:column>
    							<w2:column displayMode="label" id="accnt_cd_nm" inputType="text" readOnly="true" style="height:28px;" width="105" value="" class="le"></w2:column>
    							<w2:column displayMode="label" id="total_amt" inputType="text" readOnly="true" style="height:28px;" width="80" value="" class="ri" dataType="number" displayFormat="#,###"></w2:column>
    							<w2:column displayMode="label" id="unslip_amt" inputType="text" readOnly="true" style="height:28px;" width="80" value="" class="ri" dataType="number" displayFormat="#,###"></w2:column>
    							<w2:column displayMode="label" id="tax_amt" inputType="text" readOnly="true" style="height:28px" value=""
    								width="80" class="ri" dataType="number" displayFormat="#,###">
    							</w2:column>
    							<w2:column displayMode="label" id="rmk_1" inputType="text" readOnly="true" style="height:28px" value=""
    								width="150">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<w2:wframe id="wfm_evid" src="/ui/com/pop/COM_F001_00P.xml" style=""></w2:wframe>
    				<xf:group class="helparea" id="grp_wrte_msg" style="">
    					<xf:group id="" style="" tagname="ul">
    						<xf:group id="" style="" tagname="li">
    							<w2:textbox class="red" id="" label="결의서 삭제/취소안내자동결의로 생성된 결의서는 자동결의서를 생성한 메뉴에서 삭제/취소 가능합니다." style=""
    								tagname="span">
    							</w2:textbox>
    						</xf:group>
    						<xf:group id="" style="" tagname="li">
    							<w2:textbox class="red" id="" label="[수정안내] 과세 &gt; 비과세 혹은 비과세 &gt; 과세로 수정 시, 삭제 후 입력하세요." style=""
    								tagname="span">
    							</w2:textbox>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="helparea" id="" style="">
    					<xf:group id="" style="" tagname="ul">
    						<xf:group id="" style="" tagname="li">
    							<w2:textbox class="red" id="tbx_msg" label="" style=""
    								tagname="span">
    							</w2:textbox>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group id="" class="ly_column col_6">
    				<xf:group class="titleSection" id="" style="">
    					<xf:group class="le" id="">
    						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="- 차변 -" class="sel"
    							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_journ_cd_dr" style="width:150px;"
    							submenuSize="auto" ref="" ev:onviewchange="scwin.sbx_journ_cd_dr_onviewchange" visibleRowNum="10">
    							<xf:choices>
    								<xf:itemset nodeset="data:dlt_journ_dr">
    									<xf:label ref="code_nm"></xf:label>
    									<xf:value ref="code"></xf:value>
    								</xf:itemset>
    							</xf:choices>
    						</xf:select1>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="- 대변 -" class="sel"
    							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_journ_cd_cr" ref="" style="width:150px;"
    							submenuSize="auto" ev:onviewchange="scwin.sbx_journ_cd_cr_onviewchange" visibleRowNum="10">
    							<xf:choices>
    								<xf:itemset nodeset="data:dlt_journ_cr">
    									<xf:label ref="code_nm"></xf:label>
    									<xf:value ref="code"></xf:value>
    								</xf:itemset>
    							</xf:choices>
    						</xf:select1>
    					</xf:group>
    					<xf:group class="ri" id="" style="">
    						<xf:trigger class="btn" id="btn_reset" style="" type="button" ev:onclick="scwin.btn_reset_onclick">
    							<xf:label><![CDATA[초기화]]></xf:label>
    						</xf:trigger>
    						<xf:trigger class="btn" ev:onclick="scwin.btn_confrHis_onclick" id="btn_confrHis" style="" type="button">
    							<xf:label><![CDATA[학술대회이력]]></xf:label>
    						</xf:trigger>
    						<xf:trigger class="btn" id="btn_evidInfo" style="" type="button" ev:onclick="scwin.btn_evidInfo_onclick">
    							<xf:label><![CDATA[증빙정보]]></xf:label>
    						</xf:trigger>
    						<xf:trigger class="btn" id="btn_prjInfo" style="" type="button" ev:onclick="scwin.btn_prjInfo_onclick">
    							<xf:label><![CDATA[과제정보]]></xf:label>
    						</xf:trigger>
    						<xf:trigger class="btn" id="btn_bugt" style="" type="button" ev:onclick="scwin.btn_bugt_onclick">
    							<xf:label><![CDATA[예실]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb tbl " id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption" text="검수요청정보입력"></xf:group>
    					<xf:group style="" tagname="colgroup">
    						<xf:group style="width:160px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    						<xf:group style="width:180px;" tagname="col"></xf:group>
    						<xf:group style="" tagname="col"></xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="계정번호" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:group class="flex" id="">
    								<xf:group class="inpSch" id="grp_accnt_no" style="width:145px;">
    									<xf:input adjustMaxLength="false" class="inp req" id="ibx_accnt_no" style="text-transform:uppercase;" title="계정번호"
    										ref="data:dma_slipD.accnt_no" maxlength="8" ev:onkeyup="scwin.ibx_accnt_no_onkeyup">
    									</xf:input>
    									<xf:trigger class="btn" id="btn_accntNo" style="" title="계정번호 조회" type="button"
    										ev:onclick="scwin.btn_accntNo_onclick">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    								<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="계정번호 상세" readOnly="true"
    									ref="data:dma_slipD.accnt_no_nm">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th" style="">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="회계코드" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td" style="">
    							<w2:attributes></w2:attributes>
    							<xf:group class="flex" id="" style="">
    								<xf:group class="inpSch" id="" style="width:140px;">
    									<xf:input adjustMaxLength="false" class="inp" id="ibx_accnt_cd" readOnly="true"
    										ref="data:dma_slipD.accnt_cd" style="" title="회계코드" allowChar="0-9" maxlength="8">
    									</xf:input>
    									<xf:trigger class="btn" ev:onclick="scwin.btn_accnt_cd_onclick" id="btn_accnt_cd" style=""
    										title="회계코드 조회" type="button">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    								<xf:input adjustMaxLength="false" class="inp full" id="" readOnly="true"
    									ref="data:dma_slipD.accnt_cd_nm" style="" title="회계코드 상세">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="비용코드" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:group class="flex" id="" style="">
    								<xf:group class="inpSch" id="grp_expns_cd" style="width: 120px;">
    									<xf:input adjustMaxLength="false" class="inp req" id="ibx_expns_cd" style="" title="비용코드"
    										ref="data:dma_slipD.expns_cd" maxlength="3">
    									</xf:input>
    									<xf:trigger class="btn" id="btn_expns" style="" type="button" title="비용코드 조회"
    										ev:onclick="scwin.btn_expns_onclick">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    								<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="비용코드 상세"
    									ref="data:dma_slipD.expns_cd_nm" readOnly="true">
    								</xf:input>
    							</xf:group>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="spn_bill" label="증빙" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:group class="flex" id="grp_bill_btn" style="">
    								<xf:trigger class="btn" ev:onclick="scwin.btn_billSrc_onclick" id="btn_billSrc" style=""
    									type="button">
    									<xf:label><![CDATA[조회]]></xf:label>
    								</xf:trigger>
    								<xf:trigger class="btn" ev:onclick="scwin.btn_evid_onclick" id="btn_evid" style="" type="button">
    									<xf:label><![CDATA[증빙]]></xf:label>
    								</xf:trigger>
    								<xf:trigger class="btn" ev:onclick="scwin.btn_elecBill_onclick" id="btn_elecBill" style=""
    									type="button">
    									<xf:label><![CDATA[전자증빙]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="총액" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req ri" id="inputTotalAmt" style="" title="총액"
    								ref="data:dma_slipD.total_amt" dataType="number" displayFormat="#,###" ev:onviewchange="scwin.inputTotalAmt_onviewchange">
    							</xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="거래처" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req" id="ibx_rmk_2" style="" title="거래처"
    								ref="data:dma_slipD.rmk_2" ev:onviewchange="scwin.ibx_rmk_2_onviewchange">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="결의금액" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req ri" id="inputUnslipAmt" style="" title="결의금액"
    								ref="data:dma_slipD.unslip_amt" dataType="number" displayFormat="#,###" readOnly="true">
    							</xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="세액" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req ri" id="inputTaxAmt" style="" title="세액"
    								ref="data:dma_slipD.tax_amt" dataType="number" displayFormat="#,###" readOnly="true">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
    							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full req" id="ibx_rmk_1" style="" title="적요"
    								ref="data:dma_slipD.rmk_1" ev:onchange="scwin.ibx_rmk_1_onchange">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group id="grp_part_all_clsf" style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="tbx_part_all_clsf" label="완료구분" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="sbx_part_all_clsf" ref="data:dma_slipD.part_all_clsf"
    								style="width:150px;" submenuSize="auto" chooseOptionLabel="-선택-">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[부분]]></xf:label>
    										<xf:value><![CDATA[P]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[완료]]></xf:label>
    										<xf:value><![CDATA[F]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
    							<w2:span class="helptxt red" id="" label="※ 완료의 경우 원장확정시 원인행위 총정리" style=""></w2:span>
    						</xf:group>
    					</xf:group>
    					<xf:group id="grp_ctrl" style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="통제번호" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full" id="" readOnly="true" ref="data:dma_slipD.ctrl_no"
    								style="" title="통제번호">
    							</xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="예산잔액" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" class="inp full ri" dataType="number" displayFormat="#,###"
    								id="inputBugtRamtAmt" readOnly="true" style="" title="예산잔액">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="첨부파일" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes>
    								<w2:colspan>3</w2:colspan>
    								<w2:rowspan>1</w2:rowspan>
    							</w2:attributes>
    							<xf:group style="height:125px;">
    								<xf:group class="full" id="upload_A" style="height:100%;"></xf:group>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group id="grp_bill"><xf:group style="" id="" class="titleSection">
    					<xf:group id="" class="le">
    						<w2:textbox tagname="h3" style="" id="" label="거래증빙내역" class="tit_tbl"></w2:textbox>
    					</xf:group>
    					<xf:group id="" class="ri"></xf:group>
    				</xf:group><xf:group tagname="table" style="" id="" class="w2tb tbl ">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption" text="검수요청정보입력"></xf:group>
    					<xf:group tagname="colgroup" style="">
    						<xf:group tagname="col" style="width:160px;"></xf:group>
    						<xf:group tagname="col" style=""></xf:group>
    						<xf:group tagname="col" style="width:180px;"></xf:group>
    						<xf:group tagname="col" style=""></xf:group>
    					</xf:group>
    					<xf:group tagname="tr">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="(세금)계산서"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:group style="" id="" class="flex">
    								<xf:group style="" id="" class="inpSch">
    									<xf:input adjustMaxLength="false" style="" id="" title="비용코드" class="inp" ref="data:dma_bill.note3"></xf:input>
    									<xf:trigger style="" id="btn_bill" title="비용코드 조회" type="button" class="btn" ev:onclick="scwin.btn_bill_onclick">
    										<xf:label><![CDATA[검색]]></xf:label>
    									</xf:trigger>
    								</xf:group>
    							</xf:group>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="거래처"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="증빙" class="inp full" ref="data:dma_bill.vend_nm"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="사업자번호"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="총액" class="inp full" ref="data:dma_bill.bsns_psn_regst_no"></xf:input>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="발행일"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="거래처" class="inp full" ref="data:dma_bill.regs_date" dataType="date" displayFormat="yyyy-MM-dd"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="공급가액"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input dataType="number" displayFormat="#,###" adjustMaxLength="false" style="" readOnly="true" id="" title="결의금액" class="inp full ri" ref="data:dma_bill.chrg_amt"></xf:input>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="세액"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input dataType="number" displayFormat="#,###" adjustMaxLength="false" style="" readOnly="true" id="" title="세액" class="inp full ri" ref="data:dma_bill.tax_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="합계금액"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input dataType="number" displayFormat="#,###" adjustMaxLength="false" style="" readOnly="true" id="" title="결의금액" class="inp full ri" ref="data:dma_bill.totl_amt"></xf:input>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="미처리금액"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input dataType="number" displayFormat="#,###" adjustMaxLength="false" style="" readOnly="true" id="" title="세액" class="inp full ri" ref="data:dma_bill.un_amt"></xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group></xf:group><xf:group id="grp_card"><xf:group style="" id="" class="titleSection">
    					<xf:group id="" class="le">
    						<w2:textbox tagname="h3" style="" id="" label="카드내역" class="tit_tbl"></w2:textbox>
    					</xf:group>
    					<xf:group id="" class="ri"></xf:group>
    				</xf:group><xf:group tagname="table" style="" id="" class="w2tb tbl ">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption" text="검수요청정보입력"></xf:group>
    					<xf:group tagname="colgroup" style="">
    						<xf:group tagname="col" style="width:160px;"></xf:group>
    						<xf:group tagname="col" style=""></xf:group>
    						<xf:group tagname="col" style="width:180px;"></xf:group>
    						<xf:group tagname="col" style=""></xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="카드번호"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="총액" class="inp full" ref="data:dma_card.card_no"></xf:input>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="승인번호"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="거래처" class="inp full" ref="data:dma_card.apprvl_no"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="승인일자"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="결의금액" class="inp full" ref="data:dma_card.use_ymd"></xf:input>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="가맹점명"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="세액" class="inp full" ref="data:dma_card.joinsto_nm"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group tagname="tr" style="">
    						<xf:group tagname="th" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="사용금액"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input dataType="number" displayFormat="#,###" adjustMaxLength="false" style="" readOnly="true" id="" title="결의금액" class="inp full ri" ref="data:dma_card.use_amt"></xf:input>
    						</xf:group>
    						<xf:group tagname="th" style="" class="w2tb_th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox tagname="span" style="" id="" label="주소"></w2:textbox>
    						</xf:group>
    						<xf:group tagname="td" style="" class="w2tb_td">
    							<w2:attributes></w2:attributes>
    							<xf:input adjustMaxLength="false" style="" readOnly="true" id="" title="세액" class="inp full" ref="data:dma_card.shop_addr1"></xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group></xf:group>
    			<xf:group id="grp_sendreq"><xf:group style="" id="grp_sendreq_title" class="titleSection">
    					<xf:group id="" class="le">
    						<w2:textbox tagname="h3" style="" id="" label="송금내역" class="tit_tbl"></w2:textbox>
    					</xf:group>
    					<xf:group id="" class="ri">
    						<w2:span class="note red" id="spn_send_msg" label="※ 여러건이라도 총 합계금액을 적어서 1건으로 작성요망" style=""></w2:span>
    						<xf:group style="" id="" class="btnarea">
    							<xf:trigger ev:onclick="scwin.btn_add_onclick" style="" id="btn_add" type="button" class="bt_plus">
    								<xf:label><![CDATA[추가]]></xf:label>
    							</xf:trigger>
    							<xf:trigger ev:onclick="scwin.btn_sendDel_onclick" style="" id="btn_sendDel" type="button"
    								class="bt_minus">
    								<xf:label><![CDATA[삭제]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    					</xf:group>
</xf:group>
    				<w2:gridView rowNumVisible="true" rowStatusWidth="50" rowNumHeaderValue="No." scrollByColumn="false"
    					defaultCellHeight="28" rowNumBackgroundColor="#fff" selectedCellColor="#fbf2cd" rowNumWidth="60" evenRowBackgroundColor="#f7faff"
    					autoFit="allColumn" id="grd_sendreq" class="grid" ev:oncellclick="scwin.grd_sendreq_oncellclick" editModeEvent="onclick"
    					scrollByColumnAdaptive="false" selectedRowColor="#fbf2cd" summaryAuto="true" readOnly="true" rowStatusHeaderValue="상태"
    					noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowStatusVisible="false" dataList="data:dlt_sendreq"
    					ev:onviewchange="scwin.grd_sendreq_onviewchange" style="height: 85px;" visibleRowNum="5" rowMouseOverColor="#e7f0fb">
    					<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
    					<w2:header style="" id="header1">
    						<w2:row style="" id="row1">
    							<w2:column width="70" inputType="text" style="height:28px;" id="column5" value="구분" displayMode="label"></w2:column>
    							<w2:column width="70" inputType="text" style="height:28px;" id="column3" value="금액" displayMode="label"></w2:column>
    							<w2:column rowSpan="" colSpan="2" width="130" inputType="text" style="height:28px;" id="column20"
    								value="개인(거래처)" displayMode="label">
    							</w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" id="column27" value="입금계좌"
    								displayMode="label">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="column25" value="예금주" displayMode="label"></w2:column>
    							<w2:column width="80" inputType="text" style="height:28px" id="column23" value="은행" displayMode="label"></w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="column21" value="검증결과 " displayMode="label"
    								hidden="true">
    							</w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody style="" id="gBody1">
    						<w2:row style="" id="row2">
    							<w2:column viewType="icon" width="70" inputType="select" readOnly="false" style="height:28px;" id="pay_clsf"
    								escape="false" displayMode="label">
    							</w2:column>
    							<w2:column dataType="number" width="70" displayFormat="#,###" inputType="text" readOnly="false"
    								style="height:28px;" id="send_req_amt" class="ri" escape="false" displayMode="label">
    							</w2:column>
    							<w2:column width="100" inputType="text" readOnly="true" style="height:28px;" id="emp_vend"
    								displayMode="label">
    							</w2:column>
    							<w2:column width="30" imageSrc="/cm/images/sample/btn_tbsearch02.png" inputType="image" style="height:28px"
    								id="btn_emp_vend" value="" displayMode="label">
    							</w2:column>
    							<w2:column width="100" inputType="text" style="height:28px" allowChar="0-9-" id="bankaccnt_no" value=""
    								displayMode="label">
    							</w2:column>
    							<w2:column width="70" inputType="text" style="height:28px" id="depstr_nm" value="" displayMode="label"></w2:column>
    							<w2:column width="80" inputType="select" style="height:28px" id="bank" value="" displayMode="label"></w2:column>
    							<w2:column ref="" chooseOption="" width="70" inputType="select" style="height:28px" allOption=""
    								id="is_account" value="" displayMode="label">
    								<w2:choices>
    									<w2:item>
    										<w2:label><![CDATA[미검증]]></w2:label>
    										<w2:value><![CDATA[0]]></w2:value>
    									</w2:item>
    									<w2:item>
    										<w2:label><![CDATA[검증]]></w2:label>
    										<w2:value><![CDATA[1]]></w2:value>
    									</w2:item>
    									<w2:item>
    										<w2:label><![CDATA[검증오류]]></w2:label>
    										<w2:value><![CDATA[2]]></w2:value>
    									</w2:item>
    								</w2:choices>
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView></xf:group><xf:group id="grp_mngmt"><xf:group style="" id="" class="titleSection">
    					<xf:group id="" class="le">
    						<w2:textbox tagname="h3" style="" id="" label="관련내역" class="tit_tbl"></w2:textbox>
    					</xf:group>
    				</xf:group>
	<w2:gridView rowNumVisible="true" rowStatusWidth="50" rowNumHeaderValue="No." scrollByColumn="false" defaultCellHeight="28"
		rowNumBackgroundColor="#fff" selectedCellColor="#fbf2cd" rowNumWidth="60" evenRowBackgroundColor="#f7faff" autoFit="allColumn"
		id="grd_mngmt" class="grid" ev:oncellclick="scwin.grd_mngmt_oncellclick" editModeEvent="onclick" scrollByColumnAdaptive="false"
		selectedRowColor="#fbf2cd" summaryAuto="true" rowStatusHeaderValue="상태" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
		rowStatusVisible="false" dataList="data:dlt_mngmt" ev:onviewchange="scwin.grd_mngmt_onviewchange" style="height: 85px;" visibleRowNum="5"
		rowMouseOverColor="#e7f0fb">
		<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
		<w2:header style="" id="header1">
			<w2:row style="" id="row1">
				<w2:column width="87" inputType="text" style="height:28px;" id="column5" value="관리항목" displayMode="label"></w2:column>
				<w2:column rowSpan="" colSpan="2" width="168" inputType="text" style="height:28px;" id="column3" value="세부적요"
					displayMode="label">
				</w2:column>
				<w2:column width="300" inputType="text" style="height:28px;" id="column20" value="세부적요명" displayMode="label"></w2:column>
				<w2:column width="70" inputType="text" style="height:28px" id="column21" value="필수여부" displayMode="label"></w2:column>
			</w2:row>
		</w2:header>
		<w2:gBody style="" id="gBody1">
			<w2:row style="" id="row2">
				<w2:column width="87" inputType="text" readOnly="true" style="height:28px;" id="mngmt_item_nm" escape="false"
					displayMode="label">
				</w2:column>
				<w2:column typeGetter="getType" width="137" imageSrc="/cm/images/sample/btn_tbsearch02.png" inputType="text"
					style="height:28px;" id="mngmt_detls_cd" class="le" escape="false" displayMode="label">
				</w2:column>
				<w2:column width="31" imageSrc="/cm/images/sample/btn_tbsearch02.png" inputType="image" style="height:28px" id="img_detls"
					value="" displayMode="label">
				</w2:column>
				<w2:column width="300" inputType="text" style="height:28px;" id="mngmt_detls_nm" class="le" displayMode="label"
					readOnly="true">
				</w2:column>
				<w2:column width="70" inputType="text" style="height:28px" id="essen_ex" value="" displayMode="label" readOnly="true"></w2:column>
			</w2:row>
		</w2:gBody>
	</w2:gridView></xf:group></xf:group>
    		</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class=" btn pro " id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick" disabled="true">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
