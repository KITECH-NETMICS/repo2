<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="소액물품검수신청">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            	<w2:dataList baseNode="list" repeatNode="map" id="dlt_item" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="check_no" name="검수번호" dataType="text"></w2:column>
            			<w2:column id="check_odr" name="순번" dataType="text"></w2:column>
            			<w2:column id="item_clsf" name="물품분류" dataType="text"></w2:column>
            			<w2:column id="item_nm" name="물품명" dataType="text"></w2:column>
            			<w2:column id="item_unit" name="물품단위" dataType="text"></w2:column>
            			<w2:column id="item_unit_price" name="단가" dataType="text"></w2:column>
            			<w2:column id="item_qty" name="수량" dataType="text"></w2:column>
            			<w2:column id="item_amt" name="금액" dataType="text"></w2:column>
            			<w2:column id="tax_amt" name="부가세" dataType="text"></w2:column>
            			<w2:column id="totl_amt" name="총액" dataType="text"></w2:column>
            			<w2:column id="item_unit_nm" name="물품단위명" dataType="text"></w2:column>
            			<w2:column id="chk" name="선택" dataType="text"></w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataMap baseNode="map" id="dma_mast">
            		<w2:keyInfo>
            			<w2:key id="check_no" name="검수번호" dataType="text"></w2:key>
            			<w2:key id="check_psn" name="검사자" dataType="text"></w2:key>
            			<w2:key id="check_empno" name="검사자개인번호" dataType="text"></w2:key>
            			<w2:key id="check_nm" name="검사자성명" dataType="text"></w2:key>
            			<w2:key id="check_dept" name="검사자부서" dataType="text"></w2:key>
            			<w2:key id="check_dept_new_ymd" name="검사자부서신설일자" dataType="text"></w2:key>
            			<w2:key id="check_dept_nm" name="검사자부서명" dataType="text"></w2:key>
            			<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
            			<w2:key id="accnt_no_nm" name="계정명" dataType="text"></w2:key>
            			<w2:key id="accnt_cd" name="회계코드" dataType="text"></w2:key>
            			<w2:key id="accnt_cd_abbr" name="회계코드명" dataType="text"></w2:key>
            			<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
            			<w2:key id="expns_cd_nm" name="비용코드명" dataType="text"></w2:key>
            			<w2:key id="entsch_check_psn" name="입회검수자" dataType="text"></w2:key>
            			<w2:key id="entsch_psn_empno" name="입회검수자개인번호" dataType="text"></w2:key>
            			<w2:key id="entsch_psn_nm" name="입회검수자성명" dataType="text"></w2:key>
            			<w2:key id="entsch_check_ymd" name="입회검수일자" dataType="text"></w2:key>
            			<w2:key id="entsch_check_dept" name="입회검수자부서" dataType="text"></w2:key>
            			<w2:key id="entsch_check_dept_nm" name="입회검수자부서명" dataType="text"></w2:key>
            			<w2:key id="entsch_psn_posi_nm" name="입회검수자직책" dataType="text"></w2:key>
            			<w2:key id="entsch_check_dept_new_ymd" name="입회검수자부서신설일자" dataType="text"></w2:key>
            			<w2:key id="msds_yn" name="화학물질포함여부" dataType="text"></w2:key>
            			<w2:key id="rad_yn" name="방사선장비여부" dataType="text"></w2:key>
            			<w2:key id="rad_knd" name="방사선종류" dataType="text"></w2:key>
            			<w2:key id="equip_doc_yn" name="기술장비/컴퓨터관련여부" dataType="text"></w2:key>
            			<w2:key id="equip_yn" name="기술장비등록여부" dataType="text"></w2:key>
            			<w2:key id="equip_odr" name="연구기자재순번" dataType="text"></w2:key>
            			<w2:key id="aset_reg" name="자산등재대상여부" dataType="text"></w2:key>
            			<w2:key id="ntis_reg_no" name="ZEUS등록번호" dataType="text"></w2:key>
            			<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
            			<w2:key id="unslip_odr" name="결의순번" dataType="text"></w2:key>
            			<w2:key id="vend_nm" name="거래처" dataType="text"></w2:key>
            			<w2:key id="chrg_amt" name="공급가액" dataType="text"></w2:key>
            			<w2:key id="tax_amt" name="부가세" dataType="text"></w2:key>
            			<w2:key id="check_amt" name="취득금액" dataType="text"></w2:key>
            			<w2:key id="check_ymd" name="검수일자" dataType="text"></w2:key>
            			<w2:key id="delvr_ymd" name="납품일자" dataType="text"></w2:key>
            			<w2:key id="card_no" name="카드번호" dataType="text"></w2:key>
    					<w2:key id="apprvl_no" name="승인번호" dataType="text"></w2:key>
    					<w2:key id="use_ymd" name="승인일시" dataType="text"></w2:key>
    					<w2:key id="card_use_ex" name="카드사용구분" dataType="text"></w2:key>
    					<w2:key id="fomat_unit" name="편성단위" dataType="text"></w2:key>
    					<w2:key id="issu_ymd" name="작성일자" dataType="text"></w2:key>
    					<w2:key id="card_clsf" name="카드구분" dataType="text"></w2:key>
    					<w2:key id="card_knd" name="카드종류" dataType="text"></w2:key>
    					<w2:key id="bill_no" name="계산서번호" dataType="text"></w2:key>
    					<w2:key id="evid_chrg_amt" name="공급가액(증빙)" dataType="text"></w2:key>
    					<w2:key id="evid_tax_amt" name="세액(증빙)" dataType="text"></w2:key>
    					<w2:key id="etc_pay_info" name="기타(결제)정보" dataType="text"></w2:key>
            			<w2:key id="accnt_rspns" name="계정책임자" dataType="text"></w2:key>
            			<w2:key id="accnt_rspns_nm" name="계정책임자명" dataType="text"></w2:key>
            			<w2:key id="mngmt_clsf" name="관리구분" dataType="text"></w2:key>
            			<w2:key id="start_ymd" name="계정시작일자" dataType="text"></w2:key>
            			<w2:key id="cls_ymd" name="계정종료일자" dataType="text"></w2:key>
            			<w2:key id="tax_cd" name="과세코드" dataType="text"></w2:key>
            			<w2:key id="tax_nm" name="과세여부" dataType="text"></w2:key>
            			<w2:key id="pay_clsf" name="구분" dataType="text"></w2:key>
            			<w2:key id="rmk" name="적요" dataType="text"></w2:key>
            			<w2:key id="attach_photo_file" name="사진첨부파일번호" dataType="text"></w2:key>
            			<w2:key id="attach_file_no" name="첨부파일번호" dataType="text"></w2:key>
            			<w2:key id="photo_attach_file_no" name="사진첨부파일" dataType="text"></w2:key>
            			<w2:key id="etc_attach_file_no" name="기타(결제)첨부파일" dataType="text"></w2:key>
            			<w2:key id="safe_req_no" name="사전안전성검토 신청번호" dataType="text"></w2:key>
            			<w2:key id="inspect_psn" name="검사(결재)자" dataType="text"></w2:key>
            			<w2:key id="inspect_psn_nm" name="검사(결재)자명" dataType="text"></w2:key>
            			<w2:key id="inspect_dept" name="검사(결재)자 부서" dataType="text"></w2:key>
            			<w2:key id="inspect_dept_nm" name="검사(결재)자 부서명" dataType="text"></w2:key>
            			<w2:key id="inspect_posi_nm" name="검사(결재)자 직책" dataType="text"></w2:key>
            			<w2:key id="inspect_dept_new_ymd" name="검사(결재)자 부서신설일자" dataType="text"></w2:key>
            			<w2:key id="inspect_ymd" name="검사(결재)일자" dataType="text"></w2:key>
            			<w2:key id="instl_posi_region_cd" name="설치지역" dataType="text"></w2:key>
            			<w2:key id="instl_posi_build_cd" name="설치건물" dataType="text"></w2:key>
            			<w2:key id="instl_posi_floor_cd" name="설치층" dataType="text"></w2:key>
            			<w2:key id="instl_posi_editno" name="설치호수" dataType="text"></w2:key>
            			<w2:key id="req_no" name="통제내역신청번호" dataType="text"></w2:key>
            			<w2:key id="req_seq" name="통제내역신청순번" dataType="text"></w2:key>
            			<w2:key id="apr_state" name="검수상태" dataType="text"></w2:key>
            			<w2:key id="unslip_apr_state" name="결의상태" dataType="text"></w2:key>
            			<w2:key id="rowStatus" name="입력상태" dataType="text"></w2:key>
            			<w2:key id="validAttachNo" name="첨부파일" dataType="text"></w2:key>
            			<w2:key id="approval" name="결재신청여부" dataType="text"></w2:key>
            			<w2:key id="msg" name="메세지" dataType="text"></w2:key>
            			<w2:key id="res_man" name="연구부서담당자" dataType="text"></w2:key>
            			<w2:key id="fin_manager" name="결의생성 담당자" dataType="text"></w2:key>
            			<w2:key id="fin_manager_empno" name="결의생성 담당자 개인번호" dataType="text"></w2:key>
            			<w2:key id="fin_manager_nm" name="결의생성 담당자 성명" dataType="text"></w2:key>
            			<w2:key id="dept_res_psn" name="연구지원담당자" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_search">
            		<w2:keyInfo>
            			<w2:key id="check_no" name="검수번호" dataType="text"></w2:key>
            			<w2:key id="evid_mngmt_no" name="증빙관리번호" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            	<w2:dataMap baseNode="map" id="dma_apr" style="">
            		<w2:keyInfo>
            			<w2:key dataType="text" id="reqNo" name="신청번호"></w2:key>
            			<w2:key dataType="text" id="endpoint" name="결재자"></w2:key>
            			<w2:key dataType="text" id="comments" name="결재의견"></w2:key>
            			<w2:key id="aprState" name="결재상태" dataType="text"></w2:key>
            			<w2:key id="procDefAlias" name="별칭" dataType="text"></w2:key>
            		</w2:keyInfo>
            	</w2:dataMap>
            </w2:dataCollection>
            <w2:workflowCollection/>
            <!-- 소액물품 검수신청 내역조회 -->
        	<xf:submission id="sbm_selectData" ref="data:json,dma_search"
        		target='data:json,[{"id":"dma_mast","key":"mastVo"},{"id":"dlt_item","key":"itemList"}]'
        		action="SvcFINSPACHKR02.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 소액물품 검수신청 저장 -->
        	<xf:submission id="sbm_saveData" ref='data:json,[{"id":"dma_mast","key":"mastVo"},{"id":"dlt_item","key":"itemList"}]'
        		target='data:json,dma_search'
        		action="SvcFINSPACHKM01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 소액물품 검수신청 삭제 -->
        	<xf:submission id="sbm_deleteData" ref='data:json,dma_search'
        		target=''
        		action="SvcFINSPACHKD01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 소액검수신청 담당자 반려 -->
			<xf:submission id="sbm_sendAprReject" ref='data:json,dma_apr' 
				target='' action="/SvcCCSCOMM03.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>	
        	<!-- 소액물품 검수신청 담당자저장 -->
        	<xf:submission id="sbm_postSave" ref='data:json,dma_mast' target=''
        		action="SvcFINSPACHKU02.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 소액물품 연구지원담당자 조회 -->
        	<xf:submission id="sbm_selectFinManager" ref='data:json,dma_mast'
        		target='data:json,dma_mast'
        		action="SvcFINSPACHKR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        </xf:model>
        <script src="/cm/js/biz/fin.js" cache="false" />
        <script type="text/javascript" lazy="false"><![CDATA[
    /****************************************************
 	 * 화면 설명 : 소액물품 검수신청
 	 * 변경 이력 : 2023-02-27	이영희	최초 작성
 	 * 서비스아이디 : F428
 	 ****************************************************/  
 	// 전자증빙
	scwin.evidParam = {
		doc_id : "F27"
	};
	
	scwin.data={
		typeCode : "F428",
		asetExpns : "141,142,143,144,145,146,147,148,149", // 자산등재대상 비용코드
		equipExpns : "141,142", // 연구기자재
		purExpns : "141,144,145,146,147", // 100만원이상 구매에서 신청
		allowExtension : "jpg,pptx,tiff,jpeg,hwp,bmp,gif,mht,pdf,doc,rtf,tif,ppt,html,docx,txt,png",
		today : com.getServerDateTime(),
		saveFlag : false
	};
	
	scwin.accntRspns = {}; // 계정책임자
	
    /*
     * 페이지 열기
     */         
	scwin.onpageload = function() {
		// 초기화
		com.file.init();
		grp_photo_view.hide();
		btn_retn.hide(); // 반려버튼
		btn_postSave.hide();
		spn_msg.hide();
		grp_card.hide();
		
		// 기간 체크
		com.checkPeriod(ica_delvr_ymd, ica_check_ymd);
		
		// 변경사항 체크
		scwin.checkList = [dma_mast, wfm_evid.getWindow(0).dlt_attach];
		
		// enterkey event
		com.setEnterKeyEvent(grp_accntNo, scwin.btn_accnt_no_onclick);
		com.setEnterKeyEvent(grp_accntRspns, scwin.btn_accnt_rspns_onclick);
		com.setEnterKeyEvent(grp_expns, scwin.btn_expns_cd_onclick);
		com.setEnterKeyEvent(grp_entschPsn, scwin.btn_entsch_psn_onclick);
		com.setEnterKeyEvent(grp_fin_manager, scwin.btn_slip_charger_onclick);
		
		// 안전보건 담당자 조회
		var data={
			roleType : "safe_manager",
			syspayno : com.getLoginInfo("sn")
		};
		if(data.syspayno.substring(0, 4) != "9999"){
			com.biz.getDeptManager(data, function(retData){
				scwin.data.safe_empno = retData.empno;
			});
		}	
		
		// 공통코드
		var codeOptions = [ { code : "FEC", compID :"grd_item:item_clsf" } // 물품구분
		                   ,{ code : "PFA", compID :"grd_item:item_unit" } // 물품단위
		                   ,{ code : "HBX", compID :"sbx_posi_region" } // 설치지역
		                ];
		com.setCmnCd(codeOptions, function() {
			var param = com.getParameter();
			if(param.param4 == "apr"){
				dma_search.set("check_no", param.req_no);	
			}else{
				dma_search.set("check_no", param.check_no);	
			}
			
			if(dma_search.get("check_no") == ""){
				scwin.init();
			}else{
				scwin.search();	
			}			
		});
	};
	
	scwin.onpageunload = function() {
		
	};
	
	scwin.init = function(){
		var session = com.getLoginInfo();
		dma_mast.set("check_dept_nm", session.deptName);
		dma_mast.set("check_dept", session.deptCode);
		dma_mast.set("check_dept_new_ymd", session.deptNewYmd);
		dma_mast.set("check_psn", session.sn);
		dma_mast.set("check_empno", session.empno);
		dma_mast.set("check_nm", session.cn);
		dma_mast.set("rowStatus", "C");		
		
		dma_mast.set("fin_manager", dma_mast.get("check_psn"));
		dma_mast.set("fin_manager_empno", dma_mast.get("check_empno"));
		dma_mast.set("fin_manager_nm", dma_mast.get("check_nm"));
		
		// 첨부파일
		var objs = [
			{uploadId:upload_A.getID(), fileKey : scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension}, // 첨부파일
			{uploadId:upload_B.getID(), fileKey : scwin.data.typeCode, mode: 'edit', allowExtension : scwin.data.allowExtension}, // 사진첨부
			{uploadId:upload_C.getID(), fileKey : scwin.data.typeCode, mode: 'edit', excludeEvid : true}, // 기타(결제)첨부파일	
		];
		com.file.createMulti(objs, objs.shift(), function() {
		});	
		
		dlt_item.insertRow(0);
	};
	
	/*
     * 조회
     */ 
	scwin.search = function(){
		com.execute(sbm_selectData, {
			successCallback : function(e){
				if(dma_mast.get("instl_posi_region_cd") != ""){
					var codeOptions = [ { code : "APA", compID :"sbx_instl_posi_build", filter : "mngmtItem1 == '" + dma_mast.get("instl_posi_region_cd") + "'"}
			                         ];		
					com.setCmnCd(codeOptions, function(){
						sbx_instl_posi_build.setValue(dma_mast.get("instl_posi_build_cd"));
						scwin.setPosiFloor(ldt_cmnCd_APA_0.getMatchedJSON("comCd", dma_mast.get("instl_posi_build_cd"), true)[0]);
						sbx_instl_posi_floor.setSelectedIndex(dma_mast.get("instl_posi_floor_cd"));	
					});	
				}
				
				if(dma_mast.get("card_no").trim() != ""){
					sbx_evid_clsf.setValue("Card");	
				}else{
					sbx_evid_clsf.setValue("Bill");	
				}
				
				ibx_accnt_rspns_empno.setValue(dma_mast.get("accnt_rspns").substring(2, 8));
				if(dma_mast.get("dept_res_psn") != dma_mast.get("fin_manager")){
					rdo_slip_charg.setValue("D");
				}
				// 계정번호 구분
				if(dma_mast.get("req_no") != ""){
					rdo_ctrl_yn.setValue("Y");	
				}
					
				// 첨부파일
				var vMode = (dma_mast.get("apr_state") >= "XAD020")? "view" : "edit";
				var attachFileNo_A = dma_mast.get("attach_file_no"); // 첨부파일
				var attachFileNo_B = dma_mast.get("attach_photo_file"); // 사진첨부
				var attachFileNo_C = dma_mast.get("etc_attach_file_no"); // 기타(결제)첨부파일
				var objs = [
					{uploadId:upload_A.getID(), fileKey : (attachFileNo_A == "")? scwin.data.typeCode : attachFileNo_A, mode: vMode, allowExtension : scwin.data.allowExtension}, // 첨부파일
					{uploadId:upload_B.getID(), fileKey : (attachFileNo_B == "")? scwin.data.typeCode : attachFileNo_B, mode: vMode, allowExtension : scwin.data.allowExtension}, // 사진첨부
					{uploadId:upload_C.getID(), fileKey : (attachFileNo_C == "")? scwin.data.typeCode : attachFileNo_C, mode: vMode, excludeEvid : true}, // 기타(결제)첨부파일 
				];
				com.file.createMulti(objs, objs.shift(), function() {
				});					
				
				// 버튼 제어
				scwin.setForm(dma_mast.get("apr_state"));
				
				// 그룹 제어
				if(dma_mast.get("apr_state") >= "XAD020") {
					grp_evid.setDisabled(true);
				}
				
				// 전자증빙 조회
				scwin.evidParam.req_no = dma_mast.get("check_no");
				scwin.searchEvid(dma_mast.get("expns_cd"));
				
				// 변경사항 초기화
				dma_mast.initRowStatus();
				//wfm_evid.getWindow(0).dlt_attach.modifyAllStatus("R");
			}
		});
	};
	
	/*
     * 화면 폼 셋팅
     */
	scwin.setForm = function(aprState){				
		com.biz.disabledButtons(aprState, dma_mast.get("check_no"));
		// 인쇄
		btn_print.setDisabled(false);
				
		if(aprState >= "XAD020"){
			btn_inspecPsn.setDisabled(true); // 검사(결재)자 검색버튼
			grp_chk_cont.setDisabled(true);
			
			// 계정책임자 부서 연구지원담당부서 아니면 반려버튼 hide
			var session = com.getLoginInfo();
			if(dma_mast.get("res_man").indexOf(session.sn) >= 0  && session.roleCode.indexOf("1001215") > 0){ // 1001215 내부인건비2부서담당자
				if(dma_mast.get("unslip_no").trim() == ""){
					btn_retn.show("");
				}
			}
			
			// 1004109 구매관리(관), 1015001 자산관리자, 1015117 자산관리시스템관리자
			if(/1015001|1015117|1004109/.test(session.roleCode) || dma_mast.get("entsch_check_psn") == session.sn){
				btn_postSave.show("");
				ica_delvr_ymd.setDisabled(false);
				ica_check_ymd.setDisabled(false);
				ica_entsch_check_ymd.setDisabled(false);		
			}
		}else{
			if(/281|282/.test(dma_mast.get("expns_cd"))){
				btn_inspecPsn.setDisabled(false);
			}
		}
		
		// 2019.02.19 증빙으로 사진첨부기능이 변경되어 기존에 존재 하지 않는 건은 사진업로드 숨김처리
		if(dma_mast.get("photo_attach_file_no") != "") grp_photo_view.show("");
		
		// 사전안전성 검토
		if(dma_mast.get("msds_yn") == "Y"){
			var flag = (dma_mast.get("apr_state") >= "XAD020")? true : false;
			btn_safeDodfpr.setDisabled(flag);
			btn_wrteSafe.setDisabled(flag);
		}
	};
	
	/*
     * 설치 층 셋팅
     */
	scwin.setPosiFloor = function(data){
		sbx_instl_posi_floor.removeAll();
		sbx_instl_posi_floor.addItem("","-선택-");
		
		var	mngmtNo1 = WebSquare.util.parseInt(data.mngmtNo1, 0);
		var	mngmtNo2 = WebSquare.util.parseInt(data.mngmtNo2, 0);
		var	mngmtNo3 = WebSquare.util.parseInt(data.mngmtNo3, 0);
		var	mngmtNo4 = WebSquare.util.parseInt(data.mngmtNo4, 0);
		var	mngmtNo5 = WebSquare.util.parseInt(data.mngmtNo5, 0);
		
		if(mngmtNo1 != 0){
			for(var i=mngmtNo1; i<= mngmtNo2; i++){
				sbx_instl_posi_floor.addItem(i+"F", "지상" + i + "층");
			}
		}
		
		if(mngmtNo3 != 0){
			for(var i=mngmtNo3; i<= mngmtNo4; i++){
				var	underFloor	=	i * -1;
				sbx_instl_posi_floor.addItem( "B" + underFloor, "지하" + underFloor + "층");
			}
		}
		
		if(mngmtNo5 == 1){
			sbx_instl_posi_floor.addItem("옥상","옥상");
		}
	};
	
	/*
     * 사용자 검색
     */
	scwin.getEmpInfo = function(clsf){
		var data={work_clsf : "HAG010"};
		if(clsf == "Entsch_Psn"){
			data.empno = ibx_entsch_psn_empno.getValue();
		}else if(clsf == "Inspect_Psn"){
			data.empno = dma_mast.get("accnt_rspns").substring(2,8);
		}else if(clsf == "Slip_Charger"){
			data.empno = ibx_fin_manager.getValue();
		}else{
			data.empno = ibx_accnt_rspns_empno.getValue();
		}		
		
		data.ref_yn = (data.empno == "")? "Y" : "N";
		
		com.pop.open(com.pop.TYPE.HUM, data, function(ret){
			if(clsf == "Entsch_Psn"){
				dma_mast.set("entsch_check_psn", ret.syspayno);
				dma_mast.set("entsch_psn_empno", ret.empno);
				dma_mast.set("entsch_psn_nm", ret.nm);
				dma_mast.set("entsch_check_dept", ret.dept_cd);
				dma_mast.set("entsch_check_dept_nm", ret.dept_nm);
				dma_mast.set("entsch_psn_posi_nm", ret.posi_nm);
				dma_mast.set("entsch_check_dept_new_ymd", ret.dept_new_ymd);					
							
			}else if(clsf == "Inspect_Psn"){
				dma_mast.set("inspect_psn", ret.syspayno);
				dma_mast.set("inspect_psn_empno", ret.empno);
				dma_mast.set("inspect_psn_nm", ret.nm);
				dma_mast.set("inspect_dept", ret.dept_cd);
				dma_mast.set("inspect_dept_nm", ret.dept_nm);
				dma_mast.set("inspect_posi_nm", ret.posi_nm);
				dma_mast.set("inspect_dept_new_ymd", ret.dept_new_ymd);			
					
			}else if(clsf == "Slip_Charger"){
				dma_mast.set("fin_manager", ret.syspayno);
				dma_mast.set("fin_manager_empno", ret.empno);
				dma_mast.set("fin_manager_nm", ret.nm);
			}else{
				dma_mast.set("accnt_rspns", ret.syspayno);
				dma_mast.set("accnt_rspns_nm", ret.nm);
				ibx_accnt_rspns_empno.setValue(ret.empno);
			}
		});
	};
	
	/*
     * 사용자 데이터 초기화
     */
	scwin.clearEmpInfo = function(clsf){
		if(clsf == "Inspect_Psn"){
			dma_mast.set("inspect_psn", "");
			dma_mast.set("inspect_psn_nm", "");
			dma_mast.set("inspect_dept", "");
			dma_mast.set("inspect_dept_nm", "");
			dma_mast.set("inspect_posi_nm", "");
			dma_mast.set("inspect_dept_new_ymd", "");		
			
		}else if(clsf == "Slip_Charger"){
			dma_mast.set("fin_manager", "");
			dma_mast.set("fin_manager_nm", "");
		}
	};
	
	/*
     * 계정번호 setting
     */ 
	scwin.setAccntNo = function(data){
		dma_mast.set("accnt_no", data.accnt_no);
		dma_mast.set("accnt_no_nm", data.accnt_no_nm);
		dma_mast.set("tax_cd", data.tax_cd);
		dma_mast.set("tax_nm", (data.tax_cd == "FTX001")?"과세" : "비과세");
		dma_mast.set("mngmt_clsf", data.mngmt_clsf);
		dma_mast.set("start_ymd", data.start_ymd);
		dma_mast.set("cls_ymd", data.cls_ymd);	
		
		if(data.accnt_no == "FF210001"){ // 계정책임자 직접 검색하여 입력
			btn_accnt_rspns.setDisabled(false);
			ibx_accnt_rspns_empno.setDisabled(false);
		}else{
			btn_accnt_rspns.setDisabled(true);
			ibx_accnt_rspns_empno.setDisabled(true);
			
			dma_mast.set("accnt_rspns", data.accnt_rspns);
			ibx_accnt_rspns_empno.setValue(data.accnt_rspns_empno);
			dma_mast.set("accnt_rspns_nm", data.accnt_rspns_nm);		
		}	
		
		// 연구장비통합관리비
		if(data.accnt_no.substring(0, 4) == "FF21"){
			btn_zeus.setDisabled(false);
			btn_zeus.trigger("click");
		}else{
			btn_zeus.setDisabled(true);
			ibx_ntis_reg_no.setValue("");
		}

		// 결의생성 담당자 자동세팅을 위한 연구지원담당자 조회
		if(data.dept_res_psn != "" && data.dept_res_psn != undefined){
			spn_msg.hide();
			rdo_slip_charg.setDisabled(false);
			com.pop.open(com.pop.TYPE.HUM, {empno : data.dept_res_psn.substring(2, 8)}, function(ret){
				dma_mast.set("fin_manager", ret.syspayno);
				dma_mast.set("fin_manager_empno", ret.empno);
				dma_mast.set("fin_manager_nm", ret.nm);
				
				rdo_slip_charg.setValue("A");
				ibx_fin_manager.setDisabled(true);
				btn_slip_charger.setDisabled(true);
			});
		}else{
			spn_msg.show("");
			dma_mast.set("fin_manager", dma_mast.get("check_psn"));
			dma_mast.set("fin_manager_empno", dma_mast.get("check_empno"));
			dma_mast.set("fin_manager_nm", dma_mast.get("check_nm"));
			
			rdo_slip_charg.setValue("D");
			rdo_slip_charg.setDisabled(true);
			ibx_fin_manager.setDisabled(false);
			btn_slip_charger.setDisabled(false);
		}
	};
	
	/*
     * 계정번호 검색(일반)
     */ 
	scwin.getAccntNo = function(data){
		com.pop.open(com.pop.TYPE.ACNNO, data, function(ret){
			if(!/RAK041|RAK061/.test(ret.accnt_state)){
				com.alert(com.getMsg("message.alert.fin.com.0008", ret.accnt_no, "소액물품작성"));
				return;
			}
			
			if (ibx_accnt_no.getValue().substring(0, 4) != "FF21" && ica_check_ymd.getValue() > ret.cls_ymd) {
				alert("종료일자가 지난 계정이므로 사용할 수 없습니다.");
				return;
			}
						
			// 계정정보 셋팅
			scwin.setAccntNo(ret);
			
			dma_mast.set("accnt_cd", "");
			dma_mast.set("accnt_cd_abbr", "");
			dma_mast.set("expns_cd", "");
			dma_mast.set("expns_cd_nm", "");
		});
	};
	
	/*
     * 계정번호 검색(통제)
     */
	scwin.getCtrlAccntNo = function(data){
		data.journ_cd = "Fn0120";
		biz.fin.pop.open( biz.fin.pop.TYPE.CTRL, data, function(ret){
			// 계정정보 셋팅
			scwin.setAccntNo(ret);
			
			dma_mast.set("accnt_cd", ret.accnt_cd);
			dma_mast.set("accnt_cd_abbr", ret.accnt_cd_nm);
			dma_mast.set("expns_cd", ret.expns_cd);
			dma_mast.set("expns_cd_nm", ret.expns_cd_nm);
			dma_mast.set("req_no", ret.req_no);
			dma_mast.set("req_seq", ret.req_seq);
		});
	};
	
	/*
     * 전자증빙 조회
     */
	scwin.searchEvid = function(expnsCd){
		if(/322|262|431/.test(expnsCd) && ibx_accnt_no.getValue().substring(0, 4) == "FF21"){
			if(ibx_accnt_no.getValue() == "FF210001"){
				scwin.evidParam.expns_cd = "FF1";
			}else{
				scwin.evidParam.expns_cd = "FF2";
			}
		}else{
			scwin.evidParam.expns_cd = expnsCd;
		}
	
		wfm_evid.getWindow(0).scwin.evid_select(scwin.evidParam);
	};
	
	/*
     * 검수금액 재계산
     */
	scwin.calCheckAmt = function(){
		var itemAmtSum = 0;
		var taxAmtSum = 0;

		for (var i = 0; i < dlt_item.getRowCount(); i++) {
			itemAmtSum += Number(dlt_item.getCellData(i, "item_amt"));
			taxAmtSum += Number(dlt_item.getCellData(i, "tax_amt"));
		}

		dma_mast.set("chrg_amt", itemAmtSum); // 공급가액
		dma_mast.set("tax_amt", taxAmtSum); // 부가세
		dma_mast.set("check_amt", itemAmtSum + taxAmtSum); // 검수금액
	};
	
	/*
     * 파일 다운로드
     */
	scwin.downFileinfo = function downFileinfo(file_nm,file_no){
		var url = "/SvcAttachDown.do?fileName=web_folder/bizdoc/fin/"+file_no+"&realName="+encodeURIComponent(file_nm)+"&bizKind=OLD";		
		window.open(url, '_blank').focus();
	};
	
	/*
     * 구매계약에서 진행 여부 체크
     */
	scwin.checkPurReq = function(expnsCd, accntCd, totlAmt){
		if(scwin.data.purExpns.indexOf(expnsCd) >= 0 && totlAmt >= 1000000){
			alert("100만원 이상의 연구시설·장비 구매의 경우 구매장비관리실을 통하여 구매계약하여 주시기 바랍니다.");
			return false;
		}
		
		/* 2023.09.08 148 비용코드 코드 제거(임수연요청 : XC2202302203)
		if(expnsCd == "148"){
			if(/51125031|51120030|51120031|51105030|51120031|51145031/.test(accntCd) && totlAmt >= 1000000) {
				alert("100만원 이상의 연구시설·장비 구매의 경우 구매장비관리실을 통하여 구매계약하여 주시기 바랍니다.");
				return false;
			}
			
			if(/51125080|51120080|51145080|51105080/.test(accntCd) && totlAmt >= 3000000) {
				alert("300만원 이상의 연구시설·장비 구매의 경우 구매장비관리실을 통하여 구매계약하여 주시기 바랍니다.");
				return false;
			}
		}
		*/
		return true;
	};
	
	/*
     * 저장 전 체크
     */
	scwin.preSave = function(){
		var validData=[
			{dataObj : dma_mast
			   , valInfoArr :[
				    { id : "accnt_no", mandatory : true}
				   ,{ id : "accnt_cd", mandatory : true } 
				   ,{ id : "expns_cd", mandatory : true } 
				   ,{ id : "entsch_check_psn", mandatory : true } 
				   ,{ id : "entsch_check_dept", mandatory : true }
				   ,{ id : "check_dept", mandatory : true}
				   ,{ id : "msds_yn", mandatory : true}
				   ,{ id : "aset_reg", mandatory : true}
				   ,{ id : "delvr_ymd", mandatory : true}
				   ,{ id : "check_ymd", mandatory : true}
				   ,{ id : "fin_manager", mandatory : true}
				]
			  , isCheckModified : false
			},
			{dataObj : dlt_item
			  , valInfoArr :[
				    { id : "item_clsf", mandatory : true}
				   ,{ id : "item_nm", mandatory : true } 
				   ,{ id : "item_unit", mandatory : true} 
				   ,{ id : "item_qty", mandatory : true, allowChar : "0-9"} 				   
				   ,{ id : "item_unit_price", mandatory : true, allowChar : "0-9"} 				  
			    ]
			   , isCheckModified : false
			}
		];		
		
		if(rdo_rad_yn.getValue() == "Y"){
			validData[0].valInfoArr.push({ id : "rad_knd", valFunc : function(value){
					if(com.isEmpty(value)){
						return "message.xom.ui.fin.068"; // 방사선 장비가 해당인경우 RG/RI는 필수 입니다.
					}
				}
			});
		}
		
		if(dma_mast.get("accnt_no").substring(0, 4) == "FF21"){
			validData[0].valInfoArr.push({ id : "ntis_reg_no", mandatory : true}); // zeus장비번호 필수 체크
			
			if(dma_mast.get("accnt_no") == "FF210001"){
				validData[0].valInfoArr.push({ id : "accnt_rspns", mandatory : true}); // 계정책임자 필수 체크
			}
		}
		
		if(!com.validateData(validData)) return false;			
		
		var totlAmt = com.parseInt(grd_item.getFooterData("totl_amt_sum"));
		
		if(com.parseInt(dma_mast.get("check_amt")) != totlAmt){
			alert("검수금액합계와 검수대상금액의 총액이 일치하지 않습니다.");
			return false;
		}
		
		// 구매계약여부 체크
		if(!scwin.checkPurReq(dma_mast.get("expns_cd"), dma_mast.get("accnt_cd"), totlAmt)) return false;			
		
		// 인쇄비(281), 복사비(282)인 경우, 300만원이 넘는지 확인
		if(/281|282/.test(dma_mast.get("expns_cd")) && totlAmt >= 3000000){
			if(dma_mast.get("inspect_psn_psn") == ""){
				alert("비용코드 281, 282인 경우 검수(결재)자를 확인하셔야 합니다.");
				return false;
			}
		}else{
			dma_mast.set("inspect_psn_nm", "");
			dma_mast.set("inspect_psn", "");
			dma_mast.set("inspect_dept", "");
			dma_mast.set("inspect_dept_nm", "");
			dma_mast.set("inspect_dept_new_ymd", "");
			dma_mast.set("inspect_posi_nm", "");
		}	
		
		if(dma_mast.get("accnt_no").substring(0, 4) == "FF21"){
			if(!/322|262|431/.test(ibx_expns_cd.getValue())){
				alert("비용코드를 확인하세요.");
				return false;
			}
		}
		
		if(dma_mast.get("aset_reg") == "Y"){
			if(scwin.data.asetExpns.indexOf(dma_mast.get("expns_cd")) < 0){
				if (!confirm(dma_mast.get("expns_cd") + " 비용코드는 자산등재대상이 아닙니다. \n계속 진행하시겠습니까?")) {
					rdo_aset_reg.focus();
					return false;
				}
			}			
		}
		if(scwin.data.asetExpns.indexOf(dma_mast.get("expns_cd")) >= 0 && dma_mast.get("aset_reg") == "N"){
			alert("비용코드가 " + scwin.data.asetExpns + "일경우 자산등재는 필수 입니다");
			rdo_aset_reg.focus();
			return false;
		}
		
		// 납품일자 <= 검사일자
		if (ica_delvr_ymd.getValue() > ica_check_ymd.getValue()) {
			com.alert(com.getMsg("message.xom.ui.fin.010", "납품일", "검사일"));
			return false;
		}
		
		// 검사일자 <= 작성일자
		if (ica_check_ymd.getValue() > scwin.data.today) {
			com.alert(com.getMsg("message.xom.ui.fin.010", "검사일", "작성일"));
			return false;
		}
		
		if (/141/.test(ibx_expns_cd.getValue())) { // 2023.09.08 148 비용코드 코드 제거(임수연요청 : XC2202302203)
			if (rdo_equip_doc_yn.getValue() != "Y") {
				alert("비용코드 141 일경우 컴퓨터 기술장비는 해당이어야 합니다");
				return false;
			}
		}

		if (com.getLoginInfo("sn") == dma_mast.get("entsch_check_psn")) {
			alert("검사자와 검수자는 동일인 일수 없습니다 ");
			return false;
		}

		// 전자증빙 필수값 체크
		if (!wfm_evid.getWindow().scwin.evid_preSave()) return false;
		
		// 검수대상 품목 명에 ASCII 범위 외의 문자 대체
		var itemCnt = grd_item.getRowCount();

		for (var i = 0; i < itemCnt; i++) {
			var itemNm = grd_item.getCellData(i, "item_nm").trim();
			var invalidAscii = scwin.regexAscii(itemNm);
			
			if (invalidAscii != "") {
//				alert("검수대상 내 항목 중 " + (i+1) + "번째 줄의 품명에 사용할 수 없는 특수문자를 포함하고 있어 아래의 문자열로 대체됩니다.\n" + invalidAscii);
				dlt_item.setCellData(i, "item_nm", invalidAscii);
			} else {
				alert("검수대상 내 항목 중 " + (i+1) + "번째 줄의 품명은 허용되지 않는 문자입니다.\n" + invalidAscii);
				return false;
			}
		}
		
		return true;
	};
	
	/*
     * ASCII 범위 외의 문자 포함 여부 체크 정규식(true : 포함, false : 미포함)
     */
    scwin.regexAscii = function(chkStr) {
    	var regex = /[^\x20-\x7E\uAC00-\uD7A3\u1100-\u11FF\u1160-\u11A2]/g;
		
		if (regex.test(chkStr)) {
			return chkStr.replace(regex, "");
		} else {
			return chkStr;
		}
	};
	
	/*
     * 정의한 특수문자, 영어, 한글, 숫자를 제외한 문자 체크 정규식
     */ 
	scwin.regexCharacters = function(chkStr) {
		var regex = /[-\/~!@#$%^&*_+|=|<>?:;`{},.\]\[\'\"\(\)\\\'\·\・a-zA-Z가-힣0-9\u3131-\u314E\u314F-\u3163]/gi;
		var matchedCharacters = chkStr.match(regex);
		
		if (matchedCharacters != null && matchedCharacters != "") {
			return chkStr.split('').filter(char => !matchedAscii.includes(char)).join('').trim();
		} else {
			return chkStr;
		}
	};
	
	/*
     * 결재전 체크
     */ 
	scwin.preAprSave = async function(){
		var validData =[];
		if(rdo_msds_yn.getValue() == "Y"){
			validData.push({ id : "safe_req_no", mandatory : true});
			
			if (!com.validateData(dma_mast,validData, false)) return false;
		}
		
		if(dma_mast.get("mngmt_clsf") == "R" && scwin.data.equipExpns.indexOf(dma_mast.get("expns_cd")) >= 0 && dma_mast.get("equip_odr") == ""){
			alert("연구 계정이면서 비용코드가 " + scwin.data.equipExpns + " 일경우 연구기자재/시작품 입력은 필수 입니다");
			return false;
		}
		
		// 사진 첨부 체크
		if(com.file.action.getTotalFileCount(upload_B.getID()) < 1){
			if(dma_mast.get("aset_reg") == "Y"){
				alert("자산등재가 '예' 일경우 사진첨부는 필수 입니다");
				return false;
			}
			
			if (/141|142|146|148|221|223/.test(dma_mast.get("expns_cd")) && Number(grd_item.getFooterData('totl_amt_sum')) > 500000) {
				alert("비용코드 141,142,146,148,221,223 및 총금액 50만원 이상일경우 사진첨부는 필수 입력사항입니다.");
				return false;
			}
		}
		
		if (/141/.test(ibx_expns_cd.getValue())) { // 2023.09.08 148 비용코드 코드 제거(임수연요청 : XC2202302203)
			if (rdo_equip_doc_yn.getValue() == "Y" && dma_mast.get("equip_yn") == "N") {
				alert("컴퓨터 기술장비가 해당일경우는 컴퓨터 기술장비를 반드시 등록 하여야 합니다");
				btn_techReg.trigger("click");
				return false;
			}
		}
		
		// 지급내역 필수 값 해제 2023.11.02 이윤민 요청
		if(dma_mast.get("card_no").trim() == "" && dma_mast.get("bill_no").trim() == ""){
			let conRet = await com.confirm("지급내역(결제정보)이 누락되었습니다. 진행하시겠습니까?");
			if (conRet == false) return conRet;
		}
		
		return true;
	};
	
	/*
     * 저장
     */ 
	scwin.save = function(){
		com.file.transport( function(attachObj){			
			dma_mast.set("attach_file_no", attachObj.upload_A);
			dma_mast.set("attach_photo_file", attachObj.upload_B);
			dma_mast.set("etc_attach_file_no", attachObj.upload_C);
			var attaches =[];
			if(dma_mast.get("attach_file_no") != "") attaches.push(attachObj.upload_A);
			if(dma_mast.get("attach_photo_file") != "") attaches.push(attachObj.upload_B);
			if(dma_mast.get("etc_attach_file_no") != "") attaches.push(attachObj.upload_C);
			
			dma_mast.set("validAttachNo", attaches.join(","));
			
			dma_mast.set("instl_posi_build_cd", sbx_instl_posi_build.getValue());
			dma_mast.set("instl_posi_floor_cd", sbx_instl_posi_floor.getValue());
			
			com.execute(sbm_saveData, {
				successCallback : function(e) { // 성공 콜백
					scwin.data.saveFlag = true;
					
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
						scwin.evidParam.req_no = dma_search.get("check_no");
						scwin.evidParam.evid_mngmt_no = dma_search.get("evid_mngmt_no");
												
						// 자동증빙 저장
						wfm_evid.getWindow(0).scwin.updateEvid(scwin.evidParam);	
						
						if(scwin.data.isApproval){						
							com.movePageMenu("A001", { "reqNo" : dma_mast.get("check_no")});
						}else{
							// 조회
							scwin.search();
						}
					});					
				}
			});
		});
	};
	
	/*
     * 저장 호출
     */
	scwin.callSave = function(){
		// 예실체크
		var data ={bugt_yr: scwin.data.today.substring(0, 4)
		          , accnt_no: dma_mast.get("accnt_no")
		          , accnt_cd : dma_mast.get("accnt_cd")
		          , relat_no : dma_mast.get("accnt_rspns").substring(2, 8)
		};
		com.biz.gfnBugtEtcChk(data, function(retObj){
			if(retObj.bugt_amt < 0){
				com.alert("message.xom.ui.fin.022");
			}else if(retObj.bugt_amt >= 0){		
				scwin.save();
			}
		});		
	};
	
	//--------------------------------------------------------------- event -----------------------------//
	/*
     * 사전안전성 검토 검색버튼 클릭 이벤트
     */ 
	scwin.btn_safeDodfpr_onclick = function(e) {
		var data={
			req_no : ibx_safeReqNo.getValue(),
			ref_yn : "Y"
		};
		com.pop.open(com.pop.TYPE.PRE_SAFE, data, function(ret) {
			ibx_safeReqNo.setValue(ret.req_no);
		});
	};
	
	/*
     * 사전안전성 검토 작성버튼 클릭 이벤트
     */
	scwin.btn_wrteSafe_onclick = function(e) {
		var safeReqNo = dma_mast.get("safe_req_no");
		com.biz.openPopupByNative( '/filter/index.jsp?serviceid=D306&openerId=F428&req_no='+safeReqNo, '사전안정성검토등록', {width: 870, height: 870}, 'BIZ2');
	};
	
	/*
     * 사전안전성검토 작성 팝업 callback
     */
	scwin.setSafeReqNo = function(data){
		dma_mast.set("safe_req_no", data.req_no);
	};
	
	/*
     * 사진보기 버튼 클릭 이벤트
     */
	scwin.btn_photo_view_onclick = function(e) {
		var photoUrl = "/bizimages/pur/attach/" + dma_mast.get("photo_attach_file_no");
		window.open(photoUrl, "", "width=1024, height=768, toolbar=no, menubar=no, resizable=yes, titlebar=yes");
	};
	
	/*
     * 설치위치 지역 변경 이벤트
     */
	scwin.sbx_posi_region_onviewchange = function(info) {
		$p.data.remove("ldt_cmnCd_APA_0");
		var posiRegion = "";
		if(info == undefined){
			posiRegion = this.getValue();
		}else{
			posiRegion = info.newValue;
		}
		var codeOptions = [ { code : "APA", compID :"sbx_instl_posi_build", filter : "mngmtItem1 == '" + posiRegion + "'"}];		
		com.setCmnCd(codeOptions, function(){
			sbx_instl_posi_build.setValue("");
		});	
	};
	
	/*
     * 설치위치 건물 변경 이벤트
     */
	scwin.sbx_instl_posi_build_onviewchange = function(info) {
		if(info.newValue != ""){
			scwin.setPosiFloor(ldt_cmnCd_APA_0.getMatchedJSON("comCd", info.newValue, true)[0]);
			sbx_instl_posi_floor.setSelectedIndex(dma_mast.get("instl_posi_floor_cd"));
		}
	};
	
	/*
     * 기술장비/컴퓨터관련 변경 이벤트
     */
	scwin.rdo_equip_doc_yn_onchange = function(info) {
		if(this.getValue() == "Y" && dma_mast.get("check_no") != ""){
			btn_techReg.setDisabled(false);
		}else{
			btn_techReg.setDisabled(true);
		}
	};
	
	/*
     * 화학물질 포함여부 변경 이벤트
     */
	scwin.rdo_msds_yn_onviewchange = function(info) {
		if(info.value == "Y"){
			btn_safeDodfpr.setDisabled(false);
			btn_wrteSafe.setDisabled(false);
			
			if(confirm("안전보건 담당자로 자동 세팅하시겠습니까?")){
				ibx_entsch_psn_empno.setValue(scwin.data.safe_empno);
				
				scwin.getEmpInfo("Entsch_Psn");
				ibx_entsch_psn_empno.setDisabled(true);
				btn_entsch_psn.setDisabled(true);
			}
		}else{
			btn_safeDodfpr.setDisabled(true);
			btn_wrteSafe.setDisabled(true);
			
			ibx_safeReqNo.setValue("");
			//안전보건담당자 자동세팅 원복
			dma_mast.set("entsch_check_psn", "");
			dma_mast.set("entsch_psn_empno", "");
			dma_mast.set("entsch_psn_nm", "");
			dma_mast.set("entsch_check_dept", "");
			dma_mast.set("entsch_check_dept_nm", "");
			dma_mast.set("entsch_psn_posi_nm", "");
			
			ibx_entsch_psn_empno.setDisabled(false);
			btn_entsch_psn.setDisabled(false);
		}
	};
	
	/*
     * 검수(입회)자 검색 버튼 클릭 이벤트
     */
	scwin.btn_entsch_psn_onclick = function(e) {
		scwin.getEmpInfo("Entsch_Psn");
	};
	
	/*
     * 방사선장비 여부 변경 이벤트
     */
	scwin.rdo_rad_yn_onchange = function(info) {
		if(this.getValue() == "Y"){
			rdo_rad_knd.setDisabled(false);
		}else{
			rdo_rad_knd.setDisabled(true);
			rdo_rad_knd.setValue("");
		}
	};
	
	/*
     * 기술장비/컴퓨터관련등록 버튼 클릭 이벤트
     */
	scwin.btn_techReg_onclick = function(e) {
		if(dma_mast.get("check_no") != ""){
			var url = "/filter/index.jsp?serviceid=P394&openerId=F428&checkup_req_no=" + dma_mast.get("check_no") + "&contrct_no=" + dma_mast.get("check_no") + "&chng_seq=00";
			com.biz.openPopupByNative(url, '기술장비/컴퓨터관련등록', {width: 1020, height: 1020}, 'BIZ2');
		}else{
			alert("저장 후 입력바랍니다.");	
		}
	};
	
	/*
     * 제우스등록번호 검색 버튼 클릭 이벤트
     */
	scwin.btn_zeus_onclick = function(e) {
		com.pop.open(com.pop.TYPE.ZEUS, "", function(ret){
			ibx_ntis_reg_no.setValue(ret.ntis_reg_no);
		});
	};
	
	/*
     * 연구기자재/시작품 검색 버튼 클릭 이벤트
     */
	scwin.btn_equip_onclick = function(e) {
		var data={
			accnt_no : dma_mast.get("accnt_no"),
			ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.RES_EQUIP, data, function(ret){
			dma_mast.set("equip_odr", ret.equip_odr);
		});
	};
	
	/*
     * 자산등재대상 여부 변경 이벤트
     */
	scwin.rdo_aset_reg_onchange = function(info) {
		if(this.getValue() == "Y" && dma_mast.get("check_no") != ""){
			btn_techReg.setDisabled(false);
		}else{
			btn_techReg.setDisabled(true);
		}
	};
	
	/*
     * 대상항목 버튼 클릭 이벤트
     */
	scwin.btn_expnsItem_onclick = function(e) {
		com.pop.open(com.pop.TYPE.EXPNS_LIST,{ref_yn:"Y"}, function(ret){
		});
	};
	
	/*
     * 계정번호 검색 버튼 클릭 이벤트
     */
	scwin.btn_accnt_no_onclick = function(e) {
		var clsYr = ((ica_check_ymd.getValue() == "")? com.getServerDateTime(): ica_check_ymd.getValue()).substring(0,4);
		var data={
			accnt_no : ibx_accnt_no.getValue(),
			ref_yn : (ibx_accnt_no.getValue() == "")? "Y" : "N",
			cls_yr : clsYr
		};
		if(rdo_ctrl_yn.getValue() == "N"){
			scwin.getAccntNo(data);
		}else{
			scwin.getCtrlAccntNo(data);
		}
	};
	
	/*
     * 계정번호 구분 변경 이벤트
     */
	scwin.rdo_ctrl_yn_onchange = function(info) {
		if(this.getValue() == "Y"){
			btn_expns_cd.setDisabled(true);
			ibx_expns_cd.setDisabled(true);
		}else{
			btn_expns_cd.setDisabled(false);
			ibx_expns_cd.setDisabled(false);
		}
	};
	
	/*
     * 계정책임자 검색 버튼 클릭 이벤트
     */
	scwin.btn_accnt_rspns_onclick = function(e) {
		scwin.getEmpInfo("Accnt_Rspns");
	};
	
	/*
     * 계정번호 변경 이벤트
     */
	scwin.ibx_accnt_no_onviewchange = function(info) {
		if(ibx_accnt_no.getValue() == ""){
			dma_mast.set("accnt_no", "");
			dma_mast.set("accnt_no_nm", "");
			dma_mast.set("tax_nm", "");
			dma_mast.set("mngmt_clsf", "");
			dma_mast.set("start_ymd", "");
			dma_mast.set("cls_ymd", "");
			dma_mast.set("accnt_rspns", "");
			dma_mast.set("accnt_rspns_nm", "");
			
			dma_mast.set("accnt_cd", "");
			dma_mast.set("accnt_cd_abbr", "");
			dma_mast.set("expns_cd", "");
			dma_mast.set("expns_cd_nm", "");
			
			btn_zeus.setDisabled(true);
		}
	};
	
	/*
     * 계정책임자 변경 이벤트
     */
	scwin.ibx_accnt_rspns_empno_onviewchange = function(info) {
		if(ibx_accnt_rspns_empno.getValue() == ""){
			dma_mast.set("accnt_rspns", "");
			dma_mast.set("accnt_rspns_nm", "");
		}
	};
	
	/*
     * 비용코드 검색 버튼 클릭 이벤트
     */
	scwin.btn_expns_cd_onclick = function(e) {
		var data={
			accnt_no : ibx_accnt_no.getValue(),
			expns_cd : ibx_expns_cd.getValue(),
			ref_yn : (ibx_expns_cd.getValue() == "")? "Y" : "N"
		};
		
		com.pop.open(com.pop.TYPE.EXPNS, data, async function(ret){
			if(ibx_accnt_no.getValue().substring(0, 4) == "FF21"){
				if(biz.fin.CONST.EXPNS_RES_EQUIP.indexOf(ret.expns_cd) < 0){
					alert("연구장비통합계정일 경우 비용코드는 262,322,431 중에서 선택할 수 있습니다.");
					return;
				}
			}
			
			var strExpns = "";
			strExpns = scwin.data.purExpns;	// 2023.09.08 148 비용코드 코드 제거(임수연요청 : XC2202302203) 
			if(strExpns.indexOf(ret.expns_cd) >= 0) {
				alert("100만원 이상의 연구시설·장비 구매의 경우 구매장비관리실을 통하여 구매계약하여 주시기 바랍니다.");
			}			
				
			dma_mast.set("accnt_cd", ret.accnt_cd);
			dma_mast.set("accnt_cd_abbr", ret.accnt_cd_abbr);
			dma_mast.set("expns_cd", ret.expns_cd);
			dma_mast.set("expns_cd_nm", ret.expns_cd_nm);
			
			// 2019.03.11 자산등재 대상여부 예로 설정(박찬모 사무원 요청)
			if(scwin.data.asetExpns.indexOf(ret.expns_cd) >= 0){
				rdo_aset_reg.setValue("Y");
			}
			
			if(ret.expns_cd == "329"){
				biz.fin.pop.open(biz.fin.pop.TYPE.ASET_ITEM, {});
			}
			
			if(/141/.test(ret.expns_cd)){ // 2023.09.08 148 비용코드 코드 제거(임수연요청 : XC2202302203)
				rdo_equip_doc_yn.setValue("Y"); // 기술장비/컴퓨터관련
				btn_techReg.setDisabled(false);
			}
			
			// 연구기자재(20160314 비용코드 148추가 (연구관리 2016-1차 코칭 TF회의))
			// 2023.07.03 BG계정이면서 142 비용코드 사용할 경우 연구기자재 검증 제외(XC2202301922)
			const excpetAwaitChk = await com.isExceptAwait("XEK060", "F428", ibx_accnt_no.getValue().substring(0,2));
			if(scwin.data.equipExpns.indexOf(ret.expns_cd) >= 0 && !excpetAwaitChk){
				btn_equip.setDisabled(false);
				btn_equip.trigger("click");
			}else{
				btn_equip.setDisabled(true);
			}
			
			// 검사(결재)자 셋팅
			if(/281|282/.test(ret.expns_cd)){
				btn_inspecPsn.setDisabled(false);
				if(dma_mast.get("inspect_psn").trim() == ""){
					scwin.getEmpInfo("Inspect_Psn");
				}	
			}	
			
			// 전자증빙조회
			scwin.searchEvid(ret.expns_cd);
		});
	};
	
	/*
     * 검수대상 그리드 추가 버튼 클릭 이벤트
     */
	scwin.btn_plus_onclick = function(e) {
		com.addRow(grd_item);
	};
	
	/*
     * 검수대상 그리드 삭제버튼 클릭 이벤트
     */
	scwin.btn_minus_onclick = function(e) {
		var rows = grd_item.getCheckedIndex("chk");
		
		rows.reverse().forEach(function(row) {
			dlt_item.removeRow(row);
		});
		
		// 금액 재계산
		scwin.calCheckAmt();
	};
	
	/*
     * 저장 버튼 클릭 이벤트
     */
	scwin.btn_save_onclick = function(e) {		
		if(!scwin.preSave()) return;
		
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
			scwin.data.isApproval = false;
			
			if(ret) scwin.callSave();
		});			
	};	
	
	/*
     * 목록 버튼 클릭 이벤트
     */
	scwin.btn_list_onclick = function(e) {
		com.moveList("F427", scwin.data.saveFlag);
	};
	
	/*
     * 불러오기(최근설치지역) 버튼 클릭 이벤트
     */
	scwin.btn_instl_onclick = function(e) {
		biz.fin.pop.open(biz.fin.pop.TYPE.SMLITM_INSTL, {check_psn_nm:dma_mast.get("check_nm")}, function(ret) {
			// 설치위치(지역)
			sbx_posi_region.setValue(ret.instl_posi_region_cd);
			// 설치위치(건물)
			var codeOptions = [ { code : "APA", compID :"sbx_instl_posi_build", filter : "mngmtItem1 == '" + sbx_posi_region.getValue() + "'"}];		
			com.setCmnCd(codeOptions, function(){
				sbx_instl_posi_build.setValue(ret.instl_posi_build_cd);
			});	
			// 설치위치(층)
			scwin.setPosiFloor(ldt_cmnCd_APA_0.getMatchedJSON("comCd", ret.instl_posi_build_cd, true)[0]);
			sbx_instl_posi_floor.setSelectedIndex(ret.instl_posi_floor_cd);			
			// 설치위치(호수)
			dma_mast.set("instl_posi_editno", ret.instl_posi_editno);
		});
	};
	
	/*
     * 사진샘플 버튼 클릭 이벤트
     */
	scwin.btn_photo_sample_onclick = function(e) {
		var photoUrl = "/bizimages/pur/attach/spm_sample.jpg";
		window.open(photoUrl, "", "width=700, height=800, toolbar=no, menubar=no, resizable=yes, titlebar=yes");
	};
	
	/*
     * 용역완료양식 버튼 클릭 이벤트
     */
	scwin.btn_srvForm_onclick = function(e) {
		scwin.downFileinfo("(양식) 용역완료원&용역완료조서.hwp","10000001");
	};
	
	/*
     * 검수대상 업로드 양식 버튼 클릭 이벤트
     */
	scwin.btn_down_onclick = function(e) {
		scwin.downFileinfo("검수대상(양식).xlsx","10000005");
	};

	/*
     * 인쇄 버튼 클릭 이벤트
     */
	scwin.btn_print_onclick = function(e) {
		var node = "check_no="+ dma_mast.get("check_no");
		com.oz.openPopup({
			ozrCode : "P201",
			param: node
        });
	};
	
	/*
     * 검사일자 변경 이벤트
     */
	scwin.ica_check_ymd_onviewchange = function(info) {
		if(info.newValue > scwin.data.tody){
			com.alert(com.getMsg("message.xom.ui.fin.010", "검사일", "작성일"));
			return false;
		}
	};
	
	/*
     * 결재신청 버튼 클릭 이벤트
     */
	scwin.btn_apr_onclick = async function(e) {
		// 저장전 체크
		const isExcept = await scwin.preSave();
		if(!isExcept) return;
		// 결재전 체크
		if(await scwin.preAprSave() != true) return;
		
		var cnt = dlt_item.getRowCount();
		var rmk = dlt_item.getCellData(0, "item_nm") + ((cnt > 1)? "외" + (cnt-1) + "건" : "");
		dma_mast.set("rmk", rmk);
		
		var diff = com.diffDate(scwin.data.today, dma_mast.get("cls_ymd"));
		if(diff <= 10){
			alert("당해연도 과제 종료일이 10일 이내로, 과제 종료일 내로 검수가 완료되도록 진행하여 주시기 바랍니다.");
			dma_mast.set("msg", "※ 당해연도 과제 종료일이 10일 이내로, 과제 종료일 내로 검수가 완료되도록 진행하여 주시기 바랍니다.");
		}else{
			dma_mast.set("msg", "");
		}
		
		scwin.data.isApproval = true;
		dma_mast.set("approval", "true");
		
		scwin.callSave();
	};
		
	/*
     * 검수대상 그리드 변경 이벤트
     */
	scwin.grd_item_onviewchange = function(info) {
		var row = info.rowIndex;
		var col = info.colIndex;

		if(/item_unit_price|item_qty/.test(grd_item.getColumnID(col))){
			var itemQty = WebSquare.util.parseInt(dlt_item.getCellData(row, "item_qty"), 0);
			var unitPrice = WebSquare.util.parseInt(dlt_item.getCellData(row, "item_unit_price"), 0);
			
			var itemAmt = itemQty * unitPrice;
			var taxAmt = Math.round(itemAmt/10);
			
			dlt_item.setCellData(row, "item_qty", itemQty);
			dlt_item.setCellData(row, "item_unit_price", unitPrice);
			dlt_item.setCellData(row, "item_amt", itemAmt);
			dlt_item.setCellData(row, "tax_amt", taxAmt);
			dlt_item.setCellData(row, "totl_amt", itemAmt+taxAmt);
			
		}else if(grd_item.getColumnID(col) == "tax_amt"){
			var taxAmt = WebSquare.util.parseInt(info.newValue, 0);
			
			dlt_item.setCellData(row, "tax_amt", taxAmt);
			dlt_item.setCellData(row, "totl_amt", Number(dlt_item.getCellData(row, "item_amt")) + taxAmt);
			
		}else if(grd_item.getColumnID(col) == "item_amt"){
			var itemAmt = WebSquare.util.parseInt(info.newValue, 0);
			if(info.newValue == "") itemAmt = 0;
			
			dlt_item.setCellData(row, "item_amt", itemAmt);
			dlt_item.setCellData(row, "totl_amt", itemAmt + Number(dlt_item.getCellData(row, "tax_amt")));
			
		}else if(grd_item.getColumnID(col) == "item_unit"){
			dlt_item.setCellData(row, "item_qty", 0);
			dlt_item.setCellData(row, "item_unit_price", 0);
			dlt_item.setCellData(row, "item_amt", 0);
			dlt_item.setCellData(row, "tax_amt", 0);
			dlt_item.setCellData(row, "totl_amt", 0);
		}else if(grd_item.getColumnID(col) == "totl_amt"){
			if(WebSquare.util.parseInt(dlt_item.getCellData(row, "item_qty"), 0) == 0){
				alert("수량을 입력하세요.");
				dlt_item.setCellData(row, "totl_amt", 0);
				return;	
			}
			
			var totlAmt = WebSquare.util.parseInt(dlt_item.getCellData(row, "totl_amt"), 0);
			var itemQty = WebSquare.util.parseInt(dlt_item.getCellData(row, "item_qty"), 0);
			
			var itemUnitPrice = Math.round(totlAmt * 10 /(11 *itemQty));
			var itemAmt = itemUnitPrice * itemQty;
			
			dlt_item.setCellData(row, "item_unit_price", itemUnitPrice);
			dlt_item.setCellData(row, "item_amt", itemAmt);
			dlt_item.setCellData(row, "tax_amt", totlAmt - itemAmt);
			dlt_item.setCellData(row, "totl_amt", totlAmt);
		}
		
		// 마스터 검수금액 재계산
		scwin.calCheckAmt();		
	};
	
	/*
     * 검사자 검색버튼 클릭 이벤트
     */
	scwin.btn_inspecPsn_onclick = function(e) {
		scwin.getEmpInfo("Inspect_Psn");
	};
	
	/*
     * 삭제 버튼 클릭 이벤트
     */
	scwin.btn_del_onclick = function(e) {
		if(dma_mast.get("unslip_no").trim() != ""){
			alert("결의가 생성된 자료는 삭제할 수 없습니다.");
			return;
		}
		
		com.confirm("message.xom.wq.022"/*삭제 하시겠습니까?*/, function(ret) {
			if (ret) {
				com.file.deleteAll( function(){
					com.execute(sbm_deleteData, {
						successCallback : function(e) { // 성공 콜백
							scwin.data.saveFlag = true;
							
							com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
								com.moveList("F427", scwin.data.saveFlag);
							});
						}
					});
				});
			}
		});
	};
	
	/*
     * 엑셀업로드 버튼 클릭 이벤트
     */
	scwin.btn_upLoad_onclick = function(e) {
		if(dlt_item.getRowCount() == 1 && dlt_item.getCellData(0, "totl_amt") == "")	{
			dlt_item.removeRow(0);
		}
		
		var option = {
			  startRowIndex : "1",
			  "callbackFunc" : scwin.calCheckAmt
		};
		com.uploadGridExcel(grd_item, option);
	};

	/*
     * 반려 버튼 클릭 이벤트
     */
	scwin.btn_retn_onclick = function(e) {
		if(dma_mast.get("unslip_no").trim() != ""){
			alert("결의생성된 건입니다. 결의취소후 반려 가능합니다.");
			return;
		}		
		
		var options = {
			id : "APR02P",
			popupName : "반려의견",
			width : 500, height: 300 
		};
		com.openPopup("/ui/apr/APR_C001_03P.xml", options, "", function(retObj) {
			if (retObj.comments != null && retObj.comments != "") {
				dma_apr.set("comments", retObj.comments);
				dma_apr.set("reqNo" , dma_mast.get("check_no"));
				dma_apr.set("aprState", dma_mast.get("apr_state"));	
				dma_apr.set("procDefAlias", "F27");
				com.execute(sbm_sendAprReject, {
					successCallback : function(e){
						alert("반려처리되었습니다.");
						btn_retn.hide();
						scwin.search();
					}
				});
			}else{
				alert("반려 사유가 입력되지 않았습니다. 확인하여 주시기 바랍니다.");
			}
		});
	};
	
	/*
     * 결의담당자 검색 버튼 클릭 이벤트
     */
	scwin.btn_slip_charger_onclick = function(e) {
		scwin.getEmpInfo("Slip_Charger");
	};
	
	/*
     * 결의생성담당 변경 이벤트
     */
	scwin.rdo_slip_charg_onviewchange = function(info) {
		if(this.getValue() == "A"){
			ibx_fin_manager.setDisabled(true);
			btn_slip_charger.setDisabled(true);
			
			// 연구지원담당자를 재조회해서 결의생성 담당자로 세팅해주기 위한 이벤트 호출
			if(dma_mast.get("accnt_no") != "" && dma_mast.get("accnt_no_nm") != "") {
				scwin.btn_accnt_no_onclick();
			} else {
				rdo_slip_charg.setValue("D");
				com.alert("결의생성 담당자를 연구지원담당자로 세팅하려면\n 먼저 계정번호를 입력해주세요.");			
			}
		} else {
			dma_mast.set("fin_manager", dma_mast.get("check_psn"));
			dma_mast.set("fin_manager_empno", dma_mast.get("check_empno"));
			dma_mast.set("fin_manager_nm", dma_mast.get("check_nm"));
			
			rdo_slip_charg.setValue("D");
			ibx_fin_manager.setDisabled(false);
			btn_slip_charger.setDisabled(false);
		}
	};
	
	/*
     * 입회검수자 변경 이벤트
     */
	scwin.ibx_entsch_psn_empno_onchange = function(info) {
		if(this.getValue() == ""){
			scwin.clearEmpInfo("Inspect_Psn");
		}
	};
	
	/*
     * 결의생성담당자 변경 이벤트
     */
	scwin.ibx_fin_manager_onchange = function(info) {
		if(this.getValue() == ""){
			scwin.clearEmpInfo("Slip_Charger");
		}
	};
	
	/*
     * 비용코드 변경 이벤트
     */
	scwin.ibx_expns_cd_onchange = function(info) {
		if(this.getValue() == ""){
			dma_mast.set("accnt_cd", "");
			dma_mast.set("accnt_cd_abbr", "");
			dma_mast.set("expns_cd_nm", "");
		} else {
			// 사용자가 직접 비용코드를 변경하고 엔터 키 혹은 돋보기 버튼 클릭하지 않는 경우를 방지하기 위해 추가
			if (dma_mast.get("expns_cd") != "" && dma_mast.get("apr_state") < "XAD020") {
				dma_mast.set("accnt_cd", "");
				dma_mast.set("accnt_cd_abbr", "");
				dma_mast.set("expns_cd_nm", "");
				btn_expns_cd.trigger("click");
			}	
		}
	};

	/*
     * 담당자 저장 버튼 클릭 이벤트
     */
	scwin.btn_postSave_onclick = function(e) {
		if(confirm("일부 항목(납품일자, 검사일자, 검수일자)만 수정가능합니다.\n 수정하시겠습니까?")){
			com.execute(sbm_postSave, {
				successCallback : function(e){
					scwin.data.saveFlag = true;
					scwin.search();
				}
			});
		}
	};
	
	/*
     * 증빙구분 변경이벤트
     */
	scwin.sbx_evid_clsf_onchange = function(info) {
		if(this.getValue() == "Card"){
			grp_card.show("");
			grp_bill.hide();
			
			btn_elecBill.hide();
			btn_evid.hide();
		}else{
			grp_card.hide();
			grp_bill.show("");
			
			btn_elecBill.show("");
			btn_evid.show("");
		}
	};
	
	/*
     * 카드번호 검색 버튼 클릭 이벤트
     */
	scwin.btn_card_onclick = function(e) {
		biz.fin.pop.open(biz.fin.pop.TYPE.CARD_USE, {}, function(ret){
			if(ret){
				if(dma_mast.get("card_use_ex") == "FAJ006"){
					if(ret.card_clsf != "FAI003" || ret.card_knd != "FAJ006"){
						alert("e나라도움 과제의 경우 신한(국고보조금)연구비 카드만 등록 가능합니다.");
						return;
					}
				}
				
				// 증빙데이터 초기화
				scwin.clearData();
				
				if(ret.un_amt != dma_mast.get("check_amt")){
					alert("카드승인금액[" + ret.un_amt + "]이 검수금액과 일치하지 않습니다.");
					return;
				}
				
				dma_mast.set("card_no", ret.card_no);
				dma_mast.set("apprvl_no", ret.apprvl_no);
				dma_mast.set("use_ymd", ret.use_ymd);
				dma_mast.set("card_clsf", ret.card_clsf);
				dma_mast.set("card_knd", ret.card_knd);
				dma_mast.set("vend_nm", ret.joinsto_nm);
				
				// 증빙금액 셋팅
//				scwin.setUnslipAmt(ret.supply_amt, ret.tax_amt);						
			}
		});
	};
	
	/*
     * 증빙데이터 초기화
     */
	scwin.clearData = function(){
		var cols = ["card_no", "apprvl_no", "use_ymd", "card_clsf", "card_knd", "bill_no","pay_clsf","etc_attach_file_no","etc_pay_info"];
		
		cols.forEach(function(elt) {
			dma_mast.set(elt, "");
		});
	};
	
	/*
     * 계산서번호 검색 버튼 클릭 이벤트
     */
	scwin.btn_bill_onclick = function(e) {
		var data={
			issu_seqno : dma_mast.get("bill_no").trim(),
			relat_no : com.getLoginInfo("sn")
		};
		
		biz.fin.pop.open(biz.fin.pop.TYPE.BILL, data, function(ret) {
			if(ret){
				if(com.parseInt(ret.totl_amt) != com.parseInt(dma_mast.get("check_amt"))){
					alert("검수금액이 증빙금액과 일치 하지 않습니다. 증빙 금액[" + com.formatMoney(ret.totl_amt) + "]");
					return;	
				}
				
				// 증빙데이터 초기화
				scwin.clearData();
				dma_mast.set("bill_no", ret.issu_seqno);
				
				// 증빙금액 셋팅				
//				scwin.setUnslipAmt(ret.chrg_amt, ret.tax_amt);	
			}			
		});
	};
	/*
     * 증빙금액 셋팅(추후 사용 가능성 때문에 추가함.)
     */
	scwin.setUnslipAmt = function(chrgAmt, taxAmt){
		if(dma_mast.get("tax_cd") == "FTX001"){
			dma_mast.set("evid_chrg_amt", chrgAmt);
			dma_mast.set("evid_tax_amt", taxAmt);
		}else{
			dma_mast.set("evid_chrg_amt", dma_mast.get("check_amt"));
			dma_mast.set("evid_tax_amt", 0);
		}		
	};
	
	/*
     * 전자증빙 버튼 클릭 이벤트
     */
	scwin.btn_elecBill_onclick = function(e) {
		var data = {pur_con_user_id : com.getLoginInfo("sn")
				  , pur_con_org_code : com.getLoginInfo("deptCode")
				  , ref_yn : "Y"
		};

		com.pop.open(com.pop.TYPE.TAXBILL, data, function(retObj) {
			var billNo = retObj.dma_bill.getJSON().issu_seqno;

			if (billNo != null && billNo != "") {
				dma_mast.set("bill_no", billNo);
				// 2023.12.06 계산서 내 항목들 자동세팅
				if (confirm("입력한 전자증빙 파일 목록으로 검수대상을 자동 세팅하시겠습니까? \n 진행핫기존에 입력된 검수대상은 초기화됩니다.")) {
					dlt_item.setJSON(retObj.dlt_smlitm.getAllJSON());
					scwin.grd_item_setting(retObj.dlt_smlitm.getAllJSON());
				}
			}
		});
	};
	
	/*
     * 증빙 버튼 클릭 이벤트
     */
	scwin.btn_evid_onclick = function(e) {
		biz.fin.pop.open(biz.fin.pop.TYPE.EVID_BILL, {}, function(ret) {
			if(ret){
				dma_mast.set("bill_no", ret.issu_seqno);				
	
				btn_bill.trigger("click");
			}
		});
	};
	
	/*
	* 검수대상 엑셀업로드 후 콜백이 없는 상황이라 검수금액 합계가 mast의 검수금액으로 자동 세팅되지 않아 추가
	*/
	scwin.btn_cal_check_amt_onclick = function(e) {
		// 마스터 검수금액 재계산
		scwin.calCheckAmt();
	};
	
	/*
	* 전자증빙 저장 후 검수대상 자동세팅에서 단위(item_unit) 항목 코드화 하기 위한 이벤트
	*/
	scwin.grd_item_setting = function(e) {
		var iRow = e.length;
		var jRow = dlt_cmnCd_PFA.getAllJSON().length;
		var dltCd = dlt_cmnCd_PFA.getAllJSON();
		
		for (var i = 0; i < iRow; i++) {
			for (var j = 0; j < jRow; j++) {
				if (dltCd[j].comNm == e[i].item_unit_nm) {
					dlt_item.setCellData(i, "item_unit", dltCd[j].comCd);
				}
			}
			
			if (dlt_item.getCellData(i, "item_unit") == "") {
				dlt_item.setCellData(i, "item_unit", dltCd[0].comCd);
			} 
		}
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="" class="pageWrap">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn" id="btn_list" style="" type="button" ev:onclick="scwin.btn_list_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox ri" id="">
    				<xf:trigger class="btn" id="btn_retn" style="" type="button" ev:onclick="scwin.btn_retn_onclick">
    					<xf:label><![CDATA[반려]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" disabled="true" ev:onclick="scwin.btn_print_onclick">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" disabled="true" ev:onclick="scwin.btn_apr_onclick">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="grp_chk_cont" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="검수요청정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:180px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검수번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.check_no" style=""></w2:span>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검사부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.check_dept_nm" style=""></w2:span>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검사(입회)자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.check_nm" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정번호구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" style="">
    					<w2:attributes></w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup req" cols="" id="rdo_ctrl_yn" ref="" renderType="radiogroup" rows=""
    						selectedIndex="0" style="" title="계정번호 구분" ev:onchange="scwin.rdo_ctrl_yn_onchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[일반]]></xf:label>
    								<xf:value><![CDATA[N]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[통제]]></xf:label>
    								<xf:value><![CDATA[Y]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="계정번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:group style="width: 200px;" id="grp_accntNo" class="inpSch">
    							<xf:input adjustMaxLength="false" style="" id="ibx_accnt_no" class="inp  req" title="계정번호"
    								ref="data:dma_mast.accnt_no" ev:onviewchange="scwin.ibx_accnt_no_onviewchange">
    							</xf:input>
    							<xf:trigger style="" id="btn_accnt_no" type="button" class="btn" title="계정번호 조회"
    								ev:onclick="scwin.btn_accnt_no_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" style="" id="" class="inp full" title="계정번호 상세" disabled="true"
    							ref="data:dma_mast.accnt_no_nm">
    						</xf:input>
    						<xf:input adjustMaxLength="false" style="width:120px;" id="" class="inp" title="계정번호 2" disabled="true"
    							ref="data:dma_mast.tax_nm">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="계정책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="inpSch" id="grp_accntRspns" style="width: 100px;">
    						<xf:input adjustMaxLength="false" class="inp" id="ibx_accnt_rspns_empno" style="" title="계정책임자" disabled="true"
    							ev:onviewchange="scwin.ibx_accnt_rspns_empno_onviewchange">
    						</xf:input>
    						<xf:trigger class="btn" id="btn_accnt_rspns" style="" title="계정번호 조회" type="button" disabled="true"
    							ev:onclick="scwin.btn_accnt_rspns_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    					<xf:input adjustMaxLength="false" class="inp" disabled="true" id="ibx_accnt_rspsn_nm"
    						ref="data:dma_mast.accnt_rspns_nm" style="width:100px;" title="계정책임자 상세">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="당해년도 과제기간" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes><w2:colspan>3</w2:colspan><w2:rowspan>1</w2:rowspan></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp" id="" style="width: 100px" title="당해년도 과제기간 시작기간" disabled="true"
    						dataType="date" ref="data:dma_mast.start_ymd">
    					</xf:input>
    					<w2:textbox class="txt" id="" label="-" style="" tagname="span"></w2:textbox>
    					<xf:input adjustMaxLength="false" class="inp" id="" style="width: 100px" title="당해년도 과제기간 종료기간" disabled="true"
    						dataType="date" ref="data:dma_mast.cls_ymd">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="비용코드" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:group style="width: 120px;" id="grp_expns" class="inpSch">
    							<xf:input adjustMaxLength="false" style="" id="ibx_expns_cd" class="inp  req" title="비용코드"
    								ref="data:dma_mast.expns_cd" ev:onchange="scwin.ibx_expns_cd_onchange">
    							</xf:input>
    							<xf:trigger style="" id="btn_expns_cd" type="button" class="btn" title="비용코드 조회"
    								ev:onclick="scwin.btn_expns_cd_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" style="" id="" class="inp full" title="비용코드 상세" disabled="true"
    							ref="data:dma_mast.expns_cd_nm">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="회계코드" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:input adjustMaxLength="false" style="width: 100px" id="" title="회계코드" class="inp full  req" disabled="true"
    							ref="data:dma_mast.accnt_cd">
    						</xf:input>
    						<xf:input adjustMaxLength="false" style="" id="" title="회계코드 상세" class="inp full" disabled="true"
    							ref="data:dma_mast.accnt_cd_abbr">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의번호/순번" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp" id="" style="" title="결의번호/순번" disabled="true"
    						ref="data:dma_mast.unslip_no">
    					</xf:input>
    					<xf:input adjustMaxLength="false" class="inp" disabled="true" id="" style="width:40px;" title="결의번호/순번"
    						ref="data:dma_mast.unslip_odr">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="공급금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="공급금액" disabled="true"
    						displayFormat="#,###" dataType="number" ref="data:dma_mast.chrg_amt">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="부가세" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="부가세" disabled="true"
    						displayFormat="#,###" dataType="number" ref="data:dma_mast.tax_amt">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="합계" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="" style="" title="합계" disabled="true"
    						displayFormat="#,###" dataType="number" ref="data:dma_mast.check_amt">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="검수(입회)자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch" id="grp_entschPsn" style="width: 120px;">
    							<xf:input adjustMaxLength="false" class="inp  req" id="ibx_entsch_psn_empno" style="" title="검수(입회)자"
    								ref="data:dma_mast.entsch_psn_empno" ev:onchange="scwin.ibx_entsch_psn_empno_onchange">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_entsch_psn" style="" type="button" title="검수(입회)자 조회"
    								ev:onclick="scwin.btn_entsch_psn_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="검수(입회)자 상세" readOnly="true"
    							ref="data:dma_mast.entsch_psn_nm">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="검수(입회)자부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.entsch_check_dept_nm" style=""></w2:span>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검수(입회)자직책" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.entsch_psn_posi_nm" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="결의생성 담당" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_slip_charg" renderType="radiogroup" rows=""
    						selectedIndex="0" style="margin-right:20px;" title="결의생성 담당" ref="" ev:onviewchange="scwin.rdo_slip_charg_onviewchange"
    						disabled="false">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[연구지원담당자]]></xf:label>
    								<xf:value><![CDATA[A]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[직접지정]]></xf:label>
    								<xf:value><![CDATA[D]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    					<xf:group class="inpSch" id="grp_fin_manager" style="width: 100px;">
    						<xf:input adjustMaxLength="false" class="inp" ev:onviewchange="scwin.ibx_accnt_rspns_empno_onviewchange"
    							id="ibx_fin_manager" style="" title="결의담당자" disabled="true" ref="data:dma_mast.fin_manager_empno"
    							ev:onchange="scwin.ibx_fin_manager_onchange">
    						</xf:input>
    						<xf:trigger class="btn" disabled="true" ev:onclick="scwin.btn_slip_charger_onclick" id="btn_slip_charger"
    							style="" title="결의담당자 검색" type="button">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    					<xf:input adjustMaxLength="false" class="inp" disabled="true" id="" style="width:100px;" title="결의담당자 상세"
    						ref="data:dma_mast.fin_manager_nm">
    					</xf:input>
    					<w2:span class="helptxt red full" id="spn_msg" label="* 입력하신 계정의 연구지원담당자가 지정되지 않아 직접지정만가능합니다." style="margin-left:5px;"></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검사(결재)자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch" id="group1" style="width: 120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="entsch_psn_empno" ref="data:dma_mast.inspect_psn" style=""
    								title="검수(입회)자" disabled="true">
    							</xf:input>
    							<xf:trigger class="btn" ev:onclick="scwin.btn_inspecPsn_onclick" id="btn_inspecPsn" style=""
    								title="검수(입회)자 조회" type="button" disabled="true">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="" readOnly="true" ref="data:dma_mast.inspect_psn_nm"
    							style="" title="검수(입회)자 상세">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검사(결재)자부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.inspect_dept_nm" style=""></w2:span>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검사(결재)자직책" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:span escape="false" id="" label="000" ref="data:dma_mast.inspect_posi_nm" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="화학물질 포함여부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_msds_yn" renderType="radiogroup" rows=""
    						selectedIndex="1" style="" title="방사선장비" ref="data:dma_mast.msds_yn" ev:onviewchange="scwin.rdo_msds_yn_onviewchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[해당]]></xf:label>
    								<xf:value><![CDATA[Y]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[해당안함]]></xf:label>
    								<xf:value><![CDATA[N]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="사전안전성검토 신청번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="inpSch" id="" style="width: 180px;">
    						<xf:input adjustMaxLength="false" class="inp" disabled="true" id="ibx_safeReqNo" ref="data:dma_mast.safe_req_no"
    							style="" title="관련구매요구번호">
    						</xf:input>
    						<xf:trigger class="btn" disabled="true" id="btn_safeDodfpr" style="" title="관련구매요구번호 조회" type="button"
    							ev:onclick="scwin.btn_safeDodfpr_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    					<xf:trigger class="btn" ev:onclick="scwin.btn_wrteSafe_onclick" id="btn_wrteSafe" style="" type="button"
    						disabled="true">
    						<xf:label><![CDATA[사전안전성검토 작성]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="방사선장비" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_rad_yn" ref="data:dma_mast.rad_yn"
    						renderType="radiogroup" rows="" selectedIndex="1" style="" title="방사선장비" ev:onchange="scwin.rdo_rad_yn_onchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[해당]]></xf:label>
    								<xf:value><![CDATA[Y]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[해당안함]]></xf:label>
    								<xf:value><![CDATA[N]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="RG/RI" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_rad_knd" ref="data:dma_mast.rad_knd"
    						renderType="radiogroup" rows="" selectedIndex="-1" style="" title="RG/RI" disabled="true">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[RG(방사선 발생장치)]]></xf:label>
    								<xf:value><![CDATA[RG]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[RI(방사성 동위원소)]]></xf:label>
    								<xf:value><![CDATA[RI]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="기술장비/컴퓨터관련" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_equip_doc_yn" renderType="radiogroup" rows=""
    						selectedIndex="1" style="" title="기술장비/컴퓨터관련" ref="data:dma_mast.equip_doc_yn" ev:onchange="scwin.rdo_equip_doc_yn_onchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[해당]]></xf:label>
    								<xf:value><![CDATA[Y]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[해당안함]]></xf:label>
    								<xf:value><![CDATA[N]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기술장비/컴퓨터관련 등록" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<xf:trigger class="btn" id="btn_techReg" style="" type="button" disabled="true"
    						ev:onclick="scwin.btn_techReg_onclick">
    						<xf:label><![CDATA[기술장비/컴퓨터관련등록]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="연구기자재/시작품" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="inpSch" id="" style="width:150px;">
    						<xf:input adjustMaxLength="false" class="inp" id="" style="" title="연구기자재/시작품" ref="data:dma_mast.equip_odr"></xf:input>
    						<xf:trigger class="btn" id="btn_equip" style="" type="button" title="연구기자재/시작품 조회" ev:onclick="scwin.btn_equip_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="자산등재 대상여부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_aset_reg" ref="data:dma_mast.aset_reg"
    						renderType="radiogroup" rows="" selectedIndex="-1" style="" title="자산등재 대상여부" ev:onchange="scwin.rdo_aset_reg_onchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[예]]></xf:label>
    								<xf:value><![CDATA[Y]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[아니오]]></xf:label>
    								<xf:value><![CDATA[N]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    					<xf:trigger class="btn" id="btn_expnsItem" style="" type="button" ev:onclick="scwin.btn_expnsItem_onclick">
    						<xf:label><![CDATA[대상항목]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="ZEUS등록번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="inpSch" id="" style="width:150px;">
    						<xf:input adjustMaxLength="false" class="inp" id="ibx_ntis_reg_no" ref="data:dma_mast.ntis_reg_no" style=""
    							title="연구기자재/시작품" readOnly="true">
    						</xf:input>
    						<xf:trigger class="btn" id="btn_zeus" style="" title="ZEUS등록번호검색" type="button" disabled="true"
    							ev:onclick="scwin.btn_zeus_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="납품일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal  req" focusOnDateSelect="false" footerDiv="false"
    						id="ica_delvr_ymd" renderDiv="true" rightAlign="false" style="" title="납품일자" ref="data:dma_mast.delvr_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="검사일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal req" focusOnDateSelect="false" footerDiv="false"
    						id="ica_check_ymd" renderDiv="true" rightAlign="false" style="" title="검사일자" ref="data:dma_mast.check_ymd"
    						ev:onviewchange="scwin.ica_check_ymd_onviewchange">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="검수일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id=""></xf:group>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id="ica_entsch_check_ymd"
    						renderDiv="true" rightAlign="false" style="" title="검수일자" ref="data:dma_mast.entsch_check_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="지역,건물,층,호수" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="false" disabledClass="w2selectbox_disabled" id="sbx_posi_region" ref="data:dma_mast.instl_posi_region_cd"
    						style="width:150px;" submenuSize="auto" title="지역" ev:onviewchange="scwin.sbx_posi_region_onviewchange">
    						<xf:choices />
    					</xf:select1>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="false" disabledClass="w2selectbox_disabled" id="sbx_instl_posi_build" style="width:150px;" submenuSize="auto" title="건물"
    						ev:onviewchange="scwin.sbx_instl_posi_build_onviewchange">
    						<xf:choices />
    					</xf:select1>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabled="false" disabledClass="w2selectbox_disabled" id="sbx_instl_posi_floor" ref="" style="width:150px;" submenuSize="auto"
    						title="층">
    						<xf:choices />
    					</xf:select1>
    					<xf:input adjustMaxLength="false" class="inp " id="data:dma_mast.instl_posi" style="width: 100px" title="호수"
    						ref="data:dma_mast.instl_posi_editno">
    					</xf:input>
    					<w2:textbox class="txt" id="" label="호" style="" tagname="span"></w2:textbox>
    					<xf:trigger class="btn" id="btn_instl" style="" type="button" ev:onclick="scwin.btn_instl_onclick">
    						<xf:label><![CDATA[불러오기]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="첨부파일" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group style="height:125px;">
    						<xf:group class="full" id="upload_A" style="height:100%;"></xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="사진첨부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="titleSection" id="" style="">
    						<xf:group class="le" id=""></xf:group>
    						<xf:group class="ri" id="" style="">
    							<xf:trigger class="btn" id="btn_photo_sample" style="" type="button" ev:onclick="scwin.btn_photo_sample_onclick">
    								<xf:label><![CDATA[사진첨부샘플]]></xf:label>
    							</xf:trigger>
    							<xf:trigger class="btn icon down" id="btn_srvForm" style="" type="button" ev:onclick="scwin.btn_srvForm_onclick">
    								<xf:label><![CDATA[용역완료 양식]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    					</xf:group>
    					<xf:group style="height:125px;">
    						<xf:group class="full" id="upload_B" style="height:100%;"></xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="" id="grp_photo_view">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="사진첨부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp" id="" readOnly="true" style="width:300px;" title="검사(결재)자"></xf:input>
    					<xf:trigger class="btn" id="btn_photo_view" style="" type="button" ev:onclick="scwin.btn_photo_view_onclick">
    						<xf:label><![CDATA[보기]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:wframe id="wfm_evid" src="/ui/com/pop/COM_F001_00P.xml" style=""></w2:wframe>
    		<xf:group class="helparea" id="" style="">
    			<xf:group id="" style="" tagname="ul">
    				<xf:group id="" style="" tagname="li">
    					<w2:textbox class="red" id="" label="증빙등록하실 후 반드시 문서를 저장해주시기 바랍니다." style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<xf:group class="le" id="">
    				<w2:textbox class="tit_tbl" id="" label="검수대상" style="" tagname="h3"></w2:textbox>
    			</xf:group>
    			<xf:group class="ri" id="">
    				<xf:group class="btnarea" id="" style="">
    					<xf:trigger class="btn" id="btn_cal_check_amt" style="display:none;" type="button" ev:onclick="scwin.btn_cal_check_amt_onclick">
    						<xf:label><![CDATA[검수금액계산]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn icon upload" id="btn_upLoad" style="" type="button" ev:onclick="scwin.btn_upLoad_onclick">
    						<xf:label><![CDATA[엑셀업로드]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn icon down" id="btn_down" style="" type="button" ev:onclick="scwin.btn_down_onclick">
    						<xf:label><![CDATA[업로드 양식]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="bt_plus" id="btn_plus" style="" type="button" ev:onclick="scwin.btn_plus_onclick">
    						<xf:label><![CDATA[추가]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="bt_minus" id="btn_minus" style="" type="button" ev:onclick="scwin.btn_minus_onclick">
    						<xf:label><![CDATA[삭제]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_item" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    			id="grd_item" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    			rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    			scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
    			summaryAuto="true" visibleRowNum="all" editModeEvent="onclick" ev:onviewchange="scwin.grd_item_onviewchange">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column displayMode="label" id="column5" inputType="checkbox" style="height:28px;" value="구분" width="45"
    						checkboxLabel="전체선택">
    					</w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="물품분류" width="70"></w2:column>
    					<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="품명" width="200"></w2:column>
    					<w2:column displayMode="label" id="column27" inputType="text" style="height:28px" value="단위" width="70"></w2:column>
    					<w2:column displayMode="label" id="column25" inputType="text" style="height:28px" value="수량" width="70"></w2:column>
    					<w2:column displayMode="label" id="column23" inputType="text" style="height:28px" value="단가" width="70"></w2:column>
    					<w2:column displayMode="label" id="column21" inputType="text" style="height:28px" value="금액(부가세별도)" width="95"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column31" value="부가세" displayMode="label"></w2:column>
    					<w2:column width="90" inputType="text" style="height:28px" id="column29" value="총액" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column displayMode="label" escape="false" id="chk" inputType="checkbox" style="height:28px;"
    						width="45" fixColumnWidth="true">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="item_clsf" inputType="select" style="height:28px;" width="70"
    						allOption="" chooseOption="true" chooseOptionLabel="-선택-" ref="" viewType="icon" visibleRowNum="10">
    						<w2:choices></w2:choices>
    					</w2:column>
    					<w2:column displayMode="label" id="item_nm" inputType="text" style="height:28px;" width="200" class="le"></w2:column>
    					<w2:column displayMode="label" id="item_unit" inputType="select" style="height:28px" width="70" viewType="icon" visibleRowNum="10">
    					</w2:column>
    					<w2:column displayMode="label" id="item_qty" inputType="text" style="height:28px" width="70" class="ri" dataType="number" displayFormat="#,###">
    					</w2:column>
    					<w2:column displayMode="label" id="item_unit_price" inputType="text" style="height:28px" width="70" class="ri" dataType="number" displayFormat="#,###">
    					</w2:column>
    					<w2:column displayMode="label" id="item_amt" inputType="text" style="height:28px" width="95" class="ri" dataType="number" displayFormat="#,###">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="tax_amt" value="" displayMode="label"
    						class="ri" dataType="number" displayFormat="#,###">
    					</w2:column>
    					<w2:column width="90" inputType="text" style="height:28px" id="totl_amt" value="" displayMode="label"
    						class="ri" dataType="number" displayFormat="#,###">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    			<w2:footer style="" id="footer1">
    				<w2:row style="" id="row3">
    					<w2:column width="315" inputType="text" style="height:28px;" id="column41" value="합계" displayMode="label"
    						colSpan="3" rowSpan="">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px;" id="column38" value="" displayMode="label"></w2:column>
    					<w2:column width="70" inputType="expression" style="height:28px;" id="column37" value="" displayMode="label" class="ri" dataType="number" displayFormat="#,###" expression="sum('item_qty')"></w2:column>
    					<w2:column width="70" inputType="expression" style="height:28px;" id="column36" value="" displayMode="label" class="ri" dataType="number" displayFormat="#,###" expression="sum('item_unit_price')"></w2:column>
    					<w2:column width="95" inputType="expression" style="height:28px;" id="item_amt_sum" value="" displayMode="label" class="ri" dataType="number" displayFormat="#,###" expression="sum('item_amt')"></w2:column>
    					<w2:column width="70" inputType="expression" style="height:28px;" id="tax_amt_sum" value="" displayMode="label" class="ri" dataType="number" displayFormat="#,###" expression="sum('tax_amt')"></w2:column>
    					<w2:column width="90" inputType="expression" style="height:28px;" id="totl_amt_sum" value="" displayMode="label" class="ri" dataType="number" displayFormat="#,###" expression="sum('totl_amt')"></w2:column>
    				</w2:row>
    			</w2:footer>
    		</w2:gridView>
    		<xf:group class="titleSection" id="" style="">
    			<xf:group class="le" id="">
    				<w2:textbox class="tit_tbl" id="" label="지급내역" style="" tagname="h3"></w2:textbox>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="검수요청정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>    				
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="증빙구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" id="grp_evid">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" ev:onchange="scwin.sbx_evid_clsf_onchange"
    						ev:onviewchange="" id="sbx_evid_clsf" renderType="radiogroup" rows="" selectedIndex="0" style="" title="방사선장비">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[계산서]]></xf:label>
    								<xf:value><![CDATA[Bill]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[카드]]></xf:label>
    								<xf:value><![CDATA[Card]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    					<xf:trigger class="btn" ev:onclick="scwin.btn_evid_onclick" id="btn_evid" style="" type="button">
    						<xf:label><![CDATA[증빙]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn" ev:onclick="scwin.btn_elecBill_onclick" id="btn_elecBill" style="" type="button">
							<xf:label><![CDATA[전자증빙]]></xf:label>
					</xf:trigger>
    				</xf:group>			    				
    			</xf:group>
    			<xf:group id="grp_card" style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="카드번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    					</w2:attributes>
    					<xf:group class="inpSch" id="" style="width:180px;">
    						<xf:input adjustMaxLength="false" class="inp" id="ibx_card_no" readOnly="true" ref="data:dma_mast.card_no"
    							style="" title="카드번호">
    						</xf:input>
    						<xf:trigger class="btn" ev:onclick="scwin.btn_card_onclick" id="btn_card" style="" title="카드번호검색"
    							type="button">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes></w2:attributes>
    					<w2:textbox id="" label="승인번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" disabled="true" id="" ref="data:dma_mast.apprvl_no"
    						style="" title="승인번호">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes></w2:attributes>
    					<w2:textbox id="" label="승인일시" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" dataType="date" disabled="true" id=""
    						ref="data:dma_mast.use_ymd" style="" title="승인일시">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl " id="grp_bill" style="margin-top:0px;" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="검수요청정보입력"></xf:group>
    			<xf:group style="" tagname="colgroup">
    				<xf:group style="width:160px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계산서번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="inpSch full" id="" style="">
    						<xf:input adjustMaxLength="false" class="inp" id="" readOnly="true" ref="data:dma_mast.bill_no" style=""
    							title="계산서번호">
    						</xf:input>
    						<xf:trigger class="btn" ev:onclick="scwin.btn_bill_onclick" id="btn_bill" style="" title="계산서번호검색"
    							type="button">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes></w2:attributes>
    					<w2:textbox id="" label="기타(결제)정보" style="" tagname="span"></w2:textbox>
    				</xf:group>
   					<xf:group tagname="td" class="w2tb_td">
   						<w2:attributes>
   							<w2:colspan>3</w2:colspan>
   							<w2:rowspan>1</w2:rowspan>
   						</w2:attributes>
   						<xf:input style="width:100%;" id="ibx_etc_pay_info" title="기타(결제)정보" class="req" readOnly="false" ref="data:dma_mast.etc_pay_info" maxlength="85" maxByteLength="255">
						</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
   					<xf:group tagname="th" class="w2tb_th">
   						<w2:attributes>
   							<w2:scope>row</w2:scope>
   						</w2:attributes>
   						<w2:textbox tagname="span" style="" id="" label="기타(결제)첨부파일"></w2:textbox>
   					</xf:group>
   					<xf:group tagname="td" class="w2tb_td">
   						<w2:attributes>
   							<w2:colspan>5</w2:colspan>
   							<w2:rowspan>1</w2:rowspan>
   						</w2:attributes>
   						<xf:group style="">
   							<xf:group class="" id="upload_C" style="height:150px;"></xf:group>
   						</xf:group>
   					</xf:group>
   				</xf:group>
    		</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" ev:onclick="scwin.btn_postSave_onclick" id="btn_postSave" style="" type="button">
    					<xf:label><![CDATA[담당자저장]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn pro" id="btn_del" style="" type="button" disabled="true" ev:onclick="scwin.btn_del_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
