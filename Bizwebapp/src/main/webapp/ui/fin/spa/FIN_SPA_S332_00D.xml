<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="내부기술지원의뢰서">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="req_no" name="req_no" dataType="text"></w2:key>
						<w2:key id="approval" name="approval" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_admin">
				  <w2:keyInfo>
				       <w2:key id="rst_book_issu" name="rst_book_issu" dataType="text"></w2:key>
				       <w2:key id="use_usg" name="use_usg" dataType="text"></w2:key>
				       <w2:key id="charg" name="charg" dataType="text"></w2:key>
				       <w2:key id="supt_respn_syspayno" name="supt_respn_syspayno" dataType="text"></w2:key>
				       <w2:key id="updt_syspayno" name="updt_syspayno" dataType="text"></w2:key>
				       <w2:key id="req_no" name="req_no" dataType="text"></w2:key>
				 </w2:keyInfo>
				</w2:dataMap>				
				<w2:dataMap baseNode="map" id="dma_result_tech">
					<w2:keyInfo>
						<w2:key id="req_no" name="req_no" dataType="text"></w2:key>
						<w2:key id="req_clsf" name="신청구분" dataType="text"></w2:key>
						<w2:key id="supt_clsf" name="지원구분" dataType="text"></w2:key>
						<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
						<w2:key id="accnt_no_nm" name="accnt_no_nm" dataType="text"></w2:key>
						<w2:key id="accnt_rspns" name="계정책임자" dataType="text"></w2:key>
						<w2:key id="accnt_rspns_nm" name="accnt_rspns_nm" dataType="text"></w2:key>
						<w2:key id="req_psn_no" name="req_psn_no" dataType="text"></w2:key>
						<w2:key id="req_psn" name="신청자" dataType="text"></w2:key>
						<w2:key id="req_psn_nm" name="req_psn_nm" dataType="text"></w2:key>
						<w2:key id="req_dept" name="신청부" dataType="text"></w2:key>
						<w2:key id="req_dept_nm" name="req_dept_nm" dataType="text"></w2:key>
						<w2:key id="req_ymd" name="신청일자" dataType="text"></w2:key>
						<w2:key id="complt_demnd_ymd" name="완료요구일자" dataType="text"></w2:key>
						<w2:key id="rcpt_psn_no" name="접수자" dataType="text"></w2:key>
						<w2:key id="rcpt_no" name="접수번호" dataType="text"></w2:key>
						<w2:key id="rcpt_psn" name="접수자" dataType="text"></w2:key>
						<w2:key id="rcpt_psn_nm" name="rcpt_psn_nm" dataType="text"></w2:key>
						<w2:key id="rcpt_dept" name="접수부서" dataType="text"></w2:key>
						<w2:key id="rcpt_dept_nm" name="rcpt_dept_nm" dataType="text"></w2:key>
						<w2:key id="impt_accnt_no" name="수입계정번호" dataType="text"></w2:key>
						<w2:key id="impt_accnt_no_nm" name="impt_accnt_no_nm" dataType="text"></w2:key>
						<w2:key id="impt_accnt_rspns" name="수입계정책임" dataType="text"></w2:key>
						<w2:key id="impt_accnt_rspns_nm" name="impt_accnt_rspns_nm" dataType="text"></w2:key>
						<w2:key id="charg" name="담당자" dataType="text"></w2:key>
						<w2:key id="charg_nm" name="charg_nm" dataType="text"></w2:key>
						<w2:key id="supt_respn_syspayno" name="supt_respn_syspayno" dataType="text"></w2:key>
						<w2:key id="supt_respn_nm" name="supt_respn_nm" dataType="text"></w2:key>
						<w2:key id="bugt_ctrl_way" name="예산통제방법" dataType="text"></w2:key>
						<w2:key id="bugt_item_cd" name="예산항목코드" dataType="text"></w2:key>
						<w2:key id="rcpt_ymd" name="접수일자" dataType="text"></w2:key>
						<w2:key id="complt_ymd" name="완료일자" dataType="text"></w2:key>
						<w2:key id="req_amt" name="신청금액" dataType="text"></w2:key>
						<w2:key id="ctrl_amt" name="통제금액" dataType="text"></w2:key>
						<w2:key id="accnt_cd" name="회계코드" dataType="text"></w2:key>
						<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
						<w2:key id="unslip_no" name="가결의번호" dataType="text"></w2:key>
						<w2:key id="req_state" name="신청상" dataType="text"></w2:key>
						<w2:key id="attach_file_no" name="첨부파일번호" dataType="text"></w2:key>
						<w2:key id="rmk" name="비고" dataType="text"></w2:key>
						<w2:key id="use_usg" name="용도" dataType="text"></w2:key>
						<w2:key id="supt_detls_item" name="지원세부사항" dataType="text"></w2:key>
						<w2:key id="req_treat_qty" name="의뢰시료수량" dataType="text"></w2:key>
						<w2:key id="ctrl_no" name="통제번호" dataType="text"></w2:key>
						<w2:key id="apr_state" name="apr_state" dataType="text"></w2:key>
						<w2:key id="rst_book_issu" name="성적서구분" dataType="text"></w2:key>
						<w2:key id="slip_ymd" name="slip_ymd" dataType="text"></w2:key>
						<w2:key id="cud_type" name="저장구분" dataType="text"></w2:key>
						<w2:key id="cud_menu" name="신규접수구분" dataType="text"></w2:key>
						<w2:key id="regst_syspayno" name="등록시스템개인번호" dataType="text"></w2:key>
						<w2:key id="updt_syspayno" name="수정시스템개인번호" dataType="text"></w2:key>
						<w2:key id="validAttachNo" name="validAttachNo" dataType="text"></w2:key>
						<w2:key id="approval" name="approval" dataType="text"></w2:key>
						<w2:key id="req_dept_new_ymd" name="신청부서신설일자" dataType="text"></w2:key>
						<w2:key id="req_clsf_nm" name="req_clsf_nm" dataType="text"></w2:key>
						<w2:key id="supt_clsf_nm" name="supt_clsf_nm" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_list_equip" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="req_no" name="req_no" dataType="text"></w2:column>
						<w2:column id="use_odr" name="use_odr" dataType="text"></w2:column>
						<w2:column id="equip_no" name="equip_no" dataType="text"></w2:column>
						<w2:column id="asset_name" name="asset_name" dataType="text"></w2:column>
						<w2:column id="use_start_ymd" name="use_start_ymd" dataType="text"></w2:column>
						<w2:column id="use_cls_ymd" name="use_cls_ymd" dataType="text"></w2:column>
						<w2:column id="use_start_time" name="use_start_time" dataType="text"></w2:column>
						<w2:column id="use_cls_time" name="use_cls_time" dataType="text"></w2:column>
						<w2:column id="use_time" name="use_time" dataType="text"></w2:column>
						<w2:column id="use_unit_price" name="use_unit_price" dataType="text"></w2:column>
						<w2:column id="use_amt" name="use_amt" dataType="text"></w2:column>
						<w2:column id="treat_qty" name="treat_qty" dataType="text"></w2:column>
						<w2:column id="use_start_minute" name="use_start_minute" dataType="text"></w2:column>
						<w2:column id="use_cls_minute" name="use_cls_minute" dataType="text"></w2:column>
						<w2:column id="chk" name="chk" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_list_tech" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="req_no" name="req_no" dataType="text"></w2:column>
						<w2:column id="req_odr" name="req_odr" dataType="text"></w2:column>
						<w2:column id="supt_detls" name="supt_detls" dataType="text"></w2:column>
						<w2:column id="qty" name="qty" dataType="text"></w2:column>
						<w2:column id="time" name="time" dataType="text"></w2:column>
						<w2:column id="unit_price" name="unit_price" dataType="text"></w2:column>
						<w2:column id="amt" name="amt" dataType="text"></w2:column>
						<w2:column id="rmk" name="rmk" dataType="text"></w2:column>
						<w2:column id="syspayno" name="syspayno" dataType="text"></w2:column>
						<w2:column id="rst_book_issu" name="rst_book_issu" dataType="text"></w2:column>
						<w2:column id="rst_book_treat_nm" name="rst_book_treat_nm" dataType="text"></w2:column>
						<w2:column id="test" name="test" dataType="text"></w2:column>
						<w2:column id="posi_cd" name="posi_cd" dataType="text"></w2:column>
						<w2:column id="chk" name="chk" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_list_matrl" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="req_no" name="req_no" dataType="text"></w2:column>
						<w2:column id="req_odr" name="req_odr" dataType="text"></w2:column>
						<w2:column id="matrl_nm" name="matrl_nm" dataType="text"></w2:column>
						<w2:column id="matrl_std" name="matrl_std" dataType="text"></w2:column>
						<w2:column id="unit_price" name="unit_price" dataType="text"></w2:column>
						<w2:column id="qty" name="qty" dataType="text"></w2:column>
						<w2:column id="amt" name="amt" dataType="text"></w2:column>
						<w2:column id="rmk" name="rmk" dataType="text"></w2:column>
						<w2:column id="chk" name="chk" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_list_psn" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="req_no" name="req_no" dataType="text"></w2:column>
						<w2:column id="req_odr" name="req_odr" dataType="text"></w2:column>
						<w2:column id="supt_psn" name="supt_psn" dataType="text"></w2:column>
						<w2:column id="nm" name="nm" dataType="text"></w2:column>
						<w2:column id="empno" name="empno" dataType="text"></w2:column>
						<w2:column id="tech_grd" name="tech_grd" dataType="text"></w2:column>
						<w2:column id="posi_cd" name="posi_cd" dataType="text"></w2:column>
						<w2:column id="unit_price" name="unit_price" dataType="text"></w2:column>
						<w2:column id="time" name="time" dataType="text"></w2:column>
						<w2:column id="amt" name="amt" dataType="text"></w2:column>
						<w2:column id="rmk" name="rmk" dataType="text"></w2:column>
						<w2:column id="chk" name="chk" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
			<!-- 조회 -->
			<xf:submission id="sbm_selectData" ref="data:json,dma_search"
        		target='data:json,[{"id":"dma_result_tech","key":"fspTechSuphVo"},{"id":"dlt_list_equip","key":"fspEquipUseVoList"},{"id":"dlt_list_tech","key":"fspTechSupdVoList"},
        						   {"id":"dlt_list_matrl","key":"fspTechSupMatrlVoList"},{"id":"dlt_list_psn","key":"fspTechSupPsnVoList"}]'
        		action="SvcFINSPATECR03.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 저장 -->
            <xf:submission id="sbm_saveData" ref='data:json,[{"id":"dma_result_tech","key":"fspTechSuphVo"},{"id":"dlt_list_equip","key":"fspEquipUseVoList"},
            												 {"id":"dlt_list_tech","key":"fspTechSupdVoList"},{"id":"dlt_list_matrl","key":"fspTechSupMatrlVoList"},{"id":"dlt_list_psn","key":"fspTechSupPsnVoList"}]' target='data:json,dma_search' 
        	    action="SvcFINSPATECI01.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 관리자저장 -->
            <xf:submission id="sbm_adminSave" ref='data:json,[{"id":"dma_admin","key":"fspTechSuphVo"},{"id":"dlt_list_tech","key":"fspTechSupdVoList"}]' 
            	target='data:json,dma_search' action="SvcFINSPATECI02.pwkjson" method="post" mediatype="application/json"
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 삭제 -->
        	<xf:submission id="sbm_deleteData" ref='data:json,[{"id":"dma_result_tech","key":"fspTechSuphVo"}]' target=''
        	    action="SvcFINSPATECD01.pwkjson"
        		method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
        		mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>          	         	        	            
        </xf:model>
         <script type="text/javascript" lazy="false"><![CDATA[
    /****************************************************
     * 화면 설명 : 내부지원신청서(유상)
     * 변경 이력 : 2023-10-25	김준하	최초 작성
     * serviceId : S332
     ****************************************************/
    /**
     * 페이지 로드
     */
    scwin.data = {
        saveTag: "I",
        tag: "",
        recv_ymd: "",
        apr_state: "XAD010",
        reqNo: "",
        req_clsf: ""
    };

    scwin.onpageload = function() {
        var codeOptions = [{
                code: "FBN",
                compID: "sbx_req_clsf"
            },
            {
                code: "SLC",
                compID: "sbx_supt_clsf"
            }
        ];
        com.setCmnCd(codeOptions, function() {
            // 첨부파일 컴포넌트 초기화
            com.file.init();
            com.file.create(upload_A.getID(), {
                fileKey: "S332",
                mode: 'edit'
            });
            var param = com.getParameter();
            var session = com.getLoginInfo();
            
            // enter key event
            com.setEnterKeyEvent(grp_rcpt, scwin.btn_rcpt_onclick);
            com.setEnterKeyEvent(grp_char_td, scwin.btn_char_onclick);
            com.setEnterKeyEvent(grp_respn_td, scwin.btn_supt_onclick);
            btn_admin_save.hide();
            grp_char.hide();
            grp_detl_title.hide();
            grid_detl.hide();
            grp_matrl_title.hide();
            grid_matrl.hide();
            grp_psn_title.hide();
            grid_psn.hide();
            sbx_req_clsf.setValue("FBN002");

            if (param.param4 == "apr") {
                dma_search.set("req_no", param.req_no);
                dma_search.set("approval", "true");
            } else {
                dma_search.setJSON(param);
            }
            if (dma_search.get("req_no") != "") {
                scwin.search();
            } else { //신규				
                dma_result_tech.set("req_psn_no", session.cn);
                dma_result_tech.set("req_psn_nm", session.empno);
                dma_result_tech.set("req_psn", session.sn);
                dma_result_tech.set("req_dept_nm", session.deptName);
                dma_result_tech.set("req_dept_new_ymd", session.deptNewYmd);
                dma_result_tech.set("req_dept", session.deptCode);
                dma_result_tech.set("req_ymd", com.getServerDateTime());
                dma_result_tech.set("cud_type", "I");
                dma_result_tech.set("rst_book_issu", "STC020");
            }
        });
    };

    scwin.search = function(e) {
        com.execute(sbm_selectData, {
            successCallback: function(e) { // 성공 콜백
                //				데이터콜렉션세팅					
                var techVo = e.responseJSON.elData.fspTechSuphVo
                var session = com.getLoginInfo();
                var vMode = "edit";
                var roleCode = com.getLoginInfo('roleCode')
                dma_result_tech.set("cud_type", "U");
                // 결의 완료 된 경우 
                if ((techVo.unslip_no).trim() != "") {
                    ibx_unslip_no.setDisabled(true);
                    btn_save.setDisabled(true);
                    btn_del.setDisabled(true);
                    btn_print.setDisabled(false);
                    btn_new.setDisabled(false);
                    btn_apr.setDisabled(true);
                    // 추가삭제 버튼 제어
                    grp_btn_equip.hide();
                    grp_btn_mate.hide();
                    grp_btn_hum.hide();
                    grp_detl_title.show("");
                    grid_detl.show("");
                    grp_matrl_title.show("");
                    grid_matrl.show("");
                    grp_psn_title.show("");
                    grid_psn.show("");
                }
                if (techVo.apr_state >= "XAD020") {
                    // 상신됨
                    ibx_unslip_no.setDisabled(true);
                    btn_save.hide();
                    btn_del.hide();
                    btn_print.hide();
                    btn_new.hide();
                    btn_apr.hide();
                    // 기술지원 추가삭제 버튼 제어
                    grp_btn_tec.hide();

                    // 상신된 상태이므로 : 첨부 파일( 다운로드 버튼만 enable) 
                    mode_type = "view";

                    if (techVo.apr_state >= "XAD070") {
                        // 그룹위치 조정
                        // 추가삭제 버튼 제어			
                        grp_btn_equip.hide();
                        grp_btn_mate.hide();
                        grp_btn_hum.hide();
                        grp_detl_title.show("");
                        grid_detl.show("");
                        grp_matrl_title.show("");
                        grid_matrl.show("");
                        grp_psn_title.show("");
                        grid_psn.show("");
                    }
                    if (techVo.apr_state == "XAD100") {
                        if (roleCode.indexOf("1002211") > -1 || roleCode.indexOf("1010109") > -1 || roleCode.indexOf("1010102") > -1 || roleCode.indexOf("1005233") > -1) {
                            grp_char.show("");
                        }
                    }
                } else {
                    btn_save.setDisabled(false);
                    btn_del.setDisabled(false);
                    btn_apr.setDisabled(false);
                    btn_save.visible(true);
                    btn_del.visible(true);
                    mode_type = "edit";
                }
                if (roleCode.indexOf("1002211") > -1 || roleCode.indexOf("1010109") > -1 || roleCode.indexOf("1010102") > -1 || roleCode.indexOf("1005233") > -1) {
                    btn_admin_save.show("");
                }
                dma_result_tech.set("cud_type", "U");
				btn_new.setDisabled( false );   
                // 첨부파일
                if (dma_result_tech.get("attach_file_no").trim() !== '') {
                    com.file.create(upload_A.getID(), {
                        fileKey: dma_result_tech.get("attach_file_no"),
                        mode: mode_type
                    });
                }

                // 버튼 제어
                //com.biz.disabledButtons(dma_form_result.get("apr_state"), dma_form_result.get("req_no")); // 버튼 세팅
                scwin.gFnGetReqAmt();
            }
        });
    }

    scwin.gFnGetReqAmt = function() {
        // 신청 금액과 통제 금액 설정
        reqAmt = 0;
        scwin.data.reqTreatQty = 0;
        // 기술지원 내역
        for (var iRow = 0; iRow < grid_tech.getRowCount(); iRow++) {
            // 신청 금액                            
            reqAmt += WebSquare.util.parseInt(grid_tech.getCellData(iRow, "amt"));

            // 의뢰 시료 수량
            scwin.data.reqTreatQty += WebSquare.util.parseInt(grid_tech.getCellData(iRow, "qty"));
        }

        // 재료 사용 내역
        for (var iRow = 0; iRow < grid_matrl.getRowCount(); iRow++) {
            // 신청 금액                            
            reqAmt += WebSquare.util.parseInt(grid_matrl.getCellData(iRow, "amt"));
        }

        // 인력지원 내용
        for (var iRow = 0; iRow < grid_psn.getRowCount(); iRow++) {
            // 신청 금액                            
            reqAmt += WebSquare.util.parseInt(grid_psn.getCellData(iRow, "amt"));
        }
        ibx_req_amt.setValue(reqAmt);
        ibx_ctrl_amt.setValue(reqAmt);
    };

    scwin.onpageunload = function() {

    };

    //기술지원 행추가	
    scwin.btn_tech_add_onclick = function(e) {
        com.addRow(grid_tech);
    };

    //기술지원 행삭제
    scwin.btn_tech_del_onclick = function(e) {
        var req_amt = 0;
        var arr = grid_tech.getCheckedIndex("chk");
        var row_cnt = arr.length;
        if (row_cnt == 0) {
            alert("선택되지 않았습니다.");
            return;
        }
        com.deleteRow(grid_tech);
    };

    //계정번호 찾기
    scwin.btn_accnt_no_onclick = function(e) {
        var data = {
            clsf: "gen",
            ref_yn: "Y"
        };
        com.pop.open(com.pop.TYPE.ACNNO, data, function(ret) {
            ibx_accnt_no.setValue(ret.accnt_no);
            ibx_accnt_no_nm.setValue(ret.accnt_no_nm);
            dma_result_tech.set("accnt_no", ret.accnt_no);
            dma_result_tech.set("accnt_no_nm", ret.accnt_no_nm);
            dma_result_tech.set("accnt_rspns", ret.accnt_rspns);
            dma_result_tech.set("accnt_rspns_nm", ret.accnt_rspns_nm);

            var accntState = ret.accnt_state;
            var clsYmd = ret.cls_ymd;
            var reqYmd = ica_req_ymd.getValue();
            var accntNo = ret.accnt_no;
            var srptCd = ret.srpt_cd;
            var accntNoArr = ['PX200084', 'PX200083', 'PX200082', 'PX200081', 'PX200079', 'PX200078', 'PX200077', 'PX200076', 'PX200074', 'PX200072', 'PX200071', 'PX200070', 'PX200069', 'PX200067', 'PX200066', 'PX200065', 'PX200088', 'PX200087', 'PX200086', 'PX200085', 'PX200095', 'PX200096', 'PX200097', 'PX200098', 'PX200103', 'PX200094', 'PX200093', 'PX200105', 'PX200110', 'PX200116'];

            for (var i = 0; i < accntNoArr.length; i++) {
                if (accntNo == accntNoArr[i]) {
                    alert("본 PX계정들은 성과활용기간 종료된 계정들로, 추가 수입이 불가합니다.\n 관련내용은 연구장비실로 문의바랍니다.");
                    dma_result_tech.set("accnt_no", "");
                    dma_result_tech.set("accnt_no_nm", "");
                    dma_result_tech.set("accnt_rspns", "");
                    dma_result_tech.set("accnt_rspns_nm", "");
                    return;
                }
            }
            if (srptCd == "SRP030") {
                alert("해당 계정은 집행전용 계정으로 기술지원 접수용도로 사용할 수 없습니다.\n 관련내용은 연구장비실로 문의바랍니다.");
                dma_result_tech.set("accnt_no", "");
                dma_result_tech.set("accnt_no_nm", "");
                return;
            }
            if (clsYmd < reqYmd) {
                alert("선택하신 계정은 계정 마감일자가 " + clsYmd + " 입니다.");
                dma_result_tech.set("accnt_no", "");
                dma_result_tech.set("accnt_no_nm", "");
                return;
            }
            if (accntState == "RAK011" || accntState == "RAK021" || accntState == "RAK031" || accntState == "RAK051" || accntState == "RAK091") {
                alert("선택하신 계정은 사용할 수 없는 계정 상태입니다.");
                dma_result_tech.set("accnt_no", "");
                dma_result_tech.set("accnt_no_nm", "");
                return;
            }
        });
    };

    //접수담당자
    scwin.btn_rcpt_onclick = function(e) {
        scwin.selectHumBtn("Rcpt");
    };

    //지원담당자
    scwin.btn_char_onclick = function(e) {
        scwin.selectHumBtn("Char");
    };

    //기술책임자
    scwin.btn_supt_onclick = function(e) {
        scwin.selectHumBtn("Supt");
    };

    // 접수담당자 빈값일경우 이름, 시스템사번 데이터셋 초기화	
    scwin.ibx_rcpt_psn_nm_onchange = function(info) {
        if (info.newValue == "") {
            dma_result_tech.set("rcpt_psn_nm", "");
            dma_result_tech.set("rcpt_psn_no", "");
            dma_result_tech.set("rcpt_psn", "");
            dma_result_tech.set("rcpt_no", "");
            dma_result_tech.set("rcpt_dept", "");
            dma_result_tech.set("rcpt_dept_nm", "");
        }
    };

    // 지원담당자 빈값일경우 이름, 시스템사번 데이터셋 초기화	
    scwin.ibx_charg_nm_onchange = function(info) {
        if (info.newValue == "") {
            dma_result_tech.set("charg_nm", "");
            dma_result_tech.set("charg", "");
        }
    };

    // 기술책임자 빈값일경우 이름, 시스템사번 데이터셋 초기화	
    scwin.ibx_supt_respn_nm_onchange = function(info) {
        if (info.newValue == "") {
            dma_result_tech.set("supt_respn_nm", "");
            dma_result_tech.set("supt_respn_syspayno", "");
        }
    };

    /**	
     *	사원 조회
     **/
    scwin.selectHumBtn = function(clsf) {
        var data = {
            work_clsf: "HAG010"
        };
        if (clsf == "Rcpt") {
            if (ibx_rcpt_psn_nm.getValue() != '') {
                data.empno = ibx_rcpt_psn_nm.getValue();
                data.nm = ibx_rcpt_psn_nm.getValue();
            }
        } else if (clsf == "Char") {
            if (ibx_charg_nm.getValue() != '') {
                data.empno = ibx_charg_nm.getValue();
                data.nm = ibx_charg_nm.getValue();
            }
        } else if (clsf == "Supt") {
            if (ibx_supt_respn_nm.getValue() != '') {
                data.empno = ibx_supt_respn_nm.getValue();
                data.nm = ibx_supt_respn_nm.getValue();
            }
        }

        data.ref_yn = (data.empno == "") ? "Y" : "N";
        com.pop.open(com.pop.TYPE.HUM, data, function(ret) {
            if (clsf == "Rcpt") {
                dma_result_tech.set("rcpt_psn_nm", ret.nm);
                dma_result_tech.set("rcpt_psn_no", ret.empno);
                dma_result_tech.set("rcpt_psn", ret.syspayno);
                dma_result_tech.set("rcpt_dept", ret.dept_cd);
                dma_result_tech.set("rcpt_dept_nm", ret.dept_nm);
            } else if (clsf == "Char") {
                dma_result_tech.set("charg_nm", ret.nm);
                dma_result_tech.set("charg", ret.syspayno);
            } else if (clsf == "Supt") {
                dma_result_tech.set("supt_respn_nm", ret.nm);
                dma_result_tech.set("supt_respn_syspayno", ret.syspayno);
            }
        });
    };

    /**
     * 기술지원요청내역 그리드 변경 이벤트 
     */
    scwin.grid_tech_onafteredit = function(row, col, value) {
        var qty = grid_tech.getCellData(row, "qty");
        var time = grid_tech.getCellData(row, "time");
        var unitPrice = grid_tech.getCellData(row, "unit_price");
        if (qty == "") {
            qty = 0;
        }

        if (time == "") {
            time = 0;
        }

        if (unitPrice == "") {
            unitPrice = 0;
        }

        if (col == 5 || col == 6 || col == 7) {
            dlt_list_tech.setCellData(row, "amt", parseInt(qty) * parseInt(time) * parseInt(unitPrice));

            scwin.gFnGetReqAmt();
        }

    };

    /**
     * 장비사용내역 그리드 변경 이벤트 
     */
    scwin.grid_detl_onafteredit = function(row, col, value) {
    	// 사용시간 , 사용금액 계산하기
    	scwin.getOperationUseTimeAmt(row, col);

    };

    scwin.getOperationUseTimeAmt = function(row, col) {
        var dataCnt = 0;
        var dataDiffDay = 0;
        var useTime = 0;

        // 장비사용시간, 날짜가 changt되었을 경우, 
        if (col == grid_detl.getColumnIndex("use_start_ymd") || col == grid_detl.getColumnIndex("use_start_time") || col == grid_detl.getColumnIndex("use_cls_ymd") || col == grid_detl.getColumnIndex("use_cls_time")) {
            var useStartYmd = grid_detl.getCellData(row, "use_start_ymd");
            if (useStartYmd.trim() != "") {
                dataCnt++;
            }
            var useStartTime = grid_detl.getCellData(row, "use_start_time");
            if (useStartTime.trim() != "") {
                dataCnt++;
            }
            var useClsYmd = grid_detl.getCellData(row, "use_cls_ymd");
            if (useClsYmd.trim() != "") {
                dataCnt++;
            }
            var useClsTime = grid_detl.getCellData(row, "use_cls_time");
            if (useClsTime.trim() != "") {
                dataCnt++;
            }

            // 4개의 컬럼에 데이터가 다 들어오면
            if (dataCnt == 4) {
                dataDiffDay = WebSquare.date.dateDiff(useStartYmd, useClsYmd);

                if (dataDiffDay < '0') {
                    alert("작업종료일자가 시작일자보다 앞설수 없습니다.");
                    dlt_list_equip.setCellData(row, "use_start_ymd", useClsYmd);
                    return;
                }
                if (dataDiffDay == '0') {
                    useTime = WebSquare.util.parseInt(useClsTime, 0) - WebSquare.util.parseInt(useStartTime, 0);
                    if (useTime < 0) {
                        alert("작업종료시간이 시작시간보다 앞설수 없습니다.");
                        dlt_list_equip.setCellData(row, "use_start_time", useClsTime);
                        return;
                    }
                } else {
                    useTime = (WebSquare.util.parseInt(dataDiffDay, 0) * 24) -
                        WebSquare.util.parseInt(useStartTime, 0) +
                        WebSquare.util.parseInt(useClsTime, 0);
                }

                dlt_list_equip.setCellData(row, "use_time", useTime);
                if (grid_detl.getCellData(row, "use_unit_price") != 0 && grid_detl.getCellData(row, "use_unit_price") != "") {
                    var useAmt = WebSquare.util.parseInt(grid_detl.getCellData(row, "use_unit_price"), 0) *
                        WebSquare.util.parseInt(grid_detl.getCellData(row, "use_time"), 0);
                    dlt_list_equip.setCellData(row, "use_amt", useAmt);
                }
            }
        }

        // 장비사용단가가 change 되었을 경우
        if (col == grid_detl.getColumnIndex("use_unit_price")) {
            if (grid_detl.getCellData(row, "use_time") != 0 && grid_detl.getCellData(row, "use_time") != "") {
                var useAmt = WebSquare.util.parseInt(grid_detl.getCellData(row, "use_unit_price"), 0) *
                    WebSquare.util.parseInt(grid_detl.getCellData(row, "use_time"), 0);
                dlt_list_equip.setCellData(row, "use_amt", useAmt);
            }
        }
        scwin.gFnGetReqAmt();
    }

    /**
     * 재료사용내역 그리드 변경 이벤트 
     */
    scwin.grid_matrl_onafteredit = function(row, col, value) {
        var qty = grid_matrl.getCellData(row, "qty");
        var unitPrice = grid_matrl.getCellData(row, "unit_price");

        if (qty == "") {
            qty = 0;
        }
        if (unitPrice == "") {
            unitPrice = 0;
        }
        if (col == "4" || col == "5") {
            dlt_list_matrl.setCellData(row, "amt", parseInt(qty) * parseInt(unit_price));
            scwin.gFnGetReqAmt();
        }
    };

    /**
     * 인력지원내역 그리드 변경 이벤트 
     */
    scwin.grid_psn_onafteredit = function(row, col, value) {
        var time = grid_psn.getCellData(row, "time");
        var unitPrice = grid_psn.getCellData(row, "unit_price");
        if (time == "") {
            time = 0;
        }
        if (unitPrice == "") {
            unitPrice = 0;
        }
        if (col == "5" || col == "6") {
            dlt_list_psn.setCellData(row, "amt", parseInt(time) * parseInt(unit_price));
            scwin.gFnGetReqAmt();
        }
    };

    /**
     * 장비사용내역 그리드 클릭 이벤트
     */
    scwin.grid_detl_oncellclick = function(row, col, colId) {
        // 장비번호 팝업			
        if (colId == "btn_equip") {
            var data = {
                biz_clsf: "S",
                aset_clsf: "ABA050", // 기술장비
                region_centr: ""
            };
            com.pop.open(com.pop.TYPE.ASET, data, function(ret) {
                //biz.sup.pop.open(biz.sup.pop.TYPE.ASET, data, function(ret){
                var retArr = (Array.isArray(ret)) ? ret : new Array(ret);

                var cnt = 0;
                for (var i = 0; i < retArr.length; i++) {
                    var retData = retArr[i];
                    var dupleFlag = false;
                    for (var j = 0; j < dlt_list_equip.getRowCount(); j++) {
                        if (retData.aset_no == dlt_list_equip.getCellData(j, "equip_no")) {
                            alert("선택한 자료가 [" + (j + 1) + "]행과 중복되고 있습니다.");
                            dupleFlag = true;
                            break;
                        }
                    }
                    if (!dupleFlag) {
                        var data = {
                            equip_no: retData.aset_no,
                            asset_name: retData.aset_nm,
                            use_unit_price: retData.equip_use_fee
                        };
                        if (cnt == 0) {
                            dlt_list_equip.setRowJSON(row + cnt, data, true);
                        } else {
                            dlt_list_equip.setRowJSON(row + cnt, data);
                        }
                        cnt++;
                    }
                }
            });
        }
    };

    /**
     * 인쇄 클릭 이벤트
     */
    scwin.btn_print_onclick = function(e) {
        var reqNo = ibx_req_no.getValue();
        var node = "reqNo=" + reqNo;
        if (reqNo != "") {
            com.oz.openPopup({
                ozrCode: "S001",
                param: node
            });
        } else {
            alert("신청번호가 없습니다.");
            return false;
        }
    };

    /**
     * 저장 클릭 이벤트
     */
    scwin.btn_save_onclick = function(e) {
        var cudType = "C";
        dma_result_tech.set("cud_type", cudType);
        dma_result_tech.set("approval", "false");
        scwin.data.isApproval = "false";
        scwin.callSave(cudType);
    };

    /*
     * 저장 호출
     */
    scwin.callSave = function(cudType) {
        var reqState = "";
        if (reqState != "XAD100") {
            reqState = "XAD010"; // 신청상태
            dma_result_tech.set("req_state", reqState);
        }
        dma_result_tech.set("cud_menu", "reqMnt1");
        if (cudType != "D") {
            if (!scwin.preSave()) return;
	        com.file.transport(function(attachObj) {
	            var attaches = [];
	            attaches.push(attachObj.upload_A);
	            dma_result_tech.set("attach_file_no", attachObj.upload_A);
	            dma_result_tech.set("validAttachNo", attaches.join(','));
	            dma_result_tech.set("req_treat_qty", scwin.data.reqTreatQty);
	            
	            if (scwin.data.isApproval == "false") {
	                com.confirm("message.xom.wq.017" /*저장 하시겠습니까?*/ , function(ret) {
	                    if (ret) {
	                        scwin.save();
	                    }
	                });
	            } else {
	                scwin.save();
	            }
	        });         
        } else { //삭제 처리
			com.confirm("message.xom.wq.022" /*삭제 하시겠습니까?*/ , function(ret) {
				if (ret) {
	                com.execute(sbm_deleteData, {
	                    successCallback: function(e) { // 성공 콜백	                    	                        
							if (com.getParameter().param4 == "apr") {
								$p.parent().com.alert("message.xom.wq.023" /*정상적으로 처리되었습니다.*/, function(){
									com.movePageMenu("A010");	
								});
							} else {
								$p.parent().com.alert("message.xom.wq.023" /*정상적으로 처리되었습니다.*/, function(){
								    scwin.data.save_flag = true;
									scwin.btn_list_onclick();
								});
							}		                        
	                    }
	                });
				}			
			}); 	       
	    }
	}    
	
	/*
     * 저장
     */
	scwin.save = function(){
		com.execute(sbm_saveData, {
			successCallback : function(e) { // 성공 콜백					
					if (dma_result_tech.get("approval") == "true") {												
						com.movePageMenu("A001", { "reqNo" : dma_result_tech.get("req_no")});
					} else {
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
							scwin.data.saveFlag = true;
							dma_search.set("req_no", e.responseJSON.elData.req_no);					
							// 조회
							scwin.search();
						});										
					}					
			}
		});	
    };

    /*
     * 저장 전 체크
     */
    scwin.preSave = function() {
        var reqNo = ibx_req_no.getValue(); // 신청 번호
        var reqYmd = ica_req_ymd.getValue(); // 신청 일자 
        var rcptYmd = ibx_rcpt_ymd.getValue(); // 접수일자 
        var compltDemndYmd = ica_complt_demnd_ymd.getValue(); //완료요구일자
        var reqAmt = ibx_req_amt.getValue(); //신청금액
        var ctrlAmt = ibx_ctrl_amt.getValue(); //통제금액
        var totalAmt = 0;
        var totalAmt2 = 0;

		if (!com.validateData(dma_result_tech,[
				 { id : "req_ymd", mandatory : true }
				,{ id : "accnt_no", mandatory : true }
				,{ id : "req_clsf", mandatory : true }
				,{ id : "rcpt_psn_no", mandatory : true }
				,{ id : "complt_demnd_ymd", mandatory : true }
				,{ id : "use_usg", mandatory : true }
				,{ id : "supt_clsf", mandatory : true }
				,{ id : "rst_book_issu", mandatory : true }
			], false)
		) return false;

        if (compltDemndYmd < reqYmd) {
            alert("완료 요구 일자가 신청일자 이전일 수 없습니다");
            inputcalendarCompltDemndYmd.focus();
            return false;
        }

        // 지원 내역 확인
        if (grid_tech.getRowCount() == 0) {
            alert("지원 내역을 입력해 주시기 바랍니다.");
            return false;
        } else {
            for (var i = 0; i < grid_tech.getRowCount(); i++) {
                if (!scwin.gridValidChk(grid_tech, i, "supt_detls", "지원내역", "기술지원내역")) return false;
                if (!scwin.gridValidChk(grid_tech, i, "qty", "수량", "기술지원내역")) return false;
                if (!scwin.gridValidChk(grid_tech, i, "time", "시간", "기술지원내역")) return false;
                if (!scwin.gridValidChk(grid_tech, i, "unit_price", "단가", "기술지원내역")) return false;
                totalAmt += WebSquare.util.parseFloat(grid_tech.getCellData(i, "amt"), 0);
            }
        }

        // 장비 사용 실적
        if (grid_detl.getStyle("display") != "none") {
            for (var i = 0; i < grid_detl.getRowCount(); i++) {
                if (!gridValidChk(grid_detl, i, "equip_no", "장비번호", "장비사용내역")) return false;
                if (!gridValidChk(grid_detl, i, "use_start_ymd", "시작일자", "장비사용내역")) return false;
                if (!gridValidChk(grid_detl, i, "use_start_time", "시작시간", "장비사용내역")) return false;
                if (!gridValidChk(grid_detl, i, "use_cls_ymd", "종료일자", "장비사용내역")) return false;
                if (!gridValidChk(grid_detl, i, "use_cls_time", "종료시간", "장비사용내역")) return false;
                if (grid_detl.getCellData(i, "use_cls_ymd") < grid_detl.getCellData(i, "use_start_ymd")) {
                    alert("장비 내역 시작일자가 종료일자 보다 클 수 없습니다. ");
                    return false;
                }
                if (rcptYmd > grid_detl.getCellData(i, "use_start_ymd") || rcptYmd < grid_detl.getCellData(i, "use_cls_ymd")) {
                    alert("장비 내역 사용일은 접수일자와 완료요구일자 안에 포함되야 합니다.  ");
                    return false;
                }
                if (compltDemndYmd > grid_detl.getCellData(i, "use_start_ymd") || compltDemndYmd < grid_detl.getCellData(i, "use_cls_ymd")) {
                    alert("장비 내역 사용일은 접수일자와 완료요구일자 안에 포함되야 합니다.");
                    return false;
                }
                totalAmt2 += WebSquare.util.parseFloat(grid_detl.getCellData(i, "use_amt"), 0);
            }
        }

        // 재료 사용 내역
        for (var i = 0; i < grid_matrl.getRowCount(); i++) {
            if (!gridValidChk(grid_matrl, i, "matrl_nm", "재료명", "재료사용내역")) return false;
            if (!gridValidChk(grid_matrl, i, "unitPrice", "단가", "재료사용내역")) return false;
            if (!gridValidChk(grid_matrl, i, "qty", "수량", "재료사용내역")) return false;
            if (!gridValidChk(grid_matrl, i, "amt", "금액", "재료사용내역")) return false;
        }

        // 지원 인력
        for (var i = 0; i < grid_psn.getRowCount(); i++) {
            if (!gridValidChk(grid_psn, i, "empno", "지원자", "인력지원내역")) return false;
            if (!gridValidChk(grid_psn, i, "supt_psn", "지원자", "인력지원내역")) return false;
            if (!gridValidChk(grid_psn, i, "posi_cd", "지원자", "인력지원내역")) return false;
            if (!gridValidChk(grid_psn, i, "tech_grd", "기술등급", "인력지원내역")) return false;
            if (!gridValidChk(grid_psn, i, "unitPrice", "단가", "인력지원내역")) return false;
            if (!gridValidChk(grid_psn, i, "time", "시간", "인력지원내역")) return false;
            if (!gridValidChk(grid_psn, i, "amt", "금액", "인력지원내역")) return false;
        }
        
        console.log("totalAmt : " + totalAmt + " reqAmt : " + reqAmt + " ctrlAmt : " + ctrlAmt);
        if (totalAmt != reqAmt || totalAmt != ctrlAmt) {
            alert("신청금액과 통제금액 기술지원내역 총금액이 같아야 합니다.");
            return false;
        }
        if (grid_detl.getRowCount() > 0 && grid_detl.getStyle("display") != "none") {
            if (totalAmt2 != reqAmt || totalAmt2 != ctrlAmt || totalAmt2 != totalAmt) {
                alert("기술지원요청내역 금액의 합과 장비사용내역 금액의 합이 일치하지 않습니다.");
                return false;
            }
        }
        return true;
    }
    
    // 그리드 유효성 검사
    scwin.gridValidChk = function(gridObj, row, colId, colName, title) {
        var cellValue = gridObj.getCellData(row, colId);
        if (cellValue == "") {
            alert("[" + title + "] " + (row + 1) + "번째 " + colName + "을(를) 입력하세요.");
            gridObj.setFocusedCell(row, colId);
            return false;
        }
        return true;
    }

    /*
     * 복사 버튼 클릭
     */    
	scwin.btn_new_onclick = function(e) {
		dma_result_tech.set("req_no", "");
		dma_result_tech.set("ctrl_no", "");
		dma_result_tech.set("unslip_no", "");
		dma_result_tech.set("rcpt_psn_no", "");
		dma_result_tech.set("rcpt_psn_nm", "");
		dma_result_tech.set("rcpt_psn", "");
		dma_result_tech.set("cud_type", "I");
		btn_del.setDisabled(true);
		btn_apr.setDisabled(true);
		btn_admin_save.hide();
		btn_print.setDisabled(true);			
		btn_new.setDisabled(true);
	};

    /*
     * 관리자 저장 버튼 클릭
     */   	
	scwin.btn_admin_save_onclick = function(e) {
		dma_admin.set("req_no", ibx_req_no.getValue());
		dma_admin.set("rst_book_issu", radio_rst_book_issu.getValue());
		dma_admin.set("rmk", ibx_rmk.getValue());
		dma_admin.set("use_usg", ibx_use_usg.getValue());
		dma_admin.set("updt_syspayno", com.getLoginInfo().sn);
		dma_admin.set("charg", ibx_charg_syspayno.getValue());
		dma_admin.set("supt_respn_syspayno", ibx_supt_respn_syspayno.getValue());	
		com.execute(sbm_adminSave, {
			successCallback : function(e) { // 성공 콜백					
				com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
					scwin.data.saveFlag = true;
					dma_search.set("req_no", e.responseJSON.elData.req_no);					
					// 조회
					scwin.search();				
				});										
			}
		});			
	};

    /*
     * 삭제 버튼 클릭
     */  	
	scwin.btn_del_onclick = function(e) {
        var cudType = "D";
        dma_result_tech.set("cud_type", cudType);
        dma_result_tech.set("approval", "false");
        scwin.data.isApproval = "false";
        scwin.callSave(cudType);		
	};

    /*
     * 목록 버튼 클릭
     */  	
	scwin.btn_list_onclick = function(e) {
		var data={};
//		com.openTabUrl("내부기술지원(유상)", "/ui/fin/spa/FIN_SPA_S331_00L.xml", 1, data, function() {
//			scwin.menuFind();
//		});
		com.moveList("S331", data);			
	};

    /*
     * 결재신청 클릭
     */  	
	scwin.btn_apr_onclick = function(e) {
        var cudType = "A";
        dma_result_tech.set("cud_type", cudType);
        dma_result_tech.set("approval", "true");
        dma_result_tech.set("req_clsf_nm", sbx_req_clsf.getText());
        dma_result_tech.set("supt_clsf_nm", sbx_supt_clsf.getText());
        scwin.data.isApproval = "true";
        scwin.callSave(cudType);		
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group class="pageWrap" id="" style="">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="">
    				<xf:trigger class="btn " id="btn_list" style="" type="button" ev:onclick="scwin.btn_list_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox" id="">
    				<xf:trigger class="btn " id="btn_new" style="" type="button" disabled="true" ev:onclick="scwin.btn_new_onclick">
    					<xf:label><![CDATA[복사]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" disabled="true" ev:onclick="scwin.btn_print_onclick">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" disabled="true" ev:onclick="scwin.btn_apr_onclick">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="신청정보" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group tagname="table" style="width:100%;" id="" class="w2tb tbl">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group tagname="col" style="width:200px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:200px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:200px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_req_no" style="max-width: 300px;" title=""
    						ref="data:dma_result_tech.req_no" readOnly="true">
    					</xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_req_dept_nm" style="max-width: 300px;" title=""
    						ref="data:dma_result_tech.req_dept_nm" readOnly="true">
    					</xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="신청일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal full" focusOnDateSelect="false" footerDiv="false"
    						id="ica_req_ymd" renderDiv="true" rightAlign="false" style="max-width: 200px;" ref="data:dma_result_tech.req_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="계정번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch fix" id="" style="width:200px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_accnt_no" style=""
    								ref="data:dma_result_tech.accnt_no" readOnly="true">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_accnt_no" style="" type="button" ev:onclick="scwin.btn_accnt_no_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_accnt_no_nm" style="max-width: 700px;"
    							ref="data:dma_result_tech.accnt_no_nm" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_accnt_rspns_nm" style="max-width: 200px;" title=""
    						ref="data:dma_result_tech.accnt_rspns_nm" readOnly="true">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="신청자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:group class="flex" id="" style="">
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_req_psn_nm" style="max-width: 120px;"
    							ref="data:dma_result_tech.req_psn_no" readOnly="true">
    						</xf:input>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_req_psn_emp_no" style="max-width: 150px;"
    							ref="data:dma_result_tech.req_psn_nm" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="신청구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:select1 appearance="minimal" chooseOption="true" chooseOptionLabel="-선택-" class="sel"
    						direction="auto" disabled="true" disabledClass="w2selectbox_disabled" id="sbx_req_clsf" ref="data:dma_result_tech.req_clsf"
    						style="max-width: 400px;" submenuSize="auto">
    						<xf:choices></xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="결의번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_unslip_no" style="max-width: 200px;" title=""
    						ref="data:dma_result_tech.unslip_no" readOnly="true">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="접수담당자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td" id="grp_rcpt">
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch fix" id="" style="width:120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_rcpt_psn_nm" style=""
    								ref="data:dma_result_tech.rcpt_psn_nm" ev:onchange="scwin.ibx_rcpt_psn_nm_onchange">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_rcpt" style="" type="button" ev:onclick="scwin.btn_rcpt_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_rcpt_psn_no" style="max-width: 150px;"
    							ref="data:dma_result_tech.rcpt_psn_no" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="완료요구일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal full" focusOnDateSelect="false" footerDiv="false"
    						id="ica_complt_demnd_ymd" renderDiv="true" rightAlign="false" style="max-width: 200px;"
    						ref="data:dma_result_tech.complt_demnd_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="접수일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_rcpt_ymd" style="max-width: 200px;" title=""
    						ref="data:dma_result_tech.rcpt_ymd" readOnly="true">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="접수부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_rcpt_dept" style="max-width: 200px;"
    							ref="data:dma_result_tech.rcpt_dept" readOnly="true">
    						</xf:input>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_rcpt_dept_nm" style="max-width: 700px;"
    							ref="data:dma_result_tech.rcpt_dept_nm" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="접수번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_rcpt_no" style="max-width: 200px;" title=""
    						ref="data:dma_result_tech.rcpt_no" readOnly="true">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_req_amt" style="max-width: 300px; text-align:right;" title=""
    						displayFormat="#,###" dataType="number" readOnly="true" ref="data:dma_result_tech.req_amt">
    					</xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="통제금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_ctrl_amt" style="max-width: 300px; text-align:right;" title=""
    						displayFormat="#,###" dataType="number" ref="data:dma_result_tech.ctrl_amt" readOnly="true">
    					</xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="통제번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_ctrl_no" style="max-width: 200px;" title=""
    						readOnly="true" ref="data:dma_result_tech.ctrl_no">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="용도" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_use_usg" style="max-width: 300px;" title=""
    						ref="data:dma_result_tech.use_usg">
    					</xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="지원팀(실험실)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:select1 appearance="minimal" chooseOption="true" chooseOptionLabel="-선택-" class="sel"
    						direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_supt_clsf" ref="data:dma_result_tech.supt_clsf"
    						style="max-width: 300px;" submenuSize="auto">
    						<xf:choices></xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="성적서 발행" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:select1 appearance="full" class="radioGroup" cols="" id="radio_rst_book_issu" ref="data:dma_result_tech.rst_book_issu" renderType="radiogroup" rows=""
    						selectedIndex="-1" style="" title="발급종류 언어선택">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[KOLAS]]></xf:label>
    								<xf:value><![CDATA[STC010]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[일반]]></xf:label>
    								<xf:value><![CDATA[STC020]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[미발급]]></xf:label>
    								<xf:value><![CDATA[STC030]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="비고" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_rmk" style="" title="" ref="data:dma_result_tech.rmk"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="첨부파일" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="fileuploadBox" id="upload_A" style="height:150px;"></xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" id="grp_char" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th" id="grp_char_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="지원담당자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" id="grp_char_td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch fix" id="" style="width:120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_charg_nm" style=""
    								ref="data:dma_result_tech.charg_nm" ev:onchange="scwin.ibx_charg_nm_onchange">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_char" style="" type="button" ev:onclick="scwin.btn_char_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_charg_syspayno" style="max-width: 150px;"
    							ref="data:dma_result_tech.charg" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th" id="grp_respn_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기술책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" id="grp_respn_td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch fix" id="" style="width:120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_supt_respn_nm" style=""
    								ref="data:dma_result_tech.supt_respn_nm" ev:onchange="scwin.ibx_supt_respn_nm_onchange">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_supt" style="" type="button" ev:onclick="scwin.btn_supt_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_supt_respn_syspayno" style="max-width: 150px;"
    							ref="data:dma_result_tech.supt_respn_syspayno" readOnly="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="th">
    					<w2:attributes>
    						<w2:colspan>2</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    				</xf:group>
    			</xf:group>
    		</xf:group>

    	</xf:group>
    	<xf:group class="titleSection" id="grp_group1" style="">
    		<xf:group class="le" id="">
    			<w2:textbox class="tit_tbl" id="" label="기술지원요청내역" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="ri" id="">
    			<xf:group class="btnarea" id="grp_btn_tec" style="">
    				<xf:trigger class="bt_plus" id="btn_tech_add" style="" type="button" ev:onclick="scwin.btn_tech_add_onclick">
    					<xf:label><![CDATA[추가]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="bt_minus" id="btn_tech_del" style="" type="button" ev:onclick="scwin.btn_tech_del_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    	<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list_tech" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    		id="grid_tech" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    		rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    		scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
    		visibleRowNum="10" ev:onafteredit="scwin.grid_tech_onafteredit">
    		<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    		<w2:header id="header1" style="">
    			<w2:row id="row1" style="">
    				<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="column1" inputType="checkbox"
    					readOnly="false" style="height:28px;" value="선택" width="45">
    				</w2:column>
    				<w2:column displayMode="label" id="column41" inputType="text" style="height:28px" value="의뢰시료명" width="178"></w2:column>
    				<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="시험항목" width="100"></w2:column>
    				<w2:column displayMode="label" id="column43" inputType="text" style="height:28px" value="수량" width="70"></w2:column>
    				<w2:column displayMode="label" id="column45" inputType="text" style="height:28px" value="시간" width="70"></w2:column>
    				<w2:column displayMode="label" id="column47" inputType="text" style="height:28px" value="단가" width="70"></w2:column>
    				<w2:column displayMode="label" id="column49" inputType="text" style="height:28px" value="금액" width="100"></w2:column>
    				<w2:column displayMode="label" id="column53" inputType="text" style="height:28px" value="성적서발행" width="70"></w2:column>
    				<w2:column displayMode="label" id="column51" inputType="text" style="height:28px" value="품목/시료명(성적서발행용)" width="100">
    				</w2:column>
    				<w2:column displayMode="label" id="column55" inputType="text" style="height:28px" value="비고" width="150"></w2:column>
    			</w2:row>
    		</w2:header>
    		<w2:gBody id="gBody1" style="">
    			<w2:row id="row2" style="">
    				<w2:column checkboxLabel="선택" displayMode="label" id="chk" inputType="checkbox" readOnly="false" style="height:28px;"
    					width="50">
    				</w2:column>
    				<w2:column displayMode="label" id="supt_detls" inputType="text" style="height:28px" value="" width="178"
    					textAlign="left">
    				</w2:column>
    				<w2:column displayMode="label" id="test" inputType="text" style="height:28px;" width="100"
    					textAlign="left">
    				</w2:column>
    				<w2:column displayMode="label" id="qty" inputType="text" style="height:28px" value="" width="70" textAlign="right"></w2:column>
    				<w2:column displayMode="label" id="time" inputType="text" style="height:28px" value="" width="70" textAlign="right"></w2:column>
    				<w2:column displayMode="label" id="unit_price" inputType="text" style="height:28px" value="" width="70"
    					textAlign="right" dataType="number" displayFormat="#,###">
    				</w2:column>
    				<w2:column displayMode="label" id="amt" inputType="text" style="height:28px" value="" width="100" dataType="number"
    					displayFormat="#,###" textAlign="right" readOnly="true">
    				</w2:column>
    				<w2:column displayMode="label" id="rst_book_issu" inputType="checkbox" style="height:28px" value="" width="70"
    					checkboxLabel="선택">
    				</w2:column>
    				<w2:column displayMode="label" id="rst_book_treat_nm" inputType="text" style="height:28px" value="" width="100"
    					textAlign="left">
    				</w2:column>
    				<w2:column displayMode="label" id="rmk" inputType="text" style="height:28px" value="" width="150" textAlign="left"></w2:column>
    			</w2:row>
    		</w2:gBody>
    	</w2:gridView>
    	<xf:group class="titleSection" id="grp_detl_title" style="">
    		<xf:group class="le" id="">
    			<w2:textbox class="tit_tbl" id="" label="장비사용내역" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="ri" id="">
    			<xf:group class="btnarea" id="grp_btn_equip" style="">
    				<xf:trigger class="bt_plus" id="btn_equip_add" style="" type="button">
    					<xf:label><![CDATA[추가]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="bt_minus" id="btn_equip_remove" style="" type="button">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    	<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list_equip" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    		id="grid_detl" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    		rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    		scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
    		visibleRowNum="10" ev:onafteredit="scwin.grid_detl_onafteredit" ev:oncellclick="scwin.grid_detl_oncellclick">
    		<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    		<w2:header id="header1" style="">
    			<w2:row id="row1" style="">
    				<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="column1" inputType="checkbox"
    					readOnly="false" style="height:28px;" value="선택" width="45">
    				</w2:column>
    				<w2:column displayMode="label" id="column41" inputType="text" style="height:28px" value="장비번호" width="150"
    					colSpan="2">
    				</w2:column>
    				<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="장비명" width="161"></w2:column>
    				<w2:column displayMode="label" id="column43" inputType="text" style="height:28px" value="사용시작일자" width="92"></w2:column>
    				<w2:column displayMode="label" id="column45" inputType="text" style="height:28px" value="시작시간" width="70"></w2:column>
    				<w2:column displayMode="label" id="column47" inputType="text" style="height:28px" value="사용종료일자" width="92"></w2:column>
    				<w2:column displayMode="label" id="column49" inputType="text" style="height:28px" value="종료시간" width="100"></w2:column>
    				<w2:column displayMode="label" id="column53" inputType="text" style="height:28px" value="사용시간" width="70"></w2:column>
    				<w2:column displayMode="label" id="column51" inputType="text" style="height:28px" value="사용단가" width="100"></w2:column>
    				<w2:column displayMode="label" id="column55" inputType="text" style="height:28px" value="사용금액" width="150"></w2:column>
    				<w2:column width="70" inputType="text" style="height:28px" id="column57" value="시료수" displayMode="label"></w2:column>
    				<w2:column width="70" inputType="text" style="height:28px" id="column59" value="사용자" displayMode="label"></w2:column>
    			</w2:row>
    		</w2:header>
    		<w2:gBody id="gBody1" style="">
    			<w2:row id="row2" style="">
    				<w2:column checkboxLabel="선택" displayMode="label" id="chk" inputType="checkbox" readOnly="false" style="height:28px;"
    					width="50">
    				</w2:column>
    				<w2:column displayMode="label" id="equip_no" inputType="text" style="height:28px" value="" width="150" readOnly="true"></w2:column>
    				<w2:column width="30" inputType="button" style="height:28px" id="btn_equip" value="조회" displayMode="label"
    					class="btn_sch">
    				</w2:column>
    				<w2:column displayMode="label" id="asset_name" inputType="text" readOnly="true" style="height:28px;" width="161"
    					textAlign="left">
    				</w2:column>
    				<w2:column displayMode="label" id="use_start_ymd" inputType="calendar" style="height:28px" value="" width="92"
    					displayFormat="yyyy-MM-dd">
    				</w2:column>
    				<w2:column displayMode="label" id="use_start_time" inputType="select" style="height:28px" value="" width="70"
    					dataType="number" chooseOption="true" chooseOptionLabel="-선택-" displayFormat="yyyy-MM-dd">
						<w2:choices>
							<w2:item>
								<w2:label>0:00</w2:label>
								<w2:value>0</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>1:00</w2:label>
								<w2:value>1</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>2:00</w2:label>
								<w2:value>2</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>3:00</w2:label>
								<w2:value>3</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>4:00</w2:label>
								<w2:value>4</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>5:00</w2:label>
								<w2:value>5</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>6:00</w2:label>
								<w2:value>6</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>7:00</w2:label>
								<w2:value>7</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>8:00</w2:label>
								<w2:value>8</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>9:00</w2:label>
								<w2:value>9</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>10:00</w2:label>
								<w2:value>10</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>11:00</w2:label>
								<w2:value>11</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>12:00</w2:label>
								<w2:value>12</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>13:00</w2:label>
								<w2:value>13</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>14:00</w2:label>
								<w2:value>14</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>15:00</w2:label>
								<w2:value>15</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>16:00</w2:label>
								<w2:value>16</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>17:00</w2:label>
								<w2:value>17</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>18:00</w2:label>
								<w2:value>18</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>19:00</w2:label>
								<w2:value>19</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>20:00</w2:label>
								<w2:value>20</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>21:00</w2:label>
								<w2:value>21</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>22:00</w2:label>
								<w2:value>22</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>23:00</w2:label>
								<w2:value>23</w2:value>
							</w2:item>
						</w2:choices>    					
    				</w2:column>
    				<w2:column displayMode="yyyy-MM-dd" id="use_cls_ymd" inputType="calendar" style="height:28px" value="" width="92"></w2:column>
    				<w2:column displayMode="label" id="use_cls_time" inputType="select" style="height:28px" value="" width="100"
    					dataType="number">
						<w2:choices>
							<w2:item>
								<w2:label>0:00</w2:label>
								<w2:value>0</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>1:00</w2:label>
								<w2:value>1</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>2:00</w2:label>
								<w2:value>2</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>3:00</w2:label>
								<w2:value>3</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>4:00</w2:label>
								<w2:value>4</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>5:00</w2:label>
								<w2:value>5</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>6:00</w2:label>
								<w2:value>6</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>7:00</w2:label>
								<w2:value>7</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>8:00</w2:label>
								<w2:value>8</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>9:00</w2:label>
								<w2:value>9</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>10:00</w2:label>
								<w2:value>10</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>11:00</w2:label>
								<w2:value>11</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>12:00</w2:label>
								<w2:value>12</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>13:00</w2:label>
								<w2:value>13</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>14:00</w2:label>
								<w2:value>14</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>15:00</w2:label>
								<w2:value>15</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>16:00</w2:label>
								<w2:value>16</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>17:00</w2:label>
								<w2:value>17</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>18:00</w2:label>
								<w2:value>18</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>19:00</w2:label>
								<w2:value>19</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>20:00</w2:label>
								<w2:value>20</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>21:00</w2:label>
								<w2:value>21</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>22:00</w2:label>
								<w2:value>22</w2:value>
							</w2:item>
							<w2:item>
								<w2:label>23:00</w2:label>
								<w2:value>23</w2:value>
							</w2:item>
						</w2:choices>    					
    				</w2:column>
    				<w2:column displayMode="label" id="use_time" inputType="text" style="height:28px" value="" width="70" checkboxLabel="선택"
    					dataType="number" textAlign="right">
    				</w2:column>
    				<w2:column displayMode="label" id="use_unit_price" inputType="text" style="height:28px" value="" width="100"
    					dataType="number" defaultValue="0" displayFormat="###,###,###,###" readOnly="true" textAlign="right">
    				</w2:column>
    				<w2:column displayMode="label" id="use_amt" inputType="text" style="height:28px" value="" width="150" dataType="number"
    					displayFormat="###,###,###,###" textAlign="right">
    				</w2:column>
    				<w2:column width="70" inputType="text" style="height:28px" id="treat_qty" value="" displayMode="label"></w2:column>
    				<w2:column width="70" inputType="text" style="height:28px" id="user" value="" displayMode="label"></w2:column>
    			</w2:row>
    		</w2:gBody>
    	</w2:gridView>
    	<xf:group class="titleSection" id="grp_matrl_title" style="">
    		<xf:group class="le" id="">
    			<w2:textbox class="tit_tbl" id="" label="재료사용내역" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="ri" id="">
    			<xf:group class="btnarea" id="grp_btn_mate" style="">
    				<xf:trigger class="bt_plus" id="btn_matrl_add" style="" type="button">
    					<xf:label><![CDATA[추가]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="bt_minus" id="btn_matrl_remove" style="" type="button">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    	<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list_matrl" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    		id="grid_matrl" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    		rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    		scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
    		visibleRowNum="10" ev:onafteredit="scwin.grid_matrl_onafteredit">
    		<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    		<w2:header id="header1" style="">
    			<w2:row id="row1" style="">
    				<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="column1" inputType="checkbox"
    					readOnly="false" style="height:28px;" value="선택" width="45">
    				</w2:column>
    				<w2:column displayMode="label" id="column41" inputType="text" style="height:28px" value="재료명" width="181"></w2:column>
    				<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="규격" width="100"></w2:column>
    				<w2:column displayMode="label" id="column43" inputType="text" style="height:28px" value="단가" width="100"></w2:column>
    				<w2:column displayMode="label" id="column45" inputType="text" style="height:28px" value="수량" width="100"></w2:column>
    				<w2:column displayMode="label" id="column47" inputType="text" style="height:28px" value="금액" width="150"></w2:column>
    				<w2:column displayMode="label" id="column49" inputType="text" style="height:28px;" value="비고" width="420" colSpan="4"
    					rowSpan="">
    				</w2:column>
    			</w2:row>
    		</w2:header>
    		<w2:gBody id="gBody1" style="">
    			<w2:row id="row2" style="">
    				<w2:column checkboxLabel="선택" displayMode="label" id="chk" inputType="checkbox" readOnly="false" style="height:28px;"
    					width="50">
    				</w2:column>
    				<w2:column displayMode="label" id="matrl_nm" inputType="text" style="height:28px" value="" width="211"
    					textAlign="left">
    				</w2:column>
    				<w2:column displayMode="label" id="matrl_std" inputType="text" readOnly="true" style="height:28px;" width="100"
    					textAlign="left">
    				</w2:column>
    				<w2:column displayMode="label" id="unit_price" inputType="text" style="height:28px" value="" width="93"
    					displayFormat="#,###" dataType="number" textAlign="right">
    				</w2:column>
    				<w2:column displayMode="label" id="qty" inputType="text" style="height:28px" value="" width="85" displayFormat="###,###"
    					textAlign="right">
    				</w2:column>
    				<w2:column displayMode="label" id="amt" inputType="text" style="height:28px" value="" width="125" textAlign="right"
    					readOnly="true" dataType="number" displayFormat="#,###">
    				</w2:column>
    				<w2:column displayMode="label" id="rmk" inputType="text" style="height:28px;" value="" width="420" colSpan="4"
    					rowSpan="" textAlign="left">
    				</w2:column>
    			</w2:row>
    		</w2:gBody>
    	</w2:gridView>
    	<xf:group class="titleSection" id="grp_psn_title" style="">
    		<xf:group class="le" id="">
    			<w2:textbox class="tit_tbl" id="" label="인력지원내역" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="ri" id="">
    			<xf:group class="btnarea" id="grp_btn_hum" style="">
    				<xf:trigger class="bt_plus" id="" style="" type="button">
    					<xf:label><![CDATA[추가]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="bt_minus" id="" style="" type="button">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    	<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_list_psn" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
    		id="grid_psn" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
    		rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
    		scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
    		visibleRowNum="10" ev:onafteredit="scwin.grid_psn_onafteredit">
    		<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    		<w2:header id="header1" style="">
    			<w2:row id="row1" style="">
    				<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="column1" inputType="checkbox"
    					readOnly="false" style="height:28px;" value="선택" width="45">
    				</w2:column>
    				<w2:column displayMode="label" id="column41" inputType="text" style="height:28px" value="지원자" width="139"></w2:column>
    				<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="성명" width="100"></w2:column>
    				<w2:column displayMode="label" id="column43" inputType="text" style="height:28px" value="기술등급" width="143"></w2:column>
    				<w2:column displayMode="label" id="column45" inputType="text" style="height:28px" value="단가" width="100"></w2:column>
    				<w2:column displayMode="label" id="column47" inputType="text" style="height:28px" value="시간" width="100"></w2:column>
    				<w2:column displayMode="label" id="column49" inputType="text" style="height:28px" value="금액" width="100"></w2:column>
    				<w2:column displayMode="label" id="column53" inputType="text" style="height:28px;" value="비고" width="511" colSpan="3"
    					rowSpan="">
    				</w2:column>
    			</w2:row>
    		</w2:header>
    		<w2:gBody id="gBody1" style="">
    			<w2:row id="row2" style="">
    				<w2:column checkboxLabel="선택" displayMode="label" id="col1" inputType="checkbox" readOnly="false" style="height:28px;"
    					width="50">
    				</w2:column>
    				<w2:column displayMode="label" id="empno" inputType="text" style="height:28px" value="" width="139"></w2:column>
    				<w2:column displayMode="label" id="nm" inputType="text" readOnly="true" style="height:28px;" width="100"></w2:column>
    				<w2:column displayMode="label" id="tech_grd" inputType="select" style="height:28px" value="" width="143"
    					displayFormat="####-##-##">
    				</w2:column>
    				<w2:column displayMode="label" id="unit_price" inputType="text" style="height:28px" value="" width="70"
    					textAlign="right" displayFormat="#,###">
    				</w2:column>
    				<w2:column displayMode="label" id="time" inputType="text" style="height:28px" value="" width="70" textAlign="right"></w2:column>
    				<w2:column displayMode="label" id="amt" inputType="text" style="height:28px" value="" width="100" textAlign="right"
    					dataType="number" displayFormat="#,###" readOnly="true">
    				</w2:column>
    				<w2:column displayMode="label" id="rmk" inputType="text" style="height:28px;" value="" width="511" checkboxLabel="선택"
    					colSpan="3" rowSpan="" textAlign="left">
    				</w2:column>
    			</w2:row>
    		</w2:gBody>
    	</w2:gridView>
    	<xf:group class="titleSection" id="" style="">
    		<w2:textbox class="tit_tbl" id="" label="기술지원세부사항" style="" tagname="h3"></w2:textbox>
    	</xf:group>
    	<xf:group class="w2tb tbl" id="" style="" tagname="table">
    		<w2:attributes>
    			<w2:summary></w2:summary>
    		</w2:attributes>
    		<xf:group tagname="caption"></xf:group>
    		<xf:group tagname="colgroup">
    			<xf:group style="" tagname="col"></xf:group>
    			<xf:group style="width:200px;" tagname="col"></xf:group>
    			<xf:group style="" tagname="col"></xf:group>
    			<xf:group style="width:200px;" tagname="col"></xf:group>
    			<xf:group style="" tagname="col"></xf:group>
    		</xf:group>
    		<xf:group tagname="tr">
    			<xf:group class="w2tb_td" tagname="td">
    				<w2:attributes>
    					<w2:colspan>5</w2:colspan>
    					<w2:rowspan>1</w2:rowspan>
    				</w2:attributes>
    				<xf:textarea class="" id="" maxlength="133" style="height:80px;" title="" ref="data:dma_result_tech.supt_detls_item"></xf:textarea>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    	<xf:group class="btnGroup" id="" style="">
    		<xf:group class="le" id="" style=""></xf:group>
    		<xf:group class="ri" id="">
    			<xf:trigger class=" btn pro conf" id="btn_admin_save" style="" type="button" ev:onclick="scwin.btn_admin_save_onclick">
    				<xf:label><![CDATA[관리자 저장]]></xf:label>
    			</xf:trigger>
    			<xf:trigger class="btn pro" id="btn_del" style="" type="button" disabled="true" ev:onclick="scwin.btn_del_onclick">
    				<xf:label><![CDATA[삭제]]></xf:label>
    			</xf:trigger>
    			<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    				<xf:label><![CDATA[저장]]></xf:label>
    			</xf:trigger>
    		</xf:group>
    	</xf:group>
    </body>
</html>
