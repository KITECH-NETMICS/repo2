<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="통합RCMS/POINT집행전송(선집행)">
    	<w2:type>DEFAULT</w2:type>
    	<w2:buildDate />
    	<xf:model>
    		<xf:instance>
    			<data xmlns="" />
    		</xf:instance>
    		<w2:dataCollection baseNode="map">
    			<w2:dataMap baseNode="map" id="dma_search">
				  <w2:keyInfo>
				       <w2:key id="accnt_ymd_st" name="accnt_ymd_st" dataType="text"></w2:key>
				       <w2:key id="accnt_ymd_ed" name="accnt_ymd_ed" dataType="text"></w2:key>
				       <w2:key id="card_use_ex" name="card_use_ex" dataType="text"></w2:key>
				       <w2:key id="slip_no" name="slip_no" dataType="text"></w2:key>
				       <w2:key id="accnt_no" name="accnt_no" dataType="text"></w2:key>
				       <w2:key id="accnt_cd" name="accnt_cd" dataType="text"></w2:key>
				       <w2:key id="expns_cd" name="expns_cd" dataType="text"></w2:key>
				       <w2:key id="resch_accnt_clsf" name="resch_accnt_clsf" dataType="text"></w2:key>
				       <w2:key id="erp_send_no" name="erp_send_no" dataType="text"></w2:key>
				       <w2:key id="sel_apr_state" name="sel_apr_state" dataType="text"></w2:key>
				       <w2:key id="resch_slip_type_cd" name="resch_slip_type_cd" dataType="text"></w2:key>
				       <w2:key id="sbjt_state" name="sbjt_state" dataType="text"></w2:key>
				       <w2:key id="proc_state" name="proc_state" dataType="text"></w2:key>
				       <w2:key id="isRefund" name="isRefund" dataType="text"></w2:key>
				       <w2:key id="send_type" name="send_type" dataType="text"></w2:key>
				       <w2:key id="emp_nm" name="emp_nm" dataType="text"></w2:key>
				       <w2:key id="tel_no" name="tel_no" dataType="text"></w2:key>
				       <w2:key id="rcv_bank" name="rcv_bank" dataType="text"></w2:key>
				       <w2:key id="rcv_acct_no" name="rcv_acct_no" dataType="text"></w2:key>
				       <w2:key id="owac_nm" name="owac_nm" dataType="text"></w2:key>
				       <w2:key id="rcv_bank_nm" name="rcv_bank_nm" dataType="text"></w2:key>
				       <w2:key id="rcms_pay_clsf" name="rcms_pay_clsf" dataType="text"></w2:key>
				       <w2:key id="lnk_reg_dt" name="lnk_reg_dt" dataType="text"></w2:key>
				 </w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_error_search">
				  <w2:keyInfo>
				       <w2:key id="lnk_reg_dt_st" name="lnk_reg_dt_st" dataType="text"></w2:key>
				       <w2:key id="lnk_reg_dt_ed" name="lnk_reg_dt_ed" dataType="text"></w2:key>
				 </w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_refund_search">
				  <w2:keyInfo>
				       <w2:key id="accnt_ymd_st" name="accnt_ymd_st" dataType="text"></w2:key>
				       <w2:key id="accnt_ymd_ed" name="accnt_ymd_ed" dataType="text"></w2:key>
				       <w2:key id="card_use_ex" name="card_use_ex" dataType="text"></w2:key>
				       <w2:key id="slip_no" name="slip_no" dataType="text"></w2:key>
				       <w2:key id="accnt_no" name="accnt_no" dataType="text"></w2:key>
				       <w2:key id="resch_accnt_clsf" name="resch_accnt_clsf" dataType="text"></w2:key>
				       <w2:key id="erp_send_no" name="erp_send_no" dataType="text"></w2:key>
				       <w2:key id="sel_apr_state" name="sel_apr_state" dataType="text"></w2:key>
				       <w2:key id="resch_slip_type_cd" name="resch_slip_type_cd" dataType="text"></w2:key>
				       <w2:key id="proc_state" name="proc_state" dataType="text"></w2:key>
				 </w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_etc_evdc_rsn_cd_list" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="label" name="label" dataType="text"></w2:column>
						<w2:column id="value" name="value" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
   				<w2:dataList baseNode="list" repeatNode="map" id="dlt_list" saveRemovedData="true">
				  <w2:columnInfo>
				  	   <w2:column id="chk" name="chk" dataType="text"></w2:column>
				       <w2:column id="lnk_reg_seq" name="lnk_reg_seq" dataType="text"></w2:column>
				       <w2:column id="accnt_no" name="accnt_no" dataType="text"></w2:column>
				       <w2:column id="accnt_cd" name="accnt_cd" dataType="text"></w2:column>
				       <w2:column id="expns_cd" name="expns_cd" dataType="text"></w2:column>
				       <w2:column id="accnt_cd_abbr" name="accnt_cd_abbr" dataType="text"></w2:column>
				       <w2:column id="unslip_amt" name="unslip_amt" dataType="text"></w2:column>
				       <w2:column id="trans_amt" name="trans_amt" dataType="text"></w2:column>
				       <w2:column id="pay_accnt_cd" name="pay_accnt_cd" dataType="text"></w2:column>
				       <w2:column id="rcms_pay_clsf" name="rcms_pay_clsf" dataType="text"></w2:column>
				       <w2:column id="rcms_pay_unslip_no" name="rcms_pay_unslip_no" dataType="text"></w2:column>
				       <w2:column id="bill_no" name="bill_no" dataType="text"></w2:column>
				       <w2:column id="evid_cd" name="evid_cd" dataType="text"></w2:column>
				       <w2:column id="req_no" name="req_no" dataType="text"></w2:column>
				       <w2:column id="rmk_2" name="rmk_2" dataType="text"></w2:column>
				       <w2:column id="paym_usag" name="paym_usag" dataType="text"></w2:column>
				       <w2:column id="accnt_ymd" name="accnt_ymd" dataType="text"></w2:column>
				       <w2:column id="wrte_psn_nm" name="wrte_psn_nm" dataType="text"></w2:column>
				       <w2:column id="slip_no_odr" name="slip_no_odr" dataType="text"></w2:column>
				       <w2:column id="trans_unslip_no" name="trans_unslip_no" dataType="text"></w2:column>
				       <w2:column id="accnt_rspns_nm" name="accnt_rspns_nm" dataType="text"></w2:column>
				       <w2:column id="bugt_ctrl_psn_nm" name="bugt_ctrl_psn_nm" dataType="text"></w2:column>
				       <w2:column id="lnk_reg_dt" name="lnk_reg_dt" dataType="text"></w2:column>
				       <w2:column id="exctn_exec_dt" name="exctn_exec_dt" dataType="text"></w2:column>
				       <w2:column id="bz_exp_exctn_err_ctt" name="bz_exp_exctn_err_ctt" dataType="text"></w2:column>
				       <w2:column id="splr_bz_reg_no" name="splr_bz_reg_no" dataType="text"></w2:column>
				       <w2:column id="rch_exp_acct_no" name="rch_exp_acct_no" dataType="text"></w2:column>
				       <w2:column id="inst_sbjt_prgr_st" name="inst_sbjt_prgr_st" dataType="text"></w2:column>
				       <w2:column id="exctn_limt_st" name="exctn_limt_st" dataType="text"></w2:column>
				       <w2:column id="inst_totl_inst_amt" name="inst_totl_inst_amt" dataType="text"></w2:column>
				       <w2:column id="pms_id" name="pms_id" dataType="text"></w2:column>
				       <w2:column id="inst_sbjt_no" name="inst_sbjt_no" dataType="text"></w2:column>
				       <w2:column id="proc_state" name="proc_state" dataType="text"></w2:column>
				       <w2:column id="trns_amt" name="trns_amt" dataType="text"></w2:column>
				       <w2:column id="erp_send_no" name="erp_send_no" dataType="text"></w2:column>
				       <w2:column id="prj_ymd_yn" name="prj_ymd_yn" dataType="text"></w2:column>
				       <w2:column id="cls_ymd" name="cls_ymd" dataType="text"></w2:column>
				       <w2:column id="itxp_cd" name="itxp_cd" dataType="text"></w2:column>
				       <w2:column id="frc_trsc_yn" name="frc_trsc_yn" dataType="text"></w2:column>
				       <w2:column id="etc_evdc_rsn_cd" name="etc_evdc_rsn_cd" dataType="text"></w2:column>
				       <w2:column id="accnt_rspns_email" name="accnt_rspns_email" dataType="text"></w2:column>
				       <w2:column id="bugt_ctrl_psn_email" name="bugt_ctrl_psn_email" dataType="text"></w2:column>
				       <w2:column id="wrte_psn_emaill" name="wrte_psn_emaill" dataType="text"></w2:column>
				       <w2:column id="unslip_no" name="unslip_no" dataType="text"></w2:column>
				       <w2:column id="unslip_odr" name="unslip_odr" dataType="text"></w2:column>
				  </w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_send_list" saveRemovedData="true">
				  <w2:columnInfo>
				       <w2:column id="lnk_reg_seq" name="lnk_reg_seq" dataType="text"></w2:column>
				       <w2:column id="accnt_no" name="accnt_no" dataType="text"></w2:column>
				       <w2:column id="accnt_cd" name="accnt_cd" dataType="text"></w2:column>
				       <w2:column id="expns_cd" name="expns_cd" dataType="text"></w2:column>
				       <w2:column id="accnt_cd_abbr" name="accnt_cd_abbr" dataType="text"></w2:column>
				       <w2:column id="unslip_amt" name="unslip_amt" dataType="text"></w2:column>
				       <w2:column id="trans_amt" name="trans_amt" dataType="text"></w2:column>
				       <w2:column id="pay_accnt_cd" name="pay_accnt_cd" dataType="text"></w2:column>
				       <w2:column id="rcms_pay_clsf" name="rcms_pay_clsf" dataType="text"></w2:column>
				       <w2:column id="rcms_pay_unslip_no" name="rcms_pay_unslip_no" dataType="text"></w2:column>
				       <w2:column id="bill_no" name="bill_no" dataType="text"></w2:column>
				       <w2:column id="evid_cd" name="evid_cd" dataType="text"></w2:column>
				       <w2:column id="req_no" name="req_no" dataType="text"></w2:column>
				       <w2:column id="rmk_2" name="rmk_2" dataType="text"></w2:column>
				       <w2:column id="paym_usag" name="paym_usag" dataType="text"></w2:column>
				       <w2:column id="accnt_ymd" name="accnt_ymd" dataType="text"></w2:column>
				       <w2:column id="wrte_psn_nm" name="wrte_psn_nm" dataType="text"></w2:column>
				       <w2:column id="slip_no_odr" name="slip_no_odr" dataType="text"></w2:column>
				       <w2:column id="trans_unslip_no" name="trans_unslip_no" dataType="text"></w2:column>
				       <w2:column id="accnt_rspns_nm" name="accnt_rspns_nm" dataType="text"></w2:column>
				       <w2:column id="bugt_ctrl_psn_nm" name="bugt_ctrl_psn_nm" dataType="text"></w2:column>
				       <w2:column id="lnk_reg_dt" name="lnk_reg_dt" dataType="text"></w2:column>
				       <w2:column id="exctn_exec_dt" name="exctn_exec_dt" dataType="text"></w2:column>
				       <w2:column id="bz_exp_exctn_err_ctt" name="bz_exp_exctn_err_ctt" dataType="text"></w2:column>
				       <w2:column id="splr_bz_reg_no" name="splr_bz_reg_no" dataType="text"></w2:column>
				       <w2:column id="rch_exp_acct_no" name="rch_exp_acct_no" dataType="text"></w2:column>
				       <w2:column id="inst_sbjt_prgr_st" name="inst_sbjt_prgr_st" dataType="text"></w2:column>
				       <w2:column id="exctn_limt_st" name="exctn_limt_st" dataType="text"></w2:column>
				       <w2:column id="inst_totl_inst_amt" name="inst_totl_inst_amt" dataType="text"></w2:column>
				       <w2:column id="pms_id" name="pms_id" dataType="text"></w2:column>
				       <w2:column id="inst_sbjt_no" name="inst_sbjt_no" dataType="text"></w2:column>
				       <w2:column id="proc_state" name="proc_state" dataType="text"></w2:column>
				       <w2:column id="trns_amt" name="trns_amt" dataType="text"></w2:column>
				       <w2:column id="erp_send_no" name="erp_send_no" dataType="text"></w2:column>
				       <w2:column id="prj_ymd_yn" name="prj_ymd_yn" dataType="text"></w2:column>
				       <w2:column id="cls_ymd" name="cls_ymd" dataType="text"></w2:column>
				       <w2:column id="itxp_cd" name="itxp_cd" dataType="text"></w2:column>
				       <w2:column id="frc_trsc_yn" name="frc_trsc_yn" dataType="text"></w2:column>
				       <w2:column id="etc_evdc_rsn_cd" name="etc_evdc_rsn_cd" dataType="text"></w2:column>
				       <w2:column id="accnt_rspns_email" name="accnt_rspns_email" dataType="text"></w2:column>
				       <w2:column id="bugt_ctrl_psn_email" name="bugt_ctrl_psn_email" dataType="text"></w2:column>
				       <w2:column id="wrte_psn_emaill" name="wrte_psn_emaill" dataType="text"></w2:column>
				       <w2:column id="unslip_no" name="unslip_no" dataType="text"></w2:column>
				       <w2:column id="unslip_odr" name="unslip_odr" dataType="text"></w2:column>
				  </w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_error_list" saveRemovedData="true">
				  <w2:columnInfo>
				       <w2:column id="rcms_pay_clsf" name="rcms_pay_clsf" dataType="text"></w2:column>
				       <w2:column id="proc_state" name="proc_state" dataType="text"></w2:column>
				       <w2:column id="slip_no_odr" name="slip_no_odr" dataType="text"></w2:column>
				       <w2:column id="accnt_no" name="accnt_no" dataType="text"></w2:column>
				       <w2:column id="accnt_cd" name="accnt_cd" dataType="text"></w2:column>
				       <w2:column id="accnt_cd_abbr" name="accnt_cd_abbr" dataType="text"></w2:column>
				       <w2:column id="trns_amt" name="trns_amt" dataType="text"></w2:column>
				       <w2:column id="rmk_2" name="rmk_2" dataType="text"></w2:column>
				       <w2:column id="rmk_1" name="rmk_1" dataType="text"></w2:column>
				       <w2:column id="accnt_ymd" name="accnt_ymd" dataType="text"></w2:column>
				       <w2:column id="err_msg" name="err_msg" dataType="text"></w2:column>
				       <w2:column id="unslip_no" name="unslip_no" dataType="text"></w2:column>
				       <w2:column id="accnt_rspns" name="accnt_rspns" dataType="text"></w2:column>
				       <w2:column id="dept_cd_nm" name="dept_cd_nm" dataType="text"></w2:column>
				       <w2:column id="accnt_rspns_nm" name="accnt_rspns_nm" dataType="text"></w2:column>
				       <w2:column id="lnk_reg_dt" name="lnk_reg_dt" dataType="text"></w2:column>
				       <w2:column id="fomat_unit" name="fomat_unit" dataType="text"></w2:column>
				       <w2:column id="bugt_ctrl_psn" name="bugt_ctrl_psn" dataType="text"></w2:column>
				       <w2:column id="ext_no" name="ext_no" dataType="text"></w2:column>
				  </w2:columnInfo>
				</w2:dataList>
    		</w2:dataCollection>
    		<w2:workflowCollection></w2:workflowCollection>
    		
    		<!-- 리스트 조회 -->
    		<xf:submission id="sbm_selectSearchList" ref='data:json,dma_search'
    			target='data:json,{"id":"dlt_list","key":"FinRcmsPaySendVoList"}' action="SvcFINRCMSFINMR01.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" mode="asynchronous">
    		</xf:submission>
    		
    		<!-- 오류 리스트 조회 -->
    		<xf:submission id="sbm_selectSearchErrorList" ref='data:json,dma_error_search'
    			target='data:json,{"id":"dlt_error_list","key":"FinRcmsPaySendVoList"}' action="SvcFINRCMSFINMR03.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" mode="asynchronous">
    		</xf:submission>
    		
    		<!-- 반납금 리스트 조회 -->
    		<xf:submission id="sbm_selectRefundSearchList" ref='data:json,dma_refund_search'
    			target='data:json,{"id":"dlt_list","key":"FinRcmsPaySend04VoList"}' action="SvcFINRCMSFINMR02.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" mode="asynchronous">
    		</xf:submission>
    		
    		<!-- 강제완료 처리 -->
    		<xf:submission id="sbm_forcefulCompletion" ref='data:json,[{"id":"dlt_send_list", "key":"FinRcmsPaySendVoList"}]' action="SvcFINRCMSFIMU01.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" ev:submitdone="scwin.sbm_forcefulCompletion_submitdone" mode="asynchronous">
    		</xf:submission>
    		
    		<!-- 전송 처리 -->
    		<xf:submission id="sbm_rcmsSend" ref='data:json,[{"id":"dma_search","key":"FinRcmsPaySendVo"},{"id":"dlt_send_list", "key":"FinRcmsPaySendVoList"}]' action="SvcFINRCMSFIMI01.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" ev:submitdone="scwin.sbm_rcmsSend_submitdone" mode="asynchronous">
    		</xf:submission>
    		
    		<!-- 전송 취소 처리 -->
    		<xf:submission id="sbm_rcmsSendCancel" ref='data:json,[{"id":"dma_search","key":"FinRcmsPaySendVo"},{"id":"dlt_send_list", "key":"FinRcmsPaySendVoList"}]' action="SvcFINRCMSFIMI02.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" ev:submitdone="scwin.sbm_rcmsSendCancel_submitdone" mode="asynchronous">
    		</xf:submission>
    		
    	</xf:model>
    	<script type="text/javascript" lazy="false"><![CDATA[
        
	scwin.onpageload = function() {
		
		var sn = com.getLoginInfo('sn');
		scwin.currentDate = com.getServerDateTime("yyyyMMdd");
		dma_search.set("accnt_ymd_ed", scwin.currentDate);
		dma_search.set("accnt_ymd_st", com.getServerDateTime('yyyy0101'));
		//dma_search.set("accnt_ymd_st", com.addDate(scwin.currentDate, -30));
		
		// 데이터 세팅
		scwin.init();
		
		//const temp = [{"accnt_no": "PBW23020"}];
		//dlt_list.setJSON(temp);
		
		var codeOptions = [ { code : "FDQ", compID :"grd_sample:sbx_y"} ];
		
		com.setCmnCd(codeOptions, function() {	
			// 그리드 공통코드 세팅 
			var ret = com.getComponent(gcm.CMNCD_INFO.DATA_PREFIX + "FDQ");
			let dltData = [];
			for(let i = 0 ; i < ret.getDataLength() ; i++){
				dltData.push(
					{
						label: ret.getCellData(i, gcm.CMNCD_INFO.LABEL),
						value : ret.getCellData(i, gcm.CMNCD_INFO.FILED_ARR[6])
					}
				)
			}
			dlt_etc_evdc_rsn_cd_list.setJSON(dltData);
		});
		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	scwin.init = function() {
		buttonGroupContainer.setDisabled(true);
		btn_search.setDisabled(false);
		btn_b007.setDisabled(false);
		approvedResolutionState.setValue('XAD100');
		checkboxExept2.setValue('610');
		dma_search.set("proc_state", 9);
		
		inputBankaccntNo.setValue("391-003560-04-384");
		inputBankCd.setValue("FAA003");
		inputBankNm.setValue("기업은행");	
		inputDepStrNm.setValue("한국생산기술연구원");
	};
	
	scwin.pre_search = function() {
	
		if (start_ymd.getValue() == "") {
			start_ymd.focus();
			com.warn("확정일자(시작)를 입력해주세요");
			return false;
		}
	
		if (cls_ymd.getValue() == "") {
			cls_ymd.focus();
			com.warn("확정일자(종료)를 입력해주세요");
			return false;
		}
	
		// 확정일자 기간 구하기
		var dateDiff = WebSquare.date.dateDiff(start_ymd.getValue().trim(), cls_ymd.getValue().trim());
	
		if (dateDiff > 730) {
			com.warn("확정일자 기간은 24개월을 조과할 수 없습니다.");
			return false;
		}

		if (dateDiff > 7 && dma_search.get("proc_state") == "" && dma_search.get("slip_no").trim() == "" && dma_search.get("accnt_no").trim() == ""
		&& dma_search.get("erp_send_no").trim() == "") {
			com.warn("확정일자(7일 이내), 처리상태, 확정결의번호, 계정번호, 전송번호 중 하나 이상의 조건을 입력하십시오.");
			return false;
		}
		
		return true;
	}
	
	scwin.search = function() {
	
		if(!scwin.pre_search()) return;
		
		var chkVal = checkboxExept.getValue();
		var arrChkVal = chkVal.split(',');
		var chkItem = "";
	
		if (arrChkVal.length == 2) {
			// 20140617 재정운영실 구본준요청(인건비 제외 포함항목 - 내부인건비I, 내부인건비II, 외부인건비, 학생인건비)
			// 20150402 구본준요청(내부인건비III 포함)
			chkItem = "'FBL010','FBL020','FBL023','FBL025','FBL027','FBL150','FBL170','FBL200','FBL205','FBL207','FBL210','FBL220','FBL223','FBL225'"; //인건비, 간접비제외
		} else {
			for(var i=0; i<arrChkVal.length; i++) {
				var tmpVal = arrChkVal[i];
	
				if (tmpVal == '1') {
					chkItem = "'FBL010','FBL020','FBL023','FBL025','FBL027'"; // 인건비제외
				} else if (tmpVal == '2') {
					chkItem = "'FBL150','FBL170','FBL200','FBL205','FBL207','FBL210','FBL220','FBL223','FBL225'"; //간접비제외
				}
			}
		}
	
		var chkVal2 = checkboxExept2.getValue().trim();
	
		if (chkVal2 == "610") {
			dma_search.set("resch_slip_type_cd", chkVal2);
		} else {
			dma_search.set("resch_slip_type_cd", "");
		}
		dma_search.set("resch_accnt_clsf", chkItem);
		
		const RAC = dma_search.get("isRefund");
		
		if (RAC) {
		
			dma_refund_search.set("accnt_ymd_st", dma_search.get("accnt_ymd_st"));
			dma_refund_search.set("accnt_ymd_ed", dma_search.get("accnt_ymd_ed"));
			dma_refund_search.set("card_use_ex", dma_search.get("card_use_ex"));
			dma_refund_search.set("slip_no", dma_search.get("slip_no"));
			dma_refund_search.set("accnt_no", dma_search.get("accnt_no"));
			dma_refund_search.set("erp_send_no", dma_search.get("erp_send_no"));
			dma_refund_search.set("proc_state", dma_search.get("proc_state"));
			dma_refund_search.set("sel_apr_state", dma_search.get("sel_apr_state"));
			dma_refund_search.set("resch_accnt_clsf", chkItem);
				
			
			// 반납금 리스트 조회
			com.execute(sbm_selectRefundSearchList, {
				successCallback : function(e) {
					tbx_result.setValue(dlt_list.getTotalRow());
					scwin.activateButton();
				}
			});
		} else {
			// 리스트 조회
			com.execute(sbm_selectSearchList, {
				successCallback : function(e) {
					tbx_result.setValue(dlt_list.getTotalRow());
					scwin.activateButton();				
				}
			});
		}
	};
	
	scwin.activateButton = function() {
		btn_send.setDisabled(false);
		btn_b001.setDisabled(false);
		btn_b002.setDisabled(false);
		btn_b003.setDisabled(false);
		btn_b004.setDisabled(false);
		btn_b005.setDisabled(false);
		btn_b006.setDisabled(false);
		btn_b007.setDisabled(false);
	}
	
	scwin.btn_search_onclick = function() {
		scwin.search();
	};
	
	
	scwin.btn_down_excel_onclick = function() {
		if (dlt_list.getTotalRow() > 6000)
		{
			com.alert("6000건 이상");
		} else {
			var now = com.getServerDateTime("yyyyMMdd");
			var name = '선집행전송_' + now + '.xlsx';
			
			var option = {
				    fileName : name,
				    removeColumns : "0,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44"
			};
			com.downloadGridExcel(grd, option);
		}
	};
	
	
	scwin.btn_forceful_completion_onclick = function() {

		// 강제완료 처리
		const data = scwin.getCheckedRowData(grd);
		if(data.length < 1){
			com.warn('체크된 행이 없습니다.');
			return;
		}
		
		if(!scwin.pre_forceful_completion()) return;
		
		com.confirm("강제완료 하시겠습니까?", function(ret){
			if(ret){
				dlt_send_list.setJSON(data);
				console.log(data);
				com.execute(sbm_forcefulCompletion);
			}
		});
	}
	
	scwin.sbm_forcefulCompletion_submitdone = function(e) {
		if(e.responseJSON.elData.success){
			com.alert('강제처리 완료');
		}else{
			com.error('강제처리 실패');
		}
		scwin.search();
	}
	
	
	scwin.btn_mail_send_onclick = function(e) {
		const data = scwin.getCheckedRowData(grd);
		if(data.length < 1){
			com.warn('체크된 행이 없습니다.');
			return;
		}
		
		const grdChkIdx = grd.getCheckedIndex('chk');
		
		for(let i = 0 ; i < grdChkIdx.length ; i++){
			const procState = dlt_list.getRowJSON(grdChkIdx[i]).proc_state;
			if (procState != "4") {
				com.warn("처리상태가 오류인 전송건만\nRCMS/POINT전송오류 메일 발송이 가능합니다.");
				return;
			}
		}
		
		if (confirm("선택 된 " + grdChkIdx.length + "건에 대하여 \nRCMS/POINT 전송오류 메일을 발송하시겠습니까?")) {
			scwin.mail_send();
		}
		
	}
	
	scwin.btn_print_onclick = function() {
		
		const grdChkIdx = grd.getCheckedIndex('chk');
		let reportArr = [];
		
		if(grdChkIdx.length < 1){
			com.warn('체크된 행이 없습니다.');
			return;
		}
		
		for(let i = 0 ; i < grdChkIdx.length ; i++){
			var erpSendNo = dlt_list.getRowJSON(grdChkIdx[i]).erp_send_no.trim(); // 그리드의 체크된 데이터중 첫번째 전송번호
			if (erpSendNo == '') {
				com.warn("전송번호 데이터가 없습니다.");
				warn
				return;
			}
			// SELECT * FROM fbaevidmngmt where evid_item_cd = 'F021'
			reportArr.push({
				ozrCode : "F021",
				param: "erp_send_no=" + erpSendNo
            });				
		}
		// 오즈 뷰어 팝업 호출
	    com.oz.openPopup(reportArr, true);
		//OZFlashOpen("/fin/fin/fnd/FinRcmsPaySend03.ozr", "FinRcmsPaySend", "Y", param);
	}
	
	
	scwin.mail_send = function() {
		
		const grdChkIdx = grd.getCheckedIndex('chk');
		const sendNm = com.getLoginInfo('cn');
		const uid = com.getLoginInfo('uid');
		const sender = sendNm + "<" + uid + "@kitech.re.kr" + ">"; // 발송자
		const templatePath = "fin/FinRcmsTransErrorSendMail"; // 메일 템플릿
		const mailSubject = "RCMS/POINT 전송 오류내역"; // 제목
		
		
		let templateVars = [];
		for(let i = 0 ; i < grdChkIdx.length ; i++){
			var expnsCd = dlt_list.getRowJSON(grdChkIdx[i]).expns_cd;
			var accntCd = dlt_list.getRowJSON(grdChkIdx[i]).accnt_cd;
			
			var toAddressVal = "";

			// 인건비, 간접비, 국내여비, 국외여비, 근거리출장비, 시험분석비 비용코드
			var expncdArr = ["111","113","121","122","123","124","125","173","201","203","216","219","220","271","272","273","450","451","452","491","492","493","494","495","496","497","510","520","530","540","20C","20D"];
			var w = expncdArr.length;
			var toVal = "N";

			for(var s=0; s<w; s++) {
				if (expncdArr[s] == expnsCd || accntCd == "51120026") {
					toVal = "Y";
				}
			}

			var lnkReqSeq = dlt_list.getRowJSON(grdChkIdx[i]).lnk_reg_seq;
			
			var slipiType = lnkReqSeq.substring(0, 3);

			if (slipiType == "610") { // 2019.02.13 원인행위미지급결의는 연구관리자 수신
				toVal = "Y";
			}
			
			// 수신자 결정
			if (toVal == "Y") {
				toAddressVal = dlt_list.getRowJSON(grdChkIdx[i]).bugt_ctrl_psn_email;
				
				//toAddressVal = "eipkimtw@kitech.re.kr"; //김태원
				//toAddressVal = "eipkimbo@kitech.re.kr"; //김병옥
				//toAddressVal = "mklee@kitech.re.kr"; //이민기
				//toAddressVal = "eipjinsy@kitech.re.kr"; //진소영
				//alert(toAddressVal);
				//return;
			} else {
				toAddressVal = dlt_list.getRowJSON(grdChkIdx[i]).wrte_psn_email;
				//toAddressVal = "eipkimtw@kitech.re.kr"; //김태원
				//toAddressVal = "eipkimbo@kitech.re.kr"; //김병옥
				//toAddressVal = "mklee@kitech.re.kr"; //이민기
				//alert(toAddressVal);
				//return;
			}

			var amt = dlt_list.getRowJSON(grdChkIdx[i]).unslip_amt;
			var unslipNo = dlt_list.getRowJSON(grdChkIdx[i]).lnk_reg_seq;
			var dateType1 = dlt_list.getRowJSON(grdChkIdx[i]).accnt_ymd;
			var dateType2 = dlt_list.getRowJSON(grdChkIdx[i]).cls_ymd;
			
			// 금액 3자리수 마다 콤마 적용 #,###,###
			if (amt > 999) {
				var len1, point, str1;

				amt = amt + "";
				point = amt.length % 3;
				len1 = amt.length;
				str1 = amt.substring(0, point);

				while (point < len1) {
					if (str1 != "") {
						str1 += ",";
					}

					str1 += amt.substring(point, point + 3);
					point += 3;
				}

				amt = str1;
			}

			var len2, str2, str3;

			// 결의번호-결의번호순번
			len2 = unslipNo.length;

			if (len2 > 10) {
				str2 = unslipNo.substring(0, 10);
				str3 = unslipNo.substring(10);
				unslipNo = str2 + "-" + str3;
			}

			var year1, month1, day1;

			// 날짜형식 YYYY-MM-DD
			if (dateType1.length == 8) {
				year1 = dateType1.substring(0, 4);
				month1 = dateType1.substring(4, 6);
				day1 = dateType1.substring(6, 8);
				dateType1 = year1 + "-" + month1 + "-" + day1;
			}

			var year2, month2, day2;

			// 날짜형식 YYYY-MM-DD
			if (dateType2.length == 8) {
				year2 = dateType2.substring(0, 4);
				month2 = dateType2.substring(4, 6);
				day2 = dateType2.substring(6, 8);
				dateType2 = year2 + "-" + month2 + "-" + day2;
			}
			
			
			templateVars.push({
				//toAddr: "eipleedh@kitech.re.kr",
				toAddr: toAddressVal, 	// 수신자 설정
				contentVar: {
					"@accnt_no@": dlt_list.getRowJSON(grdChkIdx[i]).accnt_no.trim(),
					"@accnt_rspns_nm@": dlt_list.getRowJSON(grdChkIdx[i]).accnt_rspns_nm.trim(),
					"@lnk_reg_seq@": unslipNo.trim(),
					"@accnt_ymd@": dateType1.trim(),
					"@accnt_cd@": dlt_list.getRowJSON(grdChkIdx[i]).accnt_cd.trim(),
					"@expns_cd@": expnsCd.trim(),
					"@unslip_amt@": amt.trim(),
					"@rmk_2@": dlt_list.getRowJSON(grdChkIdx[i]).rmk_2.trim(),
					"@paym_usag@": dlt_list.getRowJSON(grdChkIdx[i]).paym_usag.trim(),
					"@bz_exp_exctn_err_ctt@": dlt_list.getRowJSON(grdChkIdx[i]).bz_exp_exctn_err_ctt.trim(),
					"@cls_ymd@": dateType2.trim(),
				},
			});
			
		}
		com.mail.sendMessage({
			subject: mailSubject,
			content: '내용',
			fromAddr: sender,
			toAddr: '',	// 개별 발송의 경우 무시됨
			savesent: true,	// 보낸편지함 저장 여부 (default: true)
			onesend: false,	// 일괄발송 | 개별발송 (default: true)
			logging: true,	// 로그 저장 여부 (default: true)
			business: 'FIN',
			templatePath: templatePath,
			templateVars: templateVars,
		}, function() {
			com.alert("메일을 발송하였습니다.");
		});
		
	}
	
	scwin.btn_rcms_send_onclick = function(e) {
		
		// 전송 처리
		const data = scwin.getCheckedRowData(grd);
		if(data.length < 1){
			com.warn('체크된 행이 없습니다.');
			return;
		}
		
		var searchStr = "btn_send";
		var targetStr = e.target.id;
		var isSendYype = (searchStr !== "" && targetStr.includes(searchStr));
		
		isSendYype ? dma_search.set("send_type", "S") : dma_search.set("send_type", "E");
		
		if(!scwin.pre_save(isSendYype, data)) return;
		
		com.confirm("전송 하시겠습니까?", function(ret){
			if(ret){
					
				dma_search.set("lnk_reg_dt", com.getServerDateTime());
				dma_search.set("rcms_pay_clsf", "FDC020");
				dma_search.set("emp_nm", com.getLoginInfo('cn'));
				dma_search.set("tel_no", com.getLoginInfo('phone'));
				dma_search.set("rcv_bank", inputBankCd.getValue()); // 입금은행
				var recvAccntNo = inputBankaccntNo.getValue();
				dma_search.set("rcv_acct_no", recvAccntNo.replaceAll("-", "")); // 입금계좌
				dma_search.set("rcv_bank_nm", inputBankNm.getValue()); // 입금은행
				dma_search.set("owac_nm", inputDepStrNm.getValue()); // 한국생산기술연구원
				dma_search.set("erp_send_no", dlt_list.getRowJSON(0).erp_send_no);
			
				dlt_send_list.setJSON(data);
				console.log(data);
				com.execute(sbm_rcmsSend);
			}
		});
		
	}
	
	scwin.btn_rcms_cancel_onclick = function(e) {
		// 전송 취소 처리
		const data = scwin.getCheckedRowData(grd);
		if(data.length < 1){
			com.warn('체크된 행이 없습니다.');
			return;
		}
		
		if(!scwin.pre_delete()) return;
		
		com.confirm("전송 취소하시겠습니까?", function(ret){
			if(ret){
				
				dma_search.set("syspayno", com.getLoginInfo('sn'));
				
				dlt_send_list.setJSON(data);
				console.log(data);
				com.execute(sbm_rcmsSendCancel);
			}
		});
	};
	
	scwin.sbm_rcmsSend_submitdone = function(e) {
		const erpSendNo = e.responseJSON.elData.erp_send_no;
		dma_search.set("erp_send_no", erpSendNo);
		if(erpSendNo !== ""){
			com.alert('전송 완료');
			dma_search.set("proc_state", 0);
		}else{
			com.error('전송 실패');
		}
		scwin.search();
	}
	
	scwin.sbm_rcmsSendCancel_submitdone = function(e) {
		if(e.responseJSON.elData.success){
			com.alert('전송 취소 완료');
		}else{
			com.error('전송 취소 실패');
		}
		scwin.search();	
	}
	
	scwin.getCheckedRowData = function(grid) {
	    const checkedData = grid.getCheckedJSON('chk');
	    return checkedData;
	}
	
		
	scwin.selectHumBtn = function(data) {
		// 버튼(img)으로 팝업함수 바로 호출 처음 변수에 아무것도 넣지 않으면 최초 서브미션도 실행 안함. 
		data == "img" ? data = { empno : ""} : data = { empno : tb_empno.getValue(), nm : tb_empno.getValue(), work_clsf : "HAG010" };
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			dma_search.set("emp_no", ret.empno);
			dma_search.set("nm", ret.nm);
			dma_search.set("syspayno", ret.syspayno);
			dma_search.set("dept_cd", ret.dept_cd);
			dma_search.set("dept_nm", ret.dept_nm);
			
			if (com.getLoginInfo("uid").substring(0, 3) === 'eip') {
				tb_divsn_dept.setValue("");
				tb_divsn_dept_nm.setValue("");
			}
			else {
				dma_search.set("divsn_dept", ret.divsn_dept);
				dma_search.set("divsn_dept_nm", ret.divsn_dept_nm);
			}
		});
	};
	
	scwin.setSelfTransferReason = function() {
		const data = scwin.getCheckedRowData(grd);
		var frcTrscYn = selectFrcR.getValue();
		
		if(frcTrscYn == ''){
			com.warn('자계좌이체사유를 선택해주세요');
			return;
		}
		 
		if(data.length < 1){
			com.warn('체크된 행이 없습니다.');
			return;
		}
		
		var chkGrid = grd.getCheckedIndex('chk');
		
		for(var i=0; i < chkGrid.length; i++){
			var erpSendNo = grd.getRowJSON(chkGrid[i]).erp_send_no;
			var lnkRegSeq = grd.getRowJSON(chkGrid[i]).lnk_reg_seq;
			if (erpSendNo.trim() != '') {
				com.warn("이미 전송완료된 ("+(i+1)+")번째 결의번호("+lnkRegSeq+") 건은\n자계좌이체사유를 변경할 수 없습니다.");
				return;
			}
		}
		for(var i=0; i<chkGrid.length; i++){
			dlt_list.setCellData(chkGrid[i], "frc_trsc_yn", frcTrscYn);
		}
		com.warn('변경완료');
	}
	
	scwin.tb_empno_onkeypress = function(e) {
		if(event.keyCode == 13){
			scwin.selectHumBtn();
		}
	};
	
	scwin.btn_search_hum_onclick = function(e) {
		scwin.selectHumBtn("img");
	};
	
	// 근무자 빈값일경우 이름, 시스템사번 데이터셋 초기화
	scwin.tb_empno_onchange = function(info) {
		if(info.newValue == "") {	
			dma_search.set("nm", "");
			dma_search.set("syspayno", "");
		}
	};
	
	scwin.pre_save = function(isSendYype, data) {
		// 계좌정보
		if (inputBankaccntNo.getValue() == "") {
			com.warn("입금계좌번호를 입력하십시오");
			inputBankaccntNo.focus();
			return false;
		}

		if (inputBankCd.getValue() == "") {
			com.warn("은행코드를 입력하십시오");
			inputBankCd.focus();
			return false;
		}

		if (inputBankNm.getValue() == "") {
			com.warn("은행명을 입력하십시오");
			inputBankNm.focus();
			return false;
		}
		
		const grdChkIdx = grd.getCheckedIndex('chk');
		
		for(let i = 0 ; i < grdChkIdx.length ; i++){
			var procState = dlt_list.getRowJSON(grdChkIdx[i]).proc_state;
			var rch_exp_acct_no = dlt_list.getRowJSON(grdChkIdx[i]).rch_exp_acct_no;
			var instSbjtPrgrSt = dlt_list.getRowJSON(grdChkIdx[i]).inst_sbjt_prgr_st;
			var exctnLimtSt = dlt_list.getRowJSON(grdChkIdx[i]).exctn_limt_st;
			
			if (dlt_list.getRowJSON(grdChkIdx[i]).rcms_pay_unslip_no.trim() != "") {
				com.warn(grdChkIdx[i] + "번째행의 자료는 집행완료가 되었으므로 다시 전송할 수 없습니다.");
				grd.setCellChecked(grdChkIdx[i], 'chk', false);
				return false;
			}
			
			if (dlt_list.getRowJSON(grdChkIdx[i]).inst_sbjt_no.trim() == "") {
				com.warn(grdChkIdx[i] + "번째행의 자료는 RCMS기관과제번호가 존재하지 않습니다.");
				grd.setCellChecked(grdChkIdx[i], 'chk', false);
				return false;
			}

			if (dma_search.get("card_use_ex") == "FAJ005") {
				if (!rch_exp_acct_no.endsWith("473")) {
					com.warn(grdChkIdx[i] + "번째행의 자료는 입금계좌가 잘못 등록되었습니다. 확인바랍니다.");
					grd.setCellChecked(grdChkIdx[i], 'chk', false);
					return false;
				}
			} else {
				// 20140811 추가 481 및 733계좌만 point전송되도록 요청(재정운영실 구본준)
				// 481 point, 733 창보
				if (!rch_exp_acct_no.endsWith("481") && !rch_exp_acct_no.endsWith("733")) {
					com.warn(grdChkIdx[i] + "번째행의 자료는 입금계좌가 잘못 등록되었습니다. 확인바랍니다.");
					grd.setCellChecked(grdChkIdx[i], 'chk', false);
					return false;
				}
			}
			
			if (dlt_list.getRowJSON(grdChkIdx[i]).itxp_cd.trim() == "") {
				com.warn(grdChkIdx[i] + "번째행의 자료는 연계비목코드가 존재하지 않습니다.");
				grd.setCellChecked(grdChkIdx[i], 'chk', false);
				return false;
			}

			if ((instSbjtPrgrSt !="07") && exctnLimtSt == "0") { // 집행제한상태
				com.warn(grdChkIdx[i] + "번째행의 자료는 집행제한상태가 [정상집행]이 아니므로 전송할 수 없습니다.");
				return false;
			}
			
			
			if (parseInt(dlt_list.getRowJSON(grdChkIdx[i]).inst_totl_inst_amt) == 0) {//기관총사업금액
				com.warn(grdChkIdx[i] + "번째행의 자료는 기관총사업금액이 존재하지 않기때문에 전송할 수 없습니다.");
				return false;
			}

			if (procState != "9" && procState != "4") {
				com.warn(grdChkIdx[i] + "번째 행의 자료는 이미 전송처리가 되었습니다. 확인바랍니다.");
				grd.setCellChecked(grdChkIdx[i], 'chk', false);
				return false;
			}

			if (!isSendYype) {
				if (procState != "4") {
					com.warn("오류건에 대해서만 재전송을 할 수 있습니다.");
					return false;
				}
			} else if (isSendYype) {
				if (procState== "4") {
					com.warn("오류인 경우에는 재전송을 해야합니다.");
					return false;
				}
			}
		}
		return true;
	}
	
	scwin.pre_delete = function() {
	
		const grdChkIdx = grd.getCheckedIndex('chk');
		var erpSendNo = dlt_list.getRowJSON(grdChkIdx[0]).erp_send_no // 전송번호

		for(let i = 0 ; i < grdChkIdx.length ; i++){
			var procState = dlt_list.getRowJSON(grdChkIdx[i]).proc_state; // 사업비집행처리상태

			// 결의서 취소 여부 체크
			if (procState != "0" && procState != "4") {
				com.warn(grdChkIdx[i] + "번째 행의 자료는 전송중 또는 전송완료이므로\n 취소할 수 없습니다.");
				return false;
			}
			
			if (dlt_list.getRowJSON(grdChkIdx[i]).erp_send_no != erpSendNo) {
				com.warn("같은 전송번호에 대해서만 취소할 수 있습니다.");
				return false;
			}
		}
		return true;
	}
	
	scwin.pre_forceful_completion = function() {
		const grdChkIdx = grd.getCheckedIndex('chk');
		
		if (grdChkIdx.length == 1) {
			var procState = dlt_list.getRowJSON(grdChkIdx[0]).proc_state;
			if (procState != "9") {
				com.warn("미전송건만 가능합니다.");
				return false;
			}
			var unslipNoP = dlt_list.getRowJSON(grdChkIdx[0]).unslip_no;
			var unslipOdrP = dlt_list.getRowJSON(grdChkIdx[0]).unslip_odr;
			return true;
		} else {
			com.warn("단건처리만 가능합니다. 1건만 선택 부탁드립니다.");
			return false;
		}				
	}
	
	scwin.grd_oncellclick = function(row,col,colId) {
		if(colId === "lnk_reg_seq"){
			com.biz.openEvidWindow(grd.getCellData(row, 'lnk_reg_seq').substring(0, 10), com.getLoginInfo('sn'));
		}
		if(colId === "chk") scwin.grd_balance_calc();
	}
	
	scwin.grd_header_oncellclick = function(headerId) {
		if(headerId === 'hChk') scwin.grd_balance_pre_calc();
	}
	
	scwin.grd_balance_pre_calc = function() {
		const chkAllCnt = parseInt(inputChkAll.getValue());
		const grdLength =  grd.getDataLength();
		
		if(chkAllCnt > 0){
			for(let i = chkAllCnt ; i < grdLength ; i++){
				grd.setCellChecked(i, 'chk', false)
			}
		}
		scwin.grd_balance_calc();		
	}
	
	scwin.grd_balance_calc = function() {
		
		const chkGrid = grd.getCheckedIndex('chk');	
		
		let sumBalance = 0;
		inputTotlCnt.setValue(chkGrid.length < 1 ? "" : chkGrid.length);
		for(let i=0; i < chkGrid.length ; i++){
			sumBalance += parseInt(grd.getRowJSON(chkGrid[i]).unslip_amt);				
		}
		inputSumBalance.setValue(sumBalance < 1 ? "" : sumBalance);		
	}
	
	scwin.ipt_accnt_ontextimagekeydown = function(event) {
	    if(event.keyCode == 13){
	        scwin.ipt_accnt_ontextimageclick();
	    }
	};
	
	scwin.ipt_accnt_ontextimageclick = function() {
		var data = {
			accnt_no : inputAccntNo.getValue(),
			//cls_ymd : ica_end_dt.getValue(),
			ref_yn : "Y"
		};			
		
		com.pop.open(com.pop.TYPE.ACNNO, data, function(ret) {		
			dma_search.set("accnt_no", ret.accnt_no)
		});
	}
	
	
	scwin.btn_down_error_excel_onclick = function() {
		com.confirm("오류내역 엑셀 다운로드 하시겠습니까?", function(ret){
			if(ret){
				dma_error_search.set("lnk_reg_dt_st", dma_search.get("accnt_ymd_st"));
				dma_error_search.set("lnk_reg_dt_ed", dma_search.get("accnt_ymd_ed"));
				
				com.execute(sbm_selectSearchErrorList, {
					successCallback : function(e) {
						if(dlt_error_list.getTotalRow() > 0) {
						
							var now = com.getServerDateTime("yyyyMMdd");
							var name = '선집행전송_오류내역_' + now + '.xlsx';
							var option = {
								fileName : name
							};
							com.downloadGridExcel(grd_error, option);
							
						}else{
							com.warn("결과가 없습니다.")
						}		
					}
				});
			}
		});
	}
		
	
	]]></script>
   	<style><![CDATA[
   		.data-w-f772 .df_tit{padding:0 0 0 15px;font-size:12px;line-height:24px;font-weight:bold;background:url(/cm/images/sample/bg_df_tit_ico.png) no-repeat 0 7px}
   		.data-w-f772 .searchSection{display: flex;min-height: 60px;}
   		.data-w-f772 .btn-box{display: flex;justify-content: flex-end;width: 300px;flex-wrap: wrap;align-items: flex-end;align-content: flex-end;}
   		.data-w-f772 .btn.search{margin:5px 2px}
   		.data-w-f772 .schbox{display:flex;flex-wrap: wrap;width:100% !important}
   		.data-w-f772 .schboxDiv{display: flex;align-items: center;margin: 5px 0 5px 0;min-width: 280px;justify-content: flex-end;}
   		.data-w-f772 .schboxDiv .label{font-weight: bold;font-size: 12px;height: 100%;display: inline-flex;align-items: center;text-align: right;margin-right: 5px;min-width: 95px;justify-content: flex-end;border: 0;padding-left: 10px;}
   		.data-w-f772 .schboxDiv .content{display: inline-flex;width: 210px;}
   		.data-w-f772 .schboxDiv .content input{width:100%}
   		.data-w-f772 .schboxDiv.sub{height: 15px;}
   		.data-w-f772 .schboxDiv.sub .label.subject{border: 1px solid #9d9d9d;max-width: 70px;min-width: 50px;width: 100%;padding: 0;margin: 0;align-items: center;justify-content: center;height: 22px;}
   		.data-w-f772 .schboxDiv.sub .label.subject.back{background-color: white;}
   		.data-w-f772 label.w2checkbox_label {vertical-align: text-bottom;}
   		.data-w-f772 .titleSection{margin-top:5px}
   	]]></style>
    </head>
    <body ev:onpageload="scwin.onpageload">
    		<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="" class="pageWrap data-w-f772" style="height: calc(100% - 51px);">
    		<xf:group style="padding-left: 0;" id="" class="searchSection">
    			<xf:group id="" class="schbox">
    			
    				<!-- 확정일자 -->
    				<xf:group tagname="div" style="" class="schboxDiv">
	    				<w2:textbox tagname="p" class="label" label="확정일자"></w2:textbox>
		    			<xf:group tagname="p" id="" class="">
							<w2:inputCalendar footerDiv="false" rightAlign="false" focusOnDateSelect="false" style="" id="start_ymd"
								class="inpcal" renderDiv="true" calendarValueType="yearMonthDate" title="시작일"
								ref="data:dma_search.accnt_ymd_st">
							</w2:inputCalendar>
							<w2:textbox tagname="span" style="width: 10px;text-align: center;" label="~" class="dash"></w2:textbox>
							<w2:inputCalendar footerDiv="false" rightAlign="false" focusOnDateSelect="false" style="" id="cls_ymd"
								class="inpcal" renderDiv="true" calendarValueType="yearMonthDate" title="종료일"
								ref="data:dma_search.accnt_ymd_ed">
							</w2:inputCalendar>
						</xf:group>
					</xf:group>
					<!-- 확정일자 -->
					
					<!-- RCMS/POINT -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" label="RCMS/POINT" ></w2:textbox>
						<xf:select1 ref="data:dma_search.card_use_ex" submenuSize="auto" appearance="minimal" disabledClass="w2selectbox_disabled"
							disabled="false" style="width:210px;" id="" visibleRowNum="10" class="sel" direction="auto"
							title="RCMS/POINT">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[RCMS]]></xf:label>
									<xf:value>FAJ005</xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[POINT]]></xf:label>
									<xf:value>FAJ004</xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
					</xf:group>
					<!-- 알림유형 -->
					
					<!-- 확정결의번호 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" id="" label="확정결의번호" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:input adjustMaxLength="false" style="width:210px" class="" title="확정결의번호" ref="data:dma_search.slip_no" ></xf:input>
						</xf:group>
					</xf:group>
					<!-- 확정결의번호 -->
					
					<!-- 확정결의서상태 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" label="확정결의서상태" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:select1 ref="data:dma_search.sel_apr_state" submenuSize="auto" appearance="minimal" disabledClass="w2selectbox_disabled"
								disabled="false" style="width:210px;" id="approvedResolutionState" visibleRowNum="10" class="sel" direction="auto"
								title="확정결의서상태">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[-전체-]]></xf:label>
										<xf:value></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[저장중]]></xf:label>
										<xf:value>XAD005</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[진행중]]></xf:label>
										<xf:value>XAD020</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[결재완료]]></xf:label>
										<xf:value>XAD100</xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
						</xf:group>
					</xf:group>
					<!-- 확정결의서상태 -->
					
					<!-- 계정번호 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" id="" label="계정번호" ></w2:textbox>
						<xf:group tagname="p" style="" class="content">
							<xf:input id="inputAccntNo" adjustMaxLength="false" style="" class="" title="계정번호" ref="data:dma_search.accnt_no" ev:onkeydown="scwin.ipt_accnt_ontextimagekeydown"></xf:input>
							<xf:image src="/cm/images/sample/btn_tbsearch02.png" style="width: 22px;height: 22px;" id="" ev:onclick="scwin.ipt_accnt_ontextimageclick"></xf:image>
						</xf:group>
					</xf:group>
					<!-- 계정번호 -->
					
					<!-- 처리상태 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" label="처리상태" ></w2:textbox>
						<xf:select1 ref="data:dma_search.proc_state" submenuSize="auto" appearance="minimal" disabledClass="w2selectbox_disabled"
							disabled="false" style="width:210px;" id="" visibleRowNum="10" class="sel" direction="auto"
							title="처리상태">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[-전체-]]></xf:label>
									<xf:value></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[미전송]]></xf:label>
									<xf:value>9</xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[전송중]]></xf:label>
									<xf:value>0</xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[RCMS집행처리중]]></xf:label>
									<xf:value>2</xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[정상완료]]></xf:label>
									<xf:value>3</xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[오류완료]]></xf:label>
									<xf:value>4</xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
					</xf:group>
					<!-- 처리상태 -->				
					
					<!-- 전송번호 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" id="" label="전송번호" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:input adjustMaxLength="false" style="width:210px" class="" title="전송번호" ref="data:dma_search.erp_send_no" ></xf:input>
						</xf:group>
					</xf:group>
					<!-- 전송번호 -->
					
					<!-- 회계코드 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" id="" label="회계코드" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:input adjustMaxLength="false" style="width:210px" class="" title="회계코드" ref="data:dma_search.accnt_cd" ></xf:input>
						</xf:group>
					</xf:group>
					<!-- 회계코드 -->
					
					<!-- 비용코드 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" id="" label="비용코드" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:input adjustMaxLength="false" style="width:210px" class="" title="비용코드" ref="data:dma_search.expns_cd" ></xf:input>
						</xf:group>
					</xf:group>
					<!-- 비용코드 -->
					
					<!-- 정상수행상태 -->
					<xf:group tagname="div" style="" class="schboxDiv">
						<w2:textbox tagname="p" class="label" label="정상수행상태" ></w2:textbox>
							<xf:select1 appearance="full" class="radioGroup" id="" ref="data:dma_search.sbjt_state"
							 renderType="radiogroup" rows="" selectedIndex="0" style="width:210px;text-align:center" title="정상수행상태">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[Yes]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[No]]></xf:label>
										<xf:value><![CDATA[N]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
					</xf:group>
					<!-- 정상수행상태 -->					
					
					<!-- 제외항목 -->
					<xf:group tagname="div" style="" class="schboxDiv">
							<w2:textbox tagname="p" class="label" id="" label="제외항목" ></w2:textbox>
							<xf:select appearance="full" class="chkGroup" cols="" id="checkboxExept" renderType="checkboxgroup" rows="" selectedindex="-1" style="width: 210px;text-align:left">
								<xf:choices>
									<xf:item>
										<xf:label>인건비</xf:label>
										<xf:value><![CDATA[1]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label>간접비</xf:label>
										<xf:value><![CDATA[2]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
					</xf:group>
					<!-- 제외항목 -->
					
					<!-- 원인행위미지급금 반납금조회 -->
					<xf:group tagname="div" style="" class="schboxDiv">
							<xf:select appearance="full" class="chkGroup" cols="" id="checkboxExept2" renderType="checkboxgroup" rows="" selectedindex="-1" style="width: 160px;text-align:center">
								<xf:choices>
									<xf:item>
										<xf:label>원인행위미지급금</xf:label>
										<xf:value><![CDATA[610]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
							
							<xf:select appearance="full" class="chkGroup" cols="" id="refundAmountCheck"
		    								ref="data:dma_search.isRefund" renderType="checkboxgroup" rows="" selectedindex="-1" style="width: 150px;text-align:center">
								<xf:choices>
									<xf:item>
										<xf:label>반납금조회</xf:label>
										<xf:value><![CDATA[true]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
					</xf:group>
					<!-- 원인행위미지급금 반납금조회 -->

					
    			</xf:group>
    			
    			<!-- 버튼박스 -->
				<xf:group id="buttonGroupContainer" class="btn-box">
				
					<!-- 조회버튼 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_search_onclick" id="btn_search" style="" type="button">
	    					<xf:label><![CDATA[조회]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 조회버튼 -->
					
					<!-- 전송 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_rcms_send_onclick" id="btn_send" style="" type="button" userData1="S">
	    					<xf:label><![CDATA[전송]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 전송 -->
					
					<!-- 전송취소 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_rcms_cancel_onclick" id="btn_b001" style="" type="button">
	    					<xf:label><![CDATA[전송취소]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 전송취소 -->
					
					<!-- 재전송 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_rcms_send_onclick" id="btn_b002" style="" type="button" userData1="E">
	    					<xf:label><![CDATA[재전송]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 재전송 -->
					
					<!-- 전송오류 메일발송 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_mail_send_onclick" id="btn_b003" style="" type="button">
	    					<xf:label><![CDATA[전송오류 메일발송]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 전송오류 메일발송 -->
					
					<!-- 강제완료처리 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_forceful_completion_onclick" id="btn_b004" style="" type="button">
	    					<xf:label><![CDATA[강제완료처리]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 강제완료처리 -->
					
					<!-- 인쇄 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_print_onclick" id="btn_b005" style="" type="button">
	    					<xf:label><![CDATA[인쇄]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 인쇄 -->
					
					<!-- 엑셀 -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_down_excel_onclick" id="btn_b006" style="" type="button">
	    					<xf:label><![CDATA[엑셀]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 엑셀 -->
					
					<!-- 엑셀(오류내역) -->
					<xf:group tagname="div">
						<xf:trigger class="btn search" ev:onclick="scwin.btn_down_error_excel_onclick" id="btn_b007" style="" type="button">
	    					<xf:label><![CDATA[엑셀(오류내역)]]></xf:label>
	    				</xf:trigger>	
					</xf:group>
					<!-- 엑셀(오류내역) -->
					
				</xf:group>
				<!-- 버튼박스 -->

    		</xf:group>
    		
    		<xf:group class="searchSection sub" style="margin-top: 4px;border: 1px solid #c2c7d5;min-height: 10px;padding: 5px 0 5px 0;">
    			<xf:group class="schbox">
    			
    				<!-- 결과선택 -->
					<xf:group tagname="div" style="" class="schboxDiv sub">
						<w2:textbox tagname="p" class="label" id="" label="결과선택" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:input id="inputChkAll" style="width:60px;text-align:right" title="" ref="" dataType="number"></xf:input>
							<w2:textbox tagname="p" class="label subject back" id="" label="합계" ></w2:textbox>
							<xf:input id="inputSumBalance" style="width:110px;text-align:right" title="" ref="" dataType="number" displayFormat="#,###"></xf:input>
							<xf:input id="inputTotlCnt" style="width:60px;text-align:right" title="" ref="" dataType="number"></xf:input>
						</xf:group>
					</xf:group>
					<!-- 결과선택 -->    				
					
					<!-- 자계좌이체사유 -->
					<xf:group tagname="div" style="" class="schboxDiv sub">
						<w2:textbox tagname="p" class="label" id="" label="자계좌이체사유" ></w2:textbox>
						<xf:group tagname="p" style="" class="">
							<xf:select1 ref="" submenuSize="auto" appearance="minimal" disabledClass="w2selectbox_disabled"
								disabled="false" style="width:150px;" id="selectFrcR" visibleRowNum="10" class="sel" direction="auto"
								title="자계좌이체사유" chooseOption="true" chooseOptionLabel="-선택-">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[허용비목]]></xf:label>
										<xf:value>1</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[외자구매]]></xf:label>
										<xf:value>2</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[지로직접납부]]></xf:label>
										<xf:value>3</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[연구비잔액부족]]></xf:label>
										<xf:value>4</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[지체보상금제외이체]]></xf:label>
										<xf:value>5</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[협약전사용금액]]></xf:label>
										<xf:value>6</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[연구지원전문가인건비]]></xf:label>
										<xf:value>8</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[타계좌이체]]></xf:label>
										<xf:value>N</xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[자계좌이체승인]]></xf:label>
										<xf:value>7</xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
							<xf:trigger class="btn search" ev:onclick="scwin.setSelfTransferReason" id="btn_s001" style="" type="button">
		    					<xf:label><![CDATA[적용]]></xf:label>
		    				</xf:trigger>
						</xf:group>
					</xf:group>
					<!-- 자계좌이체사유 -->
					
					
					<!-- 입금계좌 -->
					<xf:group tagname="div" style="" class="schboxDiv sub">
						<xf:group tagname="p" style="" class="">
							<w2:span class="bul_req" id="" label="[필수입력항목]" style="position: relative;left: 12px;"></w2:span>
							<w2:textbox tagname="p" class="label subject back" id="" label="입금계좌" ></w2:textbox>
							<xf:input id="inputBankaccntNo" style="width:130px" ref="" dataType="text" disabled="true"></xf:input>
							<w2:textbox tagname="p" id="inputBankNm" class="label subject"></w2:textbox>
							<w2:textbox tagname="p" id="inputBankCd" class="label subject" style="display:none"></w2:textbox>
							<w2:textbox tagname="p" id="inputDepStrNm" class="label subject" style="display:none"></w2:textbox>
						</xf:group>
					</xf:group>
					<!-- 입금계좌 -->

    			</xf:group>
   			</xf:group>
    		
    		<xf:group style="" id="" class="titleSection">
    			<xf:group class="le" id="" style="">
    				<xf:group class="result" id="">
    					<w2:span id="" label="*조회결과 " style=""></w2:span>
    					<w2:span class="numtotal" id="tbx_result" label="0" style=""></w2:span>
    					<w2:span id="" label="건" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		
    		<xf:group id="" style="height: calc(100% - 25vh);">
    		<w2:gridView scrollByColumnAdaptive="false" rowNumVisible="true" selectedRowColor="#fbf2cd"
    			rowNumHeaderValue="순번" scrollByColumn="false" defaultCellHeight="25" rowStatusHeaderValue="상태" noResultMessage="조회 결과가 없습니다."
    			rowNumBackgroundColor="#fff" noResultMessageClass="noResult" rowStatusVisible="false" selectedCellColor="#fbf2cd" dataList="data:dlt_list" evenRowBackgroundColor="#f7faff" style="height: 100%" id="grd" class="grid" rowMouseOverColor="#e7f0fb" summaryAuto="true" ev:oncellclick="scwin.grd_oncellclick" fixedRow="0" filterFocusMode="outfocus" sortEvent="onclick" sortable="true" fixedColumn="3" overflowX="scroll" ev:onheaderclick="scwin.grd_header_oncellclick">
    			<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
    			<w2:header style="" id="header1">
    				<w2:row style="" id="row1">
    					<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="hChk" inputType="checkbox"
    						style="" value="chk" width="37" sortable="false">
    					</w2:column>
    					<w2:column width="100" inputType="text" id="column01" value="계정번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column02" value="결의번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column03" value="전송번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column04" value="처리상태" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column05" value="집행일자" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column06" value="연구과제번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column07" value="연구비계좌번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column08" value="회계코드" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column09" value="회계코드명" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column10" value="비용코드" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column11" value="연계비목코드" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column12" value="원장금액" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column13" value="대체금액" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column14" value="전송금액" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column15" value="거래처" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column16" value="적요" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column17" value="결의확정번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column18" value="확정일자" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column19" value="자계좌이체사유" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column20" value="기타증빙사유" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column21" value="공급자사업자번호" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column22" value="사업비집행오류내용" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column23" value="계정책임자" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column24" value="연구관리자" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column25" value="작성자" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column26" value="과제진행상태" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column27" value="집행제한상태" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column28" value="계정종료일" displayMode="label"></w2:column>
                        <w2:column width="100" inputType="text" id="column29" value="계산서번호" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody style="" id="gBody1">
    				<w2:row style="" id="row2">
   						<w2:column id="chk" inputType="checkbox"></w2:column>
    					<w2:column inputType="text" id="accnt_no" readOnly="true"></w2:column>
    					<w2:column inputType="link" id="lnk_reg_seq" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="erp_send_no" readOnly="true"></w2:column>
    					<w2:column inputType="select" id="proc_state" readOnly="true">
   							<w2:choices>
								<w2:item>
									<w2:label>미전송</w2:label>
									<w2:value>9</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>전송중</w2:label>
									<w2:value>0</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>RCMS집행처리중</w2:label>
									<w2:value>2</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>정상완료</w2:label>
									<w2:value>3</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>오류완료</w2:label>
									<w2:value>4</w2:value>
								</w2:item>
							</w2:choices>
    					</w2:column>
    					<w2:column inputType="text" id="exctn_exec_dt" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="inst_sbjt_no" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="rch_exp_acct_no" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="accnt_cd" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="accnt_cd_abbr" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="expns_cd" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="itxp_cd" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="unslip_amt" readOnly="true" displayFormat="#,###" dataType="number"></w2:column>
    					<w2:column inputType="text" id="trans_amt" readOnly="false" displayFormat="#,###" dataType="number"></w2:column>
    					<w2:column inputType="text" id="trns_amt" readOnly="true" displayFormat="#,###" dataType="number"></w2:column>
    					<w2:column inputType="text" id="rmk_2" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="paym_usag" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="slip_no_odr" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="accnt_ymd" readOnly="true"></w2:column>
    					<w2:column inputType="select" id="frc_trsc_yn" readOnly="false">
    						<w2:choices>
								<w2:item>
									<w2:label>허용비목</w2:label>
									<w2:value>1</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>외자구매</w2:label>
									<w2:value>2</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>지로직접납부</w2:label>
									<w2:value>3</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>연구비잔액부족</w2:label>
									<w2:value>4</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>지체보상금제외이체</w2:label>
									<w2:value>5</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>협약전사용금액</w2:label>
									<w2:value>6</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>연구지원전문가인건비</w2:label>
									<w2:value>8</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>타계좌이체</w2:label>
									<w2:value>N</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>자계좌이체승인</w2:label>
									<w2:value>7</w2:value>
								</w2:item>
							</w2:choices>
    					</w2:column>
    					<w2:column inputType="select" id="etc_evdc_rsn_cd" readOnly="false">
	    					 <w2:choices>
		    					<w2:itemset nodeset="data:dlt_etc_evdc_rsn_cd_list">
		    						<w2:label ref="label"></w2:label>
		    						<w2:value ref="value"></w2:value>
		    					</w2:itemset>
		    				</w2:choices>
    					</w2:column>
    					<w2:column inputType="text" id="splr_bz_reg_no" readOnly="false"></w2:column>
    					<w2:column inputType="text" id="bz_exp_exctn_err_ctt" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="accnt_rspns_nm" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="bugt_ctrl_psn_nm" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="wrte_psn_nm" readOnly="true"></w2:column>
    					<w2:column inputType="select" id="inst_sbjt_prgr_st" readOnly="true">
    						<w2:choices>
								<w2:item>
									<w2:label>협약</w2:label>
									<w2:value>05</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>중단</w2:label>
									<w2:value>06</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>수행</w2:label>
									<w2:value>07</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>과제평가</w2:label>
									<w2:value>08</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>종료</w2:label>
									<w2:value>09</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>정산</w2:label>
									<w2:value>10</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>사후관리</w2:label>
									<w2:value>11</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>부담금입금대기</w2:label>
									<w2:value>12</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>출연금입금대기</w2:label>
									<w2:value>13</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>기타</w2:label>
									<w2:value>14</w2:value>
								</w2:item>
							</w2:choices>
    					</w2:column>
    					<w2:column inputType="select" id="exctn_limt_st" readOnly="true">
    						<w2:choices>
								<w2:item>
									<w2:label>정상집행</w2:label>
									<w2:value>1</w2:value>
								</w2:item>
								<w2:item>
									<w2:label>취소</w2:label>
									<w2:value>0</w2:value>
								</w2:item>
							</w2:choices>
    					</w2:column>
    					<w2:column inputType="text" id="cls_ymd" readOnly="true"></w2:column>
    					<w2:column inputType="text" id="bill_no" readOnly="false"></w2:column>
   					
						<w2:column inputType="text" hidden="true" id="btnEvid"></w2:column>
						<w2:column inputType="text" hidden="true" id="trans_unslip_no"></w2:column>
						<w2:column inputType="text" hidden="true" id="accnt_rspns_email"></w2:column>
						<w2:column inputType="text" hidden="true" id="bugt_ctrl_psn_email"></w2:column>
						<w2:column inputType="text" hidden="true" id="wrte_psn_emaill"></w2:column>
						<w2:column inputType="text" hidden="true" id="inst_totl_inst_amt"></w2:column>
						<w2:column inputType="text" hidden="true" id="rcms_pay_clsf"></w2:column>
						<w2:column inputType="text" hidden="true" id="prj_ymd_yn"></w2:column>
						<w2:column inputType="text" hidden="true" id="rcms_pay_unslip_no"></w2:column>
						<w2:column inputType="text" hidden="true" id="lnk_reg_dt"></w2:column>
						<w2:column inputType="text" hidden="true" id="evid_cd"></w2:column>
						<w2:column inputType="text" hidden="true" id="req_no"></w2:column>
						<w2:column inputType="text" hidden="true" id="pms_id"></w2:column>
						<w2:column inputType="text" hidden="true" id="unslip_no"></w2:column>
						<w2:column inputType="text" hidden="true" id="unslip_odr"></w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
    		</xf:group>
    		
    		
    		<w2:gridView id="grd_error" scrollByColumnAdaptive="false" rowNumVisible="true" selectedRowColor="#fbf2cd"
    			rowNumHeaderValue="순번" scrollByColumn="false" defaultCellHeight="25" rowStatusHeaderValue="상태" noResultMessage="조회 결과가 없습니다."
    			rowNumBackgroundColor="#fff" noResultMessageClass="noResult" rowStatusVisible="false" selectedCellColor="#fbf2cd" dataList="data:dlt_error_list" evenRowBackgroundColor="#f7faff" style="display:none;height: 100%"
    			class="grid" rowMouseOverColor="#e7f0fb" summaryAuto="true" fixedRow="0" filterFocusMode="outfocus" sortEvent="onclick" sortable="true" fixedColumn="3" overflowX="scroll">
    			<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
    			<w2:header style="" id="header1">
    				<w2:row style="" id="row1">
    					<w2:column width="100" inputType="text" id="column01" value="rcms_pay_clsf" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column02" value="proc_state" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column03" value="slip_no_odr" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column04" value="accnt_no" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column05" value="accnt_cd" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column06" value="accnt_cd_abbr" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column07" value="trns_amt" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column08" value="rmk_2" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column09" value="rmk_1" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column10" value="accnt_ymd" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column11" value="err_msg" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column12" value="unslip_no" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column13" value="accnt_rspns" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column14" value="dept_cd_nm" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column15" value="accnt_rspns_nm" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column16" value="lnk_reg_dt" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column17" value="fomat_unit" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column18" value="bugt_ctrl_psn" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column19" value="ext_no" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" id="column20" value="column01" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody style="" id="gBody1">
    				<w2:row style="" id="row2">
   						<w2:column id="rcms_pay_clsf" inputType="text" readOnly="true"></w2:column>
						<w2:column id="proc_state" inputType="text" readOnly="true"></w2:column>
						<w2:column id="slip_no_odr" inputType="text" readOnly="true"></w2:column>
						<w2:column id="accnt_no" inputType="text" readOnly="true"></w2:column>
						<w2:column id="accnt_cd" inputType="text" readOnly="true"></w2:column>
						<w2:column id="accnt_cd_abbr" inputType="text" readOnly="true"></w2:column>
						<w2:column id="trns_amt" inputType="text" readOnly="true"></w2:column>
						<w2:column id="rmk_2" inputType="text" readOnly="true"></w2:column>
						<w2:column id="rmk_1" inputType="text" readOnly="true"></w2:column>
						<w2:column id="accnt_ymd" inputType="text" readOnly="true"></w2:column>
						<w2:column id="err_msg" inputType="text" readOnly="true"></w2:column>
						<w2:column id="unslip_no" inputType="text" readOnly="true"></w2:column>
						<w2:column id="accnt_rspns" inputType="text" readOnly="true"></w2:column>
						<w2:column id="dept_cd_nm" inputType="text" readOnly="true"></w2:column>
						<w2:column id="accnt_rspns_nm" inputType="text" readOnly="true"></w2:column>
						<w2:column id="lnk_reg_dt" inputType="text" readOnly="true"></w2:column>
						<w2:column id="fomat_unit" inputType="text" readOnly="true"></w2:column>
						<w2:column id="bugt_ctrl_psn" inputType="text" readOnly="true"></w2:column>
						<w2:column id="ext_no" inputType="text" readOnly="true"></w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
   		
    		
    	</xf:group>
    </body>
</html>
