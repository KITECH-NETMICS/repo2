<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="지식재산권 메일발송 팝업" meta_programDesc="" meta_author="이대훈" meta_date="2023.10.26.">
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate/>
		<xf:model>
			<xf:instance>
				<data
					xmlns=""/>
				</xf:instance>
				<w2:dataCollection baseNode="map">
					<w2:dataMap baseNode="map" id="dma_search" style="">
						<w2:keyInfo>
							<w2:key dataType="text" id="req_no" name="req_no"></w2:key>
							<w2:key dataType="text" id="mngmt_no" name="mngmt_no"></w2:key>
						</w2:keyInfo>
					</w2:dataMap>
					<w2:dataMap baseNode="map" id="dma_mst_info">
					  <w2:keyInfo>
					       <w2:key id="req_no" name="req_no" dataType="text"></w2:key>
					       <w2:key id="mngmt_no" name="mngmt_no" dataType="text"></w2:key>
					       <w2:key id="invnt_krn_nm" name="invnt_krn_nm" dataType="text"></w2:key>
					       <w2:key id="patofic_mng_no" name="patofic_mng_no" dataType="text"></w2:key>
					       <w2:key id="pat_clsf_nm" name="pat_clsf_nm" dataType="text"></w2:key>
					       <w2:key id="smitapp_natn_cd" name="smitapp_natn_cd" dataType="text"></w2:key>
					       <w2:key id="smitapp_natn_nm" name="smitapp_natn_nm" dataType="text"></w2:key>
					       <w2:key id="tech_clsf_nm" name="tech_clsf_nm" dataType="text"></w2:key>
					       <w2:key id="smitapp_no" name="smitapp_no" dataType="text"></w2:key>
					       <w2:key id="smitapp_ymd" name="smitapp_ymd" dataType="text"></w2:key>
					 </w2:keyInfo>
					</w2:dataMap>
					<w2:dataList baseNode="list" repeatNode="map" id="dlt_user_list" saveRemovedData="true">
					  <w2:columnInfo>
					       <w2:column id="mngmt_no" name="mngmt_no" dataType="text"></w2:column>
					       <w2:column id="target_type" name="target_type" dataType="text"></w2:column>
					       <w2:column id="syspayno" name="syspayno" dataType="text"></w2:column>
					       <w2:column id="empno" name="empno" dataType="text"></w2:column>
					       <w2:column id="nm" name="nm" dataType="text"></w2:column>
					       <w2:column id="dept_cd" name="dept_cd" dataType="text"></w2:column>
					       <w2:column id="mobile" name="mobile" dataType="text"></w2:column>
					       <w2:column id="email" name="email" dataType="text"></w2:column>
					       <w2:column id="dept_nm" name="dept_nm" dataType="text"></w2:column>
					  </w2:columnInfo>
					</w2:dataList>
					<w2:dataMap baseNode="map" id="dma_mail_info">
					  <w2:keyInfo>
					       <w2:key id="mail_id" name="mail_id" dataType="text"></w2:key>
					       <w2:key id="regst_syspayno" name="regst_syspayno" dataType="text"></w2:key>
					       <w2:key id="send_addr" name="send_addr" dataType="text"></w2:key>
					       <w2:key id="send_name" name="send_name" dataType="text"></w2:key>
					       <w2:key id="mail_subject" name="메일 제목" dataType="text"></w2:key>
					       <w2:key id="req_no" name="req_no" dataType="text"></w2:key>
					       <w2:key id="mngmt_no" name="mngmt_no" dataType="text"></w2:key>
					       <w2:key id="mail_contents" name="메일 내용" dataType="text"></w2:key>
					 </w2:keyInfo>
					</w2:dataMap>
					<w2:dataList baseNode="list" repeatNode="map" id="dlt_receive_list" saveRemovedData="true">
					  <w2:columnInfo>
					  	   <w2:column id="chk" name="chk" dataType="text"></w2:column>
					  	   <w2:column id="dept_gb" name="dept_gb" dataType="text"></w2:column>
					  	   <w2:column id="mobile" name="mobile" dataType="text"></w2:column>
					  	   <w2:column id="dept_nm" name="dept_nm" dataType="text"></w2:column>
					       <w2:column id="mail_id" name="mail_id" dataType="text"></w2:column>
					       <w2:column id="recv_type" name="recv_type" dataType="text"></w2:column>
					       <w2:column id="email" name="email" dataType="text"></w2:column>
					       <w2:column id="nm" name="nm" dataType="text"></w2:column>
					       <w2:column id="syspayno" name="syspayno" dataType="text"></w2:column>
					       <w2:column id="regst_syspayno" name="regst_syspayno" dataType="text"></w2:column>
						   <w2:column id="mngmt_no" name="mngmt_no" dataType="text"></w2:column>
					       <w2:column id="target_type" name="target_type" dataType="text"></w2:column>
					       <w2:column id="empno" name="empno" dataType="text"></w2:column>
					       <w2:column id="dept_cd" name="dept_cd" dataType="text"></w2:column>

					  </w2:columnInfo>
					</w2:dataList>
					<w2:dataList baseNode="list" repeatNode="map" id="dlt_reference_list" saveRemovedData="true">
					  <w2:columnInfo>
					  	   <w2:column id="chk" name="chk" dataType="text"></w2:column>
					  	   <w2:column id="dept_gb" name="dept_gb" dataType="text"></w2:column>
					  	   <w2:column id="mobile" name="mobile" dataType="text"></w2:column>
					  	   <w2:column id="dept_nm" name="dept_nm" dataType="text"></w2:column>
					       <w2:column id="mail_id" name="mail_id" dataType="text"></w2:column>
					       <w2:column id="recv_type" name="recv_type" dataType="text"></w2:column>
					       <w2:column id="email" name="email" dataType="text"></w2:column>
					       <w2:column id="nm" name="nm" dataType="text"></w2:column>
					       <w2:column id="syspayno" name="syspayno" dataType="text"></w2:column>
					       <w2:column id="regst_syspayno" name="regst_syspayno" dataType="text"></w2:column>
					  </w2:columnInfo>
					</w2:dataList>
				</w2:dataCollection>
				<w2:workflowCollection/>
				
				<!-- 지식재산권 메일 발송대상 조회 -->
				<xf:submission id="sbm_svcpatppomair02" 
							   ref='data:json,dma_search' 
							   target='data:json,[{"id":"dma_mst_info","key":"mstInfo"}, {"id":"dlt_user_list","key":"userList"}]' 
							   action="SvcPATPPOMAIR02.pwkjson" 
							   ev:submitdone="" method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous"></xf:submission>
				
				<!-- 지식재산권 메일 내용 저장 -->
				<xf:submission id="sbm_svcpatppomaim01" 
							   ref='data:json,[{"id":"dma_mail_info","key":"mailInfo"}, {"id":"dlt_receive_list","key":"receiveList"}, {"id":"dlt_reference_list","key":"referenceList"}]' 
							   target='' 
							   action="SvcPATPPOMAIM01.pwkjson" 
							   ev:submitdone="" method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous"></xf:submission>
								
			</xf:model>
			<script src="/cm/js/biz/pat.js" cache="false" />
			<script type="text/javascript" lazy="false"><![CDATA[
				/**
				 * 페이지 로딩 이벤트
				 */ 
				scwin.onpageload = function() {
				
					scwin.fn_loadPolarisEditor();
					
					dma_search.set("req_no", com.getParameter().req_no);
					dma_search.set("mngmt_no", com.getParameter().mngmt_no);
					
					//dma_search.set("req_no", "I01202200011");
					//dma_search.set("mngmt_no", "KR20220466");
									
					if(dma_search.get("req_no") !== ""){
						com.execute(sbm_svcpatppomair02);
					}else{
						com.alert("파라미터가 존재하지 않습니다.");
					}
					
				};
				
				scwin.onpageunload = function() {
					
				};
				
				/**
				 * 닫기 버튼 클릭 이벤트
				 */
				scwin.btn_close_onclick = function(e) {
					com.closePopup();
				};
				
				// 에디터 컴포넌트 초기화
				scwin.fn_loadPolarisEditor = function(){
					
					scwin.editor = new PolarisEditor();
					const config = {
					    width : '100%',
					    height : '350px',
					    useImageBase64Encoding : true
					};
					const loadCompleteCallback = function() {
					    /**
						 * 기술문의로 요청한 라이선스 문제가 처리될때까지 임시로 라이선스 경고 레이어를 삭제한다.
						 * 
						 * @date 2022. 03. 17
						 * @author James
						 */
						(function(){
							const delay = 1;
							let timerId = setTimeout(function remove() {
					        	let cover = document.getElementById('polaris_progress_cover');
					        	if (cover) {
					        		cover.style.cssText += 'display:none;';
					        		clearTimeout(timerId);
					        	} else {
					        		timerId = setTimeout(remove, delay);
					        	}
							}, delay);
				            
					    })();
					};
					scwin.editor.CreateEditor(txa_Content.getID(), config, loadCompleteCallback);
				};

				scwin.add_bibliography = function() {
				
					const req_no = dma_mst_info.get("req_no");
					const mngmt_no = dma_mst_info.get("mngmt_no");
					const patofic_mng_no = dma_mst_info.get("patofic_mng_no");
					const smitapp_natn_nm = dma_mst_info.get("smitapp_natn_nm");
					const smitapp_natn_cd = dma_mst_info.get("smitapp_natn_cd");
					const pat_clsf_nm = dma_mst_info.get("pat_clsf_nm");
					const tech_clsf_nm = dma_mst_info.get("tech_clsf_nm");
					const smitapp_no = dma_mst_info.get("smitapp_no");
					const smitapp_ymd = dma_mst_info.get("smitapp_ymd");
					const invnt_krn_nm = dma_mst_info.get("invnt_krn_nm");
				
				
				    const editor = document.getElementById(txa_Content.getID());
				    let addContents = "";
				
				    // 기본정보 표 세팅
				    addContents = "<table style=\"border-collapse: collapse;\" cellspacing=\"0\" cellpadding=\"1\">" + "\n";
				    addContents = addContents + "<tbody>";
				    addContents = addContents + "<tr>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;신청번호</td>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + req_no + "</td>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;관리번호</td>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + mngmt_no + "</td>";
				    addContents = addContents + "</tr>";
				    addContents = addContents + "<tr>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;사무소관리번호</td>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + patofic_mng_no + "</td>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;대상국가</td>";
				    addContents = addContents + "<td width=\"200\" height=\"20\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + smitapp_natn_nm + "/" + smitapp_natn_cd + "</td>";
				    addContents = addContents + "</tr>";
				    addContents = addContents + "<tr>";
				    addContents = addContents + "<td width=\"200\" height=\"22\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px; height: 22px;\">&nbsp;권리구분</td>";
				    addContents = addContents + "<td width=\"200\" height=\"22\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px; height: 22px;\">" + pat_clsf_nm + "</td>";
				    addContents = addContents + "<td width=\"200\" height=\"21\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;기술분류</td>";
				    addContents = addContents + "<td width=\"200\" height=\"21\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + tech_clsf_nm + "</td>";
				    addContents = addContents + "</tr>";
				    addContents = addContents + "<tr>";
				    addContents = addContents + "<td width=\"200\" height=\"22\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px; height: 22px;\">&nbsp;출원번호</td>";
				    addContents = addContents + "<td width=\"200\" height=\"22\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px; height: 22px;\">" + smitapp_no + "</td>";
				    addContents = addContents + "<td width=\"200\" height=\"21\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;출원일</td>";
				    addContents = addContents + "<td width=\"200\" height=\"21\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + com.formatDate(smitapp_ymd, "dash") + "</td>";
				    addContents = addContents + "</tr>";
				    addContents = addContents + "<tr>";
				    addContents = addContents + "<td width=\"200\" height=\"21\" style=\"border: 1px solid rgb(0, 0, 0); width: 200px;\">&nbsp;발명의명칭(국문)</td>";
				    addContents = addContents + "<td width=\"400\" colspan=\"3\" height=\"21\" style=\"border: 1px solid rgb(0, 0, 0); width: 420px;\">" + invnt_krn_nm + "</td>";
				    addContents = addContents + "</tr>";
				    addContents = addContents + "</tbody>";
				    addContents = addContents + "</table>";
				    addContents = addContents + "<p>&nbsp;</p>";
				
				    editor.SetTextFile(addContents, "HTML", null);
				};
				
				scwin.grid01_add = function() {
					const data = [{
					    dept_gb: "I"
					}];
					
					dlt_receive_list.setJSON(data, true);
				};
				
				scwin.grid01_remove = function() {
					dlt_receive_list.removeRows(grid01.getCheckedIndex("chk"));
				};
				
				scwin.grid02_add = function() {
					const data = [{
					    dept_gb: "I"
					}];
					
					dlt_reference_list.setJSON(data, true);
				};
				
				scwin.grid02_remove = function() {
				  dlt_reference_list.removeRows(grid02.getCheckedIndex("chk"));  
				};
				
				scwin.grid01_toggle_column = function(info) {
				    // IV DM PA
				    const newValue = info.newValue;
				    const oldValue = info.oldValue;
				    if(newValue !== ""){
				        const originList = dlt_user_list.getAllJSON();
				        const filteredList = originList.filter(item => item.target_type === newValue);
				        dlt_receive_list.setJSON(filteredList, true);
			        }
				    if(oldValue !== ""){
					    const originList = dlt_receive_list.getAllJSON();
				        const filteredList = originList.filter(item => item.target_type !== oldValue);
				        dlt_receive_list.setJSON(filteredList);
				    }
				};
				
				scwin.grid01_imageclick = function(row, col) {
					const value = "";
					const gridId = "grid01";
					if(col === 2){
						if(grid01.getCellData(row, 1) === "I"){
				            scwin.select_hum_info(row, value, gridId);
				        }
				        if(grid01.getCellData(row, 1) === "O"){
				            scwin.select_office_hum(row, value, gridId);
				        }
					}
				};
				
				scwin.grid02_imageclick = function(row, col) {
					const value = "";
					const gridId = "grid02";
					if(col === 2){
						if(grid02.getCellData(row, 1) === "I"){
				            scwin.select_hum_info(row, value, gridId);
				        }
				        if(grid02.getCellData(row, 1) === "O"){
				            scwin.select_office_hum(row, value, gridId);
				        }
					}
				};
				
				scwin.grid01_cell_onafteredit = function(row, col, value) {
					const gridId = "grid01";
				    if(col === 2){
				        if(grid01.getCellData(row, 1) === "I"){
				            scwin.select_hum_info(row, value, gridId);
				        }
				        if(grid01.getCellData(row, 1) === "O"){
				            scwin.select_office_hum(row, value, gridId);
				        }
				    }
				};
				
				scwin.grid02_cell_onafteredit = function(row, col, value) {
					const gridId = "grid02";
				    if(col === 2){
				        if(grid02.getCellData(row, 1) === "I"){
				            scwin.select_hum_info(row, value, gridId);
				        }
				        if(grid02.getCellData(row, 1) === "O"){
				            scwin.select_office_hum(row, value, gridId);
				        }
				    }
				};
				
				scwin.select_office_hum = function(row, value, grid) {
					let rowData = {nm: '',mobile: '',dept_nm: '',email: '',syspayno: ''};
			        if(grid === "grid01"){dlt_receive_list.setRowJSON(row, rowData, true);}else{dlt_reference_list.setRowJSON(row, rowData, true);}
					
				    data = { "src_clsf": "tab2", "charg_nm": value }
				    com.pop.open(biz.pat.pop.TYPE.PAT_OFFICE, data, function(ret) {
				        rowData = {
				            nm: ret.charg_nm || '',
				            mobile: ret.contac_loc || '',
				            dept_nm: ret.patofic_nm || '',
				            email: ret.email || '',
				            syspayno: ret.charg_id || ''
				        };
				        if(grid === "grid01"){
					        dlt_receive_list.setRowJSON(row, rowData, true);
				        }else{
					        dlt_reference_list.setRowJSON(row, rowData, true);
				        }
				        
				    });
				};
				
				scwin.select_hum_info = function(row, value, grid) {
					
				    let rowData = {nm: '',mobile: '',dept_nm: '',email: '',syspayno: ''};
			        if(grid === "grid01"){dlt_receive_list.setRowJSON(row, rowData, true);}else{dlt_reference_list.setRowJSON(row, rowData, true);}
			        
			        data = { "empno" : value, "work_clsf" : "HAG010", ref_yn : (value == "")? "Y" : "N" };
				    com.pop.open(com.pop.TYPE.HUM, data, function(ret) {
				        rowData = {
				            nm: ret.nm || '',
				            mobile: ret.mobile || '',
				            dept_nm: ret.dept_nm || '',
				            email: ret.email || '',
				            syspayno: ret.syspayno || ''
				        };
				        if(grid === "grid01"){
							dlt_receive_list.setRowJSON(row, rowData, true);
						}else{
							dlt_reference_list.setRowJSON(row, rowData, true);
						}
				        
				    });
				};
				
				scwin.save = function() {
					
					dma_mail_info.set("req_no", dma_search.get("req_no"));
					dma_mail_info.set("mngmt_no", dma_search.get("mngmt_no"));
					dma_mail_info.set("regst_syspayno", com.getLoginInfo("sn"));
					
					const editor = document.getElementById(txa_Content.getID());
					const contents = editor.GetTextFile("HTML");
					const validateContents = editor.GetTextFile("TEXT");
					
					if(validateContents.length < 1){
						com.alert("메일 내용이 입력되지 않았습니다.");
						return;
					}
					
					if(dlt_receive_list.getDataLength() < 1){
						com.alert("받는사람이 지정되지 않았습니다.");
						return;
					}
				
				    if (!com.validateData(dma_mail_info, [
				            { id: "mail_subject", mandatory: true }
				    ], false)) return;
				    
				    dma_mail_info.set("mail_contents", contents);
				    
				    com.execute(sbm_svcpatppomaim01, {
						successCallback : function(e) {
							com.alert("발송 되었습니다.");
						}
					});
				};
		
			]]></script>
		</head>
		<style><![CDATA[
			.polaris_title{display:none}
		]]></style>
		<body ev:onpageload="scwin.onpageload">
			<xf:group id="" class="pop_contents">
				<xf:group class="w2tb tbl" id="" style="" tagname="table">
					<w2:attributes>
						<w2:summary></w2:summary>
					</w2:attributes>
					<xf:group tagname="caption"></xf:group>
					<xf:group tagname="colgroup">
						<xf:group style="width:150px;" tagname="col"></xf:group>
						<xf:group style="" tagname="col"></xf:group>
					</xf:group>
					<xf:group tagname="tr">
						<xf:group class="w2tb_th" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
							<w2:textbox id="" label="받는사람" style="" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<w2:attributes></w2:attributes>
							
							<xf:group class="titleSection" id="" style="">
				    			<xf:group class="le" id="">
				    				<xf:select appearance="full" class="chkGroup" id="" ref="" renderType="checkboxgroup" rows="" selectedindex="-1" style="width: 100px;" userData1="IV" ev:onchange="scwin.grid01_toggle_column">
										<xf:choices>
											<xf:item>
												<xf:label>주 발명자</xf:label>
												<xf:value><![CDATA[IV]]></xf:value>
											</xf:item>
										</xf:choices>
									</xf:select>
									<xf:select appearance="full" class="chkGroup" id="" ref="" renderType="checkboxgroup" rows="" selectedindex="-1" style="width: 100px;" userData1="DM" ev:onchange="scwin.grid01_toggle_column">
										<xf:choices>
											<xf:item>
												<xf:label>위임 담당자</xf:label>
												<xf:value><![CDATA[DM]]></xf:value>
											</xf:item>
										</xf:choices>
									</xf:select>
									<xf:select appearance="full" class="chkGroup" id="" ref="" renderType="checkboxgroup" rows="" selectedindex="-1" style="width: 100px;" userData1="PA" ev:onchange="scwin.grid01_toggle_column">
										<xf:choices>
											<xf:item>
												<xf:label>담당 변리사</xf:label>
												<xf:value><![CDATA[PA]]></xf:value>
											</xf:item>
										</xf:choices>
									</xf:select>
				    			</xf:group>
				    			
				    			<xf:group class="ri" id="">
				    				<xf:group class="btnarea" id="" style="">
				    					
				    					<xf:trigger class="bt_plus" id="" style="" type="button" ev:onclick="scwin.grid01_add">
				    						<xf:label><![CDATA[추가]]></xf:label>
				    					</xf:trigger>
				    					<xf:trigger class="bt_minus" id="" style="" type="button" ev:onclick="scwin.grid01_remove">
				    						<xf:label><![CDATA[삭제]]></xf:label>
				    					</xf:trigger>
				    				</xf:group>
				    			</xf:group>
				    		</xf:group>
														
							<w2:gridView id="grid01" class="grid" dataList="data:dlt_receive_list" style="height: 75px;"
							  defaultCellHeight="28" evenRowBackgroundColor="#f7faff"  rowNumHeaderValue="No." noResultMessage="조회 결과가 없습니다." rowStatusHeaderValue="상태" noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumVisible="true" rowNumWidth="60" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" summaryAuto="true" visibleRowNum="5" autoFit="allColumn" ev:onafteredit="scwin.grid01_cell_onafteredit" ev:ontextimageclick="scwin.grid01_imageclick">
							  <w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
							  <w2:header id="header1">
							    <w2:row id="row1">
							      <w2:column id="hChk" checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" inputType="checkbox" value="chk" width="37" sortable="false"></w2:column>
							      <w2:column width="50" inputType="text" displayMode="label" id="dept_gb" value="소속구분"></w2:column>
							      <w2:column width="70" inputType="text" displayMode="label" id="nm" value="성명"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="mobile" value="연락처"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="dept_nm" value="소속"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="email" value="이메일"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="syspayno" value="empty"></w2:column>
							    </w2:row>
							  </w2:header>
							  <w2:gBody id="gBody1">
							    <w2:row id="row2">
							      <w2:column inputType="checkbox" id="chk" readOnly="false"></w2:column>
							      <w2:column inputType="select" id="dept_gb" chooseOption="true" readOnly="false" visibleRowNum="10" chooseOptionLabel="-선택-">
							        <w2:choices>
	    								<w2:item>
	    									<w2:label><![CDATA[내부]]></w2:label>
	    									<w2:value><![CDATA[I]]></w2:value>
	    								</w2:item>
	    								<w2:item>
	    									<w2:label><![CDATA[사무소]]></w2:label>
	    									<w2:value><![CDATA[O]]></w2:value>
	    								</w2:item>
	    							</w2:choices>
							      </w2:column>
							      <w2:column inputType="textImage" id="nm" readOnly="false" imageSrc="/cm/images/sample/btn_tbsearch02.png"></w2:column>
							      <w2:column inputType="text" id="mobile"></w2:column>
							      <w2:column inputType="text" id="dept_nm"></w2:column>
							      <w2:column inputType="text" id="email"></w2:column>
							      <w2:column inputType="text" id="syspayno" readOnly="true" hidden="true"></w2:column>
							      </w2:row>
							  </w2:gBody>
							</w2:gridView>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr">
						<xf:group class="w2tb_th" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:textbox id="" label="참조" style="" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<w2:attributes></w2:attributes>
							
							<xf:group class="titleSection" id="" style="">
				    			<xf:group class="le" id="">
				    			</xf:group>
				    			
				    			<xf:group class="ri" id="">
				    				<xf:group class="btnarea" id="" style="">
				    					
				    					<xf:trigger class="bt_plus" id="" style="" type="button" ev:onclick="scwin.grid02_add">
				    						<xf:label><![CDATA[추가]]></xf:label>
				    					</xf:trigger>
				    					<xf:trigger class="bt_minus" id="" style="" type="button" ev:onclick="scwin.grid02_remove">
				    						<xf:label><![CDATA[삭제]]></xf:label>
				    					</xf:trigger>
				    				</xf:group>
				    			</xf:group>
				    		</xf:group>
							
							<w2:gridView id="grid02" class="grid" dataList="data:dlt_reference_list" style="height: 75px;"
							  ev:oncellclick="" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"  rowNumHeaderValue="No." noResultMessage="조회 결과가 없습니다." rowStatusHeaderValue="상태" noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumVisible="true" rowNumWidth="60" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" summaryAuto="true" visibleRowNum="5" autoFit="allColumn" ev:onafteredit="scwin.grid02_cell_onafteredit" ev:ontextimageclick="scwin.grid02_imageclick">
							  <w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
							  <w2:header id="header1">
							    <w2:row id="row1">
							      <w2:column id="hChk" checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" inputType="checkbox" value="chk" width="37" sortable="false"></w2:column>
							      <w2:column width="50" inputType="text" displayMode="label" id="dept_gb" value="소속구분"></w2:column>
							      <w2:column width="70" inputType="text" displayMode="label" id="nm" value="성명"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="mobile" value="연락처"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="dept_nm" value="소속"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="email" value="이메일"></w2:column>
							      <w2:column width="100" inputType="text" displayMode="label" id="syspayno" value="empty"></w2:column>
							    </w2:row>
							  </w2:header>
							  <w2:gBody id="gBody1">
							    <w2:row id="row2">
							      <w2:column inputType="checkbox" id="chk" readOnly="false"></w2:column>
							      <w2:column inputType="select" id="dept_gb" chooseOption="true" readOnly="false" visibleRowNum="10" chooseOptionLabel="-선택-">
							        <w2:choices>
	    								<w2:item>
	    									<w2:label><![CDATA[내부]]></w2:label>
	    									<w2:value><![CDATA[I]]></w2:value>
	    								</w2:item>
	    								<w2:item>
	    									<w2:label><![CDATA[사무소]]></w2:label>
	    									<w2:value><![CDATA[O]]></w2:value>
	    								</w2:item>
	    							</w2:choices>
							      </w2:column>
							      <w2:column inputType="textImage" id="nm" readOnly="false" imageSrc="/cm/images/sample/btn_tbsearch02.png"></w2:column>
							      <w2:column inputType="text" id="mobile"></w2:column>
							      <w2:column inputType="text" id="dept_nm"></w2:column>
							      <w2:column inputType="text" id="email"></w2:column>
							      <w2:column inputType="text" id="syspayno" readOnly="true" hidden="true"></w2:column>
							      </w2:row>
							  </w2:gBody>
							</w2:gridView>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr">
						<xf:group class="w2tb_th" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
							<w2:textbox id="" label="제목" style="" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<w2:attributes></w2:attributes>
							<xf:input adjustMaxLength="false" id="" style="width: 100%;" ref="data:dma_mail_info.mail_subject"></xf:input>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr">
						<xf:group class="w2tb_td" tagname="td">
							<w2:attributes>
								<w2:colspan>2</w2:colspan>
							</w2:attributes>
							<xf:textarea id="txa_Content"></xf:textarea>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group style="" id="" class="btnGroup">
					<xf:group style="" id="" class="le"></xf:group>
					<xf:group id="" class="ri">
						<xf:trigger style="" id="btn_close" type="button" class=" btn pro " ev:onclick="scwin.btn_close_onclick">
							<xf:label>
								<![CDATA[닫기]]>
							</xf:label>
						</xf:trigger>
						<xf:trigger style="" id="" type="button" class=" btn pro " ev:onclick="scwin.add_bibliography">
							<xf:label>
								<![CDATA[서지사항추가]]>
							</xf:label>
						</xf:trigger>
						<xf:trigger style="" id="btn_save" type="button" class=" btn pro conf" ev:onclick="scwin.save">
		    				<xf:label><![CDATA[보내기]]></xf:label>
		    			</xf:trigger>
					</xf:group>
				</xf:group>
			</xf:group>
		</body>
	</html>