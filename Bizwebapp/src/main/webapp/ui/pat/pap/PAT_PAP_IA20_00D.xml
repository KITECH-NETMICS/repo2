<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="출원지시 의뢰">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            
				<w2:dataMap baseNode="map" id="dma_search">
				  <w2:keyInfo>
				       <w2:key id="app_id" name="app_id" dataType="text"></w2:key>
				 </w2:keyInfo>
				</w2:dataMap>
				
				<w2:dataMap baseNode="map" id="dma_result">
				  <w2:keyInfo>
				       <w2:key id="app_id" name="app_id" dataType="text"></w2:key>
				       <w2:key id="req_no" name="req_no" dataType="text"></w2:key>
				       <w2:key id="mngmt_no" name="mngmt_no" dataType="text"></w2:key>
				       <w2:key id="job_state_cd" name="job_state_cd" dataType="text"></w2:key>
				       <w2:key id="job_state_nm_detail" name="job_state_nm_detail" dataType="text"></w2:key>
				       <w2:key id="job_state_nm" name="job_state_nm" dataType="text"></w2:key>
				       <w2:key id="req_psn_syspayno" name="req_psn_syspayno" dataType="text"></w2:key>
				       <w2:key id="req_psn_nm" name="req_psn_nm" dataType="text"></w2:key>
				       <w2:key id="req_daytm" name="req_daytm" dataType="text"></w2:key>
				       <w2:key id="req_app_clsf" name="req_app_clsf" dataType="text"></w2:key>
				       <w2:key id="req_app_clsf_nm" name="req_app_clsf_nm" dataType="text"></w2:key>
				       <w2:key id="req_pub_yn" name="req_pub_yn" dataType="text"></w2:key>
				       <w2:key id="req_pub_yn_nm" name="req_pub_yn_nm" dataType="text"></w2:key>
				       <w2:key id="req_claim_yn" name="req_claim_yn" dataType="text"></w2:key>
				       <w2:key id="req_claim_yn_nm" name="req_claim_yn_nm" dataType="text"></w2:key>
				       <w2:key id="req_comment" name="req_comment" dataType="text"></w2:key>
				       <w2:key id="req_attach_file" name="req_attach_file" dataType="text"></w2:key>
				       <w2:key id="com_psn_syspayno" name="com_psn_syspayno" dataType="text"></w2:key>
				       <w2:key id="com_psn_nm" name="com_psn_nm" dataType="text"></w2:key>
				       <w2:key id="com_daytm" name="com_daytm" dataType="text"></w2:key>
				       <w2:key id="com_patofic_cd" name="com_patofic_cd" dataType="text"></w2:key>
				       <w2:key id="com_patofic_nm" name="com_patofic_nm" dataType="text"></w2:key>
				       <w2:key id="com_patofic_charg_id" name="com_patofic_charg_id" dataType="text"></w2:key>
				       <w2:key id="com_patofic_charg_nm" name="com_patofic_charg_nm" dataType="text"></w2:key>
				       <w2:key id="com_due_date" name="com_due_date" dataType="text"></w2:key>
				       <w2:key id="com_comment" name="com_comment" dataType="text"></w2:key>
				       <w2:key id="com_attach_file" name="com_attach_file" dataType="text"></w2:key>
				       <w2:key id="req_ntis_no" name="req_ntis_no" dataType="text"></w2:key>
				       <w2:key id="patofic_cd" name="patofic_cd" dataType="text"></w2:key>
				       <w2:key id="patofic_nm" name="patofic_nm" dataType="text"></w2:key>
				 </w2:keyInfo>
				</w2:dataMap>
				
				<w2:dataMap baseNode="map" id="dma_save">
					<w2:keyInfo>
						<w2:key id="app_id" name="app_id" dataType="text"></w2:key>
						<w2:key id="req_no" name="req_no" dataType="text"></w2:key>
						<w2:key id="mngmt_no" name="mngmt_no" dataType="text"></w2:key>
						<w2:key id="app_id" name="app_id" dataType="text"></w2:key>
						<w2:key id="psn_syspayno" name="psn_syspayno" dataType="text"></w2:key>
						<w2:key id="com_psn_syspayno" name="com_psn_syspayno" dataType="text"></w2:key>
						<w2:key id="com_daytm" name="com_daytm" dataType="text"></w2:key>
						<w2:key id="com_patofic_cd" name="com_patofic_cd" dataType="text"></w2:key>
						<w2:key id="com_due_date" name="기한일" dataType="text"></w2:key>
						<w2:key id="com_comment" name="com_comment" dataType="text"></w2:key>
						<w2:key id="com_attach_file" name="com_attach_file" dataType="text"></w2:key>
						<w2:key id="bf_state" name="bf_state" dataType="text"></w2:key>
						<w2:key id="state" name="state" dataType="text"></w2:key>
						<w2:key id="docu_clsf" name="docu_clsf" dataType="text"></w2:key>
						<w2:key id="syspayno" name="syspayno" dataType="text"></w2:key>
						<w2:key id="curr_state_cd" name="curr_state_cd" dataType="text"></w2:key>
						<w2:key id="next_state_cd" name="next_state_cd" dataType="text"></w2:key>
						<w2:key id="job_state_cd" name="job_state_cd" dataType="text"></w2:key>
						<w2:key id="ref_key" name="ref_key" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
            
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
            
			<!-- 출원지시 조회 -->
			<xf:submission id="sbm_svcpatpapreqsr02" 
						   ref='data:json,dma_search' 
						   target='data:json,{"id":"dma_result","key":"patPapManReqInvVo"}' 
						   action="SvcPATPAPREQSR02.pwkjson" 
						   ev:submitdone="scwin.sbm_svcpatpapreqsr02_done" method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous"></xf:submission>
						   
			<!-- 출원지시 의뢰 등록 -->
			<xf:submission id="sbm_svcpatpapreqsi02" 
						   ref='data:json,dma_save' 
						   target='' 
						   action="SvcPATPAPREQSI02.pwkjson" 
						   ev:submitdone="" method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous"></xf:submission>
            
        </xf:model>
         <script type="text/javascript" lazy="false"><![CDATA[
        
			scwin.GLOBAL_VARS = {
				p_param: com.getParameter(),
				revParam: {}
			};
        
			scwin.onpageload = function() {
				// 첨부파일 컴포넌트 초기화
                com.file.init();
                
                WFRAME_PATBIBLIOGRAPHY.getWindow().scwin.selectBibliography(scwin.GLOBAL_VARS.p_param.mngmt_no);
                
                dma_search.set('app_id', scwin.GLOBAL_VARS.p_param.ref_no);
                com.execute(sbm_svcpatpapreqsr02);
			};
			
			scwin.sbm_svcpatpapreqsr02_done = function(e) {
			
				com.trimDataCollection(dma_result);
			
				let attachFileNo_A = "";
				const modeType_A = "view";
				const modeType_B = "edit";
								
			    scwin.GLOBAL_VARS.p_param.job_state_cd = dma_result.get("job_state_cd");
			    scwin.GLOBAL_VARS.p_param.patofic_cd = dma_result.get("com_patofic_cd");
			
			    //첨부파일 조회
			    attachFileNo_A = dma_result.get("req_attach_file");
				
				com.file.create(upload_A.getID(), { fileKey: attachFileNo_A ? attachFileNo_A : com.getLoginInfo('serviceId'), mode: modeType_A, target: "IPMS" });
				com.file.create(upload_B.getID(), { fileKey: com.getLoginInfo('serviceId'), mode: modeType_B, target: "IPMS" });
				
				com_psn_nm.setValue(com.getLoginInfo('cn'));
				com_daytm.setValue(com.getServerDateTime("yyyyMMdd"));
				
			};
			
			scwin.save_onclick = function(){
			
				if(!com.validateData(dma_save,  [
					{ id : "com_due_date", mandatory : true }					
				], false)) return;
				
                com.confirm("의뢰 하시겠습니까?", function(ret) {
                    if (ret) {
                    	com.file.transport(scwin.save);
                    }
               });
            };
            
            scwin.save = function(attachObj){
            
            	const sn = com.getLoginInfo('sn');

				dma_save.set("app_id", scwin.GLOBAL_VARS.p_param.ref_no);
				dma_save.set("req_no", scwin.GLOBAL_VARS.p_param.req_no);
				dma_save.set("mngmt_no", scwin.GLOBAL_VARS.p_param.mngmt_no);
				dma_save.set("psn_syspayno", sn);
				dma_save.set("com_psn_syspayno", sn);
				dma_save.set("com_patofic_cd", cwin.GLOBAL_VARS.p_param.patofic_cd);
				dma_save.set("com_attach_file", attachObj.upload_B);
				dma_save.set("bf_state", scwin.GLOBAL_VARS.p_param.job_state_cd);
				dma_save.set("state", "P0511");
				dma_save.set("docu_clsf", "I14");
				dma_save.set("syspayno", sn);
				dma_save.set("curr_state_cd", scwin.GLOBAL_VARS.p_param.job_state_cd);
				dma_save.set("next_state_cd", "P0511");
				dma_save.set("job_state_cd", "P0511");
				dma_save.set("ref_key", scwin.GLOBAL_VARS.p_param.ref_no);
				
				com.execute(sbm_svcpatpapreqsi02, {
					successCallback : function(e) {
						com.alert("저장되었습니다.");
						$p.parent().scwin.trigger_list_onclick();
					}
				});
				
            };
			
			scwin.onpageunload = function() {
				
			};
		
		]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<xf:group class="pageWrap" id="" style="">
    		<w2:wframe id="WFRAME_PATBIBLIOGRAPHY" src="/ui/pat/pcm/PAT_PCM_IF99_00D.xml"></w2:wframe>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="출원 요청" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:220px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:220px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="요청자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="req_psn_nm" label="" style="" tagname="span" ref="data:dma_result.req_psn_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="요청일시" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="req_daytm" label="" style="" tagname="span" ref="data:dma_result.req_daytm" dataType="date"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="출원구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="req_app_clsf_nm" label="" style="" tagname="span" ref="data:dma_result.req_app_clsf_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="NTIS 과제번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="req_ntis_no" label="" style="" tagname="span" ref="data:dma_result.req_ntis_no"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox class="" id="" label="조기공개 유무" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox class="txt" id="req_pub_yn_nm" label="" style="" tagname="span" ref="data:dma_result.req_pub_yn_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox class="" id="" label="심사청구" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox class="txt" id="req_claim_yn_nm" label="" style="" tagname="span" ref="data:dma_result.req_claim_yn_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="의뢰내용" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:span class="multiline" escape="false" id="req_comment" label="" style="" ref="data:dma_result.req_comment"></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="첨부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="fileuploadBox" id="upload_A" style="height:150px;"></xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="의뢰 내용" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:220px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:220px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="의뢰자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="com_psn_nm" label="" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="의뢰일" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="com_daytm" label="" style="" tagname="span" ref="data:dma_save.com_daytm" dataType="date"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="특허사무소" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="com_patofic_nm" label="" style="" tagname="span" ref="data:dma_result.com_patofic_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="희망담당자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="com_patofic_charg_nm" label="" style="" tagname="span" ref="data:dma_result.com_patofic_charg_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="기한일" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal full" focusOnDateSelect="false" footerDiv="false"
    						id="com_due_date" placeholder="" renderDiv="true" rightAlign="false" style="max-width:200px;" ref="data:dma_save.com_due_date">
    					</w2:inputCalendar>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="내용" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:span class="multiline" escape="false" id="com_comment" label="" style="" ref="data:dma_save.com_comment"></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="첨부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="fileuploadBox" id="upload_B" style="height:150px;"></xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class=" btn pro conf" id="" style="" type="button" ev:onclick="scwin.save_onclick">
    					<xf:label><![CDATA[의뢰]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
