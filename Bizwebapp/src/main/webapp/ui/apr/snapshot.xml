<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/snapshot.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head meta_programId="A001D" meta_programName="스냅샷" meta_programDesc="스냅샷 공통 페이지" meta_author="James" meta_date="2022-06-14">
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_search" style="">
    				<w2:keyInfo>
    					<w2:key dataType="text" id="syspayno" name="시스템개인번호"></w2:key>
    					<w2:key id="dlgt_sn" name="대결순번" dataType="text"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataMap baseNode="map" id="dma_config">
    				<w2:keyInfo>
    					<w2:key id="syspayno" name="시스템 개인번호" dataType="text"></w2:key>
    					<w2:key id="auto_rule_yn" name="자동전결사용여부" dataType="text"></w2:key>
    					<w2:key id="dlgt_use_yn" name="대결사용여부" dataType="text"></w2:key>
    					<w2:key id="sort_odr" name="기본정렬" dataType="text"></w2:key>
    					<w2:key id="row_per_page" name="목록개수" dataType="text"></w2:key>
    					<w2:key id="appr_recv_yn" name="결재요청 수신여부" dataType="text"></w2:key>
    					<w2:key id="sms_recv_yn" name="모바일 수신여부" dataType="text"></w2:key>
    					<w2:key id="dlgt_alrm_yn" name="대결설정 알림 수신여부" dataType="text"></w2:key>
    					<w2:key id="cud_type" name="cud타입" dataType="text"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_snap">
					<w2:keyInfo>
						<w2:key id="reqNo" name="신청번호" dataType="text"></w2:key>
						<w2:key id="endpoint" name="endpoint" dataType="text"></w2:key>
						<w2:key id="changeTitle" name="요청서 제목" dataType="text"></w2:key>
						<w2:key id="changeReason" name="요청 상세 내용" dataType="text"></w2:key>
						<w2:key id="appname" name="인스턴스명" dataType="text"></w2:key>
						<w2:key id="instStatus" name="인스턴스상태" dataType="text"></w2:key>
						<w2:key id="taskName" name="타스크명" dataType="text"></w2:key>
						<w2:key id="taskStatus" name="타스크상태" dataType="text"></w2:key>
						<w2:key id="aprState" name="결재상태값" dataType="text"></w2:key>
						<w2:key id="procDefAlias" name="양식타입" dataType="text"></w2:key>
						<w2:key id="ruleType" name="전결타입" dataType="text"></w2:key>
						<w2:key id="withDrawYn" name="회수가능여부" dataType="text"></w2:key>
						<w2:key id="ruleMoney" name="전결금액" dataType="text"></w2:key>
						<w2:key id="comments" name="결재의견" dataType="text"></w2:key>
						<w2:key id="apprEditable" name="결재선편집여부" dataType="text"></w2:key>
						<w2:key id="linetype" name="라인타입" dataType="text"></w2:key>
						<w2:key id="regulationUrl" name="양식별전결규정URL" dataType="text"></w2:key>
						<w2:key id="viewMode" name="버튼모드" dataType="text"></w2:key>
						<w2:key id="instId" name="인스턴스ID" dataType="text"></w2:key>
						<w2:key id="taskId" name="타스크ID" dataType="text"></w2:key>
						<w2:key id="trctag" name="태그넘버" dataType="text"></w2:key>
						<w2:key id="apprvConfigYn" name="전결구분유무" dataType="text"></w2:key>
						<w2:key id="asistype" name="마이그래이션유무" dataType="text"></w2:key>
						<w2:key id="defName" name="리스트양식명" dataType="text"></w2:key>
						<w2:key id="inItEmpcode" name="기안자사번" dataType="text"></w2:key>
						<w2:key id="instAlias" name="인스턴스Alias" dataType="text"></w2:key>
						<w2:key id="auditRolesSn" name="감사자사번" dataType="text"></w2:key>
						<w2:key id="safeYn" name="사전안전성검토유무" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_user">
					<w2:keyInfo>
						<w2:key id="endpoint" name="아이디" dataType="text"></w2:key>
						<w2:key id="procDefAlias" name="양식타입" dataType="text"></w2:key>
						<w2:key id="ruleType" name="전결타입" dataType="text"></w2:key>
						<w2:key id="ruleMoney" name="전결금액" dataType="text"></w2:key>
						<w2:key id="ruleAutoYn" name="전결유무" dataType="text"></w2:key>
						<w2:key id="auditRolesSn" name="감사자사번" dataType="text"></w2:key>
						<w2:key id="reqnum" name="procdefalias" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_docComments">
					<w2:keyInfo>
						<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_applicationMap">
					<w2:keyInfo>
						<w2:key id="appname" name="양식명" dataType="text"></w2:key>
						<w2:key id="rule_yn" name="전결라인구분" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_user" saveRemovedData="true" ev:onrowpositionchange="">
					<w2:columnInfo>
						<w2:column id="chk" name="선택" dataType="text" ignoreStatus="true"></w2:column>
						<w2:column id="empcode" name="아이디" dataType="text"></w2:column>
						<w2:column id="empsn" name="사번" dataType="text"></w2:column>
						<w2:column id="empname" name="성명" dataType="text"></w2:column>
						<w2:column id="jikname" name="직무명" dataType="text"></w2:column>
						<w2:column id="jikcd" name="직무코드" dataType="text"></w2:column>
						<w2:column id="email" name="이메일" dataType="text"></w2:column>
						<w2:column id="partcode" name="부서코드" dataType="text"></w2:column>
						<w2:column id="partname" name="부서명" dataType="text"></w2:column>
						<w2:column id="empposition" name="직급" dataType="text"></w2:column>
						<w2:column id="locale" name="지역" dataType="text"></w2:column>
						<w2:column id="apld_apltype" name="타입" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_docComments" saveRemovedData="true" ev:onrowpositionchange="">
					<w2:columnInfo>
						<w2:column id="req_no" name="신청번호" dataType="text" ignoreStatus="true"></w2:column>
						<w2:column id="empno" name="결재자" dataType="text" ignoreStatus="true"></w2:column>
						<w2:column id="empname" name="결재자명" dataType="text" ignoreStatus="true"></w2:column>
						<w2:column id="opt_type" name="결재상태" dataType="text"></w2:column>
						<w2:column id="created_date" name="의견일시" dataType="text"></w2:column>
						<w2:column id="contents" name="결재의견" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection>
			</w2:workflowCollection>
			<xf:submission id="SvcGetSnapshot" ref="data:json,dma_snap" action="SvcGetSnapshot.pwkjson" target='data:json,dma_snap' method="post" mediatype="application/json"
				encoding="UTF-8" mode="asynchronous" />
			<xf:submission id="SvcMakeSnapshot" ref="data:json,dma_snap" action="SvcMakeSnapshot.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<xf:submission id="SvcFormSubmit" ref='data:json,[{"id":"dma_snap", "key":"aprScVo"},{"id":"dlt_user", "key":"aprUserListVo"}]' action="SvcFormSubmit.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous" />
			<xf:submission id="SvcFormReject" ref="data:json,dma_snap" action="SvcFormReject.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<xf:submission id="SvcFormCompensate" ref="data:json,dma_snap" action="SvcFormCompensate.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<xf:submission id="SvcDeleteApr" ref="data:json,dma_snap" action="SvcDeleteApr.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<xf:submission id="sbm_selectBaseAprLine" ref='data:json,dma_user' target='data:json,{"id":"dlt_user","key":"aprUserListVo"}' action="SvcAPRCOMLINR04.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
				ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sbm_selectBaseAprLineAll" ref='data:json,dma_user' target='data:json,{"id":"dlt_user","key":"aprUserListVo"}' action="SvcAPRCOMLINR08.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
				ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sbm_selectSuSinAprLine" ref='data:json,dma_user' target='data:json,{"id":"dlt_user","key":"aprUserListVo"}' action="SvcAPRCOMLINR09.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
				ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="SvcFormAccept" ref="data:json,dma_snap" action="SvcFormAccept.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<xf:submission id="SvcFormAcceptLineSet" ref='data:json,[{"id":"dma_snap", "key":"aprScVo"},{"id":"dlt_user", "key":"aprUserListVo"}]' action="SvcFormAcceptLineSet.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous" />
			<xf:submission id="SvcComAprDocM01" ref="data:json,dma_docComments" action="SvcComAprDocM01.pwkjson" target='data:json,{"id":"dlt_docComments","key":"docCommentsVo"}' method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<xf:submission id="SvcAuthReject" ref="data:json,dma_snap" action="SvcAuthReject.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
				mode="asynchronous" />
			<!-- 전결여부 조회 -->
			<xf:submission id="SvcGetApplicationMap" ref='data:json,dma_user' target='data:json,dma_applicationMap' action="SvcAPRCOMLINR10.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" mode="asynchronous" processMsg="" ev:submitdone="">
			</xf:submission>
			<!-- 사용자 환경설정 조회 -->
        	<xf:submission id="sbm_selectData" ref="data:json,dma_search" target='data:json,[{"id": "dma_config","key":"configVo"}]'
        		action="SvcXOMCORER01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
		</xf:model>
		<script type="text/javascript" lazy="false"><![CDATA[
			scwin.gvar={
				acceptLineYn : "N", // 수신결재 최초상신일 경우에 Y값이며 그외에는 N
				lineAble : "N",
				domOverseaClsf: "N"
			};
			
			scwin.movePage = function(serviceid, message) {
				alert(message + " 처리 되었습니다.");
				com.movePageMenu( serviceid, 
					// 결재 프레임 안의 wframe 으로 존재할 때는 프레임을 닫지 않고, 
					// 결재 프레임 밖에 단독 MDI 창으로 존재할 때에만 프레임을 강제로 닫는다.
					this.$w.getParentWindow().$p.getFrameId().includes('_wfForm') ? {} : {where: 'snapshot'}
				);
				$('.side .menu .mClick').removeClass("mClick");
				$('.side .menu .' + serviceid).addClass("mClick");			
			};
			
			scwin.onpageload = function() {
			
				dma_search.set("syspayno", com.getLoginInfo("sn"));
			
				// endpoint 값이 업는 경우 로그인 아이디 넣어주기
				if (dma_snap.get("endpoint") == "") {
					dma_snap.set("endpoint",com.getLoginInfo("uid"));
				}
				
				// reqNo값이 존재 할 경우에만 스냅샷을 조회 한다.
				if (dma_snap.get("reqNo") == "") {
					scwin.btnControl("blank");
					return;
				}
								
				// 문서함별 기본 버튼컨트롤
				scwin.btnControl(dma_snap.get("viewMode"));
				
				dma_docComments.set("req_no", dma_snap.get("reqNo"));
				com.execute(SvcGetSnapshot, {
					exceptionCallback: function(e) {
						// 예외 처리
						scwin.btnControl('blank');
						gcm.pop.error(scwin, gcm.sbm.getResCode(e));
					},
					successCallback : function(e) { // 성공 콜백
						// 스냅샷이 정상적으로 조회 되었다면
						grp_docEmpty.hide();

						// 양식명 넣기
						scwin.getAppName();
						
						// 전결 기본설청
						if (dma_snap.get("viewMode") == "draft") { 
							if ("Y" == dma_snap.get("apprvConfigYn") ) {
								radio_gender.setValue("Y");
							} else {
								radio_gender.setValue("N");
							}
						}
						
						// 결재선 편집 여부 (linetype값이 recieve 수신결재일경우 결재선 편집)
						if ((dma_snap.get("apprEditable") && dma_snap.get("viewMode") == "draft") || (dma_snap.get("linetype") == "recieve" && dma_snap.get("viewMode") == "approval")) {
							btn_approvalLine.show("");
							grp_baseAprLine.show("");
						} else {
							btn_approvalLine.hide("");
							grp_baseAprLine.hide("");
						}
						
						// apprEditable true이고, viewMode draft이면 사용자 자기만 보이도록 
						if ((dma_snap.get("apprEditable") && dma_snap.get("viewMode") == "draft")) {
							scwin.gvar.lineAble = "Y";
						}
						
						// 회수여부
						if ("Y" == dma_snap.get("withDrawYn") && dma_snap.get("viewMode") == "running") {
							btn_compensate.show("");
						} else {
							btn_compensate.hide("");
						}
						
						// 소액화학물질 버튼세팅
						if (dma_snap.get("safeYn") == "Y" && dma_snap.get("viewMode") == "approval") {
							btn_label.show("");	// 라벨
							btn_accept.hide("");	// 결재
							btn_accept_comments.hide("");	//결재의견
						}
						
						if (e.responseJSON.elData && e.responseJSON.elData.html) {
							// com.setHTML(wfSnap, e.responseJSON.elData.html);
							$(wfSnap.render).html(e.responseJSON.elData.html);
							
							let str = e.responseJSON.elData.html;
							let pattern = /<td class="title2" width="15%">국내\/국외구분<\/td>\n<td class="contant" colspan="3" width="35%">(.*)<\/td>/;
							let match = str.match(pattern);
							let result = match ? match[1] : "No match";
							
							console.log(result);
							result === "국외" ? scwin.gvar.domOverseaClsf = "Y" : scwin.gvar.domOverseaClsf = "N"; 
						}
						
						// 모든 결제라인 삭제 후 다시 적용
						generator1.removeAll();
						generator2.removeAll();
						generator2_2.removeAll();
						generator3.removeAll();
						generator4.removeAll();
						generator6.removeAll();
						grd01Title.hide();
						grd02Title.hide();
						grd02_02Title.hide();
						grd03Title.hide();
						grd04Title.hide();
						grd06Title.hide();
							
						var numAppr = 0;
						var numAUD = 0;
						var numCON = 0;
						var numCOO = 0;
						var numWork = 0;
						var numSuSin = 0;
						e.responseJSON.elData.aprUserVo.forEach(
							function (element, index) {
								// AS-IS데이타일경우 기안자 사번 넣기
								if (element.apld_apltype == "결재" && element.jikname == "기안" && "1" == dma_snap.get("asistype")) {
									dma_snap.set("inItEmpcode",element.empsn);
								}
								
					        	// 결재담당자 세팅
					        	if (element.apld_apltype == "결재"||index == 0) {
						        	grd01Title.show("flex");
									generator1.insert();
				        			generator1.getChild( numAppr , "empname" ).setValue(element.empname);
						        	generator1.getChild( numAppr , "jikname" ).setValue(element.jikname);
						        	if (element.endTime != null) {
						        		generator1.getChild( numAppr , "personImage" ).show("");
						        		generator1.getChild( numAppr , "endTime" ).setValue(element.endTime.substr(0, 19));
						        		if (element.autoApproval == "Y") {
						        			generator1.getChild( numAppr , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif"); // 자동결재 
						        		} else {
						        			generator1.getChild( numAppr , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
						        		}
						        	} else {
							        	generator1.getChild( numAppr , "personImage" ).setSrc("");
							        	generator1.getChild( numAppr , "personImage" ).hide("");
							        }
						        	numAppr++;
					        	}
					        	if (element.apld_apltype == "감사") {
						        	grd02Title.show("flex");
									generator2.insert();
				        			generator2.getChild( numAUD , "empname" ).setValue(element.empname);
						        	generator2.getChild( numAUD , "jikname" ).setValue(element.jikname);
						        	if (element.endTime != null) {
							        	generator2.getChild( numAUD , "personImage" ).show("");
						        		generator2.getChild( numAUD , "endTime" ).setValue(element.endTime.substr(0, 19));
						        		if (element.autoApproval == "Y") {
						        			generator2.getChild( numAUD , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif"); // 자동결재
						        		} else {
							        		generator2.getChild( numAUD , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
						        		}
						        	} else {
							        	generator2.getChild( numAUD , "personImage" ).setSrc("");
							        	generator2.getChild( numAUD , "personImage" ).hide("");
							        }
						        	numAUD++;
					        	}
					        	if (element.apld_apltype == "행동강령책임관") {
						        	grd02_02Title.show("flex");
									generator2_2.insert();
				        			generator2_2.getChild( numCON , "empname" ).setValue(element.empname);
						        	generator2_2.getChild( numCON , "jikname" ).setValue(element.jikname);
						        	if (element.endTime != null) {
							        	generator2_2.getChild( numCON , "personImage" ).show("");
						        		generator2_2.getChild( numCON , "endTime" ).setValue(element.endTime.substr(0, 19));
						        		if (element.autoApproval == "Y") {
						        			generator2_2.getChild( numCON , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif"); // 자동결재
						        		} else {
							        		generator2_2.getChild( numCON , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
						        		}
						        	} else {
							        	generator2_2.getChild( numCON , "personImage" ).setSrc("");
							        	generator2_2.getChild( numCON , "personImage" ).hide("");
							        }
						        	numCON++;
					        	}
					        	// 업무담당자만 세팅
								if (element.apld_apltype == "업무") {
									grd03Title.show("flex");
									generator3.insert();
				        			generator3.getChild( numWork , "empname" ).setValue(element.empname);
						        	generator3.getChild( numWork , "jikname" ).setValue(element.jikname);
						        	if (element.endTime != null) {
							        	generator3.getChild( numWork , "personImage" ).show("");
						        		generator3.getChild( numWork , "endTime" ).setValue(element.endTime.substr(0, 19));
						        		if (element.autoApproval == "Y") {
						        			generator3.getChild( numWork , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif"); // 자동결재
						        		} else {
							        		generator3.getChild( numWork , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
						        		}
						        	} else {
							        	generator3.getChild( numWork , "personImage" ).setSrc("");
							        	generator3.getChild( numWork , "personImage" ).hide("");
							        }
						        	numWork++;
					        	}
					        	if (element.apld_apltype == "협조") {
						        	grd04Title.show("flex");
									generator4.insert();
				        			generator4.getChild( numCOO , "empname" ).setValue(element.empname);
						        	generator4.getChild( numCOO , "jikname" ).setValue(element.jikname);
						        	if (element.endTime != null) {
							        	generator4.getChild( numCOO , "personImage" ).show("");
						        		generator4.getChild( numCOO , "endTime" ).setValue(element.endTime.substr(0, 19));
						        		if (element.autoApproval == "Y") {
						        			generator4.getChild( numCOO , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif"); // 자동결재
						        		} else {
							        		generator4.getChild( numCOO , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
						        		}
						        	} else {
							        	generator4.getChild( numCOO , "personImage" ).setSrc("");
							        	generator4.getChild( numCOO , "personImage" ).hide("");
							        }
						        	numCOO++;
					        	}
					        	if (element.apld_apltype == "수신") {
					        		dlt_user.setJSON([{ empcode : element.empcode, empsn : element.empsn, empname : element.empname, jikname : element.jikname, apld_apltype : "결재"}] , true);
						        	grd06Title.show("flex");
									generator6.insert();
				        			generator6.getChild( numSuSin , "empname" ).setValue(element.empname);
						        	generator6.getChild( numSuSin , "jikname" ).setValue(element.jikname);
						        	if (element.endTime != null) {
						        		btn_approvalLine.hide(""); // 수신에 결재가 존재하면 결재선편집 막기
						        		grp_baseAprLine.hide(""); // 수신에 결재가 전결 적용,미적용 막기
							        	generator6.getChild( numSuSin , "personImage" ).show("");
						        		generator6.getChild( numSuSin , "endTime" ).setValue(element.endTime.substr(0, 19));
						        		if (element.autoApproval == "Y") {
						        			generator6.getChild( numSuSin , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif");  // 자동결재
						        		} else {
							        		generator6.getChild( numSuSin , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
						        		}
						        	} else {
						        		if (0 == numSuSin) { // 수신처음 사용자일경우 결재선 편집 서브미션 호출
						        			scwin.gvar.acceptLineYn = "Y";
						        		}
							        	generator6.getChild( numSuSin , "personImage" ).setSrc("");
							        	generator6.getChild( numSuSin , "personImage" ).hide("");
							        }
						        	numSuSin++;
					        	}
				        	}
					 	);

						// 초기 전결라인 세팅 정보 조회 후 적용
						dma_user.set("endpoint", dma_snap.get("endpoint"));
						dma_user.set("procDefAlias", dma_snap.get("procDefAlias").substr(0, 3));
						dma_user.set("ruleType", dma_snap.get("ruleType"));
						dma_user.set("ruleMoney", dma_snap.get("ruleMoney"));
						dma_user.set("auditRolesSn", dma_snap.get("auditRolesSn"));
						dma_user.set("reqnum", dma_snap.get("procDefAlias").substr(0, 3));
						
						// DRAFT 모드일때만 결재라인을  세팅한다.
						if (dma_snap.get("viewMode") == "draft") {
							// scwin.applicationMap_set();
							dma_user.set("ruleAutoYn", "N");
							// 결재라인 삭제
							generator1.removeAll();
							generator2.removeAll();
							generator2_2.removeAll();
							grd01Title.hide();
							grd02Title.hide();
							grd02_02Title.hide();
							
							
							// 발명신고서 국외일때 연구소장 세팅 
							if(scwin.gvar.domOverseaClsf === "Y" && dma_user.get("procDefAlias") === "I01"){
								dma_user.set("ruleMoney", "20");
								dma_user.set("ruleType", "ADR010");
							}
							
							// endpoint 기준 기준 결재선 초기 세팅
							com.execute(sbm_selectBaseAprLine, {
								successCallback : function(e) {
									var numAppr = 0;
									var numAUD = 0;
									var numCON = 0;
									e.responseJSON.elData.aprUserListVo.forEach(
										function (element, index) {
											if (("Y" == scwin.gvar.lineAble || ("N" == scwin.gvar.lineAble && 0 == index)) && (element.apld_apltype != "AUDIT" && element.apld_apltype != "CONDUCT")) {
												grd01Title.show("flex");
												generator1.insert();
							        			generator1.getChild( numAppr , "empname" ).setValue(dlt_user.getCellData( index , "empname" ));
							        			if (index == 0) {
							        				generator1.getChild( numAppr , "jikname" ).setValue("상신");
							        			} else {
							        				generator1.getChild( numAppr , "jikname" ).setValue(dlt_user.getCellData( index , "jikname" ));
							        			}
							        			generator1.getChild( numAppr , "personImage" ).setSrc("");
									        	generator1.getChild( numAppr , "personImage" ).hide("");
									        	generator1.getChild( numAppr , "endTime" ).setValue("");
									        	numAppr++;
											} else if (element.apld_apltype == "AUDIT") {
									        	grd02Title.show("flex");
												generator2.insert();
							        			generator2.getChild( numAUD , "empname" ).setValue(element.empname);
									        	generator2.getChild( numAUD , "jikname" ).setValue(element.jikname);
									        	generator2.getChild( numAUD , "personImage" ).setSrc("");
									        	generator2.getChild( numAUD , "personImage" ).hide("");
									        	numAUD++;
								        	} else if (element.apld_apltype == "CONDUCT") {
									        	grd02_02Title.show("flex");
												generator2_2.insert();
							        			generator2_2.getChild( numCON , "empname" ).setValue(element.empname);
									        	generator2_2.getChild( numCON , "jikname" ).setValue(element.jikname);
									        	generator2_2.getChild( numCON , "personImage" ).setSrc("");
									        	generator2_2.getChild( numCON , "personImage" ).hide("");
									        	numCON++;
								        	}
										}
								 	);
								 	
								}
							});
						}
						
						// 수신모드 초기세팅(결재대기함에서 들어왔으며, 수신상태(recieve)이며, 기안자가 결재하지 않은 상태일때는 차상위자 세팅 진행)
						if (dma_snap.get("viewMode") == "approval" && dma_snap.get("linetype") == "recieve" & scwin.gvar.acceptLineYn == "Y") {
							// 결재라인 삭제
							generator6.removeAll();
							grd06Title.hide();
							// endpoint 기준 기준 결재선 초기 세팅
							com.execute(sbm_selectSuSinAprLine, {
								successCallback : function(e) {
									var numSuSin = 0;
									e.responseJSON.elData.aprUserListVo.forEach(
										function (element, index) {
								        	grd06Title.show("flex");
											generator6.insert();
						        			generator6.getChild( numSuSin , "empname" ).setValue(element.empname);
								        	generator6.getChild( numSuSin , "jikname" ).setValue(element.jikname);
								        	if (element.endTime != null) {
								        		btn_approvalLine.hide(""); // 수신에 결재가 존재하면 결재선편집 막기
									        	generator6.getChild( numSuSin , "personImage" ).show("");
								        		generator6.getChild( numSuSin , "endTime" ).setValue(element.endTime.substr(0, 19));
								        		if (element.autoApproval == "Y") {
								        			generator6.getChild( numSuSin , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/auto.gif");  // 자동결재
								        		} else {
									        		generator6.getChild( numSuSin , "personImage" ).setSrc(gcm.baseUrls.oldBizUrl+"/sign/"+element.empsn+".gif");
								        		}
								        	} else {
								        		if (0 == numSuSin) { // 수신처음 사용자일경우 결재선 편집 서브미션 호출
								        			scwin.gvar.acceptLineYn = "Y";
								        		}
									        	generator6.getChild( numSuSin , "personImage" ).setSrc("");
									        	generator6.getChild( numSuSin , "personImage" ).hide("");
									        }
								        	numSuSin++;
										}
								 	);
								}
							});
						}
						
						// 결재의견 조회
						generator5.removeAll();
						com.execute(SvcComAprDocM01, {
							successCallback : function(e) {
								generator5.removeAll();
								// 결재의견 정보 내림차순으로 정렬
								dlt_docComments.setJSON(dlt_docComments.getAllJSON().sort(function(a, b) {
								    return new Date(b.created_date).getTime() - new Date(a.created_date).getTime();
								}));
								e.responseJSON.elData.docCommentsVo.forEach(
									function (element, index) {
										generator5.insert();
					        			generator5.getChild( index , "empname" ).setValue(dlt_docComments.getCellData( index , "empname" ));
					        			generator5.getChild( index , "opt_type" ).setValue(dlt_docComments.getCellData( index , "opt_type" ));
					        			generator5.getChild( index , "created_date" ).setValue(dlt_docComments.getCellData( index , "created_date" ));
					        			generator5.getChild( index , "contents" ).setValue(dlt_docComments.getCellData( index , "contents" ).replaceAll("\n", "</br>"));
									}
							 	);	
							}
						});
					}
				});
			};
			
			scwin.getAppName = function() {
				if (dma_snap.get("appname") != "") {
					label_appName.setValue(dma_snap.get("appname"));
				} else {
					label_appName.setValue(dma_snap.get("defName"));
				}
				if (dma_snap.get("taskName") != "") {
					label_taskName.setValue(dma_snap.get("taskName"));
				} else {
					label_taskName.setValue("결재");
				}
				
			};
			
			
			/**
			 * 전결 설정
			 */
			scwin.applicationMap_set = function(e){
				let info = {};
				com.execute(sbm_selectData, {
					successCallback : function(e){
						dma_config.set("syspayno", dma_search.get("syspayno"));
						
						/**
						 * appv_applicationmap 테이블  rule_yn 컬럼 데이터 조회
						 * rule_yn : 0 = 전결 미적용 | 전결선택 숨김 
						 * rule_yn : 1 = 환경설정 자동전결 여부로 선택 | 전결선택 보임
						 * rule_yn : 3 = 전결 적용 | 전결선택 보임
						 */
						com.execute(SvcGetApplicationMap, {
					        successCallback: function (e) {
					          let ruleYn = dma_applicationMap.get("rule_yn");
					          switch (ruleYn) {
					            case "0":
					              // 전결선택 숨김
					              grp_baseAprLine.hide("");
					              // 전결 미적용
					              radio_gender.setSelectedIndex(1);
					              info = { value: "N" };
					              scwin.radio_gender_onchange(info);
					              break;
					            case "1":
					              // 전결선택 보임
					              grp_baseAprLine.show("");
					              if (dma_config.get("auto_rule_yn") == "Y") {
					                // 환경설정 자동전결여부 Y일때 전결 적용
					                radio_gender.setSelectedIndex(0);
									info = { value: "Y" };
					                scwin.radio_gender_onchange(info);
					              } else {
					                // 환경설정 자동전결여부 N일때 전결 미적용
					                radio_gender.setSelectedIndex(1);
					                info = { value: "N" };
					                scwin.radio_gender_onchange(info);
					              }
					              break;
					            case "3":
					              // 전결선택 보임
					              grp_baseAprLine.show("");
					              // 전결 적용
					              radio_gender.setSelectedIndex(0);
					              info = { value: "Y" };
					              scwin.radio_gender_onchange(info);
					              break;
					            default:
					              break;
					          }
					        },
					      });	
					}
				});
				
			}
			
			
			/**
			 * 결재 상신처리
			 */ 
			scwin.btn_submit_onclick = function(e) {
				dma_snap.set("instStatus", "Running");
				com.execute(SvcFormSubmit, {
					successCallback : function(e) {
						// 결재진행함으로 이동
						scwin.movePage("A005", "상신");					
					}
				});
			};
		
			/**
			 * 결재 반려처리
			 */
			scwin.btn_reject_onclick = function(e) {
				dma_snap.set("instStatus", "Running");
				var data = { data : dma_snap.getJSON()};
				var options = {
					id : "APR02P",
					popupName : "반려의견",
					width : 500, height: 300 
				};
				com.openPopup("/ui/apr/APR_C001_03P.xml", options, data, function(retObj) {
					if (retObj.comments != null) {
						dma_snap.set("comments", retObj.comments);
						com.execute(SvcFormReject, {
							successCallback : function(e) {								
								// 결재대기함으로 이동
								scwin.movePage("A003", "반려");																				
							}
						});
					}
				});
			};
			
			/**
			 * 결재 회수처리
			 */ 
			scwin.btn_compensate_onclick = function(e) {
				dma_snap.set("instStatus", "Running");
				com.execute(SvcFormCompensate, {
					successCallback : function(e) {
						// 작성중문서함으로 이동
						scwin.movePage("A010", "회수");
					}
				});
			};
			
			/**
			 * 라벨 프린트
			 */ 
			scwin.btn_label_onclick = function(e) {
				var url = gcm.baseUrls.oldBizUrl + "/websquare/popup.html?w2xPath=/kitech/saf/che/RaiseManageInfoSelPop.xml";
				var node = url+"&safeReqNo="+dma_snap.get("reqNo");
				node = node.replaceAll("amp;","");
				if(navigator.appName != "Microsoft Internet Explorer"){
					node = node.replaceAll("amp;","");
				}
				window.open(node,"", "width=550px, height=350px, location=no, resizable=yes");
				btn_accept.show("");	//결재
				btn_accept_comments.show("");	//결재
			}
	
			/**
			 * 결재선편집.
			 * @date 2022. 07. 26
			*/ 
			scwin.btn_approvalLine_onclick = function(e) {
				var data = { empcode : com.getLoginInfo("uid"), dlt_user : dlt_user.getAllJSON(), linetype : dma_snap.get("linetype")};
				var options = {
					id : "wframePopModal",
					popupName : "결재선 지정",
					width : 1000, height: 830 
				};
				
				com.openPopup("/ui/apr/popApprLine.xml", options, data, function(retObj) {
					// 1건 이상일 경우에 세팅
					if (retObj.length > 0) {
							dlt_user.setJSON(retObj, false);
						if (dma_snap.get("linetype") == "recieve") {
							generator6.removeAll();
							grd06Title.hide();
							var numSuSin = 0; // 수신 카운트
							for (i = 0 ; i < dlt_user.getRowCount() ; i++) {
								grd06Title.show("flex");
								generator6.insert();
								generator6.getChild( numSuSin , "empname" ).setValue(dlt_user.getCellData( i , "empname" ));
								generator6.getChild( numSuSin , "jikname" ).setValue(dlt_user.getCellData( i , "jikname" ));
								generator6.getChild( numSuSin , "personImage" ).setSrc("");
								generator6.getChild( numSuSin , "personImage" ).hide("");
								numSuSin++;
							}
						} else {
							generator1.removeAll();
							generator2.removeAll();
							generator2_2.removeAll();
							generator4.removeAll();
							grd01Title.hide();
							grd02Title.hide();
							grd02_02Title.hide();
							grd04Title.hide();
							
							var approval_num = 0; // 결재자 카운트
							var cooperation_num = 0; // 협조자 카운트
							var audit_num = 0; // 감사 카운트
							var con_num = 0; // 행동강령책임관 카운트
							for (i = 0 ; i < dlt_user.getRowCount() ; i++) {
								if (dlt_user.getCellData( i , "apld_apltype" ) == "APPROVAL" || dlt_user.getCellData( i , "apld_apltype" ) == "ARBITRARY_DECISION" || dlt_user.getCellData( i , "apld_apltype" ) == "상신") {
									grd01Title.show("flex");
									generator1.insert();
									generator1.getChild( approval_num , "empname" ).setValue(dlt_user.getCellData( i , "empname" ));
									if (dlt_user.getCellData( i , "apld_apltype" ) == "상신") {
										dlt_user.setCellData( i , "apld_apltype", "APPROVALSTRAT")
										generator1.getChild( approval_num , "jikname" ).setValue("상신");
									} else {
										generator1.getChild( approval_num , "jikname" ).setValue(dlt_user.getCellData( i , "jikname" ));
									}
									generator1.getChild( approval_num , "personImage" ).setSrc("");
									generator1.getChild( approval_num , "personImage" ).hide("");
									approval_num++;
								} else if (dlt_user.getCellData( i , "apld_apltype" ) == "AUDIT") {
									grd02Title.show("flex");
									generator2.insert();
									generator2.getChild( audit_num , "empname" ).setValue(dlt_user.getCellData( i , "empname" ));
									generator2.getChild( audit_num , "jikname" ).setValue(dlt_user.getCellData( i , "jikname" ));
									generator2.getChild( audit_num , "personImage" ).setSrc("");
									generator2.getChild( audit_num , "personImage" ).hide("");
									audit_num++;
								} else if (dlt_user.getCellData( i , "apld_apltype" ) == "CONDUCT") {
									grd02_02Title.show("flex");
									generator2_2.insert();
									generator2_2.getChild( con_num , "empname" ).setValue(dlt_user.getCellData( i , "empname" ));
									generator2_2.getChild( con_num , "jikname" ).setValue(dlt_user.getCellData( i , "jikname" ));
									generator2_2.getChild( con_num , "personImage" ).setSrc("");
									generator2_2.getChild( con_num , "personImage" ).hide("");
									con_num++;									
								} else if (dlt_user.getCellData( i , "apld_apltype" ) == "COOPERATION") {
									grd04Title.show("flex");
									generator4.insert();
									generator4.getChild( cooperation_num , "empname" ).setValue(dlt_user.getCellData( i , "empname" ));
									generator4.getChild( cooperation_num , "jikname" ).setValue(dlt_user.getCellData( i , "jikname" ));
									generator4.getChild( cooperation_num , "personImage" ).setSrc("");
									generator4.getChild( cooperation_num , "personImage" ).hide("");
									cooperation_num++;
								}
								
							}
						}
					}
				});
			};			
			
			function createForm(nm, tg, act, met) {
				var cForm = document.createElement("form");
				cForm.name = nm;
				cForm.target = tg;
				cForm.action = act;
				cForm.method = met;
				
				return cForm;
			}
			
			function createHidden(nm, val, frm) {
				/*IE9, IE10, 크롬 등에서 호환성 보기 없이 실행되도록 보완(2013.07.29)*/
				var	hiddenInput	=	document.createElement("input");
				
				/*
				hiddenInput.type="hidden";
				hiddenInput.name=nm;
				hiddenInput.value=val;
				frm.insertBefore(hiddenInput);
					*/
					
				hiddenInput.setAttribute("type", "hidden");
				hiddenInput.setAttribute("name", nm);
				hiddenInput.setAttribute("value", val);
				frm.appendChild(hiddenInput);
				
				return frm;
			}
			
			/* 사양서 팝업 */
			function openPurReqSpecPop (pPurReqNo, pCn, pSn, pBizoucode, pMaxStateCd) {
				/*window.open("","spec28",'width=1008,height=420,top=50,left=150');*/
				window.open("","spec28", "width=1008,height=420,top=50,left=150,location=no, status=no");
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", "spec28", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurReqSpecPop.xml", frm);
				frm = createHidden("popupID", "spec28", frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("purReqNo", pPurReqNo, frm);
				frm = createHidden("cn", pCn, frm);
				frm = createHidden("sn", pSn, frm);
				frm = createHidden("bizoucode", pBizoucode, frm);
				frm = createHidden("serviceId", "P101", frm);
				
				if ( pMaxStateCd == "" ) {
					frm = createHidden("maxStateCd", "XAD100", frm);
				} else {
					frm = createHidden("maxStateCd", pMaxStateCd, frm);
				}
				
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				frm = createHidden("page_gbn", "first", frm );  /* 사양서를 호출하는 페이지가 구매요구인지, 검수인지 구분 */
				
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 용도설명서 팝업 */
			function openPurReqUsgPop (pPurReqNo, pCn, pSn, pBizoucode, pMaxStateCd) {
				window.open("","usg76",'width=1010,height=435,top=50,left=150');
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", "usg76", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurReqUsgPop.xml", frm);
				frm = createHidden("popupID", "usg76", frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("purReqNo", pPurReqNo, frm);
				frm = createHidden("cn", pCn, frm);
				frm = createHidden("sn", pSn, frm);
				frm = createHidden("bizoucode", pBizoucode, frm);	
				frm = createHidden("serviceId", "P102", frm);
				
				if ( pMaxStateCd == "" ) {
					frm = createHidden("maxStateCd", "XAD100", frm);
				} else {
					frm = createHidden("maxStateCd", pMaxStateCd, frm);
				}
				
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				
				document.body.appendChild(frm);	
				frm.submit();
			}
			
			/* 견적서 팝업 */
			function openPurReqEstimPop (pPurReqNo, pCn, pSn, pBizoucode, pMaxStateCd) {
				window.open("","estim82",'width=753,height=362,top=50,left=150');
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", "estim82", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurReqEstimPop.xml", frm);
				frm = createHidden("popupID", "estim82", frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("purReqNo", pPurReqNo, frm);
				frm = createHidden("cn", pCn, frm);
				frm = createHidden("sn", pSn, frm);
				frm = createHidden("bizoucode", pBizoucode, frm);
				frm = createHidden("serviceId", "P103", frm);
				
				if ( pMaxStateCd == "" ) {
					frm = createHidden("maxStateCd", "XAD100", frm);
				} else {
					frm = createHidden("maxStateCd", pMaxStateCd, frm);
				}
				
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 특정구매사유서 팝업 */
			function openPurReqSpcficPop (pPurReqNo, pCn, pSn, pBizoucode, pMaxStateCd, pAccntNo, pGdnm, pEstiAmt, pDelvrDemndDaycnt) {
				window.open("","spcfic89",'width=1023,height=575,top=50,left=150');
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", "spcfic89", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurReqSpcficPop.xml", frm);
				frm = createHidden("popupID", "spcfic89", frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("purReqNo", pPurReqNo, frm);
				frm = createHidden("cn", pCn, frm);
				frm = createHidden("sn", pSn, frm);
				frm = createHidden("bizoucode", pBizoucode, frm);
				frm = createHidden("serviceId", "P104", frm);
				
				if ( pMaxStateCd == "" ) {
					frm = createHidden("maxStateCd", "XAD100", frm);
				} else {
					frm = createHidden("maxStateCd", pMaxStateCd, frm);
				}
				
				frm = createHidden("accntNo", pAccntNo, frm);
				frm = createHidden("gdnm", pGdnm, frm);
				frm = createHidden("estiAmt", pEstiAmt, frm);
				frm = createHidden("delvrDemndDaycnt", pDelvrDemndDaycnt, frm);
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 시방서, 긴급구매사유서, 사업계획, 과업지시서   팝업 */
			function openPurReqDelyPop (pPurReqNo, pCn, pSn, pBizoucode, pMaxStateCd, gbn) {
				var win = "";
				
				if (gbn == "G") {	/*시방서*/
					win = "dely28";
				} else if (gbn == "H") {	/*긴급구매사유서*/
					win = "dely29";
				} else if (gbn == "J") {	/*사업계획*/
					win = "dely31";
				} else {	/* K:과업지시서*/
					win = "dely32";
				}
				
				if (gbn == "G") {
					window.open("",win,'width=1023,height=330,top=50,left=150,scrollbars=yes');
				} else {
					window.open("",win,'width=1023,height=330,top=50,left=150');
				}
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", win, "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurReqDelyPop.xml", frm);
				frm = createHidden("popupID", win, frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("purReqNo", pPurReqNo, frm);
				frm = createHidden("cn", pCn, frm);
				frm = createHidden("sn", pSn, frm);
				frm = createHidden("bizoucode", pBizoucode, frm);
				frm = createHidden("serviceId", "P106", frm);
				
				if ( pMaxStateCd == "" ) {
					frm = createHidden("maxStateCd", "XAD100", frm);
				} else {
					frm = createHidden("maxStateCd", pMaxStateCd, frm);
				}
				
				frm = createHidden("clsfCd", gbn, frm);
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 원가계산서 팝업  */
			function openPurReqCostPop (pPurReqNo, pCn, pSn, pBizoucode, pMaxStateCd, gbn, purClsfCd) {
				if (purClsfCd == "PBA030") { /* 구매구분 : 공사 */
					gbn = "D";
				}
				
				window.open("","cost89",'width=1023,height=477,top=50,left=150');
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", "cost89", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurReqCostPop.xml", frm);
				frm = createHidden("popupID", "cost89", frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("purReqNo", pPurReqNo, frm);
				frm = createHidden("cn", pCn, frm);
				frm = createHidden("sn", pSn, frm);
				frm = createHidden("bizoucode", pBizoucode, frm);
				frm = createHidden("serviceId", "P105", frm);
				
				if ( pMaxStateCd == "" ) {
					frm = createHidden("maxStateCd", "XAD100", frm);
				} else {
					frm = createHidden("maxStateCd", pMaxStateCd, frm);
				}
				
				frm = createHidden("clsfCd", gbn, frm);
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 연구장비심의  */
			function openPurEquipConsttnPop (pPurReqNo, pSn, pMaxStateCd) {
				
				window.open("","equipCons",'width=712,height=287,top=50,left=150');
				
				var idx = (new Date()).getTime() + Math.random() * 10000;
				var frm = createForm("popFrm", "equipCons", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/pur/req/PurEquipConsttnPopup.xml", frm);
				frm = createHidden("popupID", "equipCons", frm);
				frm = createHidden("idx", idx, frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("pur_req_no", pPurReqNo, frm);
				frm = createHidden("sn", pSn, frm);	
				frm = createHidden("serviceId", "P115", frm);
				frm = createHidden("apr_state", pMaxStateCd, frm);	
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 품목코드  */
			
			
			function openitemPop (pur_req_no,item_odr)  {
				window.open("","equipCons",'width=800,height=685,top=50,left=150');
				var frm = createForm("popFrm", "equipCons", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/epu/bas/EpuBasItmGpMnt.xml", frm);
				frm = createHidden("popupID", "equipCons", frm);
				frm = createHidden("w2xHome", "/kitech/epu/bas/", frm);
				frm = createHidden("pur_req_no", pur_req_no, frm);
				frm = createHidden("item_odr", item_odr, frm);
				frm = createHidden("flag", "U", frm);
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/* 연구 기자재 내역 */
			function openEquipPop(accntNo){
				window.open("","equipCons",'width=755,height=405,top=100,left=100');
				var frm = createForm("popFrm", "equipCons", "https://biz.kitech.re.kr/websquare/popup.html", "get");
				frm = createHidden("w2xPath", "/kitech/res/com/ResComEquipSel.xml", frm);
				frm = createHidden("popupID", "equipCons", frm);
				frm = createHidden("w2xHome", "/kitech/pur/req/", frm);
				frm = createHidden("accnt_no", accntNo, frm);
				frm = createHidden("searchYn", "Y", frm);
				frm = createHidden("gfnYn", "N", frm);
				frm = createHidden("requestFlag", "H", frm); /* 웹스퀘어에서 요청 : W, 결재(HTML)에서 요청 : H */
				document.body.appendChild(frm);
				frm.submit();
			}
			
			/**
			 * 스냅샷 첨부파일 다운로드 함수
			 * 	- WebSqaure scope 가 적용되지 않음
			 *
			 * @date 2022. 07. 27
			 * @param 첨부파일번호+순번, 업무코드(XAA)
			 * @author OWNER
			*/ 
			function downloadForXsl(fileName, bizKind){
				biz.apr.downloadForXsl(fileName, bizKind);
			}
			
			function xslFileDownload(fileName, bizKind){
			    var fileNameArr = fileName.split('/');
				var fileNameStr = fileNameArr[3];
			    if(fileNameStr === undefined) biz.apr.downloadForXsl(fileName, bizKind);
				if(fileNameStr !== undefined && bizKind === undefined) biz.apr.downloadForXsl(fileNameStr, null);
			}
			
			/* 증빙구분 팝업 */
			function openItmEvidPop(unslip_no,unslip_odr,expns_cd,service_id, sn) {
				var data = {
					unslip_no : unslip_no,
					unslip_odr : unslip_odr,
					expns_cd : expns_cd
				};
				
				var option;
				var url;
				switch(service_id){
					case "F236" : // 교육(학회/세미나)증빙정보	
						url = "/ui/fin/pop/FIN_POP_F201_08P.xml"
						option={ width: 1000, height: 600, id: "evidPop", popupName: "교육(학회/세미나)정보"};
						break;
					case "F237" : // 회의증빙정보
					    url = "/ui/fin/pop/FIN_POP_F201_06P.xml"
						option={width: 850, height: 580, id: "evidPop", popupName: "회의증빙"};
						break;
					case "F238" : // 특근자정보
						url = "/ui/fin/pop/FIN_POP_F201_07P.xml"
						option={width: 850, height: 550, id: "evidPop", popupName: "특근증빙정보"};
						break;
					case "F239" : // 전문가활용정보
						url = "/ui/fin/pop/FIN_POP_F201_09P.xml"
						option={width: 1000, height: 550, id: "evidPop", popupName: "전문가활용정보"};
						break;
				}
				
				com.openPopup(url, option, data);
			}
			

			/* 크리스피드 이원길 미리보기 시작 */
			function openEvidWindow(unslipNo){
				var url = "http://evid.kitech.re.kr/sd/view?CLS=00&amp;amp;amp;amp;RESL_NO=" + unslipNo + "&amp;amp;amp;amp;EMP_NO=" + unslipNo;
				url = url.replaceAll("amp;","");
				window.open(url, "_blank", "toolbar=no, menubar=no, scrollbars=yes, resizable=yes");
			}
			
			/* 라벨 프린트  */
			function openLabelPrint(safeReqNo){
				var url = "https://biz.kitech.re.kr/websquare/popup.html?w2xPath=/kitech/saf/che/RaiseManageInfoSelPop.xml";
				var node = url+"&safeReqNo="+safeReqNo;
				node = node.replaceAll("amp;","");
				if(navigator.appName != "Microsoft Internet Explorer"){
					node = node.replaceAll("amp;","");
				}
				window.open(node,"", "width=550px, height=350px, location=no, resizable=yes");
				gyolJae.show();
				gyolJaeCt.show();
				//$("#LabelWrap").hide();
			}
			/* 사진화일  */
			function openPhotoFile (photoFileNo) {						
				var photoUrl = "https://biz.kitech.re.kr/bizimages/pur/attach/"+photoFileNo;	
				window.open(photoUrl, "", "width=1024, height=768, toolbar=no, menubar=no, resizable=yes, titlebar=yes");
			}
			
			/* 사전 안전성 검토 */
			function openSafeDodfpr(safeReqNo){
				var ozFileNm = "/ccs/csf/SafeDodfprRegistMnt.ozr";
				var ozrNm = "SafeDodfprRegistMnt";
				var url = "https://biz.kitech.re.kr/websquare/popup.html?w2xPath=/kitech/com/oz/ComPopupOZReport.xml";
				var node = url+"&ozr="+ozFileNm+"&odi="+ozrNm+"&printMode=Y&param=req_no^"+safeReqNo;
				node = node.replaceAll("amp;","");
				if(navigator.appName != "Microsoft Internet Explorer"){
					node = node.replaceAll("amp;","");
				}
				window.open(node,"OZReport", "width=1012px, height=610px, location=no, resizable=yes");   
				
			}
			
			
	
			/* 삭제기능(사용안할 시 삭제) */
			scwin.btn_apr_del_onclick = function(e) {
				com.execute(SvcDeleteApr, {
					successCallback : function(e) { // 성공 콜백
						$(wfSnap.render).html(e.responseJSON.elData.html);
					}
				});
			};
	
		   /**
			* 결재(승인) 처리
			* @date 2022. 08. 02
			*/ 
			scwin.btn_accept_onclick = function(e) {
				dma_snap.set("instStatus", "Running");
				dma_snap.set("aprState", "XAD050");
				if ("N" == scwin.gvar.acceptLineYn) {
					com.execute(SvcFormAccept, {
						successCallback : function(e) {
							debugger;
							// 예산통제자승인 화면일 경우 결재 이벤트 성공시 메세지 없이 화면만 리로드 처리 - 유선희 요청(XC220220321E)
							var parentServiceID = null;
							try {
								parentServiceID = scwin.$w.parent().$p.getParentWindow().scwin.menuObj.serviceID;
							} catch (prentExcpetion) {
								parentServiceID = null;
							}
							
							if(parentServiceID != null && parentServiceID.indexOf("B504") > -1) {
								if (scwin.$w.parent().scwin.$w.parent().btn_inst_search) {								
									scwin.$w.parent().scwin.$w.parent().btn_inst_search.trigger('click');
								} else if (scwin.$w.parent().scwin.$w.parent().btn_search) {
									scwin.$w.parent().scwin.$w.parent().btn_search.trigger('click');
								}
							} else {
								com.alert("결재 승인 처리 되었습니다.", function(){
									if (scwin.$w.parent().scwin.$w.parent().btn_inst_search) {								
										scwin.$w.parent().scwin.$w.parent().btn_inst_search.trigger('click');
									} else if (scwin.$w.parent().scwin.$w.parent().btn_search) {
										scwin.$w.parent().scwin.$w.parent().btn_search.trigger('click');
									}
								});
							}
						}
					});
				} else {
					// 수신결재일경우 라인 편집이 필요 하여 다른 서브미션 호출
					com.execute(SvcFormAcceptLineSet, {
						successCallback : function(e) {
							com.alert("결재 승인 처리 되었습니다.", function(){
								if (scwin.$w.parent().scwin.$w.parent().btn_inst_search) {								
									scwin.$w.parent().scwin.$w.parent().btn_inst_search.trigger('click');
								} else if (scwin.$w.parent().scwin.$w.parent().btn_search) {
									scwin.$w.parent().scwin.$w.parent().btn_search.trigger('click');
								}
							});
						}
					});
				}
			};
			
			scwin.btn_accept_comments_onclick = function(e) {
				dma_snap.set("instStatus", "Running");
				var data = { data : dma_snap.getJSON()};
				var options = {
					id : "APR02P",
					popupName : "결재의견",
					width : 500, height: 300 
				};
				com.openPopup("/ui/apr/APR_C001_04P.xml", options, data, function(retObj) {
					if (retObj.comments != null) {
						dma_snap.set("comments", retObj.comments);
						if ("N" == scwin.gvar.acceptLineYn) {
							com.execute(SvcFormAccept, {
								successCallback : function(e) { // 성공 콜백
									com.alert("결재 처리 되었습니다.", function(){
										if (scwin.$w.parent().scwin.$w.parent().btn_inst_search) {								
											scwin.$w.parent().scwin.$w.parent().btn_inst_search.trigger('click');
										} else if (scwin.$w.parent().scwin.$w.parent().btn_search) {
											scwin.$w.parent().scwin.$w.parent().btn_search.trigger('click');
										}
									});
								}
							});
						} else {
							// 수신결재일경우 라인 편집이 필요 하여 다른 서브미션 호출
							com.execute(SvcFormAcceptLineSet, {
								successCallback : function(e) { // 성공 콜백
									com.alert("결재 처리 되었습니다.", function(){
										if (scwin.$w.parent().scwin.$w.parent().btn_inst_search) {								
											scwin.$w.parent().scwin.$w.parent().btn_inst_search.trigger('click');
										} else if (scwin.$w.parent().scwin.$w.parent().btn_search) {
											scwin.$w.parent().scwin.$w.parent().btn_search.trigger('click');
										}
									});
									
								}
							});
						}
					}
				});
			};
	
			scwin.btn_submit_comments_onclick = function(e) {
				dma_snap.set("instStatus", "Running");
				var data = { data : dma_snap.getJSON()};
				var options = {
					id : "APR02P",
					popupName : "상신의견",
					width : 500, height: 300 
				};
				com.openPopup("/ui/apr/APR_C001_02P.xml", options, data, function(retObj) {
					if (retObj.comments != null) {
						dma_snap.set("comments", retObj.comments);
						dma_snap.set("instStatus", "Running");
							com.execute(SvcFormSubmit, {
							successCallback : function(e) {
								// 결재진행함으로 이동
								scwin.movePage("A005", "상신");		
							}
						});
					}
				});
			};
			
			
			scwin.btnAllHide = function() {
				btn_collect.hide();
			};
			
			/**
			 * 대기함별 버튼컨트롤
			 * @date 2022. 08. 02
			 */ 
			scwin.btnControl = function(proc) {
				grp_docMain.show("");
				
				// 모든버튼을 숨긴뒤 필요한 업무에만 보여주기
				btn_submit_comments.hide("");	 //상신의견
				btn_accept.hide("");	//결재
				btn_accept_comments.hide("");	//결재의견
				btn_label.hide("");	//반려
				btn_approvalLine.hide(""); //결재선지정
				btn_submit.hide("");	//상신
				btn_reject.hide("");	//반려
				btn_reject_auth.hide("");	//담당자반려
				btn_compensate.hide(""); //회수
				btn_print.hide(""); //인쇄
					
				switch (proc) {
				case "complete": case "instead":
					btn_print.show(""); //인쇄
					break;
				case "draft":
					btn_submit_comments.show("");	 //상신의견
					btn_submit.show("");	//상신
					break;
				case "running":
					btn_compensate.show(""); //회수
					btn_print.show(""); //인쇄
					break;
				case "approval":
					btn_accept.show("");	//결재
					btn_accept_comments.show("");	//결재의견
					btn_reject.show("");	//반려
					btn_print.show(""); //인쇄
					break;
				case "alias":
					btn_reject_auth.show("");	//담당자반려
					btn_print.show(""); //인쇄
					break;
				case "blank":	// 스냅샷 불필요한 리스트: 스냅샷 전체 숨김 (TOBO: 안내 메시지 필요)
					grp_docMain.hide("");
					break;
				case "read":	// 결재문서 보기: 모든 버튼 숨김
					btn_print.show(""); //인쇄
					break;
				}
			};
	
			// 위임전결규정
			scwin.btn_regulation_onclick = function() {
				var url = "https://rule.kitech.re.kr/web/regulation/regulationViewPop.do?OBOOKID=1000794";
				var width = 1400;
				var height = 1000;
				var left = screen.width / 2 - width / 2;
				var top = screen.height / 2 - height / 2;
				var baseShape = 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no';
				window.open(url, "위임전결구정", baseShape + ', width='+width+', height='+height+', top='+top+', left='+left);
			};
			
			// 양식별 업무규정
			scwin.btn_regulation_doc_onclick = function() {
				var url = dma_snap.get("regulationUrl");
				if (url == "") {
					alert("양식별 업무규정이 존재하지 않습니다.");
					return;
				}
				var width = 1400;
				var height = 1000;
				var left = screen.width / 2 - width / 2;
				var top = screen.height / 2 - height / 2;
				var baseShape = 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no';
				window.open(url, "위임전결구정", baseShape + ', width='+width+', height='+height+', top='+top+', left='+left);
			};
			
			// 양식별 위임전결규정
			scwin.btn_regulation_alias_doc_onclick = function() {
				var appCode = "";
				if (dma_snap.get("instAlias") == "" && dma_snap.get("procDefAlias") == "") {
					alert("양식별 위임전결규정이 존재하지 않습니다.");
					return;
				}
				
				if (dma_snap.get("instAlias") == "") {
					appCode = dma_snap.get("procDefAlias").substr(0, 3);
				} else {
					appCode = dma_snap.get("instAlias");
				}
				
				var url = "https://biz.kitech.re.kr/websquare/popup.html?w2xPath=/kitech/com/ComPopupAprDlgArbtDcsRule.xml&app_code=" + appCode;
				var width = 750;
				var height = 320;
				var left = screen.width / 2 - width / 2;
				var top = screen.height / 2 - height / 2;
				var baseShape = 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no';
				window.open(url, "위임전결구정", baseShape + ', width='+width+', height='+height+', top='+top+', left='+left);
			};
	
			// 인쇄 보기
			scwin.btn_print_onclick = function(e) {
				var formAliasVal = dma_snap.get("instAlias").trim();
				com.oz.openPopup( {
					formAlias : "" != formAliasVal ? formAliasVal : dma_snap.get("reqNo").substring(0,3),
					reqNo : dma_snap.get("reqNo"),
					snapFrame : grp_docMain.getID()
				});
			};
	
			// 담당자반려함
			scwin.btn_reject_auth_onclick = function(e) {
				// AS-IS 데이타일경우 담당자 반려시 인스턴스ID가 존재 하지 않을 경우 막기
				if (dma_snap.get("asistype") == "1" && dma_snap.get("instId") == "") {
					alert("INSTID가 존재 하지 않습니다. 시스템문의 바랍니다.");
					return;
				}
				
				var data = { data : dma_snap.getJSON()};
				var options = {
					id : "APR02P",
					popupName : "반려의견",
					width : 500, height: 300 
				};
				com.openPopup("/ui/apr/APR_C001_03P.xml", options, data, function(retObj) {
					if (retObj.comments != null) {
						dma_snap.set("comments", retObj.comments);
						com.execute(SvcAuthReject, {
							successCallback : function(e) { // 성공 콜백
								// 담당자반려함으로 이동
								scwin.movePage("A008", "반려");							
							}
						});
					}
				});
			};
	
			scwin.radio_gender_onchange = function(info) {
				dma_user.set("ruleAutoYn", info.value);
				
				// 발명신고서 국외일때 연구소장 세팅
				if(scwin.gvar.domOverseaClsf === "Y" && dma_user.get("procDefAlias") === "I01"){
					dma_user.set("ruleMoney", "20");
					dma_user.set("ruleType", "ADR010");
				}
				
				
				// 결재라인 삭제
				generator1.removeAll();
				generator2.removeAll();
				generator2_2.removeAll();
				grd01Title.hide();
				grd02_02Title.hide();
				if("Y" == info.value) {
					// endpoint 기준 기준 결재선 초기 세팅
					com.execute(sbm_selectBaseAprLine, {
						successCallback : function(e) {
							var numAppr = 0;
							var numAUD = 0;
							var numCON = 0;
							e.responseJSON.elData.aprUserListVo.forEach(
								function (element, index) {
									if (element.apld_apltype != "AUDIT" && element.apld_apltype != "CONDUCT") {
										grd01Title.show("flex");
										generator1.insert();
					        			generator1.getChild( numAppr , "empname" ).setValue(dlt_user.getCellData( index , "empname" ));
					        			if (index == 0) {
					        				generator1.getChild( numAppr , "jikname" ).setValue("상신");
					        			} else {
					        				generator1.getChild( numAppr , "jikname" ).setValue(dlt_user.getCellData( index , "jikname" ));
					        			}
					        			generator1.getChild( numAppr , "personImage" ).setSrc("");
							        	generator1.getChild( numAppr , "personImage" ).hide("");
							        	generator1.getChild( numAppr , "endTime" ).setValue("");
							        	numAppr++;
						        	} else if (element.apld_apltype == "AUDIT") {
										grd02Title.show("flex");
										generator2.insert();
										generator2.getChild( numAUD , "empname" ).setValue(element.empname);
										generator2.getChild( numAUD , "jikname" ).setValue(element.jikname);
										generator2.getChild( numAUD , "personImage" ).setSrc("");
										generator2.getChild( numAUD , "personImage" ).hide("");
										numAUD++;
									} else if (element.apld_apltype == "CONDUCT") {
										grd02_02Title.show("flex");
										generator2_2.insert();
										generator2_2.getChild( numCON , "empname" ).setValue(element.empname);
										generator2_2.getChild( numCON , "jikname" ).setValue(element.jikname);
										generator2_2.getChild( numCON , "personImage" ).setSrc("");
										generator2_2.getChild( numCON , "personImage" ).hide("");
										numCON++;
									}
								}
						 	);
						 	/*if(dlt_user.getDataLength() === 1){
								radio_gender.setSelectedIndex(1);
								let dataParam = {value: 'N'};
								scwin.radio_gender_onchange(dataParam);
							}*/
						}
					});
				} else {
					// endpoint 기준 기준 결재선 초기 세팅
					com.execute(sbm_selectBaseAprLineAll, {
						successCallback : function(e) {
							var numAppr = 0;
							var numAUD = 0;
							var numCON = 0;
							e.responseJSON.elData.aprUserListVo.forEach(
								function (element, index) {
									if (element.apld_apltype != "AUDIT" && element.apld_apltype != "CONDUCT") {
										grd01Title.show("flex");
										generator1.insert();
					        			generator1.getChild( numAppr , "empname" ).setValue(dlt_user.getCellData( index , "empname" ));
					        			if (index == 0) {
					        				generator1.getChild( numAppr , "jikname" ).setValue("상신");
					        			} else {
					        				generator1.getChild( numAppr , "jikname" ).setValue(dlt_user.getCellData( index , "jikname" ));
					        			}
					        			generator1.getChild( numAppr , "personImage" ).setSrc("");
							        	generator1.getChild( numAppr , "personImage" ).hide("");
							        	generator1.getChild( numAppr , "endTime" ).setValue("");
							        	numAppr++;
						        	} else if (element.apld_apltype == "AUDIT") {
										grd02Title.show("flex");
										generator2.insert();
										generator2.getChild( numAUD , "empname" ).setValue(element.empname);
										generator2.getChild( numAUD , "jikname" ).setValue(element.jikname);
										generator2.getChild( numAUD , "personImage" ).setSrc("");
										generator2.getChild( numAUD , "personImage" ).hide("");
										numAUD++;
									} else if (element.apld_apltype == "CONDUCT") {
										grd02_02Title.show("flex");
										generator2_2.insert();
										generator2_2.getChild( numCON , "empname" ).setValue(element.empname);
										generator2_2.getChild( numCON , "jikname" ).setValue(element.jikname);
										generator2_2.getChild( numCON , "personImage" ).setSrc("");
										generator2_2.getChild( numCON , "personImage" ).hide("");
										numCON++;
									}
								}
						 	);
						}
					});
				}
			};
		]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload" class="snapshot_body">
    	<xf:group class="helparea" id="grp_docEmpty" style="padding:30px;display:none;">
    		<w2:textbox id="" label="본문을 보려면 목록을 클릭하세요." tagname="h3"></w2:textbox>
    		<xf:group tagname="ul" style="padding:10px">
    			<xf:group tagname="li">
    				<w2:textbox class="red" label="양식명이나 문서제목 클릭시 세부화면이 표시됩니다." tagname="span"></w2:textbox>
    			</xf:group>
    		</xf:group>
    	</xf:group>
		<xf:group class="docWrap" id="grp_docMain">
			<xf:group class="doc_header" id="">
				<xf:group class="topline" id="grp_btnCollect" style="visibility:hidden;">
					<w2:textbox class="" id="label_taskName" label="" style="" tagname="em"></w2:textbox>
					<xf:trigger class="btn icon print" id="btn_print" style="margin-left: 5px;" type="button" ev:onclick="scwin.btn_print_onclick">
						<xf:label><![CDATA[인쇄]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" id="btn_compensate" style="" type="button" ev:onclick="scwin.btn_compensate_onclick">
						<xf:label><![CDATA[회수]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" id="btn_reject" style="" type="button" ev:onclick="scwin.btn_reject_onclick">
						<xf:label><![CDATA[반려]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" ev:onclick="scwin.btn_submit_onclick" id="btn_submit" style="" type="button">
						<xf:label><![CDATA[상신]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" id="btn_submit_comments" style="" type="button" ev:onclick="scwin.btn_submit_comments_onclick">
						<xf:label><![CDATA[상신+의견]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" ev:onclick="scwin.btn_accept_onclick" id="btn_accept" style="" type="button">
						<xf:label><![CDATA[결재]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" ev:onclick="scwin.btn_accept_comments_onclick" id="btn_accept_comments" style="" type="button">
						<xf:label><![CDATA[결재+의견]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" ev:onclick="scwin.btn_label_onclick" id="btn_label" style="" type="button">
						<xf:label><![CDATA[라벨]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn icon print" ev:onclick="scwin.btn_approvalLine_onclick" id="btn_approvalLine" style="" type="button">
						<xf:label><![CDATA[결재선 지정]]></xf:label>
					</xf:trigger>
					<xf:group class="divJunGyul" id="grp_baseAprLine" style="" tagname="div">
						<w2:textbox class="" id="" label="전결" style="margin-left: 5px;" tagname="span"></w2:textbox>
						<xf:select1 appearance="full" class="radioGroup" cols="" id="radio_gender" ref=""
							renderType="radiogroup" rows="" selectedIndex="-1" style="margin-left: 15px;" ev:onviewchange="scwin.radio_gender_onchange">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[적용]]></xf:label>
									<xf:value><![CDATA[Y]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[미적용]]></xf:label>
									<xf:value><![CDATA[N]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
					</xf:group>
					<xf:trigger class="btn icon print" id="btn_reject_auth" style="" type="button" ev:onclick="scwin.btn_reject_auth_onclick">
						<xf:label><![CDATA[담당자반려]]></xf:label>
					</xf:trigger>
				</xf:group>
				<xf:group class="titleline" id="">
					<w2:textbox class="" id="label_appName" label="" style="" tagname="h2"></w2:textbox>
					
				</xf:group>


				<style><![CDATA[
					.titleruleline {position:relative;height:35px; width:450px;}
					.titleruleline > .link {position:absolute;right:0;bottom:1px;}
					.titleruleline > .link a {display:inline-block;padding-left:20px;background:url(/cm/images/ico_link.png) no-repeat left center;color:#777;text-decoration:none;}
					.titleruleline > .link a + a {margin-left:20px;}				
					.approval .grd01{margin-left: 5px;display: inline-block;}
					.approval .grd02{display: inline-block;}
					.approval .grd02 .sign_label{margin-left: 5px;}
					.approval .grd02_02 .sign_label{margin-left: 5px;}
					.approval .grd06{display: inline-block;}
					.approval .grd06 .sign_label{margin-left: 5px;}
					.approval .grd03{margin-left: 5px;display: inline-block;}
					.approval .grd04{display: inline-block;}
					.approval .grd04 .sign_label{margin-left: 5px;}
					.approval .grd01 .generatorWrap{max-width: 510px}
					.approval .grd02 .generatorWrap{max-width: 255px;}
					.approval .grd06 .generatorWrap{}
					.approval .grd03 .generatorWrap{max-width: 510px;}
					.approval .grd04 .generatorWrap{}
					
					.approval .signWrap{display: flex;}
					.approval .signWrap .sign_label{min-width: 25px;display: flex;flex-wrap: wrap;align-content: center;border: 1px solid #003b8f;justify-content: center;background-color: #e9ecf5;flex-direction: row;margin-bottom: 5px;}
					.approval .signWrap .generatorWrap{height: 100%;display: inline-flex;flex-direction: row;flex-wrap: wrap;}
					.approval .signWrap .generatorWrap .generatorSection {display: inline-table;border-collapse: collapse;width: 85px;text-align: center;margin-bottom: 5px;}
					.approval .signWrap .generatorWrap .generatorSection .jikname{min-height:20px;border: 1px solid #003b8f;border-left: none;background-color: #e9ecf5;display: table-row;}
					.approval .signWrap .generatorWrap .generatorSection .jikname p span{padding:1px 1px;display: block;font-weight: bold;}
					.approval .signWrap .generatorWrap .generatorSection .empname{height:20px;border: 1px solid;display: table-row;border-left: none;white-space: nowrap;}
					.approval .signWrap .generatorWrap .generatorSection .pic_person{height:42px;border: 1px solid;display: table-row;border-left: none;}
					.approval .signWrap .generatorWrap .generatorSection .pic_person img{width:60px;height:40px;}
					.approval .signWrap .generatorWrap .generatorSection .endTime{height:30px;border: 1px solid;display: table-row;border-left: none;line-height: 11px;}
					.approval .signWrap .generatorWrap .generatorSection p{display: table-cell;vertical-align: middle;}
					.divJunGyul {display:inline-block;width: 180px;line-height: 20px;margin-left: 5px;color: #7A7A7A;border: 1px solid #C7C7C7;background-image: linear-gradient(#FCFCFC, #E3E3E3);border-radius: 4px;float:right;}
					.w2radio_label input[type="radio"]:checked + label::before {    content: "✔";    position: absolute;    left: 5px;    color: #C86400;}
					.tbl > table {width: 100% !important;}
					
				]]></style>

				<xf:group class="approval" id="">
					<xf:group id="grd01_02">
						<xf:group id="grd01" class="grd01">
							<xf:group tagname="div" class="signWrap">
								<xf:group id="grd01Title" class="sign_label" tagname="div" style="visibility:hidden;">
									<w2:textbox escape="false" id="" label="결&lt;br/&gt;재" tagname="span"></w2:textbox>
								</xf:group>
								<w2:generator class="generatorWrap" id="generator1" tagname="div">
									<xf:group class="generatorSection" tagname="div">
										<xf:group class="jikname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="jikname" label="직무" tagname="span"></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="empname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="empname" label="이름" tagname="span" class=""></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="pic_person" tagname="div">
											<xf:group tagname="p">
												<xf:image id="personImage" src=""></xf:image>
											</xf:group>
										</xf:group>
										<xf:group class="endTime" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="endTime" label="" tagname="span" class="ce"></w2:textbox>
											</xf:group>
										</xf:group>
									</xf:group>
								</w2:generator>
							</xf:group>
						</xf:group>
						<xf:group id="grd02" class="grd02">
							<xf:group tagname="div" class="signWrap">
								<xf:group id="grd02Title" class="sign_label" tagname="div" style="visibility:hidden;">
									<w2:textbox escape="false" id="" label="감&lt;br/&gt;사" tagname="span"></w2:textbox>
								</xf:group>
								<w2:generator class="generatorWrap" id="generator2" tagname="div">
									<xf:group class="generatorSection" tagname="div">
										<xf:group class="jikname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="jikname" label="직무" tagname="span"></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="empname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="empname" label="이름" tagname="span" class=""></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="pic_person" tagname="div">
											<xf:group tagname="p">
												<xf:image id="personImage" src=""></xf:image>
											</xf:group>
										</xf:group>
										<xf:group class="endTime" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="endTime" label="" tagname="span" class="ce"></w2:textbox>
											</xf:group>
										</xf:group>
									</xf:group>
								</w2:generator>
							</xf:group>
						</xf:group>
						<xf:group id="grd02_02" class="grd02_02">
							<xf:group tagname="div" class="signWrap">
								<xf:group id="grd02_02Title" class="sign_label" tagname="div" style="visibility:hidden;">
									<w2:textbox escape="false" id="" label="행동강령 책임관" tagname="span" style="writing-mode: vertical-lr;letter-spacing: 2px;"></w2:textbox>
								</xf:group>
								<w2:generator class="generatorWrap" id="generator2_2" tagname="div">
									<xf:group class="generatorSection" tagname="div">
										<xf:group class="jikname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="jikname" label="직무" tagname="span"></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="empname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="empname" label="이름" tagname="span" class=""></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="pic_person" tagname="div">
											<xf:group tagname="p">
												<xf:image id="personImage" src=""></xf:image>
											</xf:group>
										</xf:group>
										<xf:group class="endTime" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="endTime" label="" tagname="span" class="ce"></w2:textbox>
											</xf:group>
										</xf:group>
									</xf:group>
								</w2:generator>
							</xf:group>
						</xf:group>
					</xf:group>

					<xf:group id="grd06_03_04">
						<xf:group id="grd06" class="grd06">
							<xf:group tagname="div" class="signWrap">
								<xf:group id="grd06Title" class="sign_label" tagname="div" style="visibility:hidden;">
									<w2:textbox escape="false" id="" label="수&lt;br/&gt;신" tagname="span"></w2:textbox>
								</xf:group>
								<w2:generator class="generatorWrap" id="generator6" tagname="div">
									<xf:group class="generatorSection" tagname="div">
										<xf:group class="jikname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="jikname" label="직무" tagname="span"></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="empname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="empname" label="이름" tagname="span" class=""></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="pic_person" tagname="div">
											<xf:group tagname="p">
												<xf:image id="personImage" src=""></xf:image>
											</xf:group>
										</xf:group>
										<xf:group class="endTime" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="endTime" label="" tagname="span" class="ce"></w2:textbox>
											</xf:group>
										</xf:group>
									</xf:group>
								</w2:generator>
							</xf:group>
						</xf:group>
						<xf:group id="grd03" class="grd03">
							<xf:group tagname="div" class="signWrap">
								<xf:group id="grd03Title" class="sign_label" tagname="div" style="visibility:hidden;">
									<w2:textbox escape="false" id="" label="업&lt;br/&gt;무" tagname="span"></w2:textbox>
								</xf:group>
								<w2:generator class="generatorWrap" id="generator3" tagname="div">
									<xf:group class="generatorSection" tagname="div">
										<xf:group class="jikname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="jikname" label="직무" tagname="span"></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="empname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="empname" label="이름" tagname="span" class=""></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="pic_person" tagname="div">
											<xf:group tagname="p">
												<xf:image id="personImage" src=""></xf:image>
											</xf:group>
										</xf:group>
										<xf:group class="endTime" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="endTime" label="" tagname="span" class="ce"></w2:textbox>
											</xf:group>
										</xf:group>
									</xf:group>
								</w2:generator>
							</xf:group>
						</xf:group>
						<xf:group id="grd04" class="grd04">
							<xf:group tagname="div" class="signWrap">
								<xf:group id="grd04Title" class="sign_label" tagname="div" style="visibility:hidden;">
									<w2:textbox escape="false" id="" label="협&lt;br/&gt;조" tagname="span"></w2:textbox>
								</xf:group>
								<w2:generator class="generatorWrap" id="generator4" tagname="div">
									<xf:group class="generatorSection" tagname="div">
										<xf:group class="jikname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="jikname" label="직무" tagname="span"></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="empname" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="empname" label="이름" tagname="span" class=""></w2:textbox>
											</xf:group>
										</xf:group>
										<xf:group class="pic_person" tagname="div">
											<xf:group tagname="p">
												<xf:image id="personImage" src=""></xf:image>
											</xf:group>
										</xf:group>
										<xf:group class="endTime" tagname="div">
											<xf:group tagname="p">
												<w2:textbox id="endTime" label="" tagname="span" class="ce"></w2:textbox>
											</xf:group>
										</xf:group>
									</xf:group>
								</w2:generator>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group class="titleSection" id="" style="">
				<w2:textbox class="tit_tbl" id="" label="결재의견 정보" style="" tagname="h3"></w2:textbox>
				<xf:group class="titleruleline">	
					<xf:group class="link" id="">
						<w2:anchor id="btn_regulation" outerDiv="false" style="" ev:onclick="scwin.btn_regulation_onclick">
							<xf:label><![CDATA[위임전결규정]]></xf:label>
						</w2:anchor>
						<w2:anchor id="btn_regulation_doc" outerDiv="false" style="" ev:onclick="scwin.btn_regulation_doc_onclick">
							<xf:label><![CDATA[양식별 업무규정]]></xf:label>
						</w2:anchor>
						<w2:anchor id="btn_regulation_alias_doc" outerDiv="false" style="" ev:onclick="scwin.btn_regulation_alias_doc_onclick">
							<xf:label><![CDATA[양식별 위임전결규정]]></xf:label>
						</w2:anchor>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group adaptiveThreshold="" class="gvwbox" id="" style="">
				<xf:group class="w2tb tbl" id="" style="margin-top:10px;" tagname="table">
					<w2:attributes>
						<w2:summary></w2:summary>
					</w2:attributes>
					<xf:group tagname="caption" text="전자결재구분"></xf:group>
					<xf:group tagname="colgroup">
						<xf:group style="width:13%;" tagname="col"></xf:group>
						<xf:group style="width:13%;" tagname="col"></xf:group>
						<xf:group style="width:19%;" tagname="col"></xf:group>
						<xf:group style="" tagname="col"></xf:group>
					</xf:group>
					<xf:group tagname="tr" style="">
						<xf:group class="w2tb_th ce" tagname="th">
							<w2:textbox label="결재자" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_th ce" tagname="th">
							<w2:textbox label="결재상태" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_th ce" tagname="th">
							<w2:textbox label="의견일시" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_th ce" tagname="th">
							결재의견
							<w2:textbox label="" tagname="span"></w2:textbox>
						</xf:group>
					</xf:group>

				</xf:group>

				<w2:generator id="generator5" style="" tagname="">
					<xf:group class="w2tb tbl" id="" style="margin-top : 0px; background : none;" tagname="table">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="caption" text="전자결재구분"></xf:group>
						<xf:group tagname="colgroup">
							<xf:group style="width:13%;" tagname="col"></xf:group>
							<xf:group style="width:13%;" tagname="col"></xf:group>
							<xf:group style="width:19%;" tagname="col"></xf:group>
							<xf:group style="" tagname="col"></xf:group>
						</xf:group>
						<xf:group tagname="tr">
							<xf:group class="w2tb_td ce" tagname="td">
								<w2:textbox id="empname" label="결재자" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td ce" tagname="td">
								<w2:textbox id="opt_type" label="결재상태" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td ce" tagname="td">
								<w2:textbox id="created_date" label="의견일시" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td le" tagname="td">
								<w2:textbox id="contents" label="결재" escape="false"></w2:textbox>
							</xf:group>
						</xf:group>
					</xf:group>
				</w2:generator>
			</xf:group>
			<w2:wframe id="wfSnap" src="" style="margin-top:20px;" class="w2tb tbl"></w2:wframe>
		</xf:group>
	</body>
</html>
