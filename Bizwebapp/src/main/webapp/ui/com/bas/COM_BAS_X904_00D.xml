<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="방화벽오픈신청">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
        	<xf:instance>
        		<data xmlns="" />
        	</xf:instance>
        	<w2:dataCollection baseNode="map">
        		<w2:dataMap baseNode="map" id="dma_search">
        			<w2:keyInfo>
        				<w2:key id="aply_no" name="aply_no" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_info">
        			<w2:keyInfo>
        				<w2:key id="aply_no" name="신청서번호" dataType="text"></w2:key>
        				<w2:key id="aply_sys_psn_no" name="신청자시스템개인번호" dataType="text"></w2:key>
        				<w2:key id="comp_charg_sys_psn_no" name="담당자시스템개인번호" dataType="text"></w2:key>
        				<w2:key id="aply_psn_krchar_nm" name="신청자이름" dataType="text"></w2:key>
        				<w2:key id="aply_pns_posi" name="신청자직급" dataType="text"></w2:key>
        				<w2:key id="user_id" name="신청자ID" dataType="text"></w2:key>
        				<w2:key id="blong_divsn" name="소속(본부)" dataType="text"></w2:key>
        				<w2:key id="blong_dept" name="소속(부서)" dataType="text"></w2:key>
        				<w2:key id="blong_ofic" name="소속(팀)" dataType="text"></w2:key>
        				<w2:key id="aply_psn_mobile_no" name="신청자핸드폰번호" dataType="text"></w2:key>
        				<w2:key id="agncy_cd" name="기관코드" dataType="text"></w2:key>
        				<w2:key id="agncy_nm" name="기관이름" dataType="text"></w2:key>
        				<w2:key id="agncy_charg_psn" name="담당자이름" dataType="text"></w2:key>
        				<w2:key id="agncy_contec_tel" name="연락처" dataType="text"></w2:key>
        				<w2:key id="link_goal" name="연결목적" dataType="text"></w2:key>
        				<w2:key id="link_ymd_from" name="연결시작일자" dataType="text"></w2:key>
        				<w2:key id="link_ymd_to" name="연결종료일자" dataType="text"></w2:key>
        				<w2:key id="link_time_from" name="연결시작시간" dataType="text"></w2:key>
        				<w2:key id="link_time_to" name="연결종료시간" dataType="text"></w2:key>

        				<w2:key id="ymd_link_yn" name="계속여부" dataType="text"></w2:key>
        				<w2:key id="link_addr" name="연결주소" dataType="text"></w2:key>
        				<w2:key id="in_out_clsf" name="내외부구분" dataType="text"></w2:key>
        				<w2:key id="start_loc_ip" name="출발지IP" dataType="text"></w2:key>
        				<w2:key id="destin_loc_ip" name="목적지IP" dataType="text"></w2:key>
        				<w2:key id="linkn_port" name="포트" dataType="text"></w2:key>
        				<w2:key id="unusual_item" name="특이사항" dataType="text"></w2:key>
        				<w2:key id="bizwrk_prcs_state" name="신청상태" dataType="text"></w2:key>
        				<w2:key id="apprvl_prcs_state" name="결재상태" dataType="text"></w2:key>
        				<w2:key id="apr_state" name="결재상태" dataType="text"></w2:key>
        				<w2:key id="end_point" name="end_point" dataType="text"></w2:key>
        				<w2:key id="comments" name="comments" dataType="text"></w2:key>
        				<w2:key id="service_id" name="service_id" dataType="text"></w2:key>
        				<w2:key id="doc_id" name="doc_id" dataType="text"></w2:key>
        				<w2:key id="approval" name="approval" dataType="text"></w2:key>
        				<w2:key id="aply_docu_clsf" name="정보자원신청서유형" dataType="text"></w2:key>
        				<w2:key id="aply_clsf" name="aply_clsf" dataType="text"></w2:key>
        				<w2:key id="comp_charg_nm" name="comp_charg_nm" dataType="text"></w2:key>
        				<w2:key id="bizwrk_prcs_state_nm" name="bizwrk_prcs_state_nm" dataType="text"></w2:key>
        				<w2:key id="send_phone" name="send_phone" dataType="text"></w2:key>
        				<w2:key id="send_name" name="send_name" dataType="text"></w2:key>
        				<w2:key id="send_syspayno" name="send_syspayno" dataType="text"></w2:key>
        				<w2:key id="aply_dept_cd" name="aply_dept_cd" dataType="text"></w2:key>
        				<w2:key id="aply_syspayno" name="aply_syspayno" dataType="text"></w2:key>
        				<w2:key id="info_cd" name="info_cd" dataType="text"></w2:key>
        				<w2:key id="comp_charg_sys_pay_no" name="comp_charg_sys_pay_no" dataType="text"></w2:key>
        				<w2:key id="supervisor_uid" name="담당책임자아이디" dataType="text"></w2:key>
        				<w2:key id="empno" name="empno" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_ldap" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="sn" name="시스템사번" dataType="text"></w2:column>
        				<w2:column id="cn" name="성명" dataType="text"></w2:column>
        				<w2:column id="uid" name="계정명(username)" dataType="text"></w2:column>
        				<w2:column id="userPassword" name="암호(password)" dataType="text"></w2:column>
        				<w2:column id="ou" name="부서명" dataType="text"></w2:column>
        				<w2:column id="ouCode" name="부서코드" dataType="text"></w2:column>
        				<w2:column id="ouLevel" name="부서레벨" dataType="text"></w2:column>
        				<w2:column id="roleCode" name="권한코드" dataType="text"></w2:column>
        				<w2:column id="headouCode" name="상위부서코드" dataType="text"></w2:column>
        				<w2:column id="empno" name="사번" dataType="text"></w2:column>
        				<w2:column id="celphoneNumber" name="휴대폰번호" dataType="text"></w2:column>
        				<w2:column id="officephoneNumber" name="전화번호" dataType="text"></w2:column>
        				<w2:column id="mail" name="이메일" dataType="text"></w2:column>
        				<w2:column id="area" name="근무지역" dataType="text"></w2:column>
        				<w2:column id="aclastlogintime" name="마지막로그인일시" dataType="text"></w2:column>
        				<w2:column id="useYN" name="사용여부" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataMap baseNode="map" id="dma_param">
        			<w2:keyInfo>
        				<w2:key id="cmd" name="cmd" dataType="text"></w2:key>
        				<w2:key id="aply_no" name="aply_no" dataType="text"></w2:key>
        				<w2:key id="aply_syspayno" name="aply_syspayno" dataType="text"></w2:key>
        				<w2:key id="aply_docu_clsf" name="aply_docu_clsf" dataType="text"></w2:key>
        				<w2:key id="aply_clsf" name="aply_clsf" dataType="text"></w2:key>
        				<w2:key id="bizwrk_prcs_state" name="bizwrk_prcs_state" dataType="text"></w2:key>
        				<w2:key id="apr_state" name="apr_state" dataType="text"></w2:key>
        				<w2:key id="search_date" name="search_date" dataType="text"></w2:key>
        				<w2:key id="rcpt_ymd_from" name="rcpt_ymd_from" dataType="text"></w2:key>
        				<w2:key id="rcpt_ymd_to" name="rcpt_ymd_to" dataType="text"></w2:key>
        				<w2:key id="req_no" name="req_no" dataType="text"></w2:key>
        				<w2:key id="param4" name="param4" dataType="text"></w2:key>
        				<w2:key id="aprStatus" name="aprStatus" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_supervisor">
        			<w2:keyInfo>
        				<w2:key id="supervisor_uid" name="담당책임자아이디" dataType="text"></w2:key>
        				<w2:key id="supervisor_syspayno" name="담당책임자시스템개인번호" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        	</w2:dataCollection>
        	<w2:workflowCollection></w2:workflowCollection>
        	<xf:submission id="sbm_selectComBasFWOpenInfo" ref="data:json,dma_search" target="data:json,dma_info"
        		action="SvcCOMBASFWOPSR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<xf:submission id="sbm_selectManagerList" ref="data:json,dma_search" target='' action="SvcCOMBASFWOPSR02.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<xf:submission id="sbm_aprAgr" ref="data:json,dma_info" target="" action="SvcCOMBASFWOPSM01.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<xf:submission id="sbm_aprReject" ref="data:json,dma_info" target="" action="SvcCOMBASFWOPSM02.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<xf:submission id="sbm_saveComBasFWOpen" ref="data:json,dma_info" target="data:json,dma_search"
        		action="SvcCOMBASFWOPSI01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<xf:submission id="sbm_deleteComBasFWOpen" ref="data:json,dma_info" target="" action="SvcCOMBASFWOPSD01.pwkjson" method="post"
        		mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
        		processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        </xf:model>
        <script type="text/javascript" lazy="false"><![CDATA[
 
    /****************************************************
 	 * 화면 설명 : 방화벽오픈신청서
 	 * 변경 이력 : 2023-09-19 	김상미	최초 작성
 	 * 서비스아이디 : X904
 	 ****************************************************/  
 	
 	scwin.data = {};
 	
 	/**
	 * 페이지 로딩 이벤트
	 */  	             
	scwin.onpageload = function() {
		var param = com.getParameter();
		console.log(param);
		
		scwin.searchManagerList();
		scwin.data.service_id = "X904";
		scwin.data.doc_id = "X94";
		scwin.data.isNew = true;
		scwin.data.today = com.getServerDateTime();		
		scwin.data.apr_state = "";
		btn_reject.hide();
		btn_confirm.hide();
		btn_charge_prc.hide();
		
		// 기관정보 enter key event
		com.setEnterKeyEvent(grp_vend, scwin.btn_search_agny_onclick);	
		
		scwin.initPage(param);
	};
	
	scwin.onpageunload = function() {
		
	};

	/**
	* 화면 초기 세팅
	*/
	scwin.initPage = function(param) {	
		com.biz.checkRole({ serviceId : scwin.data.service_id, roleCodes : com.getLoginInfo('roleCode')}, function(e) {	
			scwin.data.isRoleYn = e.isRoleYn;
		});	
		
		if ("99999995" != com.getLoginInfo("sn")) {
			btn_send_test_message.hide();
		}

		//필수입력항목 세팅
		com.setValidGroup(grp_base_info, [
			 { id : "ibx_link_gal", mandatory : true}
			,{ id : "ica_link_ymd_from", mandatory : true }
			,{ id : "sbx_link_hour_from", mandatory : true }
			,{ id : "ica_link_ymd_to", mandatory : true }			
			,{ id : "sbx_link_hour_to", mandatory : true } 			 	
			,{ id : "ibx_link_addr", mandatory : true } 
			,{ id : "sbx_in_out_clsf", mandatory : true } 
			,{ id : "ibx_start_loc_ip", mandatory : true } 	
			,{ id : "ibx_destin_loc_ip", mandatory : true } 												 									
			,{ id : "ibx_link_port", mandatory : true } 												 									
		])

		dma_param.setJSON(param);

		scwin.data.apr_state = dma_param.get("apr_state");
		
		if (dma_param.get("cmd")== "Vw") {
			dma_search.set("aply_no", dma_param.get("aply_no"));			
			//조회
			scwin.search();
		} else {
			if (dma_param.get("req_no") !="") {
				dma_search.set("aply_no", dma_param.get("req_no"));			
				//조회
				scwin.search();
			} else {
				ica_link_ymd_from.setValue(scwin.data.today);
				ica_link_ymd_to.setValue(scwin.data.today);
				ibx_empno.setValue(com.getLoginInfo("empno"));
				dma_info.set("aply_sys_psn_no", com.getLoginInfo("sn"));
				ibx_aply_psn_krchar_nm.setValue(com.getLoginInfo("cn"));
				ibx_user_id.setValue(com.getLoginInfo("uid"));
				ibx_aply_psn_posi.setValue(com.getLoginInfo("posiName"));
				ibx_apy_psn_mobile_no.setValue(com.getLoginInfo("phone"));
				scwin.searchEmp();			
				com.biz.disabledButtons(dma_info.get("apr_state"), dma_info.get("aply_no"));					
			}
		}
	};	

	/**
	 * LDAP담당자 정보조회
	 */		
	scwin.searchManagerList = function() {
		com.execute(sbm_selectManagerList, {
			successCallback : function(e) {
				console.log(e.responseJSON);
				dlt_ldap.setJSON(e.responseJSON.userVoList, false);
			}
		});	
	}	
	
	/**
	 * 직원 정보 조회
	 */			
	scwin.searchEmp = function() {
		var data = { empno : com.getLoginInfo("empno"), 
					 work_clsf : "HAG010", 
					 ref_yn : "N"
					};
					
		com.pop.open( com.pop.TYPE.HUM, data, function(ret) {	
			ibx_blong_divsn.setValue(ret.divsn_dept_nm);
			ibx_blong_dept.setValue(ret.dept_level_4_nm || ret.dept_nm);
			ibx_blong_ofic.setValue(ret.dept_level_4_nm ? ret.dept_nm : "");
		});	
	};

	/**
	 * 조회 실행
	 */		
	scwin.search = function() {
		com.execute(sbm_selectComBasFWOpenInfo, {
			successCallback : function(e) {
				tbx_cnt.setValue(txa_unusual_item.getValue().length);
				scwin.compControll();
			}
		});	
	};

	/**
	 * 목록 버튼 클릭 이벤트
	 */		
	scwin.btn_list_onclick = function(e) {
		scwin.backToList();
	};

	/**
	 * 목록 페이지로 이동
	 */	
	scwin.backToList = function() {
		var data = dma_param.getJSON();
		com.moveList("X903", data);
	};	
	
	/**
	 * 인쇄 버튼 클릭 이벤트
	 */			
	scwin.btn_print_onclick = function(e) {
		com.oz.openPopup( {
		    formAlias : dma_info.get("aply_no").substring(0,3),
		    reqNo : dma_info.get("aply_no"),
		    snapFrame : grp_base_info.getID()
		});		
	};
	
	/**
	 * 결재신청 버튼 클릭 이벤트
	 */		
	scwin.btn_apr_onclick = function(e) {
		if (!scwin.preSave())
		{
			return;
		}		
		com.confirm("방화벽 오픈신청서를 신청하시겠습니까?", function(ret) {
			if (ret) {
				dma_info.set("approval", "true");				
				var infocd = "신청자: "+ibx_blong_dept.getValue()+" "
						+ibx_aply_psn_krchar_nm.getValue()
						+" / 연결목적: "+ibx_link_gal.getValue()
						+" / 출발지: "+ ibx_start_loc_ip.getValue();
				dma_info.set("info_cd", infocd);
				scwin.save();
			}
		});			
	};
	
	/**
	 * 기관(단체) 조회 돋보기버튼 클릭 이벤트
	 */	
	scwin.btn_search_agny_onclick = function(e) {
		scwin.cust_popup();		
	};

	/**
	 * 기관(단체) 조회 팝업 오픈
	 */	
	scwin.cust_popup = function(e) {
		var data = { vend_abbr : ibx_agncy_cd.getValue() ,  biz_clsf : "COM"};

		com.pop.open( com.pop.TYPE.VEND, data, function(ret) { // COM_Z005_00P.xml
			if (ret) {
				scwin.setVendInfo(ret);
			}
		});
	};

	/**
	 * 기관(단체) 정보 세팅
	 */	
	scwin.setVendInfo = function(info) {
		ibx_agncy_cd.setValue(info["vend_cd"]);
		ibx_agncy_nm.setValue(info["vend_abbr"]);
		ibx_agncy_charg_psn.setValue(info["reprs_psn_nm"]);
		ibx_agncy_contec_tel.setValue(info["tel_no"]);
	};
	
	/**
	 * 계속 체크박스 변경 이벤트
	 */	
	scwin.cbx_ymd_link_yn_onchange = function(info) {
		if (this.getValue() == "Y") {
			ica_link_ymd_to.setValue("99991231");
			sbx_link_hour_from.setDisabled(true);
			sbx_link_hour_to.setDisabled(true);
			ica_link_ymd_from.setDisabled(true);
			ica_link_ymd_to.setDisabled(true);
		} else {
			ica_link_ymd_to.setValue(scwin.data.today);
			sbx_link_hour_from.setDisabled(false);
			sbx_link_hour_to.setDisabled(false);
			ica_link_ymd_from.setDisabled(false);
			ica_link_ymd_to.setDisabled(false);		
		}
	};
		
	/**
	 * 특이사항 입력 이벤트
	 */	
	scwin.txa_unusual_item_onkeyup = function(e) {
		tbx_cnt.setValue(this.getValue().length);
	};
		
	/**
	 * 메세지 발송 테스트 버튼 클릭 이벤트
	 */		
	scwin.btn_send_test_message_onclick = function(e) {
		scwin.sendTestMessage();
	};

	/**
	 * 테스트 메시지 발송
	 */		
	scwin.sendTestMessage = function() {
		// 발송 사전준비 데이터 시작(예시)
		// 데이터 구조는 예시를 위해 간단히 구성한 것임. 반드시 이런 형태일 필요는 없음
		var dataList = [{
			destName: '송영수',
			destPhone: '01071543278',
			destSyspayno: '99999998',		
		}, {
			destName: '박정일',
			destPhone: '01092546288',
			destSyspayno: '99999995',						
		}];
		 
		// 템플릿 변수 구성
		var templateVars = [];
		dataList.forEach(function(data, index) {
			templateVars.push({
				destName: data.destName,
				destPhone: data.destPhone,
				destSyspayno: data.destSyspayno,
				contentVar: {
					"성명": "이나영",				
				},				
			});
		});
		 
		// 메시지 발송
		com.msg.sendMessage({
			messages: 'AT_MSG',				// LMS 메시지 발송
			business: 'FIN',				// 재무 업무					
			logging: true,					// 로그 저장 여부 (default: true)
			businessYn: 'Y',
			templateCode: 'bizp_2019121500241118033664447',	// 템플릿: 방화벽 오픈 신청
			templateVars: templateVars,
		});
	};
	
	/**
	 * 담당책임 승인 버튼 클릭 이벤트
	 */			
	scwin.btn_charge_prc_onclick = function(e) {
		var user = {uid:dma_info.get("supervisor_uid")};
		scwin.chargeApproval(user);
	};

	/**
	 * 담당책임 승인 처리
	 */		
	scwin.chargeApproval = function(user) {
		dma_info.set("end_point", user.uid);	
		dma_info.set("comp_charg_sys_pay_no", "");								
		com.execute(sbm_aprAgr, {
			successCallback : function(e) {
				com.alert("승인처리 되었습니다", function() {
					//신청자의 이메일을 조회하여 사용자검색공통팝업 호출 실행
					scwin.searchAplyPsnEmail();
				});
			}
		});	
	};
	
	/**
	 * 승인 버튼 클릭 이벤트
	 */	
	scwin.btn_confirm_onclick = function(e) {
		if (dma_info.get("supervisor_uid") == "") { //담당책임자 승인까지 자동으로 처리되어야 하여 담당책임자 정보유무를 확인함.
			com.alert("담당책임자 정보가 없습니다.");
			return;
		}
				
		com.biz.checkRole({serviceId : scwin.data.service_id, roleCodes : com.getLoginInfo('roleCode')}, function(e) {	
			scwin.data.isRoleYn = e.isRoleYn;
			if (!scwin.data.isRoleYn) {
				com.alert("관리자외에는 처리 하실 수 없습니다.");
			}
			
			if (scwin.validate()) {
				com.confirm("승인처리 하시겠습니까?", function(ret) { 		
					dma_info.set("end_point", com.getLoginInfo("uid"));
					dma_info.set("comp_charg_sys_pay_no", com.getLoginInfo("sn"));
					if (ret) {
						com.execute(sbm_aprAgr, {
							successCallback : function(e) {
								btn_charge_prc.trigger("click");
							}
						});
					}
				});
			}			
		});			
	};

	/**
	 * 반려 버튼 클릭 이벤트
	 */		
	scwin.btn_reject_onclick = function(e) {
		com.biz.checkRole({serviceId : scwin.data.service_id, roleCodes : com.getLoginInfo('roleCode')}, function(e) {	
			scwin.data.isRoleYn = e.isRoleYn;
			if (!scwin.data.isRoleYn) {
				com.alert("관리자외에는 반려를 하실 수 없습니다.");
			}
			var options = {
			    id: "APR02P",
			    popupName: "반려의견",
			    width: 500,
			    height: 300
			};
			com.openPopup("/ui/apr/APR_C001_03P.xml", options, "", function(retObj) {
			    if (retObj.comments != null) {
			        dma_info.set("comments", retObj.comments);
			        com.execute(sbm_aprReject, {
			            successCallback: function(e) {
			                com.alert("반려처리 되었습니다");
							com.openTabMenu("A004", {});
			            }
			        });
			    }
			});
		});		
	};

	/**
	 * 삭제 버튼 클릭 이벤트
	 */		
	scwin.btn_del_onclick = function(e) {
		scwin.remove();
	};

	/**
	 * 삭제 실행
	 */		
	scwin.remove = function() {
		dma_info.set("regst_syspayno", com.getLoginInfo("sn"));
		dma_info.set("updt_syspayno", com.getLoginInfo("sn"));
		
		var msg = "방화벽오픈신청 : ["+tbx_aply_no.getValue()+"] 의 모든 데이터를 삭제 하시려면 [확인]을 클릭하세요.";
		com.confirm(msg, function(ret) {
			if (ret) {
				com.execute(sbm_deleteComBasFWOpen, {
					successCallback : function(e) { // 성공 콜백
						com.alert("정상적으로 삭제되었습니다.", function() {
							if (dma_param.get("param4") == "apr") {
								com.openTabMenu("A010", {});
							} else {
								scwin.backToList();							
							}
						});
					},
					exceptionCallback : function(e) {
						com.alert("방화벽오픈신청서 삭제시 오류가 발생하였습니다.\n관리자에게 문의하여 주십시오.");
						return;
					}
				});
			}
		});
	};
	
	/**
	 * 저장 버튼 클릭 이벤트
	 */		
	scwin.btn_save_onclick = function(e) {
		if (!scwin.preSave())
		{
			return;
		}		
		com.confirm("message.xom.wq.017" /*저장 하시겠습니까?*/, function(ret) {
			if (ret) {
				dma_info.set("approval", "false");
				scwin.save();
			}
		});		
	};
		
	/**
	 * 저장
	 */
	scwin.save = function() {
		dma_info.set("service_id", scwin.data.service_id);
		dma_info.set("doc_id", scwin.data.doc_id);		
		dma_info.set("aply_docu_clsf", scwin.data.doc_id);					
		dma_info.set("aply_clsf", "1");					
		dma_info.set("comp_charg_sys_psn_no", "99999999");					
		dma_info.set("comp_charg_nm", "지식정보실");					
		dma_info.set("aply_dept_cd", com.getLoginInfo("deptCode"));					
		dma_info.set("aply_syspayno", dma_info.get("aply_sys_psn_no"));					
		dma_info.set("bizwrk_prcs_state", "XZB001");					
		dma_info.set("bizwrk_prcs_state_nm", "신청");					
		dma_info.set("send_phone", com.getLoginInfo("phone"));					
		dma_info.set("send_name", com.getLoginInfo("cn"));					
		dma_info.set("send_syspayno", com.getLoginInfo("sn"));				
		com.execute(sbm_saveComBasFWOpen, {
			successCallback : function(e) { // 성공 콜백
				if (dma_info.get("approval")=="true") {
					//정보기반담당자에게 메세지 발송
					scwin.sendMessage();
				} else {
					com.alert("[방화벽오픈신청]저장 되었습니다.", function() {
						scwin.search();
					});				
				}
			} 
		});
	};

	/**
	 * 저장전 확인
	 */
	scwin.preSave = function() {
		if (!scwin.validate()) {
			return false;
		}
		
		if (cbx_ymd_link_yn.getValue() != "Y") {
			if (ica_link_ymd_from.getValue() == ica_link_ymd_to.getValue()) {
				if (Number(sbx_link_hour_to.getValue()) < Number(sbx_link_hour_from.getValue())) {
					com.alert("[연결시간]같은 일자에 사용시작 시간이 큽니다.\n확인해 주세요!!");
					sbx_link_hour_to.focus();
					return false;
				}
				if (Number(sbx_link_hour_from.getValue()) == Number(sbx_link_hour_to.getValue())) {
					com.alert("[연결시간]총시간이 0시간입니다.\n확인해 주세요!!");
					sbx_link_hour_to.focus();
					return false;
				}
			}
		}		
		
		if (!scwin.checkIP(ibx_start_loc_ip.getValue())) {
			com.alert("출발지IP주소형식이 맞지않습니다.\n확인해 주세요");
			ibx_start_loc_ip.focus();
			return false;
		}
		
		if (!scwin.checkIP(ibx_destin_loc_ip.getValue())) {
			com.alert("목적지IP주소형식이 맞지않습니다.\n확인해 주세요");
			ibx_destin_loc_ip.focus();
			return false;
		}

		if (ibx_start_loc_ip.getValue() == ibx_destin_loc_ip.getValue()) {
			com.alert("출발지IP와 목적지IP가 동일하면 안됩니다.\n확인해 주세요");
			ibx_destin_loc_ip.focus();
			return false;
		}		
		return true;
	};

	/*
     * 검증
     */
	scwin.validate = function() {
		if (!com.validateData(dma_info,[
			{ id : "link_goal", mandatory : true},
			{ id : "link_ymd_from", mandatory : true},
			{ id : "link_ymd_to", mandatory : true},
			{ id : "link_time_from", mandatory : true},
			{ id : "link_time_to", mandatory : true},
			{ id : "link_addr", mandatory : true},
			{ id : "in_out_clsf", mandatory : true},
			{ id : "start_loc_ip", mandatory : true},	
			{ id : "destin_loc_ip", mandatory : true},
			{ id : "linkn_port", mandatory : true},														
		], false)) return false;
		
		if (!com.isDate(ica_link_ymd_from.getValue(), false)) {
			return false;
		}
				
		if (!com.isDate(ica_link_ymd_to.getValue(), false)) {
			return false;
		}		
		return true;
	};	
	
	/*
     * IP유효성 체크
     */	
	scwin.checkIP = function(strIP) {
		var expUrl = /^(1|2)?\d?\d([.](1|2)?\d?\d){3}$/;
		
		if (!expUrl.test(strIP)) {
			return false;
		}		
		return true;
	}
	
	/**
	 * 직원 이메일 조회
	 */			
	scwin.searchAplyPsnEmail = function() {
		var data = { empno : ibx_aply_psn_krchar_nm.getValue(), 
					 work_clsf : "HAG010", 
					 ref_yn : "N"
					};
					
		com.pop.open( com.pop.TYPE.HUM, data, function(ret) {			
			scwin.sendMail(ret.email);
		});	
	};	
					
	/**
	 * 신청자에게 메일 발송
	 */			
	scwin.sendMail = function(toAddress) {	
		var subject = '[결재완료]방화벽오픈 신청결재가 승인 되었습니다.';	 
		var templatePath = 'com/ComBasOpenFWReq';
		
		// 유효성 제크 & 수신자 세팅.
		if ('undefined' === typeof toAddress || '' == toAddress) {
			com.alert("신청자의 이메일 주소가 없어서 [결재완료]메일 발송이 불가합니다.");
			return false;
		}
				
		var linkTime = ica_link_ymd_from.getValue() + " " + sbx_link_hour_from.getText()
						+ "~" + ica_link_ymd_to.getValue() + " " + sbx_link_hour_to.getText();
		// 템플릿 변수 설정
		var templateVars = [];
		
		templateVars.push({
			toAddr: toAddress,
			contentVar: {
				"@reqNo@": tbx_aply_no.getValue(),
				"@linkGoal@": ibx_link_gal.getValue(),
				"@linkTime@": linkTime,
				"@@linkAddress@@": ibx_link_addr.getValue(),
				"@bound@": sbx_in_out_clsf.getText(),
				"@outboundIP@": ibx_start_loc_ip.getValue(),
				"@inboundIP@": ibx_destin_loc_ip.getValue(),	
				"@portNumber@": ibx_link_port.getValue(),								
			},				
		});

		//메일발송
		com.mail.sendMessage( {
			subject: subject,
			content: '내용',
			fromAddr: com.getLoginInfo("email"),
			toAddr: toAddress,
			savesent: true,	// 보낸편지함 저장 여부 (default: true)
			onesend: false,	// 일괄발송 | 개별발송 (default: true)
			logging: true,	// 로그 저장 여부 (default: true)
			business: 'COM',
			templatePath: templatePath,
			templateVars: templateVars,
		},function() {
			com.alert("메일을 발송하였습니다.",function() {
				com.openTabMenu("A004", {});
			});
		});
	};
	
	/**
	 * 정보기반담당자에게 메세지 발송
	 */			
	scwin.sendMessage = function() {	
		if (dlt_ldap.getRowCount() == 0) {
			com.alert("정보기반담당자 정보가 없습니다.");
			return false;		
		}
		 
		// 템플릿 변수 구성
		var templateVars = [];
		
		dlt_ldap.getAllJSON().forEach(function(data, index) {
			templateVars.push({
				destName: data.cn,
				destPhone: data.celphoneNumber,
				destSyspayno: data.sn,
				contentVar: {
					"성명": ibx_aply_psn_krchar_nm.getValue(),				
				},				
			});
		});
		 
		// 메시지 발송
		com.msg.sendMessage({
			messages: 'AT_MSG',				// LMS 메시지 발송
			business: 'COM',				// 시스템					
			logging: true,					// 로그 저장 여부 (default: true)
			businessYn: 'Y',
			templateCode: 'bizp_2019121500241118033664447',	// 템플릿: 방화벽 오픈 신청
			templateVars: templateVars,
		}, function() {
			com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/,function() {
				//결재신청 후에는 결재진행함으로 이동
				com.openTabMenu("A005", {});
			});				
		});
	};
	
	/**
	 * 화면 component disable세팅
	 */	 	
	scwin.disabledComponent = function(flag) {
		var disableArr = ["btn_search_agny","ibx_agncy_cd","ibx_agncy_nm","ibx_agncy_charg_psn",
				"ibx_agncy_contec_tel","ibx_link_gal","ica_link_ymd_from","ica_link_ymd_to",
				"sbx_link_hour_from","sbx_link_hour_to","cbx_ymd_link_yn","ibx_link_addr",
				"sbx_in_out_clsf","ibx_start_loc_ip","ibx_destin_loc_ip","ibx_link_port",
				"txa_unusual_item"];

		scwin.setDisable(disableArr, flag);		
	};

	/**
	* 컴포넌트 disable true/false 처리
	*/	
	scwin.setDisable = function(arr, flag) {
		for (var i =0; i<arr.length; i++) {
			$p.getComponentById(arr[i]).setDisabled(flag);
		}
	};
	
	/**
	 * 화면 콤포넌트 컨트롤
	 */	
	scwin.compControll = function() {			
	    com.biz.disabledButtons(dma_info.get("apr_state"), dma_info.get("aply_no"));
	    
		if (dma_info.get("apr_state") >= "XAD020") {			
			//화면 component disable 처리
			scwin.disabledComponent(true);
				
			//관리자이고, 담당자확인 상태일 때만 반려/처리버튼 노출.
			com.biz.checkRole({ serviceId : scwin.data.service_id, roleCodes : com.getLoginInfo('roleCode')}, function(e) {
				scwin.data.isRoleYn = e.isRoleYn;
				if (scwin.data.isRoleYn && dma_info.get("apr_state") == "XAD070") {
					btn_confirm.show("");
					btn_reject.show("");
				}				
			});		
				
			if (dma_info.get("apr_state") == "XAD100") {
				btn_print.setDisabled(false);
			}
		} else {
			if (ibx_empno.getValue() != com.getLoginInfo("empno")) {
				scwin.disabledComponent(true);
				btn_save.setDisabled(true);
				btn_apr.setDisabled(true);
				btn_del.setDisabled(true);
			}
		}
	};		]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_wframe2" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group class="pageWrap" id="grp_base_info" style="">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="">
    				<xf:trigger class="btn " id="btn_list" style="" type="button" ev:onclick="scwin.btn_list_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox" id="">
    				<xf:trigger class="btn icon print" id="btn_print" style="display:none;" type="button" ev:onclick="scwin.btn_print_onclick" disabled="true">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="사용자정보" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>7</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox class="txt" id="tbx_aply_no" label="" style="" tagname="span" ref="data:dma_info.aply_no"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="개인번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_empno" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.empno"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="아이디성명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_aply_psn_krchar_nm" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.aply_psn_krchar_nm"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="아이디" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_user_id" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.user_id"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="직급" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_aply_psn_posi" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.aply_pns_posi"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속(본부)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_blong_divsn" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.blong_divsn"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속(부서)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_blong_dept" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.blong_dept"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속(팀)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_blong_ofic" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.blong_ofic"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="연락처(HP)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_apy_psn_mobile_no" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.aply_psn_mobile_no"></xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="외부정보" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group tagname="table" style="" id="" class="w2tb tbl">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group tagname="col" style="width:130px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:130px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기관(단체)명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch fix" id="grp_vend" style="width:120px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_agncy_cd" style="" ref="data:dma_info.agncy_cd"></xf:input>
    							<xf:trigger class="btn" id="btn_search_agny" style="" type="button" ev:onclick="scwin.btn_search_agny_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="ibx_agncy_nm" style="max-width: 200px;" disabled="true" ref="data:dma_info.agncy_nm"></xf:input>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="담당자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_agncy_charg_psn" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.agncy_charg_psn"></xf:input>
    				</xf:group>
    				<xf:group tagname="th" style="" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="연락처" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" style="" class="w2tb_td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_agncy_contec_tel" style="max-width: 200px;" title="신청번호" disabled="true" ref="data:dma_info.agncy_contec_tel"></xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="신청사항" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:130px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" style="" tagname="th"><w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes><w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox class="blue" id="" label="연결목적" style="" tagname="span"></w2:textbox></xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_link_gal" style="" title="신청번호" ref="data:dma_info.link_goal"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="연결시간" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group class="inpcalWrap" id="" style="">
    						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false"
    							id="ica_link_ymd_from" renderDiv="true" rightAlign="false" style="" ref="data:dma_info.link_ymd_from">
    						</w2:inputCalendar>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="" class="sel" direction="auto" disabledClass="w2selectbox_disabled" id="sbx_link_hour_from" ref="data:dma_info.link_time_from" style="width:60px;" submenuSize="auto">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[1시]]></xf:label>
    									<xf:value><![CDATA[1]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[2시]]></xf:label>
    									<xf:value><![CDATA[2]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[3시]]></xf:label>
    									<xf:value><![CDATA[3]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[4시]]></xf:label>
    									<xf:value><![CDATA[4]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[5시]]></xf:label>
    									<xf:value><![CDATA[5]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[6시]]></xf:label>
    									<xf:value><![CDATA[6]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[7시]]></xf:label>
    									<xf:value><![CDATA[7]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[8시]]></xf:label>
    									<xf:value><![CDATA[8]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[9시]]></xf:label>
    									<xf:value><![CDATA[9]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[10시]]></xf:label>
    									<xf:value><![CDATA[10]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[11시]]></xf:label>
    									<xf:value><![CDATA[11]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[12시]]></xf:label>
    									<xf:value><![CDATA[12]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[13시]]></xf:label>
    									<xf:value><![CDATA[13]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[14시]]></xf:label>
    									<xf:value><![CDATA[14]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[15시]]></xf:label>
    									<xf:value><![CDATA[15]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[16시]]></xf:label>
    									<xf:value><![CDATA[16]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[17시]]></xf:label>
    									<xf:value><![CDATA[17]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[18시]]></xf:label>
    									<xf:value><![CDATA[18]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[19시]]></xf:label>
    									<xf:value><![CDATA[19]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[20시]]></xf:label>
    									<xf:value><![CDATA[20]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[21시]]></xf:label>
    									<xf:value><![CDATA[21]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[22시]]></xf:label>
    									<xf:value><![CDATA[22]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[23시]]></xf:label>
    									<xf:value><![CDATA[23]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[24시]]></xf:label>
    									<xf:value><![CDATA[24]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    						<w2:textbox class="dash" id="" label="~" style="" tagname="span"></w2:textbox>
    						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false"
    							id="ica_link_ymd_to" renderDiv="true" rightAlign="false" style="" ref="data:dma_info.link_ymd_to">
    						</w2:inputCalendar>
    						<xf:select1 allOption="" appearance="minimal" chooseOption="" class="sel" direction="auto" disabledClass="w2selectbox_disabled" id="sbx_link_hour_to" ref="data:dma_info.link_time_to" style="width:60px;" submenuSize="auto">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[1시]]></xf:label>
    									<xf:value><![CDATA[1]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[2시]]></xf:label>
    									<xf:value><![CDATA[2]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[3시]]></xf:label>
    									<xf:value><![CDATA[3]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[4시]]></xf:label>
    									<xf:value><![CDATA[4]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[5시]]></xf:label>
    									<xf:value><![CDATA[5]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[6시]]></xf:label>
    									<xf:value><![CDATA[6]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[7시]]></xf:label>
    									<xf:value><![CDATA[7]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[8시]]></xf:label>
    									<xf:value><![CDATA[8]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[9시]]></xf:label>
    									<xf:value><![CDATA[9]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[10시]]></xf:label>
    									<xf:value><![CDATA[10]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[11시]]></xf:label>
    									<xf:value><![CDATA[11]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[12시]]></xf:label>
    									<xf:value><![CDATA[12]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[13시]]></xf:label>
    									<xf:value><![CDATA[13]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[14시]]></xf:label>
    									<xf:value><![CDATA[14]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[15시]]></xf:label>
    									<xf:value><![CDATA[15]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[16시]]></xf:label>
    									<xf:value><![CDATA[16]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[17시]]></xf:label>
    									<xf:value><![CDATA[17]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[18시]]></xf:label>
    									<xf:value><![CDATA[18]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[19시]]></xf:label>
    									<xf:value><![CDATA[19]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[20시]]></xf:label>
    									<xf:value><![CDATA[20]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[21시]]></xf:label>
    									<xf:value><![CDATA[21]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[22시]]></xf:label>
    									<xf:value><![CDATA[22]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[23시]]></xf:label>
    									<xf:value><![CDATA[23]]></xf:value>
    								</xf:item>
    								<xf:item>
    									<xf:label><![CDATA[24시]]></xf:label>
    									<xf:value><![CDATA[24]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select1>
    						<xf:select appearance="full" class="chkGroup ml10" cols="" id="cbx_ymd_link_yn" ref="data:dma_info.ymd_link_yn"
    							renderType="checkboxgroup" rows="" selectedindex="-1" style="" ev:onchange="scwin.cbx_ymd_link_yn_onchange" falseValue="N">
    							<xf:choices>
    								<xf:item>
    									<xf:label><![CDATA[계속]]></xf:label>
    									<xf:value><![CDATA[Y]]></xf:value>
    								</xf:item>
    							</xf:choices>
    						</xf:select>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
					<xf:group tagname="th" class="w2tb_th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
						<w2:textbox class="blue" id="" label="연결주소" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group tagname="td" class="w2tb_td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full" id="ibx_link_addr" initValue="http://" style="" title="신청번호" ref="data:dma_info.link_addr"></xf:input>
					</xf:group></xf:group><xf:group tagname="tr">
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="내외부구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel" direction="auto"
    						disabledClass="w2selectbox_disabled" id="sbx_in_out_clsf" ref="data:dma_info.in_out_clsf" style="max-width: 200px;" submenuSize="auto" ev:onclick="scwin.sbx_in_out_clsf_onclick">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[내부->외부]]></xf:label>
    								<xf:value><![CDATA[1]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[외부->내부]]></xf:label>
    								<xf:value><![CDATA[2]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    				</xf:group>
</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="출발지IP" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_start_loc_ip" style="max-width: 200px;" title="출발지IP" ref="data:dma_info.start_loc_ip" minByteLength="15"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th"><w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes><w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox class="blue" id="" label="목적지IP" style="" tagname="span"></w2:textbox></xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_destin_loc_ip" style="max-width: 200px;" title="목적지IP" ref="data:dma_info.destin_loc_ip" minByteLength="15"></xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th"><w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes><w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox class="blue" id="" label="Port" style="" tagname="span"></w2:textbox></xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_link_port" style="max-width: 200px;" title="신청번호" ref="data:dma_info.linkn_port" minByteLength="4"></xf:input>
    				</xf:group>
    			</xf:group>
	    		<xf:group tagname="tr">
	    			<xf:group tagname="th" class="w2tb_th">
	    				<w2:attributes>
	    					<w2:scope>row</w2:scope>
	    				</w2:attributes>
	    				<w2:textbox id="" label="특이사항" style="" tagname="span"></w2:textbox>
						<w2:textbox class="txt_limit" id="" label="(입력제한 200자)" style="" tagname="p"></w2:textbox>	    				
	    			</xf:group>
	    			<xf:group tagname="td" class="w2tb_td">
	    				<w2:attributes>
	    					<w2:colspan>5</w2:colspan>
	    					<w2:rowspan>1</w2:rowspan>
	    				</w2:attributes>
	    				<xf:textarea id="txa_unusual_item" style="height: 80px;" placeholder="최대 200자" ref="data:dma_info.unusual_item" ev:onkeyup="scwin.txa_unusual_item_onkeyup" maxlength="200"></xf:textarea>
	    				<xf:group class="txt_count ri" id="" style="">
	    					<w2:textbox class="red" escape="false" id="tbx_cnt" label="0" style="" tagname="span"></w2:textbox>
	    					<w2:span id="" label="/ 200자" style=""></w2:span>
	    				</xf:group>
	    			</xf:group>
	    		</xf:group>
	    		<xf:group tagname="tr">
					<xf:group tagname="th" class="w2tb_th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="연결주소로 IP주소 확인하는 방법" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group tagname="td" class="w2tb_td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<w2:textbox class="txt" id="" label="1. 명령 프롬프트 실행" style="" tagname="span"></w2:textbox>
						<w2:anchor id="btn_open_guide" outerDiv="false" style="padding-left:20px;" href="https://google.co.kr/search?q=명령+프롬프트+실행하는+방법" target="_blank">
							<xf:label><![CDATA[※ 실행방법 알아보기(새창)]]></xf:label>
						</w2:anchor>
						<w2:textbox class="txt" id="" label="2. nslookup 웹주소" style="" tagname="p"></w2:textbox>
						<xf:group style="position:relative; width:600px; height:300px; margin-left:20px; background-color:black; color:white; font-family:GulimChe; font-size:16px;" id="">
							<w2:textbox class="txt" id="" label="Microsoft Windows [Version 10.0.15063]" style="" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="(c) 2017 Microsoft Corporation. All rights reserved." style="" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="C:\Users\user>nslookup www.gov.kr" style="margin-top:15px;" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="서버: ns.kitech.re.kr" style="" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="Address: 203.250.104.2" style="" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="권한 없는 응답:" style="margin-top:15px;" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="이름: www.gov.kr" style="" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="Address: 27.101.213.1" style="" tagname="p"></w2:textbox>
							<w2:textbox class="txt" id="" label="C:\Users\user>" style="margin-top:30px;" tagname="p"></w2:textbox>
							
							<w2:textbox id="" label="" style="position:absolute; top:55px; left:110px; display:inline-block; width:165px; height:30px; 
							border:3px solid red;" tagname="span"></w2:textbox>
							<w2:textbox id="" label="" style="position:absolute; top:180px; left:70px; display:inline-block; width:110px; height:30px; 
							border:3px solid red;" tagname="span"></w2:textbox>
						</xf:group>
					</xf:group>
	    		</xf:group>
			</xf:group>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn pro" id="btn_send_test_message" style="" type="button" ev:onclick="scwin.btn_send_test_message_onclick">
    					<xf:label><![CDATA[메시지 발송 테스트]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" id="btn_charge_prc" style="" type="button" ev:onclick="scwin.btn_charge_prc_onclick">
    					<xf:label><![CDATA[담당책임 승인]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn pro" id="btn_confirm" style="" type="button" ev:onclick="scwin.btn_confirm_onclick">
    					<xf:label><![CDATA[승인]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn pro" id="btn_reject" style="" type="button" ev:onclick="scwin.btn_reject_onclick">
    					<xf:label><![CDATA[반려]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
