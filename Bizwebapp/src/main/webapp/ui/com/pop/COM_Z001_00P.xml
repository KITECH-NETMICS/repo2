<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head meta_programName="계정번호 조회 ">
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>

						<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
						<w2:key id="accnt_no_nm" name="계정명" dataType="text"></w2:key>
						<w2:key id="cls_yr" name="종료년도" dataType="text"></w2:key>
						<w2:key id="clsf" name="구분" dataType="text"></w2:key>
						<w2:key id="accnt_rspns" name="계정책임자" dataType="text"></w2:key>
						<w2:key id="rtpaper" name="rtpaper" dataType="text"></w2:key>
						<w2:key id="start_ymd" name="시작일자" dataType="text"></w2:key>
						<w2:key id="cls_ymd" name="종료일자" dataType="text"></w2:key>
						<w2:key id="syspayno" name="사번" dataType="text"></w2:key>
						<w2:key id="inout_psn_clsf_cd" name="내외자구분" dataType="text"></w2:key>
						<w2:key id="accnt_clsf" name="계정구분" dataType="text"></w2:key>
						<w2:key id="bsns_req_no" name="사업신청번호" dataType="text"></w2:key>
						<w2:key id="prj_no" name="과제번호" dataType="text"></w2:key>
						<w2:key id="note_use_ex" name="연구노트사용여부" dataType="text"></w2:key>
						<w2:key id="mngmt_clsf" name="관리구분" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_accntNo" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="accnt_no" name="계정번호" dataType="String"></w2:column>
						<w2:column id="main_accnt_no" name="메인계정번호" dataType="String"></w2:column>
						<w2:column id="accnt_rspns" name="계정책임자" dataType="String"></w2:column>
						<w2:column id="bugt_ctrl_psn" name="예산통제자" dataType="String"></w2:column>
						<w2:column id="accnt_clsf" name="계정구분" dataType="String"></w2:column>
						<w2:column id="mngmt_clsf" name="관리구분" dataType="text"></w2:column>
						<w2:column id="prj_no" name="과제번호" dataType="String"></w2:column>
						<w2:column id="accnt_state" name="계정상태" dataType="String"></w2:column>
						<w2:column id="accnt_no_nm" name="계정명" dataType="String"></w2:column>
						<w2:column id="accnt_state_nm" name="계정상태명" dataType="String"></w2:column>
						<w2:column id="fin_bsns_clsf" name="재무사업구분" dataType="String"></w2:column>
						<w2:column id="start_ymd" name="시작일자" dataType="String"></w2:column>
						<w2:column id="cls_ymd" name="종료일자" dataType="String"></w2:column>
						<w2:column id="tot_prj_start_ymd" name="전체과제시작일자" dataType="String"></w2:column>
						<w2:column id="tot_prj_cls_ymd" name="전체과제종료일자" dataType="String"></w2:column>
						<w2:column id="itm_solve_base" name="비목해소기준" dataType="String"></w2:column>
						<w2:column id="tax_cd" name="과세코드" dataType="String"></w2:column>
						<w2:column id="card_use_ex" name="카드사용구분" dataType="String"></w2:column>
						<w2:column id="fomat_unit" name="편성단위" dataType="String"></w2:column>
						<w2:column id="accnt_grp" name="계정그룹" dataType="text"></w2:column>
						<w2:column id="bsns_cd_exclsv_agncy" name="전문기관" dataType="text"></w2:column>
						<w2:column id="bsns_cd_inout" name="내외구분" dataType="text"></w2:column>
						<w2:column id="bsns_cd_ofic" name="관계부처" dataType="text"></w2:column>
						<w2:column id="accnt_rspns_empno" name="계정책임자개인번호" dataType="text"></w2:column>
						<w2:column id="accnt_rspns_nm" name="계정책임자성명" dataType="text"></w2:column>
						<w2:column id="prj_nm" name="프로젝트명" dataType="text"></w2:column>
						<w2:column id="ctrl_gbn" name="마감일관리여부(구매)" dataType="text"></w2:column>
						<w2:column id="date_between" name="잔여일수(구매)" dataType="text"></w2:column>
						<w2:column id="evid_chk" name="증빙체크" dataType="text"></w2:column>
						<w2:column id="dept_res_psn" name="연구지원담당자" dataType="text"></w2:column>
						<w2:column id="srpt_cd" name="경상비지원유무" dataType="text"></w2:column>
						<w2:column id="anal_adjst_decsn_yn" name="연차정산상태(과제반납)" dataType="text"></w2:column>
						<w2:column id="req_no" name="신청번호(과제반납)" dataType="text"></w2:column>
						<w2:column id="student_cost_use" name="학생인건비풀링여부" dataType="text"></w2:column>
						<w2:column id="note_use_ex" name="연구노트사용유무" dataType="text"></w2:column>
						<w2:column id="note_type_cd" name="연구노트유형" dataType="text"></w2:column>
						<w2:column id="accnt_rspns_detl_nm" name="계정책임자상세" dataType="text"></w2:column>
						<w2:column id="accnt_rspns_dept_nm" name="계정책임자부서" dataType="text"></w2:column>
						<w2:column id="bugt_ctrl_psn_empno" name="예산통제자개인번호" dataType="text"></w2:column>
						<w2:column id="bugt_ctrl_psn_nm" name="예산통제자성명" dataType="text"></w2:column>
						<w2:column id="bugt_ctrl_psn_detl_nm" name="예산통제자상세" dataType="text"></w2:column>
						<w2:column id="bugt_ctrl_psn_dept_nm" name="예산통제자부서" dataType="text"></w2:column>
						<w2:column id="resch_rspns" name="연구책임자" dataType="text"></w2:column>
						<w2:column id="resch_rspns_empno" name="연구책임자개인번호" dataType="text"></w2:column>
						<w2:column id="resch_rspns_nm" name="연구책임자성명" dataType="text"></w2:column>
						<w2:column id="resch_rspns_detl_nm" name="연구책임자상세" dataType="text"></w2:column>
						<w2:column id="resch_rspns_dept_nm" name="연구책임자부서" dataType="text"></w2:column>
						<w2:column id="resch_fund" name="연구비(현금)" dataType="text"></w2:column>
						<w2:column id="bsns_cd_detls_bsns_nm" name="내역사업명" dataType="text"></w2:column>
						<w2:column id="bsns_cd_ofic_nm" name="관계부처명" dataType="text"></w2:column>
						<w2:column id="secrt_prj_ex" name="보안과제유무" dataType="text"></w2:column>
						<w2:column id="secrt_prj_yn" name="연구자료공개유무" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sbm_selectAccntInfoList" ref='data:json,dma_search'
				target='data:json,{"id":"dlt_accntNo","key":"accntNoPopupVoList"}' action="SvcAccntNoPopupList.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		<script type="text/javascript" lazy="false"><![CDATA[
	/*******************************************************************
 	 * 화면 설명 : 계정번호조회
 	 * 변경 이력 : 2022-04-01	박병목	최초 작성
 	            2023-04-19	이영희	조회조건추가(bsns_req_no : 연구비입금관리)
 	 *******************************************************************/
	/**
	 * 페이지 로딩 이벤트
	 */
	scwin.onpageload = function() {
		var param = com.getParameter();
		var paramRspnsNm = param?.rspns_nm;
		dma_search.setJSON(param);

		if (paramRspnsNm) {
			ibx_empno.setValue(paramRspnsNm);
		}
		
		if(param.clsf == "prePrj"){
			spn_accnt_rspns.setValue("연구책임자");
			ibx_empno.setValue(param.empno);
			ibx_nm.setValue(param.nm);
			
			ibx_empno.setDisabled(true);
			btn_emp.setDisabled(true);
		}else if(param.clsf == "prjEnd"){
			spn_accnt_rspns.setValue("연구책임자");
		}else if(param.clsf == "Res_Note"){
			alert("<2022-10회 연구총괄심의위원회 제10호기본사업 운영계획 심의>\n2022-10회 연구총괄심의위원회 결과에 따라 2023년도부터는 내부연구(기본사업)는 전자연구노트 사용이 의무화됨에 따라, 서면연구노트 신청이 불가함을 안내드립니다.");
		}
		
		if(param.clsf != "prjEnd"){
			grd_list.setColumnVisible("anal_adjst_decsn_yn", false);
		}
		
		// 검색조건 영역내의 컴포넌트에 엔터키 이벤트 발생시 조회 수행
		com.setEnterKeyEvent(grp_empno, scwin.btn_emp_onclick);
		com.setEnterKeyEvent(grp_accno, scwin.btn_search_onclick);
		com.setEnterKeyEvent(grp_accno_nm, scwin.btn_search_onclick);
		
		// 공통코드
		var codeOptions = [ { code : "RHA", compID :"grd_list:bsns_cd_inout" }
		                ];
		com.setCmnCd(codeOptions, function() {
			// 계정번호가 있으면 자동 조회
			if(dma_search.get("accnt_no") != ""|| dma_search.get("bsns_req_no") != "" || param.clsf == "prePrj" || dma_search.get("syspayno") != "" ){
				scwin.search();	
			}
		});		
	};

	/**
	 * 조회버튼 클릭
	 */
	scwin.btn_search_onclick = function() {
		scwin.search();
	};

	/**
	 * 조회
	 */
	scwin.search = function() {
		var accntNo = ibx_accnt_no.getValue();
		var accntNoNm = dma_search.get("accnt_no_nm").trim();
		if ( accntNo.length < 3 && ibx_empno.getValue() == "" && dma_search.get("bsns_req_no") == "" && dma_search.get("prj_no") == "" && accntNoNm.length < 2) { 
			alert("계정번호 3자리 이상 또는 계정명 2글자 이상 또는 계정책임자를 입력해주세요");
			return;
		}
		// 목록 조회
		ibx_accnt_no.setValue(ibx_accnt_no.getValue().toUpperCase());
		if(dma_search.get("clsf") == ""){ // 오류로 인하여 임시로
			dma_search.set("clsf", "000");	
		}
		com.execute(sbm_selectAccntInfoList, {
			successCallback : function(e) { // 성공 콜백
			}
		});
	};
	
	/**
	 * 그리드 더블클릭 이벤트
	 */ 
	scwin.grd_list_oncelldblclick = function(row,col,colId) {
		if(dma_search.get("clsf") == "prePrj"){ // 선행연구과제등록시 호출된 경우
			var today = com.getServerDateTime();
			var clsYmd = dlt_accntNo.getCellData(row, "tot_prj_cls_ymd");
			debugger;
			if(com.parseInt(clsYmd.substring(0, 4)) < com.parseInt(today.substring(0, 4)) - 3){
				alert("최근 3년 이내 최종 종료과제만 선행연구로 가능합니다.");
				return;
			}
			
			var addDate = com.addDate(today, 90);
			if(com.parseInt(clsYmd.substring(0, 6)) > com.parseInt(addDate.substring(0, 6))){
				alert("총연구기간 종료일 이전 3년, 이후 3달이내 과제를 선택해야 합니다.");
				return;
			}
		}
		com.closePopup(dlt_accntNo.getRowJSON(row));
	};
	
	/**
	 * 닫기
	 */
	scwin.btn_close_onclick = function(e) {
		com.closePopup();
	};
	
	/**
	 * 계정책임자 검색 버튼 클릭 이벤트
	 */
	scwin.btn_emp_onclick = function(e) {
		data = { empno : ibx_empno.getValue(), 
		         work_clsf : "HAG010",
		         ref_yn : (ibx_empno.getValue() == "")? "Y" : "N"
		       };
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			dma_search.set("accnt_rspns", ret.syspayno);
			dma_search.set("syspayno", ret.syspayno); // 과제반납시 필요
			ibx_empno.setValue(ret.empno);
			ibx_nm.setValue(ret.nm);			
		});
	};
	
	/**
	 * 계정번호 검색 팝업 호출
	 */
	scwin.selectHumBtn = function(data, callback) {
		
	};
	
	/**
	 * 계정책임자 변경 이벤트
	 */
	scwin.ibx_empno_onchange = function(info) {
		// 근무자 빈값일경우 이름, 시스템사번 데이터셋 초기화
		if(info.newValue == "") {	
			dma_search.set("accnt_rspns", "");
			ibx_nm.setValue("");
		}
	};
	
	/**
	 * 계정번호  keyup 이벤트
	 */
	scwin.ibx_accnt_no_onkeyup = function(e) {
		ibx_accnt_no.setValue(ibx_accnt_no.getValue().toUpperCase());
	};
	
	/**
	 * 과제번호  keyup 이벤트
	 */
	scwin.ibx_prj_no_onkeyup = function(e) {
		ibx_prj_no.setValue(ibx_prj_no.getValue().toUpperCase());
	};

	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload">
		<xf:group id="" class="pop_contents">
			<xf:group style="" id="grp_search" class="searchSection">
				<xf:group id="" class="schbox">
					<xf:group tagname="table" style="" id="" class="w2tb tbl">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="caption"></xf:group>
						<xf:group tagname="colgroup">
							<xf:group tagname="col" style="width:70px;"></xf:group>
							<xf:group tagname="col" style="width:150px;"></xf:group>
							<xf:group tagname="col" style="width:60px;"></xf:group>
							<xf:group tagname="col" style="width:170px;"></xf:group>							
							<xf:group tagname="col" style="width:100px;"></xf:group>
							<xf:group tagname="col" style=""></xf:group>
						</xf:group>
						<xf:group tagname="tr" style="">
							<xf:group tagname="th" style="" class="w2tb_th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
								<w2:textbox tagname="span" style="" id="" label="계정번호"></w2:textbox>
							</xf:group>
							<xf:group tagname="td" style="" class="w2tb_td" id="grp_accno">
								<xf:input adjustMaxLength="false" class="inp" id="ibx_accnt_no" style="width:120px;" title="계정번호"
									ref="data:dma_search.accnt_no" ev:onkeyup="scwin.ibx_accnt_no_onkeyup;">
								</xf:input>
							</xf:group>
							<xf:group tagname="th" style="" class="w2tb_th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
								<w2:textbox tagname="span" style="" id="" label="계정명"></w2:textbox>
							</xf:group>
							<xf:group tagname="td" style="" class="w2tb_td" id="grp_accno_nm">
								<xf:input adjustMaxLength="false" class="inp" id="ibx_accnt_no_nm" style="width:120px;" title="계정명"
									ref="data:dma_search.accnt_no_nm">
								</xf:input>
							</xf:group>
							<xf:group tagname="th" class="w2tb_th">
								<w2:attributes></w2:attributes>
								<w2:textbox tagname="span" style="" id="spn_accnt_rspns" label="계정책임자"></w2:textbox>
							</xf:group>
							<xf:group tagname="td" class="w2tb_td" id="">
								<w2:attributes></w2:attributes>
								<xf:group style="width: 120px;" id="grp_empno" class="inpSch">
										<xf:input ev:onchange="scwin.ibx_empno_onchange" adjustMaxLength="false" style="" id="ibx_empno" title="계정책임자명" class="inp">
										</xf:input>
										<xf:trigger ev:onclick="scwin.btn_emp_onclick" style="" id="btn_emp" type="button" title="계정책임자 조회 " class="btn">
											<xf:label><![CDATA[검색]]></xf:label>
										</xf:trigger>
									</xf:group><xf:input adjustMaxLength="false" style="width: 80px;" readOnly="true" disabled="true" id="ibx_nm" title="계정책임자 상세" class="inp">
									</xf:input>
							</xf:group>
						</xf:group>
						<xf:group style="" tagname="tr">
							<xf:group class="w2tb_th" style="" tagname="th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
								<w2:textbox id="" label="과제번호" style="" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td" id="group5" style="" tagname="td">
								<xf:input adjustMaxLength="false" class="inp" ev:onkeyup="scwin.ibx_prj_no_onkeyup;" id="ibx_prj_no"
									ref="data:dma_search.prj_no" style="width:120px;" title="과제번호">
								</xf:input>
							</xf:group>
							<xf:group class="w2tb_th" style="" tagname="th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
							</xf:group>
							<xf:group class="w2tb_td" id="group6" style="" tagname="td"></xf:group>
							<xf:group class="w2tb_th" tagname="th">
								<w2:attributes></w2:attributes>
							</xf:group>
							<xf:group class="w2tb_td" id="" tagname="td">
								<w2:attributes></w2:attributes>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group id="" class="schbtn">
					<xf:trigger style="" id="btn_search" type="button" class="btn search" ev:onclick="scwin.btn_search_onclick">
						<xf:label><![CDATA[조회]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
			<w2:gridView scrollByColumnAdaptive="false" rowNumVisible="true" rowStatusWidth="50" selectedRowColor="#fbf2cd"
				rowNumHeaderValue="No." scrollByColumn="false" defaultCellHeight="28" rowStatusHeaderValue="상태" noResultMessage="조회 결과가 없습니다."
				rowNumBackgroundColor="#fff" noResultMessageClass="noResult" rowStatusVisible="false" selectedCellColor="#fbf2cd" rowNumWidth="60"
				dataList="data:dlt_accntNo" evenRowBackgroundColor="#f7faff" style="height: 85px;" autoFit="allColumn" id="grd_list" visibleRowNum="10"
				class="grid" rowMouseOverColor="#e7f0fb" summaryAuto="true" ev:oncelldblclick="scwin.grd_list_oncelldblclick" sortable="true"
				filterFocusMode="outfocus" readOnly="true">
				<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
				<w2:header style="" id="header1">
					<w2:row style="" id="row1">
						<w2:column width="70" inputType="text" style="height:28px;" id="column9" value="과세구분" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px;" id="column7" value="내외구분" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column34" value="과제번호" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px;" id="column5" value="계정번호" displayMode="label"></w2:column>
						<w2:column width="200" inputType="text" style="height:28px;" id="column3" value="계정명" displayMode="label"></w2:column>
						<w2:column width="156" inputType="text" style="height:28px;" id="column30" value="계정책임자" displayMode="label" colSpan="2"
							rowSpan="">
						</w2:column>
						<w2:column width="100" inputType="text" style="height:28px;" id="column29" value="기간(From)" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px;" id="column27" value="기간(To)" displayMode="label"></w2:column>
						<w2:column width="90" inputType="text" style="height:28px" id="column33" value="총연구기간종료일자" displayMode="label"
							dataType="date">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column35" value="연차정상상태" displayMode="label"></w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody style="" id="gBody1">
					<w2:row style="" id="row2">
						<w2:column width="70" inputType="select" readOnly="true" style="height:28px;" id="tax_cd" displayMode="label" allOption=""
							chooseOption="" ref="">
							<w2:choices>
								<w2:item>
									<w2:label><![CDATA[과세]]></w2:label>
									<w2:value><![CDATA[FTX001]]></w2:value>
								</w2:item>
								<w2:item>
									<w2:label><![CDATA[비과세]]></w2:label>
									<w2:value><![CDATA[FTX002]]></w2:value>
								</w2:item>
							</w2:choices>
						</w2:column>
						<w2:column width="100" inputType="select" readOnly="true" style="height:28px;" id="bsns_cd_inout" class=""
							displayMode="label">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="prj_no" value="" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" readOnly="true" style="height:28px;" id="accnt_no" class="" escape="false"
							displayMode="label">
						</w2:column>
						<w2:column width="200" inputType="text" readOnly="true" style="height:28px;" id="accnt_no_nm" displayMode="label"
							escape="false" textAlign="left">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="accnt_rspns_empno" value="" displayMode="label"
							readOnly="true">
						</w2:column>
						<w2:column width="86" inputType="text" readOnly="true" style="height:28px;" id="accnt_rspns_nm" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px;" id="start_ymd" displayMode="label" readOnly="true"
							dataType="date" displayFormat="yyyy-MM-dd">
						</w2:column>
						<w2:column width="100" inputType="text" style="height:28px;" id="cls_ymd" displayMode="label" readOnly="true"
							dataType="date" displayFormat="yyyy-MM-dd">
						</w2:column>
						<w2:column width="90" inputType="text" style="height:28px" id="tot_prj_cls_ymd" value="" displayMode="label" readOnly="true"
							dataType="date">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="anal_adjst_decsn_yn" value="" displayMode="label"></w2:column>
					</w2:row>
				</w2:gBody>
			</w2:gridView>
			<xf:group style="" id="" class="btnGroup">
				<xf:group style="" id="" class="le"></xf:group>
				<xf:group id="" class="ri">
					<xf:trigger style="" id="btn_close" type="button" class="btn pro" ev:onclick="scwin.btn_close_onclick">
						<xf:label><![CDATA[닫기]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
		</xf:group>
	</body>
</html>
