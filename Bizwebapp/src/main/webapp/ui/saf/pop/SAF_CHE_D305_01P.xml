<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="연구실검색">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
        	<xf:instance>
        		<data xmlns="" />
        	</xf:instance>
        	<w2:dataCollection baseNode="map">
        		<w2:dataMap baseNode="map" id="dma_search">
        			<w2:keyInfo>
        				<w2:key id="centr_cd" name="centr_cd" dataType="text"></w2:key>
        				<w2:key id="dept_cd" name="dept_cd" dataType="text"></w2:key>
        				<w2:key id="lab_nm" name="lab_nm" dataType="text"></w2:key>
        				<w2:key id="main_secrt_rspns_syspayno" name="main_secrt_rspns_syspayno" dataType="text"></w2:key>
        				<w2:key id="lab_grd" name="lab_grd" dataType="text"></w2:key>
        				<w2:key id="lab_state" name="lab_state" dataType="text"></w2:key>
        				<w2:key id="manager_yn" name="manager_yn" dataType="text"></w2:key>
        				<w2:key id="syspayno" name="syspayno" dataType="text"></w2:key>
        				<w2:key id="lab_no" name="lab_no" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_lab_list" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="rdo" name="rdo" dataType="text"></w2:column>
        				<w2:column id="lab_no" name="lab_no" dataType="text"></w2:column>
        				<w2:column id="lab_nm" name="lab_nm" dataType="text"></w2:column>
        				<w2:column id="centr_nm" name="centr_nm" dataType="text"></w2:column>
        				<w2:column id="dept_nm" name="dept_nm" dataType="text"></w2:column>
        				<w2:column id="lab_state" name="lab_state" dataType="text"></w2:column>
        				<w2:column id="space_cd" name="space_cd" dataType="text"></w2:column>
        				<w2:column id="region_cd" name="region_cd" dataType="text"></w2:column>
        				<w2:column id="region_nm" name="region_nm" dataType="text"></w2:column>
        				<w2:column id="centr_cd" name="centr_cd" dataType="text"></w2:column>

        				<w2:column id="divsn_cd" name="divsn_cd" dataType="text"></w2:column>
        				<w2:column id="dept_cd" name="dept_cd" dataType="text"></w2:column>
        				<w2:column id="dept_new_ymd" name="dept_new_ymd" dataType="text"></w2:column>

        				<w2:column id="hsect_nm" name="hsect_nm" dataType="text"></w2:column>
        				<w2:column id="build_nm" name="build_nm" dataType="text"></w2:column>
        				<w2:column id="build_smal_clsf_nm" name="build_smal_clsf_nm" dataType="text"></w2:column>

        				<w2:column id="eng_lab_nm" name="eng_lab_nm" dataType="text"></w2:column>
        				<w2:column id="roomno" name="roomno" dataType="text"></w2:column>
        				<w2:column id="area" name="area" dataType="text"></w2:column>
        				<w2:column id="main_secrt_rspns_syspayno" name="main_secrt_rspns_syspayno" dataType="text"></w2:column>
        				<w2:column id="main_secrt_rspns_nm" name="main_secrt_rspns_nm" dataType="text"></w2:column>
        				<w2:column id="main_secrt_rspns_ymd" name="main_secrt_rspns_ymd" dataType="text"></w2:column>
        				<w2:column id="sub_secrt_rspns_syspayno" name="sub_secrt_rspns_syspayno" dataType="text"></w2:column>
        				<w2:column id="sub_secrt_rspns_nm" name="sub_secrt_rspns_nm" dataType="text"></w2:column>
        				<w2:column id="sub_secrt_rspns_ymd" name="sub_secrt_rspns_ymd" dataType="text"></w2:column>
        				<w2:column id="space_usg_clsf" name="space_usg_clsf" dataType="text"></w2:column>
        				<w2:column id="space_usg_clsf_nm" name="space_usg_clsf_nm" dataType="text"></w2:column>
        				<w2:column id="aloc_ymd" name="aloc_ymd" dataType="text"></w2:column>
        				<w2:column id="retrn_ymd" name="retrn_ymd" dataType="text"></w2:column>
        				<w2:column id="risk_equip" name="risk_equip" dataType="text"></w2:column>
        				<w2:column id="lab_grd" name="lab_grd" dataType="text"></w2:column>
        				<w2:column id="lab_grd_nm" name="lab_grd_nm" dataType="text"></w2:column>
        				<w2:column id="pecu_medexm_yn" name="pecu_medexm_yn" dataType="text"></w2:column>
        				<w2:column id="pecu_medexm_yn_nm" name="pecu_medexm_yn_nm" dataType="text"></w2:column>

        				<w2:column id="attach_file_no" name="attach_file_no" dataType="text"></w2:column>
        				<w2:column id="rmk" name="rmk" dataType="text"></w2:column>
        				<w2:column id="regst_psn_syspayno" name="regst_psn_syspayno" dataType="text"></w2:column>
        				<w2:column id="regst_daytm" name="regst_daytm" dataType="text"></w2:column>
        				<w2:column id="updt_psn_syspayno" name="updt_psn_syspayno" dataType="text"></w2:column>
        				<w2:column id="updt_daytm" name="updt_daytm" dataType="text"></w2:column>

        				<w2:column id="user_syspayno_arr" name="user_syspayno_arr" dataType="text"></w2:column>
        				<w2:column id="user_count" name="user_count" dataType="text"></w2:column>

        			</w2:columnInfo>
        		</w2:dataList>
        	</w2:dataCollection>
        	<w2:workflowCollection></w2:workflowCollection>
        	<xf:submission id="sbm_selectSpaceList" ref="data:json,dma_search" target="data:json,dlt_lab_list"
        		action="SvcSAFCHEPRDUSR17.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        </xf:model>
        <script type="text/javascript" lazy="false"><![CDATA[
     /****************************************************
 	 * 화면 설명 : 연구실검색
 	 * 변경 이력 : 2023-09-06	김상미	최초 작성
 	 * 서비스아이디 : D305
 	 ****************************************************/    

 	/**
	 * 페이지 로딩 이벤트
	 */  	    	         
	scwin.onpageload = function() {
		var param = com.getParameter();
		
		com.initDataMap(dma_search);
		
		if (param != undefined) {
			dma_search.setJSON(param);
		}
	
		// enter key event
		com.setEnterKeyEvent(grp_search, scwin.btn_search_onclick);		
		scwin.search();
	};
	
	scwin.onpageunload = function() {
		
	};
		
	/**
	 * 조회실행
	 */	
	scwin.search = function() {

		var managerYn = "N";
			if (dma_search.get("syspayno") == "20130576" || dma_search.get("syspayno") == "20160348") {
				managerYn = "A";
			}
								
		if (sbx_search_type.getValue() =="lab_nm") {
			dma_search.set("lab_nm", ibx_search_value.getValue());
			dma_search.set("lab_no", "");			
		} else if (sbx_search_type.getValue() =="lab_no") {
			dma_search.set("lab_nm", "");
			dma_search.set("lab_no", bx_search_value.getValue());			
		} else {
			dma_search.set("lab_nm", "");
			dma_search.set("lab_no", "");			
		}
		dma_search.set("manager_yn", managerYn);
		dma_search.set("syspayno", com.getLoginInfo("sn"));
		
		com.execute(sbm_selectSpaceList, {
			successCallback : function(e) {
				console.log(e.responseJSON);
				dlt_lab_list.setJSON(e.responseJSON.safCheSpaceInfoVoList);
			}
		});	
	};
	

	/**
	 * 키워드 selectbox 변경 이벤트
	 */		
	scwin.sbx_search_type_onchange = function(info) {
		if (this.getValue() !="") {
			ibx_search_value.setDisabled(false);
		} else {
			ibx_search_value.setValue("");
			ibx_search_value.setDisabled(true);		
		}
	};
	
	/**
	 * 조회 버튼 클릭 이벤트
	 */			
	scwin.btn_search_onclick = function(e) {
		scwin.search();
	};

	/**
	 * 닫기 버튼 클릭 이벤트
	 */			
	scwin.btn_close_onclick = function(e) {
		com.closePopup({}); // 팝업 닫기 (콜백 수행을 위해 빈 객체 넘김)			
	};

	/**
	 * 선택 버튼 클릭 이벤트
	 */			
	scwin.btn_select_onclick = function(e) {
		console.log(grd_list.getCheckedJSON("rdo"));
		com.closePopup(grd_list.getCheckedJSON("rdo"));	
	};

	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<xf:group class="pop_contents" id="" style="">
    		<xf:group class="searchSection" id="" style="">
    			<xf:group class="schbox" id="">
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group tagname="col"></xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="키워드" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" id="" tagname="td">
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="sbx_search_type" ref="" style="width:120px;" submenuSize="auto"
    								visibleRowNum="10" ev:onchange="scwin.sbx_search_type_onchange" chooseOptionLabel="-전체-">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[연구실명]]></xf:label>
    										<xf:value><![CDATA[lab_nm]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[연구실코드]]></xf:label>
    										<xf:value><![CDATA[lab_no]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
								<xf:group class="inpSch" id="grp_search" style="width: 200px;">    							
    								<xf:input adjustMaxLength="false" class="inp" id="ibx_search_value" style="width: 180px"></xf:input>
    							</xf:group>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group class="schbtn" id="">
    				<xf:trigger class="btn search" id="btn_search" style="" type="button" ev:onclick="scwin.btn_search_onclick">
    					<xf:label><![CDATA[조회]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_lab_list" defaultCellHeight="28"
    			evenRowBackgroundColor="#f7faff" id="grd_list" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb"
    			rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태"
    			rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd"
    			selectedRowColor="#fbf2cd" style="height: 280px;" visibleRowNum="10" sortEvent="onclick" sortable="true">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column checkboxLabel="전체선택" displayMode="label" fixColumnWidth="true" id="column1" inputType="text"
    						readOnly="false" style="height:28px;" value="선택" width="45">
    					</w2:column>
    					<w2:column displayMode="label" id="column9" inputType="text" style="height:28px;" value="연구실번호" width="150"></w2:column>
    					<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;" value="연구실명" width="150"></w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" sortable="true" style="height:28px;" value="센터명"
    						width="100">
    					</w2:column>
    					<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="부서명" width="100"></w2:column>
    					<w2:column displayMode="label" id="column21" inputType="text" style="height:28px" value="사용여부" width="100"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column23" value="신청번호" displayMode="label"
    						hidden="true">
    					</w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column checkboxLabel="선택" displayMode="label" id="rdo" inputType="radio" readOnly="false" style="height:28px;"
    						width="50">
    					</w2:column>
    					<w2:column displayMode="label" id="lab_no" inputType="text" readOnly="true" style="height:28px;" width="150"></w2:column>
    					<w2:column displayMode="label" id="lab_nm" inputType="text" readOnly="true" style="height:28px;" value=""
    						width="150">
    					</w2:column>
    					<w2:column displayMode="label" id="centr_nm" inputType="text" readOnly="true" style="height:28px;" width="100"></w2:column>
    					<w2:column displayMode="label" id="dept_nm" inputType="text" readOnly="true" style="height:28px;" width="100"></w2:column>
    					<w2:column displayMode="label" id="lab_state" inputType="text" style="height:28px" value="" width="100" readOnly="true"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="space_cd" value="" displayMode="label"></w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class=" btn pro " id="btn_close" style="" type="button" ev:onclick="scwin.btn_close_onclick">
    					<xf:label><![CDATA[닫기]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_select" style="" type="button" ev:onclick="scwin.btn_select_onclick">
    					<xf:label><![CDATA[선택]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
