<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="상조회대출신청">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
        	<xf:instance>
        		<data xmlns="" />
        	</xf:instance>
        	<w2:dataCollection baseNode="map">
        		<w2:dataMap baseNode="map" id="dma_search" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
        				<w2:key id="req_psn_syspayno" name="개인시스템번호" dataType="text"></w2:key>
        				<w2:key id="sci_tech_anuty" name="과학기술연금여부" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_result">
        			<w2:keyInfo>
        				<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
        				<w2:key id="centr_cd" name="센터코드" dataType="text"></w2:key>
        				<w2:key id="centr_nm" name="센터명" dataType="text"></w2:key>
        				<w2:key id="dept_cd" name="부서코드" dataType="text"></w2:key>
        				<w2:key id="dept_nm" name="부서명" dataType="text"></w2:key>
        				<w2:key id="dept_new_ymd" name="부서신설일" dataType="text"></w2:key>
        				<w2:key id="req_ymd" name="신청일자" dataType="text"></w2:key>
        				<w2:key id="req_psn" name="신청자명" dataType="text"></w2:key>
        				<w2:key id="req_psn_syspayno" name="신청자시스템개인번호" dataType="text"></w2:key>
        				<w2:key id="empno" name="사원번호" dataType="text"></w2:key>
        				<w2:key id="dept_tel" name="부서전화번호" dataType="text"></w2:key>
        				<w2:key id="loan_amt" name="신청금액" dataType="number"></w2:key>
        				<w2:key id="req_cause" name="신청사유" dataType="text"></w2:key>
        				<w2:key id="month_dedct_amt" name="확정월공제액" dataType="number"></w2:key>
        				<w2:key id="req_state" name="신청상태" dataType="text"></w2:key>
        				<w2:key id="req_state_nm" name="신청상태명" dataType="text"></w2:key>
        				<w2:key id="pay_amt" name="사정금액" dataType="number"></w2:key>
        				<w2:key id="pay_ymd" name="지급일자" dataType="text"></w2:key>
        				<w2:key id="depst_clsf" name="입금구분" dataType="text"></w2:key>
        				<w2:key id="depst_bankaccnt_no" name="입금계좌번호" dataType="text"></w2:key>
        				<w2:key id="depst_bank_cd" name="입금은행코드" dataType="text"></w2:key>
        				<w2:key id="depst_bank_nm" name="입금은행명" dataType="text"></w2:key>
        				<w2:key id="depstr_nm" name="예금주명" dataType="text"></w2:key>
        				<w2:key id="rmk" name="비고" dataType="text"></w2:key>
        				<w2:key id="repay_month" name="상환월수" dataType="text"></w2:key>
        				<w2:key id="fix_repay_month" name="확정상환월수" dataType="text"></w2:key>
        				<w2:key id="email" name="이메일" dataType="text"></w2:key>
        				<w2:key id="sci_tech_anuty" name="과학기술연금여부" dataType="text"></w2:key>
        				<w2:key id="entr_ymd" name="입사일" dataType="text"></w2:key>
        				<w2:key id="pay_bank_cd" name="지급은행코드" dataType="text"></w2:key>
        				<w2:key id="pay_bank_nm" name="지급은행명" dataType="text"></w2:key>
        				<w2:key id="pay_bankaccnt" name="지급계좌번호" dataType="text"></w2:key>
        				<w2:key id="pay_depstr" name="지급예금주" dataType="text"></w2:key>
        				<w2:key id="oth_bankaccnt" name="별도계좌번호" dataType="text"></w2:key>
        				<w2:key id="oth_bank_cd" name="별도은행코드" dataType="text"></w2:key>
        				<w2:key id="oth_bank_nm" name="별도은행명" dataType="text"></w2:key>
        				<w2:key id="oth_depstr" name="별도예금주" dataType="text"></w2:key>
        				<w2:key id="loan_ramt" name="총대출잔액" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="aid_loan_ramt" name="상조회대출잔액" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="univ_loan_ramt" name="대학융자금잔액" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="retire_appro" name="퇴직금" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="avail_sum" name="전별금" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="approval" name="결재여부" dataType="text"></w2:key>
        				<w2:key id="cud_type" name="저장구분" dataType="text"></w2:key>
        				<w2:key id="apr_state" name="결재상태코드" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_procApr" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
        				<w2:key dataType="text" id="req_action" name="동작구분"></w2:key>
        				<w2:key dataType="text" id="comments" name="반려사유"></w2:key>
        				<w2:key id="apr_state" name="결재상태코드" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>

        		<w2:dataMap baseNode="map" id="dma_loanRamt">
        			<w2:keyInfo>
        				<w2:key id="loan_ramt" name="잔액총액" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="aid_loan_ramt" name="상조회대출잔액" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="univ_loan_ramt" name="대학융자금잔액" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="retire_appro" name="퇴직금" dataType="number" defaultValue="0"></w2:key>
        				<w2:key id="avail_sum" name="전별금" dataType="number" defaultValue="0"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_retireAppro">
        			<w2:keyInfo></w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_resultBankInfo" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="pay_bank_cd" name="지급은행코드"></w2:key>
        				<w2:key dataType="text" id="pay_bank_nm" name="지급은행명"></w2:key>
        				<w2:key dataType="text" id="pay_bankaccnt" name="지급계좌번호"></w2:key>
        				<w2:key dataType="text" id="pay_depstr" name="지급예금주"></w2:key>
        				<w2:key dataType="text" id="oth_bankaccnt" name="별도계좌번호"></w2:key>
        				<w2:key dataType="text" id="oth_bank_cd" name="별도은행코드"></w2:key>
        				<w2:key dataType="text" id="oth_bank_nm" name="별도은행명"></w2:key>
        				<w2:key dataType="text" id="oth_depstr" name="별도예금주"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_resultDecideInfo" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_loanMaster">
        			<w2:keyInfo>
        				<w2:key id="syspayno" name="syspayno" dataType="text"></w2:key>
        				<w2:key id="loan_cd" name="loan_cd" dataType="text"></w2:key>
        				<w2:key id="loan_ymd" name="loan_ymd" dataType="text"></w2:key>
        				<w2:key id="loan_tot_liq" name="loan_tot_liq" dataType="text"></w2:key>
        				<w2:key id="loan_ramt" name="loan_ramt" dataType="text"></w2:key>
        				<w2:key id="loan_rts" name="loan_rts" dataType="text"></w2:key>
        				<w2:key id="tot_repay_amt" name="tot_repay_amt" dataType="text"></w2:key>
        				<w2:key id="tot_repay_intrst" name="tot_repay_intrst" dataType="text"></w2:key>
        				<w2:key id="month_repay_amt" name="month_repay_amt" dataType="text"></w2:key>
        				<w2:key id="thmon_intrst_amt" name="thmon_intrst_amt" dataType="text"></w2:key>
        				<w2:key id="repay_schdl_tot_times" name="repay_schdl_tot_times" dataType="text"></w2:key>
        				<w2:key id="repay_times" name="repay_times" dataType="text"></w2:key>
        				<w2:key id="dedct_start_ymd" name="dedct_start_ymd" dataType="text"></w2:key>
        				<w2:key id="midway_repay_ymd" name="midway_repay_ymd" dataType="text"></w2:key>
        				<w2:key id="final_dedct_ymd" name="final_dedct_ymd" dataType="text"></w2:key>
        				<w2:key id="tot_midway_repay_amt" name="tot_midway_repay_amt" dataType="text"></w2:key>
        				<w2:key id="tot_midway_repay_intrst" name="tot_midway_repay_intrst" dataType="text"></w2:key>
        				<w2:key id="midway_repay_times" name="midway_repay_times" dataType="text"></w2:key>
        				<w2:key id="thmon_midway_repay_intrst_amt" name="thmon_midway_repay_intrst_amt" dataType="text"></w2:key>
        				<w2:key id="dedct_progrss_state" name="dedct_progrss_state" dataType="text"></w2:key>
        				<w2:key id="def_intrst" name="def_intrst" dataType="text"></w2:key>
        				<w2:key id="repay_intrst" name="repay_intrst" dataType="text"></w2:key>
        				<w2:key id="tot_intrst_amt" name="tot_intrst_amt" dataType="text"></w2:key>
        				<w2:key id="confirm_day" name="confirm_day" dataType="text"></w2:key>
        				<w2:key id="req_defer" name="req_defer" dataType="text"></w2:key>
        				<w2:key id="req_repay" name="req_repay" dataType="text"></w2:key>
        				<w2:key id="req_repay_month" name="req_repay_month" dataType="text"></w2:key>
        				<w2:key id="rmk" name="rmk" dataType="text"></w2:key>
        				<w2:key id="req_no" name="req_no" dataType="text"></w2:key>
        				<w2:key id="regst_psn_syspayno" name="regst_psn_syspayno" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        	</w2:dataCollection>
        	<w2:workflowCollection></w2:workflowCollection>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSR01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_selectDetail" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style=""
        		target='data:json,{"id":"dma_result","key":"cwlFwLoanReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLMI01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_saveDetail" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref="data:json,dma_result" replace="" style="" target='data:json,{"id":"dma_search","key":"cwlFwLoanReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSD01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_deleteDetail" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style="" target="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSM01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_procApr" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_procApr" replace="" style="" target="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSR02.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_selectLoanRamt" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style=""
        		target='data:json,{"id":"dma_loanRamt","key":"cwlFwLoanReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSR02.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_selectRetireAppro" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style=""
        		target='data:json,{"id":"dma_loanRamt","key":"cwlFwLoanReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSR03.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_selectBasicInfo" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style=""
        		target='data:json,{"id":"dma_resultBankInfo","key":"cwlFwLoanReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSR04.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_selectDecideInfo" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style=""
        		target='data:json,{"id":"dma_resultDecideInfo","key":"cwlFwLoanReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLFWLSI01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_saveLoanMaster" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref="data:json,dma_loanMaster" replace="" style="" target=''>
        	</xf:submission>
        </xf:model>
        <script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 상조회대출신청
	 * 변경 이력 : 2023-09-05	lsh	최초 작성
	 * serviceId : C253
	 ****************************************************/	
	
	// 전역변수로 사용하기 위해 scwin 객체안에 선언  
	scwin.data = {};
        
	scwin.onpageload = function() {
		// dataMap 초기화
		com.initDataMap(dma_result);
		
		// parameter 설정
		dma_search.setJSON(com.getParameter());
		
		// 영역내의 컴포넌트에 엔터키 이벤트 발생시 조회 수행
		com.setEnterKeyEvent(grp_hum_pop, scwin.openHumUserPop);
		
		scwin.data.cudType = "C"; 	// 저장구분
		scwin.data.status = "";		// 결재신청상태구분
		scwin.data.isRole = false;	// 권한
		
		// 공통코드
		var codeOptions = [ { code : "FAA", compID :"sbx_bankNm"} // 은행코드
			];
		com.setCmnCd(codeOptions, function() {
		});
		
		// 권한체크 
		com.biz.checkRole({ serviceId : "C253", roleCodes : com.getLoginInfo('roleCode')}, function(e){
			scwin.data.isRole = e.isRoleYn;
			
			if(scwin.data.isRole){
				ibx_payAmt.setDisabled(false);
				ibx_dedctTerm.setDisabled(false);	
				ibx_monthDedctAmt.setDisabled(false);
				btn_userSearch.show("");
			}
			
			if(dma_search.get("req_no")){
				scwin.data.cudType = "U";
				
				scwin.search(scwin.data.isRole);
			}else{ // 최초작성 일때
				// 신규신청이 가능한 상조회원(정규직) 자격여부 확인하여 신청버튼 사용가능여부 제어
				var listPosiCd = ["110010","130020","130030","130040","130050","130010","150010","150020","150030","150040","150050","170010","170020","170030","170040","170050","420030","430030","420020","420025","430020","430025","420010","420015","430010","430015"];
				if(listPosiCd.indexOf(com.getLoginInfo("posiCode")) == -1) {
					com.alert("상조회원만 이용 가능합니다.", function(){
						com.moveList("C267");
					});
				} else {
					// 기대출금 조회
					scwin.searchLoanRamt(com.getLoginInfo("sn"));
					
					dma_result.set("repay_month", 48);
					ibx_payAmt.setDisabled(true);
					ibx_dedctTerm.setDisabled(true);
					ibx_monthDedctAmt.setDisabled(true);
					ica_payYmd.setDisabled(true);
					
					// 신청자 정보 셋팅
					tbx_reqPsn.setValue(com.getLoginInfo("empno"));
					btn_userSearch.trigger("click");
					
					// 버튼제어(결재신청, 저장, 삭제) 
					com.biz.disabledButtons();
					
					// 하단 버튼제어(확정, 승인, 반려)
					scwin.btnController();
				}
				
			}
		});
		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/**
	 * 컴포넌트 disable true 처리
	 */		
	scwin.disable = function() {
		ibx_loanAmt.setDisabled(true);
		ibx_reqCause.setDisabled(true);
		ica_reqYmd.setDisabled(true);
		rdb_depstClsf.setDisabled(true);
		
		ibx_payAmt.setDisabled(true);
		ibx_dedctTerm.setDisabled(true);
		ibx_monthDedctAmt.setDisabled(true);
		ibx_loanTerm.setDisabled(true);
		ica_payYmd.setDisabled(true);
	}

	/**
	 * 컴포넌트 disable false 처리
	 */		
	scwin.unDisable = function() {
		ibx_payAmt.setDisabled(false);
		ibx_dedctTerm.setDisabled(false);
		ibx_monthDedctAmt.setDisabled(false);
		ibx_loanTerm.setDisabled(false);
		ica_payYmd.setDisabled(false);
	}
	
	scwin.search = function(isRole) {
		com.execute(sbm_selectDetail, {
			successCallback : function(e) {
				var param4 = com.getParameter("param4");
				var reqNo = dma_result.get("req_no");		
				var aprStateCode = dma_result.get("apr_state");
				var reqSyspayno = dma_result.get("req_psn_syspayno");
				var depstClsf = dma_result.get("depst_clsf");		
				var sn = com.getLoginInfo("sn");
				
				// 입금계좌별 계좌번호,은행, 에금주 셋팅 
				if(depstClsf == "HSA010"){
					ibx_bankNo.setValue(dma_result.get("pay_bankaccnt"));
					sbx_bankNm.setValue(dma_result.get("pay_bank_cd"));
					tbx_depstr.setValue(dma_result.get("depstr_nm"));
				}else if(depstClsf == "HSA020"){
					ibx_bankNo.setValue(dma_result.get("oth_bankaccnt"));
					sbx_bankNm.setValue(dma_result.get("oth_bank_cd"));
					tbx_depstr.setValue(dma_result.get("oth_depstr"));
				}
				
				// 문서함에서 이동한 경우 -> param4 : apr
				if(param4 != ""){
					if(aprStateCode == "XAD100" && isRole){
						btn_print.setDisabled(false); // 인쇄버튼 활성화
					} 
				}	
				
				if(reqSyspayno == sn && (aprStateCode != "XAD005" && aprStateCode != "XAD013" && aprStateCode != "XAD015")){
					scwin.disable();
				}else if(reqSyspayno != sn){
					scwin.disable();
				}

				if(aprStateCode == "XAD070" && isRole){
					scwin.unDisable();
					btn_print.setDisabled(false); // 인쇄버튼 활성화
				}
				
				if(aprStateCode == "XAD100"){
					// 확정내역 조회
					scwin.searchDecideInfo();
				}
				
				// 대출가능금액 산정
				scwin.getPossblLoanAmt();
				
				// 승인, 반려, 확정 버튼 상태 변경
				scwin.btnController(aprStateCode, reqSyspayno, isRole);
				
				// 결재상태에 따른 버튼제어 (결재신청, 삭제, 저장)
				com.biz.disabledButtons(aprStateCode, reqNo);
			}
		});
	};
	
	scwin.save = function() {
		if(scwin.data.status == "apr"){
			// 결재여부셋팅
			dma_result.set("approval", true); 
		}else{
			dma_result.set("approval", false);
			
			if(scwin.data.cudType == "C"){ // 입력일때
				dma_result.set("req_state", "XRR020");					// 신청상태코드
			} 
		}
		
		dma_result.set("cud_type", scwin.data.cudType); 				// 저장상태구분셋팅
		dma_result.set("depst_bankaccnt_no", ibx_bankNo.getValue()); 	// 입금계좌번호 
		dma_result.set("depst_bank_cd", sbx_bankNm.getValue()); 		// 입금은행코드
		dma_result.set("depst_bank_nm", sbx_bankNm.getText()); 			// 입금은행명
		dma_result.set("depstr_nm", tbx_depstr.getValue()); 			// 예금주
		
		com.execute(sbm_saveDetail, {
			successCallback : function(e) { // 성공 콜백
				if(scwin.data.status == "affir"){ // 승인처리
					scwin.procApr("agree");
				}else{
					if (dma_result.get("approval")) {
						com.alert("결재신청 되었습니다", function() {
							scwin.moveAprPage("A005");
						});
					} else {
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
							scwin.search(scwin.data.isRole);
						});	
					}	
				}
			}
		});
	}
	
	/**
	 * 대출금마스터 등록 (확정버튼 클릭시)
	 */		
	scwin.saveLoanMaster = function() {
		dma_loanMaster.set("syspayno", dma_result.get("req_psn_syspayno"));		//시스템 개인번호
		dma_loanMaster.set("loan_cd", "507");									//대출코드
		dma_loanMaster.set("loan_ymd", ica_payYmd.getValue());					//대출일
		dma_loanMaster.set("loan_tot_liq", dma_result.get("pay_amt"));			//대출총액
		dma_loanMaster.set("loan_ramt", dma_result.get("pay_amt"));				//잔액
		dma_loanMaster.set("loan_rts", 0);										//대출이율 - 서버프로그램에서 현재대출마스터테이블의 최대 이율로 설정한다.
		dma_loanMaster.set("tot_repay_amt", 0);									//총 상환금액
		dma_loanMaster.set("month_repay_amt", dma_result.get("month_dedct_amt"));	//월 상환금액
		dma_loanMaster.set("repay_times", 0);									//상환횟수
		dma_loanMaster.set("dedct_start_ymd", ica_payYmd.getValue());			//공제시작일자
		
		dma_loanMaster.set("repay_schdl_tot_times", dma_result.get("fix_repay_month"));	//상환회수
		
		var tmpStart = ica_payYmd.getValue();
		var tmpTerm = dma_result.get("fix_repay_month").trim();
		tmpTerm = tmpTerm != "" ? tmpTerm : 0;
		var tmpDate  = com.addMonth(tmpStart, tmpTerm);
		
		dma_loanMaster.set("final_dedct_ymd", tmpDate);							//공제종료일자
		
		dma_loanMaster.set("tot_repay_intrst", 0);		
		dma_loanMaster.set("thmon_intrst_amt", 0);	
		dma_loanMaster.set("tot_midway_repay_amt", 0);		
		dma_loanMaster.set("tot_midway_repay_intrst", 0);
		dma_loanMaster.set("midway_repay_times", 0);		
		dma_loanMaster.set("thmon_midway_repay_intrst_amt", 0);	
		
		dma_loanMaster.set("dedct_progrss_state", "1");
		dma_loanMaster.set("req_no", tbx_reqNo.getValue());
		
		com.execute(sbm_saveLoanMaster, {
			successCallback : function(e) { // 성공 콜백
				com.alert("상조금대출신청이 확정되었습니다.", function() {
					btn_decide.hide(); // 확정버튼
				});	
			}
		});
	}
	
	// 필수값체크 
	scwin.validateCheck = function() {
		return com.validateData(dma_result, [  
			 { id : "loan_amt", mandatory : true, allowChar : "0-9" }
			,{ id : "repay_month", mandatory : true, allowChar : "0-9" }
			,{ id : "loan_amt", valFunc : function(value) {
		  					if (Number(value) < 1000000) {
		  						ibx_loanAmt.focus();
		  						return "[알림] 최소대출금액은 백만원입니다.";
		  					}
						 } 
			 }
		], false);
	}
	
	// 필수값체크(담당자 승인 처리시) 
	scwin.validateCheck2 = function() {
		return com.validateData(dma_result, [  
			,{ id : "pay_amt", mandatory : true, allowChar : "0-9" }
			,{ id : "fix_repay_month", mandatory : true, allowChar : "0-9" }
			,{ id : "month_dedct_amt",mandatory : true, allowChar : "0-9" }
			,{ id : "pay_ymd",mandatory : true}
			,{ id : "pay_amt", valFunc : function(value) {
		  					if (Number(value) <= 0) {
		  						return "[알림] 사정금액을 입력해주세요.";
		  					}
						 }  
			}
		], false);
	}
	
	/**
	 * 급여계좌정보 조회
	 */	
	scwin.searchBasicInfo = function(){
		com.execute(sbm_selectBasicInfo, {
			successCallback : function(e) { // 성공 콜백
				ibx_bankNo.setValue(dma_resultBankInfo.get("pay_bankaccnt"));
				sbx_bankNm.setValue(dma_resultBankInfo.get("pay_bank_cd"));
				tbx_depstr.setValue(dma_resultBankInfo.get("pay_depstr"));
				rdb_depstClsf.setValue( "HSA010" );
			}
		});
	}
	
	/**
	 * 확정내역 조회
	 */	
	scwin.searchDecideInfo = function(){
		com.execute(sbm_selectDecideInfo, {
			successCallback : function(e) { // 성공 콜백
				if(dma_resultDecideInfo.get("req_no")){ // 확정내역 있을 경우
					btn_decide.hide(); 		// 확정버튼
					btn_print.show(""); 	// 인쇄버튼
					btn_reject.show(""); 	// 반려버튼
				}else{
					btn_decide.show(""); 	
				}
			}
		});
	}
	
	/**
	 * 대출가능금액 산정
	 */
	scwin.getPossblLoanAmt = function(){
		// possibleAmt : 대출가능금액;
		// availSum : 전별금
		// retireAppro : 퇴직금
		// totalAmt : 퇴충금
		// loanRamt : 대출잔액(= 대학융자금잔액 + 상조회대출잔액)
		// univLoanRamt : 대학융자금 대출 잔액
		// aidLoanRamt : 상조회 대출 잔액
		// sci_tech_anutyYn : 연금보험가입여부
		
		var possibleAmt = 0;
		
		var sci_tech_anutyYn = dma_result.get("sci_tech_anuty");
		var entrYmd = dma_result.get("entr_ymd");
		
		var loanRamt = dma_result.get("loan_ramt") || dma_loanRamt.get("loan_ramt");
		var aidLoanRamt = dma_result.get("aid_loan_ramt") || dma_loanRamt.get("aid_loan_ramt");
		var univLoanRamt = dma_result.get("univ_loan_ramt") || dma_loanRamt.get("univ_loan_ramt");
		
		var retireAppro = dma_result.get("retire_appro") || dma_loanRamt.get("retire_appro");
		var availSum = dma_result.get("avail_sum") || dma_loanRamt.get("avail_sum");
		
		// 전별금 + 퇴직금
		var totalAmt = Number(availSum) + Number(retireAppro);
		// 최대대출가능금액(= 대출잔액 + 현가능금액)
		var maxLoanAmt = 0;
		// 상조회기초금액
		var aidPossibleAmt = (Number(availSum) + Number(retireAppro)) - Number(univLoanRamt);
		// 대출가능금액(금액상)
		var tPsbAmt = Number(totalAmt) - Number(loanRamt);
		// 기준 대출가능금액(금액상) 
		var stdAmt = 10000000 - Number(aidLoanRamt); 
		// 입원일로부터 현재까지의 근무일 수
		var dDayCnt = com.diffDate(entrYmd, com.getServerDateTime());
		    dDayCnt = Number(dDayCnt) + 1;
		    
		//console.log("연금보험가입여부_________>> :: " + sci_tech_anutyYn);
						
		//console.log(">대출가능금액 요소<  전별금 : " + availSum +", 퇴직금 : "+ retireAppro +", 상조회기초금액 : "+ aidPossibleAmt +", 대출잔액 : "+ loanRamt +", 대학융자잔액 : "+univLoanRamt+", 입원일자:"+entrYmd);
		//console.log(">대출가능금액 요소<  퇴직금전체: "+totalAmt+", 계산가능금액 : " + tPsbAmt);
		// 입원일 기준 1년이상자와 미만인자 구분. 
		// 입사1년 미만자는 퇴직금 자체가 없기때문에 연금보험가입여부 판단 불필요
		if(Number(dDayCnt) < 365){
			possibleAmt = 3000000 - Number(loanRamt);
			if(possibleAmt < 1000000){
			   possibleAmt = 0;
			}
		}else{
			//연금가입의 경우
			//대출가능금액 = 1,000만원 - 기대출금액(상조회대출잔액)
			if(sci_tech_anutyYn == "Y"){  
				if(Number(aidLoanRamt) > 10000000){ //기대출금액이 천만원 이상이면 더이상 대출불가 (상조회대출잔액)
					possibleAmt = 0;
				}else{
					if(Number(stdAmt) >= 0 && Number(stdAmt) < 1000000){  //일백만원 
						possibleAmt = 0;
					}else if(Number(stdAmt) < 0){  // 기대출금이 일천만원 초과자
						possibleAmt = 0;
					}else{  //일천만원
						possibleAmt = 10000000 - Number(aidLoanRamt);
						//총대출금액은 퇴충금을 초과할 수 없다.
						//if(Number(totalAmt) < Number(possibleAmt) + Number(loanRamt)){
						//	possibleAmt = Number(possibleAmt) - (Number(totalAmt) - (Number(possibleAmt) + Number(loanRamt)));
						//}else{
						//	
						//}
						if(tbx_reqEmpNo.getValue() == "100611"){//박세호 선임 요청(황연태실장 3000만원고정)
							possibleAmt = 30000000;
						}
					}
				}
			
			}else{  
			    //연금미가입자
				if(Number(aidLoanRamt) > 30000000){ //기대출금액이 삼천만원 이상이면 더이상 대출불가
					possibleAmt = 0;
				}else {
					//퇴충금 일천만원 이하자
					if(Number(totalAmt) <= 10000000){  
						if(Number(stdAmt) >= 0 && Number(stdAmt) < 1000000){
							possibleAmt = 0;
						}else if(Number(stdAmt) < 0){  // 기대출금이 일천만원 초과자
							possibleAmt = 0;
						}else{
							possibleAmt = 10000000 - Number(aidLoanRamt);
							//대출가능금액은 퇴충금을 초과할 수 없다.
							//대출가능금액은 최소 1,000만원까지 가능하다. 본 이유로 아래 로직 폐기
							/*if(Number(totalAmt) < Number(possibleAmt) + Number(loanRamt)){
								//possibleAmt = Number(possibleAmt) - ((Number(possibleAmt) + Number(loanRamt)) - Number(totalAmt));
								possibleAmt = Number(totalAmt) - Number(loanRamt);
							}else{
							
							}*/
						}
					}else{  //퇴충금 일천만원 초과자
						if(Number(totalAmt) > 30000000){
							possibleAmt = 30000000 - Number(aidLoanRamt);
							//총대출금액은 퇴충금을 초과할 수 없다.
							if(Number(totalAmt) < Number(possibleAmt) + Number(loanRamt)){
								//possibleAmt = Number(possibleAmt) - ((Number(possibleAmt) + Number(loanRamt))- Number(totalAmt));
								possibleAmt = Number(totalAmt) - Number(loanRamt);
							}else{
							
							}
						}else{
							possibleAmt = Number(totalAmt) - Number(aidLoanRamt);  //=퇴충금 - 상조회대출잔액
							//총대출금액은 퇴충금을 초과할 수 없다.
							if(Number(totalAmt) < Number(possibleAmt) + Number(loanRamt)){ 
								//= 가능금액 - ((가능금액 + 대출잔액) - 퇴충금)
								//possibleAmt = Number(possibleAmt) - ((Number(possibleAmt) + Number(loanRamt)) - Number(totalAmt));
								possibleAmt = Number(totalAmt) - Number(loanRamt);
							}else{
							
							}
						}
						
						if(Number(possibleAmt) < 1000000){
							possibleAmt = 0;
						}
					}
				}
			}
		}
		
		//console.log("<대출가능금액계산> 날수:" + dDayCnt+", 가능금액:"+possibleAmt);
		if(isNaN(possibleAmt)){
			ibx_possblLoanAmt.setValue(0);  //대출가능금액
		}else{
			ibx_possblLoanAmt.setValue(possibleAmt);  //대출가능금액
		}
	}
	
	/**
	 * 기대출금  조회
	 */
	scwin.searchLoanRamt = function(syspayno){
		dma_search.set("req_psn_syspayno", syspayno);
		dma_search.set("sci_tech_anuty", dma_result.get("sci_tech_anuty"));
		
		com.execute(sbm_selectLoanRamt, {
			successCallback : function(e) { // 성공 콜백
				tbx_existLoanAmt.setValue(dma_loanRamt.get("loan_ramt"));
				tbx_aidLoanRamt.setValue(dma_loanRamt.get("aid_loan_ramt"));
				tbx_univLoanRamt.setValue(dma_loanRamt.get("univ_loan_ramt"));
				
				// 2023.09.06 기능개선 요청사항 적용 - 기대출금액 존재 시, 결재신청서 작성단계에서 추가대출 불가 안내
				var loanRamt = dma_loanRamt.get("loan_ramt");
				if(!com.isEmpty(loanRamt) && loanRamt > 0){
					com.alert("상조회 회칙>대출규약>제5조에 따라 추가 대출이 불가능합니다.\n제5조 (추가대출)기대출금을 모두 상환한 경우에만 추가 대출이 가능하며, 대출금의 상환은 본 규약 제4조에 따른다 (개정 `20.5.28.)\n문의 : 총무보안실 상조회 담당자", function() {
						// alert 콜백
						com.closeTab({});
					});
				}else{
					// 대출가능금액 산정
					scwin.getPossblLoanAmt();
				}
				
				// 급여계좌기본정보 조회 후 셋팅
				scwin.searchBasicInfo();
			}
		});
	}

	/**
	 * 승인, 반려, 확정 버튼 상태변경
	 *  
	 * @param aprState 전자결재 상태코드
	 * @param reqSyspayno 등록자 시스템개인번호
	 * @param roleChk 담당자 확인 [true:false]
	 */
	scwin.btnController = function(aprState, reqSyspayno, roleChk) {
		// 확정, 반려, 승인 버튼 숨김처리
		btn_decide.hide();
		btn_reject.hide();
		btn_confirm.hide();
		
		if(!aprState) return; 
		
		// 승인, 반려
		if (aprState == "XAD060" && roleChk) { // *수신(접수) - 학자금보조신청 담당자단계 일때만 사용
			btn_confirm.show("");
			btn_reject.show("");
		}else if (aprState == "XAD070" && roleChk) { // *담당자확인 - 반려, 처리(승인)
			btn_confirm.show("");
			btn_reject.show("");
		}else if (aprState == "XAD100" && roleChk) { // *결재완료 - 목록
			btn_reject.show("");
		}
	}
	
	/**
	 * 승인, 반려 처리
	 */
	scwin.procApr = function(doAction) {
		dma_procApr.set("req_no", dma_result.get("req_no"));
		dma_procApr.set("req_action", doAction); // 동작구분 : agree-승인, reject-반려 
		dma_procApr.set("apr_state", dma_result.get("apr_state")); // 결재상태코드 
		
		com.execute(sbm_procApr, {
			successCallback : function(e) { // 성공 콜백
				var msg = "";
				if (doAction == "agree") {
					msg = "승인 처리 되었습니다.";
				} else {
					msg = "반려 처리 되었습니다.";
				}
				com.alert(msg, function() {
					scwin.moveAprPage("A004");
				});
			}
		});
	}
	
	// 양식함 이동	
	scwin.moveAprPage = function(serviceID) {
		com.movePageMenu(serviceID, {});
		
		let dummyModal = document.querySelector('.w2modal_popup');
		if (dummyModal) {
			dummyModal.style.display = 'none';
		}
	}	
	
	/**
	 * 저장 버튼 클릭 이벤트
	 */
	scwin.btn_save_onclick = function(e) {
		if(!scwin.validateCheck()) return;
		
		scwin.data.status = "save";
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret) {
			if (ret) {
				scwin.save();
			}
		});
	};
	
	/**
	 * 목록 버튼 클릭시 이벤트
	 */
	scwin.btn_pre_onclick = function(e) {
		var menuId = com.getParameter("menuID") || "C267";
		com.moveList(menuId);
	};
	
	/**
	 * 삭제 버튼 클릭시 이벤트
	 */
	scwin.btn_del_onclick = function(e) {
		com.confirm("message.xom.wq.022"/*삭제 하시겠습니까?*/, function( ret) {
			if (ret) {
				com.execute(sbm_deleteDetail, {
					successCallback : function(e) { // 성공 콜백
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
							com.moveList(com.getParameter("menuID"), {mod :"delete"});
						});
					}
				});
			}
		});
	};
	
	/**
	 * 인쇄 버튼 클릭시 이벤트
	 */
	scwin.btn_print_onclick = function(e) {
		var reqNo = tbx_reqNo.getValue();
		if(reqNo.trim() != ""){
			let node = "req_no=" + reqNo;
			com.oz.openPopup({
			    ozrCode : "C042",      
			    param: node
			});
		}else{
			com.alert("인쇄할 내용이 없습니다.");
		}
	};
	
	/**
	 * 결재신청 버튼 클릭시 이벤트
	 */
	scwin.btn_apr_onclick = function(e) {
		if(!scwin.validateCheck()) return;
		
		scwin.data.status = "apr";
		
		scwin.save();
	};
	
	/**
	 * 사용자 검색 버튼 클릭 이벤트
	 */	
	scwin.btn_userSearch_onclick = function(e) {
		scwin.openHumUserPop();
	};
	
	/**
	 * 사용자검색 팝업 실행
	 */
	scwin.openHumUserPop = function(){
		var vNm = tbx_reqPsn.getValue().trim(); 
		var data = { empno : vNm, work_clsf : "HAG010" };
		
		com.pop.open(com.pop.TYPE.HUM, data, function(ret){
			dma_result.set("centr_cd", ret.fomat_unit);
			dma_result.set("centr_nm", ret.region_nm);

			dma_result.set("dept_cd", ret.dept_cd);
			dma_result.set("dept_nm", ret.dept_nm);

			dma_result.set("req_psn_syspayno", ret.syspayno);
			dma_result.set("req_psn", ret.nm);
			tbx_depstr.setValue(ret.nm);
			
			dma_result.set("empno", ret.empno);
			dma_result.set("dept_tel", ret.mobile);
			
			dma_result.set("dept_new_ymd", ret.dept_new_ymd);

			dma_result.set("sci_tech_anuty", ret.sci_tech_anuty);
			dma_result.set("entr_ymd", ret.entr_ymd);

			dma_result.set("req_ymd", com.getServerDateTime());
			
		});
	}
	
	/**
	 * 확정 버튼 클릭시 이벤트 - 대출금마스터 등록
	 */	
	scwinbtn_decide_onclick = function(e) {
		scwin.saveLoanMaster();
	};
	
	/**
	 * 반려 버튼 클릭시 이벤트 
	 */		
	scwin.btn_reject_onclick = function(e) {
		com.confirm("상조회대출신청건을 반려 하시려면 [확인]을 클릭하세요.", function(ret) {
			if(ret){
				com.pop.open(com.pop.TYPE.RETRN_OPN,{ref_yn : "Y"}, function(ret){
					if(ret.comments){
						dma_procApr.set("comments", ret.comments);
						scwin.procApr("reject");	
					}
				});
			}
		});
	};
	
	/**
	 * 승인 버튼 클릭시 이벤트 
	 */		
	scwin.btn_confirm_onclick = function(e) {
		if(!scwin.validateCheck2()) return;
		scwin.data.status = "affir";
		
		scwin.save();
	};
	
	/**
	 * 대출가능금액 값 변경시 이벤트 
	 */	
	scwin.ibx_possblLoanAmt_onviewchange = function(info) {
		var loanAmt = dma_result.get("loan_amt"); // 대출신청금액
		var possblLoanAmt = ibx_possblLoanAmt.getValue(); // 대출가능금액
		
		if(Number(loanAmt) > Number(possblLoanAmt)){
			com.alert("대출가능금액을 초과했습니다. 확인해주세요.", function() {
				dma_result.get("loan_amt");
				ibx_loanAmt.focus();
			});
			return;
		}
		
		var tmp1 = dma_result.get("repay_month");
		var tmp2 = dma_result.get("loan_amt");
		var tmp3 = 0;
		if((tmp1 != "" && tmp1 != null) && (tmp2 != "" && tmp2 != null)){
			tmp3 = Math.floor(tmp2/tmp1);
		}
		if(isNaN(tmp3)){
			tbx_expctDedctAmt.setValue(0);
		}else{
			tbx_expctDedctAmt.setValue(tmp3);
		}
	};
	
	/**
	 * 상환월수 값 변경시 이벤트 
	 */		
	scwin.ibx_loanTerm_onchange = function(info) {
		var tmp1 = dma_result.get("repay_month");
		var tmp2 = dma_result.get("loan_amt");
		var tmp3 = 0;
		if((tmp1 != "" && tmp1 != null) && (tmp2 != "" && tmp2 != null)){
			tmp3 = Math.floor(tmp2/tmp1);
		}
		if(isNaN(tmp3)){
			tbx_expctDedctAmt.setValue(0);
		}else{
			tbx_expctDedctAmt.setValue(tmp3);
		}
		
		if(tmp1 > 48){
			com.alert("상환개월 수는 48개월을 넘길 수가 없습니다.");
			dma_result.set("repay_month", 48);
		}		
	};
	
	/**
	 * 급여계좌 라디오박스 선택시 이벤트 
	 */			
	scwin.rdb_depstClsf_onviewchange = function(info) {
		var payBankAccnt = dma_result.get("pay_bankaccnt") || dma_resultBankInfo.get("pay_bankaccnt");
		var payBankCd = dma_result.get("pay_bank_cd") || dma_resultBankInfo.get("pay_bank_cd");
		var payDepstr = dma_result.get("pay_depstr") || dma_resultBankInfo.get("pay_depstr");
		
		var othBankAccnt = dma_result.get("oth_bankaccnt") || dma_resultBankInfo.get("oth_bankaccnt");
		var othBankCd = dma_result.get("oth_bank_cd") || dma_resultBankInfo.get("oth_bank_cd");
		var othDepstr = dma_result.get("oth_depstr") || dma_resultBankInfo.get("oth_depstr");
		
		if(rdb_depstClsf.getValue() == "HSA010"){
			ibx_bankNo.setValue(payBankAccnt);
			sbx_bankNm.setValue(payBankCd);
			tbx_depstr.setValue(payDepstr);
		}else{
			ibx_bankNo.setValue(othBankAccnt);
			sbx_bankNm.setValue(othBankCd);
			tbx_depstr.setValue(othDepstr);
		}
	};
	
	/**
	 * 신청금액 값 변경시 이벤트 
	 */		
	scwin.ibx_loanAmt_onviewchange = function(info) {
		var tmp1 = dma_result.get("loan_amt");
		var tmp2 = ibx_possblLoanAmt.getValue();
		
		if(Number(tmp1) > Number(tmp2)){
			com.alert("대출가능금액을 초과했습니다. 확인해주세요.", function(){
				dma_result.set("loan_amt", 0);
				ibx_loanAmt.focus();
			});
			return;
		}
		
		if(Number(tmp1) < 1000000){
			com.alert("[알림] 최소대출금액은 백만원입니다.", function(){
				dma_result.set("repay_month", 48);
				ibx_loanAmt.focus();
			});
			return;
		}
		
		var tmp1 = dma_result.get("repay_month");
		var tmp2 = dma_result.get("loan_amt");
		var tmp3 = 0;
		if((tmp1 != "" && tmp1 != null) && (tmp2 != "" && tmp2 != null)){
			tmp3 = Math.floor(tmp2/tmp1);
		}
		if(isNaN(tmp3)){
			tbx_expctDedctAmt.setValue(0);
		}else{
			tbx_expctDedctAmt.setValue(tmp3);
		}
	};
	
	/**
	 * 사정금액 값 변경시 이벤트 
	 */			
	scwin.ibx_payAmt_onviewchange = function(info) {
		var tmp1 = dma_result.get("fix_repay_month");
		var tmp2 = dma_result.get("pay_amt");
		var tmp3 = Math.floor(tmp2/tmp1);
		
		if(tmp1 == ""){
			com.alert("확정상환월수를 입력해 주세요.");
			return;
		}
		
		if(tmp1 != "" && tmp2 != ""){
			dma_result.set("month_dedct_amt", tmp3);
		}
	};
	
	/**
	 * 확정상환월수 값 변경시 이벤트 
	 */			
	scwin.ibx_dedctTerm_onviewchange = function(info) {
		var tmp1 = dma_result.get("fix_repay_month");
		var tmp2 = dma_result.get("pay_amt");
		var tmp3 = Math.floor(tmp2/tmp1);
		
		if(tmp2 == ""){
			com.alert("사정금액을 입력해 주세요.");
			return;
		}
		
		if(tmp2 != "" && tmp1 != ""){
			dma_result.set("month_dedct_amt", tmp3);
		}
	};
]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group class="pageWrap" id="grp_main" style="">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="">
    				<xf:trigger class="btn " id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox" id="">
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" disabled="true" ev:onclick="scwin.btn_print_onclick">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick" disabled="true">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_reqNo" label="000" style="" tagname="span" ref="data:dma_result.req_no"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="센터" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_centrNm" label="000" style="" tagname="span" ref="data:dma_result.centr_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="tbx_deptNm" label="총무보안실" style="" tagname="span" ref="data:dma_result.dept_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="성명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:group class="flex flex_lybox" id="grp_hum_pop">
    						<w2:textbox class="" id="tbx_reqPsn" label="홍길동" style="" tagname="span" ref="data:dma_result.req_psn"></w2:textbox>
		    				<xf:trigger class="btn glass" id="btn_userSearch" style=";display:;visibility:hidden;" type="button" ev:onclick="scwin.btn_userSearch_onclick">
	    						<xf:label><![CDATA[검색]]></xf:label>
	    					</xf:trigger>
		    			</xf:group>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="급여번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="tbx_reqEmpNo" label="12345" style="" tagname="span" ref="data:dma_result.empno"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="전화번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="" id="tbx_deptTel" label="010-1234-1234" style="" tagname="span" ref="data:dma_result.dept_tel"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기대출금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="tbx_existLoanAmt" style="max-width: 150px;" disabled="true" dataType="number" displayFormat="#,###" ref="data:dma_result.loan_ramt"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="상조회대출잔액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="tbx_aidLoanRamt" style="max-width: 150px;" disabled="true" dataType="number" displayFormat="#,###" ref="data:dma_result.aid_loan_ramt"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="대학융자금잔액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="tbx_univLoanRamt" style="max-width: 150px;" disabled="true" dataType="number" ref="data:dma_result.univ_loan_ramt"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="대출가능금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="ibx_possblLoanAmt" style="max-width: 150px;" dataType="number" displayFormat="#,###" readOnly="true" ev:onviewchange="scwin.ibx_possblLoanAmt_onviewchange"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    					<w2:span class="helptxt blue" id="" label="* 대출규약 2조에 의거 대출한도는 최저 100만원부터 가능합니다." style=""></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="신청금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input class="inp full ri" id="ibx_loanAmt" style="max-width: 150px;" dataType="number" ref="data:dma_result.loan_amt" displayFormat="#,###,###,###,###,###,###" allowChar="0-9" ev:onviewchange="scwin.ibx_loanAmt_onviewchange" maskFormat="reverse" maskFormatModelExcludeChar=","></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="상환월수" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp ri" id="ibx_loanTerm" style="width: 70px;" ref="data:dma_result.repay_month" allowChar="0-9" ev:onchange="scwin.ibx_loanTerm_onchange" displayFormat="#,###,###,###,###,###,###" maskFormat="reverse" maskFormatModelExcludeChar=","></xf:input>
    					<w2:textbox class="txt" id="" label="개월 (최소 1~48 개월)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="예상월공제액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp ri" id="tbx_expctDedctAmt" style="width: 150px;" disabled="true" dataType="number" displayFormat="#,###,###,###,###,###,###"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청사유" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="ibx_reqCause" style="" ref="data:dma_result.req_cause"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<xf:group id="" class="flex">
	    					<w2:textbox id="" label="입금계좌" style="" tagname="span"></w2:textbox>
	    					<xf:select1 appearance="full" class="radioGroup ml10" cols="" id="rdb_depstClsf" ref="data:dma_result.depst_clsf" renderType="radiogroup" rows="1"
	    						selectedIndex="-1" style="" ev:onviewchange="scwin.rdb_depstClsf_onviewchange">
	    						<xf:choices>
	    							<xf:item>
	    								<xf:label><![CDATA[급여]]></xf:label>
	    								<xf:value><![CDATA[HSA010]]></xf:value>
	    							</xf:item>
	    							<xf:item>
	    								<xf:label><![CDATA[별도]]></xf:label>
	    								<xf:value><![CDATA[HSA020]]></xf:value>
	    							</xf:item>
	    						</xf:choices>
	    					</xf:select1>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="ibx_bankNo" label="000" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="은행명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-선택-" class="sel full" direction="auto"
    						 disabled="true" disabledClass="w2selectbox_disabled" id="sbx_bankNm" ref="" style="max-width:150px;" submenuSize="auto">
    						<xf:choices></xf:choices>
    					</xf:select1>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="예금주명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_depstr" label="000" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="사정금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp ri" id="ibx_payAmt" style="width: 150px;" ref="data:dma_result.pay_amt" dataType="number" displayFormat="#,###,###,###,###,###,###" disabled="true" ev:onviewchange="scwin.ibx_payAmt_onviewchange" allowChar="0-9" maskFormat="reverse" maskFormatModelExcludeChar=","></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정상환월수" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp ri" id="ibx_dedctTerm" style="width: 70px;" ref="data:dma_result.fix_repay_month" disabled="true" ev:onviewchange="scwin.ibx_dedctTerm_onviewchange" allowChar="0-9" displayFormat="#,###,###,###,###,###,###" maskFormat="reverse" dataType="number" maskFormatModelExcludeChar=","></xf:input>
    					<w2:textbox class="txt" id="" label="개월" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					확정월공제액
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" id="ibx_monthDedctAmt" style="max-width: 150px;" dataType="number" displayFormat="#,###,###,###,###,###,###" ref="data:dma_result.month_dedct_amt" disabled="true" allowChar="0-9" maskFormat="reverse" maskFormatModelExcludeChar=","></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="지급일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id="ica_payYmd"
    						rightAlign="false" style="max-width: 150px;" ref="data:dma_result.pay_ymd" disabled="true">
    					</w2:inputCalendar>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:textbox class="fwb mt10 red" id="" label="※  최근 상조회대출이 급격하게 증가하여 즉각적인 대출이 불가함을 알려드립니다." style=""></w2:textbox>
    		<w2:textbox class="fwb red" id="" label="추후 운영잔액 상황에 따라 대출에 대한 결재처리가 가능하오니 신청에 참고하시기 바랍니다." style="margin-left:13px;"></w2:textbox>
    		<xf:group class="flex_lybox" id="">
    			<xf:group class="mla" id="" style="">
    				<w2:textbox class="" id="" label="상기와 같이 이면대출규약에 의거 대출을 신청합니다." style=""></w2:textbox>
    				<xf:group class="mt10" id="">
    					<w2:textbox class="singleLine" id="" label="신 청 일 :" style="width: 60px;" tagname="span"></w2:textbox>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id="ica_reqYmd"
    						renderDiv="true" rightAlign="false" style="width: 100px;" ref="data:dma_result.req_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="mt10" id="">
    					<w2:textbox class="singleLine" id="" label="신 청 인 :" style="width: 60px;" tagname="span"></w2:textbox>
    					<w2:textbox class="singleLine" id="tbx_reqPsn2" label="홍길동" style="width: 80px;" tagname="span" ref="data:dma_result.req_psn"></w2:textbox>
    					<w2:textbox class="" id="" label="(인)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:textbox class="fs22 fwb ce mt20" id="" label="한국생산기술연구원 상조회장 귀하" style=""></w2:textbox>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style=""></xf:group>
    			<xf:group class="ri" id="">
    				<xf:trigger class="btn pro" ev:onclick="scwinbtn_decide_onclick" id="btn_decide" style="" type="button">
    					<xf:label><![CDATA[확정]]></xf:label>
    				</xf:trigger><xf:trigger class="btn pro" ev:onclick="scwin.btn_reject_onclick" id="btn_reject" style="" type="button">
    					<xf:label><![CDATA[반려]]></xf:label>
    				</xf:trigger><xf:trigger class="btn pro" ev:onclick="scwin.btn_confirm_onclick" id="btn_confirm" style="" type="button">
    					<xf:label><![CDATA[승인]]></xf:label>
    				</xf:trigger><xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick" disabled="true">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    				
    				
    				
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
