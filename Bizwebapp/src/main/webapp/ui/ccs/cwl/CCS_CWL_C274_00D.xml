<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="상조회중도상환신청서" meta_vertical_guides="" meta_horizontal_guides="452">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
        	<xf:instance>
        		<data xmlns="" />
        	</xf:instance>
        	<w2:dataCollection baseNode="map">
        		<w2:dataMap baseNode="map" id="dma_search">
        			<w2:keyInfo>
        				<w2:key id="req_no" name="req_no" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_result">
        			<w2:keyInfo>
        				<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
        				<w2:key id="apr_state" name="결재상태코드" dataType="text"></w2:key>
        				<w2:key id="req_ymd" name="신청일자" dataType="text"></w2:key>
        				<w2:key id="req_syspayno" name="신청자개인번호" dataType="text"></w2:key>
        				<w2:key id="req_empno" name="신청자사원번호" dataType="text"></w2:key>
        				<w2:key id="req_nm" name="신청자명" dataType="text"></w2:key>
        				<w2:key id="mobile" name="전화번호" dataType="text"></w2:key>
        				<w2:key id="req_dept_cd" name="신청자부서코드" dataType="text"></w2:key>
        				<w2:key id="req_dept_new_ymd" name="신청자부서신설일자" dataType="text"></w2:key>
        				<w2:key id="req_dept_nm" name="신청자부서명" dataType="text"></w2:key>
        				<w2:key id="centr_nm" name="센터명" dataType="text"></w2:key>
        				<w2:key id="req_midway_repay_ymd" name="중도상환신청일자" dataType="text"></w2:key>
        				<w2:key id="midway_repay_ymd" name="중도상환일자" dataType="text"></w2:key>
        				<w2:key id="midway_repay_amt" name="중도상환금액" dataType="text"></w2:key>
        				<w2:key id="midway_repay_intrst" name="중도상환이자" dataType="text"></w2:key>
        				<w2:key id="dedct_clsf" name="공제구분" dataType="text"></w2:key>
        				<w2:key id="loan_rts" name="대출이자" dataType="text"></w2:key>
        				<w2:key id="midway_repay_aft_amt" name="중도상환후잔액" dataType="text"></w2:key>
        				<w2:key id="biz_proc_cd" name="업무상태코드" dataType="text"></w2:key>
        				<w2:key id="loan_cd" name="대출코드" dataType="text"></w2:key>
        				<w2:key id="loan_nm" name="대출명" dataType="text"></w2:key>
        				<w2:key id="loan_ymd" name="대출일자" dataType="text"></w2:key>
        				<w2:key id="loan_syspayno" name="대출자시스템개인번호" dataType="text"></w2:key>
        				<w2:key id="loan_psn_nm" name="대출자명" dataType="text"></w2:key>
        				<w2:key id="loan_tot_amt" name="대출금액" dataType="text"></w2:key>
        				<w2:key id="loan_ramt" name="대출잔액" dataType="text"></w2:key>
        				<w2:key id="tot_repay_amt" name="총상환금액" dataType="text"></w2:key>
        				<w2:key id="tot_repay_intrst" name="총상환이자금액" dataType="text"></w2:key>
        				<w2:key id="tot_midway_repay_amt" name="총중도상환금액" dataType="text"></w2:key>
        				<w2:key id="tot_midway_repay_intrst" name="총중동상환이자금액" dataType="text"></w2:key>
        				<w2:key id="sum_repay_amt" name="대출상환총액" dataType="text"></w2:key>
        				<w2:key id="rmk" name="비고" dataType="text"></w2:key>
        				<w2:key id="cofm_ymd" name="확정일자" dataType="text"></w2:key>
        				<w2:key id="cofm_syspayno" name="확정자개인시스템번호" dataType="text"></w2:key>
        				<w2:key id="cofm_psn_nm" name="확정자명" dataType="text"></w2:key>
        				<w2:key id="pre_midway_repay_ymd" name="중도상환일자" dataType="text"></w2:key>
        				<w2:key id="midway_repay_times" name="중도상환회수" dataType="text"></w2:key>
        				<w2:key id="email" name="이메일" dataType="text"></w2:key>
        				<w2:key id="approval" name="결재여부" dataType="text"></w2:key>
        				<w2:key id="comments" name="반려의견" dataType="text"></w2:key>
        				<w2:key id="odr" name="name41" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_resultDecideInfo" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_docComments" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" ev:onrowpositionchange="" id="dlt_docComments" repeatNode="map" saveRemovedData="true"
        			style="">
        			<w2:columnInfo>
        				<w2:column dataType="text" id="req_no" ignoreStatus="true" name="신청번호"></w2:column>
        				<w2:column dataType="text" id="empno" ignoreStatus="true" name="결재자"></w2:column>
        				<w2:column dataType="text" id="empname" ignoreStatus="true" name="결재자명"></w2:column>
        				<w2:column dataType="text" id="opt_type" name="결재상태"></w2:column>
        				<w2:column dataType="text" id="created_date" name="의견일시"></w2:column>
        				<w2:column dataType="text" id="contents" name="결재의견"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>

        		<w2:dataMap baseNode="map" id="dma_calculateInfo">
        			<w2:keyInfo>
        				<w2:key id="loan_syspayno" name="시스템개인번호" dataType="text"></w2:key>
        				<w2:key id="loan_ymd" name="대출일자" dataType="text"></w2:key>
        				<w2:key id="loan_cd" name="대출코드" dataType="text"></w2:key>
        				<w2:key id="dDay_cnt" name="name4" dataType="text"></w2:key>
        				<w2:key id="sDay_cnt" name="name5" dataType="text"></w2:key>
        				<w2:key id="midway_repay_amt" name="중도상환금액" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_calculateInfoResult" style="">
        			<w2:keyInfo>
        				<w2:key id="afRepayLoanAmt" name="상환 후 잔액" dataType="text"></w2:key>
        				<w2:key id="bfRepayIntrst" name="상환일 이전의 이자" dataType="text"></w2:key>
        				<w2:key id="afRepayIntrst" name="상환일 이후의 월 예상이자" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_loanMaster" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="syspayno" name="syspayno"></w2:key>
        				<w2:key dataType="text" id="loan_cd" name="loan_cd"></w2:key>
        				<w2:key dataType="text" id="loan_ymd" name="loan_ymd"></w2:key>
        				<w2:key dataType="text" id="loan_tot_liq" name="loan_tot_liq"></w2:key>
        				<w2:key dataType="text" id="loan_ramt" name="loan_ramt"></w2:key>
        				<w2:key dataType="text" id="loan_rts" name="loan_rts"></w2:key>
        				<w2:key dataType="text" id="tot_repay_amt" name="tot_repay_amt"></w2:key>
        				<w2:key dataType="text" id="tot_repay_intrst" name="tot_repay_intrst"></w2:key>
        				<w2:key dataType="text" id="month_repay_amt" name="month_repay_amt"></w2:key>
        				<w2:key dataType="text" id="thmon_intrst_amt" name="thmon_intrst_amt"></w2:key>
        				<w2:key dataType="text" id="repay_schdl_tot_times" name="repay_schdl_tot_times"></w2:key>
        				<w2:key dataType="text" id="repay_times" name="repay_times"></w2:key>
        				<w2:key dataType="text" id="dedct_start_ymd" name="dedct_start_ymd"></w2:key>
        				<w2:key dataType="text" id="midway_repay_ymd" name="midway_repay_ymd"></w2:key>
        				<w2:key dataType="text" id="final_dedct_ymd" name="final_dedct_ymd"></w2:key>
        				<w2:key dataType="text" id="tot_midway_repay_amt" name="tot_midway_repay_amt"></w2:key>
        				<w2:key dataType="text" id="tot_midway_repay_intrst" name="tot_midway_repay_intrst"></w2:key>
        				<w2:key dataType="text" id="midway_repay_times" name="midway_repay_times"></w2:key>
        				<w2:key dataType="text" id="thmon_midway_repay_intrst_amt" name="thmon_midway_repay_intrst_amt"></w2:key>
        				<w2:key dataType="text" id="dedct_progrss_state" name="dedct_progrss_state"></w2:key>
        				<w2:key dataType="text" id="def_intrst" name="def_intrst"></w2:key>
        				<w2:key dataType="text" id="repay_intrst" name="repay_intrst"></w2:key>
        				<w2:key dataType="text" id="tot_intrst_amt" name="tot_intrst_amt"></w2:key>
        				<w2:key dataType="text" id="confirm_day" name="confirm_day"></w2:key>
        				<w2:key dataType="text" id="req_defer" name="req_defer"></w2:key>
        				<w2:key dataType="text" id="req_repay" name="req_repay"></w2:key>
        				<w2:key dataType="text" id="req_repay_month" name="req_repay_month"></w2:key>
        				<w2:key dataType="text" id="rmk" name="rmk"></w2:key>
        				<w2:key dataType="text" id="req_no" name="req_no"></w2:key>
        				<w2:key dataType="text" id="regst_psn_syspayno" name="regst_psn_syspayno"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        	</w2:dataCollection>
        	<w2:workflowCollection></w2:workflowCollection>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSR01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_selectDetail" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style=""
        		target='data:json,{"id":"dma_result","key":"cwlLoanMidRepayReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSI01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_saveDetail" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref="data:json,dma_result" replace="" style=""
        		target='data:json,{"id":"dma_search","key":"cwlLoanMidRepayReqVo"}'>
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSU01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_updateDetail" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref='data:json,dma_result' replace="" style="" target="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSD01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_deleteDetail" instance="" mediatype="application/json" method="post"
        		mode="asynchronous" processMsg="" ref="data:json,dma_search" replace="" style="" target="">
        	</xf:submission>
        	
        	<xf:submission action="SvcComAprDocM01.pwkjson" encoding="UTF-8" id="SvcComAprDocM01" mediatype="application/json" method="post"
        		mode="asynchronous" ref="data:json,dma_docComments" target='data:json,{"id":"dlt_docComments","key":"docCommentsVo"}' style="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSM01.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_calculation" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref="data:json,dma_calculateInfo" replace="" style=""
        		target='data:json,{"id":"dma_calculateInfoResult","key":"cwlLoanMidRepayReqVo"}'>
        	</xf:submission>

        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSU02.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_confirm" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref='data:json,[{"id":"dma_result","key":"cwlLoanMidRepayReqVo"},{"id":"dma_loanMaster","key":"cwlLoanMasterVo"}]' replace="" style="" target="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSU03.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_cancel" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref='data:json,[{"id":"dma_result","key":"cwlLoanMidRepayReqVo"},{"id":"dma_loanMaster","key":"cwlLoanMasterVo"}]' replace="" style="" target="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSM02.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_agree" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref="data:json,dma_result" replace="" style="" target="">
        	</xf:submission>
        	<xf:submission abortTrigger="" action="SvcCCSCWLLMRSM03.pwkjson" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
        		ev:submitdone="" ev:submiterror="" id="sbm_reject" instance="" mediatype="application/json" method="post" mode="asynchronous"
        		processMsg="" ref="data:json,dma_result" replace="" style="" target="">
        	</xf:submission>
        </xf:model>
        <script src="/cm/js/biz/ccs.js" cache="false" />
        <script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 상조회 대출중도상환 신청서
	 * 변경 이력 : 2023-09-14	lsh	최초 작성
	 * serviceId : C274
	 ****************************************************/	
	
	// 전역변수로 사용하기 위해 scwin 객체안에 선언  
	scwin.data = {};
        
	scwin.onpageload = function() {
		// dataMap 초기화
		com.initDataMap(dma_result);
		
		// parameter 설정
		dma_search.setJSON(com.getParameter());
		
		scwin.data.cudType = "C"; 	// 저장구분
		scwin.data.status = "";		// 결재신청상태구분
		scwin.data.isRole = false;	// 권한
		
		// 권한체크 
		com.biz.checkRole({ serviceId : "C274", roleCodes : com.getLoginInfo('roleCode')}, function(e){
			scwin.data.isRole = e.isRoleYn;
			
			// 반려의견 조회
			scwin.searchRejectComment(dma_search.get("req_no"));
			
			if (dma_search.get("req_no")) {
				scwin.search(scwin.data.isRole);
			} else { // 최초작성 일때
				
				// 신청자 정보 셋팅
				scwin.openHumUserPop(com.getLoginInfo("empno"));
				
				// 버튼제어(결재신청, 저장, 삭제) 
				com.biz.disabledButtons();
				
				// 하단 버튼제어(확정, 승인, 반려)
				scwin.btnController();
			}
		});
		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/**
	 * 컴포넌트 disable true 처리
	 */		
	scwin.disable = function() {
		ibx_midwayRepayAmt.setDisabled(true);
		ica_reqMidwayRepayYmd.setDisabled(true);
		ica_reqYmd.setDisabled(true);
		btn_callLoan.setDisabled(true);
		btn_intrstCal.setDisabled(true);
	}

	/**
	 * 담당자입력
	 */		
	scwin.enable = function() {
		ibx_midwayRepayAmt.setDisabled(true);
		ica_reqMidwayRepayYmd.setDisabled(true);
		ica_reqYmd.setDisabled(true);
		btn_callLoan.setDisabled(true);
		btn_intrstCal.setDisabled(true);
	}
	
	scwin.search = function(isRole) {
		
		com.execute(sbm_selectDetail, {
			successCallback : function(e) {
				scwin.data.cudType = "U";
				
				var param4 = com.getParameter("param4");
				var reqNo = dma_result.get("req_no");		
				var aprStateCode = dma_result.get("apr_state");
				var reqSyspayno = dma_result.get("req_syspayno");
				var cofmYmd = dma_result.get("cofm_ymd");		
				var bizProcCd = dma_result.get("biz_proc_cd");		
				var sn = com.getLoginInfo("sn");
				
				if (cofmYmd.trim() == "") {
					tbx_bankAccntNo.setValue("");
					tbx_bankNm.setValue("");
					tbx_depstrNm.setValue("");
				} else {
					tbx_bankAccntNo.setValue("391-001863-04-976");
					tbx_bankNm.setValue("기업은행");
					tbx_depstrNm.setValue("한국생산기술연구원");
				}
				
				if (reqSyspayno == sn && (aprStateCode != "XAD005" && aprStateCode != "XAD013" && aprStateCode != "XAD015")) {
					scwin.disable();
				} else if (reqSyspayno != sn) {
		    		scwin.disable();
				} else if (aprStateCode == "XAD070" || aprStateCode == "XAD100") {
					scwin.disable();
				}
				
				// 담당자 확인중 상태 - 승인, 반려  
				if (aprStateCode == "XAD070" && isRole) {
					scwin.enable();
				}
				
				// 결재완료 상태 - 확정, 반려, 메일
				if (aprStateCode == "XAD100") {
		      		if (isRole) {
		      			btn_print.setDisabled(false); 	// 인쇄버튼
		      			grp_confirm.show("");			// 확정일자 컴포넌트 그룹
		      			
		      			if (bizProcCd.trim() == "Y") {	// 확정일때
		      				btn_cancle.setDisabled(false);
		      				btn_decide.setDisabled(true);
		      				ica_confirmYmd.setDisabled(true);
		      			} else {  //미확정
		      				btn_cancle.setDisabled(true);
		      				btn_decide.setDisabled(false);
		      				ica_confirmYmd.setDisabled(false);
		      			}
		      		}
				}								
				
				// 승인, 반려 버튼 상태 변경
				scwin.btnController(aprStateCode, reqSyspayno, isRole);
				
				// 결재상태에 따른 버튼제어 (결재신청, 삭제, 저장)
				com.biz.disabledButtons(aprStateCode, reqNo);
			}
		});
	};
	
	scwin.save = function() {
		if(scwin.data.status == "apr"){
			// 결재여부셋팅
			dma_result.set("approval", true); 
		}else{
			dma_result.set("approval", false);
		}
		
		dma_result.set("midway_repay_ymd", dma_result.get("req_midway_repay_ymd")); // 중도상환일자 셋팅
		
		if (scwin.data.cudType == "C") { // 신규신청
			
			com.execute(sbm_saveDetail, {
				successCallback : function(e) { // 성공 콜백
					com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
						scwin.search(scwin.data.isRole);
					});	
				}
			});
		} else {
			com.execute(sbm_updateDetail, {
				successCallback : function(e) { // 성공 콜백
					if (scwin.data.status == "agree") { // 승인처리
						scwin.prcessAgree();
					} else if (scwin.data.status == "reject") { // 반려처리
						scwin.prcessReject();
					} else {
						if (dma_result.get("approval")) {
							com.alert("결재신청 되었습니다", function() {
								scwin.moveAprPage("A005");
							});
						} else {
							com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
								scwin.search(scwin.data.isRole);
							});	
						}	
					}
				}
			});
		}
	}
	
	// 양식함 이동	
	scwin.moveAprPage = function(serviceID) {
		com.movePageMenu(serviceID, {});
		
		let dummyModal = document.querySelector('.w2modal_popup');
		if (dummyModal) {
			dummyModal.style.display = 'none';
		}
	}		
	
	/**
	 * 승인처리
	 */		
	scwin.prcessAgree = function() {
		com.execute(sbm_agree, {
			successCallback : function(e) {
				com.alert("승인 처리 되었습니다.", function() {
					scwin.moveAprPage("A004");
				});
			}
		});
	}
	
	/**
	 * 반려처리
	 */		
	scwin.prcessReject = function() {
		com.execute(sbm_reject, {
			successCallback : function(e) {
				com.alert("반려 처리 되었습니다.", function() {
					scwin.moveAprPage("A004");
				});
			}
		});
	}
	
	/**
	 * 반려의견 조회
	 */		
	scwin.searchRejectComment = function(req_no) {
		dma_docComments.set('req_no', req_no);
		
		com.execute(SvcComAprDocM01, {
			successCallback : function(e) {
				var cnt = dlt_docComments.getRowCount();
				
				if (cnt > 0) {
					grd_reject.show("");
				} else {
					grd_reject.hide();
				}				
			}
		});
	}

	//==============================================================================
	// <function name="ramt">
	// <summary >대출이자 계산</summary>
	// <return type= ""></return>
	// </function>
	//==============================================================================
	scwin.ramtCalculate = function()	{
		var loanCd = dma_result.get("loan_cd");				// 대출코드
		var loanSyspayno = dma_result.get("loan_syspayno");	// 대출자시스템번호
		var loanYmd = dma_result.get("loan_ymd");			// 대출일자
		var midwayRepayAmt = dma_result.get("midway_repay_amt"); // 중도상환금액
		
     	//console.log("====<대출이자계산;ramt()>  loanCd:" + loanCd+", loanSyspayno:"+loanSyspayno+", loanYmd:"+loanYmd);
     	if(loanCd.trim() == "" || loanSyspayno.trim() == "" || loanYmd.trim() == "") {
   			com.alert("[알림] 중도상환하기 위한 대출정보를 불러오세요.");
   			return false;
     	}
     	
     	// 필수값 (중도상환금액, 중도상환일자 체크)
    	if(!scwin.validateCheckForCalculation()) return;
     			
   		if(Number(tbx_loanRamt.getValue()) < Number(midwayRepayAmt)) {
   			com.alert("중도상환금액이 대출잔액보다 많습니다.\n확인해주세요!!");
   			return false;
   		}
     		
   		var dDayCount = 0;
   		var sDayCount = 0;
   		var mIntrstFrYmd = "";
   		var stdYmd = "";
   		var tmrAmt = dma_result.get("tot_midway_repay_amt"); // 기중도상환총액 
   		var mwrAmt = midwayRepayAmt; 		 				 // 중도상환금액
   		var sumAmt = Number(tmrAmt) + Number(mwrAmt);	     // 중도상환총금액
   		var repayYmd = ica_reqMidwayRepayYmd.getValue().substring(0,4)+ica_reqMidwayRepayYmd.getValue().substring(4,6);  //상환 년월	   
   		
   		stdYmd = repayYmd+"21"; // 당월표준일 21일		
   		
   		var preStdYmd = com.addMonth(stdYmd, -1);				//전월표준일 22일 월을빼고
   		var nxtStdYmd = com.addMonth(stdYmd, 1); 				//차월표준일 	      		
   		     //nxtStdYmd = nxtStdYmd.substring(0,6)+"21";
   		var midYmd = ica_reqMidwayRepayYmd.getValue();  		//중도상환일
   		var midwayRepayYmd = dma_result.get("pre_midway_repay_ymd").trim();          //이전중도상환일자
		
   		//이자계산위한 기준일 변수
   		var firstYmd = "";
   		var secondYmd = "";
   		var thirdYmd = "";
   		var calLog = "";
   		
   		// 이전 중도상환일자에 의한 시작일 보정
   		//console.log("<상환이자계산 변수>" + repayYmd+":"+stdYmd+":"+preStdYmd+":"+nxtStdYmd+":"+midYmd+":"+midwayRepayYmd );
   		if(Number(midYmd) <= Number(stdYmd)){
   		// 중도상환일이 당월표준일 이전이냐 이후냐	      			
   			if(midwayRepayYmd == "" && loanYmd >= preStdYmd){
   			//이전중도상환이 없고 대출일이 전달표준일 보다 크다면(1: 대출일자, 2: 상환일자, 3: 당월표준일)
   				firstYmd = loanYmd;
     			secondYmd = midYmd;
     			thirdYmd = stdYmd;
     			calLog = "1";
   			}else if(midwayRepayYmd == "" && loanYmd < preStdYmd){
   			//이전중도상환이 없고 대출일이 전달표준일 보다 작다면(시작일: 이전표준일, 종료일: 상환일자, 3: 당월표준일)
   				firstYmd = preStdYmd;
	     		secondYmd = midYmd;
	     		thirdYmd = stdYmd;
	     		calLog = "2";
   			}else if(midwayRepayYmd >= preStdYmd && loanYmd >= preStdYmd && loanYmd < midwayRepayYmd){
   			//전달표준일 이후로 대출시작과 이전중도상환이 있는 경우(시작일: 이전중도상환일자, 종료일: 상환일자, 3: 당월표준일)
   				firstYmd = midwayRepayYmd;
	     		secondYmd = midYmd;
	     		thirdYmd = stdYmd;
	     		calLog = "3";
   			}else if(midwayRepayYmd >= preStdYmd && loanYmd < preStdYmd && loanYmd < midwayRepayYmd){
   			//전달표준일 이후로 이전중도상환이 있는 경우(시작일: 이전중도상환일자, 종료일: 상환일자, 3: 당월표준일)
   				firstYmd = midwayRepayYmd;
	     		secondYmd = midYmd;
	     		thirdYmd = stdYmd;
	     		calLog = "4";
   			}else if(midwayRepayYmd < preStdYmd && loanYmd < preStdYmd){
   			//이전중도상환일과 대출일이 이전표준일자 이전인 경우(시작일: 이전표준일, 종료일: 상환일자, 3: 당월표준일)
   				firstYmd = preStdYmd;
	     		secondYmd = midYmd;
	     		thirdYmd = stdYmd;
	     		calLog = "5";
   			}
   		}else{
   			if(midwayRepayYmd == "" && loanYmd >= stdYmd){
   			//이전중도상환이 없고 대출일이 당월표준일 보다 크다면(1: 대출일자, 2: 상환일자, 3: 차월표준일)
   				firstYmd = loanYmd;
     			secondYmd = midYmd;
     			thirdYmd = nxtStdYmd;
     			calLog = "6";
   			}else if(midwayRepayYmd == "" && loanYmd < stdYmd){
   			//이전중도상환이 없고 대출일이 전달표준일 보다 작다면(시작일: 당월표준일, 종료일: 상환일자, 3: 차월표준일)
   				firstYmd = stdYmd;
     			secondYmd = midYmd;
     			thirdYmd = nxtStdYmd;
     			calLog = "7";
   			}else if(midwayRepayYmd >= stdYmd && loanYmd >= stdYmd && loanYmd < midwayRepayYmd){
   			//전달표준일 이후로 대출시작과 이전중도상환이 있는 경우(시작일: 이전중도상환일자, 종료일: 상환일자, 3: 차월표준일)
   				firstYmd = midwayRepayYmd;
     			secondYmd = midYmd;
     			thirdYmd = nxtStdYmd;
     			calLog = "8";
   			}else if(midwayRepayYmd >= stdYmd && loanYmd < stdYmd && loanYmd < midwayRepayYmd){
   			//전달표준일 이후로 이전중도상환이 있는 경우(시작일: 이전중도상환일자, 종료일: 상환일자, 3: 차월표준일)
   				firstYmd = midwayRepayYmd;
     			secondYmd = midYmd;
     			thirdYmd = nxtStdYmd;
     			calLog = "9";
   			}else if(midwayRepayYmd < stdYmd && loanYmd < stdYmd){
   			//이전중도상환일과 대출일이 이전표준일자 이전인 경우(시작일: 당월표준일, 종료일: 상환일자, 3: 차월표준일)
   				firstYmd = stdYmd;
     			secondYmd = midYmd;
     			thirdYmd = nxtStdYmd;
     			calLog = "10";
   			}
   		}
   		
   		//console.log("<<날자 계산 함수시험>>" + com.diffDate("20150221", "20150303"));
   		
   		//중도금이전의 이자 날짜 계산
		dDayCount = com.diffDate(firstYmd, secondYmd);
		//중도금이 후 의 이자 날짜 계산
		//secondYmd= jsAfterThisDate(midYmd,"0","0","1");
		sDayCount = com.diffDate(secondYmd, thirdYmd);	

   		//console.log("<<날자 계산 결과>>" + dDayCount+":"+sDayCount+":"+firstYmd+":"+secondYmd+":"+thirdYmd+":"+calLog);

		dma_calculateInfo.set("loan_syspayno", loanSyspayno);
		dma_calculateInfo.set("loan_ymd", loanYmd);
		dma_calculateInfo.set("loan_cd", loanCd);
   		//중도금 상환 직후 의 일수(상환일 다음날부터 다음달 21일까지) - 월 공제 이자
		dma_calculateInfo.set("dDay_cnt", dDayCount);
		dma_calculateInfo.set("sDay_cnt", sDayCount);
		dma_calculateInfo.set("midway_repay_amt", midwayRepayAmt);
   		
   		// 이자계산 처리
   		scwin.processInterestCalculation();	 
   	}	
	
	// 필수값체크  
	scwin.validateCheck = function() {
		if (!com.validateData(dma_result, [  
			  { id : "midway_repay_amt", mandatory : true, allowChar : "0-9" }
			 ,{ id : "req_midway_repay_ymd", mandatory : true }
		], false)) return false;

		if (1 > Number(dma_result.get("midway_repay_amt"))) {
			com.alert("[알림] 중도상환금액에 0원 이상 입력하세요.");
			return false;
		}
				
		if (1 > Number(tbx_midwayRepayIntrst.getValue())) {
			com.alert("[알림] 중도상환이자가 생성되지 않았습니다. 이자계산버튼을 클릭하세요.");
			return false;
		}
				
		return true;
	}
	
	// 필수값체크 - 이자계산 
	scwin.validateCheckForCalculation = function() {
		return com.validateData(dma_result, [  
			  { id : "midway_repay_amt", mandatory : true, allowChar : "0-9" }
			 ,{ id : "req_midway_repay_ymd", mandatory : true }
		], false);
	}
	
	/**
	 * 이자계산 처리
	 */	
	scwin.processInterestCalculation = function(){
		com.execute(sbm_calculation, {
			successCallback : function(e) { // 성공 콜백
				var nRepayLoanAmt = dma_calculateInfoResult.get("afRepayLoanAmt"); 	//상환후잔액
				var nRepayIntrst = dma_calculateInfoResult.get("bfRepayIntrst"); 	//중도상환이자
				var nMRepayIntrst = dma_calculateInfoResult.get("afRepayIntrst"); 	//월공제이자
				nRepayIntrst = Math.floor(nRepayIntrst);
				nMRepayIntrst = Math.floor(nMRepayIntrst);	
				
				//상환 후 잔액
				ibx_midwayRepayAftAmt.setValue(nRepayLoanAmt);
				
				//console.log("<이자계산결과>"+nRepayLoanAmt+":"+nRepayIntrst+":"+nMRepayIntrst);
				
				// 제약) 같은 날 중도상환을 한 번 이상 할 수 없다.(만약 해야 한다면 대출금중도상환신청 테이블에 맵핑 필드 추가 필요[순번])
				//중도상환이자 같은날 2번이상의 중도상환일 경우 이자금액 0원
				if(dma_result.get("pre_midway_repay_ymd") == ica_reqMidwayRepayYmd.getValue()){
					tbx_midwayRepayIntrst.setValue(0);
				}else{
					tbx_midwayRepayIntrst.setValue(nRepayIntrst);
				}
			}
		});
	}
	
	/**
	 * 승인, 반려 버튼 상태변경
	 *  
	 * @param aprState 전자결재 상태코드
	 * @param reqSyspayno 등록자 시스템개인번호
	 * @param roleChk 담당자 확인 [true:false]
	 */
	scwin.btnController = function(aprState, reqSyspayno, roleChk) {
		// 반려, 승인 버튼 숨김처리
		btn_reject.hide();
		btn_confirm.hide();
		
		if(!aprState) return; 
		
		// 승인, 반려
		if (aprState == "XAD060" && roleChk) { // *수신(접수) - 학자금보조신청 담당자단계 일때만 사용
			btn_confirm.show("");
			btn_reject.show("");
		}else if (aprState == "XAD070" && roleChk) { // *담당자확인 - 반려, 처리(승인)
			btn_confirm.show("");
			btn_reject.show("");
		}else if (aprState == "XAD100" && roleChk) { // *결재완료 - 목록
			btn_reject.show("");
		}
	}
	
	/**
	 * 저장 버튼 클릭 이벤트
	 */
	scwin.btn_save_onclick = function(e) {
		if(!scwin.validateCheck()) return;
		
		scwin.data.status = "save";
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret) {
			if (ret) {
				scwin.save();
			}
		});
	};
	
	/**
	 * 목록 버튼 클릭시 이벤트
	 */
	scwin.btn_pre_onclick = function(e) {
		var menuId = com.getParameter("menuID") || "C275";
		com.moveList(menuId);
	};
	
	/**
	 * 삭제 버튼 클릭시 이벤트
	 */
	scwin.btn_del_onclick = function(e) {
		com.confirm("message.xom.wq.022"/*삭제 하시겠습니까?*/, function( ret) {
			if (ret) {
				com.execute(sbm_deleteDetail, {
					successCallback : function(e) { // 성공 콜백
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
							com.moveList(com.getParameter("menuID"), {mod :"delete"});
						});
					}
				});
			}
		});
	};
	
	/**
	 * 인쇄 버튼 클릭시 이벤트
	 */
	scwin.btn_print_onclick = function(e) {
		var reqNo = tbx_reqNo.getValue();
		var reqSyspayno = dma_result.get("req_syspayno");
		if(reqNo.trim() != ""){
			let node = "req_no=" + reqNo + "&syspayno=" + reqSyspayno;
			com.oz.openPopup({
			    ozrCode : "C043",      
			    param: node
			});
		}else{
			com.alert("인쇄할 내용이 없습니다.");
		}
	};
	
	/**
	 * 결재신청 버튼 클릭시 이벤트
	 */
	scwin.btn_apr_onclick = function(e) {
		if(!scwin.validateCheck()) return;
		
		com.confirm("[확인] 결재신청 하시겠습니까?", function(ret) {
			if (ret) {
				scwin.data.status = "apr";
				
				scwin.save();
			}
		});
	};
	
	/**
	 * 사용자검색 팝업 실행 - 신규 작성시 신청자 정보 셋팅용
	 */
	scwin.openHumUserPop = function(empno){
		var vEmpno = empno.trim(); 
		var data = { empno : vEmpno, work_clsf : "HAG010" };
		
		com.pop.open(com.pop.TYPE.HUM, data, function(ret){
			dma_result.set("centr_nm", ret.region_nm);	  			// 센터명

			dma_result.set("req_dept_cd", ret.dept_cd);		  		// 부서코드
			dma_result.set("req_dept_nm", ret.dept_nm);		  		// 부서명
			dma_result.set("req_dept_new_ymd", ret.dept_new_ymd); 	// 신청자 부서 신설일

			dma_result.set("req_syspayno", ret.syspayno); 			// 신청자 개인번호
			dma_result.set("req_nm", ret.nm);			  			// 신청자명
			dma_result.set("mobile", ret.mobile);		  			// 전화번호
			dma_result.set("email", ret.email);			  			// 이메일주소
			dma_result.set("req_empno", ret.empno);		  			// 신청자 사원번호

			dma_result.set("req_ymd", com.getServerDateTime());	  	// 신청일자
			dma_result.set("dedct_clsf", "1");	  					// 공제구분
		});
	}

	/**
	 * 중도상환일자 체크
	 */	
	scwin.checkRepayReqYmd = function(){
		var curdate = com.getServerDateTime();
	   	var curYearMonth = curdate.substring(0,6);    //현재년월
		var curStdYmd = curYearMonth+"21";                              //현재기준일
		var preStdYmd = com.addMonth(curStdYmd, -1);
		var nxtStdYmd = com.addMonth(curStdYmd, 1);                     //차월기준일
		     //nxtStdYmd = nxtStdYmd.substring(0,6)+"21";
		var midwayRepayYmd = ica_reqMidwayRepayYmd.getValue();
		var preMidwayRepayYmd = ica_preMidwayRepayYmd.getValue();
		
		//console.log("<상환일자 검증> " + curdate+":"+preStdYmd+":"+curStdYmd+":"+nxtStdYmd+":"+midwayRepayYmd);
		
		if (midwayRepayYmd.trim() != "") {
			if (preMidwayRepayYmd.trim() != "" && preMidwayRepayYmd >= midwayRepayYmd) { //최근중도상환일자 이전으로는 중도상환일자 선택불가
				com.alert("[알림] 중도상환일자는 최근상환일자 이후여야 합니다. \n 중도상환일자를 다시 선택하시기 바랍니다.");
				ica_reqMidwayRepayYmd.setValue("");
				return false;
			} else if (curdate <= curStdYmd) { // 중도상환일이 현재월 21일 이전 선택된 경우
				if (preStdYmd < midwayRepayYmd && midwayRepayYmd <= curStdYmd) {
					
				} else {
					com.alert("[알림] 중도상환일자를 전월 22일부터 현재월 21일까지 내에서 선택하세요.");
					ica_reqMidwayRepayYmd.setValue("");
					return false;
				}	
			} else if (curdate > curStdYmd){ // 중도상환일이 현재월 21일 이후 선택된 경우
				if (curStdYmd < midwayRepayYmd && midwayRepayYmd <= nxtStdYmd) {
					
				} else {
					com.alert("[알림] 중도상환일자를 현재월 22일부터 차월 21일까지 내에서 선택하세요.");
					ica_reqMidwayRepayYmd.setValue("");
					return false;
				}
			}
		}
		return true;
	}	
	
	/**
	 * 반려 버튼 클릭시 이벤트 
	 */		
	scwin.btn_reject_onclick = function(e) {
		if (dma_result.get("biz_proc_cd") == "Y") {
			com.alert("[알림] 확정 취소를 후 반려바랍니다.");
		} else {
			scwin.data.status = "reject";
			com.pop.open(com.pop.TYPE.RETRN_OPN,{ref_yn : "Y"}, function(ret){
				if (ret.comments) {
					dma_result.set("comments", ret.comments);
					scwin.save();	
				}
			});
		}
	};
	
	/**
	 * 승인 버튼 클릭시 이벤트 
	 */		
	scwin.btn_confirm_onclick = function(e) {
		if(!scwin.validateCheck()) return;
		scwin.data.status = "agree";
		
		scwin.save();
	};
	
	/**
	 * 대출건 불러오기 버튼 클릭시 이벤트 
	 */			
	scwin.btn_callLoan_onclick = function(e) {
		var data = { syspayno : dma_result.get("req_syspayno")};
		biz.ccs.pop.open(biz.ccs.pop.TYPE.LOAN_INFO, data, function(ret) {
			dma_result.set("sum_repay_amt", ret.sum_repay_amt);	  				// 대출상환총액
			dma_result.set("loan_ramt", ret.loan_ramt);	  						// 대출잔액
			dma_result.set("loan_tot_amt", ret.loan_tot_liq);	  				// 대출금액
			
			dma_result.set("loan_ymd", ret.loan_ymd);	  						// 대출일자
			dma_result.set("loan_syspayno", ret.syspayno);	  					// 대출자시스템개인번호
			dma_result.set("loan_cd", ret.loan_cd);	  							// 대출코드
			dma_result.set("tot_repay_amt", ret.tot_repay_amt);	  				// 총상환금액
			dma_result.set("tot_repay_intrst", ret.tot_repay_intrst);	  		// 총상환이자금액
			dma_result.set("tot_midway_repay_amt", ret.tot_midway_repay_amt);	// 총중도상환금액
			dma_result.set("loan_rts", ret.loan_rts);	  						// 대출잔액
			dma_result.set("pre_midway_repay_ymd", ret.pre_midway_repay_ymd);	// 중도상환일자
			dma_result.set("midway_repay_times", ret.midway_repay_times);	  	// 중도상환회수
		});	
	};

	/**
	 * 이자계산 버튼 클릭시 이벤트 
	 */		
	scwin.btn_intrstCal_onclick = function(e) {
		if (!scwin.checkRepayReqYmd()) {
			return false;
		} else {
			scwin.ramtCalculate();
		}		
	};

	/**
	 * 확정 버튼 클릭시 이벤트 
	 */			
	scwin.btn_decide_onclick = function(e) {
		// 확정일자의 유효성 체크로직 필요
		if (ica_confirmYmd.getValue().trim() == "") {
			com.alert("[알림] 확정일자를 입력하세요.", function(){
				return false;
			});
		} else {
			com.confirm("[물음] 확정 하시겠습니까?", function(ret) {
				if (ret) {
					// 대출중도상환신청서 확정(수정), 이력등록용 파라미터
					dma_result.set("biz_proc_cd", "Y");
					dma_result.set("cofm_ymd", ica_confirmYmd.getValue());
					dma_result.set("cofm_syspayno", com.getLoginInfo("sn"));
					//dma_loanMaster.set("repay_psn_dept_cd", dma_result.get("repay_psn_dept_cd"));
					//dma_loanMaster.set("repay_psn_dept_new_ymd", dma_result.get("repay_psn_dept_new_ymd"));
					dma_result.set("midway_repay_ymd", ica_reqMidwayRepayYmd.getValue());
					dma_result.set("midway_repay_amt", dma_result.get("midway_repay_amt"));
					dma_result.set("midway_repay_intrst", dma_result.get("midway_repay_intrst"));
					dma_result.set("rmk", "");
					dma_result.set("dedct_clsf", "1");	//급여공제
					dma_result.set("loan_rts", dma_result.get("loan_rts"));
					dma_result.set("loan_ramt", dma_result.get("midway_repay_aft_amt"));
					
					// 중도상환내역 및 대출기본정보 수정용 파라미터
					// ** 참고
					//   -. 중도상환내역 테이블의 loan_ramt는 중도상환 후 잔액
					dma_loanMaster.set("syspayno", dma_result.get("loan_syspayno"));
					dma_loanMaster.set("loan_cd", dma_result.get("loan_cd"));
					dma_loanMaster.set("loan_ymd", dma_result.get("loan_ymd"));
					dma_loanMaster.set("loan_ramt", dma_result.get("midway_repay_aft_amt"));
					dma_loanMaster.set("midway_repay_ymd", ica_reqMidwayRepayYmd.getValue());
					dma_loanMaster.set("tot_midway_repay_amt", Number(dma_result.get("tot_midway_repay_amt")) + Number(dma_result.get("midway_repay_amt")));
					dma_loanMaster.set("tot_midway_repay_intrst", Number(dma_result.get("tot_midway_repay_intrst")) + Number(dma_result.get("midway_repay_intrst")));
					dma_loanMaster.set("midway_repay_times", Number(dma_result.get("midway_repay_times")) + 1);
					dma_loanMaster.set("thmon_midway_repay_intrst_amt", dma_result.get("midway_repay_intrst"));
					
					if (ibx_midwayRepayAftAmt.getValue() == 0) { //상환 후 잔액이 남지 않은경우 
						dma_loanMaster.set("dedct_progrss_state", "2"); // 상환구분(만기상환)
					}else{ // 상환 후 잔액이 남은경우
						dma_loanMaster.set("dedct_progrss_state", "1"); // 상환구분(진행)
					}		
					
					com.execute(sbm_confirm, {
						successCallback : function(e) { // 성공 콜백
							if (scwin.data.isRole) {
								btn_print.setDisabled(false);
								grp_confirm.show("");
								
								btn_cancle.setDisabled(false);
								btn_decide.setDisabled(true);
								ica_confirmYmd.setDisabled(true);
							}
						}
					});
				}
			});
		} // else end
		
	};
	
	/**
	 * 취소 버튼 클릭시 이벤트 - 확정 취소
	 */		
	scwin.btn_cancle_onclick = function(e) {
		var repayYmd = ica_reqMidwayRepayYmd.getValue().trim();  	 //상환일자
		var repayYearMonth = repayYmd.substring(0,6);
		var repayStdYmd = repayYearMonth+"21";  			 //상환월 기준일자
		var repayNextStdYmd = com.addMonth(repayStdYmd, 1);  //상환차월 기준일자
		var curdate = com.getServerDateTime();
		
		if (repayYmd <= repayStdYmd && curdate > repayStdYmd) {
			//상환일자가 상환월기준일 이전이면서 현재일이 상환월기준일 이후인 경우
			com.alert("[알림] 확정취소 불가합니다.", function() {
				return false;
			});
			
		} else if (repayYmd > repayStdYmd && curdate > repayNextStdYmd) {
			//상환일자가 상환월기준일 이후이면서 현재일이 상환차월기준일 이후인 경우
			com.alert("[알림] 확정취소 불가합니다.", function() {
				return false;
			});
		} else {
			com.confirm("[물음] 확정을 취소하시겠습니까?", function(ret) {
				if (ret) {
					var loanSyspayno = dma_result.get("loan_syspayno");
					var loanCd = dma_result.get("loan_cd");
					var loanYmd = dma_result.get("loan_ymd");
					
					if(loanSyspayno.trim() == "" || loanCd.trim() == "" || loanYmd.trim() == ""){
						com.alert("[알림] 확정 취소를 위한 필수값에 이상이 있습니다. 관리자에게 연락바랍니다.");
						return;
					}
					
					// 대출중도상환신청서 취소용 파라미터
					dma_result.set("biz_proc_cd", "N");
					dma_result.set("cofm_ymd", "");
					dma_result.set("cofm_syspayno", com.getLoginInfo("sn"));
					dma_result.set("midway_repay_ymd", ica_reqMidwayRepayYmd.getValue());
					dma_result.set("odr", 1);						// 상환순번
					
					// 중도상환내역 및 대출기본정보 수정용 파라미터
					dma_loanMaster.set("syspayno", loanSyspayno);		// 대출자
					dma_loanMaster.set("loan_cd", loanCd);				// 대출코드
					dma_loanMaster.set("loan_ymd", loanYmd);			// 대출일자
					dma_loanMaster.set("midway_repay_ymd", repayYmd);	// 중도상환일자
					dma_loanMaster.set("odr", 1);						// 상환순번
									
					com.execute(sbm_cancel, {
						successCallback : function(e) { // 성공 콜백
							if (scwin.data.isRole) {
								btn_print.setDisabled(false);
								grp_confirm.show("");
								
								btn_cancle.setDisabled(true);
								btn_decide.setDisabled(false);
								ica_confirmYmd.setDisabled(false);
							}
						}
					});	
				}
			});
		}		
	};

	/**
	 * 중도상환금액 값 변경시 이벤트
	 */			
	scwin.ibx_midwayRepayAmt_onviewchange = function(info) {
		var loanRamt = tbx_loanRamt.getValue(); // 기대출잔액

		if(Number(dma_result.get("midway_repay_amt")) > Number(loanRamt)){
			com.alert("[알림] 중도상환금액이 기대출잔액을 초과하였습니다. \n 중도상환금액을 다시 입력하세요.");
			dma_result.set("midway_repay_amt", 0);
		}
	};
	
	/**
	 * 중도상환일자 값 변경시 이벤트
	 */			
	scwin.ica_reqMidwayRepayYmd_onviewchange = function(info) {
		scwin.checkRepayReqYmd();
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group class="pageWrap" id="" style="">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="">
    				<xf:trigger class="btn " id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox" id="">
    				<xf:trigger class="btn icon print" id="btn_print" style="" type="button" disabled="true" ev:onclick="scwin.btn_print_onclick">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_docComments" defaultCellHeight="28"
    			evenRowBackgroundColor="#f7faff" id="grd_reject" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    			rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="50"
    			rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
    			selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" visibleRowNum="10" sortable="true">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column displayMode="label" id="column1" inputType="text" style="height:28px" value="반려자" width="100"></w2:column>
    					<w2:column displayMode="label" id="column2" inputType="text" style="height:28px;" value="반려의견" width="800"></w2:column>
    					<w2:column displayMode="label" id="column5" inputType="text" style="height:28px" value="반려일시" width="150"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column displayMode="label" id="empno" inputType="text" style="height:28px" value="" width="100" readOnly="true"></w2:column>
    					<w2:column displayMode="label" id="contents" inputType="text" readOnly="true" style="height:28px;" width="800"></w2:column>
    					<w2:column displayMode="label" id="created_date" inputType="text" style="height:28px" value="" width="150" displayFormat="yyyy-MM-dd HH:mm:SS" readOnly="true" dataType="date"></w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:200px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_reqNo" label="000" style="" tagname="span" ref="data:dma_result.req_no"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="본부/센터" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_centrNm" label="000" style="" tagname="span" ref="data:dma_result.centr_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="부서" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_oeptNm" label="000" style="" tagname="span" ref="data:dma_result.req_dept_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="성명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_reqPsn" label="000" style="" tagname="span" ref="data:dma_result.req_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="급여번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_reqEmpNo" label="000" style="" tagname="span" ref="data:dma_result.req_empno"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="전화번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_mobile" label="000" style="" tagname="span" ref="data:dma_result.mobile"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<xf:group class="flex" id="" style="">
    						<w2:textbox id="" label="대출건 불러오기" style="" tagname="span"></w2:textbox>
    						<xf:trigger class="btn glass mla" id="btn_callLoan" style="" type="button" ev:onclick="scwin.btn_callLoan_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox class="txt" id="tbx_loanNm" label="000" style="" tagname="span" ref="data:dma_result.loan_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기대출금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" disabled="true" id="tbx_loanAmt" style="max-width: 150px;" dataType="number" ref="data:dma_result.loan_tot_amt" displayFormat="#,###"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기대출일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" disabled="false" focusOnDateSelect="false"
    						footerDiv="false" id="ica_loanYmd" renderDiv="true" rightAlign="false" style="max-width: 150px;" ref="data:dma_result.loan_ymd" readOnly="true">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기상환액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" disabled="true" id="tbx_totRepayAmt" style="max-width: 150px;" dataType="number" displayFormat="#,###" ref="data:dma_result.sum_repay_amt"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기대출잔액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" disabled="true" id="tbx_loanRamt" style="max-width: 150px;" dataType="number" displayFormat="#,###" ref="data:dma_result.loan_ramt"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="최근중도상환일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false"
    						footerDiv="false" id="ica_preMidwayRepayYmd" renderDiv="true" rightAlign="false" style="max-width: 150px;" ref="data:dma_result.pre_midway_repay_ymd" readOnly="true">
    					</w2:inputCalendar>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="중도상환금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" disabled="false" id="ibx_midwayRepayAmt" style="max-width: 150px;" dataType="number" ref="data:dma_result.midway_repay_amt" allowChar="0-9" ev:onviewchange="scwin.ibx_midwayRepayAmt_onviewchange" maskFormat="reverse" maskFormatModelExcludeChar="," displayFormat="#,###,###,###,###,###,###"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox class="blue" id="" label="중도상환일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" disabled="false" focusOnDateSelect="false"
    						footerDiv="false" id="ica_reqMidwayRepayYmd" renderDiv="true" rightAlign="false" style="max-width: 150px;" ref="data:dma_result.req_midway_repay_ymd" ev:onviewchange="scwin.ica_reqMidwayRepayYmd_onviewchange">
    					</w2:inputCalendar>
    					<xf:trigger class="btn" id="btn_intrstCal" style="" type="button" ev:onclick="scwin.btn_intrstCal_onclick">
    						<xf:label><![CDATA[이자계산]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="중도상환이자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" disabled="true" id="tbx_midwayRepayIntrst" style="max-width: 150px;" dataType="number" displayFormat="####,###,###,###" ref="data:dma_result.midway_repay_intrst"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="상환 후 잔액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full ri" disabled="true" id="ibx_midwayRepayAftAmt" style="max-width: 150px;" dataType="number" ref="data:dma_result.midway_repay_aft_amt" displayFormat="#,###"></xf:input>
    					<w2:textbox class="txt" id="" label="원정(\)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<xf:group class="flex" id="">
    						<w2:textbox id="" label="입금계좌" style="" tagname="span"></w2:textbox>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_bankAccntNo" label="" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="은행명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_bankNm" label="" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="예금주명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="tbx_depstrNm" label="" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="입금방법설명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:span class="helptxt blue" id="" label="* 담당자 승인메일 수신 후 중도상환금액 및 중도상환이자를 각각 구분하여 중도상환일자에 입금계좌로 입금" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" id="grp_confirm" style=";visibility:;display:none;">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="확정일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal full" disabled="false" focusOnDateSelect="false"
    						footerDiv="false" id="ica_confirmYmd" renderDiv="true" rightAlign="false" style="max-width: 150px;" ref="data:dma_result.cofm_ymd">
    					</w2:inputCalendar>
    					<xf:trigger class="btn" id="btn_decide" style="" type="button" ev:onclick="scwin.btn_decide_onclick">
    						<xf:label><![CDATA[확정]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class="btn" id="btn_cancle" style="" type="button" ev:onclick="scwin.btn_cancle_onclick">
    						<xf:label><![CDATA[취소]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="flex_lybox mt10" id="">
    			<xf:group class="mla" id="" style="">
    				<w2:textbox class="" id="" label="상기와 같이 이면대출규약에 의거 대출을 신청합니다." style=""></w2:textbox>
    				<xf:group class="mt10" id="">
    					<w2:textbox class="singleLine" id="" label="신 청 일 :" style="width: 60px;" tagname="span"></w2:textbox>
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false" id="ica_reqYmd"
    						renderDiv="true" rightAlign="false" style="width: 100px;" ref="data:dma_result.req_ymd">
    					</w2:inputCalendar>
    				</xf:group>
    				<xf:group class="mt10" id="">
    					<w2:textbox class="singleLine" id="" label="신 청 인 :" style="width: 60px;" tagname="span"></w2:textbox>
    					<w2:textbox class="singleLine" id="tbx_reqPsn2" label="" style="width: 100px;" tagname="span" ref="data:dma_result.req_nm"></w2:textbox>
    					<w2:textbox class="" id="" label="(인)" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:textbox class="fs22 fwb ce mt20" id="" label="한국생산기술연구원 상조회장 귀하" style=""></w2:textbox>
    		<xf:group class="btnGroup" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn pro" id="" style=";display:none;" type="button">
    					<xf:label><![CDATA[메일]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="ri" id=""><xf:trigger class="btn pro" ev:onclick="scwin.btn_reject_onclick" id="btn_reject" style="" type="button">
    					<xf:label><![CDATA[반려]]></xf:label>
    				</xf:trigger><xf:trigger class="btn pro" ev:onclick="scwin.btn_confirm_onclick" id="btn_confirm" style="" type="button">
    					<xf:label><![CDATA[승인]]></xf:label>
    				</xf:trigger><xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    					<xf:label><![CDATA[저장]]></xf:label>
    				</xf:trigger>
    				
    				
    				
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
