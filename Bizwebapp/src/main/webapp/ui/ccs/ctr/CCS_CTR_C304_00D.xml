<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="근거리출장서" meta_vertical_guides="" meta_horizontal_guides="">
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
        	<xf:instance>
        		<data xmlns="" />
        	</xf:instance>
        	<w2:dataCollection baseNode="map">
        		<w2:dataMap baseNode="map" id="dma_trip">
        			<w2:keyInfo>
        				<w2:key id="req_psn_syspayno" name="신청자시스템번호" dataType="text"></w2:key>
        				<w2:key id="req_psn_nm" name="신청자명" dataType="text"></w2:key>
        				<w2:key id="req_dept" name="신청자부서코드" dataType="text"></w2:key>
        				<w2:key id="req_psn_dept_nm" name="신청자부서명" dataType="text"></w2:key>
        				<w2:key id="req_ymd" name="신청일자" dataType="text"></w2:key>
        				<w2:key id="req_psn_posi" name="신청자포지션번호" dataType="text"></w2:key>
        				<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_syspayno" name="출장자시스템번호" dataType="text"></w2:key>
        				<w2:key id="agent_psn_syspayno" name="대행자시스템번호" dataType="text"></w2:key>
        				<w2:key id="emgnc_contac_no" name="비상연락처" dataType="text"></w2:key>
        				<w2:key id="biztrip_ymd" name="출장일자" dataType="text"></w2:key>
        				<w2:key id="start_time" name="출발시간" dataType="number"></w2:key>
        				<w2:key id="arriv_time" name="도착시간" dataType="number"></w2:key>
        				<w2:key id="car_use_yn" name="차량사용여부" dataType="text"></w2:key>
        				<w2:key id="start_region" name="출발지" dataType="text"></w2:key>
        				<w2:key id="arriv_region" name="도착지" dataType="text"></w2:key>
        				<w2:key id="biztrip_land" name="출장장소" dataType="text"></w2:key>
        				<w2:key id="major_intrv_psn" name="면담자" dataType="text"></w2:key>
        				<w2:key id="major_intrv_tel" name="면담자연락처" dataType="text"></w2:key>
        				<w2:key id="biztrip_goal_clsf" name="출장목적" dataType="text"></w2:key>
        				<w2:key id="biztrip_goal" name="출장목적비고" dataType="text"></w2:key>
        				<w2:key id="is_internal_region" name="원내출장여부" dataType="text"></w2:key>
        				<w2:key id="rmk_1" name="방문처" dataType="text"></w2:key>
        				<w2:key id="trafc_fee" name="교통비" dataType="number"></w2:key>
        				<w2:key id="trafc_fee_rmk" name="교통비비고" dataType="text"></w2:key>
        				<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
        				<w2:key id="accnt_no_nm" name="계정번호명" dataType="text"></w2:key>
        				<w2:key id="accnt_respn_psn_syspayno" name="계정책임자시스템번호" dataType="text"></w2:key>
        				<w2:key id="accnt_respn_psn_empno" name="계정책임자사원번호" dataType="text"></w2:key>
        				<w2:key id="accnt_respn_psn_nm" name="계정책임자명" dataType="text"></w2:key>
        				<w2:key id="start_ymd" name="계정시작일자" dataType="text"></w2:key>
        				<w2:key id="cls_ymd" name="계정종료일자" dataType="text"></w2:key>
        				<w2:key id="accnt_state" name="계정상태" dataType="text"></w2:key>
        				<w2:key id="prj_no" name="과제번호" dataType="text"></w2:key>
        				<w2:key id="bugt_ctrl_no" name="통제번호" dataType="text"></w2:key>
        				<w2:key id="attach_file_no" name="첨부파일번호" dataType="text"></w2:key>
        				<w2:key id="accnt_cd" name="회계코드" dataType="text"></w2:key>
        				<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
        				<w2:key id="card_use_ex" name="이지바로계정" dataType="text"></w2:key>
        				<w2:key id="approval" name="전자결재신청여부" dataType="text"></w2:key>
        				<w2:key id="req_dept_new_ymd" name="신청자부서신설일자" dataType="text"></w2:key>
        				<w2:key id="tot_expns" name="출장비총액" dataType="text"></w2:key>
        				<w2:key id="apr_state" name="결재상태" dataType="text"></w2:key>
        				<w2:key id="pool_conf_nm" name="학술대회명" dataType="text"></w2:key>
        				<w2:key id="cud_type" name="cud타입" dataType="text"></w2:key>
        				<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_compn" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="chk" name="check" dataType="text" ignoreStatus="true"></w2:column>
        				<w2:column id="biztrip_psn_syspayno" name="출장자시스템번호" dataType="text"></w2:column>
        				<w2:column id="biztrip_psn_empno" name="출장자사원번호" dataType="text"></w2:column>
        				<w2:column id="biztrip_psn_nm" name="출장자명" dataType="text"></w2:column>
        				<w2:column id="biztrip_psn_dept_cd" name="출장자부서코드" dataType="text"></w2:column>
        				<w2:column id="biztrip_psn_dept_nm" name="출장자부서명" dataType="text"></w2:column>
        				<w2:column id="biztrip_psn_dept_new_ymd" name="출장자부서신설일자" dataType="text"></w2:column>
        				<w2:column id="agent_psn_syspayno" name="대행자시스템번호" dataType="text"></w2:column>
        				<w2:column id="agent_psn_empno" name="대행자사원번호" dataType="text"></w2:column>
        				<w2:column id="agent_psn_nm" name="대행자명" dataType="text"></w2:column>
        				<w2:column id="emgnc_contac_no" name="비상연락처" dataType="text"></w2:column>
        				<w2:column id="commute_cd" name="조합원코드" dataType="text"></w2:column>
        				<w2:column id="pay_amt" name="지급금액" dataType="text"></w2:column>
        				<w2:column id="rmk" name="비고" dataType="text"></w2:column>

        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_localPay" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="biztrip_psn_empno" name="사원번호" dataType="text"></w2:column>
        				<w2:column id="biztrip_psn_nm" name="이름" dataType="text"></w2:column>
        				<w2:column id="pay_amt" name="금액" dataType="text"></w2:column>
        				<w2:column id="rmk" name="비고" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_aprReject" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="empname" name="반려자명" dataType="text"></w2:column>
        				<w2:column id="contents" name="반려비고" dataType="text"></w2:column>
        				<w2:column id="created_date" name="반려일자" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataMap baseNode="map" id="dma_search">
        			<w2:keyInfo>
        				<w2:key id="req_no" name="신청번호" dataType="text"></w2:key>
        				<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
        				<w2:key id="expns_cd" name="비용코드" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_syspayno" name="출장자" dataType="text"></w2:key>
        				<w2:key id="curr_yy" name="당해년도" dataType="text"></w2:key>
        				<w2:key id="curr_ymd" name="오늘날짜" dataType="text"></w2:key>
        				<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_compn">
        			<w2:keyInfo>
        				<w2:key id="biztrip_psn_syspayno" name="출장자시스템번호" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_empno" name="출장자사원번호" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_nm" name="출장자명" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_dept_cd" name="출장자부서코드" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_dept_nm" name="출장자부서명" dataType="text"></w2:key>
        				<w2:key id="biztrip_psn_dept_new_ymd" name="출장자부서신설일자" dataType="text"></w2:key>
        				<w2:key id="agent_psn_syspayno" name="대행자시스템번호" dataType="text"></w2:key>
        				<w2:key id="agent_psn_empno" name="대행자사원번호" dataType="text"></w2:key>
        				<w2:key id="agent_psn_nm" name="대행자명" dataType="text"></w2:key>
        				<w2:key id="emgnc_contac_no" name="비상연락처" dataType="text"></w2:key>
        				<w2:key id="pay_amt" name="지급금액" dataType="text"></w2:key>
        				<w2:key id="commute_cd" name="조합원코드" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataMap baseNode="map" id="dma_aprCheck" style="">
        			<w2:keyInfo>
        				<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
        				<w2:key dataType="text" id="biztrip_start_ymd" name="시작일자"></w2:key>
        				<w2:key dataType="text" id="biztrip_cls_ymd" name="종료일자"></w2:key>
        				<w2:key dataType="text" id="biztrip_psn_syspayno" name="출장자"></w2:key>
        				<w2:key dataType="text" id="goal_clsf" name="출장목적구분"></w2:key>
        				<w2:key dataType="text" id="accnt_no" name="계정번호"></w2:key>
        				<w2:key dataType="text" id="command" name="근무시간 체크"></w2:key>
        				<w2:key id="start_time" name="시작시간" dataType="text"></w2:key>
        				<w2:key id="arriv_time" name="도착시간" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" id="dlt_tripCnt" repeatNode="map" saveRemovedData="true" style="">
        			<w2:columnInfo>
        				<w2:column dataType="text" id="ctr_gbn" name="구분"></w2:column>
        				<w2:column dataType="text" id="ctr_count" name="출장일수"></w2:column>
        				<w2:column dataType="text" id="ctr_rate" name="출장비율"></w2:column>
        				<w2:column dataType="text" id="ctr_in_region" name="원내출장일수"></w2:column>
        				<w2:column dataType="text" id="ctr_out_region" name="원외출장일수"></w2:column>
        				<w2:column dataType="text" id="work_days" name="당해근무일수"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        		<w2:dataMap baseNode="map" id="dma_postApr">
        			<w2:keyInfo>
        				<w2:key id="reason" name="사후결재사유" dataType="text"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        		<w2:dataList baseNode="list" repeatNode="map" id="dlt_fare" saveRemovedData="true">
        			<w2:columnInfo>
        				<w2:column id="arriv_region" name="도착지역" dataType="text"></w2:column>
        				<w2:column id="biztrip_fee" name="운임" dataType="text"></w2:column>
        			</w2:columnInfo>
        		</w2:dataList>
        	</w2:dataCollection>
        	<w2:workflowCollection></w2:workflowCollection>
        	<!-- 근거리 출장비 조회 -->
        	<xf:submission id="sbm_selectTrafcFee"
        		ref='data:json,dma_search'
        		target='' action="SvcCCSCTRLTFR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 근거리 출장 저장 -->
        	<xf:submission id="sbm_saveLocalTrip"
        		ref='data:json,[{"id":"dma_trip","key":"tripVo"},{"id":"dlt_compn","key":"compnList"},{"id":"dma_compn","key":"biztripPsnVo"}]'
        		target='data:json,dma_search' action="SvcCCSCTRLTBC01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	<!-- 근거리 출장 삭제 -->
        	<xf:submission id="sbm_deleteLocalTrip" ref="data:json,dma_search" target="" action="SvcCCSCTRLTBD01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
        		instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone=""
        		ev:submiterror="" abortTrigger="">
        	</xf:submission>
        	<!-- 근거리 출장 조회 -->
        	<xf:submission id="sbm_searchLocalTrip" ref="data:json,dma_search" target='data:json,[{"id":"dma_trip","key":"tripVo"},{"id":"dlt_compn","key":"compnList"},{"id":"dlt_aprReject","key":"docList"},{"id":"dma_postApr","key":"postAprVo"}]'
        		action="SvcCCSCTRLTBR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
        		errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
        		abortTrigger="">
        	</xf:submission>
        	
        	<!-- 회계코드 검색 -->
    		<xf:submission id="sbm_selectAccntCd" ref='data:json,dma_search'
    			target='' action="SvcCCSCTRLCTR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
    			instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone=""
    			ev:submiterror="" abortTrigger="">
    		</xf:submission> 
        	
        	<!-- 결재전 검증 -->
    		<xf:submission id="sbm_checkApr" ref='data:json,dma_aprCheck'
    			target='' action="SvcCCSCTRDOMR05.pwkjson" method="post" mediatype="application/json" encoding="UTF-8"
    			instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone=""
    			ev:submiterror="" abortTrigger="">
    		</xf:submission>  
    		<!-- 출장일수 조회 -->
    		<xf:submission id="sbm_searchTripPsnCount" ref="data:json,dma_search" target='' action="SvcCCSCTRLPTR01.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
        </xf:model>
        <script src="/cm/js/biz/ccs.js" cache="false" />
        <script type="text/javascript" lazy="false"><![CDATA[
    /*************************************************************************************************************
     *
     *	전역변수
     *
     *************************************************************************************************************/
    scwin.currentDateTime = com.getServerDateTime("yyyyMMddHHmmss");
    scwin.currentDate = scwin.currentDateTime.substring(0,8);
    scwin.attachFileNo = "C304";
    scwin.isApproval = false;
    
    /*************************************************************************************************************
     *
     *	페이지 이벤트 함수
     *
     *************************************************************************************************************/
    /*
     * 페이지 열기
     */
	scwin.onpageload = function() {
		//첨부파일 초기화
		com.file.init();
		
		// 최초 폼 셋팅
		grp_reject.hide(); // 반려사유		
		grp_reason.hide(); //사후결제사유
		grp_confPool.hide(); // 학술대회
		grp_cust.hide(); // 업체(기술지도일 경우보임- 사용안함(2022.08.31.)
		
		//공통코드 셋팅
		var codeOption = [
			{ code : "FDO", compID : "sbx_carUse" } //차량사용
		,   { code : "FBV", compID : "sbx_biztripGoal" } //출장목적
        ,   { code : "FAT", compID : "sbx_startRegion", filter : "mngmtItem1 == 'Y'"} //출발지
        ,	{ code : "CTC" }
		];
		
		var arrivCode = { code : "CTB", compID : "sbx_arrivRegion" }; //도착지
		if(scwin.currentDate.substring(0,4) >= "2014"){
			arrivCode.filter = "mngmtItem1 == 'Y'";
		}
		codeOption.push(arrivCode);
		com.setCmnCd(codeOption, function() {	
		});
		
		// enter key event
		com.setEnterKeyEvent(grp_biztrip_psn, scwin.btn_searchBiztrip_onclick);
		com.setEnterKeyEvent(grp_agent, scwin.btn_searchAgent_onclick);	
		
		//작성번호 셋팅
		var param = com.getParameter();
		if(!com.isEmpty(param.openerTabId)){
			scwin.openerTabId = param.openerTabId;
		}
		dma_search.set("req_no", param.req_no);
		dma_search.set("expns_cd", "273");
		
		// 운임조회
		com.execute(sbm_selectTrafcFee, {
			successCallback : function(e){
				dlt_fare.setJSON(e.responseJSON.bizTripFareVoList);
				
				//수정
				if(dma_search.get("req_no") != "") {
					//근거리출장정보 셋팅
					scwin.search();
				}
				//생성
				else {
					scwin.init();
				}
			}
		});		
	};
	
	/*
     * 페이지 닫기
     */
	scwin.onpageunload = function() {
		com.file.destroy();
	};
	
	
	/*************************************************************************************************************
     *
     *	사용자 정의 함수
     *
     *************************************************************************************************************/
     /*
     * 초기화
     */
	scwin.init = function() {
		//파일 셋팅
		com.file.create(upload_A.getID(), { fileKey : scwin.attachFileNo, mode : 'edit' });
		
		//초기화
		dma_trip.setEmptyValue();
		
		dma_trip.set("cud_type", "C");
		
		//출장자 셋팅
		com.pop.open(com.pop.TYPE.HUM, {empno : com.getLoginInfo("empno")}, function(ret) {
			// 작성자
			dma_trip.set("req_psn_syspayno", ret.syspayno);
			dma_trip.set("req_psn_nm", ret.nm);
			dma_trip.set("req_psn_dept_nm", ret.dept_nm);
			dma_trip.set("req_psn_posi", ret.posi_cd);	
			dma_trip.set("req_ymd", scwin.currentDate);
			
			// 출장자 셋팅
			scwin.setBizTripPsn("Biz", ret);
		});	
		
		// 출장일자 셋팅
		// 원래 신규신청인 경우 Default로 오늘 날짜를 자동설정했으나, 실수유발의 위험이 있어서 일부러 배제함
		//ica_biztripDate.setValue(scwin.currentDate);
		
		var sHour = com.parseInt(scwin.currentDateTime.substring(8,10));
		if (sHour < 8) sHour = 8;
		if (sHour > 21) sHour = 21;
		var eHour = sHour + 4;
		if (eHour > 21) eHour = 21;
		sHour = (sHour < 10 ? "0" : "") + sHour + ":00";
		eHour = eHour + ":00";
		
		sbx_start_time.setValue(sHour);
		sbx_arriv_time.setValue(eHour);		
		
		//원내출장여부 셋팅
		dma_trip.set("is_internal_region", "t"); 		
		// 차량사용여부
		dma_trip.set("car_use_yn", "FDO001"); 
		//출장목적 셋팅
		dma_trip.set("biztrip_goal_clsf", "FBV040");		
		//신규입력시 계정없음에 Check
		chk_accntNoUse.setValue("Y");		
		
		//그 외 AS-IS에서 필요한 부분
		dma_trip.set("expns_cd", "273");
		
		// 여비비고 셋팅
		scwin.feeInfo("2");		
	};
	
     /*
     * 조회
     */
     scwin.search = function(){
	 	com.execute(sbm_searchLocalTrip, {
			successCallback : function(e) {
				//계정번호 셋팅
				if(dma_trip.get("accnt_no") === ""){
					chk_accntNoUse.setValue("Y");
					ibx_accnt_no.setValue("계정없음");
				}else{
					scwin.start_ymd = dma_trip.get("start_ymd");
					scwin.cls_ymd = dma_trip.get("cls_ymd");	
					scwin.accnt_state = dma_trip.get("accnt_state");	
					ibx_accnt_no.setValue(dma_trip.get("accnt_no"));
				}
				
				// 지급내역 셋팅
				dlt_localPay.setJSON(dlt_compn.getAllJSON());
				
				// 출장자 셋팅
				dma_compn.setJSON(dlt_compn.getRowJSON(0));
				dlt_compn.removeRow(0);
				dlt_compn.reform();
				
				// 반려자
				if(dlt_aprReject.getRowCount() > 0){
					grp_reject.show("");
				}
				
				//사후결재사유
				if(dma_postApr.get("reason") != ""){
					grp_reason.show("");
				}
				
				// 버튼 제어
				com.biz.disabledButtons(dma_trip.get("apr_state"), dma_search.get("req_no"));
				
				if(dma_trip.get("apr_state") == "XAD100"){
					grp_page.setDisabled(true);	
					if (com.getLoginInfo('roleCode').indexOf('1006206') >= 0 || 
						(com.getLoginInfo('roleCode').indexOf('1006205') >= 0 && com.getLoginInfo('roleCode').indexOf('1006273') >= 0)) { // 외부강의 담당자 조건 추가
						grp_bizTripGoal.setDisabled(false);
						sbx_start_time.setDisabled(false);
						sbx_arriv_time.setDisabled(false);
						btn_save.setDisabled(false);	
					}
				}else if(dma_trip.get("apr_state") < "XAD020"){ // 저장시 마다 금액이 차감되어서 다시 최초 금액으로 초기화
					if(chk_accntNoUse.getValue() != "Y"){
						scwin.setTripExpns();
					}
				}				
				
				//파일 셋팅
				com.file.create(upload_A.getID(), { fileKey : dma_trip.get("attach_file_no") == "" ? scwin.attachFileNo : dma_trip.get("attach_file_no"), mode : 'edit' });
				btn_oz.setDisabled(false);
			}
		});    
	 };
	
	// 운임비고 셋팅
	scwin.feeInfo = function(type){
		if (type == "1") {
			dma_trip.set("trafc_fee_rmk", "원차량사용");
		} else if (type == "3") {
			dma_trip.set("trafc_fee_rmk", "연료비지급");
		} else if (type == "2") {
			dma_trip.set("trafc_fee_rmk", "대중교통");			
		} else if (type == "4") {
			dma_trip.set("trafc_fee_rmk", "실비정산");
		}
	};
	
	/**
	 * 출장자 정보 셋팅
	 * type : Biz-출장자, Compn - 동반자
	 */
	scwin.setBizTripPsn = function(type, data){
		if(type == "Biz"){ // 출장자
			var arr = dlt_compn.getMatchedIndex("biztrip_psn_syspayno", data.syspayno, true);
			if(arr.length > 0){
				com.alert(com.getMsg("message.xom.ui.ccs.007", data.nm));
				arr.reverse().forEach( function(index){
					dlt_compn.removeRow( index);					
				});
				return;
			}
			
			// 출장자	
			dma_compn.set("biztrip_psn_syspayno", data.syspayno);
			dma_compn.set("biztrip_psn_empno", data.empno);
			dma_compn.set("biztrip_psn_nm", data.nm);
			dma_compn.set("biztrip_psn_dept_cd", data.dept_cd);
			dma_compn.set("biztrip_psn_dept_nm", data.dept_nm);
			dma_compn.set("biztrip_psn_dept_new_ymd", data.dept_new_ymd);	
			dma_compn.set("emgnc_contac_no", data.mobile);
			
			scwin.work_land = data.work_land;					
			
			// 출장 경로 초기화
			scwin.gridPathInit();
			
		}else if(type == "BizAgent"){ // 출장자 직무대행자
			dma_compn.set("agent_psn_syspayno", data.syspayno);
			dma_compn.set("agent_psn_empno", data.empno);
			dma_compn.set("agent_psn_nm", data.nm);
			
		}else if(type == "Compn"){ // 동반자
			var row = grd_compn.getFocusedRowIndex();
			
			if(data.syspayno == dma_compn.get("biztrip_psn_syspayno")){
				com.alert("message.xom.ui.ccs.005");
				return;
			}
			
			var arr = dlt_compn.getMatchedIndex("biztrip_psn_syspayno", data.syspayno);
			if(arr.length > 0){				
				com.alert(com.getMsg("message.xom.ui.ccs.006", data.nm));
				return;
			}
			dlt_compn.setCellData(row, "biztrip_psn_syspayno", data.syspayno);
			dlt_compn.setCellData(row, "biztrip_psn_empno", data.empno);
			dlt_compn.setCellData(row, "biztrip_psn_nm", data.nm);
			dlt_compn.setCellData(row, "biztrip_psn_dept_cd", data.dept_cd);
			dlt_compn.setCellData(row, "biztrip_psn_dept_nm", data.dept_nm);
			dlt_compn.setCellData(row, "biztrip_psn_dept_new_ymd", data.dept_new_ymd);
			dlt_compn.setCellData(row, "emgnc_contac_no", data.mobile);		
			
			// 금액 재계산
			scwin.setTripExpns();
						
		}else if(type == "Agent"){ // 동반자 그리드 직무대행자
			var row = grd_compn.getFocusedRowIndex();
			dlt_compn.setCellData(row, "agent_psn_syspayno", data.syspayno);
			dlt_compn.setCellData(row, "agent_psn_empno", data.empno);
			dlt_compn.setCellData(row, "agent_psn_nm", data.nm);
		}
	};
	
	/**
	 * 출발지 셋팅
	 */
	scwin.gridPathInit = function(){
		var cmnList = gcm.cmnCdCache['dlt_cmnCd_CTC'].filter(function(elt, i) {
			return elt.mngmtItem1 == scwin.work_land;
		});	
		
		var cmnCdJson = dlt_cmnCd_FAT.getMatchedJSON("mngmtItem2", cmnList[0].mngmtItem3);
		sbx_startRegion.setValue(cmnCdJson[0].comCd);
	};
	
	/*
     * 시간 체크
     */
	scwin.timeCheck = function(type) {
		if(sbx_start_time.getValue() >= sbx_arriv_time.getValue()) {
			// alert(com.getMsg("message.xom.ui.fin.010", "시작시간", "종료시간"));
			alert("종료시간은 시작시간 이후여야 합니다.");
			
			return false;
		}	
		
		var startTime = Number(sbx_start_time.getValue().substring(0, 2));
		var arrivTime = Number(sbx_arriv_time.getValue().substring(0, 2));
		var tmp3 = 0;
		
		if (Number(startTime) <= 12 && Number(arrivTime) >= 13) {
			tmp3 = arrivTime - startTime -1;
		}else{
			tmp3 = arrivTime - startTime;
		}	
		
		if(dma_trip.get("arriv_region") == "CTB051"){ // CTB051	근무지 내 지역 4시간 미만
			if(tmp3 >= 4){
				var sbxStartTimeSelectedIndex = sbx_start_time.getSelectedIndex();
//				sbx_arriv_time.setSelectedIndex(sbxStartTimeSelectedIndex + 1);
				
				alert("출장시간(4시간 미만) 범위를 초과했습니다.");
				return false;
			}
		}else if(dma_trip.get("arriv_region") == "CTB052"){ // CTB052 근무지 내 지역 4시간 이상
			if(tmp3 > 8){
				com.alert("message.alert.ccs.ctr.0008");
				return false;
			}
			
			if(tmp3 <= 3){
				com.alert("message.alert.ccs.ctr.0009");
				return false;
			}
		}		
		return true;
	};		

	/*
     * 필수항목 체크
     */
	scwin.saveCheck = function() {
		var validData = [
			{dataObj : dma_trip
			   , valInfoArr :[
				    { id : "biztrip_psn_syspayno", mandatory : true}
				   ,{ id : "agent_psn_syspayno", mandatory : true } 
				   ,{ id : "biztrip_ymd", mandatory : true } 
				   ,{ id : "start_region", mandatory : true } 
				   ,{ id : "arriv_region", mandatory : true } 
				   ,{ id : "biztrip_land", mandatory : true }
				   ,{ id : "trafc_fee", mandatory : true }
				   ,{ id : "major_intrv_psn", mandatory : true } //면담자
				   ,{ id : "major_intrv_tel", mandatory : true } //면담자연락처
				   ,{ id : "biztrip_goal_clsf", mandatory : true } //출장목적
				   ,{ id : "biztrip_goal", mandatory : true } //출장목적비고
				   ,{ id : "is_internal_region", mandatory : true } // 원내출장여부
				]
			  , isCheckModified : false
			},
			{dataObj : dma_compn
			  , valInfoArr :[
				    { id : "biztrip_psn_syspayno", mandatory : true}
				   ,{ id : "agent_psn_syspayno", mandatory : true } 
			    ]
			   , isCheckModified : false
			}
		];
		
		if(dlt_compn.getRowCount() > 0){
			validData.push({dataObj : dlt_compn, valInfoArr :[
					    { id : "biztrip_psn_syspayno", mandatory : true}
					   ,{ id : "agent_psn_syspayno", mandatory : true } 
				    ] , isCheckModified : false
				});
		}
		
		if (!com.validateData(validData)) return false;
		
		// 출장비가 있는 경우 또는 원차량 사용의 경우에만 검증
		if(chk_accntNoUse.getValue() != "Y"){
			// 계정번호 체크
			if(!scwin.checkLocalTrip("accnt_no")) return false;
			
			// 계정책임자 체크
			if(!scwin.checkLocalTrip("accnt_respn_psn_syspayno")) return false;
		}else{
			// 원차량 출장비 체크(FBV150 외부강의등)
			if(dma_trip.get("car_use_yn") != "FDO001" && dma_trip.get("trafc_fee") > '0'){
				com.alert("message.xom.ui.ccs.016"); //원 차량 이용시 출장비는 차량관리비 계정(BG)에 흡수되므로, 출장비를 반드시 입력하시기 바랍니다.
				return false;
			}	
		}
		
		if(dma_trip.get("accnt_no").trim() != "" && dma_trip.get("accnt_cd").trim() == ""){
			com.alert("message.alert.ccs.ctr.0004");
			return false;
		}
		
		if(!scwin.timeCheck()) return false;		
		
		return true;
	};
	
	/*
     * 저장
     */
	scwin.save = function() {
		var rowCnt = dlt_compn.getRowCount();
		var payAmt = com.parseInt(dma_trip.get("tot_expns")) / (rowCnt+1);
		
		// 출장자 지급금액
		dma_compn.set("pay_amt", payAmt);
		// 동반자 지급금액
		for(var i=0; i<dlt_compn.getRowCount(); i++){
			dlt_compn.setCellData(i, "pay_amt", payAmt);
		}
		
		com.file.transport(function(attachObj) {
			dma_trip.set("attach_file_no", attachObj.upload_A);					
			
			com.execute(sbm_saveLocalTrip, {
				successCallback : function(e) {
					if(scwin.isApproval){
						// 결재화면 이동
						com.movePageMenu("A001", { "reqNo" :  dma_trip.get("req_no")});
					}else{
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
							scwin.search();
						});
					}
				}
			});
		});
	}
	
	/*
     * 출장일자, 계정번호 체크
     */
	scwin.checkLocalTrip = function(knd){
		if(knd == "biztrip_ymd"){
			if(dma_trip.get(knd).trim() == ""){
				com.alert(com.getMsg("message.xom.co.com.0009", "출장일자"));
				return false;
			}
		}else if(knd == "accnt_no"){
			if(dma_trip.get(knd) == ""){
				com.alert(com.getMsg("message.xom.co.com.0009", "계정번호"));	
				return false;
			}
		}else if(knd == "accnt_respn_psn_syspayno"){
			if(dma_trip.get(knd) == ""){
				com.alert(com.getMsg("message.xom.co.com.0007", "계정책임자"));	
				return false;
			}
		}		
		return true;
	}
	
	/*
     * 계정번호 포맷
     */
	scwin.accntNoFormat = function(val) { 
		if(val === ""){
			return "계정없음";
		}else
			return val;
	};
	
	/*
     * 팝업 데이터 초기화
     */
	scwin.clearData = function(type, value) {
		//출장자
		if(type === "BIZTRIP_PSN" && value === "") {
			dma_trip.set("biztrip_psn_syspayno", value);
			dma_trip.set("biztrip_psn_empno", value);
			dma_trip.set("biztrip_psn_nm", value);
			dma_trip.set("biztrip_psn_dept_cd", value);
			dma_trip.set("biztrip_psn_dept_nm", value);
			dma_trip.set("biztrip_psn_dept_new_ymd", value);
			dma_trip.set("emgnc_contac_no", value);
		}
		//대행자
		else if(type === "AGENT_PSN" && value === ""){
			dma_trip.set("agent_psn_syspayno", value);
			dma_trip.set("agent_psn_empno", value);
			dma_trip.set("agent_psn_nm", value);
		}
		//계정 책임자
		else if(type === "ACCNT_RESPN" && value === ""){
			dma_trip.set("accnt_respn_psn_syspayno", value);
			dma_trip.set("accnt_respn_psn_empno", value);
			dma_trip.set("accnt_respn_psn_nm", value);			
		}
	};	
	
	/*************************************************************************************************************
     *
     *	컴포넌트 이벤트 함수
     *
     *************************************************************************************************************/
	/*
     * 출장현황 팝업
     */
	scwin.btn_tripList_onclick = function(e) {
		if(dma_compn.get("biztrip_psn_syspayno") != "") {
			var data ={
				biztrip_psn_syspayno : dma_compn.get("biztrip_psn_syspayno"),
				biztrip_psn_nm : dma_trip.get("biztrip_psn_nm"),
				isApproval : scwin.isApproval,
				paramData : dlt_tripCnt.getAllJSON()
			};
			
			biz.ccs.pop.open(biz.ccs.pop.TYPE.TRIP_INFO, data, function(ret) {
				if(ret){				
					scwin.confirmPostApr();
				}
			});
		}		
	};
	
	/*
     * 출장자 변경
     */
	scwin.btn_searchBiztrip_onclick = function(e) {
		scwin.getEmpInfo("Biz", ibx_biztripPsnEmpno.getValue());
	};
	
	/*
     * 대행자 변경
     */
	scwin.btn_searchAgent_onclick = function(e) {
		scwin.getEmpInfo("BizAgent", ibx_agentPsnEmpno.getValue());
	};
	
	/*
     * 동반자 추가
     */
	scwin.btn_biztripPlus_onclick = function(e) {
		com.addRow(grd_compn);
	};
	
	/*
     * 동반자 제거
     */
	scwin.btn_biztripMin_onclick = function(e) {
		var rows = grd_compn.getCheckedIndex("chk");
		rows.reverse().forEach(function(rowIndex){
			dlt_compn.removeRow(rowIndex);
		});
		dlt_compn.reform();
		
		// 금액 재계산
		scwin.setTripExpns();
	};
	
	/*
     * 동반자 그리드 클릭 이벤트
     */
	scwin.grd_compn_oncellclick = function(row, col, colId) {
		//동반자
		if(colId === "grd_searchBiztrip") {
			scwin.getEmpInfo("Compn", dlt_compn.getCellData(row, "biztrip_psn_empno"));
		}
		//직무대행
		else if(colId === "grd_searchAgent") {
			scwin.getEmpInfo("Agent", dlt_compn.getCellData(row, "agent_psn_empno"));
		}
	};
	
	/*
     * 시작시간 변경
     */
    scwin.sbx_start_time_onviewchange = function(info) {
    	var oldSelectedIndex = info.oldSelectedIndex;
    	var newSelectedIndex = info.newSelectedIndex;
    	var sbx_start_len = sbx_start_time.itemArr.length;
    	
    	if(newSelectedIndex < 12) sbx_arriv_time.setSelectedIndex(newSelectedIndex + 3);
    	if(newSelectedIndex >= 12) sbx_arriv_time.setSelectedIndex(newSelectedIndex + 2);
		
		/*if(!scwin.timeCheck()) {
			sbx_start_time.setValue(info.oldValue);
			return;			
		}*/
		
		//인근지역일경우 시간에 따른 금액지급 함수
		scwin.setSurrndTripExpns();
	}
	
	/*
     * 도착시간 변경
     */
	scwin.sbx_arriv_time_onviewchange = function(info) {
		
		if(!scwin.timeCheck()) {
			sbx_arriv_time.setValue(info.oldValue);
			return;
		}
		
		//인근지역일경우 시간에 따른 금액지급 함수
		scwin.setSurrndTripExpns();
	};
	
	/*
     * 차랑사용 변경
     */
	scwin.sbx_carUse_onviewchange = function(info) {
		if(dma_trip.get("car_use_yn") == "FDO001"){ // 원차량 사용안함
			scwin.feeInfo("2"); // 운임비고 셋팅
		}else{
			scwin.feeInfo("1");
		}
	};	
	
	/*
     * 출장지 변경
     */
	scwin.sbx_arrivRegion_onviewchange = function(info) {
		if(dma_compn.get("biztrip_psn_syspayno").trim() == ""){
			com.alert(com.getMsg("message.xom.co.com.0001", "출장자"));
			this.setValue("");
			return;
		}
		
		if(dma_trip.get("biztrip_ymd").trim() == ""){
			com.alert(com.getMsg("message.xom.co.com.0001", "출장일자"));
			this.setValue("");
			return;
		}
		
		if(!scwin.timeCheck()){
			this.setValue("");
			return;
		}
		
		if(chk_accntNoUse.getValue() != "Y"){
			scwin.setTripExpns();
		}else{
			dma_trip.set("trafc_fee", 0);
		}
	};	

	
	/*
     * 출장비 계산
     */
	scwin.setTripExpns = function(){
		var cnt = dlt_compn.getRowCount();
		
		var data = dlt_fare.getMatchedJSON("arriv_region", dma_trip.get("arriv_region"), true)[0]; 
		var trafcFee = Number(data.biztrip_fee);
		
		if(trafcFee == 0){
			scwin.feeInfo('4'); // 운임비고 셋팅
			dma_trip.set("trafc_fee", 0);
			dma_trip.set("tot_expns", 0);
		}else{
			if(dma_trip.get("arriv_region") == "CTB053"){
				scwin.setSurrndTripExpns(); //인근지역일경우 시간에 따른 금액지급 함수
			}else{
				scwin.setSurrndTripExpns();
//				dma_trip.set("trafc_fee", trafcFee * (cnt+1));
//				dma_trip.set("tot_expns", trafcFee * (cnt+1));
			}
		}		
	}
	
	
	/*
     * 인근지역일경우 시간에 따른 금액지급 함수
     * 인근지역으로 선택하였지만 시간 설정을 4시간 미만으로 선택한 경우 1만원으로 자동 세팅
     * 2022-07-11  안화용
     */
	scwin.setSurrndTripExpns = function(){
//		if(dma_trip.get("arriv_region") != "CTB053") return;
		if(dma_trip.get("start_time") == "" || dma_trip.get("arriv_time") == "") return;

		var tmp1 = com.parseInt(dma_trip.get("start_time").substring(0,2));
		var tmp2 = com.parseInt(dma_trip.get("arriv_time").substring(0,2));
		var tmp3 = 0;
		var expns = 0;
		var cnt = dlt_compn.getRowCount() +1;
		
		if (Number(tmp1) <= 12 && Number(tmp2) >= 13) {// 점심휴게시간 포함된 구간
			tmp3 = Number(tmp2) - Number(tmp1) - 1;
		} else { // 점심휴게시간 포함되지 않은 구간
			tmp3 = Number(tmp2) - Number(tmp1);
		}
		
		if (tmp3 < 4){ // 4시간 미만
			expns = 10000;
		} else if (tmp3 >= 4){ // 4시간 이상
			expns = 20000;
		}
		
		dma_trip.set("trafc_fee", expns * cnt);
		dma_trip.set("tot_expns", expns * cnt);		
	};
	
	/*
     * 출장목적 변경
     */
	scwin.sbx_biztripGoal_onviewchange = function(info) {
		if(info.newValue == "FBV050"){
			grp_cust.show("");
		}else{
			grp_cust.hide();
		}
		if(dma_trip.get("req_no") != "" && info.newValue === "FBV110"){
			grp_confPool.show("");
		}else{
			grp_confPool.hide();
		}
	};
	
	/*
     * 학술대회정보 팝업
     */
	scwin.btn_poolConf_onclick = function(e) {
		if(dma_trip.get("req_no") == "") return;
		
		// 학술대회이력
		var data = {
			req_no : dma_trip.get("req_no"),
			ezbr_yn : (dma_trip.get("card_use_ex") == "FAJ007")?"Y":"N",
			ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.CONFPOOL, data, function(ret) {		
			dma_trip.set("pool_conf_nm", ret);	
		});
	};
	
	/*
     * 근거리여비 팝업
     */
	scwin.btn_popTrafcFee_onclick = function(e) {
		biz.ccs.pop.open(biz.ccs.pop.TYPE.PAY_INFO);
	};
	
	/*
     * 계정사용여부 변경
     */
	scwin.chk_accntNoUse_onviewchange = function(info) {
		if(info.checked) {
			dma_trip.set("accnt_no", "");
			ibx_accnt_no.setValue("");
			dma_trip.set("accnt_no_nm", "");
			dma_trip.set("accntcd", "");
			dma_trip.set("trafc_fee", 0);
			dma_trip.set("tot_expns", 0);
			// 계정책임자정보 초기화
			scwin.clearData("ACCNT_RESPN", "");
		}else{
			ibx_accnt_no.setValue(" ");
			if(dma_trip.get("arriv_region") == "") return;
			
			scwin.setTripExpns();
		}
	};
	
	/*
     * 계정번호 검색
     */
	scwin.btn_searchAccntNo_onclick = function(e) {
		if(chk_accntNoUse.getValue() == "Y") {
			com.alert("message.alert.ccs.ctr.0010");
			return;
		}
		// 출장일자 체크
		if(!scwin.checkLocalTrip("biztrip_ymd")) return;
		
		com.pop.open(com.pop.TYPE.ACNNO, { ref_yn : "Y", cls_ymd : dma_trip.get("biztrip_ymd") }, function(ret) {			
			scwin.start_ymd = ret.start_ymd;
			scwin.cls_ymd = ret.cls_ymd;
			scwin.accnt_state = ret.accnt_state;
			
			if(scwin.checkAccntNo(ret.accnt_no)){
				dma_trip.set("accnt_no", ret.accnt_no);
				ibx_accnt_no.setValue(ret.accnt_no);
				dma_trip.set("accnt_no_nm", ret.accnt_no_nm);				
				dma_trip.set("accnt_respn_psn_syspayno", ret.accnt_rspns);
				dma_trip.set("accnt_respn_psn_empno", ret.accnt_rspns_empno);
				dma_trip.set("accnt_respn_psn_nm", ret.accnt_rspns_nm);
				dma_trip.set("prj_no", ret.prj_no);
				
				// 회계코드 조회
				scwin.getAccntCd();
			}			
		});
	};
	
	/*
     * 계정번호 체크
     */
	scwin.checkAccntNo = function(accntNo){
		if(!/RAK041|RAK061/.test(scwin.accnt_state)){
			com.alert(com.getMsg("message.xom.ui.ccs.025", accntNo));
			return false;
		}
		var biztripYmd = dma_trip.get("biztrip_ymd");
		if(biztripYmd < scwin.start_ymd || biztripYmd > scwin.cls_ymd){
			com.alert(com.getMsg("message.xom.ui.ccs.026", accntNo, scwin.start_ymd, scwin.cls_ymd));
			return false
		}
		return true;
	};
	
	/*
     * 계정책임자 변경
     */
	scwin.btn_searchAccntRes_onclick = function(e) {
		if(chk_accntNoUse.getValue() != "Y") {
			com.pop.open(com.pop.TYPE.HUM, { "empno" : ibx_accntRespnPsnEmpno.getValue() }, function(ret) {
				if(ret.syspayno != "") {
					dma_trip.set("accnt_respn_psn_syspayno", ret.syspayno);
					dma_trip.set("accnt_respn_psn_empno", ret.empno);
					dma_trip.set("accnt_respn_psn_nm", ret.nm);					
				}
			});
		}
		else {
			alert("계정/출장비 없음입니다");	
		}
	};
	
	/*
     * 최근사용 계정번호 팝업
     */
	scwin.btn_searchRecntAccnt_onclick = function(e) {
		if(chk_accntNoUse.getValue() == "Y") {
			com.alert("message.alert.ccs.ctr.0010");
			return;
		}
		// 출장일자 체크
		if(!scwin.checkLocalTrip("biztrip_ymd")) return;		
		
		let data = {
			"biztrip_psn_syspayno" : dma_compn.get("biztrip_psn_syspayno")
		,	"biztrip_ymd" : dma_trip.get("biztrip_ymd")
		}
		
		biz.ccs.pop.open(biz.ccs.pop.TYPE.RCT_ACCNT, data, function(ret) {
			if(ret.accnt_no != "") {
				scwin.start_ymd = ret.start_ymd;
				scwin.cls_ymd = ret.cls_ymd;
				scwin.accnt_state = ret.accnt_state;
				
				if(scwin.checkAccntNo(ret.accnt_no)){
					dma_trip.set("accnt_no", ret.accnt_no);
					ibx_accnt_no.setValue(ret.accnt_no);
					dma_trip.set("accnt_no_nm", ret.accnt_no_nm);				
					dma_trip.set("accnt_respn_psn_syspayno", ret.accnt_respn_psn_syspayno);
					dma_trip.set("accnt_respn_psn_empno", ret.accnt_respn_psn_empno);
					dma_trip.set("accnt_respn_psn_nm", ret.accnt_respn_psn_nm);
					dma_trip.set("prj_no", ret.prj_no);
					
					// 회계코드 조회
					scwin.getAccntCd();
				}	
			}
		});
	};
	
	/*
     * 회계코드 검색
     */
	scwin.getAccntCd = function(){
		if(dma_trip.get("accnt_no") == "") return;
		
		dma_search.set("accnt_no", dma_trip.get("accnt_no"));
		
		com.execute(sbm_selectAccntCd, {
			successCallback : function(e){
				dma_trip.set("accnt_cd", e.responseJSON.elData.accnt_cd);
			}
		});
	};
	
	/*
     * 저장
     */
	scwin.btn_save_onclick = function(e) {
		scwin.isApproval = false;
		dma_trip.set("approval", "false");
			
		dma_trip.set("biztrip_psn_syspayno", dma_compn.get("biztrip_psn_syspayno"));
		dma_trip.set("agent_psn_syspayno", dma_compn.get("agent_psn_syspayno"));
		dma_trip.set("emgnc_contac_no", dma_compn.get("emgnc_contac_no"));
		
		//필수값, 계정번호
		if(!scwin.saveCheck()) return;		

		if(chk_accntNoUse.getValue() == "Y"){
			com.confirm("message.xom.ui.ccs.022", function(ret){
				if(ret){
					dma_trip.set("trafc_fee", "0");
					dma_trip.set("tot_expns", "0");
					
					com.confirm("message.xom.wq.017", function(ret) {
						if(ret){
							scwin.save();
						}
					});
				}
			});	
		}else{
			com.confirm("message.xom.wq.017", function(ret) {
				if(ret){
					scwin.save();
				}
			});
		}
	};
	
	/*
     * 삭제
     */
	scwin.btn_del_onclick = function(e) {
		if(dma_trip.get("req_no") != "") {
			dma_search.set("unslip_no", dma_trip.get("unslip_no"));
			com.confirm("message.xom.wq.022", function(ret) {
				if(ret) {
					com.file.deleteAll(function(){
						com.execute(sbm_deleteLocalTrip, {
							successCallback : function(e) {
								com.moveList("C306", {});
							}
						});
					});
				}
			});
		}
	};
	
	/*
     * 목록
     */
	scwin.btn_list_onclick = function(e) {
		com.moveList("C306");
	};
	
	/*
     * 인쇄
     */
	scwin.btn_oz_onclick = function(e) {
		if(dma_trip.get("req_no") == ""){
			com.alert(com.getMsg("message.xom.co.com.0007", "신청번호"));
			return
		}
		var node = "req_no="+ dma_trip.get("req_no");
		com.oz.openPopup({
			ozrCode : "F035",      
			param: node
        });
	};
	
	/*
     * 결재 버튼 클릭
     */
	scwin.btn_apr_onclick = function(e) {
		//필수값, 계정번호
		if(!scwin.saveCheck()) return;
		
		if(dma_trip.get("trafc_fee") > '0' && chk_accntNoUse.getValue() == "Y"){
			com.alert("message.xom.ui.ccs.023"); // [알림] 계정정보가 입력되지 않았습니다. 확인 후 계정정보를 입력해 주시기 바랍니다.
			return;
		}
		
		if(dma_trip.get("trafc_fee") == '0' && chk_accntNoUse.getValue() != "Y"){ 
			com.alert("message.xom.ui.ccs.024"); //[알림] 출장금액은 0원인데 계정정보가 입력되어 있습니다. 확인 후 계정정보를 제거해주시기 바랍니다.
			return;
		}
		
		if(dma_trip.get("trafc_fee") > '0'){
			// 계정번호 유효성 체크
			if(!scwin.checkAccntNo(dma_trip.get("accnt_no"))) return;
		}		
		
		// 01. 예실 체크
		if(dma_trip.get("accnt_no") != ""){
			var data = {
				bugt_yr : dma_trip.get("biztrip_ymd").substring(0, 4),
				accnt_no : dma_trip.get("accnt_no"),
				accnt_cd : dma_trip.get("accnt_cd"),
				relat_no : dma_trip.get("accnt_respn_psn_syspayno").substring(2,8)
			}
		
			com.biz.gfnBugtEtcChk(data, function(retObj){
				if(retObj.bugt_amt < 0){
					com.alert("message.xom.ui.fin.022");
				}else if(retObj.bugt_amt >= 0){
					// 02. 결재신청전 체크
					scwin.preAprCheck();
				}			
			});
		}else{
			scwin.preAprCheck();
		}	
	};
	
	/**
	 * 결재신청 전 체크
	 */
	scwin.preAprCheck = function(){
		// 서버사이드 업무로직 유효성 검증 시작	
		var psnArray = dlt_compn.getColData("biztrip_psn_syspayno");
		psnArray.push(dma_compn.get("biztrip_psn_syspayno"));
		
		dma_aprCheck.set("req_no", dma_trip.get("req_no"));
		dma_aprCheck.set("biztrip_start_ymd", ica_biztripDate.getValue());
		dma_aprCheck.set("biztrip_cls_ymd", ica_biztripDate.getValue());
		dma_aprCheck.set("start_time", sbx_start_time.getValue());
		dma_aprCheck.set("arriv_time", sbx_arriv_time.getValue());
		dma_aprCheck.set("biztrip_psn_syspayno", psnArray.join(","));				
		dma_aprCheck.set("goal_clsf", dma_trip.get("biztrip_goal_clsf"));
		// 정부수탁과제일 경우에만 참여연구원 검증
		if(dma_trip.get("prj_no").trim() != ""){
			dma_aprCheck.set("accnt_no", dma_trip.get("accnt_no"));
		}
		
		// 02. 결재전 체크사항
		com.execute(sbm_checkApr, {
			successCallback : function(e){
				var data ={};
				if(e.responseJSON.elData.rst_val == "prd_dup"){ // 출장기간 중복여부
					data.type = "PRD_DUP";
					data.rstData = e.responseJSON.elData.prdDupList;
				}else if(e.responseJSON.elData.rst_val == "othr_wrk"){ // 타업종사여부 확인
					data.type = "OTHR_WRK";
					data.rstData = e.responseJSON.elData.prdDupList;
				}else if(e.responseJSON.elData.rst_val == "no_join"){ // 참여연구원 확인
					data.type = "NO_JOIN";
					data.rstData = e.responseJSON.elData.noJoinList;
				}
				
				// 검증팝업 호출
				if(e.responseJSON.elData.rst_val != "success"){
					biz.ccs.pop.open(biz.ccs.pop.TYPE.APR_CHK, data, function(ret) {
					});
				}else{		
					scwin.isApproval = true;		
					
					// 출장통계조회
					scwin.getTripCnt();	
				}
			}
		});		
	};
	
	/**
	 * 출장통계조회
	 */
	scwin.getTripCnt = function(){
		dma_search.set("biztrip_psn_syspayno", dma_compn.get("biztrip_psn_syspayno"));
		dma_search.set("curr_yy",  scwin.currentDate.substring(0,4));
		dma_search.set("curr_ymd",  scwin.currentDate);	
		com.execute(sbm_searchTripPsnCount, {
			successCallback : function(e){
				dlt_tripCnt.setJSON(e.responseJSON.ctrTripCurStnVoList);
								
				var outSum = 0;
				for(var i=0; i<dlt_tripCnt.getRowCount(); i++){					
					outSum+= Number(dlt_tripCnt.getCellData(i, "ctr_out_region"));
				}
				if(outSum >= 101){
					btn_tripList.trigger("click");						
				}else{
					// 사후결재 확인
					scwin.confirmPostApr();
				}		
			}
		});
	};
	
	/**
	 * 사후결재 확인
	 */
	scwin.confirmPostApr = function(){
		// 사후결재 확인
		var data = {
			req_no : dma_trip.get("req_no"),
			docu_id : "C76",
			syspayno : dma_compn.get("biztrip_psn_syspayno"),
			action_ymd : dma_trip.get("biztrip_ymd")
		};
		
		// 면담자연락처 전화번호 포맷 적용
		dma_trip.set("major_intrv_tel", com.formatPhone(dma_trip.get("major_intrv_tel")));
				
		com.biz.confirmPostApr(data, function(){
			dma_trip.set("approval", "true");
			scwin.save();
		});
	};
	
	/*
     * 출장자 초기화
     */
	scwin.ibx_biztripPsnEmpno_onviewchange = function(info) {
		scwin.clearData("BIZTRIP_PSN", info.newValue);
	};
	/*
     * 대행자 초기화
     */
	scwin.ibx_agentPsnEmpno_onviewchange = function(info) {
		scwin.clearData("AGENT_PSN", info.newValue);
	};
	
	/*
     * 계정책임자 초기화
     */
	scwin.ibx_accntRespnPsnEmpno_onviewchange = function(info) {
		scwin.clearData("ACCNT_RESPN", info.newValue);
	};	
	
	/*
     * 방문처 업체검색(사용않음)
     */
	scwin.btn_cust_onclick = function(e) {
		com.pop.open(com.pop.TYPE.CUST, {ref_yn : "Y"}, function(ret){
			ibx_cust_nm.setValue(ret.cmpy_nm_krchar);
		});
	};	
	
	/*
     * 동반자 그리드 변경 이벤트
     */
	scwin.grd_compn_onviewchange = function(info) {
		var row = info.rowIndex;
		if(info.colIndex == grd_compn.getColumnIndex("biztrip_psn_empno")){
			if(dlt_compn.getCellData(row, "biztrip_psn_empno") == ""){
				dlt_compn.setCellData(row, "biztrip_psn_syspayno", "");
				dlt_compn.setCellData(row, "biztrip_psn_nm", "");				
				dlt_compn.setCellData(row, "biztrip_dept_nm", "");
				dlt_compn.setCellData(row, "biztrip_psn_dept_cd", "");
				dlt_compn.setCellData(row, "biztrip_psn_dept_new_ymd", "");
			}else{
				if(dma_compn.get("biztrip_psn_syspayno") == ""){
					com.alert(com.getMsg("message.xom.co.com.0001","출장자"));	
					dlt_compn.setCellData(row, "biztrip_psn_empno", "");
					return;
				}	
				scwin.getEmpInfo("Compn", dlt_compn.getCellData(row, "biztrip_psn_empno"));
			}
			
		}else if(info.colIndex == grd_compn.getColumnIndex("agent_psn_empno")){
			if(dlt_compn.getCellData(row, "agent_psn_empno") == ""){
				dlt_compn.setCellData(row, "agent_psn_nm", "");
				dlt_compn.setCellData(row, "agent_psn_syspayno", "");
			}else{
				scwin.getEmpInfo("Agent", dlt_compn.getCellData(row, "agent_psn_empno"));
			}
		}
	};
	
	/**
	 * 사원검색 및 팝업호출
	 */
	scwin.getEmpInfo = function(type, empNo){
		var data = {empno : empNo,
					work_clsf : "HAG010"
		};
		
		if(empNo == ""){
			data.ref_yn = "Y";
		}
		
		com.pop.open(com.pop.TYPE.HUM, data, function(ret) {
			scwin.setBizTripPsn(type, ret);
		});
	}

	/**
	 * 2023년 4월 1일부로 시행	
	 * 금요일의 경우 근무인정 시각이 08시 부터 이므로 08시부터 선택할 수 있게 한다.
	 */
	scwin.ica_biztripDate_onchange = function() {
		var selectdate = this.getValue();
		var biztripDate = new Date(selectdate.substr(0,4) + "-" + selectdate.substr(4,2) + "-" + selectdate.substr(6,2));
		debugger;
		
		if (!com.isEmpty(selectdate)) {
			if(selectdate >= "20230401" && biztripDate.getDay() == 5) {
				if(sbx_start_time.itemArr[0].value == "07:00") {	// 금요일이고 0번 인덱스가 07시이면 0번 인덱스에 07시 제거
					var sbxStartTime = sbx_start_time.getValue();
					sbx_start_time.deleteItem(0);
					sbx_start_time.setValue("");
					sbx_start_time.setValue(sbxStartTime);
					if(sbx_start_time.getValue() == "07:00") { 
						sbx_start_time.setValue("");
					}
				}
			} else {
				if(sbx_start_time.itemArr[0].value == "08:00") {
					sbx_start_time.addItem("07:00", "07:00", 0);	// 금요일이 아니고 0번 인덱스가 08시이면 0번 인덱스에 07시 추가
				}
			}
		}
	};
	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group id="grp_page" class="pageWrap">
    		<xf:group class="searchSection step" id="" style="">
    			<xf:group class="le" id="" style="">
    				<xf:trigger class="btn" id="btn_list" style="" type="button" ev:onclick="scwin.btn_list_onclick">
    					<xf:label><![CDATA[목록]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btnbox ri" id="">
    				<xf:trigger class="btn icon print" id="btn_oz" style="" type="button" ev:onclick="scwin.btn_oz_onclick" disabled="true">
    					<xf:label><![CDATA[인쇄]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn" id="btn_tripList" style="" type="button" ev:onclick="scwin.btn_tripList_onclick">
    					<xf:label><![CDATA[출장현황]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="btn blue" id="btn_apr" style="" type="button" ev:onclick="scwin.btn_apr_onclick" disabled="true">
    					<xf:label><![CDATA[결재신청]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="근거리출장서 작성자 소속 신청번호"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="작성자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="" label="" style="" tagname="span" ref="data:dma_trip.req_psn_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="" label="" style="" tagname="span" ref="data:dma_trip.req_psn_dept_nm"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th" style="">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="신청번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" style="">
    					<w2:attributes></w2:attributes>
    					<w2:textbox class="txt" id="" label="" style="" tagname="span" ref="data:dma_trip.req_no"></w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="" id="grp_reject" style="">
    			<xf:group class="titleSection" id="" style="">
    				<w2:textbox class="tit_tbl" id="" label="반려자" style="" tagname="h3"></w2:textbox>
    			</xf:group>
    			<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_aprReject" defaultCellHeight="28"
    				evenRowBackgroundColor="#f7faff" id="grdReject" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    				rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40"
    				rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="false" scrollByColumnAdaptive="false"
    				selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5">
    				<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    				<w2:header id="header1" style="">
    					<w2:row id="row1" style="">
    						<w2:column colSpan="1" displayMode="label" id="column5" inputType="text" rowSpan="" style="height:28px;"
    							value="반려자" width="240">
    						</w2:column>
    						<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="반려의견" width="200"></w2:column>
    						<w2:column width="70" inputType="text" style="height:28px" id="column30" value="반려일시" displayMode="label"></w2:column>
    					</w2:row>
    				</w2:header>
    				<w2:gBody id="gBody1" style="">
    					<w2:row id="row2" style="">
    						<w2:column displayMode="label" escape="false" id="empname" inputType="text" readOnly="true"
    							style="height:28px;" width="120">
    						</w2:column>
    						<w2:column displayMode="label" id="contents" inputType="text" readOnly="true" style="height:28px;"
    							width="400" class="le">
    						</w2:column>
    						<w2:column width="120" inputType="text" style="height:28px" id="created_date" value="" displayMode="label"
    							readOnly="true">
    						</w2:column>
    					</w2:row>
    				</w2:gBody>
    			</w2:gridView>
    		</xf:group>
    		<xf:group class="" id="grp_reason" style="">
    			<xf:group class="titleSection" id="" style="">
    				<w2:textbox class="tit_tbl" id="" label="사후결재" style="" tagname="h3"></w2:textbox>
    			</xf:group>
    			<xf:group class="w2tb tbl" id="" style="" tagname="table">
    				<w2:attributes>
    					<w2:summary></w2:summary>
    				</w2:attributes>
    				<xf:group tagname="caption" text="증빙정보"></xf:group>
    				<xf:group tagname="colgroup">
    					<xf:group style="width:140px;" tagname="col"></xf:group>
    					<xf:group style="" tagname="col"></xf:group>
    					<xf:group style="width:140px;" tagname="col"></xf:group>
    					<xf:group style="" tagname="col"></xf:group>
    				</xf:group>
    				<xf:group tagname="tr">
    					<xf:group class="w2tb_th" tagname="th">
    						<w2:attributes>
    							<w2:scope>row</w2:scope>
    						</w2:attributes>
    						<w2:textbox id="" label="사유" style="" tagname="span"></w2:textbox>
    					</xf:group>
    					<xf:group class="w2tb_td" tagname="td">
    						<w2:attributes>
    							<w2:colspan>3</w2:colspan>
    							<w2:rowspan>1</w2:rowspan>
    						</w2:attributes>
    						<xf:group id="group" style="width:100%;height:60px;">
    							<xf:input adjustMaxLength="false" class="inp full le" id="txt_afterReason" readOnly="true"
    								readOnlyClass="inp full" style="width: 100%;height: 100%;" title="성명 상세" ref="data:dma_postApr.reason">
    							</xf:input>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group style="" id="" class="titleSection">
    			<w2:textbox tagname="h3" style="" id="" label="출장자" class="tit_tbl"></w2:textbox>
    		</xf:group>
    		<xf:group tagname="table" style="" id="" class="w2tb tbl">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="출장자 성명 소속 직문대행 비상연락"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group tagname="col" style="width:140px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:140px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="" id="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="성명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:group style="width: 160px;" id="grp_biztrip_psn" class="inpSch">
    							<xf:input adjustMaxLength="false" style="" id="ibx_biztripPsnEmpno" class="inp" title="성명"
    								ref="data:dma_compn.biztrip_psn_empno" readOnlyClass="inp" ev:onviewchange="scwin.ibx_biztripPsnEmpno_onviewchange">
    							</xf:input>
    							<xf:trigger style="" id="btn_searchBiztrip" type="button" class="btn" title="성명 조회"
    								ev:onclick="scwin.btn_searchBiztrip_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" style="" id="" class="inp full" title="성명 상세" readOnlyClass="inp full" ref="data:dma_compn.biztrip_psn_nm" disabled="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="소속" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="소속" readOnlyClass="inp full" ref="data:dma_compn.biztrip_psn_dept_nm" disabled="true">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="직무대행" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:group class="flex" id="" style="">
    						<xf:group class="inpSch" id="grp_agent" style="width: 160px;">
    							<xf:input adjustMaxLength="false" class="inp" id="ibx_agentPsnEmpno" style="" title="직무대행명"
    								ref="data:dma_compn.agent_psn_empno" readOnlyClass="inp" ev:onviewchange="scwin.ibx_agentPsnEmpno_onviewchange">
    							</xf:input>
    							<xf:trigger class="btn" id="btn_searchAgent" style="" title="직무대행 조회" type="button"
    								ev:onclick="scwin.btn_searchAgent_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="직무대행 상세" readOnlyClass="inp full" ref="data:dma_compn.agent_psn_nm" disabled="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="비상연락" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="비상연락"
    						ref="data:dma_compn.emgnc_contac_no" readOnly="true" readOnlyClass="inp full">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="동반자" style="" tagname="h3"></w2:textbox>
    			<xf:group class="btnarea" id="" style="">
    				<xf:trigger class="bt_plus" id="btn_biztripPlus" style="" type="button" ev:onclick="scwin.btn_biztripPlus_onclick">
    					<xf:label><![CDATA[추가]]></xf:label>
    				</xf:trigger>
    				<xf:trigger class="bt_minus" id="btn_biztripMin" style="" type="button" ev:onclick="scwin.btn_biztripMin_onclick">
    					<xf:label><![CDATA[삭제]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_compn" defaultCellHeight="28"
    			evenRowBackgroundColor="#f7faff" id="grd_compn" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
    			rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40"
    			rowStatusHeaderValue="상태" rowStatusVisible="true" rowStatusWidth="40" scrollByColumn="false" scrollByColumnAdaptive="false"
    			selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5" ev:oncellclick="scwin.grd_compn_oncellclick" ev:onviewchange="scwin.grd_compn_onviewchange">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;" value="선택" width="50"></w2:column>
    					<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="성명" width="240" colSpan="3"
    						rowSpan="">
    					</w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="소속" width="200"></w2:column>
    					<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="직무대행" width="290"
    						colSpan="3" rowSpan="">
    					</w2:column>
    					<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="비상연락" width="180"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column displayMode="label" id="chk" inputType="checkbox" style="height:28px;" width="40" defaultValue="N" fixColumnWidth="true"></w2:column>
    					<w2:column displayMode="label" escape="false" id="biztrip_psn_empno" inputType="text" readOnly="false"
    						style="height:28px;" width="100">
    					</w2:column>
    					<w2:column width="40" inputType="image" style="height:28px;cursor: pointer;" id="grd_searchBiztrip" value=""
    						displayMode="label" class="btn glass">
    					</w2:column>
    					<w2:column width="100" inputType="text" style="height:28px" id="biztrip_psn_nm" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="biztrip_psn_dept_nm" inputType="text" readOnly="true"
    						style="height:28px;" width="200">
    					</w2:column>
    					<w2:column class="" displayMode="label" id="agent_psn_empno" inputType="text" readOnly="false" style="height:28px;"
    						width="100">
    					</w2:column>
    					<w2:column width="40" inputType="image" style="height:28px;cursor: pointer;" id="grd_searchAgent" value="" displayMode="label"
    						class="btn glass">
    					</w2:column>
    					<w2:column width="100" inputType="text" style="height:28px" id="agent_psn_nm" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column displayMode="label" id="emgnc_contac_no" inputType="text" readOnly="true" style="height:28px;"
    						width="180">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
    		<xf:group style="" id="" class="titleSection">
    			<w2:textbox tagname="h3" style="" id="" label="출장정보" class="tit_tbl"></w2:textbox>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="출장정보 상세"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="출장일자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal req" focusOnDateSelect="false" footerDiv="false"
    						id="ica_biztripDate" placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="출장일자"
    						ref="data:dma_trip.biztrip_ymd" ev:onchange="scwin.ica_biztripDate_onchange">
    					</w2:inputCalendar>
    					<w2:attributes></w2:attributes>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="시간" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<xf:select1 allOption="" appearance="minimal" chooseOption="" class="sel req" direction="auto" disabled="false"
    						disabledClass="w2selectbox_disabled" id="sbx_start_time" ref="data:dma_trip.start_time" style="width:80px;" submenuSize="auto"
    						title="시간 시작시간" ev:onviewchange="scwin.sbx_start_time_onviewchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[07:00]]></xf:label>
    								<xf:value><![CDATA[07:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[08:00]]></xf:label>
    								<xf:value><![CDATA[08:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[09:00]]></xf:label>
    								<xf:value><![CDATA[09:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[10:00]]></xf:label>
    								<xf:value><![CDATA[10:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[11:00]]></xf:label>
    								<xf:value><![CDATA[11:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[12:00]]></xf:label>
    								<xf:value><![CDATA[12:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[13:00]]></xf:label>
    								<xf:value><![CDATA[13:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[14:00]]></xf:label>
    								<xf:value><![CDATA[14:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[15:00]]></xf:label>
    								<xf:value><![CDATA[15:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[16:00]]></xf:label>
    								<xf:value><![CDATA[16:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[17:00]]></xf:label>
    								<xf:value><![CDATA[17:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[18:00]]></xf:label>
    								<xf:value><![CDATA[18:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[19:00]]></xf:label>
    								<xf:value><![CDATA[19:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[20:00]]></xf:label>
    								<xf:value><![CDATA[20:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[21:00]]></xf:label>
    								<xf:value><![CDATA[21:00]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    					<w2:textbox class="dash" id="" label="~" style="" tagname="span"></w2:textbox>
    					<xf:select1 allOption="" appearance="minimal" chooseOption="" class="sel req" direction="auto" disabled="false"
    						disabledClass="w2selectbox_disabled" id="sbx_arriv_time" ref="data:dma_trip.arriv_time" style="width:80px;" submenuSize="auto"
    						title="시간 종료시간" ev:onviewchange="scwin.sbx_arriv_time_onviewchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[08:00]]></xf:label>
    								<xf:value><![CDATA[08:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[09:00]]></xf:label>
    								<xf:value><![CDATA[09:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[10:00]]></xf:label>
    								<xf:value><![CDATA[10:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[11:00]]></xf:label>
    								<xf:value><![CDATA[11:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[12:00]]></xf:label>
    								<xf:value><![CDATA[12:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[13:00]]></xf:label>
    								<xf:value><![CDATA[13:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[14:00]]></xf:label>
    								<xf:value><![CDATA[14:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[15:00]]></xf:label>
    								<xf:value><![CDATA[15:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[16:00]]></xf:label>
    								<xf:value><![CDATA[16:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[17:00]]></xf:label>
    								<xf:value><![CDATA[17:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[18:00]]></xf:label>
    								<xf:value><![CDATA[18:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[19:00]]></xf:label>
    								<xf:value><![CDATA[19:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[20:00]]></xf:label>
    								<xf:value><![CDATA[20:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[21:00]]></xf:label>
    								<xf:value><![CDATA[21:00]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[22:00]]></xf:label>
    								<xf:value><![CDATA[22:00]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    					<w2:attributes></w2:attributes>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th" style="">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="차량사용" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" style="">
    					<xf:select1 allOption="" appearance="minimal" chooseOption="" chooseOptionLabel="" class="sel  req" direction="auto"
    						disabled="false" disabledClass="w2selectbox_disabled" id="sbx_carUse" ref="data:dma_trip.car_use_yn" style="width:150px;"
    						submenuSize="auto" title="차량사용" ev:onviewchange="scwin.sbx_carUse_onviewchange">
    						<xf:choices></xf:choices>
    					</xf:select1>
    					<w2:attributes></w2:attributes>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="출장지" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group id="" class="flex">
    						<w2:autoComplete allOption="" chooseOption="true" chooseOptionLabel="-선택-" class="req" displayMode=""
    							editModeEvent="onclick" id="sbx_startRegion" ref="data:dma_trip.start_region" search=""
    							style="width:150px;" submenuSize="auto" tooltipDisplay="" useKeywordHighlight="" visibleColumn=""
    							visibleColumnFalseValue="" title="출장지 출발지">
    							<w2:choices>
    								<w2:itemset nodeset="data:dlt_code">
    									<w2:label ref="code_nm"></w2:label>
    									<w2:value ref="code"></w2:value>
    								</w2:itemset>
    							</w2:choices>
    						</w2:autoComplete>
    						<w2:textbox tagname="span" style="" id="" label="▶" class="txt"></w2:textbox>
    						<xf:select1 chooseOptionLabel="- 선택-" submenuSize="auto" chooseOption="true" allOption="" title="출장지 종료지"
    							ref="data:dma_trip.arriv_region" appearance="minimal" disabledClass="w2selectbox_disabled" disabled="false" style="width:250px;"
    							id="sbx_arrivRegion" class="sel  req" direction="auto" ev:onviewchange="scwin.sbx_arrivRegion_onviewchange">
    							<xf:choices></xf:choices>
    						</xf:select1>
    						<xf:input adjustMaxLength="false" style="" id="" title="출장지 종료지 상세" class="inp full  req" maxlength="60"
    							ref="data:dma_trip.biztrip_land">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="주요면담자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full  req" id="" style="" title="주요면담자" maxlength="60"
    						ref="data:dma_trip.major_intrv_psn">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="면담자연락처" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes></w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full  req" id="" style="" title="면담자연락처"
    						ref="data:dma_trip.major_intrv_tel">
    					</xf:input>    					
    					<!-- <xf:input adjustMaxLength="false" class="inp full  req" id="" style="" title="면담자연락처" maxlength="11"
    						ref="data:dma_trip.major_intrv_tel" allowChar="0-9">
    					</xf:input> -->
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="출장목적" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group id="grp_bizTripGoal" class="flex">
    						<xf:select1 chooseOptionLabel="" ref="data:dma_trip.biztrip_goal_clsf" submenuSize="auto"
    							appearance="minimal" disabledClass="w2selectbox_disabled" chooseOption="" disabled="false" style="width:150px;" allOption=""
    							id="sbx_biztripGoal" class="sel  req" direction="auto" title="출장목적" ev:onviewchange="scwin.sbx_biztripGoal_onviewchange">
    							<xf:choices></xf:choices>
    						</xf:select1>
    						<xf:input adjustMaxLength="false" style="" id="" title="출장목적 상세" class="inp full  req" maxlength="60"
    							ref="data:dma_trip.biztrip_goal">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="원내출장여부" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<xf:select1 appearance="full" class="radioGroup  req" cols="" id="rdo_internalRegion"
    						ref="data:dma_trip.is_internal_region" renderType="radiogroup" rows="" selectedIndex="-1" style="" title="원내출장여부">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[원내]]></xf:label>
    								<xf:value><![CDATA[t]]></xf:value>
    							</xf:item>
    							<xf:item>
    								<xf:label><![CDATA[원외]]></xf:label>
    								<xf:value><![CDATA[f]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select1>
    					<w2:attributes></w2:attributes>
    				</xf:group>
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="방문처" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>2</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:input adjustMaxLength="false" style="" id="" title="방문처 " class="inp full" maxlength="60"
    							ref="data:dma_trip.rmk_1">
    						</xf:input>
    						<xf:group style="width: 120px;display: none;" id="" class="inpSch">
    							<xf:input adjustMaxLength="false" style="" id="" class="inp" title="방문처명"></xf:input>
    							<xf:trigger style="" id="" type="button" class="btn" title="방문처 조회">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td" style="">
    					<w2:attributes></w2:attributes>
    					<xf:group class="inpSch full" id="grp_cust" style="">
    						<xf:input adjustMaxLength="false" class="inp" id="ibx_cust_nm" style="" title="방문처명"></xf:input>
    						<xf:trigger class="btn" id="btn_cust" style="" title="방문처 조회" type="button" ev:onclick="scwin.btn_cust_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="" id="grp_confPool">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
    					<w2:textbox id="" label="학술대회정보" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<xf:group class="inpSch  full" id="" style="">
    						<xf:input adjustMaxLength="false" class="inp" id="" style="" title="학술대회정보" readOnly="true"
    							readOnlyClass="inp" ref="data:dma_trip.pool_conf_nm">
    						</xf:input>
    						<xf:trigger class="btn" id="btn_poolConf" style="" title="학술대회정보 조회" type="button" ev:onclick="scwin.btn_poolConf_onclick">
    							<xf:label><![CDATA[검색]]></xf:label>
    						</xf:trigger>
    					</xf:group>
    					<w2:attributes>
    						<w2:colspan>5</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="helparea" id="" style="">
    			<xf:group id="" style="" tagname="ul">
    				<xf:group id="" style="" tagname="li">
    					<w2:textbox class="" id=""
    						label="원내: 우리 연구원이 주관/주최하는 전시회, 회의/행사로서 '원내'에서 개최하는 경우, 우리 연구원이 주관/주최하는 회의/행사로서 '원외'에서 개최하는 경우도 포함" style="" tagname="span">
    					</w2:textbox>
    				</xf:group>
    				<xf:group id="" style="" tagname="li">
    					<w2:textbox class="" id=""
    						label="원외: 타 기관이 주관/주최하는 회의/행사로서 '원외'에서 개최하는 경우, 타 기관이 주관/주최하는 회의/행사로서 '원내'에서 개최하는 경우도 포함" style="" tagname="span">
    					</w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="출장정보 여비"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px" tagname="col"></xf:group>
    				<xf:group style="width:140px" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th ce" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="구분" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th ce" style="" tagname="th">
    					<w2:textbox id="" label="금액" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th ce" style="" tagname="th">
    					<w2:textbox id="" label="비고" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_td ce" style="" tagname="td">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="여비" style="" tagname="span"></w2:textbox>
    					<xf:trigger class="btn glass ml10" id="btn_popTrafcFee" style="" title="여비조회" type="button"
    						ev:onclick="scwin.btn_popTrafcFee_onclick">
    						<xf:label><![CDATA[검색]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full ri" id="ibx_trafc_fee" style="" ref="data:dma_trip.trafc_fee"
    						dataType="number" readOnlyClass="inp full ri" displayFormat="#,###" disabled="true">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_td ce" style="" tagname="td">
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" ref="data:dma_trip.trafc_fee_rmk"
    						maxlength="60" readOnly="true" readOnlyClass="inp full">
    					</xf:input>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="출장정보 여비"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:320px" tagname="col"></xf:group>
    				<xf:group style="width:240px" tagname="col"></xf:group>
    				<xf:group tagname="col" style="width:140px"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th ce" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="계정번호 (계정/출장비 없음" style="" tagname="span"></w2:textbox>
    					<xf:select appearance="full" class="chkGroup" cols="" id="chk_accntNoUse" ref="" renderType="checkboxgroup" rows=""
    						selectedindex="-1" style="width: 16px;" falseValue="N" ev:onviewchange="scwin.chk_accntNoUse_onviewchange">
    						<xf:choices>
    							<xf:item>
    								<xf:label><![CDATA[]]></xf:label>
    								<xf:value><![CDATA[Y]]></xf:value>
    							</xf:item>
    						</xf:choices>
    					</xf:select>
    					<w2:textbox id="" label=")" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th ce" style="" tagname="th">
    					<w2:textbox id="" label="계정책임자" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="th" class="w2tb_th ce">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="통제번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_th ce" style="" tagname="th">
    					<w2:textbox id="" label="비고" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group class="w2tb_td ce" style="" tagname="td">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<xf:group id="" class="flex">
    						<xf:trigger style="" id="btn_searchAccntNo" title="계정번호 조회" type="button" class="btn glass"
    							ev:onclick="scwin.btn_searchAccntNo_onclick">
    							<xf:label><![CDATA[계정정보찾기]]></xf:label>
    						</xf:trigger>
    						<xf:trigger style="" id="btn_searchRecntAccnt" title="출정일 조회" type="button" class="btn cal "
    							ev:onclick="scwin.btn_searchRecntAccnt_onclick">
    							<xf:label><![CDATA[출정일자]]></xf:label>
    						</xf:trigger>
    						<xf:input adjustMaxLength="false" style="" id="ibx_accnt_no" class="inp full" title="계정번호" readOnlyClass="inp full" displayFormatter='scwin.accntNoFormat' readOnly="true">
    						</xf:input>
    						<xf:input adjustMaxLength="false" style="" id="" class="inp full" title="출정일" readOnlyClass="inp full" ref="data:dma_trip.accnt_no_nm" disabled="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<xf:group id="" class="flex">
    						<xf:group style="width: 160px;" id="" class="inpSch">
    							<xf:input adjustMaxLength="false" style="" id="ibx_accntRespnPsnEmpno" class="inp" title="계정책임자"
    								ref="data:dma_trip.accnt_respn_psn_empno" readOnlyClass="inp" ev:onviewchange="scwin.ibx_accntRespnPsnEmpno_onviewchange">
    							</xf:input>
    							<xf:trigger style="" id="btn_searchAccntRes" type="button" class="btn" title="계정책임자 조회"
    								ev:onclick="scwin.btn_searchAccntRes_onclick">
    								<xf:label><![CDATA[검색]]></xf:label>
    							</xf:trigger>
    						</xf:group>
    						<xf:input adjustMaxLength="false" style="" id="" class="inp" title="계정책임자 상세" readOnlyClass="inp" ref="data:dma_trip.accnt_respn_psn_nm" disabled="true">
    						</xf:input>
    					</xf:group>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<xf:input adjustMaxLength="false" class="inp full" id="" style="" title="통제번호" readOnlyClass="inp full"
    						ref="data:dma_trip.bugt_ctrl_no" maxlength="10" readOnly="true" disabled="true">
    					</xf:input>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:textbox id="" label="※ 계정번호 없는 경우 집행처리 불가" style="" tagname="span"></w2:textbox>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="지급내역" style="" tagname="h3"></w2:textbox>
    			<w2:span class="note blue" id="" label="※ 일별/개인별 지급총액(2만원) 고려한 금액정보" style=""></w2:span>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_localPay" defaultCellHeight="28"
    			evenRowBackgroundColor="#f7faff" id="" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb"
    			rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="60" rowStatusHeaderValue="상태"
    			rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd"
    			selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="5">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;" value="출장자" width="170"
    						colSpan="2" rowSpan="">
    					</w2:column>
    					<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="지급금액" width="100"></w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="적요" width="300"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column displayMode="label" id="biztrip_psn_empno" inputType="text" readOnly="true" style="height:28px;"
    						width="100">
    					</w2:column>
    					<w2:column width="100" inputType="text" style="height:28px" id="biztrip_psn_nm" value="" displayMode="label"
    						readOnly="true">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="pay_amt" inputType="text" readOnly="true" style="height:28px;"
    						width="100" dataType="number" displayFormat="#,###" readOnlyClass="ri">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="rmk" inputType="text" readOnly="true" style="height:28px;"
    						width="300" class="le">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
    		<xf:group tagname="table" style="" id="" class="w2tb tbl">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption" text="증빙정보"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group tagname="col" style="width:140px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    				<xf:group tagname="col" style="width:140px;"></xf:group>
    				<xf:group tagname="col" style=""></xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox tagname="span" style="" id="" label="첨부파일"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes>
    						<w2:colspan>3</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<xf:group id="upload_A" style="width:100%;height:125px;" ev:onclick="scwin.upload_A_onclick"></xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="helparea no" id="" style="">
    			<xf:group id="" style="" tagname="ol">
    				<xf:group id="" tagname="li">
    					<w2:textbox class="blue" id="" label="공용업무차량 이용 및 출장비를 지급 받고자 하는 경우에는 반드시 계정번호를 입력해야 합니다." style=""
    						tagname="span">
    					</w2:textbox>
    				</xf:group>
    				<xf:group id="" tagname="li" style="">
    					<w2:textbox class="blue" id="" label="원차량 이용시 출장비는 차량 관리비 계정에 흡수됩니다." style="" tagname="span"></w2:textbox>
    					<w2:textbox class="blue dis_block" id="" label="※ 급여항목 자가운전보조비 비과세 처리기준(근거리출장 1회이상, 자가차량사용, 월별신청합계 0원)" style=""
    						tagname="span">
    					</w2:textbox>
    				</xf:group>
    				<xf:group class="ri" id="" style="">
    					<xf:trigger class="btn pro" id="btn_del" style="" type="button" ev:onclick="scwin.btn_del_onclick" disabled="true">
    						<xf:label><![CDATA[삭제]]></xf:label>
    					</xf:trigger>
    					<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
    						<xf:label><![CDATA[저장]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
