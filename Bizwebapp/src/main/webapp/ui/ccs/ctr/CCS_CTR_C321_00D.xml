<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:w2="http://www.inswave.com/websquare"	xmlns:xf="http://www.w3.org/2002/xforms">
	<head meta_programName="국내출장정산서">
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" id="dlt_path" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="req_no" name="신청번호"></w2:column>
						<w2:column dataType="text" id="odr" name="순번"></w2:column>
						<w2:column dataType="text" id="start_region" name="출발지"></w2:column>
						<w2:column dataType="text" id="arriv_region" name="도착지"></w2:column>
						<w2:column dataType="text" id="rmk" name="비고"></w2:column>
						<w2:column dataType="text" id="start_region_nm" name="출발지명"></w2:column>
						<w2:column dataType="text" id="arriv_region_nm" name="도착지명"></w2:column>
						<w2:column dataType="text" id="biztrip_fee" name="운임비"></w2:column>
						<w2:column dataType="text" id="chk" name="선택"></w2:column>
						<w2:column dataType="text" id="posi_clsf" name="직급구분"></w2:column>
						<w2:column id="lodg_yn" name="숙박일수" dataType="text"></w2:column>
						<w2:column id="lodg_fee_max" name="숙박금액" dataType="text"></w2:column>
						<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_search" style="">
					<w2:keyInfo>
						<w2:key dataType="text" id="req_no" name="정산번호"></w2:key>
						<w2:key dataType="text" id="unslip_no" name="결의번호"></w2:key>
						<w2:key id="biztrip_req_no" name="출장신청번호" dataType="text"></w2:key>
						<w2:key id="posi_clsf" name="직급구분" dataType="text"></w2:key>
						<w2:key id="mails" name="메일리스트" dataType="text"></w2:key>
						<w2:key id="from_ymd" name="출장시작일자" dataType="text"></w2:key>
						<w2:key id="to_ymd" name="출장종료일" dataType="text"></w2:key>
						<w2:key id="psn_syspayno" name="출장자" dataType="text"></w2:key>
						<w2:key id="accnt_no" name="계정번호" dataType="text"></w2:key>
						<w2:key id="expns_cd" name="회계코드" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_tripAd">
					<w2:keyInfo>
						<w2:key id="req_no" name="정산번호" dataType="text"></w2:key>
						<w2:key id="req_ymd" name="신청일자" dataType="text"></w2:key>
						<w2:key id="req_psn_syspayno" name="신청자" dataType="text"></w2:key>
						<w2:key id="req_psn_dept_cd" name="신청자부서" dataType="text"></w2:key>
						<w2:key id="req_psn_dept_new_ymd" name="신청자부서신설일" dataType="text"></w2:key>
						<w2:key id="unslip_no" name="결의번호" dataType="text"></w2:key>
						<w2:key id="attach_file_no" name="첨부파일번호" dataType="text"></w2:key>
						<w2:key id="excess_resn_cd" name="초과사유코드" dataType="text"></w2:key>
						<w2:key id="biztrip_req_no" name="출장신청번호" dataType="text"></w2:key>
						<w2:key id="orign_biztrip_goal" name="출장목적" dataType="text"></w2:key>
						<w2:key id="biztrip_prd" name="신청 출장기간" dataType="text"></w2:key>
						<w2:key id="car_use_yn" name="차량사용" dataType="text"></w2:key>
						<w2:key id="truth_orign_ymd" name="실제시작일자" dataType="text"></w2:key>
						<w2:key id="truth_cls_ymd" name="실제종료일자" dataType="text"></w2:key>
						<w2:key id="biztrip_nght" name="출장밤" dataType="text"></w2:key>
						<w2:key id="biztrip_day" name="출장낮" dataType="text"></w2:key>
						<w2:key id="chng_resn" name="변경사유" dataType="text"></w2:key>
						<w2:key id="chng_contnt" name="변경내용" dataType="text"></w2:key>
						<w2:key id="truth_biztrip_form" name="신청출장지" dataType="text"></w2:key>
						<w2:key id="truth_biztrip_goal_cd" name="실제출장목적구분" dataType="text"></w2:key>
						<w2:key id="truth_biztrip_goal" name="실제출장목적" dataType="text"></w2:key>
						<w2:key id="card_meal" name="카드식여부" dataType="text"></w2:key>
						<w2:key id="notebook_in" name="노트북반입여부" dataType="text"></w2:key>
						<w2:key id="usb_in" name="USB반입여부" dataType="text"></w2:key>
						<w2:key id="evid_attach_file_no" name="첨부화일(복명증빙)" dataType="text"></w2:key>
						<w2:key id="biztrip_way" name="운임구분" dataType="text"></w2:key>
						<w2:key id="bizwrk_atdnc_contnt" name="업무수행내용" dataType="text"></w2:key>
						<w2:key id="polcy_suggst_item" name="주요성과(정책건의사항)" dataType="text"></w2:key>
						<w2:key id="slip_ymd" name="결의일자" dataType="text"></w2:key>
						<w2:key id="decsn_ex" name="확정유무" dataType="text"></w2:key>
						<w2:key id="rmk" name="적요" dataType="text"></w2:key>
						<w2:key id="posi_clsf" name="직급구분" dataType="text"></w2:key>
						<w2:key id="notebook_out" name="노트북반출여부" dataType="text"></w2:key>
						<w2:key id="usb_out" name="usb반출여부" dataType="text"></w2:key>
						<w2:key id="apr_state" name="결재상태" dataType="text"></w2:key>
						<w2:key id="biztrip_region" name="신청출장지" dataType="text"></w2:key>
						<w2:key id="chng_biztrip_land" name="신청도착지" dataType="text"></w2:key>
						<w2:key id="expns_cnt" name="출장경비여부" dataType="text"></w2:key>
						<w2:key id="air_mile_no" name="마일리지신청번호" dataType="text"></w2:key>
						<w2:key id="no_trvel_expns" name="출장비없음여부" dataType="text"></w2:key>
						<w2:key id="validAttachNo" name="첨부파일" dataType="text"></w2:key>
						<w2:key id="cud_type" name="cud타입" dataType="text"></w2:key>
						<w2:key id="approval" name="전자결재" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" id="dlt_compn" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="req_no" name="신청번호"></w2:column>
						<w2:column dataType="text" id="req_seq" name="순번"></w2:column>
						<w2:column dataType="text" id="biztrip_req_no" name="출장신청번호"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_clsf" name="출장자구분"></w2:column>
						<w2:column id="biztrip_psn_clsf_nm" name="출장자구분명" dataType="text"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_syspayno" name="출장자시스템개인번호"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_empno" name="출장자개인번호"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_nm" name="출장자성명"></w2:column>
						<w2:column dataType="text" id="posi_cd" name="직급"></w2:column>
						<w2:column dataType="text" id="posi_nm" name="출장자직급"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_dept_cd" name="출장자부서코드"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_dept_new_ymd" name="출장자부서신설일자"></w2:column>
						<w2:column dataType="text" id="biztrip_dept_nm" name="출장자부서명"></w2:column>
						<w2:column dataType="text" id="posi_clsf" name="직급구분"></w2:column>
						<w2:column dataType="text" id="posi_clsf_nm" name="직급구분명"></w2:column>
						<w2:column dataType="text" id="biztrip_orign_ymd" name="출장시작일자"></w2:column>
						<w2:column dataType="text" id="biztrip_cls_ymd" name="출장종료일자"></w2:column>
						<w2:column dataType="text" id="biztrip_nght" name="출장밤"></w2:column>
						<w2:column dataType="text" id="biztrip_day" name="출장일"></w2:column>
						<w2:column dataType="text" id="chk" name="선택"></w2:column>
						<w2:column id="chng_clsf" name="취소여부" dataType="text"></w2:column>
						<w2:column id="biztrip_day_exp" name="name21" dataType="text"></w2:column>
						<w2:column id="email" name="이메일" dataType="text"></w2:column>
						<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dlt_pay" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="req_no" name="신청번호"></w2:column>
						<w2:column dataType="text" id="pay_seq" name="순번"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_syspayno" name="출장자시스템개인번호"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_nm" name="출장자성명"></w2:column>
						<w2:column dataType="text" id="biztrip_psn_empno" name="출장자개인번호"></w2:column>
						<w2:column dataType="text" id="truth_use_amt" name="실사용액"></w2:column>
						<w2:column id="adjst_amt" name="지급액" dataType="text"></w2:column>
						<w2:column dataType="text" id="tot_expns" name="금액"></w2:column>
						<w2:column dataType="text" id="bankaccnt_no" name="계좌번호"></w2:column>
						<w2:column dataType="text" id="bank_cd" name="은행"></w2:column>
						<w2:column id="bank_nm" name="은행명" dataType="text"></w2:column>
						<w2:column dataType="text" id="depstr" name="예금주"></w2:column>
						<w2:column dataType="text" id="pay_clsf" name="지급구분"></w2:column>
						<w2:column id="rmk" name="비고" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_expns" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="req_no" name="정산번호" dataType="text"></w2:column>
						<w2:column id="biztrip_psn_syspayno" name="출장자개인번호" dataType="text"></w2:column>
						<w2:column id="biztrip_psn_nm" name="출장자" dataType="text"></w2:column>
						<w2:column id="fare_txt" name="name28" dataType="text"></w2:column>
						<w2:column id="lodg_txt" name="name31" dataType="text"></w2:column>
						<w2:column id="ymd_txt" name="name30" dataType="text"></w2:column>
						<w2:column id="meal_txt" name="name29" dataType="text"></w2:column>
						<w2:column id="fare_clsf" name="운임구분" dataType="text"></w2:column>
						<w2:column id="fare_fee_max" name="운임기준금액" dataType="number"></w2:column>
						<w2:column id="fare_fee" name="운임실사용액" dataType="number"></w2:column>
						<w2:column id="fare_fee_rmk" name="운임비고" dataType="number"></w2:column>
						<w2:column id="fare_fee_pay" name="운임신청금액" dataType="number"></w2:column>
						<w2:column id="fare_card_yn" name="운임카드사용여부" dataType="text"></w2:column>
						<w2:column id="lodg_clsf" name="숙박구분" dataType="text"></w2:column>
						<w2:column id="lodg_fee_max" name="숙박기준금액" dataType="number"></w2:column>
						<w2:column id="lodg_fee_rmk" name="숙박비고" dataType="number"></w2:column>
						<w2:column id="lodg_fee_pay" name="숙박신청금액" dataType="number"></w2:column>
						<w2:column id="lodg_card_yn" name="숙박카드사용여부" dataType="text"></w2:column>
						<w2:column id="ymd_fee_max" name="일비기준금액" dataType="number"></w2:column>
						<w2:column id="ymd_fee_pay" name="일비신청금액" dataType="number"></w2:column>
						<w2:column id="ymd_fee_rmk" name="일비비고" dataType="text"></w2:column>
						<w2:column id="meal_fee_max" name="식비기준금액" dataType="number"></w2:column>
						<w2:column id="meal_fee_pay" name="식비신청금액" dataType="number"></w2:column>
						<w2:column id="meal_fee_rmk" name="식비비고" dataType="text"></w2:column>
						<w2:column id="card_meal" name="카드식" dataType="text"></w2:column>
						<w2:column id="sum_trip_fee_max" name="출장경비기준금액" dataType="text"></w2:column>
						<w2:column id="sum_trip_fee" name="출장경비실사용액" dataType="text"></w2:column>
						<w2:column id="sum_trip_fee_pay" name="출장경비신청금액" dataType="text"></w2:column>
						<w2:column id="lodg_fee" name="숙박비실사용액" dataType="number"></w2:column>
						<w2:column id="ymd_fee" name="일비실사용액" dataType="number"></w2:column>
						<w2:column id="meal_fee" name="식비실사용액" dataType="number"></w2:column>
						<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dlt_reqPath" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="req_no" name="신청번호"></w2:column>
						<w2:column dataType="text" id="odr" name="순번"></w2:column>
						<w2:column dataType="text" id="start_region" name="출발지"></w2:column>
						<w2:column dataType="text" id="arriv_region" name="도착지"></w2:column>
						<w2:column dataType="text" id="rmk" name="비고"></w2:column>
						<w2:column dataType="text" id="start_region_nm" name="출발지명"></w2:column>
						<w2:column dataType="text" id="arriv_region_nm" name="도착지명"></w2:column>
						<w2:column dataType="text" id="biztrip_fee" name="운임비"></w2:column>
						<w2:column dataType="text" id="chk" name="선택"></w2:column>
						<w2:column dataType="text" id="posi_clsf" name="직급구분"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dlt_accnt" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="req_no" name="신청번호"></w2:column>
						<w2:column dataType="text" id="req_seq" name="순번"></w2:column>
						<w2:column dataType="text" id="accnt_no" name="계정번호"></w2:column>
						<w2:column dataType="text" id="accnt_respn_psn_syspayno" name="계정책임자"></w2:column>
						<w2:column dataType="text" id="accnt_rspns_nm" name="계정책임자성명"></w2:column>
						<w2:column dataType="text" id="accnt_rspns_empno" name="계정책임자개인번호"></w2:column>
						<w2:column dataType="text" id="fomat_unit" name="편성단위"></w2:column>
						<w2:column dataType="text" id="accnt_cd" name="회계코드"></w2:column>
						<w2:column dataType="text" id="expns_cd" name="비용코드"></w2:column>
						<w2:column dataType="text" id="tot_expns" name="금액"></w2:column>
						<w2:column dataType="text" id="rmk" name="비고"></w2:column>
						<w2:column dataType="text" id="bugt_ctrl_no" name="통제번호"></w2:column>
						<w2:column id="bugt_ctrl_way" name="통제방법" dataType="text"></w2:column>
						<w2:column dataType="text" id="bugt_ctrl_psn" name="예산통제자"></w2:column>
						<w2:column dataType="text" id="bugt_ctrl_psn_nm" name="예산통제자성명"></w2:column>
						<w2:column dataType="text" id="accnt_no_nm" name="계정명"></w2:column>
						<w2:column dataType="text" id="mngmt_clsf" name="관리구분"></w2:column>
						<w2:column dataType="text" id="card_use_ex" name="카드사용구분"></w2:column>
						<w2:column dataType="text" id="chk" name="선택"></w2:column>
						<w2:column dataType="text" id="cud_type" name="cud타입"></w2:column>
						<w2:column dataType="text" id="btn_accnt_use" name="최근사용계정번호"></w2:column>
						<w2:column dataType="text" id="prj_no" name="과제번호"></w2:column>
						<w2:column dataType="text" id="accnt_state" name="계정상태"></w2:column>
						<w2:column id="cud_type" name="cud타입" dataType="text"></w2:column>
						<w2:column id="tax_cd_nm" name="과세구분" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_cardMeal" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="label" name="name1" dataType="text"></w2:column>
						<w2:column id="value" name="name2" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_etcFee" style="">
					<w2:keyInfo>
						<w2:key dataType="text" id="ymd_fee" name="일비"></w2:key>
						<w2:key dataType="text" id="meal_fee" name="식비"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_gpsInfo" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="user_nm" name="성명" dataType="text"></w2:column>
						<w2:column id="dept_nm" name="부서명" dataType="text"></w2:column>
						<w2:column id="emplyr_id" name="인증아이디" dataType="text"></w2:column>
						<w2:column id="addr_kr" name="인증지역" dataType="text"></w2:column>
						<w2:column id="input_date" name="인증시각" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_aprCheck" style="">
					<w2:keyInfo>
						<w2:key dataType="text" id="req_no" name="신청번호"></w2:key>
						<w2:key dataType="text" id="biztrip_start_ymd" name="시작일자"></w2:key>
						<w2:key dataType="text" id="biztrip_cls_ymd" name="종료일자"></w2:key>
						<w2:key dataType="text" id="biztrip_psn_syspayno" name="출장자"></w2:key>
						<w2:key dataType="text" id="goal_clsf" name="출장목적구분"></w2:key>
						<w2:key dataType="text" id="accnt_no" name="계정번호"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection />
			<!-- 조회 -->
			<xf:submission id="sbm_selectData" ref="data:json,dma_search"
				target='data:json,[{"id":"dma_tripAd","key":"tripAdVo"},{"id":"dlt_compn","key":"compnList"},{"id":"dlt_path","key":"pathList"},{"id":"dlt_reqPath","key":"reqPathList"},{"id":"dlt_pay","key":"payList"},{"id":"dlt_accnt","key":"accntList"},{"id":"dlt_expns","key":"expnsList"},{"id":"dma_etcFee","key":"feeVo"}]'
				action="SvcCCSCTRDADR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 운임 조회 -->
			<xf:submission id="sbm_selectFareFee" ref='data:json,{"id":"dlt_path","key":"pathList"}' target='data:json,dlt_path'
				action="SvcCCSCTRDOMR03.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 기타경비 조회 -->
			<xf:submission id="sbm_selectEtcFee" ref='data:json,dma_search' target='data:json,dma_etcFee'
				action="SvcCCSCTRDOMR04.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 출장번호로 출장정보조회 -->
			<xf:submission id="sbm_selectTripInfo" ref="data:json,dma_search"
				target='data:json,[{"id":"dma_tripAd","key":"tripAdVo"},{"id":"dlt_compn","key":"compnList"},{"id":"dlt_path","key":"pathList"},{"id":"dlt_accnt","key":"accntList"},{"id":"dlt_pay","key":"payList"},{"id":"dma_etcFee","key":"feeVo"}]'
				action="SvcCCSCTRDADR02.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 출장번호로 출장정산여부 조회 -->
			<xf:submission id="sbm_selectExistYn" ref="data:json,dma_search" target='' action="SvcCCSCTRDADR04.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 위치정보 조회 -->
			<xf:submission id="sbm_selectGpsInfo" ref="data:json,dma_search" target='' action="SvcCCSCTRDADR03.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="조회중..." ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 회계코드 조회 -->
			<xf:submission id="sbm_selectExpnsList" ref='data:json,dma_search' target='' action="SvcFinComExpnsList.pwkjson"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 저장 -->
			<xf:submission id="sbm_saveDomTripAd"
				ref='data:json,[{"id":"dma_tripAd","key":"tripAdVo"},{"action":"modified","id":"dlt_compn","key":"compnList"},{"id":"dlt_path","key":"pathList"},{"action":"modified","id":"dlt_accnt","key":"accntList"},{"id":"dlt_expns","key":"expnsList"},{"id":"dlt_pay","key":"payList"},{"id":"dlt_gpsInfo","key":"gpsList"}]'
				target='data:json,dma_search' action="SvcCCSCTRDADM01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance=""
				replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror=""
				abortTrigger="">
			</xf:submission>
			<!-- 결재전 검증 -->
			<xf:submission id="sbm_checkApr" ref='data:json,dma_aprCheck' target='' action="SvcCCSCTRDOMR05.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 정산서 삭제 -->
			<xf:submission id="sbm_deleteTripAd" ref='data:json,dma_search' target='' action="SvcCCSCTRDADD01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 담당자 정산서 수정 -->
			<xf:submission id="sbm_updateDomTripAd" ref='data:json,dma_tripAd' target='' action="SvcCCSCTRDADU01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 결재 후 담당자 저장 -->
			<xf:submission id="sbm_saveAttach" ref="data:json,dma_trip" target='' action="SvcCCSCOMU01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		<script src="/cm/js/biz/ccs.js" cache="false" />
		<script type="text/javascript" lazy="false"><![CDATA[
	/****************************************************
	 * 화면 설명 : 국내출장정산
	 * 변경 이력 : 2022-11-02	이영희	최초 작성
	 * serviceId : C321
	 ****************************************************/
	/**
	* 페이지 로딩 이벤트
	*/
	scwin.data={
		excessType : "N", // 숙박비 초과여부
		lodgYn : "N",
		typeCode : "C321",
		isChangeFlag : false,
		lodg_rmk : "서울특별시 100,000원 / 광역시 80,000원 / 그 밖의 지역 70,000원"
	};
	
	scwin.onpageload = function() {
		// 첨부파일 컴포넌트 초기화
		com.file.init();
		
		// 초기화
		grp_excess.hide();
		grp_rep.hide(); // 복명내역
		grp_slipInfo.hide();
		grp_airMile.setDisabled(true); // 마일리지 신고번호그룹
		btn_mngSave.hide();
		
		// 공통코드
		var codeOptions = [ { code : "FBQ", compID :"sbx_chng_resn" } // 변경사유
		 				   ,{ code : "FDO", compID :"sbx_car_use" }     // 원차량목록
		                   ,{ code : "FBV", compID :"sbx_goal_clsf" }	// 출장목적
		                   ,{ code : "FBG", compID :"grd_compn:posi_clsf" } // 직급구분
		                   ,{ code : "FBH", compID :"grd_compn:biztrip_psn_clsf" }	// 동반자구분	
		                   ,{ code : "FAU", compID :"grd_path:start_region,grd_path:arriv_region" }	// 출발지 및 도착지
		                   ,{ code : "FAA", compID :"grd_pay:bank_cd" }	
		                   ,{ code : "CAD", compID :"grd_expns:fare_clsf" }	
		                   ,{ code : "CAG", compID :"grd_expns:lodg_clsf" }	// 숙박구분
		                   ,{ code : "FBQ", compID :"sbx_chng_resn" } // 변경사유
		                ];		
		com.setCmnCd(codeOptions, function() {
			// parameter
			var param = com.getParameter();
			if(!com.isEmpty(param.openerTabId)){
				scwin.data.openerTabId = param.openerTabId;
			}

			if(param.param4 == "apr"){
				if(param.req_no.substring(0, 3) != "C87"){					
					dma_search.set("biztrip_req_no", param.req_no);
					
					com.execute(sbm_selectExistYn, {
						successCallback : function(e){
							if(e.responseJSON.req_no == undefined){
								scwin.searchTripInfo(); // 출장번호로 출장정보 조회
							}else{
								dma_search.set("req_no", e.responseJSON.req_no);	
								scwin.search();	
							}
						}
					});
					
				}else{
					dma_search.set("req_no", param.req_no);
					scwin.search();	
				}
			}else{
				dma_search.setJSON(param);
				
				if(dma_search.get("req_no") != ""){
					scwin.search();	
				}else{					
					// 첨부파일 번호가 생성될 때 lock이 발생하는 경우가 있어서 순차적으로 생성
					com.file.create(upload_A.getID(), {fileKey: scwin.data.typeCode, mode: 'edit'}, function(){
						com.file.create(upload_B.getID(), {fileKey: scwin.data.typeCode, mode: 'edit'});
					});	
					
					if(dma_search.get("biztrip_req_no") != ""){
						dma_search.set("biztrip_req_no", param.biztrip_req_no);
						scwin.searchTripInfo(); // 출장정보 조회
					}else{
						btn_tripReq.setDisabled(false);
						btn_tripReq.trigger("click");
					}
				}
			}
		});		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/**
	 * 폼 셋팅
	 */
	scwin.setForm = function(tripAdVo){
		// 출장비 없음으로 신청했을 경우
		if(dma_tripAd.get("no_trvel_expns") == "Y"){			
			grp_accnt.hide();
			grp_pay.hide();
			btn_oneTrip.hide(); // 당일출장 버튼
			
			grd_expns.setColumnReadOnly("fare_fee", true);
			grd_expns.setColumnReadOnly("fare_fee_pay", true);
			grd_expns.setColumnReadOnly("lodg_fee", true);
			grd_expns.setColumnReadOnly("lodg_fee_pay", true);
			grd_expns.setColumnReadOnly("ymd_fee", true);
			grd_expns.setColumnReadOnly("ymd_fee_pay", true);
			grd_expns.setColumnReadOnly("meal_fee", true);
			grd_expns.setColumnReadOnly("meal_fee_pay", true);
		}
		
		if(dma_tripAd.get("truth_biztrip_goal_cd") == "FBV150"){
			btn_oneTrip.hide();
		}else{
			if(dma_tripAd.get("truth_biztrip_goal_cd") == "FBV920" 
				|| (com.isNotEmpty(tripAdVo) && tripAdVo.truth_biztrip_goal_cd == "FBV920") ) {
					
				// FBV920 일때 selectBox 내에 없으므로 responseBody 에서 꺼내어야함
				sbx_goal_clsf.addItem("FBV920", "현장출장(기술)", 0, true);
				sbx_goal_clsf.setValue("FBV920");
				sbx_goal_clsf.setDisabled(true);
			}
			
			if(dma_tripAd.get("biztrip_day") == "1"){ // 당일출장버튼 활성화
				btn_oneTrip.setDisabled(false);
			}
		}
		
		if(dma_tripAd.get("biztrip_nght") > '0' && dma_tripAd.get("excess_resn_cd") != ""){			
			scwin.data.excessType = "Y";			
		}else{
			scwin.data.excessType = "N";
		}
		
		// (당일출장이면서 변경없음) 또는 취소인 경우 복명내역 숨김처리
		if((dma_tripAd.get("biztrip_nght") > '0' || dma_tripAd.get("chng_resn") != "FBQ990") && dma_tripAd.get("chng_resn") != "FBQ020"){
			grp_rep.show("");
			scwin.data.isChangeFlag = true;
		}
		
		
		// 결의서 정보 보여주기
		if(dlt_accnt.getRowCount() > 0){
			grp_slipInfo.show("");	
			
			if(dma_tripAd.get("slip_ymd").trim() == ""){
				dma_tripAd.set("slip_ymd", com.getServerDateTime());
			}
			
			for(var i=0; i<dlt_accnt.getRowCount(); i++){
				grd_accnt.setCellColor(i, "tax_cd_nm", (dlt_accnt.getCellData(i, "tax_cd_nm") == "과세")? "red" : "#333");	
			}
		}
		
		if(dma_tripAd.get("unslip_no") != ""){
			btn_print.setDisabled(false);
		}
		
		// 첨부파일 셋팅
		var vMode = "edit";
		if(dma_tripAd.get("apr_state") >= "XAD020"){
			btn_oneTrip.setDisabled(true);
			
			ica_start_dt.setDisabled(true);		// 복명 출장기간(시작일)
			ica_end_dt.setDisabled(true);		// 복명 출장기간(종료일)
			
			sbx_car_use.setDisabled(true);		// 원차량사용
			sbx_biztrip_way.setDisabled(true);	// 운임구분
							
			grd_path.setDisabled(true);
			grd_compn.setDisabled(true);
			grd_expns.setDisabled(true);
			grd_accnt.setDisabled(true);
			grp_accnt.setDisabled(true);
				
			// 1006206 출장담당자, 1006205 총무담당자, 1006273 외부강의담당자
			if (/1006206|1006205|1006273/.test(com.getLoginInfo('roleCode'))) {
				btn_mngSave.show(""); // 담당자 저장 버튼 보이도록 수정				
			}else{
				vMode = "view";
			}
		}
		
		var attachFileNo_A = dma_tripAd.get("evid_attach_file_no"); // 복명증빙
		var attachFileNo_B = dma_tripAd.get("attach_file_no"); // 첨부화일(숙박증빙)		
		var objs = [
			{uploadId:upload_A.getID(), fileKey : (attachFileNo_A == "")? scwin.data.typeCode : attachFileNo_A, mode: vMode}, // 복명증빙
			{uploadId:upload_B.getID(), fileKey : (attachFileNo_B == "")? scwin.data.typeCode : attachFileNo_B, mode: vMode}, // 첨부화일(숙박증빙)			
		];
//		debugger;
		com.file.createMulti(objs, objs.shift(), function() {
		});		
				
		// 숙박비초과사유
		if(dma_tripAd.get("excess_resn_cd").trim() != "" && dma_tripAd.get("biztrip_nght") > '0'){
			grp_excess.show("");
		}else{
			grp_excess.hide();					
		}
		
		// 경로 첫행 disalbe
		grd_path.setCellDisabled(0, "chk", true);
		
		// 출장경비 
		if(dma_tripAd.get("expns_cnt") > '0'){					
			if(dma_tripAd.get("car_use_yn") != "FDO001"){ // 차량사용할 경우
				grd_expns.setColumnReadOnly("fare_fee", true);
				grd_expns.setColumnReadOnly("fare_fee_pay", true);
				grd_expns.setColumnReadOnly("ymd_fee", true);
				grd_expns.setColumnReadOnly("ymd_fee_pay", true);
				
				grd_expns.setColumnColor("fare_fee_rmk", "blue");
				grd_expns.setColumnColor("ymd_fee_rmk", "blue");
			}
		}
		
		// 항공마일리지
		if(/exprss|exMile/.test(dma_tripAd.get("biztrip_way"))){
			grp_airMile.setDisabled(false);
		} 
		
		if(dma_tripAd.get("biztrip_way") != "train"){
			sbx_car_use.setDisabled(true);
		}				
	};
	
	/**
	 * 정산정보 조회
	 */
	scwin.search = function(){
		com.execute(sbm_selectData, {
			successCallback : function(e){
				// 결재상태에 따른 버튼 제어
				var aprState = dma_tripAd.get("apr_state");
				com.biz.disabledButtons(aprState, dma_tripAd.get("req_no"));
						
				
				btn_tripReq.setDisabled(true);
				
				// form setting
				scwin.setForm(e.responseJSON.elData.tripAdVo);
				
				// GPS 정보
				scwin.getNstGpsData();
			}
		});
	};
	
	/**
	 * 출장경비 셋팅(운임구분 변경 후)
	 */
	scwin.setGrdExpns = function(){
		var biztripWay = sbx_biztrip_way.getValue();

		for(var i=0; i<dlt_expns.getRowCount(); i++){
			if(/exprss|exMile/.test(biztripWay)){ // 항공, 항공마일리지
				dlt_expns.setCellData(i, "fare_clsf", "CAD004"); // 항공
				dlt_expns.setCellData(i, "fare_fee_max", 0);
				dlt_expns.setCellData(i, "fare_fee", 0);
				dlt_expns.setCellData(i, "fare_fee_pay", 0);
				dlt_expns.setCellData(i, "fare_fee_rmk", "실비정산(항공) / 항공권은 법인카드, 연구비카드 등으로 처리(항공권 개인카드 처리 불가)");	
					
				if(dma_tripAd.get("car_use_yn") != "FDO001"){
					grd_expns.setCellDisabled(i, "fare_fee_pay", true);
					grd_expns.setCellDisabled(i, "fare_fee", true);		
					grd_expns.setCellDisabled(i, "ymd_fee_pay", true);
					grd_expns.setCellDisabled(i, "ymd_fee", true);	
				}else{
					grd_expns.setCellDisabled(i, "fare_fee_pay", false);
					grd_expns.setCellDisabled(i, "fare_fee", false);
					grd_expns.setCellDisabled(i, "ymd_fee_pay", false);
					grd_expns.setCellDisabled(i, "ymd_fee", false);	
				}
			}else if(biztripWay == "vessel"){
				dlt_expns.setCellData(i, "fare_clsf", "CAD004"); // 선박
				dlt_expns.setCellData(i, "fare_fee_max", 0);
				dlt_expns.setCellData(i, "fare_fee", 0);
				dlt_expns.setCellData(i, "fare_fee_pay", 0);
				dlt_expns.setCellData(i, "fare_fee_rmk", "실비정산(선박)");
			}else if(biztripWay == "train"){				
				dlt_expns.setCellData(i, "fare_clsf", "CAD001"); // 대중교통
				scwin.makeFareFeeRmk();
			}else{
				if(dma_tripAd.get("car_use_yn") != "FDO001"){
					dlt_expns.setCellData(i, "fare_clsf", "CAD003"); // 원차량
					
					grd_expns.setCellDisabled(i, "fare_fee", true);
					grd_expns.setCellDisabled(i, "ymd_fee", true);
					grd_expns.setCellDisabled(i, "fare_fee_pay", true);
					grd_expns.setCellDisabled(i, "ymd_fee_pay", true);
				}else{
					dlt_expns.setCellData(i, "fare_clsf", "CAD001"); // 대중교통
					
					grd_expns.setCellDisabled(i, "fare_fee", false);
					grd_expns.setCellDisabled(i, "ymd_fee", false);
					grd_expns.setCellDisabled(i, "fare_fee_pay", false);
					grd_expns.setCellDisabled(i, "ymd_fee_pay", false);
				}
			}
		}		
	};
	
	/**
	 * 카드식 셋팅
	 */
	scwin.idx_biztrip_day_onchange = function(info) {
		dlt_cardMeal.removeAll();		
		
		var maxMeal = WebSquare.util.parseInt(info.newValue, 0) * 3 + 1;
		for(var i=0; i< maxMeal; i++){
			dlt_cardMeal.setRowJSON(i, {"label" : i, "value":i}, false);	
		}
		dlt_cardMeal.reform();
		
		if(info.newValue == "1"){
			btn_oneTrip.setDisabled(false);
			btn_apr.setDisabled(true);
		}else{
			btn_oneTrip.setDisabled(true);
			btn_apr.setDisabled(false);
		}
	};
	
	/**
	 * 운임구분 변경 이벤트
	 */
	scwin.sbx_biztrip_way_onviewchange = function(info) {
		if(info.newValue == "exMile"){
			alert("<운임 구분 : 항공(마일리지) 운임은 마일리지를 활용하여 항공권을 구입한 경우 선택이 가능합니다.> \n 관련 : 공무 항공마일리지 운영지침 제7조(일비의 추가지급)");
		}
		
		if(/exprss|exMile/.test(info.newValue)){
			grp_airMile.setDisabled(false);
		}else{
			grp_airMile.setDisabled(true);
		} 
		
		if(info.newValue =="train"){
			sbx_car_use.setDisabled(false);
		}else{
			sbx_car_use.setDisabled(true);
			sbx_car_use.setValue("FDO001");
		}
		
		// 출장경비내역 셋팅
		scwin.setGrdExpns();
		
		// 식비, 일비, 숙박비 셋팅
		scwin.setTripEtcExpns();
	};
	
	/**
	 * 출장경로 변경 이벤트
	 */
	scwin.grd_path_onviewchange = function(info) {
		var row = info.rowIndex;
		var colId = grd_path.getColumnID(info.colIndex);
		var rowCnt = dlt_path.getRowCount();
		
		// 출장일자 체크
		if(!com.validateData(dma_tripAd
				, [{ id : "truth_orign_ymd", mandatory : true},{ id : "truth_cls_ymd", mandatory : true}]
				, false
			)){
			dlt_path.setCellData(row, colId, "");
			return;
		};			
		
		if(colId == "start_region"){
			if(dlt_path.getRowCount() > 1){
				dlt_path.setCellData(rowCnt-1, "arriv_region", info.newValue);
			}
			
		}else if(colId == "arriv_region"){
			if(row == 0 && info.newValue == dlt_path.getCellData(row, "start_region")){
				alert("출발지와 도착지가 같습니다.");
			}else{
				if(row +1 == rowCnt){
					var data ={
						start_region : info.newValue,
						arriv_region : dlt_path.getCellData(0, "start_region"),
						lodg_yn : 0	
					};				
					dlt_path.setRowJSON(rowCnt, data, false);				
				}else{
					dlt_path.setCellData(row+1, "start_region", info.newValue);
				}	
			}				
		}		
		
		// 출발지, 도착지, 직급구분이 변경되었을 경우 금액 재계산
		if(/start_region|arriv_region/.test(colId)){
			var val = (colId == "start_region")? dlt_path.getCellData(row, "arriv_region") : dlt_path.getCellData(row, "start_region");
			
			// 제주 지역 내의 출장이 아니고 출발지 또는 도착지에 제주가 포함되었다면 출장경로 항공으로 변경			
			var oldVal = sbx_biztrip_way.getValue();	
			if(info.newValue != val){
				if(info.newValue == "FAU059"){
					sbx_biztrip_way.setValue("exprss");
				}else{
					if(dlt_path.getMatchedIndex("start_region", "FAU059", true).length > 0 || dlt_path.getMatchedIndex("arriv_region", "FAU059", true).length > 0){
						sbx_biztrip_way.setValue("exprss");
					}else{
						sbx_biztrip_way.setValue("train");
					}
				}
			}
			
			if(oldVal != sbx_biztrip_way.getValue()){
				scwin.sbx_biztrip_way_onviewchange({newValue : sbx_biztrip_way.getValue()});
			}
	
			if(dlt_path.getCellData(row, "start_region") != dlt_path.getCellData(row, "arriv_region")){
				if(info.oldValue != info.newValue && val != ""){
					scwin.getFareFee();
				}
			}else{
				dlt_path.setCellData(row, "rmk", "0(운임없음)");
				dlt_path.setCellData(row, "biztrip_fee", 0);
			}
		}
		
		// 출장경로 삭제 버튼 컨트롤
		scwin.gridPathView();	
	};
	
	/**
	 * 출장 경로 클릭 이벤트
	 */
	scwin.grd_path_oncellclick = function(row,col,colId) {
		if(colId == "lodg_plus" || colId == "lodg_minus"){
			var lodgYn = com.parseInt(dlt_path.getCellData(row, "lodg_yn"));
			var nght = com.parseInt(dma_tripAd.get("biztrip_nght"));
			if(nght ==0) return;
			
			var sumLodgYn = 0;
			for(var i=0; i<dlt_path.getRowCount(); i++){
				sumLodgYn += com.parseInt(dlt_path.getCellData(i, "lodg_yn"));
			}
			
			if(colId == "lodg_plus"){
				if(sumLodgYn < nght){
					lodgYn++;
				}
			}else{
				if(lodgYn > 0){
					lodgYn--;
				}
			}
			dlt_path.setCellData(row, "lodg_yn", lodgYn);
			
			// 숙박비 계산
			scwin.calcLodgFee();
			
			// 계정금액 재계산
			scwin.setAccntTotExpns();
			
			// 지급금액 계산
			scwin.setPayAdjstAmt();
			
		}else if(colId =="chk"){
			grd_path.setCellChecked(row , colId, true); // 체크되는 시점이 이벤트 발생 시점 뒤여서 미리 체크
			var chkArr = grd_path.getCheckedIndex(colId);
			var rCnt = grd_path.getRowCount();
			
			if (chkArr.length == 1) {
				var chkIdx = chkArr[0];	// 1개만 체크되는 radio특성상 0번째 인덱스만 사용
				if(chkIdx == 0 || chkIdx == (rCnt-1)) {
					com.alert("message.xom.ui.ccs.027"); // 경로 삭제는 출발지와 도착지를 제외한 중간 경로만 삭제 가능합니다.
					grd_path.setCellChecked(row , colId, false);
				} 
			} else if(chkArr.length > 1){
				com.alert("출장경로 [선택]란이 중복 체크되었습니다.");
				for(var i=0; i<rCnt; i++){
					grd_path.setCellChecked(i , colId, false);
				}
			}
		}
	};	
	
	/**
	 * 운임 재조회
	 */
	scwin.getFareFee = function(){		
		dlt_path.setCellData(0, "posi_clsf", dlt_compn.getCellData(0, "posi_clsf"));
		
		com.execute(sbm_selectFareFee, {
			successCallback : function(e){	
				dlt_path.setJSON(e.responseJSON.ctrDomPathVoList);
				// 출장경비: 운임 비고 생성
				scwin.makeFareFeeRmk();
				
				// 기타경비 계산
				scwin.getEtcFee();
			}
		});
	}
	
	/**
	 * 기타경비 조회
	 */	
	scwin.getEtcFee = function(){
		dma_search.set("posi_clsf", dlt_compn.getCellData(0, "posi_clsf"));
		dma_search.set("start_region", dlt_path.getCellData(dlt_path.getRowCount()-1, "start_region"));
		
		com.execute(sbm_selectEtcFee, {
			successCallback : function(e){
				// 기타경비 셋팅
				scwin.setTripEtcExpns();
			}
		});
	};
	
	/**
	 * 운임경비 및 비고 계산
	 */
	scwin.makeFareFeeRmk = function(){
		if(dma_tripAd.get("no_trvel_expns") == "Y") return;
		
		// 총 운임비 및 비고 생성
		var totFareFee = 0;
		var rmks = [];
		for(var i=0; i<dlt_path.getRowCount(); i++){
			// 도착지가 설정되어있지 않으면 생성하지 않음
			if(dlt_path.getCellData(i, "arriv_region") == ""){
				return;	
			}
			
			totFareFee += Number(dlt_path.getCellData(i, "biztrip_fee"));
			rmks.push(dlt_path.getCellData(i, "rmk"));
		}
		
		for(var i=0; i<dlt_expns.getRowCount(); i++){
			if(!/exprss|vessel|exMile/.test(sbx_biztrip_way.getValue())){ // 항공, 선박, 마일리지
				if(sbx_car_use.getValue() != "FDO001"){
					dlt_expns.setCellData(i, "fare_fee_rmk", "=" +  rmks.join(" + ") + " ※ 원차량 흡수");
				}else{
					var ngt = Number(dma_tripAd.get("biztrip_nght"));
					var day = Number(dma_tripAd.get("biztrip_day"));
					// 무박 1일 초과면 운임비 X 일수
					if(ngt ==0 && day > 1){
						totFareFee = totFareFee*day;						
					}					
					dlt_expns.setCellData(i, "fare_fee_rmk", "="+ rmks.join(" + ") + ((ngt ==0 && day>1)? " X " + day + "일" : ""));
				}
				dlt_expns.setCellData(i, "fare_fee_max", totFareFee);
				dlt_expns.setCellData(i, "fare_fee", totFareFee);
				dlt_expns.setCellData(i, "fare_fee_pay", totFareFee);
			}
		}
	}
	
	/**
	 * 식비, 일비, 숙박비 셋팅
	 */	
	scwin.setTripEtcExpns = function(row){
		if(dma_tripAd.get("no_trvel_expns") == "Y") return;
		
		var start = 0;
		var end = dlt_expns.getRowCount();
		if(row != undefined){
			start = row;
			end = row+1;
		}
		
		var day = com.parseInt(dma_tripAd.get("biztrip_day"));
		var ngt = com.parseInt(dma_tripAd.get("biztrip_nght"));				
		
		// 출장일자가 없으면 리턴
		if(day == 0) return;
		
		var ymdFee = Number(dma_etcFee.get("ymd_fee"));
		var mealFee = Number(dma_etcFee.get("meal_fee"));
		// 2023.04.01. 이전은 20000원임
		if(ica_end_dt.getValue() < "20230401"){
			ymdFee = 20000;
			mealFee = 20000;
		}
				
		var tmp =0;
		for(var i=start; i< end; i++){
			// 출장자 출장취소 체크
			if(dlt_compn.getCellData("chng_clsf") == "1"){
				continue;
			}
			
			if(sbx_car_use.getValue() != "FDO001"){
				// 1.일비처리
				if(dma_tripAd.get("biztrip_way") == "exMile"){
					tmp = ymdFee * 1.5 * day; 
					dlt_expns.setCellData(i, "ymd_fee_rmk", "= " + com.formatMoney(ymdFee* 1.5) + "(일비/2) X " + day + "(일) : 일비50%지급 / 항공마일리지 사용 일비 증액" );
				}else{
					tmp = ymdFee * day; 
					dlt_expns.setCellData(i, "ymd_fee_rmk", "= " + com.formatMoney(ymdFee) + "(일비/2) X " + day + "(일) : 일비50%지급" );
				}
			}else{
				if(dma_tripAd.get("biztrip_way") == "exMile"){
					tmp = ymdFee * 1.5 * day; 
					dlt_expns.setCellData(i, "ymd_fee_rmk", "= " + com.formatMoney(ymdFee* 1.5) + "(일비) X " + day + "(일) / 항공마일리지 사용 일비 증액" );
				}else{
					tmp = ymdFee * day; 
					dlt_expns.setCellData(i, "ymd_fee_rmk", "= " + com.formatMoney(ymdFee) + "(일비) X " + day + "(일)" );
				}
			}			
			dlt_expns.setCellData(i, "ymd_fee_max", tmp);
			dlt_expns.setCellData(i, "ymd_fee", tmp);
			dlt_expns.setCellData(i, "ymd_fee_pay", tmp);
			
			// 3. 식비 처리: 카드식 처리
			dlt_expns.setCellData(i, "meal_fee_max", mealFee * day);
			scwin.setMealFee(dlt_expns.getCellData(i, "card_meal"), i);			
			
			// 2. 숙박비 비고
			if(ngt == 0 && day > 1){
				dlt_expns.setCellData(i, "lodg_fee_rmk", "= 교육출장으로 인한 숙박 제외"); 
			}else{
				dlt_expns.setCellData(i, "lodg_fee_rmk", "= 숙박비 정산 시 실비지급 (※상한금액: " + scwin.data.lodg_rmk + ")"); 
			}
		}
		
		// 총액 재계산 및 계정내역 금액 계산
		scwin.setAccntTotExpns();
		
		// 지급금액 계산
		scwin.setPayAdjstAmt(row);	
	}
	
	/**
	 * 식비 계산
	 */	
	scwin.setMealFee = function(cardMeal, row){
		if(dma_tripAd.get("no_trvel_expns") == "Y") return;
		
		var cardCnt = com.parseInt((cardMeal=="")?"0":cardMeal);
		var day = com.parseInt(dma_tripAd.get("biztrip_day"));
		
		var mealFee = Number(dma_etcFee.get("meal_fee"));
		if(ica_end_dt.getValue() < "20230401"){
			mealFee = 20000;
		}

		// 일의자리에서 버림
		var tmp = Math.floor(mealFee * cardCnt/(3*10)) * 10; 
		// 조정된 식비
		var calcFee = mealFee * day - tmp;
		
		var mealFeeRmk = "= " + com.formatMoney(mealFee) + "(식비) X " + day + "(일)";
		dlt_expns.setCellData(row, "meal_fee", (calcFee < 0)? 0 : calcFee);
		dlt_expns.setCellData(row, "meal_fee_pay", (calcFee < 0)? 0 : calcFee);
		
		if(cardCnt > 0){				
			dlt_expns.setCellData(row, "meal_fee_rmk", mealFeeRmk +" - ("+ com.formatMoney(mealFee) +"/3) X "+ cardCnt +"식");
		}else{
			dlt_expns.setCellData(row, "meal_fee_rmk", mealFeeRmk);
		}
	};
	
	/**
	 * 출장경비 초기화
	 */	
	scwin.clearGrdExpns = function(row){
		dlt_expns.setCellData(row, "fare_fee_max", 0);
		dlt_expns.setCellData(row, "lodg_fee_max", 0);
		dlt_expns.setCellData(row, "ymd_fee_max", 0);
		dlt_expns.setCellData(row, "meal_fee_max", 0);
		
		dlt_expns.setCellData(row, "fare_fee", 0);		
		dlt_expns.setCellData(row, "lodg_fee", 0);
		dlt_expns.setCellData(row, "ymd_fee", 0);
		dlt_expns.setCellData(row, "meal_fee", 0);
		
		dlt_expns.setCellData(row, "fare_fee_pay", 0);
		dlt_expns.setCellData(row, "lodg_fee_pay", 0);
		dlt_expns.setCellData(row, "ymd_fee_pay", 0);
		dlt_expns.setCellData(row, "meal_fee_pay", 0);
		
		dlt_expns.setCellData(row, "sum_trip_fee", 0);
		dlt_expns.setCellData(row, "sum_trip_fee_max", 0);
		dlt_expns.setCellData(row, "sum_trip_fee_pay", 0);
		
		// 총액 셋팅
		scwin.setAccntTotExpns();	
						
		// 지급금액 계산
		scwin.setPayAdjstAmt();	
	}
	
	/**
	 * 총액 재계산 및 계정내역 금액 계산
	 */
	scwin.setAccntTotExpns = function(){
		if(dma_tripAd.get("no_trvel_expns") == "Y") return;
		
		// 운임 + 일비 + 숙박비 + 식비 + 기타
		var fareFee = 0;
		var lodgFee = 0;
		var ymdFee = 0;
		var mealFee = 0;
		for(var i=0; i<dlt_expns.getRowCount(); i++){
			fareFee += Number(dlt_expns.getCellData( i , "fare_fee_pay" ));
			lodgFee += Number(dlt_expns.getCellData( i , "lodg_fee_pay" ));
			ymdFee += Number(dlt_expns.getCellData( i , "ymd_fee_pay" ));
			mealFee += Number(dlt_expns.getCellData( i , "meal_fee_pay" ));
		}
		
		var totSum = fareFee + lodgFee + ymdFee + mealFee;		
		
		var rowCnt = dlt_accnt.getRowCount();		
		var totExpns = Math.round(totSum / rowCnt);
		for(var i=0; i < rowCnt; i++){			
			dlt_accnt.setCellData(i, "tot_expns", totExpns);
			if(dma_tripAd.get("cud_type") == "C"){
				dlt_accnt.setCellData(i, "cud_type", "C");
			}
		}		
	};
	
	/**
	 * 지급 금액 계산
	 */
	scwin.setPayAdjstAmt = function(row){
		if(dma_tripAd.get("no_trvel_expns") == "Y") return;
		
		var start = 0;
		var end = dlt_pay.getRowCount();
		if(row != undefined){
			start = row;
			end = row+1;	
		}
		
		var totSum = 0;
		var totSumPay = 0;
		
		var fareFee = 0;
		var lodgFee = 0;
		var ymdFee = 0;
		var mealFee = 0;
		
		var fareFeePay = 0;
		var lodgFeePay = 0;
		var ymdFeePay = 0;
		var mealFeePay = 0;
		for(var i=start; i<end; i++){
			fareFee = Number(dlt_expns.getCellData(i, "fare_fee"));
			lodgFee = Number(dlt_expns.getCellData(i, "lodg_fee"));
			ymdFee = Number(dlt_expns.getCellData(i, "ymd_fee"));
			mealFee = Number(dlt_expns.getCellData(i, "meal_fee"));
			
			fareFeePay = Number(dlt_expns.getCellData(i, "fare_fee_pay"));
			lodgFeePay = Number(dlt_expns.getCellData(i, "lodg_fee_pay"));
			ymdFeePay = Number(dlt_expns.getCellData(i, "ymd_fee_pay"));
			mealFeePay = Number(dlt_expns.getCellData(i, "meal_fee_pay"));
		
			totSum = fareFee + lodgFee + ymdFee + mealFee;
			totSumPay = fareFeePay + lodgFeePay + ymdFeePay + mealFeePay;
					
			dlt_pay.setCellData(i, "truth_use_amt", totSum);
			if(dma_tripAd.get("car_use_yn") != "FDO001"){
				dlt_pay.setCellData(i, "adjst_amt", totSumPay - fareFee - ymdFeePay/2);
			}else{
				dlt_pay.setCellData(i, "adjst_amt", totSumPay);
			}
		}
	}
	
	/**
	 * 출장경로 삭제 버튼 컨트롤
	 */	
	scwin.gridPathView = function(){
		if(dlt_path.getRowCount() > 2){
			btn_path_del.show("");
		}else{
			if(dlt_path.getRowCount() == 2){
				if(dlt_path.getCellData(0, "start_region") == dlt_path.getCellData(0, "arriv_region")){
					dlt_path.removeRow(1);
				}
			}
			btn_path_del.hide();
		}
		
		// 출장경로 첫행, 3단계 이상 경로인 경우 마지막 행 삭제 체크 불가 처리
		// 출장경로 마지막 행의 출발지는 수정 불가
		var rowCnt = dlt_path.getRowCount();
		if(rowCnt > 1){
			grd_path.setCellReadOnly(rowCnt-1, "start_region", true);	
		}
	};
	
	/**
	 * 차량사용 변경 이벤트
	 */
	scwin.sbx_car_use_onviewchange = function(info) {
		if(dma_tripAd.get("car_use_yn") != "FDO001"){ // 차량사용할 경우			
			grd_expns.setColumnColor("fare_fee_rmk", "blue");
			grd_expns.setColumnColor("ymd_fee_rmk", "blue");			
			
			grd_expns.setColumnReadOnly("fare_fee_pay", true);
			grd_expns.setColumnReadOnly("ymd_fee", true);			
			
			if(/exprss|exMile/.test(sbx_biztrip_way.getValue())){
				grd_expns.setColumnReadOnly("fare_fee", false);
				grd_expns.setColumnReadOnly("ymd_fee_pay", false);
			}else{
				grd_expns.setColumnReadOnly("fare_fee", true);
				grd_expns.setColumnReadOnly("ymd_fee_pay", true);
			}
			
			// 지급금액 재설정
			scwin.setPayAdjstAmt()
		}else{
			grd_expns.setColumnColor("fare_fee_rmk", "#333");
			grd_expns.setColumnColor("ymd_fee_rmk", "#333");
			
			grd_expns.setColumnReadOnly("fare_fee", false);
			grd_expns.setColumnReadOnly("fare_fee_pay", false);
			grd_expns.setColumnReadOnly("ymd_fee", false);
			grd_expns.setColumnReadOnly("ymd_fee_pay", false);
			
			// 지급금액 재설정
			scwin.setPayAdjstAmt()
		}
		
		// 출장경비 셋팅
		scwin.setGrdExpns();
	};
	
	/**
	 * 복명 출장시작일자 변경 이벤트
	 */
	scwin.ica_start_dt_onviewchange = function(info) {
		scwin.changeBizTripDay();
	};
	
	/**
	 * 복명 출장종료일자 변경 이벤트
	 */
	scwin.ica_end_dt_onviewchange = function(info) {
		if(info.newValue == ""){
			com.alert(com.getMsg("message.xom.co.com.0003", "복명 출장종료일자"));
			ica_end_dt.setValue(info.oldValue);
			return;
		}
		
		scwin.changeBizTripDay(this.getValue());
	};
	
	/**
	 * 출장일자 변경 이벤트
	 */
	scwin.changeBizTripDay = function(ymd){
		if(dma_tripAd.get("truth_orign_ymd") == "" || dma_tripAd.get("truth_cls_ymd") == ""){
			return;
		}		
		
		// 박일 계산
		var day = com.diffDate(dma_tripAd.get("truth_orign_ymd"), dma_tripAd.get("truth_cls_ymd"));
		
		// 일자 변경시 숙박횟수 및 숙박비 초기화
		if(day != dma_tripAd.get("biztrip_nght")){
			for(var i=0; i<dlt_path.getRowCount(); i++){
				dlt_path.setCellData(i, "lodg_yn", 0);
			}
			
			for(var i=0; i<dlt_expns.getRowCount(); i++){
				dlt_expns.setCellData(i, "lodg_fee_max", 0);
				dlt_expns.setCellData(i, "lodg_fee", 0);
				dlt_expns.setCellData(i, "lodg_fee_pay", 0);

				grd_expns.setCellDisabled(i, "lodg_clsf", day == "0");
				grd_expns.setCellDisabled(i, "lodg_fee", day == "0");
				grd_expns.setCellDisabled(i, "lodg_fee_pay", day == "0");
				grd_expns.setCellDisabled(i, "lodg_card_yn", day == "0");
			}
		}
		
		dma_tripAd.set("biztrip_nght", day);
		dma_tripAd.set("biztrip_day", com.parseInt(day)+1);		
				
		
		// 동반자 출장일자 및 출장밤, 낮 셋팅
		scwin.setCompnGrid();
		
		if(com.parseInt(dma_etcFee.get("ymd_fee")) == 0){
			// 기타경비조회
			scwin.getEtcFee();
		}else{
			// 기타경비 계산
			scwin.setTripEtcExpns();				
		}
		
		// 위치정보 조회
		scwin.getNstGpsData();
	};	
	
	/**
	 * 출장신청번호로 조회 후 출장비내역 구하기
	 */
	scwin.getFirstExpns = function(){
		// 출장비 없음으로 신청했을 경우
		if(dma_tripAd.get("no_trvel_expns") == "Y"){			
			grp_accnt.hide();
			grp_pay.hide();
			btn_oneTrip.hide(); // 당일출장 버튼
			
			grd_expns.setColumnReadOnly("fare_fee", true);
			grd_expns.setColumnReadOnly("fare_fee_pay", true);
			grd_expns.setColumnReadOnly("lodg_fee", true);
			grd_expns.setColumnReadOnly("lodg_fee_pay", true);
			grd_expns.setColumnReadOnly("ymd_fee", true);
			grd_expns.setColumnReadOnly("ymd_fee_pay", true);
			grd_expns.setColumnReadOnly("meal_fee", true);
			grd_expns.setColumnReadOnly("meal_fee_pay", true);		
			
			for(var i=0; i<dlt_expns.getRowCount(); i++){
				dlt_expns.setCellData(i, "lodg_clsf", "CAG001");
				dlt_expns.setCellData(i, "lodg_fee_max", 0);
				dlt_expns.setCellData(i, "lodg_fee", 0);
				dlt_expns.setCellData(i, "lodg_fee_pay", 0);				
				
				dlt_expns.setCellData(i, "fare_clsf", "CAD001"); 
				dlt_expns.setCellData(i, "fare_fee_max", 0);
				dlt_expns.setCellData(i, "fare_fee", 0);
				dlt_expns.setCellData(i, "fare_fee_pay", 0);
				
				dlt_expns.setCellData(i, "ymd_fee_max", 0);
				dlt_expns.setCellData(i, "ymd_fee", 0);
				dlt_expns.setCellData(i, "ymd_fee_pay", 0);

				dlt_expns.setCellData(i, "meal_fee_max", 0);
				dlt_expns.setCellData(i, "meal_fee", 0);
				dlt_expns.setCellData(i, "meal_fee_pay", 0);
			}
					
		}else{		
			if(dma_tripAd.get("biztrip_nght") == '0' && dma_tripAd.get("biztrip_day") > '1'){	
				for(var i=0; i<dlt_path.getRowCount(); i++){
					dlt_path.setCellData(i, "lodg_yn", 0);
				}
			}
			
			for(var i=0; i<dlt_expns.getRowCount(); i++){
				dlt_expns.setCellData(i, "lodg_clsf", "CAG001");
				dlt_expns.setCellData(i, "lodg_fee_max", 0);
				dlt_expns.setCellData(i, "lodg_fee", 0);
				dlt_expns.setCellData(i, "lodg_fee_pay", 0);
				
				if(dma_tripAd.get("biztrip_nght") == "0"){
					grd_expns.setCellDisabled(i, "lodg_clsf", true);
					grd_expns.setCellDisabled(i, "lodg_fee", true);
					grd_expns.setCellDisabled(i, "lodg_fee_pay", true);
					grd_expns.setCellDisabled(i, "lodg_card_yn", true);
				}
			}
			
			// 출장경비 셋팅
			scwin.setGrdExpns();
					
			// 출장경비내역 
			scwin.makeFareFeeRmk();
			
			// 식비, 일비
			scwin.setTripEtcExpns();
		}
	};
	
	/**
	 * 동반자 변경 이벤트
	 */
	scwin.data.cnt = 0;
	scwin.grd_compn_onviewchange = function(info) {
		var row = info.rowIndex;
		var col = info.colIndex;
		if(grd_compn.getColumnID(col) == "chng_clsf"){
			if(info.newValue == "1"){
				if(scwin.data.cnt == 0 && !/FBQ020|FBQ030/.test(sbx_chng_resn.getValue())){
					alert("출장취소인 경우 [변경사유 : 취소]를 선택하여 주시기 바랍니다.\n휴가일 경우 [변경사유 : 휴가]");
					sbx_chng_resn.focus();
					scwin.data.cnt++;
				}
				scwin.clearGrdExpns(row);
			}else{
				sbx_chng_resn.setValue("FBQ990");
				dma_tripAd.set("chng_contnt", "변경내용없음");
				
				// 숙박비 재계산
				if(dma_tripAd.get("biztrip_nght") > '0'){
					scwin.calcLodgFee();
				}
				
				// 운임 및 비고
				scwin.makeFareFeeRmk();
				// 식비, 일비
				scwin.setTripEtcExpns(row);
			}
		}
	};
	
	/**
	 * 숙박비 재계산
	 */
	scwin.calcLodgFee = function(){
		var sumLodgYn = 0;
		var lodgYn = 0;
		var lodgFeeMax = 0;
		for(var i=0; i<dlt_path.getRowCount(); i++){
			lodgYn = Number(dlt_path.getCellData(i, "lodg_yn"));
			sumLodgYn += lodgYn;
			if(lodgYn > 0){
				// 숙박비 정산 시 실비지급
				lodgFeeMax+= Number(dlt_path.getCellData(i, "lodg_fee_max"))* lodgYn;
			}
		}
		
		for(var i=0; i<dlt_expns.getRowCount(); i++){
			dlt_expns.setCellData(i, "lodg_fee_max", lodgFeeMax);
			dlt_expns.setCellData( i , "lodg_fee", 0);
			dlt_expns.setCellData( i , "lodg_fee_pay", 0);
			
			if(dlt_expns.getCellData(i, "lodg_clsf") == "CAG002"){ // 친지숙박
				dlt_expns.setCellData( i , "lodg_fee", 20000 * sumLodgYn);
				dlt_expns.setCellData( i , "lodg_fee_pay", 20000 * sumLodgYn);
				dlt_expns.setCellData( i , "lodg_fee_rmk", " = 친지숙박  : " + com.formatMoney(20000) + "(숙박) × " + dma_tripAd.get("biztrip_nght") +"(일)"); // 친지숙박일 경우 20000 지급
			}
		}
	};
	
	/**
	 * 예실조회 버튼 클릭 이벤트
	 */
	scwin.btn_bugt_onclick = function(e) {
		var rows = grd_accnt.getRowCount();
		if(rows > 0){
			var row = (rows == 1)? 0 : grd_accnt.getFocusedRowIndex();
			if(row <0){
				 com.alert(com.getMsg("message.xom.co.com.0003", "계정번호"));
				 return;
			}
			com.pop.open(com.pop.TYPE.BUGT, {accnt_no:dlt_accnt.getCellData(row, "accnt_no")}, function(ret) {				
			});
		}
	};
	
	/**
	 * 출장번호 버튼 클릭 이벤트
	 */
	scwin.btn_tripReq_onclick = function(e) {
		var data={
			flag : "DomRep",
			rep_req_no : dma_tripAd.get("req_no"),
			cmd : "adjst",
			ref_yn : "Y"
		};
		
		com.pop.open(com.pop.TYPE.TRIP, data, function(ret) {
			if(ret.rep_req_no.trim() != ""){
				dma_search.set("req_no", ret.rep_req_no);
				scwin.search();
			}else{
				dma_search.set("biztrip_req_no", ret.req_no);
				scwin.searchTripInfo(); // 출장정보 조회
			}
		});
	};
	
	/**
	 * 출장번호로 출장정보 조회
	 */
	scwin.searchTripInfo = function(){
		if(dma_search.get("biztrip_req_no") == ""){
			alert("출장신청번호가 존재하지 않습니다.");	
			return;
		}
		
		com.execute(sbm_selectTripInfo, {
			successCallback : function(e){
				// 1) 출장정보				
				var startYmd = dma_tripAd.get("truth_orign_ymd");
				var clsYmd = dma_tripAd.get("truth_cls_ymd");
				var nightCnt = dma_tripAd.get("biztrip_nght");
				
				var prd = startYmd.substring(0, 4) + "-" + startYmd.substring(4, 6) + "-" + startYmd.substring(6, 8) + " ~ ";
					prd += clsYmd.substring(0, 4) + "-" + clsYmd.substring(4, 6) + "-" + clsYmd.substring(6, 8);
					prd += " (" + nightCnt + "박 " + dma_tripAd.get("biztrip_day") + "일 )";
				
				dma_tripAd.set("biztrip_prd", prd);
				dma_tripAd.set("biztrip_region", dma_tripAd.get("truth_biztrip_form"));
				dma_tripAd.set("slip_ymd", com.getServerDateTime());
				dma_tripAd.set("req_ymd", com.getServerDateTime());
				dma_tripAd.set("cud_type", "C");				
				
				// 출장경로 셋팅
				dlt_reqPath.setJSON(e.responseJSON.elData.pathList);
				
				for(var i=0; i<dlt_path.getRowCount(); i++){
					dlt_path.setCellData(i, "cud_type", "C");
					dlt_path.setCellData(i, "lodg_yn", 0);
				}	
				
				// form settting
				scwin.setForm(e.responseJSON.elData.tripAdVo);							
				
				// 동반자 출장일자 및 출장밤, 낮 셋팅
				scwin.setCompnGrid();

				dlt_expns.setJSON(e.responseJSON.elData.payList);
				// 카드식 셋팅
				for(var i=0; i<dlt_expns.getRowCount(); i++){
					dlt_expns.setCellData(i, "cud_type", "C");		
					dlt_expns.setCellData(i, "card_meal", (dma_tripAd.get("card_meal") == "")? "0": dma_tripAd.get("card_meal"));					
				}
				
				// 초기셋팅
				scwin.getFirstExpns();				
				
				// GPS 정보
				scwin.getNstGpsData();
			}
		});
	};
	
	/**
	 * 동반자 출장일자 및 출장밤, 낮 셋팅
	 */
	scwin.setCompnGrid = function(){
		for(var i=0; i<dlt_compn.getRowCount(); i++){
			dlt_compn.setCellData(i, "cud_type", dma_tripAd.get("cud_type"));
			dlt_compn.setCellData(i, "biztrip_orign_ymd", dma_tripAd.get("truth_orign_ymd"));
			dlt_compn.setCellData(i, "biztrip_cls_ymd", dma_tripAd.get("truth_cls_ymd"));
			dlt_compn.setCellData(i, "biztrip_nght", dma_tripAd.get("biztrip_nght"));
			dlt_compn.setCellData(i, "biztrip_day", dma_tripAd.get("biztrip_day"));
			dlt_compn.setCellData(i, "biztrip_day_exp", dma_tripAd.get("biztrip_nght") + " 박 " + dma_tripAd.get("biztrip_day") + " 일");
		}
	};
	
	/**
	 * GPS데이터 조회
	 */
	scwin.getNstGpsData = function(){
		if(ica_start_dt.getValue() == "" || ica_end_dt.getValue() == "") return;
		
		var mails =[];
		for(var i=0; i<dlt_compn.getRowCount(); i++){
			mails.push(dlt_compn.getCellData(i, "email"));
		}
		
		dma_search.set("psn_syspayno", mails.join(","));
		dma_search.set("from_ymd", ica_start_dt.getFormattedValue());
		dma_search.set("to_ymd", ica_end_dt.getFormattedValue());
		
		com.execute(sbm_selectGpsInfo, {
			successCallback : function(e){
				dlt_gpsInfo.setJSON(e.responseJSON.ctrTripGpsVoList);
			}
		});
	};
	
	/**
	 * 계정내역 행추가 이벤트
	 */
	scwin.btn_accntPlus_onclick = function(e) {
		var idx = com.addRow(grd_accnt);
		dlt_accnt.setCellData(idx, "expns_cd", "271");
		dlt_accnt.setCellData(idx, "cud_type", "C");
	};
	
	/**
	 * 계정내역 행삭제 이벤트
	 */
	scwin.btn_accntMinus_onclick = function(e) {
		var rows = grd_accnt.getCheckedIndex("chk");
		if(rows.length == 0){
			com.alert(com.getMsg("message.xom.co.com.0003", "삭제할 행"));
			return;
		}
		
		rows.reverse().forEach(function(idx) {
			dlt_accnt.setCellData(idx, "cud_type", "D");
			dlt_accnt.removeRow(idx);
		});
	};
	
	/**
	 * 계정번호 검색
	 */
	scwin.grd_accnt_ontextimageclick = function(row,col) {
		if(grd_accnt.getColumnID(col) == "accnt_no"){
			var data = {
				accnt_no : dlt_accnt.getCellData(row, "accnt_no"),
				cls_ymd : ica_end_dt.getValue(),
				ref_yn : "Y"
			};
			
			com.pop.open(com.pop.TYPE.ACNNO, data, function(ret) {
				if(ret.cls_ymd < ica_end_dt.getValue()){
					com.alert("message.xom.ui.ccs.003"); // 과제기간이 종료된 계정입니다.다른 계정을 선택해주세요.
					return;
				}
				
				if(!/RAK041|RAK061/.test(ret.accnt_state)){ // RAK041 집행가능, RAK061 미입금집행승인
					com.alert(com.getMsg("message.alert.fin.com.0008", ret.accnt_no, "출장신청"));
					return;
				}		
				
				if(dlt_accnt.getRowCount() > 1){
					var chks = dlt_accnt.getMatchedIndex("accnt_no", ret.accnt_no, true);
					if(chks.length > 0){
						com.alert("message.xom.ui.ccs.017");
						return;
					}
				}
				
				dlt_accnt.setCellData(row, "accnt_no", ret.accnt_no);
				dlt_accnt.setCellData(row, "accnt_no_nm", ret.accnt_no_nm);
				dlt_accnt.setCellData(row, "fomat_unit", ret.fomat_unit);
				dlt_accnt.setCellData(row, "prj_no", ret.prj_no);		
				dlt_accnt.setCellData(row, "mngmt_clsf", ret.mngmt_clsf);		
				dlt_accnt.setCellData(row, "accnt_respn_psn_syspayno", ret.accnt_rspns);
				dlt_accnt.setCellData(row, "accnt_rspns_empno", ret.accnt_rspns_empno);
				dlt_accnt.setCellData(row, "accnt_rspns_nm", ret.accnt_rspns_nm);				
				dlt_accnt.setCellData(row, "expns_cd", "271");
				dlt_accnt.setCellData(row, "tax_cd_nm", (ret.tax_cd == "FTX001")? "과세" : "비과세");
				grd_accnt.setCellColor(row, "tax_cd_nm", (ret.tax_cd == "FTX001")? "red" : "#333");
				
				// 회계코드 조회
				dma_search.set("accnt_no", ret.accnt_no);
				dma_search.set("expns_cd", dlt_accnt.getCellData(row, "expns_cd"));
				com.execute(sbm_selectExpnsList, {
					successCallback : function(ret){	
						if(ret.responseJSON.elData.fbaItmExpnsVoList.length == 0){
							dlt_accnt.setCellData(row, "accnt_no", "");
							com.alert("해당 계정번호는 사용하실 수 없습니다.");
							return;
						}			
						
						var data = ret.responseJSON.elData.fbaItmExpnsVoList[0];
						dlt_accnt.setCellData(row, "accnt_cd", data.accnt_cd);				
						
						// 총액 셋팅
						scwin.setAccntTotExpns();	
						
						// 예실잔액 체크
						var param = {
							bugt_yr : scwin.data.today.substring(0,4),
							accnt_no : dlt_accnt.getCellData(row, "accnt_no"),
							accnt_cd : data.accnt_cd,
							relat_no : dlt_accnt.getCellData(row, "accnt_rspns_empno")
						};
			
						com.biz.checkBugtRamt(param, function(ret){
							var bugtAmt = Number(ret.bugt_amt);
							var causeAmt = Number(ret.cause_amt);
							var enfrcAmt = Number(ret.enfrc_amt);
							var reqAmt = Number(dlt_accnt.getCellData(row, "tot_expns"));
							
							if(/FAF011|FAF021|FAF031/.test(ret.bugt_ctrl_way)){
								if(bugtAmt - causeAmt - enfrcAmt < reqAmt){
									alert("예산이 부족합니다. 관련 계정의 예실대비표 확인 부탁드립니다.");	
								}
							}
						});
					}
					
				});
			});
		}
	};
	
	/**
	 * 숙박횟수 체크
	 */
	scwin.checkLodgYn = function(){
		var ngt = Number(dma_tripAd.get("biztrip_nght"));
		var day = Number(dma_tripAd.get("biztrip_day"));
		var sumLodgYn = 0;
		for(var i=0; i<dlt_path.getRowCount(); i++){
			sumLodgYn += com.parseInt(dlt_path.getCellData(i, "lodg_yn"));				
		}	
		
		if(ngt > 0 && day > 1){
			if(ngt != sumLodgYn){
				alert("숙박횟수와 출장기간이 일치하지 않습니다. [" + ngt + "박, 숙박횟수 :" + sumLodgYn + "] \n변경 출장경로에서 숙박한 도착지 옆에 숙박횟수를 입력해주시길 바랍니다.");
				return false;
			}
		}
		
		return true;
	};
	
	/**
	 * 저장전 체크
	 */
	scwin.preSave = function(){
		scwin.data.lodgYn = "N";	
		
		if(!com.validateData(dma_tripAd,[
				 { id : "chng_resn", mandatory : true }
				,{ id : "chng_contnt", mandatory : true }
				,{ id : "truth_orign_ymd", mandatory : true }
				,{ id : "truth_cls_ymd", mandatory : true }
				,{ id : "biztrip_nght", mandatory : true }
				,{ id : "biztrip_day", mandatory : true }
			], false)
		) return false;
		
		var ngt = Number(dma_tripAd.get("biztrip_nght"));
		var day = Number(dma_tripAd.get("biztrip_day"));
		var sumLodgYn = 0;
		for(var i=0; i<dlt_path.getRowCount(); i++){
			sumLodgYn += com.parseInt(dlt_path.getCellData(i, "lodg_yn"));				
		}	
		
		if(ngt > 0 && day > 1){
			if(!scwin.checkLodgYn()) return false;
			
			if(!confirm("지급받으실 출장경비의 운임 및 숙박/일비/식비 등을 확인하셨습니까?")) return;
		}		
		
		if(dma_tripAd.get("no_trvel_expns") != "Y"){
			if(dlt_accnt.getRowCount() == 0){
				alert("계정내역을 입력하세요.");
				return false;
			}
			
			if(!com.validateData(dlt_accnt,[
					{ id : "accnt_no", mandatory : true},
				 	{ id : "expns_cd", mandatory : true},
				 	{ id : "accnt_cd", mandatory : true}
				], false)
			) return false;
			
			// 계정 중복 체크
			var accnts = dlt_accnt.getColData("accnt_no");
			if (accnts.some( function(a){ return accnts.indexOf(a) !== accnts.lastIndexOf(a);})) {
				com.alert("message.xom.ui.ccs.017");
				return false;
			}
		}
		
		// 숙박비 기준금액과 신청금액 비교를 위한 변수 선언
		var lodgMax = 0;
		var lodgPay = 0;
		var lodgMaxSum = 0;
		var lodgPaySum = 0;	
		
		var lodeTypeCnt = 0;
		var day = com.parseInt(dma_tripAd.get("biztrip_day"));
		for(var i=0; i<dlt_expns.getRowCount(); i++){
			lodgMax = com.parseInt(dlt_expns.getCellData(i, "lodg_fee_max"));
			lodgPay = com.parseInt(dlt_expns.getCellData(i, "lodg_fee_pay"));
			lodgMaxSum += lodgMax;
			lodgPaySum += lodgPay;
			
			
			
			if(lodgMax < lodgPay && dma_tripAd.get("excess_resn_cd").trim() == "" && dlt_expns.getCellData(i, "lodg_clsf") != "CAG003"){ // CAG003 공동숙박
				alert("숙박비 신청금액을 다시 입력하시고 숙박비 초과사유를 선택하세요.");
				scwin.data.excessType == "Y"
				grp_excess.show("");
				return false;
			}
			
			// CAG002 친지숙박, CAG004 숙박제공
			if (/CAG002|CAG004/.test(dlt_expns.getCellData(i, "lodg_clsf"))) lodeTypeCnt = 1;					
			
			// FBV150 외부강의등
			if(dma_tripAd.get("truth_biztrip_goal_cd") != "FBV150" && dma_tripAd.get("no_trvel_expns") != "Y"){
				// CAD004 항공
				if(dlt_expns.getCellData( i , "fare_clsf" ) != "CAD004" && Number(dlt_expns.getCellData( i , "fare_fee_pay" )) > Number(dlt_expns.getCellData( i , "fare_fee_max" ))){ 				
					alert("[운임] 신청금액이 기준금액을 초과할 수 없습니다.");
					dlt_expns.setCellData(i, "fare_fee_pay", 0);				
				}
				
				if(Number(dlt_expns.getCellData( i , "ymd_fee_max" )) < Number(dlt_expns.getCellData( i , "ymd_fee_pay" ))){				
					alert("[일비] 신청금액이 기준금액을 초과할 수 없습니다.");
					dlt_expns.setCellData(i, "ymd_fee_pay", 0);				
				}
				
				if(Number(dlt_expns.getCellData( i , "meal_fee_max" )) < Number(dlt_expns.getCellData( i , "meal_fee_pay" ))){				
					alert("[식비] 신청금액이 기준금액을 초과할 수 없습니다.");
					dlt_expns.setCellData(i, "meal_fee_pay", 0);
				}
			}			
			
			if(com.parseInt(dlt_expns.getCellData(i, "fare_fee")) < com.parseInt(dlt_expns.getCellData(i, "fare_fee_pay"))){
				alert("[운임] 신청금액은 실사용금액을 초과할 수 없습니다.");
				return false;
			}
			
			if(com.parseInt(dlt_expns.getCellData(i, "ymd_fee")) < com.parseInt(dlt_expns.getCellData(i, "ymd_fee_pay"))){
				alert("[일비] 신청금액은 실사용금액을 초과할 수 없습니다.");
				return false;
			}
			
			if(com.parseInt(dlt_expns.getCellData(i, "meal_fee")) < com.parseInt(dlt_expns.getCellData(i, "meal_fee_pay"))){
				alert("[식비] 신청금액은 실사용금액을 초과할 수 없습니다.");
				return false;
			}
			
			if (dlt_expns.getCellData(i, "card_meal") == "") {
				alert((i + 1) + "행 카드식 입력하시기 바랍니다.");
				dlt_expns.setFocusedCell( i , "card_meal" , true );
				return false;
			}
						
			// 2023.04.01.이후 일비 및 식비 25000원으로 조정
//			if(dma_tripAd.get("truth_cls_ymd") < "20230401"){
//				debugger;
//				if(com.parseInt(dlt_expns.getCellData(i, "ymd_fee_pay")) > 20000*day){
//					alert("개정된 여비규정에 의거, 상향 조정된 국내출장경비 수령은 4월 1일 출장 건부터 적용입니다. \n이전 출장에 대한 출장경비는 이전 기준으로 수령하여 주시기 바랍니다.\n 일비 기준금액 : 20,000원");
//					return;
//				}
//				
//				if(/FBG0900|FBG030/.test(dlt_compn.getCellData(0, "posi_clsf")) && com.parseInt(dlt_expns.getCellData(i, "meal_fee_pay")) > 20000*day){
//					alert("개정된 여비규정에 의거, 상향 조정된 국내출장경비 수령은 4월 1일 출장 건부터 적용입니다. \n이전 출장에 대한 출장경비는 이전 기준으로 수령하여 주시기 바랍니다.\n 식비 기준금액 : 20,000원");
//					return;
//				}
//			}
		}
		
		if(lodgPaySum > 0) scwin.data.lodgYn = "Y";		

		// 출장자가 모두 취소 한경우에는 숙박증빙 필요 없음
		if (lodeTypeCnt != 1 && dlt_compn.getRowCount() != dlt_compn.getMatchedIndex("chng_clsf", "1", true).length) { //친지숙박, 숙박제공인 경우 숙박증비 필수 제외
			/* 숙박증빙 첨부파일 필수*/
			if (ngt > 0 && com.file.action.getTotalFileCount(upload_B.getID()) < 1) {
				alert("숙박증빙을 첨부하시기 바랍니다.");
				return false;
			}
			
			// EXC005 기타
			if (sbx_excess_resn_cd.getValue() == "EXC005" && com.file.action.getTotalFileCount(upload_B.getID()) < 1) { // 초과사유 첨부파일 참조일때 필수체크
				alert("초과사유 첨부파일 참조 선택시 첨부하시기를 바랍니다.");
				return false;
			} 
		}		

		if(scwin.data.isChangeFlag && WebSquare.util.parseInt(dma_tripAd.get("biztrip_nght"), 0) > 0){
			if(dma_tripAd.get("bizwrk_atdnc_contnt") == ""){
				alert("업무수행내용을 입력해 주시길 바랍니다.");
				return false;
			}
			
			if(dma_tripAd.get("polcy_suggst_item") == ""){
				alert("주요성과(정책건의사항)을 입력해 주시길 바랍니다.");
				return false;
			}
		}		
		
		if(sbx_chng_resn.getValue() != "FBQ020"){ // 취소
			if(dlt_gpsInfo.getRowCount() == 0 && com.file.action.getTotalFileCount(upload_B.getID()) < 1){
				alert("위치 인증내역이나 출장증빙 첨부파일을 첨부하시기 바랍니다.");
				return false;
			}
		}
		
		return true;
		
	};
	
	/**
	 * 저장버튼 클릭 이벤트
	 */
	scwin.btn_save_onclick = function(e) {
		if(!scwin.preSave()) return;
		
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
			if(ret){
				scwin.save();
			}
		});
	};
	
	/**
	 * 저장
	 */
	scwin.save = function(){
		dma_tripAd.set("chng_biztrip_land", grd_path.getCellDisplayData(dlt_path.getRowCount()-1, "arriv_region"));
		dma_tripAd.set("card_meal", dlt_expns.getCellData(0, "card_meal"));
		
		com.file.transport( function(attachObj){
			dma_tripAd.set("evid_attach_file_no", attachObj.upload_A); // 복명서증빙
			dma_tripAd.set("attach_file_no", attachObj.upload_B); // 출장증빙			
			var attaches = [];
			if(attachObj.upload_A !=""){
				attaches.push(attachObj.upload_A);
			}
			if(attachObj.upload_B !=""){
				attaches.push(attachObj.upload_B);
			}
			dma_tripAd.set("validAttachNo", attaches.join(","));
			
			com.execute(sbm_saveDomTripAd, {
				successCallback : function(e) { // 성공 콜백
					if(scwin.data.isApproval){
						// 결재화면 이동
						com.movePageMenu("A001", { "reqNo" :  dma_search.get("req_no")});
					}else{
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
							// 조회
							scwin.search();
						});
					}
				}
			});
		});	
			
	};
	
	/**
	 * 변경사유 변경 이벤트
	 */
	scwin.sbx_chng_resn_onviewchange = function(info) {		
		if(info.newValue == "FBQ990"){
			if(/FBQ020|FBQ030/.test(info.oldValue)){
				grd_compn.checkAll("chng_clsf", false);
			}			
			ibx_chng_contnt.setValue("변경내용없음");			
			
		}else if(/FBQ020|FBQ030/.test(info.newValue)){ // 일정변경 : 취소, 휴가 
			// 출장자 그리드에 있는 인원 취소여부 ALL CHECK / 이재상 사무원 요청
			grd_compn.checkAll("chng_clsf", true);
			ibx_chng_contnt.setValue("");
			
			// 출장경비 초기화
			for(var i=0; i<dlt_compn.getRowCount(); i++){
				scwin.clearGrdExpns(i);
			}				
		}else{
			
			if(/FBQ020|FBQ030/.test(info.oldValue)){
				grd_compn.checkAll("chng_clsf", false);
			}
			ibx_chng_contnt.setValue("");
		}		
		
		if((dma_tripAd.get("biztrip_nght") == '0' && dma_tripAd.get("chng_resn") == "FBQ990") || dma_tripAd.get("chng_resn") == "FBQ020"){
			grp_rep.hide();
			
			scwin.data.isChangeFlag = false;
		}else{
			grp_rep.show("");
			scwin.data.isChangeFlag = true;
		}
	};
	
	/**
	 * 결재신청 전 처리
	 */
	scwin.processAppr = function(){
		scwin.data.isApproval = true;
		
		// 서버사이드 업무로직 유효성 검증 시작		
		var psnArray = [];
		for(var i=0; i< dlt_compn.getRowCount(); i++){
			if(dlt_compn.getCellData(i, "chng_clsf") != "1"){
				psnArray.push(dlt_compn.getCellData(i, "biztrip_psn_syspayno"))
			}
		}
		
//		debugger;
		// 출장자가 없을 경우 체크 필요없음		
		if(psnArray.length == 0){
			scwin.sendApr();
		}else{		
			if(dma_tripAd.get("cud_type") == "C"){
				dma_aprCheck.set("req_no", "C87");
			}else{
				dma_aprCheck.set("req_no", dma_tripAd.get("req_no"));
			}
			
			dma_aprCheck.set("biztrip_start_ymd", ica_start_dt.getValue());
			dma_aprCheck.set("biztrip_cls_ymd", ica_end_dt.getValue());
			dma_aprCheck.set("biztrip_psn_syspayno", psnArray.join(","));
			
			var accntArray = [];
			for(var i=0; i<dlt_accnt.getRowCount(); i++){
				var rowData = dlt_accnt.getRowJSON(i);
				if(rowData.prj_no.trim() != "" && !biz.ccs.exceptAccntMember(rowData.accnt_no, dlt_accnt.getCellData(0, "expns_cd"))){
					accntArray.push(rowData.accnt_no);
				}
			}		
			dma_aprCheck.set("accnt_no", accntArray.join(","));
			
			com.execute(sbm_checkApr, {
				successCallback : function(e){
					var data ={};
					if(e.responseJSON.elData.rst_val == "no_join"){ // 참여연구원 확인
						data.type = "NO_JOIN";
						data.rstData = e.responseJSON.elData.noJoinList;
					}else if(e.responseJSON.elData.rst_val == "air_mile"){
						data.type = "AIR_MILE";
					}
					
					// 검증팝업 호출
					if(data.type == "NO_JOIN"){
						biz.ccs.pop.open(biz.ccs.pop.TYPE.APR_CHK, data, function(ret) {
						});
					}else if(data.type == "AIR_MILE"){
						alert("항공마일리지신청서와 동반자의 수가 일치하지 않습니다 확인 바랍니다.");
					}else{
						if(Number(grd_expns.getFooterData("totl_trip_fee_pay")) > 0){
							scwin.checkPreSlip();
						}else{
							scwin.sendApr();
						}
					}
				}
			});
		}
	};
	
	/**
	 * 결재신청 버튼 클릭 이벤트
	 */
	scwin.btn_apr_onclick = function(e) {
		if(!scwin.preSave()) return;
		
		// 운임구분이 항공인 경우 마일리지 신청번호 필수 체크
		if(/exMile|exprss/.test(dma_tripAd.get("biztrip_way")) && dma_tripAd.get("air_mile_no").trim() == ""){
			alert("운임구분이 항공 또는 항공마일리지인 경우 마일리지 신청서를 작성해주시길 바랍니다.");
			return;
		}
//		debugger;
		// 2023.04.01.기준으로 일정기간만 알림창 생성
//		com.alert("개정된 여비규정에 의거, 상향 조정된 국내출장경비 수령은 4월 1일 출장 건부터 적용입니다. \n이전 출장에 대한 출장경비는 이전 기준으로 수령하여 주시기 바랍니다.", function(ret){
			var taxRows = dlt_accnt.getMatchedIndex("tax_cd_nm", "과세", true);
			if(scwin.data.lodgYn == "Y" && taxRows.length > 0){
				com.alert("<font style='color:red'>* 본 출장계정은 과세계정으로, 숙박비를 개인카드 결제한 경우 '부가세'(환급 대상)는 제외하고 숙박비 신청하여 주세요.</font>", function(ret){
					if(ret){
						scwin.processAppr();
					}
				}, true);
			}else{
				scwin.processAppr();
			}	
//		});			
	};
	
	/**
	 * 결의생성전 체크
	 */
	scwin.checkPreSlip = function(){
		if(idx_slip_ymd.getValue() == ""){
			com.alert("message.xom.co.com.0009", "결의일자");
			return;
		}
		
		var payAmtSum = Number(grd_pay.getFooterData("adjst_amt_sum"));
		
		if(payAmtSum > 0){
			if(dma_tripAd.get("slip_ymd").substring(0, 4) != dma_tripAd.get("truth_cls_ymd").substring(0,4)){
				alert("출장정산 결의일자는 해당 출장연도내로 진행하셔야 합니다.");
				return;
			}	
		}
		
		var accntSum = 0;
		for(var i=0; i<dlt_accnt.getRowCount(); i++){
			accntSum += Number(dlt_accnt.getCellData(i, "tot_expns"));
		}
		
		if(dma_tripAd.get("car_use_yn") != "FDO001"){
			if(payAmtSum > accntSum){
				alert("계정내역의 금액의 합보다 지급내역의 지급액의 합이 클 수 없습니다.");
				return;
			}
		}else{
			if(payAmtSum != accntSum){
				alert("계정내역의 금액의 합과 지급내역의 지급액의 합이 일치하지 않습니다.");
				return;
			}	
			
			if(payAmtSum != Number(grd_expns.getFooterData("totl_trip_fee_pay"))){
				alert("출장경비내역 신청금액과 지급내역 지급액이 일치하지 않습니다.");
				return;
			}
		}
		
		scwin.sendApr();
	};
	
	/**
	 * 결재신청
	 */
	scwin.sendApr = function(){
		dma_tripAd.set("approval", "true");
		
		scwin.save();
	};
	
	/**
	 * 당일 출장 클릭 이벤트
	 */
	scwin.btn_oneTrip_onclick = function(e) {
		scwin.btn_apr_onclick();
	};
	
	/**
	 * 삭제 버튼 클릭 이벤트
	 */
	scwin.btn_del_onclick = function(e) {
		if(dma_tripAd.get("decsn_ex") == "Y"){
			alert("결의확정이 되었으므로 삭제할 수 없습니다.");
			return;	
		}
		
		if(dma_tripAd.get("apr_state") >= "XAD020"){
			alert("현재 결재상태이므로 삭제가 불가능합니다.");
			return;	
		}
		
		dma_search.set("unslip_no", dma_tripAd.get("unslip_no"));
		dma_search.set("req_no", dma_tripAd.get("req_no"));
		
		com.confirm("message.xom.wq.022"/*삭제 하시겠습니까?*/, function(ret) {
			if (ret) {
				com.file.deleteAll( function(){					
					com.execute(sbm_deleteTripAd, {
						successCallback : function(e) { // 성공 콜백
							com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function() {
								com.moveList("C319", {});						
							});
						}
					});
				});
			}
		});
	};
	
	/**
	 * 목록 버튼 클릭 이벤트
	 */
	scwin.btn_pre_onclick = function(e) {
		//com.closeTab();
		com.moveList((com.getParameter("openerId") != undefined)?com.getParameter("openerId"):"C319");
	};
	
	/**
	 * 출장경비 변경 이벤트
	 */
	scwin.grd_expns_onviewchange = function(info) {
		var row = info.rowIndex;
		var col = info.colIndex;
		var colId = grd_expns.getColumnID(col);		
		
		if(colId == "card_meal"){
			scwin.setTripEtcExpns(row)	
		}else if(colId == "lodg_clsf"){
			if(info.newData == "CAG003"){
				if(dlt_compn.getRowCount() == 1){
					alert("출장자가 1명일때는 공동숙발 선택을 할 수 없습니다.");
					dlt_expns.setCellData(row, "lodg_clsf", info.oldValue);
					return;
				}
				
				var rows = dlt_expns.getMatchedIndex("lodg_clsf", "CAG001", true);
				//숙박구분(공동숙박)일때 모든출장경비그리드 숙박구분 변경
				if(rows.length != dlt_expns.getRowCount()){
					for(var i=0; i<dlt_expns.getRowCount(); i++){
						dlt_expns.setCellData(i, "lodg_clsf", "CAG003");
					}
				}
			}
		}else if(colId == "fare_fee"){
			dlt_expns.setCellData(row, "fare_fee_pay", info.newValue);			
			
		}else if(colId == "meal_fee"){
			dlt_expns.setCellData(row, "meal_fee_pay", info.newValue);
			
		}else if(colId == "lodg_fee"){
			if(Number(dlt_expns.getCellData(row, "lodg_fee")) <= Number(dlt_expns.getCellData(row, "lodg_fee_max"))){
				dlt_expns.setCellData(row, "lodg_fee_pay", info.newValue);
			}else{
				dlt_expns.setCellData(row, "lodg_fee_pay", 0);
			}
			
			if(Number(info.newValue) > 0){
				// 실사용액 및 신청금액 입력 시에도 문구 출력 - 이재상 사무원 요청 202202/07 
				scwin.checkLodgYn();
			}
		}else if(colId == "lodg_fee_pay"){
			if(Number(info.newValue) > 0){
				// 실사용액 및 신청금액 입력 시에도 문구 출력 - 이재상 사무원 요청 202202/07 
				scwin.checkLodgYn();
			}			
		}else if(colId == "lodg_card_yn"){
			if(info.newValue == "Y"){
				dlt_expns.setCellData(row, "lodg_fee", 0);
				dlt_expns.setCellData(row, "lodg_fee_pay", 0);
				grd_expns.setCellDisabled( row , "lodg_fee" , true );
				grd_expns.setCellDisabled( row , "lodg_fee_pay" , true );
				
			}else{
				dlt_expns.setCellData(row, "lodg_fee_pay", dlt_expns.getCellData(row, "lodg_fee"));
				dlt_expns.setCellData(row, "lodg_fee_pay", dlt_expns.getCellData(row, "lodg_fee_pay"));
				grd_expns.setCellDisabled(row, "lodg_fee", false);
				grd_expns.setCellDisabled(row, "lodg_fee_pay", false);
			}
		}

		if(/lodg/.test(colId)){
			scwin.setPublicLodg(row, Number(dlt_expns.getCellData(row, "lodg_fee_pay")));	
		}
		
		// 계정금액 재계산
		scwin.setAccntTotExpns();
				
		// 지급금액 계산
		scwin.setPayAdjstAmt(row);	
	};
	
	/**
	 * 출장경비 숙박구분에 따른 금액 및 Action 변경
	 */
	scwin.setPublicLodg = function(row, lodgFeePay){
		var ngt = com.parseInt(dma_tripAd.get("biztrip_nght"));
		if(ngt == 0) return;
		
		var lodgFeeMax = com.parseInt(dlt_expns.getCellData(row, "lodg_fee_max"));
		
		var lodgCardYn = dlt_expns.getCellData(row, "lodg_card_yn");
		
		if(lodgFeeMax == 0){
			dlt_expns.setCellData(row, "lodg_fee", 0);
			dlt_expns.setCellData(row, "lodg_fee_pay", 0);
			return;
		}
		
		var lodgClsf = dlt_expns.getCellData(row, "lodg_clsf");
		if(lodgClsf == "CAG001") { // 일반숙박
			if(lodgFeeMax < lodgFeePay){
				grp_excess.show("");
			}else{
				grp_excess.hide();
			}
			
			//1.3배 실사용금액 → 기준금액 * 130% / 100
			var temp2 = lodgFeeMax * 1.3; 
			if(lodgFeePay > temp2){
				alert("숙박비 상한액은 기준금액의 1.3배 범위 내에서 초과지급 가능합니다. (공무원여비규정 제16조 상안액 규정 준용)");
				dlt_expns.setCellData(row, "lodg_fee", 0);
				dlt_expns.setCellData(row, "lodg_fee_pay", 0);
			}
		}else if(lodgClsf == "CAG002") { // 친지숙박
			// 친지숙박일 경우 20000 지급
			dlt_expns.setCellData(row, "lodg_fee", 20000 * ngt);
			dlt_expns.setCellData(row, "lodg_fee_pay", 20000 * ngt);
			
		}else if(lodgClsf == "CAG004"){ // 숙박제공
			dlt_expns.setCellData(row, "lodg_fee", 0);
			dlt_expns.setCellData(row, "lodg_fee_pay", 0);		}
		
		if(lodgClsf == "CAG002"){
			dlt_expns.setCellData(row, "lodg_fee_rmk", "= 친지숙박  : " + "20000" + "(숙박) × " + ngt +"(일)");
		}else{
			dlt_expns.setCellData(row, "lodg_fee_rmk", "= 숙박비 정산 시 실비지급(※상한금액: " + scwin.data.lodg_rmk + ")");
		}
		
		if(lodgClsf == "CAG004"){
			grd_expns.setCellDisabled( row , "lodg_fee" , true );
			grd_expns.setCellDisabled( row , "lodg_fee_pay" , true );
			grd_expns.setCellDisabled(row, "lodg_card_yn" , true);
		}else{
			// 숙박 법인카드 체크 시, 실사용액+신청금액 입력 X
			// XC2202302B1C, 20231122 수정
			if(lodgCardYn == 'Y'){
				grd_expns.setCellDisabled( row , "lodg_fee" , true );
				grd_expns.setCellDisabled( row , "lodg_fee_pay" , true );
			}else{
				grd_expns.setCellDisabled( row , "lodg_fee" , false );
				grd_expns.setCellDisabled( row , "lodg_fee_pay" , false );
				grd_expns.setCellDisabled(row, "lodg_card_yn" , false);
			}
			
		}
		
		// 계정금액 재계산
		scwin.setAccntTotExpns();
			
		// 지급금액 계산
		scwin.setPayAdjstAmt();	
	};
	
	
	/**
	 * 마일리지신고번호 검색 버튼 클릭이벤트
	 */
	scwin.btn_airMile_onclick = function(e) {
		biz.ccs.pop.open(biz.ccs.pop.TYPE.AIR_MILE, {biztrip_req_no:dma_tripAd.get("biztrip_req_no")}, function(ret) {
			dma_tripAd.set("air_mile_no", ret.req_no);
		});
	};
	
	/**
	 * 숙박증빙 안내
	 */
	scwin.btn_lodgInfo_onclick = function(e) {
		biz.ccs.pop.open(biz.ccs.pop.TYPE.LODG_EVID_INFO, {}, function(ret) {
		});
	};
	
	/**
	 * 숙박비 초과지급 신청 양식
	 */
	scwin.btn_downForm_onclick = function(e) {
		var save = "ctrDomTripActExpnsAdjstReq";
		var real = encodeURIComponent("(양식) 국내여비(숙박비) 초과 지급 신청서.hwp");	
		var url = "/SvcAttachDown.do?fileName=web_folder/bizdoc/ccs/ctr/"+save+"&realName="+real+"&bizKind=OLD";
		
		window.open(url, '_blank').focus();
	};
	
	/**
	 * 항공마일리지 신청서(신고서) 작성
	 */
	scwin.btn_wrte_mile_onclick = function(e) {		
		var data={
			req_no : dma_tripAd.get("air_mile_no"),
			biztrip_req_no : dma_tripAd.get("biztrip_req_no"),
			rep_req_no : dma_tripAd.get("req_no"),
			flag : "DomTrip"
		};
		
		biz.ccs.pop.open(biz.ccs.pop.TYPE.AIR_MILE_WRTE, data, function(ret){
			dma_tripAd.set("air_mile_no", ret.req_no);
		});		

		// CtrAirMileMnt
//		var url = "/filter/index.jsp?serviceid=C341&flag=DomTrip&reqNo=" + dma_tripAd.get("air_mile_no");
//		url += "&biztripReqNo=" + dma_tripAd.get("biztrip_req_no") + "&repReqNo="+ dma_tripAd.get("req_no")
//		com.biz.openPopupByNative(url, '항공마일리지신청서(신고서)작성', {width: 1187, height: 675}, 'BIZ2');
	};
	
	/**
	 * 인쇄버튼 클릭 이벤트
	 */
	scwin.btn_print_onclick = function(e) {
		var node = "req_no="+ dma_tripAd.get("req_no");
		com.oz.openPopup({
			ozrCode : "F036",      
			param: node
        });
	};

	/**
	 * 업무수행내용 keyup 이벤트
	 */
	scwin.ta_bizwrk_atdnc_contnt_onkeyup = function(e) {
		tbx_cnt_1.setValue(this.getValue().length);
	};
	
	/**
	 * 주요성과내용 keyup 이벤트
	 */
	scwin.ta_polcy_suggst_item_onkeyup = function(e) {
		tbx_cnt_2.setValue(this.getValue().length);
	};
	
	/**
	 * 출장경로 삭제 이벤트
	 */
	scwin.btn_path_del_onclick = function(e) {
		var row = grd_path.getFocusedRowIndex();
		if(row < 0){
			com.alert(com.getMsg("message.xom.co.com.0003", "삭제할 행"));
			return;
		}		
		dlt_path.setCellData(row+1, "start_region", dlt_path.getCellData(row-1, "arriv_region"));
		dlt_path.removeRow(row);		
		
		scwin.getFareFee();
		// 출장경로 삭제 버튼 컨트롤
		scwin.gridPathView();	
	};
	
	/**
	 * 담당자수정 버튼 클릭 이벤트
	 */
	scwin.btn_mngSave_onclick = function(e) {
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
			if(ret){
				com.file.transport( function(attachObj){
					dma_tripAd.set("evid_attach_file_no", attachObj.upload_A); // 복명서증빙
					dma_tripAd.set("attach_file_no", attachObj.upload_B); // 출장증빙			
					var attaches = [];
					if(attachObj.upload_A !=""){
						attaches.push(attachObj.upload_A);
					}
					if(attachObj.upload_B !=""){
						attaches.push(attachObj.upload_B);
					}
					dma_tripAd.set("validAttachNo", attaches.join(","));
					
					com.execute(sbm_updateDomTripAd, {
						successCallback : function(e) { // 성공 콜백					
							com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
								// 조회
								scwin.search();
							});					
						}
					});
				});	
			}
		});
	};

	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload">
		<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
		<xf:group id="" class="pageWrap">
			<xf:group class="searchSection step" id="" style="">
				<xf:group class="le" id="" style="">
					<xf:trigger class="btn" id="btn_pre" style="" type="button" ev:onclick="scwin.btn_pre_onclick">
						<xf:label><![CDATA[목록]]></xf:label>
					</xf:trigger>
				</xf:group>
				<xf:group class="btnbox ri" id="">
					<xf:trigger class="btn icon print" id="btn_print" style="" type="button" disabled="true"
						ev:onclick="scwin.btn_print_onclick">
						<xf:label><![CDATA[인쇄]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn" id="btn_oneTrip" style="" type="button" ev:onclick="scwin.btn_oneTrip_onclick"
						disabled="true">
						<xf:label><![CDATA[당일출장]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn blue" id="btn_apr" style="" type="button" disabled="true" ev:onclick="scwin.btn_apr_onclick">
						<xf:label><![CDATA[결재신청]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
			<xf:group class="w2tb tbl" id="" style="" tagname="table">
				<w2:attributes>
					<w2:summary></w2:summary>
				</w2:attributes>
				<xf:group tagname="caption" text="근거리출장서 작성자 소속 신청번호"></xf:group>
				<xf:group tagname="colgroup">
					<xf:group style="width:140px;" tagname="col"></xf:group>
					<xf:group style="width:280px;" tagname="col"></xf:group>
					<xf:group style="width:140px;" tagname="col"></xf:group>
					<xf:group style="width:230px;" tagname="col"></xf:group>
					<xf:group style="width:140px;" tagname="col"></xf:group>
					<xf:group style="" tagname="col"></xf:group>
				</xf:group>
				<xf:group tagname="tr" style="" id="grp_slipInfo">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="결의일자" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal " focusOnDateSelect="false" footerDiv="false"
							id="idx_slip_ymd" placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="결의일자" ref="data:dma_tripAd.slip_ymd">
						</w2:inputCalendar>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="적요" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full  le" id="" style="" title="적요 상세" ref="data:dma_tripAd.rmk"></xf:input>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="출장 신청번호" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<xf:group class="inpSch" id="" style="width: 150px;">
							<xf:input adjustMaxLength="false" class="inp" id="" style="" title="출장 신청번호"
								ref="data:dma_tripAd.biztrip_req_no" readOnly="true">
							</xf:input>
							<xf:trigger class="btn" id="btn_tripReq" style="" type="button" title="출장 신청번호 조회"
								ev:onclick="scwin.btn_tripReq_onclick">
								<xf:label><![CDATA[검색]]></xf:label>
							</xf:trigger>
						</xf:group>
						<w2:attributes></w2:attributes>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="정산 신청번호" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<w2:textbox class="txt" id="" label="" ref="data:dma_tripAd.req_no" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_th" style="" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="정산 결의번호" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" style="" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:group id="" class="flex">
							<xf:input adjustMaxLength="false" style="" id="" title="정산 결의번호" class="inp full  " readOnly="true"
								ref="data:dma_tripAd.unslip_no">
							</xf:input>
							<xf:select1 chooseOptionLabel="" ref="data:dma_tripAd.decsn_ex" submenuSize="auto" appearance="minimal"
								disabledClass="w2selectbox_disabled" chooseOption="" disabled="true" style="width:150px;" allOption="" id="" class="sel"
								direction="auto" title="정산 결의번호 결의구분">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[확정]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[미확정]]></xf:label>
										<xf:value><![CDATA[N]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[미결의]]></xf:label>
										<xf:value><![CDATA[]]>
										</xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="변경사유" style="" tagname="span"></w2:textbox>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel req"
							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_chng_resn" ref="data:dma_tripAd.chng_resn"
							style="width:150px;" submenuSize="auto" title="변경사유" ev:onviewchange="scwin.sbx_chng_resn_onviewchange">
							<xf:choices></xf:choices>
						</xf:select1>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="변경내용" style="" tagname="span"></w2:textbox>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full  req" id="ibx_chng_contnt" style="" title="변경내용 상세"
							ref="data:dma_tripAd.chng_contnt">
						</xf:input>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="신청 출장기간" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<w2:textbox class="txt" id="" label="" ref="data:dma_tripAd.biztrip_prd" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="복명 출장기간" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false"
							id="ica_start_dt" placeholder="시작일" renderDiv="true" rightAlign="false" style="" title="기간 중 시작일 "
							ref="data:dma_tripAd.truth_orign_ymd" ev:onviewchange="scwin.ica_start_dt_onviewchange">
						</w2:inputCalendar>
						<w2:textbox class="dash" id="" label="~" style="" tagname="span"></w2:textbox>
						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false" footerDiv="false"
							id="ica_end_dt" placeholder="종료일" renderDiv="true" rightAlign="false" style="" title="기간 중 종료일" ref="data:dma_tripAd.truth_cls_ymd"
							ev:onviewchange="scwin.ica_end_dt_onviewchange">
						</w2:inputCalendar>
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:input adjustMaxLength="false" class="inp" id="" style="width: 50px;" title="출장일자 중 숙박일자"
							ref="data:dma_tripAd.biztrip_nght" readOnly="true">
						</xf:input>
						<w2:textbox class="txt" id="" label="박" style="" tagname="span"></w2:textbox>
						<xf:input adjustMaxLength="false" class="inp" id="idx_biztrip_day" style="width: 50px;" title="출장일자 중 숙박일자"
							ev:onchange="scwin.idx_biztrip_day_onchange" ref="data:dma_tripAd.biztrip_day" readOnly="true">
						</xf:input>
						<w2:textbox class="txt" id="" label="일" style="" tagname="span"></w2:textbox>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="신청 출장지" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<w2:textbox class="txt" id="" label="" ref="data:dma_tripAd.biztrip_region" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="복명 출장지" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full le" id="" style="" title="복명 출장지 상세"
							ref="data:dma_tripAd.truth_biztrip_form">
						</xf:input>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="신청 출장목적" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<w2:textbox class="txt" id="" label="" ref="data:dma_tripAd.orign_biztrip_goal" style="" tagname="span"></w2:textbox>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="복명 출장목적" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:group class="flex" id="" style="">
							<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel"
								direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_goal_clsf"
								ref="data:dma_tripAd.truth_biztrip_goal_cd" style="width:150px;" submenuSize="auto" title="복명 출장목적 구분">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[new row]]></xf:label>
										<xf:value></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[new row]]></xf:label>
										<xf:value></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[new row]]></xf:label>
										<xf:value></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[new row]]></xf:label>
										<xf:value></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
							<xf:input adjustMaxLength="false" class="inp full  " id="" style="" title="복명 출장목적 상세"
								ref="data:dma_tripAd.truth_biztrip_goal">
							</xf:input>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="원차량사용" style="" tagname="span"></w2:textbox>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel req"
							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_car_use" ref="data:dma_tripAd.car_use_yn"
							style="width:150px;" submenuSize="auto" title="원차량사용" ev:onviewchange="scwin.sbx_car_use_onviewchange">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[new row]]></xf:label>
									<xf:value></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[new row]]></xf:label>
									<xf:value></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[new row]]></xf:label>
									<xf:value></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[new row]]></xf:label>
									<xf:value></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="운임구분" style="" tagname="span"></w2:textbox>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="sel req"
							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_biztrip_way" ref="data:dma_tripAd.biztrip_way"
							style="width:150px;" submenuSize="auto" title="운임구분" ev:onviewchange="scwin.sbx_biztrip_way_onviewchange">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[열차/버스 등]]></xf:label>
									<xf:value><![CDATA[train]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[항공]]></xf:label>
									<xf:value><![CDATA[exprss]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[선박]]></xf:label>
									<xf:value><![CDATA[vessel]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[항공(마일리지)]]></xf:label>
									<xf:value><![CDATA[exMile]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="정보기기 반출" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:select appearance="full" class="chkGroup  " cols="" id="" ref="data:dma_tripAd.notebook_out"
							renderType="checkboxgroup" rows="" selectedindex="-1" style="" title="정보기기 반출" disabled="true">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[노트북반출]]></xf:label>
									<xf:value><![CDATA[Y]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select>
						<xf:select appearance="full" class="chkGroup  " cols="" id="" ref="data:dma_tripAd.usb_out"
							renderType="checkboxgroup" rows="" selectedindex="-1" style="margin-left:10px;" title="정보기기 반출" disabled="true">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[휴대용 저장매체 반출]]></xf:label>
									<xf:value><![CDATA[Y]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="정보기기 반입" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:select appearance="full" class="chkGroup  " cols="" id="" ref="data:dma_tripAd.notebook_in"
							renderType="checkboxgroup" rows="" selectedindex="-1" style="" title="정보기기 반입">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[노트북반입]]></xf:label>
									<xf:value><![CDATA[Y]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select>
						<xf:select appearance="full" class="chkGroup  " cols="" id="" ref="data:dma_tripAd.usb_in"
							renderType="checkboxgroup" rows="" selectedindex="-1" style="margin-left:10px;" title="정보기기 반입">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[휴대용 저장매체 반입]]></xf:label>
									<xf:value><![CDATA[Y]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="" id="grp_airMile">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="마일리지 신고번호" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<xf:group class="inpSch" id="" style="width: 120px;">
							<xf:input adjustMaxLength="false" class="inp" id="" style="" title="마일리지 신고번호" readOnly="true"
								ref="data:dma_tripAd.air_mile_no">
							</xf:input>
							<xf:trigger class="btn" id="btn_airMile" style="" type="button" title="마일리지 신고번호 조회"
								ev:onclick="scwin.btn_airMile_onclick">
								<xf:label><![CDATA[검색]]></xf:label>
							</xf:trigger>
						</xf:group>
						<xf:trigger class="btn" id="btn_wrte_mile" style="" type="button" ev:onclick="scwin.btn_wrte_mile_onclick">
							<xf:label><![CDATA[신청서(신고서) 작성]]></xf:label>
						</xf:trigger>
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr" style="">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="출장경로" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:group class="ly_column col_4" id="">
							<xf:group class="titleSection" id="" style="">
								<w2:textbox class="tit_tbl" id="" label="이전출장경로" style="" tagname="h3"></w2:textbox>
							</xf:group>
							<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_reqPath" defaultCellHeight="28"
								evenRowBackgroundColor="#f7faff" id="grd_req_path" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
								rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40"
								rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
								selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="3">
								<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
								<w2:header id="header1" style="">
									<w2:row id="row1" style="">
										<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;text-align:center;"
											value="출발지" width="70">
										</w2:column>
										<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;text-align:center;"
											value="도착지" width="70">
										</w2:column>
										<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;text-align:center;"
											value="비고" width="200">
										</w2:column>
									</w2:row>
								</w2:header>
								<w2:gBody id="gBody1" style="">
									<w2:row id="row2" style="">
										<w2:column displayMode="label" escape="false" id="start_region_nm" inputType="text" readOnly="true"
											style="height:28px;" width="70">
										</w2:column>
										<w2:column displayMode="label" escape="false" id="arriv_region_nm" inputType="text" readOnly="true"
											style="height:28px;" width="70">
										</w2:column>
										<w2:column displayMode="label" id="rmk" inputType="text" readOnly="true" style="height:28px;"
											width="200" class="le">
										</w2:column>
									</w2:row>
								</w2:gBody>
							</w2:gridView>
						</xf:group>
						<xf:group class="ly_column col_6" id="">
							<xf:group class="titleSection" id="" style="">
								<xf:group class="le" id="" style="">
									<w2:textbox class="tit_tbl blue" id="" label="변경 출장경로" style="" tagname="h3"></w2:textbox>
								</xf:group>
								<xf:group class="ri" id="" style="">
									<w2:span class="note blue" id="" label="※ 숙박 기준금액: 도착지 기준" style=""></w2:span>
									<xf:group class="btnarea" id="" style="">
										<xf:trigger class="bt_minus" id="btn_path_del" style="" type="button"
											ev:onclick="scwin.btn_path_del_onclick">
											<xf:label><![CDATA[삭제]]></xf:label>
										</xf:trigger>
									</xf:group>
								</xf:group>
							</xf:group>
							<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_path" defaultCellHeight="28"
								evenRowBackgroundColor="#f7faff" id="grd_path" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult"
								rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40"
								rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false"
								selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="3"
								ev:onviewchange="scwin.grd_path_onviewchange" ev:oncellclick="scwin.grd_path_oncellclick">
								<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
								<w2:header id="header1" style="">
									<w2:row id="row1" style="">
										<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;text-align:center;"
											value="선택" width="40" class="blue">
										</w2:column>
										<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;text-align:center;"
											value="출발지" width="70" class="blue">
										</w2:column>
										<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;text-align:center;"
											value="도착지" width="70" class="blue">
										</w2:column>
										<w2:column width="210" inputType="text" style="height:28px;text-align:center;" id="column30"
											value="숙박횟수" displayMode="label" class="blue" colSpan="3" rowSpan="">
										</w2:column>
										<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;text-align:center;"
											value="비고" width="200" class="blue">
										</w2:column>
									</w2:row>
								</w2:header>
								<w2:gBody id="gBody1" style="">
									<w2:row id="row2" style="">
										<w2:column displayMode="label" id="chk" inputType="radio" style="height:28px;" width="50">
										</w2:column>
										<w2:column displayMode="label" escape="false" id="start_region" inputType="autoComplete"
											style="height:28px;" width="70" class="blue" viewType="icon" skipKeyMoveEditMode="true">
										</w2:column>
										<w2:column displayMode="label" escape="false" id="arriv_region" inputType="autoComplete"
											style="height:28px;" width="70" class="blue" viewType="icon" skipKeyMoveEditMode="true">
										</w2:column>
										<w2:column width="40" inputType="text" style="height:28px" id="lodg_yn" value="" displayMode="label"
											readOnly="true" class="blue">
										</w2:column>
										<w2:column width="40" inputType="button" style="height:28px" id="lodg_plus" value="+"
											displayMode="label" fixColumnWidth="true">
										</w2:column>
										<w2:column width="40" inputType="button" style="height:28px" id="lodg_minus" value="-"
											displayMode="label" fixColumnWidth="true">
										</w2:column>
										<w2:column displayMode="label" id="rmk" inputType="text" readOnly="true" style="height:28px;"
											width="200" class="blue le">
										</w2:column>
									</w2:row>
								</w2:gBody>
							</w2:gridView>
							<xf:group class="re" id="" style="">
								<w2:span class="note red" id="" label="ㅁ 여비규정 제4조(여비의 지급)에 의거 출발지는 근무지 기준입니다.&lt;br/&gt; ㅁ 중간 경유지 추가 : 2행 도착지 클릭 후 추가할 경유지를 입력하면, 새로운 3행이 추가 됩니다.&lt;br/&gt;ㅁ 출장경로 삭제 : 경로 삭제는 출발지와 도착지를 제외한 중간 경로만 삭제 가능합니다." style="" escape="false"></w2:span>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group style="" tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="첨부파일&lt;br/&gt;(복명서증빙)" style="" tagname="span" escape="false"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:group style="height:125px;">
							<xf:group class="full" id="upload_A" style="height:100%;"></xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group style="" tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
						<w2:textbox id="" label="첨부파일&lt;br/&gt;(출장증빙)" style="" tagname="span" escape="false"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:group style="height:125px;">
							<xf:group class="full" id="upload_B" style="height:100%;"></xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group style="" tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="위치인증내역&lt;br/&gt;(출장증빙)" style="" tagname="span" escape="false"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes>
							<w2:colspan>5</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_gpsInfo" defaultCellHeight="28"
							evenRowBackgroundColor="#f7faff" id="" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb"
							rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40" rowStatusHeaderValue="상태"
							rowStatusVisible="false" rowStatusWidth="50" scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd"
							selectedRowColor="#fbf2cd" style="height: 85px;" summaryAuto="true" visibleRowNum="3">
							<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
							<w2:header id="header1" style="">
								<w2:row id="row1" style="">
									<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;text-align:center;"
										value="성명" width="70">
									</w2:column>
									<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;text-align:center;"
										value="부서명" width="150">
									</w2:column>
									<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;text-align:center;"
										value="인증아이디" width="150">
									</w2:column>
									<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;text-align:center;"
										value="인증지역" width="150">
									</w2:column>
									<w2:column width="150" inputType="text" style="height:28px;text-align:center;" id="column30"
										value="인증시각" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody id="gBody1" style="">
								<w2:row id="row2" style="">
									<w2:column displayMode="label" escape="false" id="user_nm" inputType="text" readOnly="true"
										style="height:28px;" width="70">
									</w2:column>
									<w2:column displayMode="label" escape="false" id="dept_nm" inputType="text" readOnly="true"
										style="height:28px;" width="150" class="le">
									</w2:column>
									<w2:column displayMode="label" id="emplyr_id" inputType="text" readOnly="true" style="height:28px;"
										width="150">
									</w2:column>
									<w2:column displayMode="label" id="addr_kr" inputType="text" readOnly="true" style="height:28px;"
										width="150" class="le">
									</w2:column>
									<w2:column width="150" inputType="text" style="height:28px" id="input_date" value="" displayMode="label"
										readOnly="true">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group class="titleSection" id="" style="">
				<w2:textbox class="tit_tbl" id="" label="출장자" style="" tagname="h3"></w2:textbox>
				<xf:group class="re" id="">
					<xf:group class="btnarea" id="" style="">
						<xf:trigger class="btn " id="btn_lodgInfo" style="" type="button" ev:onclick="scwin.btn_lodgInfo_onclick">
							<xf:label><![CDATA[숙박증빙 안내]]></xf:label>
						</xf:trigger>
						<xf:trigger class="btn icon down" id="btn_downForm" style="" type="button"
							ev:onclick="scwin.btn_downForm_onclick">
							<xf:label><![CDATA[숙박비 초과지급 신청 양식]]></xf:label>
						</xf:trigger>
					</xf:group>
				</xf:group>
			</xf:group>
			<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_compn" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
				id="grd_compn" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
				rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
				scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 85px;"
				summaryAuto="true" visibleRowNum="5" ev:onviewchange="scwin.grd_compn_onviewchange">
				<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
				<w2:header id="header1" style="">
					<w2:row id="row1" style="">
						<w2:column displayMode="label" id="column7" inputType="checkbox" style="height:28px;" value="선택" width="40"
							readOnly="false" checkboxLabel="전체선택" fixColumnWidth="true">
						</w2:column>
						<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="구분" width="70"></w2:column>
						<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="취소여부" width="70"
							fixColumnWidth="true">
						</w2:column>
						<w2:column width="150" inputType="text" style="height:28px;" id="column33" value="출장자" displayMode="label"
							colSpan="2" rowSpan="">
						</w2:column>
						<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="소속/직급" width="162"
							colSpan="2">
						</w2:column>
						<w2:column displayMode="label" id="column32" inputType="text" style="height:28px;" value="기간 " width="140"
							colSpan="2">
						</w2:column>
						<w2:column displayMode="label" id="column30" inputType="text" style="height:28px" value="박/일" width="80"></w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody id="gBody1" style="">
					<w2:row id="row2" style="">
						<w2:column displayMode="label" id="col2" inputType="checkbox" readOnly="false" style="height:28px;" width="50"></w2:column>
						<w2:column displayMode="label" escape="false" id="biztrip_psn_clsf" inputType="select" readOnly="true"
							style="height:28px;" width="70">
						</w2:column>
						<w2:column displayMode="label" escape="false" id="chng_clsf" inputType="checkbox" style="height:28px;" width="70"
							valueType="binary">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="biztrip_psn_empno" value="" displayMode="label"
							readOnly="true">
						</w2:column>
						<w2:column displayMode="label" id="biztrip_psn_nm" inputType="text" readOnly="true" style="height:28px;"
							width="80">
						</w2:column>
						<w2:column displayMode="label" id="biztrip_dept_nm" inputType="text" readOnly="true" style="height:28px;"
							width="150">
						</w2:column>
						<w2:column width="100" inputType="select" style="height:28px" id="posi_clsf" displayMode="label" readOnly="true"></w2:column>
						<w2:column displayMode="label" id="biztrip_orign_ymd" inputType="calendar" readOnly="true" style="height:28px"
							width="90">
						</w2:column>
						<w2:column width="90" inputType="calendar" style="height:28px" id="biztrip_cls_ymd" displayMode="label"
							readOnly="true">
						</w2:column>
						<w2:column displayMode="label" id="biztrip_day_exp" inputType="text" readOnly="true" style="height:28px"
							width="80">
						</w2:column>
					</w2:row>
				</w2:gBody>
			</w2:gridView>
			<xf:group id="grp_rep">
				<xf:group style="margin-top:5px;" id="" class="titleSection">
					<w2:textbox tagname="h3" style="" id="" label="복명내역" class="tit_tbl"></w2:textbox>
					<xf:group id="" class="re"></xf:group>
				</xf:group>
				<xf:group tagname="table" style="" id="" class="w2tb tbl ">
					<w2:attributes>
						<w2:summary></w2:summary>
					</w2:attributes>
					<xf:group tagname="caption" text="증빙정보"></xf:group>
					<xf:group tagname="colgroup">
						<xf:group tagname="col" style="width:140px;"></xf:group>
						<xf:group tagname="col" style=""></xf:group>
						<xf:group tagname="col" style="width:140px;"></xf:group>
						<xf:group tagname="col" style=""></xf:group>
					</xf:group>
					<xf:group tagname="tr">
						<xf:group tagname="th" class="w2tb_th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span style="" id="" label="[필수입력항목]" class="bul_req"></w2:span>
							<w2:textbox tagname="span" style="" id="" label="업무수행내용"></w2:textbox>
						</xf:group>
						<xf:group tagname="td" class="w2tb_td">
							<w2:attributes>
								<w2:colspan>3</w2:colspan>
								<w2:rowspan>1</w2:rowspan>
							</w2:attributes>
							<xf:textarea ref="data:dma_tripAd.bizwrk_atdnc_contnt" style="height: 80px;" id="ta_bizwrk_atdnc_contnt"
								title="업무수행내용" class="req le" maxlength="500" ev:onkeyup="scwin.ta_bizwrk_atdnc_contnt_onkeyup">
							</xf:textarea>
							<xf:group style="" id="" class="txt_count ri">
								<w2:textbox tagname="p" style="" id="" label="(입력제한 : 10 ~ 500자)" class="txt_limit fs11"></w2:textbox>
								<w2:span class="red" id="tbx_cnt_1" label="0" style=""></w2:span>
								<w2:textbox tagname="span" style="" id="" label=" / 500 자" class="byte" escape="false"></w2:textbox>
							</xf:group>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr" style="">
						<xf:group tagname="th" class="w2tb_th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span style="" id="" label="[필수입력항목]" class="bul_req"></w2:span>
							<w2:textbox tagname="span" style="" id="" label="주요성과&lt;br/&gt;(정책건의사항)" escape="false"></w2:textbox>
						</xf:group>
						<xf:group tagname="td" class="w2tb_td">
							<w2:attributes>
								<w2:colspan>3</w2:colspan>
								<w2:rowspan>1</w2:rowspan>
							</w2:attributes>
							<xf:textarea ref="data:dma_tripAd.polcy_suggst_item" style="height: 80px;" id="ta_polcy_suggst_item"
								title="주요성과(정책건의사항)" class="req le" maxlength="500" ev:onkeyup="scwin.ta_polcy_suggst_item_onkeyup">
							</xf:textarea>
							<xf:group style="" id="" class="txt_count ri">
								<w2:textbox tagname="p" style="" id="" label="(입력제한 : 10 ~ 500자)" class="txt_limit fs11"></w2:textbox>
								<w2:span class="red" id="tbx_cnt_2" label="0" style=""></w2:span>
								<w2:textbox tagname="span" style="" id="" label=" / 500 자" class="byte" escape="false"></w2:textbox>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group class="titleSection" id="" style="height:50px;margin-top:5px;">
				<w2:textbox class="tit_tbl" id="" label="출장경비내역" style="" tagname="h3"></w2:textbox>
				<xf:group class="re" id="" style="">
					<w2:span class="note red" id="" label="1) 일반숙박 : 개인이 법인카드/개인카드 등으로 숙박한 경우, 선택(숙박 증빙 필수) &amp;nbsp;2) 친지숙박 : 자택/기숙사/친지에서 숙박한 경우, 선택(숙박 증빙 불필요)&lt;br/&gt;3) 공동숙박 : 출장자 및 동행자 중 대표자 1명이 숙박 결제를 한 경우, 선택(숙박 증빙 필수) 4) 숙박제공 : 외부기관, 워크숍 등에서 숙박을 제공한 경우, 선택(숙박 증빙 불필요)" style="" escape="false"></w2:span>
				</xf:group>
			</xf:group>
			<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_expns" defaultCellHeight="28" evenRowBackgroundColor="#f7faff"
				id="grd_expns" noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
				rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
				scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 338px;"
				summaryAuto="true" visibleRowNum="3" focusMode="cell" ev:onviewchange="scwin.grd_expns_onviewchange">
				<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
				<w2:header id="header1" style="">
					<w2:row id="row1" style="">
						<w2:column displayMode="label" id="column7" inputType="text" style="height:28px;" value="성명" width="100" colSpan=""
							rowSpan="2">
						</w2:column>
						<w2:column displayMode="label" id="column5" inputType="text" style="height:28px;" value="구분" width="300" colSpan="2"
							rowSpan="2">
						</w2:column>
						<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="기준금액" width="130"></w2:column>
						<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="실사용액" width="130"></w2:column>
						<w2:column displayMode="label" id="column29" inputType="text" style="height:28px;" value="신청금액" width="130"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column104" value="" displayMode="label"></w2:column>
						<w2:column width="140" inputType="text" style="height:28px;" id="column92" value="카드식" displayMode="label"
							colSpan="3" rowSpan="">
						</w2:column>
						<w2:column displayMode="label" id="column30" inputType="text" style="height:28px;" value="법인카드" width="75"></w2:column>
					</w2:row>
					<w2:row style="" id="row3">
						<w2:column width="461" inputType="text" style="height:28px;" id="column38" value="산출근거" displayMode="label"
							colSpan="7" rowSpan="">
						</w2:column>
						<w2:column width="25" inputType="text" style="height:28px" id="column105" value="" displayMode="label"></w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody id="gBody1" style="">
					<w2:row id="" style="">
						<w2:column displayMode="label" id="biztrip_psn_nm" inputType="text" readOnly="true" style="height:24px;" width="100"
							colSpan="" rowSpan="8" class="temp">
						</w2:column>
						<w2:column displayMode="label" escape="false" id="fare_txt" inputType="text" readOnly="true"
							style="vertical-align:middle;" width="70" value="운임" colSpan="" rowSpan="2" class="temp">
						</w2:column>
						<w2:column width="150" inputType="select" style="background-color:#ffc;" id="fare_clsf" value="" displayMode="label"
							colSpan="" rowSpan="2" class="req" viewType="icon" disabled="true">
						</w2:column>
						<w2:column displayMode="label" escape="false" id="fare_fee_max" inputType="text" readOnly="true"
							style="height:28px;" width="130" class="ri" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column class="ri" displayMode="label" id="fare_fee" inputType="text" style="height:28px;" width="130"
							dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column displayMode="label" id="fare_fee_pay" inputType="text" style="height:28px;" width="130" class="ri"
							dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column106" value="" displayMode="label"></w2:column>
						<w2:column width="80" inputType="text" style="height:28px;" id="column94" value="" displayMode="label" colSpan="3"
							rowSpan="" readOnly="true">
						</w2:column>
						<w2:column displayMode="label" id="fare_card_yn" inputType="text" readOnly="true" style="height:28px;" value=""
							width="75" class="ri">
						</w2:column>
					</w2:row>
					<w2:row style="" id="">
						<w2:column width="461" inputType="text" style="height:28px;" id="fare_fee_rmk" value="" displayMode="label"
							colSpan="7" rowSpan="" class="le" readOnly="true">
						</w2:column>
						<w2:column width="25" inputType="text" style="height:28px" id="column107" value="" displayMode="label"></w2:column>
					</w2:row>
					<w2:row id="" style="">
						<w2:column displayMode="label" escape="false" id="lodg_txt" inputType="text" readOnly="true" style="height:56px;"
							width="70" value="숙박" colSpan="" rowSpan="2" class="blue temp">
						</w2:column>
						<w2:column width="150" inputType="select" style="background-color:#ffc;" id="lodg_clsf" value="" displayMode="label"
							colSpan="" rowSpan="2" class="req blue" viewType="icon">
						</w2:column>
						<w2:column displayMode="label" escape="false" id="lodg_fee_max" inputType="text" readOnly="true"
							style="height:28px;" width="130" class="ri blue" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column class="ri blue" displayMode="label" id="lodg_fee" inputType="text"
							style="height:28px;background-color:#ffc;" width="130" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column displayMode="label" id="lodg_fee_pay" inputType="text" style="height:28px;background-color:#ffc;"
							width="130" class="ri blue" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column108" value="" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:0px;" id="column96" value="" displayMode="label" colSpan="3"
							rowSpan="" readOnly="true">
						</w2:column>
						<w2:column displayMode="label" id="lodg_card_yn" inputType="checkbox" style="height:28px;background-color:#ffc;"
							value="" width="75" class="" falseValue="N" trueValue="Y">
						</w2:column>
					</w2:row>
					<w2:row style="" id="">
						<w2:column width="461" inputType="text" style="height:28px;" id="lodg_fee_rmk" value="" displayMode="label"
							colSpan="7" rowSpan="" class="le blue" readOnly="true">
						</w2:column>
						<w2:column width="25" inputType="text" style="height:28px" id="column109" value="" displayMode="label"></w2:column>
					</w2:row>
					<w2:row id="" style="">
						<w2:column displayMode="label" escape="false" id="ymd_txt" inputType="text" readOnly="true" style="height:24px;"
							width="220" value="일비" colSpan="2" rowSpan="2" class="temp">
						</w2:column>
						<w2:column displayMode="label" escape="false" id="ymd_fee_max" inputType="text" readOnly="true" style="height:28px;"
							width="130" class="ri" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column class="ri" displayMode="label" id="ymd_fee" inputType="text" style="height:28px;background-color:#ffc;"
							width="130" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column displayMode="label" id="ymd_fee_pay" inputType="text" style="height:28px;background-color:#ffc;"
							width="130" class="ri" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column110" value="" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:0px;" id="column98" value="" displayMode="label" colSpan="3"
							rowSpan="">
						</w2:column>
						<w2:column displayMode="label" id="column31" inputType="text" readOnly="true" style="height:28px" value=""
							width="75" class="ri">
						</w2:column>
					</w2:row>
					<w2:row style="" id="">
						<w2:column width="461" inputType="text" style="height:28px;" id="ymd_fee_rmk" value="" displayMode="label"
							colSpan="7" rowSpan="" class="le" readOnly="true">
						</w2:column>
						<w2:column width="25" inputType="text" style="height:28px" id="column111" value="" displayMode="label"></w2:column>
					</w2:row>
					<w2:row id="" style="">
						<w2:column displayMode="label" escape="false" id="meal_txt" inputType="text" readOnly="true" style="height:24px;"
							width="220" value="식비" colSpan="2" rowSpan="2" class="temp">
						</w2:column>
						<w2:column displayMode="label" escape="false" id="meal_fee_max" inputType="text" readOnly="true"
							style="height:28px;" width="130" class="ri" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column class="ri" displayMode="label" id="meal_fee" inputType="text" style="height:28px;background-color:#ffc;"
							width="130" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column displayMode="label" id="meal_fee_pay" inputType="text" readOnly="true" style="height:28px;" width="130"
							class="ri" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column112" value="" displayMode="label"></w2:column>
						<w2:column width="45" inputType="text" style="height:28px;color:blue;" id="column100" value="(카드"
							displayMode="label" class="" fixColumnWidth="true">
						</w2:column>
						<w2:column displayMode="label" id="card_meal" inputType="select" style="height:28px;background-color:#ffc;" value=""
							width="50" class="" allOption="" chooseOption="" ref="" fixColumnWidth="true" viewType="icon">
							<w2:choices>
								<w2:itemset nodeset="data:dlt_cardMeal">
									<w2:label ref="label"></w2:label>
									<w2:value ref="value"></w2:value>
								</w2:itemset>
							</w2:choices>
						</w2:column>
						<w2:column width="40" inputType="text" style="height:28px;color:blue;" id="column88" value="식)" displayMode="label"
							fixColumnWidth="true">
						</w2:column>
						<w2:column displayMode="label" id="column32" inputType="text" readOnly="true" style="height:28px" value=""
							width="75" class="ri">
						</w2:column>
					</w2:row>
					<w2:row style="" id="">
						<w2:column width="461" inputType="text" style="height:28px;" id="meal_fee_rmk" value="" displayMode="label"
							colSpan="7" rowSpan="" class="le" readOnly="true">
						</w2:column>
						<w2:column width="25" inputType="text" style="height:28px" id="column113" value="" displayMode="label"></w2:column>
					</w2:row>
				</w2:gBody>
				<w2:subTotal targetColumnID="biztrip_psn_syspayno" style="" id="subTotal1">
					<w2:row style="" id="row6">
						<w2:column width="170" inputType="text" style="height:20px;" id="column67" value="소 계" displayMode="label"
							colSpan="2" rowSpan="">
						</w2:column>
						<w2:column width="150" inputType="text" style="height:20px" id="column65" value="" displayMode="label"></w2:column>
						<w2:column width="130" inputType="expression" style="height:20px; text-align:right !important;" id="column64"
							value="" displayMode="label" dataType="number"
							expression="sum('fare_fee_max') + sum('lodg_fee_max') + sum('ymd_fee_max') + sum('meal_fee_max')" displayFormat="#,###" class="ri">
						</w2:column>
						<w2:column width="130" inputType="expression" style="height:20px; text-align:right !important;;" id="column63"
							value="" displayMode="label" dataType="number" displayFormat="#,###"
							expression="sum('fare_fee') + sum('lodg_fee') + sum('ymd_fee') + sum('meal_fee')" class="ri">
						</w2:column>
						<w2:column width="130" inputType="expression" style="height:20px;text-align:right !important;" id="column62"
							value="" displayMode="label" dataType="number" displayFormat="#,###"
							expression="sum('fare_fee_pay') + sum('lodg_fee_pay') + sum('ymd_fee_pay') + sum('meal_fee_pay')" class="ri">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:20px" id="column114" value="" displayMode="label"></w2:column>
						<w2:column width="206" inputType="text" style="height:20px;" id="column102" value="" displayMode="label" colSpan="4"
							rowSpan="">
						</w2:column>
					</w2:row>
				</w2:subTotal>
				<w2:footer style="" id="footer1">
					<w2:row style="" id="row5">
						<w2:column width="300" inputType="text" style="height:20px;" id="column54" value="총합계" displayMode="label"
							colSpan="2" rowSpan="">
						</w2:column>
						<w2:column width="150" inputType="text" style="height:20px" id="column59" value="" displayMode="label"></w2:column>
						<w2:column width="130" inputType="expression" style="height:20px" id="column52" value="" displayMode="label"
							class="ri" expression="sum('fare_fee_max') + sum('lodg_fee_max') + sum('ymd_fee_max') + sum('meal_fee_max')" dataType="number"
							displayFormat="#,###">
						</w2:column>
						<w2:column width="130" inputType="expression" style="height:20px" id="column51" value="" displayMode="label"
							class="ri" dataType="number" displayFormat="#,###"
							expression="sum('fare_fee') + sum('lodg_fee') + sum('ymd_fee') + sum('meal_fee')">
						</w2:column>
						<w2:column width="130" inputType="expression" style="height:20px" id="totl_trip_fee_pay" value=""
							displayMode="label" class="ri" dataType="number" displayFormat="#,###"
							expression="sum('fare_fee_pay') + sum('lodg_fee_pay') + sum('ymd_fee_pay') + sum('meal_fee_pay')">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:20px" id="column115" value="" displayMode="label"></w2:column>
						<w2:column width="206" inputType="text" style="height:20px;" id="column103" value="" displayMode="label" colSpan="4"
							rowSpan="">
						</w2:column>
					</w2:row>
				</w2:footer>
			</w2:gridView>
			<xf:group class="w2tb tbl" id="grp_excess" style="" tagname="table">
				<w2:attributes>
					<w2:summary></w2:summary>
				</w2:attributes>
				<xf:group tagname="caption" text="숙박비 초과사유"></xf:group>
				<xf:group tagname="colgroup">
					<xf:group style="width:140px;" tagname="col"></xf:group>
					<xf:group style="" tagname="col"></xf:group>
				</xf:group>
				<xf:group style="" tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
						<w2:textbox id="" label="숙박비 초과사유" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-선택-" class="sel"
							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_excess_resn_cd" ref="data:dma_tripAd.excess_resn_cd"
							style="width:500px;" submenuSize="auto">
							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[해당지역에 숙박비 상한액 내에 숙박 가능한 곳이 없는 경우]]></xf:label>
									<xf:value><![CDATA[EXC001]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[해당지역에 숙박시설이 있어도 출장목적지와 거리가 멀어 출장업무 수행에 지장을 초래할 것이 명백한 경우]]></xf:label>
									<xf:value><![CDATA[EXC004]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[학술회의 등의 경우 숙박예정시설로 지정된 숙박시설의 객실요금이 숙박비 상한액을 초과하는 경우]]></xf:label>
									<xf:value><![CDATA[EXC002]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[기타(위와 유사한 사유)]]></xf:label>
									<xf:value><![CDATA[EXC005]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
						<w2:attributes></w2:attributes>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group class="helparea" id="" style="">
				<xf:group id="" style="" tagname="ol">
					<xf:group id="" style="" tagname="li">
						<w2:textbox class="red" id="" label="※ 운임 : 항공/선박운임의 경우, 법인카드/연구비카드 등만 처리가 가능하며, 개인카드 처리 후 청구는 불가합니다." style="" tagname="span"></w2:textbox>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group id="grp_accnt">
				<xf:group style="" id="" class="titleSection">
					<w2:textbox tagname="h3" style="" id="" label="계정내역" class="tit_tbl"></w2:textbox>
					<xf:group id="" class="re">
						<xf:trigger style="" id="btn_bugt" type="button" class="btn  ml10" ev:onclick="scwin.btn_bugt_onclick">
							<xf:label><![CDATA[예산조회]]></xf:label>
						</xf:trigger>
						<xf:group style="" id="" class="btnarea">
							<xf:trigger style="" id="btn_accntPlus" type="button" class="bt_plus"
								ev:onclick="scwin.btn_accntPlus_onclick">
								<xf:label><![CDATA[추가]]></xf:label>
							</xf:trigger>
							<xf:trigger style="" id="btn_accntMinus" type="button" class="bt_minus"
								ev:onclick="scwin.btn_accntMinus_onclick">
								<xf:label><![CDATA[삭제]]></xf:label>
							</xf:trigger>
						</xf:group>
					</xf:group>
				</xf:group>
				<w2:gridView scrollByColumnAdaptive="false" rowNumVisible="true" rowStatusWidth="50" selectedRowColor="#fbf2cd"
					summaryAuto="true" rowNumHeaderValue="No." scrollByColumn="false" defaultCellHeight="28" rowStatusHeaderValue="상태"
					noResultMessage="조회 결과가 없습니다." rowNumBackgroundColor="#fff" noResultMessageClass="noResult" rowStatusVisible="false"
					selectedCellColor="#fbf2cd" rowNumWidth="40" dataList="data:dlt_accnt" evenRowBackgroundColor="#f7faff" style="height: 85px;"
					autoFit="allColumn" id="grd_accnt" visibleRowNum="5" class="grid" rowMouseOverColor="#e7f0fb"
					ev:ontextimageclick="scwin.grd_accnt_ontextimageclick">
					<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
					<w2:header style="" id="header1">
						<w2:row style="" id="row1">
							<w2:column width="40" inputType="text" style="height:28px;" id="column7" value="선택" displayMode="label"
								fixColumnWidth="true">
							</w2:column>
							<w2:column rowSpan="" colSpan="2" width="224" inputType="text" style="height:28px;" id="column5" value="계정정보"
								displayMode="label">
							</w2:column>
							<w2:column width="70" inputType="text" style="height:28px" id="column33" value="과세구분" displayMode="label"></w2:column>
							<w2:column width="70" inputType="text" style="height:28px;" id="column3" value="회계코드" displayMode="label"></w2:column>
							<w2:column width="70" inputType="text" style="height:28px;" id="column20" value="비용코드" displayMode="label"></w2:column>
							<w2:column width="90" inputType="text" style="height:28px;" id="column29" value="금액" class="blue"
								displayMode="label">
							</w2:column>
							<w2:column rowSpan="" colSpan="2" width="140" inputType="text" style="height:28px;" id="column32" value="계정책임자"
								displayMode="label">
							</w2:column>
							<w2:column width="85" inputType="text" style="height:28px" id="column30" value="통제번호" displayMode="label"></w2:column>
						</w2:row>
					</w2:header>
					<w2:gBody style="" id="gBody1">
						<w2:row style="" id="row2">
							<w2:column width="50" inputType="checkbox" style="height:28px;" id="chk" displayMode="label"></w2:column>
							<w2:column width="90" inputType="textImage" readOnly="true" style="height:28px;" id="accnt_no" escape="false"
								value="" displayMode="label" imageSrc="/cm/images/sample/btn_tbsearch02.png">
							</w2:column>
							<w2:column width="160" inputType="text" style="height:28px" readOnly="true" id="accnt_no_nm" value=""
								displayMode="label">
							</w2:column>
							<w2:column width="70" inputType="text" style="height:28px;" id="tax_cd_nm" value="" displayMode="label"
								readOnly="true">
							</w2:column>
							<w2:column width="85" inputType="text" readOnly="true" style="height:28px;" id="accnt_cd" escape="false"
								displayMode="label">
							</w2:column>
							<w2:column ref="" chooseOption="" width="70" inputType="select" readOnly="true" style="height:28px;"
								id="expns_cd" allOption="" displayMode="label">
								<w2:choices>
									<w2:item>
										<w2:label><![CDATA[국내여비]]></w2:label>
										<w2:value><![CDATA[271]]></w2:value>
									</w2:item>
									<w2:item>
										<w2:label><![CDATA[평가관리비]]></w2:label>
										<w2:value><![CDATA[394]]></w2:value>
									</w2:item>
								</w2:choices>
							</w2:column>
							<w2:column dataType="number" width="90" displayFormat="#,###" inputType="text" style="height:28px;"
								id="tot_expns" class="ri" displayMode="label">
							</w2:column>
							<w2:column width="70" inputType="text" readOnly="true" style="height:28px" id="accnt_rspns_empno"
								displayMode="label">
							</w2:column>
							<w2:column width="80" inputType="text" style="height:28px" readOnly="true" id="accnt_rspns_nm" value=""
								displayMode="label">
							</w2:column>
							<w2:column width="85" inputType="text" readOnly="true" style="height:28px" id="bugt_ctrl_no" value=""
								displayMode="label">
							</w2:column>
						</w2:row>
					</w2:gBody>
				</w2:gridView>
			</xf:group>
			<xf:group id="grp_pay">
				<xf:group style="" id="" class="titleSection">
					<w2:textbox tagname="h3" style="" id="" label="지급내역" class="tit_tbl"></w2:textbox>

					<xf:group id="" class="re"></xf:group>
				</xf:group>
				<w2:gridView scrollByColumnAdaptive="false" rowNumVisible="true" rowStatusWidth="50" selectedRowColor="#fbf2cd"
					summaryAuto="true" rowNumHeaderValue="No." scrollByColumn="false" defaultCellHeight="28" rowStatusHeaderValue="상태"
					noResultMessage="조회 결과가 없습니다." rowNumBackgroundColor="#fff" noResultMessageClass="noResult" rowStatusVisible="false"
					selectedCellColor="#fbf2cd" rowNumWidth="40" dataList="data:dlt_pay" evenRowBackgroundColor="#f7faff" style="height: 85px;"
					autoFit="allColumn" id="grd_pay" visibleRowNum="5" class="grid" rowMouseOverColor="#e7f0fb">
					<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
					<w2:header style="" id="header1">
						<w2:row style="" id="row1">
							<w2:column width="90" inputType="text" style="height:28px;" id="column5" value="구분" displayMode="label"></w2:column>
							<w2:column rowSpan="" colSpan="2" width="140" inputType="text" style="height:28px;" id="column3" value="지급자"
								displayMode="label">
							</w2:column>
							<w2:column width="90" inputType="text" style="height:28px;" id="column20" value="실사용액" displayMode="label"></w2:column>
							<w2:column width="90" inputType="text" style="height:28px;" id="column29" value="지급액" displayMode="label"></w2:column>
							<w2:column width="100" inputType="text" style="height:28px" id="column32" value="은행" displayMode="label"></w2:column>
							<w2:column width="80" inputType="text" style="height:28px" id="column30" value="예금주" displayMode="label"></w2:column>
							<w2:column width="200" inputType="text" style="height:28px" id="column34" value="비고" displayMode="label"></w2:column>
						</w2:row>
					</w2:header>
					<w2:gBody style="" id="gBody1">
						<w2:row style="" id="row2">
							<w2:column ref="" chooseOption="" width="90" inputType="select" readOnly="true" style="height:28px;"
								id="pay_clsf" allOption="" escape="false" displayMode="label">
								<w2:choices>
									<w2:item>
										<w2:label><![CDATA[개인지급]]></w2:label>
										<w2:value><![CDATA[FAX010]]></w2:value>
									</w2:item>
									<w2:item>
										<w2:label><![CDATA[기타(송금)지급]]></w2:label>
										<w2:value><![CDATA[FAX090]]></w2:value>
									</w2:item>
								</w2:choices>
							</w2:column>
							<w2:column width="70" inputType="text" readOnly="true" style="height:28px;" id="biztrip_psn_empno"
								escape="false" displayMode="label">
							</w2:column>
							<w2:column width="70" inputType="text" style="height:28px" readOnly="true" id="biztrip_psn_nm" value=""
								displayMode="label">
							</w2:column>
							<w2:column dataType="number" width="90" displayFormat="#,###" inputType="text" readOnly="true"
								style="height:28px;" id="truth_use_amt" class="ri" displayMode="label">
							</w2:column>
							<w2:column dataType="number" width="90" displayFormat="#,###" inputType="text" readOnly="true"
								style="height:28px;" id="adjst_amt" class="ri" displayMode="label">
							</w2:column>
							<w2:column width="100" inputType="select" readOnly="true" style="height:28px" id="bank_cd"
								displayMode="label">
							</w2:column>
							<w2:column width="80" inputType="text" readOnly="true" style="height:28px" id="depstr" displayMode="label">
							</w2:column>
							<w2:column width="200" inputType="text" style="height:28px" readOnly="true" id="rmk" value=""
								displayMode="label">
							</w2:column>
						</w2:row>
					</w2:gBody>
					<w2:footer style="" id="footer1">
						<w2:row style="" id="row3">
							<w2:column rowSpan="" colSpan="2" width="140" inputType="text" style="height:20px;" id="column42" value="합계"
								displayMode="label">
							</w2:column>
							<w2:column width="70" inputType="text" style="height:20px" id="column45" value="" displayMode="label"></w2:column>
							<w2:column expression="sum('truth_use_amt')" dataType="number" width="90" displayFormat="#,###"
								inputType="expression" style="height:20px" id="truth_use_amt_sum" value="" class="ri" displayMode="label">
							</w2:column>
							<w2:column expression="sum('adjst_amt')" dataType="number" width="90" displayFormat="#,###"
								inputType="expression" style="height:20px" id="adjst_amt_sum" value="" class="ri" displayMode="label">
							</w2:column>
							<w2:column width="100" inputType="text" style="height:20px" id="column38" value="" displayMode="label"></w2:column>
							<w2:column width="80" inputType="text" style="height:20px" id="column37" value="" displayMode="label"></w2:column>
							<w2:column width="200" inputType="text" style="height:20px" id="column36" value="" displayMode="label"></w2:column>
						</w2:row>
					</w2:footer>
				</w2:gridView>
			</xf:group>
			<xf:group class="btnGroup" id="" style="">
				<xf:group class="le" id="" style=""></xf:group>
				<xf:group class="ri" id="">
					<xf:trigger class="btn pro" id="btn_mngSave" style="" type="button" ev:onclick="scwin.btn_mngSave_onclick">
						<xf:label><![CDATA[담당자저장]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn pro" disabled="true" ev:onclick="scwin.btn_del_onclick" id="btn_del" style="" type="button">
						<xf:label><![CDATA[삭제]]></xf:label>
					</xf:trigger>
					<xf:trigger class=" btn pro conf" id="btn_save" style="" type="button" ev:onclick="scwin.btn_save_onclick">
						<xf:label><![CDATA[저장]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
		</xf:group>
	</body>
</html>
