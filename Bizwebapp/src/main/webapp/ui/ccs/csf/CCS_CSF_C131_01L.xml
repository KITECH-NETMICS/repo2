<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head meta_programName="보안안전교육(관)" meta_programId="F312" meta_author="전재우" meta_date="2023.08.03.">
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="year" name="year" dataType="text"></w2:key>
						<w2:key id="educ_psn_nm" name="educ_psn_nm" dataType="text"></w2:key>
						<w2:key id="educ_psn_empno" name="educ_psn_empno" dataType="text"></w2:key>
						<w2:key id="educ_psn_syspayno" name="educ_psn_syspayno" dataType="text"></w2:key>
						<w2:key id="dept_cd" name="dept_cd" dataType="text"></w2:key>
						<w2:key id="search_div" name="search_div" dataType="text"></w2:key>
						<w2:key id="educ_typ" name="educ_typ" dataType="text"></w2:key>
						<w2:key id="educ_knd" name="educ_knd" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_mast">
					<w2:keyInfo>
						<w2:key id="year" name="년도" dataType="text"></w2:key>
						<w2:key id="educ_ymd" name="교육일자" dataType="text"></w2:key>
						<w2:key id="educ_psn_nm" name="성명" dataType="text"></w2:key>
						<w2:key id="empno" name="시스템사번" dataType="text"></w2:key>
						<w2:key id="work_region" name="지역" dataType="text"></w2:key>
						<w2:key id="educ_typ" name="교육구분" dataType="text"></w2:key>
						<w2:key id="educ_knd" name="교육종류" dataType="text"></w2:key>
						<w2:key id="educ_knd_grp" name="교육종류그룹" dataType="text"></w2:key>
						<w2:key id="complt_time" name="이수시간" dataType="text"></w2:key>
						<w2:key id="educ_time" name="교육시기" dataType="text"></w2:key>
						<w2:key id="rmk" name="비고" dataType="text"></w2:key>
						<w2:key id="educ_psn_syspayno" name="educ_psn_syspayno" dataType="text"></w2:key>
						<w2:key id="job_flag" name="cu구분" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_grd" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="chk" name="chk" dataType="text"></w2:column>
						<w2:column id="year" name="년도" dataType="text"></w2:column>
						<w2:column id="educ_ymd" name="교육일자" dataType="text"></w2:column>
						<w2:column id="educ_psn_syspayno" name="educ_psn_syspayno" dataType="text"></w2:column>
						<w2:column id="educ_psn_nm" name="educ_psn_nm" dataType="text"></w2:column>
						<w2:column id="dept_new_ymd" name="dept_new_ymd" dataType="text"></w2:column>
						<w2:column id="dept_cd" name="dept_cd" dataType="text"></w2:column>
						<w2:column id="dept_nm" name="dept_nm" dataType="text"></w2:column>
						<w2:column id="posi_nm" name="posi_nm" dataType="text"></w2:column>
						<w2:column id="work_region" name="work_region" dataType="text"></w2:column>
						<w2:column id="work_region_nm" name="work_region_nm" dataType="text"></w2:column>
						<w2:column id="educ_typ" name="교육구분코드" dataType="text"></w2:column>
						<w2:column id="educ_typ_nm" name="교육구분명" dataType="text"></w2:column>
						<w2:column id="educ_knd" name="교육명코드" dataType="text"></w2:column>
						<w2:column id="educ_knd_nm" name="교육명" dataType="text"></w2:column>
						<w2:column id="educ_time" name="시기" dataType="text"></w2:column>
						<w2:column id="complt_time" name="이수시간" dataType="text"></w2:column>
						<w2:column id="rmk" name="비고" dataType="text"></w2:column>
						<w2:column id="empno" name="개인번호" dataType="text"></w2:column>
						<w2:column id="entr_ymd" name="입원일자" dataType="text"></w2:column>
						<w2:column id="retire_ymd" name="퇴원일자" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_eductyp_list" saveRemovedData="true">
				  <w2:columnInfo>
				       <w2:column id="educ_year" name="educ_year" dataType="text"></w2:column>
				       <w2:column id="educ_typ" name="educ_typ" dataType="text"></w2:column>
				       <w2:column id="cd_nm" name="cd_nm" dataType="text"></w2:column>
				  </w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_eduknd_list" saveRemovedData="true">
				  <w2:columnInfo>
				       <w2:column id="educ_typ" name="educ_typ" dataType="text"></w2:column>
				       <w2:column id="educ_cd" name="educ_cd" dataType="text"></w2:column>
				       <w2:column id="cd_nm" name="cd_nm" dataType="text"></w2:column>
				  </w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection />
			<!-- 조회 -->
			<xf:submission id="sbm_selectData" ref="data:json,dma_search" target='' action="SvcCCSCGSEDUMR01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 교육구분 조회 -->
			<xf:submission id="sbm_selectEducTypCd" ref="data:json,dma_mast" target='' action="SvcCCSCGSEDUTYPCD01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 교육종류 조회 -->
			<xf:submission id="sbm_selectEducKndCd" ref="data:json,dma_mast" target='' action="SvcCCSCGSEDUKNDCD01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 교육 저장 -->
			<xf:submission id="sbm_saveData" ref="data:json,dma_mast" target='' action="SvcCCSCGSEDUMI01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 교육 삭제 -->
			<xf:submission id="sbm_deleteData" ref="data:json,dma_mast" target='' action="SvcCCSCGSEDUMD01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- 교육 저장 -->
			<xf:submission id="sbm_savesData" ref='data:json,{"action":"modified", "id":"dlt_grd", "key":"csfSecrtEduVoList"}' target='' action="SvcCCSCGSEDUMIS01.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		<script type="text/javascript" lazy="false"><![CDATA[
	/*
     *  날짜 설정
     */
	var now = new Date();
	var defalutday = gcm.date.formatDateTime(now, "yyyyMMddHHmm"); // yyyyMMddHHmm
	var ymd = gcm.date.formatDateTime(now); // yyyyMMdd 
	var year = ymd.substr(0, 4); // yyyy
	
	var sn = com.getLoginInfo("sn");
	var jobFlag = "new";
	var excelUpYn = "N";
	var saveYn = "N";
	
    /*
     * 페이지 열기
     */          
	scwin.onpageload = function() {
		scwin.service_id = com.getParameter("menuObj").serviceID;
		
		if(scwin.service_id == "H171"){
			save_title.setValue("개인별 법정교육 등록/수정");
		}else{
			save_title.setValue("개인별 보안안전교육 등록/수정");
		}
		
		ica_year.setValue(year);
		
		var codeOptions = [ 
							{code : "HDI", compID : "sbx_educ_typ"},
							{code : "HDO", compID : "sbx_educ_knd"},
							{code : "HBX", compID : "sbx_work_region"}
		               	  ];		
		com.setCmnCd(codeOptions, function(){
			var retHDI = com.getComponent(gcm.CMNCD_INFO.DATA_PREFIX + "HDI");
			let dataHDI = [];
			for(let i = 0 ; i < retHDI.getDataLength() ; i++){
				dataHDI.push(
					{
						cd_nm: retHDI.getCellData(i, gcm.CMNCD_INFO.LABEL),
						educ_typ : retHDI.getCellData(i, gcm.CMNCD_INFO.VALUE)
					}
				)
			}
			dlt_eductyp_list.setJSON(dataHDI);
			
			var retHDO = com.getComponent(gcm.CMNCD_INFO.DATA_PREFIX + "HDO");
			let dataHDO = [];
			for(let i = 0 ; i < retHDO.getDataLength() ; i++){
				dataHDO.push(
					{
						cd_nm: retHDO.getCellData(i, gcm.CMNCD_INFO.LABEL),
						educ_cd : retHDO.getCellData(i, gcm.CMNCD_INFO.VALUE)
					}
				)
			}
			dlt_eduknd_list.setJSON(dataHDO);
		});
		
		com.setEnterKeyEvent(grp_hum_search, scwin.btn_search_hum_onclick);
		com.setEnterKeyEvent(grp_hum_search_2, scwin.btn_search_hum_onclick_2);
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/*
     *  조회버튼 클릭 이벤트
     */
	scwin.btn_search_onclick = function(e) {
		scwin.search();
	};
	
	/*
    *  조회
    */
	scwin.search = function() {		
		com.execute(sbm_selectData, {
			successCallback : function(e){
				tbx_result.setValue(dlt_grd.getRowCount());
				dlt_grd.setJSON(e.responseJSON.csfSecrtEduVoList);
				
				var grdCount = dlt_grd.getRowCount();
				for(var i=0; i<grdCount; i++){
					if(dlt_grd.getCellData(i, "educ_knd") != ""){
//						grd_list.setCellDisabled(i, "year", true);
//						grd_list.setCellDisabled(i, "educ_ymd", true);
//						grd_list.setCellDisabled(i, "educ_knd", true);
//						grd_list.setCellDisabled(i, "educ_time", true);
//						grd_list.setCellDisabled(i, "educ_psn_syspayno", true);
//						grd_list.setCellDisabled(i, "user_pop", true);
						dlt_grd.modifyRowStatus(i, "U");
					}else{
						dlt_grd.modifyRowStatus(i, "R");
					}
//					grd_list.setCellDisabled(i, "year", true);
//					grd_list.setCellDisabled(i, "educ_psn_syspayno", true);
//					grd_list.setCellDisabled(i, "user_pop", true);
//					grd_list.setCellDisabled(i, "empno", true);
//					grd_list.setCellDisabled(i, "entr_ymd", true);
				}
			}
		});
	};
	
	/*
     *  사원번호 변경 이벤트
     */
	scwin.ibx_search_hum_onchange = function(info) {
		if (this.getValue() == "") {
			tb_nm.setValue("");
			dma_search.set("educ_psn_syspayno", "");
		}
	};
	
	/*
     *  사원검색 검색 버튼 클릭 이벤트
     */
	scwin.btn_search_hum_onclick = function(e) {
		scwin.selectHumBtn(inp_empno.getValue());
	};
	
	/*
     *  직원검색 팝업 호출
     */
	scwin.selectHumBtn = function(empNo) {
		var data = {
			empno : empNo,
			work_clsf : "HAG010",
			ref_yn : (empNo == "")? "Y" : "N"
		};
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			if (ret) {
				dma_search.set("educ_psn_empno", ret.empno);
				dma_search.set("educ_psn_nm", ret.nm);
				dma_search.set("educ_psn_syspayno", ret.syspayno);
			}
		});
	};
	
	scwin.btn_excel_onclick = function(e) {
		if(dlt_grd.getRowCount() == 0) return;
		
		var option = {
			    fileName : "보안안전교육현황.xlsx"
			  , useDataFormat : true
			  , removeColumns : "0, 5, 6, 7"
//			  , hiddenVisible : true
		};
		com.downloadGridExcel(grd_list, option);
	};
	
	scwin.grd_list_oncellclick = async function(row,col,colId) {
		if(colId == "educ_psn_nm"){
			var vYr = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("year"));
			var vEducYmd = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("educ_ymd"));
			var vEmpNo = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("empno"));
			var vEducPsnNm = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("educ_psn_nm"));
			var vEducPsnSyspayno = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("educ_psn_syspayno"));
			var vWorkRegion = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("work_region"));
			var vEducCd = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("educ_typ"));
			var vEducKnd = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("educ_knd"));
			var vCompltTime = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("complt_time"));
			var vEducTime = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("educ_time"));
			var vRmk = dlt_grd.getCellData(row, dlt_grd.getColumnIndex("rmk"));
			
			jobFlag = "update";
			tbx_save_info.setValue("* 수정 또는 삭제 상태입니다.");
			dma_mast.set("year", vYr);
			dma_mast.set("educ_ymd", vEducYmd);
			dma_mast.set("empno", vEmpNo);
			dma_mast.set("educ_psn_nm", vEducPsnNm);
			dma_mast.set("educ_psn_syspayno", vEducPsnSyspayno);
			dma_mast.set("work_region", vWorkRegion);
			dma_mast.set("complt_time", vCompltTime);
			dma_mast.set("educ_time", vEducTime);
			dma_mast.set("rmk", vRmk);
			dma_mast.set("educ_typ", vEducCd);
			dma_mast.set("educ_knd", vEducKnd);
			
			await scwin.setEducSbx();
			debugger
			dma_mast.set("educ_typ", vEducCd);
			dma_mast.set("educ_knd", vEducKnd);
			
			ica_year_ins.setDisabled(true);
			ica_educ_ymd.setDisabled(true);
			ica_empno.setDisabled(true);
			btn_search_hum_2.setDisabled(true);
			ibx_educ_time.setDisabled(true);
			sbx_educ_typ_ins.setDisabled(true);
			sbx_educ_knd_ins.setDisabled(true);
			btn_trigger_delete.setDisabled(false);
		}
	};
	
	scwin.btn_search_hum_onclick_2 = function(e) {
		var data = {
			empno : ica_empno.getValue(),
			work_clsf : "HAG010",
			ref_yn : (ica_empno.getValue() == "")? "Y" : "N"
		};
		
		com.pop.open( com.pop.TYPE.HUM, data, function(ret){
			if (ret) {
				dma_mast.set("empno", ret.empno);
				dma_mast.set("educ_psn_nm", ret.nm);
				dma_mast.set("educ_psn_syspayno", ret.syspayno);
				if(jobFlag != "update" && saveYn != "Y"){
					scwin.setEducSbx();
				}
				saveYn = "N";
			}
		});
	};
	
	scwin.setEducSbx = async function(e) {
			if(ica_year_ins.getValue() == ""){
				alert("교육년도 입력은 필수사항 입니다.");
				ica_year_ins.focus();
				return;
			}
			
			if(ica_empno.getValue() == ""){
				alert("성명 입력은 필수사항 입니다.");
				ica_empno.focus();
				return;
			}
			
			dlt_eductyp_list.removeAll();
			dlt_eduknd_list.removeAll();
			
			try {
				let retJson = await com.execute(sbm_selectEducTypCd);
				
				if(retJson.responseJSON.csfSecrtEduVoList.length < 2){
					alert(ica_year_ins.getValue() +"년도에 등록된 교육이 없습니다. \n입력한 년도를 확인해주세요.");
				} else {
					dlt_eductyp_list.setJSON(retJson.responseJSON.csfSecrtEduVoList);
					var eductypData = dlt_eductyp_list.getColData("educ_typ");
					var eductypDataAddGubun = eductypData.join(',');
					dma_mast.set("educ_knd_grp", eductypDataAddGubun);
					
					retJson = await com.execute(sbm_selectEducKndCd);
					dlt_eduknd_list.setJSON(retJson.responseJSON.csfSecrtEduVoList);
				}
			} catch (e) {
				throw e;
			}
	}
	
	scwin.tb_empno_onchange = function(info) {
		if (this.getValue() == "") {
			ica_nm.setValue("");
			dma_mast.set("educ_psn_syspayno", "");
		}
	};
	
	scwin.ica_year_ins_onchange = function() {
		if(jobFlag != "update" && saveYn != "Y"){
			scwin.setEducSbx();
		}
		saveYn = "N";
	};
	
	scwin.btn_save_onclick = function(e) {
		if(!com.validateData(dma_mast,[
			{ id : "year", mandatory : true},
			{ id : "educ_ymd", mandatory : true},
			{ id : "empno", mandatory : true},
			{ id : "work_region", mandatory : true},
			{ id : "complt_time", mandatory : true}
			], false)
		) return;
		
		if(jobFlag != "update"){
			if(!com.validateData(dma_mast,[
				{ id : "educ_typ", mandatory : true},
				{ id : "educ_knd", mandatory : true}
				], false)
			) return;
		}
		com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
			if(ret){
				scwin.save();
			}
		});	
		
	};
	
	scwin.save = function() {
		if(jobFlag == "new"){
			dma_mast.set("regst_syspayno", sn);
		}else if(jobFlag == "update"){
			dma_mast.set("updt_syspayno", sn);
		}
		dma_mast.set("job_flag", jobFlag);
		
		com.execute(sbm_saveData, {
			successCallback : function(e) { // 성공 콜백
				com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
					saveYn = "Y";
					scwin.search();
					scwin.input_form_reset();
				});					
			}
		});
	};
	
	scwin.input_form_reset = function(){
		jobFlag = "new";
		tbx_save_info.setValue("* 신규저장 상태입니다.");
		dma_mast.set("rmk", "");
		dma_mast.set("year", "");
		dma_mast.set("educ_ymd", ymd);
		dma_mast.set("educ_knd", "");
		dma_mast.set("educ_typ", "");
		dma_mast.set("educ_time", "");
		dma_mast.set("complt_time", "");
		dma_mast.set("empno", "");
		dma_mast.set("educ_psn_nm", "");
		dma_mast.set("educ_psn_syspayno", "");
		dma_mast.set("work_region", "");
		dma_mast.set("work_region", "");
		dma_mast.set("work_region", "");
		ica_year_ins.setDisabled(false);
		ica_educ_ymd.setDisabled(false);
		ica_empno.setDisabled(false);
		btn_search_hum_2.setDisabled(false);
		sbx_work_region.setDisabled(false);
		ibx_educ_time.setDisabled(false);
		sbx_educ_typ_ins.setDisabled(false);
		sbx_educ_knd_ins.setDisabled(false);
		ibx_complt_time.setDisabled(false);
		ibx_rmk.setDisabled(false);
		btn_trigger_delete.setDisabled(false);
	}
	
	scwin.btn_reset_onclick = function(e) {
		scwin.input_form_reset();
	};
	
	scwin.btn_delete_onclick = function(e) {
		com.confirm("message.xom.wq.022"/*삭제 하시겠습니까?*/, function(ret) {
			if(ret){
				com.execute(sbm_deleteData, {
					successCallback : function(e) { // 성공 콜백
						com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
							saveYn = "Y";
							scwin.search();
							scwin.input_form_reset();
						});					
					}
				});
			}
		});
	};
	
	scwin.btn_upLoad_onclick = function(e) {
		dlt_grd.removeAll();
		tbx_result.setValue(0);
		var option = {
			  type: "1"
			, sheetNo: 0
			, headerExist: "1"
			, hidden: "0,3,4,5,6,7"
			, fillHidden: "1"
			, append: "0"
		};
		com.uploadGridExcel(grd_list, option);
	};
	
	scwin.btn_down_onclick = function(e) {
		scwin.downFileinfo("보안안전교육_업로드.xlsx","csfeduresult_upload.xlsx");
	};
	
	/*
     * 파일 다운로드
     */
	scwin.downFileinfo = function downFileinfo(file_nm,file_no){
		var url = "/SvcAttachDown.do?fileName=web_folder/bizdoc/ccs/csf/"+file_no+"&realName="+encodeURIComponent(file_nm)+"&bizKind=OLD";		
		window.open(url, '_blank').focus();
	};
	
	scwin.btn_saves_onclick = function(e) {
		if(excelUpYn == "Y"){
			if(!com.validateData(dlt_grd,[
				{ id : "year", mandatory : true},
				{ id : "educ_ymd", mandatory : true},
				{ id : "educ_typ", mandatory : true},
				{ id : "educ_knd", mandatory : true},
				{ id : "empno", mandatory : true}
				], false)
			) return;
			
			com.confirm("message.xom.wq.017"/*저장 하시겠습니까?*/, function(ret){
				if(ret){
					com.execute(sbm_savesData, {
						successCallback : function(e) {
							com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/, function(){
								saveYn = "Y";
								scwin.btn_search_onclick();
								excelUpYn = "N";
							});
						}
					});
				}
			})
		} else {
			alert("엑셀 업로드인 경우에만 저장이 가능합니다.");
		}
	};
	
	scwin.grd_list_onfilereadend = function(value) {
		if(!com.validateData(dlt_grd,[
			{ id : "year", mandatory : true},
			{ id : "educ_ymd", mandatory : true},
			{ id : "educ_typ", mandatory : true},
			{ id : "educ_knd", mandatory : true},
			{ id : "empno", mandatory : true}
			], false)
		) return;
		
		excelUpYn = "Y";
	};
	
	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload">
		<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
		<xf:group id="" class="pageWrap">
			<xf:group style="" id="" class="searchSection">
				<xf:group id="grp_search" class="schbox">
					<xf:group tagname="table" style="" id="" class="w2tb tbl">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="caption" text="조회조건"></xf:group>
						<xf:group tagname="colgroup">
							<xf:group tagname="col" style="width:70px;"></xf:group>
							<xf:group tagname="col" style="width:200px;"></xf:group>
							<xf:group tagname="col" style="width:70px;"></xf:group>
							<xf:group tagname="col" style="width:270px;"></xf:group>
							<xf:group style="width:70px;" tagname="col"></xf:group>
							<xf:group style="" tagname="col"></xf:group>
						</xf:group>
						<xf:group style="" tagname="tr">
							<xf:group class="w2tb_th" style="" tagname="th">
								<w2:attributes></w2:attributes>
								<w2:textbox id="" label="조회구분" style="" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td" style="" tagname="td">
								<w2:attributes></w2:attributes>
								<xf:select1 allOption="" appearance="minimal" chooseOption="" chooseOptionLabel="-전체-" class="sel"
									direction="auto" disabled="true" disabledClass="w2selectbox_disabled" id="sbx_search_div" ref="data:dma_search.search_div" style="width:150px;"
									submenuSize="auto">
									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[교육이수대상]]></xf:label>
											<xf:value><![CDATA[1]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[전체인원대상]]></xf:label>
											<xf:value><![CDATA[2]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group class="w2tb_th" style="" tagname="th">
								<w2:attributes></w2:attributes>
								<w2:textbox id="" label="년도" style="" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td" style="" tagname="td">
								<w2:attributes></w2:attributes>
								<w2:inputCalendar calendarValueType="year" class="inpcal" focusOnDateSelect="false" footerDiv="false"
									id="ica_year" placeholder="년도" ref="data:dma_search.year" renderDiv="true" rightAlign="false" style="">
								</w2:inputCalendar>
							</xf:group>
							<xf:group class="w2tb_th" style="" tagname="th">
								<w2:attributes></w2:attributes>
								<w2:textbox id="" label="이름" style="" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group class="w2tb_td" style="" tagname="td">
								<w2:attributes>
									<w2:colspan>1</w2:colspan>
									<w2:rowspan>1</w2:rowspan>
								</w2:attributes>
								<xf:group class="inpSch" id="grp_hum_search" style="width: 100px;">
									<xf:input adjustMaxLength="false" class="inp" ev:onchange="scwin.ibx_search_hum_onchange"
										id="inp_empno" ref="data:dma_search.educ_psn_empno" style="" title="성명">
									</xf:input>
									<xf:trigger class="btn" ev:onclick="scwin.btn_search_hum_onclick" id="btn_search_hum" style=""
										title="성명 조회" type="button">
										<xf:label><![CDATA[검색]]></xf:label>
									</xf:trigger>
								</xf:group>
								<xf:input adjustMaxLength="false" class="inp" disabled="true" id="tb_nm" ref="data:dma_search.educ_psn_nm"
									style="width: 100px;" title="성명상세 ">
								</xf:input>
							</xf:group>
						</xf:group>
						<xf:group tagname="tr">
							<xf:group tagname="th" class="w2tb_th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
								<w2:textbox id="" label="교육구분" style="" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group tagname="td" class="w2tb_td">
								<w2:attributes></w2:attributes>
								<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-전체-" class="sel"
									direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_educ_typ" ref="data:dma_search.educ_typ"
									style="width:170px;" submenuSize="auto">
									<xf:choices></xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group tagname="th" class="w2tb_th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
								<w2:textbox id="" label="교육명" style="" tagname="span"></w2:textbox>
							</xf:group>
							<xf:group tagname="td" class="w2tb_td">
								<w2:attributes></w2:attributes>
								<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-전체-" class="sel"
									direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_educ_knd" ref="data:dma_search.educ_knd"
									style="width:250px;" submenuSize="auto">
									<xf:choices></xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group tagname="th" class="w2tb_th">
								<w2:attributes>
									<w2:scope>row</w2:scope>
								</w2:attributes>
							</xf:group>
							<xf:group tagname="td" class="w2tb_td">
								<w2:attributes></w2:attributes>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group id="" class="schbtn">
					<xf:trigger class="btn icon down" ev:onclick="scwin.btn_excel_onclick" id="btn_excel" style="" type="button">
						<xf:label><![CDATA[엑셀다운로드]]></xf:label>
					</xf:trigger>
					<xf:trigger style="" id="btn_search" type="button" class="btn search" ev:onclick="scwin.btn_search_onclick">
						<xf:label><![CDATA[조회]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
			<xf:group class="titleSection" id="" style="margin-top:5px;">
				<xf:group class="le" id="" style="">
					<xf:group class="result" id="">
						<w2:span id="" label="*조회결과 " style=""></w2:span>
						<w2:span class="numtotal" id="tbx_result" label="0" style=""></w2:span>
						<w2:span id="" label="건" style=""></w2:span>
					</xf:group>
				</xf:group>
				<xf:group class="ri" id="" style="">
					<xf:trigger class="btn icon down" ev:onclick="scwin.btn_down_onclick" id="btn_down" style="" type="button">
						<xf:label><![CDATA[엑셀업로드양식]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn" ev:onclick="scwin.btn_upLoad_onclick" id="btn_upLoad" style="" type="button">
						<xf:label><![CDATA[엑셀업로드]]></xf:label>
					</xf:trigger>
					<xf:trigger class="btn" ev:onclick="scwin.btn_saves_onclick" id="btn_save" style="" type="button">
						<xf:label><![CDATA[저장]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
			<w2:gridView class="grid" dataList="data:dlt_grd" defaultCellHeight="28" evenRowBackgroundColor="#f7faff" id="grd_list"
				noResultMessage="조회 결과가 없습니다." noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff"
				rowNumHeaderValue="No." rowNumVisible="true" rowNumWidth="40" rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="50"
				scrollByColumn="false" scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" style="height: 100px;"
				summaryAuto="true" fixedColumn="8" sortable="true" readOnly="true" ev:oncellclick="scwin.grd_list_oncellclick" autoFit="allColumn"
				visibleRowNum="16" ev:onfilereadend="scwin.grd_list_onfilereadend">
				<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
				<w2:header id="header1" style="">
					<w2:row style="" id="row3">
						<w2:column width="70" inputType="text" style="height:28px" id="column186" value="선택" displayMode="label"
							hidden="true">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column195" value="년도" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px" id="column197" value="교육일자" displayMode="label"></w2:column>
						<w2:column width="80" inputType="text" style="height:28px" id="column199" value="개인번호" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px;" id="column201" value="성명" displayMode="label" colSpan=""
							rowSpan="">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column207" value="" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column205" value="" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="column209" value="부서명" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="column211" value="직급명" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column213" value="지역코드" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="column215" value="근무지" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column217" value="교육구분코드" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="column219" value="교육구분명" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column221" value="교육명코드" displayMode="label"></w2:column>
						<w2:column width="160" inputType="text" style="height:28px" id="column223" value="교육명" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column225" value="시기" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="column227" value="이수시간" displayMode="label"></w2:column>
						<w2:column width="160" inputType="text" style="height:28px" id="column235" value="비고" displayMode="label"></w2:column>
						<w2:column width="80" inputType="text" style="height:28px" id="column233" value="개인번호" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px" id="column231" value="입원일자" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px" id="column229" value="퇴직일자" displayMode="label"></w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody id="gBody1" style="">
					<w2:row id="row2" style="">
						<w2:column width="70" inputType="text" style="height:28px" id="chk" value="" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="year" value="" displayMode="label" dataType="date">
						</w2:column>
						<w2:column width="100" inputType="text" style="height:28px" id="educ_ymd" value="" displayMode="label"
							dataType="date" displayFormat="yyyy-MM-dd">
						</w2:column>
						<w2:column width="80" inputType="text" style="height:28px" id="educ_psn_syspayno" value="" displayMode="label"></w2:column>
						<w2:column width="70" inputType="link" style="height:28px" id="educ_psn_nm" value="" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="dept_new_ymd" value="" displayMode="label"
							hidden="true">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="dept_cd" value="" displayMode="label"
							hidden="true">
						</w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="dept_nm" value="" displayMode="label"
							textAlign="left">
						</w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="posi_nm" value="" displayMode="label"
							textAlign="left">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="work_region" value="" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="work_region_nm" value="" displayMode="label"
							textAlign="left">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="educ_typ" value="" displayMode="label"></w2:column>
						<w2:column width="120" inputType="text" style="height:28px" id="educ_typ_nm" value="" displayMode="label"
							textAlign="left">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="educ_knd" value="" displayMode="label"></w2:column>
						<w2:column width="160" inputType="text" style="height:28px" id="educ_knd_nm" value="" displayMode="label"
							textAlign="left">
						</w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="educ_time" value="" displayMode="label"></w2:column>
						<w2:column width="70" inputType="text" style="height:28px" id="complt_time" value="" displayMode="label"></w2:column>
						<w2:column width="160" inputType="text" style="height:28px" id="rmk" value="" displayMode="label"
							textAlign="left">
						</w2:column>
						<w2:column width="80" inputType="text" style="height:28px" id="empno" value="" displayMode="label"></w2:column>
						<w2:column width="100" inputType="text" style="height:28px" id="entr_ymd" value="" displayMode="label"
							dataType="date" displayFormat="yyyy-MM-dd">
						</w2:column>
						<w2:column width="100" inputType="text" style="height:28px" id="retire_ymd" value="" displayMode="label"
							dataType="date" displayFormat="yyyy-MM-dd">
						</w2:column>
					</w2:row>
				</w2:gBody>
			</w2:gridView>
			<xf:group class="titleSection" id="" style="">
				<w2:textbox class="tit_tbl" id="save_title" label="개인별 보안안전교육 등록/수정" style="" tagname="h3"></w2:textbox>
				<w2:textbox class="tit_tbl blue" id="" label="* 저장하시려면 초기화 클릭 후 저장하시고, 수정하시려면 성명을 클릭하여 수정하세요." style="" tagname="h3"></w2:textbox>
			</xf:group>
			<xf:group class="w2tb tbl" id="" style="" tagname="table">
				<w2:attributes>
					<w2:summary></w2:summary>
				</w2:attributes>
				<xf:group tagname="caption"></xf:group>
				<xf:group tagname="colgroup">
					<xf:group style="width:150px;" tagname="col"></xf:group>
					<xf:group style="" tagname="col"></xf:group>
					<xf:group style="width:150px;" tagname="col"></xf:group>
					<xf:group style="" tagname="col"></xf:group>
					<xf:group style="width:150px;" tagname="col"></xf:group>
					<xf:group style="" tagname="col"></xf:group>
				</xf:group>
				<xf:group tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
						<w2:textbox class="blue" id="" label="년도" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<w2:inputCalendar calendarValueType="year" class="inpcal full" focusOnDateSelect="false" footerDiv="false"
							id="ica_year_ins" renderDiv="true" rightAlign="false" style="max-width: 150px;" ref="data:dma_mast.year" ev:onchange="scwin.ica_year_ins_onchange" title="년도">
						</w2:inputCalendar>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox id="" label="교육일자" style="" tagname="span" class="blue"></w2:textbox>
						
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal full" focusOnDateSelect="false" footerDiv="false"
							id="ica_educ_ymd" renderDiv="true" rightAlign="false" style="max-width: 150px;" ref="data:dma_mast.educ_ymd" title="교육일">
						</w2:inputCalendar>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox id="" label="성명" style="" tagname="span" class="blue"></w2:textbox>
						
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:group class="inpSch" id="grp_hum_search_2" style="width: 100px;">
							<xf:input adjustMaxLength="false" class="inp" ev:onchange="scwin.tb_empno_onchange"
								ev:onkeypress="scwin.tb_empno_onkeypress" id="ica_empno" ref="data:dma_mast.empno" style="" title="성명">
							</xf:input>
							<xf:trigger class="btn" ev:onclick="scwin.btn_search_hum_onclick_2" id="btn_search_hum_2" style="" title="성명 조회"
								type="button">
								<xf:label><![CDATA[검색]]></xf:label>
							</xf:trigger>
						</xf:group>
						<xf:input adjustMaxLength="false" class="inp" disabled="true" id="ica_nm" ref="data:dma_mast.educ_psn_nm"
							style="width: 100px;" title="성명상세 ">
						</xf:input>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox id="" label="지역" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-전체-" class="sel" direction="auto"
							disabled="false" disabledClass="w2selectbox_disabled" id="sbx_work_region" ref="data:dma_mast.work_region" style="width:170px;"
							submenuSize="auto" title="지역">
							<xf:choices></xf:choices>
						</xf:select1>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th" style="">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox id="" label="교육구분" style="" tagname="span" class="blue"></w2:textbox>
						
					</xf:group>
					<xf:group class="w2tb_td" tagname="td" style="">
						<w2:attributes></w2:attributes>
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-전체-" class="sel"
							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_educ_typ_ins" ref="data:dma_mast.educ_typ"
							style="width:170px;" submenuSize="auto" title="교육구분">
							<xf:choices>
								<xf:itemset nodeset="data:dlt_eductyp_list">
									<xf:label ref="cd_nm"></xf:label>
									<xf:value ref="educ_typ"></xf:value>
								</xf:itemset>
							</xf:choices>
						</xf:select1>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th" style="">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span><w2:textbox id="" label="교육종류" style="" tagname="span" class="blue"></w2:textbox>
						
					</xf:group>
					<xf:group class="w2tb_td" tagname="td" style="">
						<w2:attributes></w2:attributes>
						<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="-전체-" class="sel"
							direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_educ_knd_ins" ref="data:dma_mast.educ_knd"
							style="width:250px;" submenuSize="auto" title="교육종류">
							<xf:choices>
								<xf:itemset nodeset="data:dlt_eduknd_list">
									<xf:label ref="cd_nm"></xf:label>
									<xf:value ref="educ_cd"></xf:value>
								</xf:itemset>
							</xf:choices>
						</xf:select1>
					</xf:group>
				</xf:group>
				<xf:group tagname="tr">
					<xf:group class="w2tb_th" tagname="th">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:span class="bul_req" id="" label="[필수입력항목]" style=""></w2:span>
						<w2:textbox class="blue" id="" label="이수시간" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td">
						<w2:attributes></w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full" id="ibx_complt_time" style="width:170px;" title="이수시간" ref="data:dma_mast.complt_time" allowChar="0-9"></xf:input>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th" style="">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox class="" id="" label="교육시기" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td" style="">
						<w2:attributes></w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full" id="ibx_educ_time" style="width:170px;" title="교육시기" ref="data:dma_mast.educ_time"></xf:input>
					</xf:group>
					<xf:group class="w2tb_th" tagname="th" style="">
						<w2:attributes>
							<w2:scope>row</w2:scope>
						</w2:attributes>
						<w2:textbox class="" id="" label="비고" style="" tagname="span"></w2:textbox>
					</xf:group>
					<xf:group class="w2tb_td" tagname="td" style="">
						<w2:attributes></w2:attributes>
						<xf:input adjustMaxLength="false" class="inp full" id="ibx_rmk" style="width:250px;" title="비고" ref="data:dma_mast.rmk"></xf:input>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group class="btnGroup" id="" style="">
				<xf:group class="le" id="" style=""></xf:group>
				<xf:group class="ri" id="">

					<w2:textbox class="tit_tbl blue" id="tbx_save_info" label="* 신규 저장 상태입니다." style="" tagname="h4"></w2:textbox>
					<xf:trigger class=" btn pro conf" ev:onclick="scwin.btn_reset_onclick" id="btn_trigger_reset" style="" type="button">
						<xf:label><![CDATA[초기화]]></xf:label>
					</xf:trigger>
					<xf:trigger class=" btn pro conf" ev:onclick="scwin.btn_save_onclick" id="btn_trigger_insert" style="" type="button">
						<xf:label><![CDATA[저장]]></xf:label>
					</xf:trigger>
					<xf:trigger class=" btn pro conf" ev:onclick="scwin.btn_delete_onclick" id="btn_trigger_delete" style="" type="button" disabled="true">
						<xf:label><![CDATA[삭제]]></xf:label>
					</xf:trigger>
					
				</xf:group>
			</xf:group>
		</xf:group>
	</body>
</html>
