<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
    	<w2:type>DEFAULT</w2:type>
    	<w2:buildDate />
    	<xf:model>
    		<xf:instance>
    			<data xmlns="" />
    		</xf:instance>
    		<w2:dataCollection baseNode="map">
    			<w2:dataMap baseNode="map" id="dma_search">
    				<w2:keyInfo>
    					<w2:key id="prod_recei_div" name="구분" dataType="text"></w2:key>
    					<w2:key id="record_nm" name="기록물명" dataType="text"></w2:key>
    					<w2:key id="receipt_syspayno" name="접수자" dataType="text"></w2:key>
    					<w2:key id="receipt_nm" name="접수자이름" dataType="text"></w2:key>
    					<w2:key id="keep_year" name="보존기간" dataType="text"></w2:key>
    					<w2:key id="open_level" name="공개여부" dataType="text"></w2:key>
    					<w2:key id="receipt_ymd_start" name="시작일" dataType="text"></w2:key>
    					<w2:key id="receipt_ymd_close" name="종료일" dataType="text"></w2:key>

    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataList baseNode="list" repeatNode="map" id="dlt_grd" saveRemovedData="true">
    				<w2:columnInfo>
    					<w2:column id="req_no" name="문서번호" dataType="text"></w2:column>
    					<w2:column id="process_dept" name="처리과" dataType="text"></w2:column>
    					<w2:column id="business_unit" name="단위업무코드" dataType="text"></w2:column>
    					<w2:column id="business_nm" name="단위업무이름" dataType="text"></w2:column>
    					<w2:column id="prod_recei_div" name="구분" dataType="text"></w2:column>
    					<w2:column id="record_nm" name="기록물명" dataType="text"></w2:column>
    					<w2:column id="recei_no" name="접수번호" dataType="text"></w2:column>
    					<w2:column id="receipt_ymd" name="접수일자" dataType="text"></w2:column>
    					<w2:column id="receipt_dept" name="접수부서" dataType="text"></w2:column>
    					<w2:column id="receipt_dept_nm" name="접수부서이름" dataType="text"></w2:column>
    					<w2:column id="receipt_syspayno" name="접수자" dataType="text"></w2:column>
    					<w2:column id="receipt_nm" name="접수자이름" dataType="text"></w2:column>
    					<w2:column id="dept_new_ymd" name="부서데이트" dataType="text"></w2:column>
    					<w2:column id="receipt_approver" name="최종결재자" dataType="text"></w2:column>
    					<w2:column id="receipt_approver_nm" name="최종결재자이름" dataType="text"></w2:column>
    					<w2:column id="keep_year" name="보존기간" dataType="text"></w2:column>
    					<w2:column id="open_level" name="공개구분" dataType="text"></w2:column>
    					<w2:column id="attach_file_no" name="파일번호" dataType="text"></w2:column>
    					<w2:column id="regst_psn_syspayno" name="게시자" dataType="text"></w2:column>
    					<w2:column id="regst_psn_nm" name="게시자이름" dataType="text"></w2:column>
    					<w2:column id="regst_daytm" name="게시일시" dataType="text"></w2:column>
    					<w2:column id="updt_psn_syspayno" name="수정자" dataType="text"></w2:column>
    					<w2:column id="updt_daytm" name="수정일시" dataType="text"></w2:column>
    					<w2:column id="is_deleted" name="삭제여부" dataType="text"></w2:column>
    					<w2:column id="chk" name="선택" dataType="text"></w2:column>
    				</w2:columnInfo>
    				<w2:data use="false"></w2:data>
    			</w2:dataList>
    			<w2:dataMap baseNode="map" id="dma_attach">
    				<w2:keyInfo>
    					<w2:key id="req_no" name="문서번호" dataType="text"></w2:key>
    					<w2:key id="record_nm" name="기록물명" dataType="text"></w2:key>
    					<w2:key id="attach_file_no" name="첨부파일" dataType="text"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataMap baseNode="map" id="dma_save">
    				<w2:keyInfo>
    					<w2:key id="chk" name="체크" dataType="text"></w2:key>
    					<w2:key id="prod_recei_div" name="구분" dataType="text"></w2:key>
    					<w2:key id="req_no" name="문서번호" dataType="text"></w2:key>
    					<w2:key id="process_dept" name="처리과" dataType="text"></w2:key>
    					<w2:key id="business_unit" name="단위업무 코드" dataType="text"></w2:key>
    					<w2:key id="business_nm" name="단위업무" dataType="text"></w2:key>
    					<w2:key id="record_nm" name="기록물명" dataType="text"></w2:key>
    					<w2:key id="recei_no" name="접수번호" dataType="text"></w2:key>
    					<w2:key id="receipt_ymd" name="접수일시" dataType="text"></w2:key>
    					<w2:key id="receipt_dept" name="receipt_dept" dataType="text"></w2:key>
    					<w2:key id="receipt_dept_nm" name="접수부서" dataType="text"></w2:key>
    					<w2:key id="receipt_syspayno" name="receipt_syspayno" dataType="text"></w2:key>
    					<w2:key id="receipt_nm" name="접수자" dataType="text"></w2:key>
    					<w2:key id="receipt_approver" name="receipt_approver" dataType="text"></w2:key>
    					<w2:key id="receipt_approver_nm" name="최종결재자" dataType="text"></w2:key>
    					<w2:key id="keep_year" name="보존기간" dataType="text"></w2:key>
    					<w2:key id="open_level" name="공개구분" dataType="text"></w2:key>
    					<w2:key id="attach_file_no" name="첨부파일 번호" dataType="text"></w2:key>
    					<w2:key id="regst_psn_syspayno" name="regst_psn_syspayno" dataType="text"></w2:key>
    					<w2:key id="regst_psn_nm" name="게시자" dataType="text"></w2:key>
    					<w2:key id="regst_daytm" name="등록일시" dataType="text"></w2:key>


    				</w2:keyInfo>
    			</w2:dataMap>
    		</w2:dataCollection>
    		<w2:workflowCollection></w2:workflowCollection>
    		<!-- 리스트조회 -->
    		<xf:submission id="sbm_selectData" ref="data:json,dma_search" target='data:json,{"id":"dlt_grd","key":"CgsLongRecVoList"}'
    			action="SvcCCSCGSCGSLR01.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
    			customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 삭제 -->
    		<xf:submission id="sbm_deleteData" ref="data:json,dma_save" target="" action="SvcCCSCGSCGSMD01.pwkjson" method="post"
    			mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
    			processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 문서번호 받아오기 -->
    		<xf:submission id="sbm_getReqNo" ref="" target='' action="SvcCCSCGSCGSMM01.pwkjson" method="post" mediatype="application/json"
    			encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
    			ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    		<!-- 데이터 저장하기 -->
    		<xf:submission id="sbm_saveData" ref='data:json,{"action":"modified","id":"dlt_grd","key":"CgsLongRecVoList"}' target="" action="SvcCCSCGSCGSSI01.pwkjson" method="post" mediatype="application/json"
    			encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
    			ev:submitdone="" ev:submiterror="" abortTrigger="">
    		</xf:submission>
    	</xf:model>
    	<script type="text/javascript" lazy="false"><![CDATA[
        
	scwin.onpageload = function() {
		com.file.init();
		var today = gcm.date.getServerDateTime();
		dma_search.set("receipt_ymd_start", com.addDate(today, -30));//데이터 맵에 세팅하는 방식(추후 뷰에서 ref값 추가 해야함)
		dma_search.set("receipt_ymd_close", today);
		
//		receipt_ymd_start.setValue(com.addDate(today, -30));  // 밸류값을 바로 세팅하는 방식
//		receipt_ymd_close.setValue(today);
		//기간역전 체크
		com.checkPeriod(receipt_ymd_start, receipt_ymd_close);
		//enter key event
		com.setEnterKeyEvent(schbox, scwin.btn_search_onclick);
		
		
		
	};
	//직원검색
	scwin.selectHumBtn = function(data,row) {
		// 버튼(img)으로 팝업함수 바로 호출 처음 변수에 아무것도 넣지 않으면 최초 서브미션도 실행 안함. 
//		data == "img" ? data = { empno : ""} : data = { empno : receipt_syspayno.getValue(), nm : receipt_nm.getValue(), work_clsf : "HAG010" };
		if(data == "search"){
			data = { empno : ""}
			com.pop.open( com.pop.TYPE.HUM, data, function(ret){
				if (ret) {
					dma_search.set("receipt_syspayno", ret.syspayno);
					dma_search.set("receipt_nm", ret.nm);
				}
			});
		}else if (data == "receiptUpdate"){
			data = { empno : ""}
			com.pop.open( com.pop.TYPE.HUM, data, function(ret){
				if (ret) {
					dma_save.setJSON(dlt_grd.getRowJSON(row));
					dma_save.set("receipt_syspayno", ret.syspayno);
					dma_save.set("receipt_nm", ret.nm);
					dma_save.set("receipt_dept", ret.dept_cd);
					dma_save.set("receipt_dept_nm", ret.dept_nm);
					dlt_grd.setRowJSON(row, dma_save.getJSON(), true);
				}
			});
		}else if (data == "approverUpdate"){
			data = { empno : ""}
			com.pop.open( com.pop.TYPE.HUM, data, function(ret){
				if (ret) {
					dma_save.set("receipt_approver", ret.syspayno);
					dma_save.set("receipt_approver_nm", ret.nm);
					dlt_grd.setRowJSON(row, dma_save.getJSON(), true);
				}
			});
		}
			
	};
	
	scwin.setTotalNum = function(){
		//전체 건수 조회
		ui_totRowCount.setValue( dlt_grd.getRowCount() );
	};
	
	scwin.search = function(e){
		com.execute(sbm_selectData,{
			successCallback : function() {
				scwin.setTotalNum();
				}
		});
	};
	
	scwin.deleteData = function(chkArr){
		for(var i=0; i<chkArr.length; i++){
			dma_save.set("req_no", dlt_grd.getCellData(chkArr[i], "req_no"));
			com.execute(sbm_deleteData);
		}
		com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/);
		scwin.search();
	};
	
	scwin.saveData = function(chkArr){
		com.execute(sbm_saveData, {
			successCallback : function() {
				com.alert("message.xom.wq.023"/*정상적으로 처리되었습니다.*/);
				scwin.search();
			}
		});	
		
	};
	
	/******************************************************클릭 이벤트*******************************************************/
	//검색 버튼 클릭
	scwin.btn_search_onclick = function(e){
		scwin.search();
	};
	
	//초기화 버튼 클릭
	scwin.btn_clear_onclick = function(e){
		var today = gcm.date.getServerDateTime();
		
		prod_recei_div.setValue("");
		record_nm.setValue("");
		receipt_syspayno.setValue("");
		keep_year.setValue("");
		open_level.setValue("");
		receipt_ymd_start.setValue(com.addDate(today, -30));  // (밸류값을 바로 세팅하는 방식)
		receipt_ymd_close.setValue(today);
		scwin.setTotalNum();
	};
	
	//접수자 찾기 버튼 클릭
	scwin.btn_search_hum_onclick = function(e) {
		scwin.selectHumBtn("search");
	};
	
	//행 추가 버튼 클릭
	scwin.btn_add_row_onclick = function(e) {
		com.execute(sbm_getReqNo,{
			successCallback : function(e) {
				var reqNo = e.responseJSON.elData.req_no;
				console.log(reqNo);
				var index = com.addRow(grd_list);
				dlt_grd.setCellData(index, "prod_recei_div", "1"); 
				dlt_grd.setCellData(index, "req_no", reqNo); 
				dlt_grd.setCellData(index, "regst_psn_syspayno", com.getLoginInfo("syspayno"));
			}
		});
	};
	
	//행 삭제 버튼 클릭
	scwin.btn_sub_row_onclick = function(e) {
		com.deleteRow(grd_list);
	};
	
	//행 클릭
	scwin.grd_list_oncellclick = function(row,col,colId) {
		var rowJson = dlt_grd.getRowJSON(row);
		dma_attach.setJSON(rowJson);
		
		var fileKey = com.isEmpty(rowJson.attach_file_no) ? 'C461' : rowJson.attach_file_no;
		com.file.create(upload_A.getID(), {fileKey: fileKey, mode: 'edit'});
		
		if( col == grd_list.getColumnIndex("receipt_nm") || col == grd_list.getColumnIndex("receipt_approver_nm")){
			if( col == grd_list.getColumnIndex("receipt_nm")){
				scwin.selectHumBtn("receiptUpdate",row);
			}
			
			if( col == grd_list.getColumnIndex("receipt_approver_nm")){
				scwin.selectHumBtn("approverUpdate",row);
			}
			
		}
		
	};
	
	//엑셀 다운로드 버튼 클릭
	scwin.btn_exel_onclick = function(e) {
		var option = {
			    fileName : "data.xlsx"
		};
		com.downloadGridExcel(grd_list, option);
	};
	
	//삭제 버튼 클릭
	scwin.btn_delete_onclick = function(e) {
		var chkArr = grd_list.getCheckedIndex("chk");
		
		if(chkArr.length == 0){
			alert("삭제하실 자료를 선택하십시오");
			return;
		}
		
		for(var i=0; i<chkArr.length; i++){
			if(dlt_grd.getCellData(chkArr[i], "req_no").trim() == "") {
				alert("문서번호는 필수입니다.");
				return;
			}
		}
		
		if(confirm("해당 자료를 삭제하시겠습니까?")){
			com.execute(scwin.deleteData(chkArr));
		}
	};
	
	//저장 버튼 클릭
	scwin.btn_save_onclick = function(e) {
		var chkArr = grd_list.getCheckedIndex("chk");
		
		if(chkArr.length == 0){
			alert("저장하실 데이터를 선택하십시오");
			return;
		}
		
		for(var i=0; i<chkArr.length; i++){
			if(dlt_grd.getCellData(chkArr[i], "req_no").trim() == "") {
				alert("문서번호는 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "prod_recei_div").trim() =="") {
				alert("구분은 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "record_nm").trim() =="") {
				alert("기록물명은 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "receipt_ymd").trim() =="") {
				alert("접수일자는 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "receipt_dept").trim() =="") {
				alert("접수부서는 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "receipt_nm").trim() =="") {
				alert("접수자는 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "keep_year").trim() =="") {
				alert("보존기간은 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "open_level").trim() =="") {
				alert("공개구분은 필수입력사항 입니다.");
				return;
			}else if(dlt_grd.getCellData(chkArr[i], "receipt_approver_nm").trim() =="") {
				alert("최종결재자는 필수입력사항 입니다.");
				return;
			}
		}
		
		if(confirm("해당 자료를 저장하시겠습니까?")){
			com.execute(scwin.saveData(chkArr));
		}
		
	};
	
	
	scwin.btn_saveAttach_onclick = function(e) {
		//파일 전송 후 첨부파일 번호를 받아옴 (먼저실행해야함)
		com.file.transport( function( attachObj) {
			var req_no = dma_attach.get("req_no");
			var index = dlt_grd.getMatchedIndex("req_no", req_no, true)[0];
			
			if (attachObj.upload_A) dlt_grd.setCellData(index, "attach_file_no", attachObj.upload_A);
			
			console.log("attach_file_no >>>>" + dma_attach.get("attach_file_no"));
			console.log("index, req_no >>>>" + index, req_no);
		});
	};
	]]></script><!-- 
    	<style type="text/css"><![CDATA[ ]]></style> -->
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<w2:wframe id="wfm_title" src="/cm/xml/contentTitle.xml" style=""></w2:wframe>
    	<xf:group style="padding:0px 20px 20px 20px;" id="">
    		<xf:group class="searchSection" id="" style="">
    			<xf:group class="schbox" id="schbox" style="">
    				<xf:group class="w2tb tbl" id="" style="" tagname="table">
    					<w2:attributes>
    						<w2:summary></w2:summary>
    					</w2:attributes>
    					<xf:group tagname="caption"></xf:group>
    					<xf:group tagname="colgroup">
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:186px;" tagname="col"></xf:group>
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:192px;" tagname="col"></xf:group>
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group style="width:300px;" tagname="col"></xf:group>
    						<xf:group style="width:60px;" tagname="col"></xf:group>
    						<xf:group tagname="col"></xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="구분" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="prod_recei_div" ref="data:dma_search.prod_recei_div"
    								style="width:150px;" submenuSize="auto" chooseOptionLabel="-전체-">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[생산]]></xf:label>
    										<xf:value><![CDATA[1]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[접수]]></xf:label>
    										<xf:value><![CDATA[2]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="기록물명" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:input adjustMaxLength="false" id="record_nm" style="width: 150px;height: 21px;" ref="data:dma_search.record_nm"></xf:input>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes>
    								<w2:scope>row</w2:scope>
    							</w2:attributes>
    							<w2:textbox id="" label="신청자" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<xf:group class="inpSch" id="" style="width: 100px;">
    								<xf:input adjustMaxLength="false" class="inp" id="receipt_syspayno" style="width:68px;" ref="data:dma_search.receipt_syspayno"></xf:input>
    								<xf:trigger ev:onclick="scwin.btn_search_hum_onclick" class="btn" id="btn_search_emp_pop" style="" type="button">
    									<xf:label><![CDATA[검색]]></xf:label>
    								</xf:trigger>
    							</xf:group>
    							<xf:input adjustMaxLength="false" class="inp" id="receipt_nm" style="width:100px;margin-left:16px;"
    							ref="data:dma_search.receipt_nm"></xf:input>
    						</xf:group>
    					</xf:group>
    					<xf:group style="" tagname="tr">
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes></w2:attributes>
    							<w2:textbox id="" label="보존기간" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="keep_year" ref="data:dma_search.keep_year" style="width:150px;"
    								submenuSize="auto" chooseOptionLabel="-전체-">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[1년]]></xf:label>
    										<xf:value><![CDATA[1]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[3년]]></xf:label>
    										<xf:value><![CDATA[3]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[5년]]></xf:label>
    										<xf:value><![CDATA[5]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[10년]]></xf:label>
    										<xf:value><![CDATA[10]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[30년]]></xf:label>
    										<xf:value><![CDATA[30]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[준영구]]></xf:label>
    										<xf:value><![CDATA[99]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[영구]]></xf:label>
    										<xf:value><![CDATA[100]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
    						</xf:group>
    						<xf:group class="w2tb_th" tagname="th">
    							<w2:attributes></w2:attributes>
    							<w2:textbox id="" label="공개여부" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" tagname="td">
    							<w2:attributes></w2:attributes>
    							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="sel" direction="auto"
    								disabled="false" disabledClass="w2selectbox_disabled" id="open_level" ref="data:dma_search.open_level" style="width:150px;"
    								submenuSize="auto" chooseOptionLabel="-전체-">
    								<xf:choices>
    									<xf:item>
    										<xf:label><![CDATA[공개]]></xf:label>
    										<xf:value><![CDATA[1]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[부분공개]]></xf:label>
    										<xf:value><![CDATA[2]]></xf:value>
    									</xf:item>
    									<xf:item>
    										<xf:label><![CDATA[비공개]]></xf:label>
    										<xf:value><![CDATA[3]]></xf:value>
    									</xf:item>
    								</xf:choices>
    							</xf:select1>
    						</xf:group>
    						<xf:group class="w2tb_th" style="" tagname="th">
    							<w2:attributes></w2:attributes>
    							<w2:textbox id="" label="신청기간" style="" tagname="span"></w2:textbox>
    						</xf:group>
    						<xf:group class="w2tb_td" style="" tagname="td">
    							<w2:attributes></w2:attributes>
    							<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false"
    								footerDiv="false" id="receipt_ymd_start" placeholder="시작일" renderDiv="true" rightAlign="false" 
    								ref="data:dma_search.receipt_ymd_start">
    							</w2:inputCalendar>
    							<w2:textbox class="dash" id="" label="~" style="" tagname="span"></w2:textbox>
    							<w2:inputCalendar calendarValueType="yearMonthDate" class="inpcal" focusOnDateSelect="false"
    								footerDiv="false" id="receipt_ymd_close" placeholder="종료일" renderDiv="true" rightAlign="false" 
    								ref="data:dma_search.receipt_ymd_close">
    							</w2:inputCalendar>
    						</xf:group>
    					</xf:group>
    				</xf:group>
    			</xf:group>
    			<xf:group class="schbtn" id="">
    				<xf:trigger ev:onclick="scwin.btn_clear_onclick" class="btn icon init" id="btn_clear" style="" type="button">
    					<xf:label><![CDATA[초기화]]></xf:label>
    				</xf:trigger>
    				<xf:trigger ev:onclick="scwin.btn_search_onclick" class="btn search" id="btn_search" style="" type="button">
    					<xf:label><![CDATA[조회]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    		</xf:group>
    		
    		<xf:group class="titleSection" id="" style="">
    			<xf:group class="le" id="">
    				<w2:textbox class="tit_tbl" id="" label="장기기록물 조회" style="" tagname="h3"></w2:textbox>
    				<xf:group class="result" id="">
    					<w2:span id="" label="*조회결과 " style=""></w2:span>
    					<w2:span class="numtotal" id="ui_totRowCount" label="0" style=""></w2:span>
    					<w2:span id="" label="건" style=""></w2:span>
    				</xf:group>
    			</xf:group>
    			<xf:group id="" class="ri">

    				<xf:group style="float:left;width:83px;" id="" class="btnarea">
    					<xf:group class="le" id="">

    					</xf:group>
    					<xf:trigger style="" id="btn_add_row" type="button" class="bt_plus" ev:onclick="scwin.btn_add_row_onclick">
    						<xf:label><![CDATA[추가]]></xf:label>
    					</xf:trigger>
    					<xf:trigger style="" id="btn_sub_row" type="button" class="bt_minus" ev:onclick="scwin.btn_sub_row_onclick">
    						<xf:label><![CDATA[삭제]]></xf:label>
    					</xf:trigger>
    					<w2:textbox class="tit_tbl" id="" label="행" style="float: left;margin-right: 10px;margin-top:2px;" tagname="h3"></w2:textbox>
    				</xf:group>
    				<xf:group style="" id="" class="btnarea">
    					<xf:trigger style="" id="btn_save" type="button" class="btn" ev:onclick="scwin.btn_save_onclick">
    						<xf:label><![CDATA[저장]]></xf:label>
    					</xf:trigger>
    					<xf:trigger style="" id="btn_delete" type="button" class="btn" ev:onclick="scwin.btn_delete_onclick">
    						<xf:label><![CDATA[삭제]]></xf:label>
    					</xf:trigger>
    					<xf:trigger style="" id="btn_exel" type="button" class="btn icon down" ev:onclick="scwin.btn_exel_onclick">
    						<xf:label><![CDATA[엑셀다운로드]]></xf:label>
    					</xf:trigger>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<w2:gridView autoFit="allColumn" class="grid" dataList="data:dlt_grd" defaultCellHeight="28"
    			ev:oncellclick="scwin.grd_list_oncellclick" evenRowBackgroundColor="#f7faff" id="grd_list" noResultMessage="조회 결과가 없습니다."
    			noResultMessageClass="noResult" rowMouseOverColor="#e7f0fb" rowNumBackgroundColor="#fff" rowNumHeaderValue="No." rowNumVisible="true"
    			rowNumWidth="40" rowStatusHeaderValue="상태" rowStatusVisible="true" rowStatusWidth="50" scrollByColumn="false"
    			scrollByColumnAdaptive="false" selectedCellColor="#fbf2cd" selectedRowColor="#fbf2cd" sortable="true" style="height: 85px;"
    			summaryAuto="true" visibleRowNum="20" ev:oncelldblclick="scwin.grd_list_oncelldblclick" ev:onafteredit="scwin.grd_list_onafteredit">
    			<w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
    			<w2:header id="header1" style="">
    				<w2:row id="row1" style="">
    					<w2:column checkboxLabel="전체선택" displayMode="label" id="hChk" inputType="checkbox" sortable="false"
    						style="height:28px;" value="chk" width="35">
    					</w2:column>
    					<w2:column displayMode="label" id="column3" inputType="text" style="height:28px;" value="구분" width="70"></w2:column>
    					<w2:column displayMode="label" id="column20" inputType="text" style="height:28px;" value="문서번호" width="85">
    					</w2:column>
    					<w2:column displayMode="label" hidden="false" id="column62" inputType="text" style="height:28px;" value="처리과"
    						width="85">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column69" value="" displayMode="label"
    						hidden="true">
    					</w2:column>
    					<w2:column displayMode="label" id="column34" inputType="text" style="height:28px" value="단위업무" width="85"></w2:column>
    					<w2:column displayMode="label" id="column27" inputType="text" style="height:28px;" value="기록물명" width="70"></w2:column>
    					<w2:column displayMode="label" id="column25" inputType="text" style="height:28px;" value="접수번호" width="80"></w2:column>
    					<w2:column displayMode="label" id="column30" inputType="text" style="height:28px" value="접수일시" width="75"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column63" value="" displayMode="label"
    						hidden="true">
    					</w2:column>
    					<w2:column displayMode="label" id="column32" inputType="text" style="height:28px" value="접수부서" width="90"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column65" value="" displayMode="label"
    						hidden="true">
    					</w2:column>
    					<w2:column displayMode="label" id="column36" inputType="text" style="height:28px" value="접수자" width="80"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column67" value="" displayMode="label"
    						hidden="true">
    					</w2:column>
    					<w2:column displayMode="label" id="column48" inputType="text" style="height:28px" value="최종 결재자" width="120"></w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="column70" value="" displayMode="label"
    						hidden="true">
    					</w2:column>
    					<w2:column displayMode="label" id="column44" inputType="text" style="height:28px" value="보존기간" width="70"></w2:column>
    					<w2:column displayMode="label" id="column60" inputType="text" style="height:28px" value="공개구분" width="80"></w2:column>
    					<w2:column displayMode="label" id="column46" inputType="text" style="height:28px;" value="첨부파일 번호" width="170"></w2:column>
    					<w2:column displayMode="label" id="column58" inputType="text" style="height:28px" value="등록일시" width="60"></w2:column>
    				</w2:row>
    			</w2:header>
    			<w2:gBody id="gBody1" style="">
    				<w2:row id="row2" style="">
    					<w2:column displayMode="label" fixColumnWidth="true" id="chk" inputType="checkbox" style="height:28px;"
    						width="45">
    					</w2:column>
    					<w2:column displayMode="label" escape="false" id="prod_recei_div" inputType="select" readOnly="false"
    						style="height:28px;" viewType="icon" width="70" dataType="text" chooseOption="true" ref="" allOption=""
    						chooseOptionLabel="-선택-">
    						<w2:choices>
    							<w2:item>
    								<w2:label><![CDATA[생산]]></w2:label>
    								<w2:value><![CDATA[1]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[접수]]></w2:label>
    								<w2:value><![CDATA[2]]></w2:value>
    							</w2:item>
    						</w2:choices>
    					</w2:column>
    					<w2:column dataType="text" displayMode="label" id="req_no" inputType="text" readOnly="true" style="height:28px;"
    						width="85">
    					</w2:column>
    					<w2:column dataType="text" displayMode="label" id="process_dept" inputType="text" readOnly="false"
    						style="height:28px;" width="85">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="business_unit" value="" displayMode="label"></w2:column>
    					<w2:column dataType="text" displayMode="label" id="business_nm" inputType="text" readOnly="false"
    						style="height:28px" width="85">
    					</w2:column>
    					<w2:column dataType="text" displayMode="label" id="record_nm" inputType="text" readOnly="false" style="height:28px;"
    						width="70">
    					</w2:column>
    					<w2:column dataType="text" displayMode="label" id="recei_no" inputType="text" readOnly="false" style="height:28px;"
    						width="80">
    					</w2:column>
    					<w2:column dataType="date" displayMode="label" id="receipt_ymd" inputType="calendar" readOnly="false"
    						style="height:28px" width="75">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="receipt_dept" value="" displayMode="label"></w2:column>
    					<w2:column dataType="text" displayMode="label" id="receipt_dept_nm" inputType="text" readOnly="true"
    						style="height:28px" width="90">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="receipt_syspayno" value="" displayMode="label"></w2:column>
    					<w2:column dataType="text" displayMode="label" id="receipt_nm" inputType="text" readOnly="false" style="height:28px"
    						width="80">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="receipt_approver" value="" displayMode="label"></w2:column>
    					<w2:column dataType="text" displayMode="label" id="receipt_approver_nm" inputType="text" readOnly="false"
    						style="height:28px" width="70">
    					</w2:column>
    					<w2:column width="70" inputType="text" style="height:28px" id="is_deleted" value="false" displayMode="label"></w2:column>
    					<w2:column dataType="text" displayMode="label" id="keep_year" inputType="select" readOnly="false"
    						style="height:28px" viewType="icon" width="80" allOption="" chooseOption="true" ref="" chooseOptionLabel="-선택-">
    						<w2:choices>
    							<w2:item>
    								<w2:label><![CDATA[1년]]></w2:label>
    								<w2:value><![CDATA[1]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[3년]]></w2:label>
    								<w2:value><![CDATA[3]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[5년]]></w2:label>
    								<w2:value><![CDATA[5]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[10년]]></w2:label>
    								<w2:value><![CDATA[10]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[30년]]></w2:label>
    								<w2:value><![CDATA[30]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[준영구]]></w2:label>
    								<w2:value><![CDATA[99]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[영구]]></w2:label>
    								<w2:value><![CDATA[100]]></w2:value>
    							</w2:item>
    						</w2:choices>
    					</w2:column>
    					<w2:column dataType="text" displayMode="label" id="open_level" inputType="select" readOnly="false"
    						style="height:28px" viewType="icon" width="50" allOption="" chooseOption="true" ref="" chooseOptionLabel="-선택-">
    						<w2:choices>
    							<w2:item>
    								<w2:label><![CDATA[공개]]></w2:label>
    								<w2:value><![CDATA[1]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[부분공개]]></w2:label>
    								<w2:value><![CDATA[2]]></w2:value>
    							</w2:item>
    							<w2:item>
    								<w2:label><![CDATA[비공개]]></w2:label>
    								<w2:value><![CDATA[3]]></w2:value>
    							</w2:item>
    						</w2:choices>
    					</w2:column>
    					<w2:column dataType="text" displayMode="label" id="attach_file_no" inputType="text" readOnly="true"
    						style="height:28px" width="60">
    					</w2:column>
    					<w2:column dataType="date" displayMode="label" id="regst_daytm" inputType="calendar" readOnly="true" style="height:28px"
    						width="75">
    					</w2:column>
    				</w2:row>
    			</w2:gBody>
    		</w2:gridView>
    		<xf:group class="titleSection" id="" style="">
    			<w2:textbox class="tit_tbl" id="" label="별첨자료" style="" tagname="h3"></w2:textbox>
    		</xf:group>
    		<xf:group class="w2tb tbl" id="" style="" tagname="table" dataMap="dma_attach">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="caption"></xf:group>
    			<xf:group tagname="colgroup">
    				<xf:group style="width:140px;" tagname="col"></xf:group>
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group tagname="tr" style="">
    				<xf:group class="w2tb_th" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="문서번호" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" tagname="td">
    					<w2:attributes>
    						<w2:colspan>1</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox id="tbx_req_no" label="" ref="data:dma_attach.req_no"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_th" style="" tagname="th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="기록물명" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group class="w2tb_td" style="" tagname="td">
    					<w2:attributes>
    						<w2:colspan>1</w2:colspan>
    						<w2:rowspan>1</w2:rowspan>
    					</w2:attributes>
    					<w2:textbox id="tbx_record_nm" label="" ref="data:dma_attach.record_nm"></w2:textbox>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="th" class="w2tb_th">
    					<w2:attributes>
    						<w2:scope>row</w2:scope>
    					</w2:attributes>
    					<w2:textbox id="" label="첨부파일" style="" tagname="span"></w2:textbox>
    				</xf:group>
    				<xf:group tagname="td" class="w2tb_td">
    					<w2:attributes></w2:attributes>
    					<xf:group style="height:150px;" id="upload_A"></xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group style="" id="" class="btnGroup">
				<xf:group style="" id="" class="le">
				</xf:group>
				<xf:group id="" class="ri">
					<xf:trigger style="" id="btn_saveAttach" type="button" class="btn pro conf" ev:onclick="scwin.btn_saveAttach_onclick">
						<xf:label><![CDATA[첨부파일 저장]]></xf:label>
					</xf:trigger>
				</xf:group>
			</xf:group>
    	</xf:group>
    </body>
</html>
